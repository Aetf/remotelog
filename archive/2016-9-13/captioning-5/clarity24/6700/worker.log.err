SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/peifeng/tools/storm102/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/peifeng/work/run/storm102/data/supervisor/stormdist/captioning-1-1473815501/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /home/peifeng/work/run/storm102/data/workers/3acea4ca-d4b8-4d7b-9681-0542def7d4e6/tmp/cvld4291719538085398960/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0913 21:12:19.382254 18047 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0913 21:12:19.382450 18047 layer_factory.hpp:77] Creating layer data
I0913 21:12:19.382477 18047 net.cpp:91] Creating Layer data
I0913 21:12:19.382488 18047 net.cpp:399] data -> data
I0913 21:12:19.903192 18047 net.cpp:141] Setting up data
I0913 21:12:19.903395 18047 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0913 21:12:19.903404 18047 net.cpp:156] Memory required for data: 6183480
I0913 21:12:19.903435 18047 layer_factory.hpp:77] Creating layer conv1
I0913 21:12:19.903475 18047 net.cpp:91] Creating Layer conv1
I0913 21:12:19.903484 18047 net.cpp:425] conv1 <- data
I0913 21:12:19.903498 18047 net.cpp:399] conv1 -> conv1
I0913 21:12:20.028067 18037 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/3acea4ca-d4b8-4d7b-9681-0542def7d4e6/tmp/cvld4291719538085398960/s2vt.words_to_preds.prototxt
I0913 21:12:20.028136 18037 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0913 21:12:20.028144 18037 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0913 21:12:20.028408 18037 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0913 21:12:20.028507 18037 layer_factory.hpp:77] Creating layer input
I0913 21:12:20.028535 18037 net.cpp:91] Creating Layer input
I0913 21:12:20.028544 18037 net.cpp:399] input -> frames_fc7
I0913 21:12:20.028563 18037 net.cpp:399] input -> cont_sentence
I0913 21:12:20.028574 18037 net.cpp:399] input -> input_sentence
I0913 21:12:20.028584 18037 net.cpp:399] input -> stage_indicator
I0913 21:12:20.029909 18037 net.cpp:141] Setting up input
I0913 21:12:20.029928 18037 net.cpp:148] Top shape: 1 4096 (4096)
I0913 21:12:20.029935 18037 net.cpp:148] Top shape: 1 1 (1)
I0913 21:12:20.029940 18037 net.cpp:148] Top shape: 1 1 (1)
I0913 21:12:20.029947 18037 net.cpp:148] Top shape: 1 1 (1)
I0913 21:12:20.029950 18037 net.cpp:156] Memory required for data: 16396
I0913 21:12:20.029956 18037 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0913 21:12:20.029989 18037 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0913 21:12:20.029995 18037 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0913 21:12:20.030015 18037 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0913 21:12:20.030026 18037 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0913 21:12:20.033879 18037 net.cpp:141] Setting up cont_sentence_input_1_split
I0913 21:12:20.033896 18037 net.cpp:148] Top shape: 1 1 (1)
I0913 21:12:20.033903 18037 net.cpp:148] Top shape: 1 1 (1)
I0913 21:12:20.033907 18037 net.cpp:156] Memory required for data: 16404
I0913 21:12:20.033913 18037 layer_factory.hpp:77] Creating layer embed_encoder
I0913 21:12:20.033933 18037 net.cpp:91] Creating Layer embed_encoder
I0913 21:12:20.033939 18037 net.cpp:425] embed_encoder <- frames_fc7
I0913 21:12:20.033949 18037 net.cpp:399] embed_encoder -> embedded_in_frames
I0913 21:12:20.059963 18037 net.cpp:141] Setting up embed_encoder
I0913 21:12:20.060014 18037 net.cpp:148] Top shape: 1 500 (500)
I0913 21:12:20.060020 18037 net.cpp:156] Memory required for data: 18404
I0913 21:12:20.060047 18037 layer_factory.hpp:77] Creating layer reshape_frames
I0913 21:12:20.060091 18037 net.cpp:91] Creating Layer reshape_frames
I0913 21:12:20.060099 18037 net.cpp:425] reshape_frames <- embedded_in_frames
I0913 21:12:20.060111 18037 net.cpp:399] reshape_frames -> embedded_input_frames
I0913 21:12:20.060266 18037 net.cpp:141] Setting up reshape_frames
I0913 21:12:20.060276 18037 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:12:20.060281 18037 net.cpp:156] Memory required for data: 20404
I0913 21:12:20.060286 18037 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0913 21:12:20.060297 18037 net.cpp:91] Creating Layer reshape_stage_indicator
I0913 21:12:20.060302 18037 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0913 21:12:20.060322 18037 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0913 21:12:20.063189 18037 net.cpp:141] Setting up reshape_stage_indicator
I0913 21:12:20.063208 18037 net.cpp:148] Top shape: 1 1 1 (1)
I0913 21:12:20.063213 18037 net.cpp:156] Memory required for data: 20408
I0913 21:12:20.063220 18037 layer_factory.hpp:77] Creating layer embedding
I0913 21:12:20.063232 18037 net.cpp:91] Creating Layer embedding
I0913 21:12:20.063238 18037 net.cpp:425] embedding <- input_sentence
I0913 21:12:20.063251 18037 net.cpp:399] embedding -> embedded_input_sentence
I0913 21:12:20.128206 18047 net.cpp:141] Setting up conv1
I0913 21:12:20.128249 18047 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0913 21:12:20.128257 18047 net.cpp:156] Memory required for data: 17799480
I0913 21:12:20.128276 18047 layer_factory.hpp:77] Creating layer relu1
I0913 21:12:20.128293 18047 net.cpp:91] Creating Layer relu1
I0913 21:12:20.128299 18047 net.cpp:425] relu1 <- conv1
I0913 21:12:20.128307 18047 net.cpp:386] relu1 -> conv1 (in-place)
I0913 21:12:20.128686 18047 net.cpp:141] Setting up relu1
I0913 21:12:20.128700 18047 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0913 21:12:20.128705 18047 net.cpp:156] Memory required for data: 29415480
I0913 21:12:20.128710 18047 layer_factory.hpp:77] Creating layer pool1
I0913 21:12:20.128722 18047 net.cpp:91] Creating Layer pool1
I0913 21:12:20.128727 18047 net.cpp:425] pool1 <- conv1
I0913 21:12:20.128736 18047 net.cpp:399] pool1 -> pool1
I0913 21:12:20.128801 18047 net.cpp:141] Setting up pool1
I0913 21:12:20.128811 18047 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0913 21:12:20.128816 18047 net.cpp:156] Memory required for data: 32214840
I0913 21:12:20.128821 18047 layer_factory.hpp:77] Creating layer norm1
I0913 21:12:20.128837 18047 net.cpp:91] Creating Layer norm1
I0913 21:12:20.128842 18047 net.cpp:425] norm1 <- pool1
I0913 21:12:20.128849 18047 net.cpp:399] norm1 -> norm1
I0913 21:12:20.129103 18047 net.cpp:141] Setting up norm1
I0913 21:12:20.129117 18047 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0913 21:12:20.129122 18047 net.cpp:156] Memory required for data: 35014200
I0913 21:12:20.129127 18047 layer_factory.hpp:77] Creating layer conv2
I0913 21:12:20.129156 18047 net.cpp:91] Creating Layer conv2
I0913 21:12:20.129161 18047 net.cpp:425] conv2 <- norm1
I0913 21:12:20.129168 18047 net.cpp:399] conv2 -> conv2
I0913 21:12:20.132324 18047 net.cpp:141] Setting up conv2
I0913 21:12:20.132344 18047 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0913 21:12:20.132349 18047 net.cpp:156] Memory required for data: 42479160
I0913 21:12:20.132361 18047 layer_factory.hpp:77] Creating layer relu2
I0913 21:12:20.132369 18047 net.cpp:91] Creating Layer relu2
I0913 21:12:20.132375 18047 net.cpp:425] relu2 <- conv2
I0913 21:12:20.132383 18047 net.cpp:386] relu2 -> conv2 (in-place)
I0913 21:12:20.132766 18047 net.cpp:141] Setting up relu2
I0913 21:12:20.132779 18047 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0913 21:12:20.132783 18047 net.cpp:156] Memory required for data: 49944120
I0913 21:12:20.132789 18047 layer_factory.hpp:77] Creating layer pool2
I0913 21:12:20.132812 18047 net.cpp:91] Creating Layer pool2
I0913 21:12:20.132818 18047 net.cpp:425] pool2 <- conv2
I0913 21:12:20.132825 18047 net.cpp:399] pool2 -> pool2
I0913 21:12:20.132882 18047 net.cpp:141] Setting up pool2
I0913 21:12:20.132892 18047 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:12:20.132896 18047 net.cpp:156] Memory required for data: 51674680
I0913 21:12:20.132901 18047 layer_factory.hpp:77] Creating layer norm2
I0913 21:12:20.132913 18047 net.cpp:91] Creating Layer norm2
I0913 21:12:20.132918 18047 net.cpp:425] norm2 <- pool2
I0913 21:12:20.132925 18047 net.cpp:399] norm2 -> norm2
I0913 21:12:20.133182 18047 net.cpp:141] Setting up norm2
I0913 21:12:20.133193 18047 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:12:20.133198 18047 net.cpp:156] Memory required for data: 53405240
I0913 21:12:20.133203 18047 layer_factory.hpp:77] Creating layer conv3
I0913 21:12:20.133215 18047 net.cpp:91] Creating Layer conv3
I0913 21:12:20.133220 18047 net.cpp:425] conv3 <- norm2
I0913 21:12:20.133227 18047 net.cpp:399] conv3 -> conv3
I0913 21:12:20.136878 18047 net.cpp:141] Setting up conv3
I0913 21:12:20.136898 18047 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:12:20.136903 18047 net.cpp:156] Memory required for data: 56001080
I0913 21:12:20.136929 18047 layer_factory.hpp:77] Creating layer relu3
I0913 21:12:20.136940 18047 net.cpp:91] Creating Layer relu3
I0913 21:12:20.136945 18047 net.cpp:425] relu3 <- conv3
I0913 21:12:20.136953 18047 net.cpp:386] relu3 -> conv3 (in-place)
I0913 21:12:20.137174 18047 net.cpp:141] Setting up relu3
I0913 21:12:20.137186 18047 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:12:20.137190 18047 net.cpp:156] Memory required for data: 58596920
I0913 21:12:20.137195 18047 layer_factory.hpp:77] Creating layer conv4
I0913 21:12:20.137222 18047 net.cpp:91] Creating Layer conv4
I0913 21:12:20.137228 18047 net.cpp:425] conv4 <- conv3
I0913 21:12:20.137238 18047 net.cpp:399] conv4 -> conv4
I0913 21:12:20.141132 18047 net.cpp:141] Setting up conv4
I0913 21:12:20.141151 18047 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:12:20.141156 18047 net.cpp:156] Memory required for data: 61192760
I0913 21:12:20.141165 18047 layer_factory.hpp:77] Creating layer relu4
I0913 21:12:20.141178 18047 net.cpp:91] Creating Layer relu4
I0913 21:12:20.141185 18047 net.cpp:425] relu4 <- conv4
I0913 21:12:20.141193 18047 net.cpp:386] relu4 -> conv4 (in-place)
I0913 21:12:20.141572 18047 net.cpp:141] Setting up relu4
I0913 21:12:20.141585 18047 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:12:20.141589 18047 net.cpp:156] Memory required for data: 63788600
I0913 21:12:20.141594 18047 layer_factory.hpp:77] Creating layer conv5
I0913 21:12:20.141607 18047 net.cpp:91] Creating Layer conv5
I0913 21:12:20.141613 18047 net.cpp:425] conv5 <- conv4
I0913 21:12:20.141619 18047 net.cpp:399] conv5 -> conv5
I0913 21:12:20.145191 18047 net.cpp:141] Setting up conv5
I0913 21:12:20.145210 18047 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:12:20.145215 18047 net.cpp:156] Memory required for data: 65519160
I0913 21:12:20.145241 18047 layer_factory.hpp:77] Creating layer relu5
I0913 21:12:20.145254 18047 net.cpp:91] Creating Layer relu5
I0913 21:12:20.145261 18047 net.cpp:425] relu5 <- conv5
I0913 21:12:20.145267 18047 net.cpp:386] relu5 -> conv5 (in-place)
I0913 21:12:20.145643 18047 net.cpp:141] Setting up relu5
I0913 21:12:20.145656 18047 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:12:20.145661 18047 net.cpp:156] Memory required for data: 67249720
I0913 21:12:20.145666 18047 layer_factory.hpp:77] Creating layer pool5
I0913 21:12:20.145692 18047 net.cpp:91] Creating Layer pool5
I0913 21:12:20.145699 18047 net.cpp:425] pool5 <- conv5
I0913 21:12:20.145707 18047 net.cpp:399] pool5 -> pool5
I0913 21:12:20.145764 18047 net.cpp:141] Setting up pool5
I0913 21:12:20.145774 18047 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0913 21:12:20.145778 18047 net.cpp:156] Memory required for data: 67618360
I0913 21:12:20.145783 18047 layer_factory.hpp:77] Creating layer fc6
I0913 21:12:20.145797 18047 net.cpp:91] Creating Layer fc6
I0913 21:12:20.145802 18047 net.cpp:425] fc6 <- pool5
I0913 21:12:20.145808 18047 net.cpp:399] fc6 -> fc6
I0913 21:12:20.247007 18047 net.cpp:141] Setting up fc6
I0913 21:12:20.247067 18047 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:12:20.247073 18047 net.cpp:156] Memory required for data: 67782200
I0913 21:12:20.247089 18047 layer_factory.hpp:77] Creating layer relu6
I0913 21:12:20.247105 18047 net.cpp:91] Creating Layer relu6
I0913 21:12:20.247112 18047 net.cpp:425] relu6 <- fc6
I0913 21:12:20.247123 18047 net.cpp:386] relu6 -> fc6 (in-place)
I0913 21:12:20.247444 18047 net.cpp:141] Setting up relu6
I0913 21:12:20.247455 18047 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:12:20.247459 18047 net.cpp:156] Memory required for data: 67946040
I0913 21:12:20.247465 18047 layer_factory.hpp:77] Creating layer drop6
I0913 21:12:20.247478 18047 net.cpp:91] Creating Layer drop6
I0913 21:12:20.247484 18047 net.cpp:425] drop6 <- fc6
I0913 21:12:20.247490 18047 net.cpp:386] drop6 -> fc6 (in-place)
I0913 21:12:20.247540 18047 net.cpp:141] Setting up drop6
I0913 21:12:20.247548 18047 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:12:20.247553 18047 net.cpp:156] Memory required for data: 68109880
I0913 21:12:20.247584 18047 layer_factory.hpp:77] Creating layer fc7
I0913 21:12:20.247594 18047 net.cpp:91] Creating Layer fc7
I0913 21:12:20.247599 18047 net.cpp:425] fc7 <- fc6
I0913 21:12:20.247611 18047 net.cpp:399] fc7 -> fc7
I0913 21:12:20.280848 18037 net.cpp:141] Setting up embedding
I0913 21:12:20.280905 18037 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:12:20.280911 18037 net.cpp:156] Memory required for data: 22408
I0913 21:12:20.280930 18037 layer_factory.hpp:77] Creating layer lstm1
I0913 21:12:20.280953 18037 net.cpp:91] Creating Layer lstm1
I0913 21:12:20.280961 18037 net.cpp:425] lstm1 <- embedded_input_frames
I0913 21:12:20.280969 18037 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0913 21:12:20.280982 18037 net.cpp:399] lstm1 -> lstm1
I0913 21:12:20.281023 18037 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0913 21:12:20.281399 18037 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0913 21:12:20.281492 18037 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:12:20.281505 18037 net.cpp:91] Creating Layer lstm1_
I0913 21:12:20.281512 18037 net.cpp:399] lstm1_ -> x
I0913 21:12:20.281523 18037 net.cpp:399] lstm1_ -> cont
I0913 21:12:20.281584 18037 net.cpp:141] Setting up lstm1_
I0913 21:12:20.281594 18037 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:12:20.281600 18037 net.cpp:148] Top shape: 1 1 (1)
I0913 21:12:20.281605 18037 net.cpp:156] Memory required for data: 2004
I0913 21:12:20.281610 18037 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:12:20.281617 18037 net.cpp:91] Creating Layer lstm1_
I0913 21:12:20.281626 18037 net.cpp:399] lstm1_ -> c_0
I0913 21:12:20.281636 18037 net.cpp:399] lstm1_ -> h_0
I0913 21:12:20.281687 18037 net.cpp:141] Setting up lstm1_
I0913 21:12:20.281695 18037 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:12:20.281702 18037 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:12:20.281705 18037 net.cpp:156] Memory required for data: 10004
I0913 21:12:20.281709 18037 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0913 21:12:20.281718 18037 net.cpp:91] Creating Layer lstm1_cont_slice
I0913 21:12:20.281723 18037 net.cpp:425] lstm1_cont_slice <- cont
I0913 21:12:20.281733 18037 net.cpp:399] lstm1_cont_slice -> cont_1
I0913 21:12:20.281766 18037 net.cpp:141] Setting up lstm1_cont_slice
I0913 21:12:20.281774 18037 net.cpp:148] Top shape: 1 1 (1)
I0913 21:12:20.281780 18037 net.cpp:156] Memory required for data: 10008
I0913 21:12:20.281785 18037 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0913 21:12:20.281795 18037 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0913 21:12:20.281800 18037 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0913 21:12:20.281806 18037 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0913 21:12:20.281816 18037 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0913 21:12:20.281865 18037 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0913 21:12:20.281874 18037 net.cpp:148] Top shape: 1 1 (1)
I0913 21:12:20.281879 18037 net.cpp:148] Top shape: 1 1 (1)
I0913 21:12:20.281884 18037 net.cpp:156] Memory required for data: 10016
I0913 21:12:20.281888 18037 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0913 21:12:20.281898 18037 net.cpp:91] Creating Layer lstm1_x_transform
I0913 21:12:20.281903 18037 net.cpp:425] lstm1_x_transform <- x
I0913 21:12:20.281910 18037 net.cpp:399] lstm1_x_transform -> W_xc_x
I0913 21:12:20.292342 18047 net.cpp:141] Setting up fc7
I0913 21:12:20.292379 18047 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:12:20.292384 18047 net.cpp:156] Memory required for data: 68273720
I0913 21:12:20.292397 18047 layer_factory.hpp:77] Creating layer relu7
I0913 21:12:20.292434 18047 net.cpp:91] Creating Layer relu7
I0913 21:12:20.292443 18047 net.cpp:425] relu7 <- fc7
I0913 21:12:20.292453 18047 net.cpp:386] relu7 -> fc7 (in-place)
I0913 21:12:20.293128 18047 net.cpp:141] Setting up relu7
I0913 21:12:20.293141 18047 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:12:20.293145 18047 net.cpp:156] Memory required for data: 68437560
I0913 21:12:20.293151 18047 layer_factory.hpp:77] Creating layer drop7
I0913 21:12:20.293164 18047 net.cpp:91] Creating Layer drop7
I0913 21:12:20.293169 18047 net.cpp:425] drop7 <- fc7
I0913 21:12:20.293175 18047 net.cpp:386] drop7 -> fc7 (in-place)
I0913 21:12:20.293216 18047 net.cpp:141] Setting up drop7
I0913 21:12:20.293225 18047 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:12:20.293229 18047 net.cpp:156] Memory required for data: 68601400
I0913 21:12:20.293234 18047 layer_factory.hpp:77] Creating layer fc8
I0913 21:12:20.293243 18047 net.cpp:91] Creating Layer fc8
I0913 21:12:20.293248 18047 net.cpp:425] fc8 <- fc7
I0913 21:12:20.293257 18047 net.cpp:399] fc8 -> fc8
I0913 21:12:20.301224 18037 net.cpp:141] Setting up lstm1_x_transform
I0913 21:12:20.301276 18037 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:12:20.301282 18037 net.cpp:156] Memory required for data: 26016
I0913 21:12:20.301306 18037 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0913 21:12:20.301328 18037 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0913 21:12:20.301337 18037 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0913 21:12:20.301347 18037 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0913 21:12:20.301393 18037 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0913 21:12:20.301403 18037 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:12:20.301406 18037 net.cpp:156] Memory required for data: 42016
I0913 21:12:20.301411 18037 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0913 21:12:20.301424 18037 net.cpp:91] Creating Layer lstm1_h_conted_0
I0913 21:12:20.301429 18037 net.cpp:425] lstm1_h_conted_0 <- h_0
I0913 21:12:20.301435 18037 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0913 21:12:20.301442 18037 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0913 21:12:20.301529 18037 net.cpp:141] Setting up lstm1_h_conted_0
I0913 21:12:20.301538 18037 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:12:20.301543 18037 net.cpp:156] Memory required for data: 46016
I0913 21:12:20.301548 18037 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0913 21:12:20.301565 18037 net.cpp:91] Creating Layer lstm1_transform_1
I0913 21:12:20.301570 18037 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0913 21:12:20.301578 18037 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0913 21:12:20.309164 18047 net.cpp:141] Setting up fc8
I0913 21:12:20.309206 18047 net.cpp:148] Top shape: 10 1000 (10000)
I0913 21:12:20.309213 18047 net.cpp:156] Memory required for data: 68641400
I0913 21:12:20.309227 18047 layer_factory.hpp:77] Creating layer prob
I0913 21:12:20.309273 18047 net.cpp:91] Creating Layer prob
I0913 21:12:20.309283 18047 net.cpp:425] prob <- fc8
I0913 21:12:20.309291 18047 net.cpp:399] prob -> prob
I0913 21:12:20.309690 18047 net.cpp:141] Setting up prob
I0913 21:12:20.309705 18047 net.cpp:148] Top shape: 10 1000 (10000)
I0913 21:12:20.309710 18047 net.cpp:156] Memory required for data: 68681400
I0913 21:12:20.309715 18047 net.cpp:219] prob does not need backward computation.
I0913 21:12:20.309720 18047 net.cpp:219] fc8 does not need backward computation.
I0913 21:12:20.309725 18047 net.cpp:219] drop7 does not need backward computation.
I0913 21:12:20.309731 18047 net.cpp:219] relu7 does not need backward computation.
I0913 21:12:20.309734 18047 net.cpp:219] fc7 does not need backward computation.
I0913 21:12:20.309739 18047 net.cpp:219] drop6 does not need backward computation.
I0913 21:12:20.309744 18047 net.cpp:219] relu6 does not need backward computation.
I0913 21:12:20.309748 18047 net.cpp:219] fc6 does not need backward computation.
I0913 21:12:20.309753 18047 net.cpp:219] pool5 does not need backward computation.
I0913 21:12:20.309758 18047 net.cpp:219] relu5 does not need backward computation.
I0913 21:12:20.309762 18047 net.cpp:219] conv5 does not need backward computation.
I0913 21:12:20.309768 18047 net.cpp:219] relu4 does not need backward computation.
I0913 21:12:20.309772 18047 net.cpp:219] conv4 does not need backward computation.
I0913 21:12:20.309777 18047 net.cpp:219] relu3 does not need backward computation.
I0913 21:12:20.309782 18047 net.cpp:219] conv3 does not need backward computation.
I0913 21:12:20.309787 18047 net.cpp:219] norm2 does not need backward computation.
I0913 21:12:20.309792 18047 net.cpp:219] pool2 does not need backward computation.
I0913 21:12:20.309795 18047 net.cpp:219] relu2 does not need backward computation.
I0913 21:12:20.309800 18047 net.cpp:219] conv2 does not need backward computation.
I0913 21:12:20.309804 18047 net.cpp:219] norm1 does not need backward computation.
I0913 21:12:20.309809 18047 net.cpp:219] pool1 does not need backward computation.
I0913 21:12:20.309814 18047 net.cpp:219] relu1 does not need backward computation.
I0913 21:12:20.309818 18047 net.cpp:219] conv1 does not need backward computation.
I0913 21:12:20.309823 18047 net.cpp:219] data does not need backward computation.
I0913 21:12:20.309828 18047 net.cpp:261] This network produces output prob
I0913 21:12:20.309847 18047 net.cpp:274] Network initialization done.
I0913 21:12:20.339375 18037 net.cpp:141] Setting up lstm1_transform_1
I0913 21:12:20.339426 18037 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:12:20.339433 18037 net.cpp:156] Memory required for data: 62016
I0913 21:12:20.339454 18037 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0913 21:12:20.339480 18037 net.cpp:91] Creating Layer lstm1_gate_input_1
I0913 21:12:20.339488 18037 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0913 21:12:20.339498 18037 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0913 21:12:20.339505 18037 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0913 21:12:20.339565 18037 net.cpp:141] Setting up lstm1_gate_input_1
I0913 21:12:20.339575 18037 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:12:20.339578 18037 net.cpp:156] Memory required for data: 78016
I0913 21:12:20.339583 18037 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0913 21:12:20.339592 18037 net.cpp:91] Creating Layer lstm1_unit_1
I0913 21:12:20.339597 18037 net.cpp:425] lstm1_unit_1 <- c_0
I0913 21:12:20.339606 18037 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0913 21:12:20.339612 18037 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0913 21:12:20.339618 18037 net.cpp:399] lstm1_unit_1 -> c_1
I0913 21:12:20.339627 18037 net.cpp:399] lstm1_unit_1 -> h_1
I0913 21:12:20.339689 18037 net.cpp:141] Setting up lstm1_unit_1
I0913 21:12:20.339697 18037 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:12:20.339704 18037 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:12:20.339707 18037 net.cpp:156] Memory required for data: 86016
I0913 21:12:20.339712 18037 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:12:20.339720 18037 net.cpp:91] Creating Layer lstm1_
I0913 21:12:20.339725 18037 net.cpp:425] lstm1_ <- c_1
I0913 21:12:20.339731 18037 net.cpp:399] lstm1_ -> c_T
I0913 21:12:20.339766 18037 net.cpp:141] Setting up lstm1_
I0913 21:12:20.339774 18037 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:12:20.339778 18037 net.cpp:156] Memory required for data: 90016
I0913 21:12:20.339783 18037 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0913 21:12:20.339793 18037 net.cpp:91] Creating Layer lstm1_h_concat
I0913 21:12:20.339798 18037 net.cpp:425] lstm1_h_concat <- h_1
I0913 21:12:20.339805 18037 net.cpp:399] lstm1_h_concat -> h
I0913 21:12:20.339856 18037 net.cpp:141] Setting up lstm1_h_concat
I0913 21:12:20.339864 18037 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:12:20.339869 18037 net.cpp:156] Memory required for data: 94016
I0913 21:12:20.339874 18037 layer_factory.hpp:77] Creating layer h_pseudoloss
I0913 21:12:20.339891 18037 net.cpp:91] Creating Layer h_pseudoloss
I0913 21:12:20.339896 18037 net.cpp:425] h_pseudoloss <- h
I0913 21:12:20.339902 18037 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0913 21:12:20.340260 18037 net.cpp:141] Setting up h_pseudoloss
I0913 21:12:20.340272 18037 net.cpp:148] Top shape: (1)
I0913 21:12:20.340277 18037 net.cpp:151]     with loss weight 1
I0913 21:12:20.340314 18037 net.cpp:156] Memory required for data: 94020
I0913 21:12:20.340320 18037 net.cpp:217] h_pseudoloss needs backward computation.
I0913 21:12:20.340324 18037 net.cpp:217] lstm1_h_concat needs backward computation.
I0913 21:12:20.340329 18037 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:12:20.340334 18037 net.cpp:217] lstm1_unit_1 needs backward computation.
I0913 21:12:20.340340 18037 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0913 21:12:20.340345 18037 net.cpp:217] lstm1_transform_1 needs backward computation.
I0913 21:12:20.340349 18037 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0913 21:12:20.340358 18037 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0913 21:12:20.340363 18037 net.cpp:217] lstm1_x_transform needs backward computation.
I0913 21:12:20.340368 18037 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0913 21:12:20.340374 18037 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0913 21:12:20.340379 18037 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:12:20.340384 18037 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:12:20.340387 18037 net.cpp:261] This network produces output c_T
I0913 21:12:20.340392 18037 net.cpp:261] This network produces output h_pseudoloss
I0913 21:12:20.340406 18037 net.cpp:274] Network initialization done.
I0913 21:12:20.340459 18037 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0913 21:12:20.340466 18037 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0913 21:12:20.340469 18037 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0913 21:12:20.340586 18037 net.cpp:141] Setting up lstm1
I0913 21:12:20.340600 18037 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:12:20.340603 18037 net.cpp:156] Memory required for data: 26408
I0913 21:12:20.340616 18037 layer_factory.hpp:77] Creating layer concat
I0913 21:12:20.340628 18037 net.cpp:91] Creating Layer concat
I0913 21:12:20.340636 18037 net.cpp:425] concat <- lstm1
I0913 21:12:20.340642 18037 net.cpp:425] concat <- embedded_input_sentence
I0913 21:12:20.340647 18037 net.cpp:425] concat <- reshaped_stage_indicator
I0913 21:12:20.340654 18037 net.cpp:399] concat -> lstm1_video_sequence
I0913 21:12:20.340687 18037 net.cpp:141] Setting up concat
I0913 21:12:20.340695 18037 net.cpp:148] Top shape: 1 1 1501 (1501)
I0913 21:12:20.340699 18037 net.cpp:156] Memory required for data: 32412
I0913 21:12:20.340704 18037 layer_factory.hpp:77] Creating layer lstm2
I0913 21:12:20.340716 18037 net.cpp:91] Creating Layer lstm2
I0913 21:12:20.340723 18037 net.cpp:425] lstm2 <- lstm1_video_sequence
I0913 21:12:20.340728 18037 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0913 21:12:20.340734 18037 net.cpp:399] lstm2 -> lstm2
I0913 21:12:20.340745 18037 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0913 21:12:20.341001 18037 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0913 21:12:20.341087 18037 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:12:20.341099 18037 net.cpp:91] Creating Layer lstm2_
I0913 21:12:20.341105 18037 net.cpp:399] lstm2_ -> x
I0913 21:12:20.341116 18037 net.cpp:399] lstm2_ -> cont
I0913 21:12:20.341166 18037 net.cpp:141] Setting up lstm2_
I0913 21:12:20.341176 18037 net.cpp:148] Top shape: 1 1 1501 (1501)
I0913 21:12:20.341181 18037 net.cpp:148] Top shape: 1 1 (1)
I0913 21:12:20.341186 18037 net.cpp:156] Memory required for data: 6008
I0913 21:12:20.341190 18037 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:12:20.341198 18037 net.cpp:91] Creating Layer lstm2_
I0913 21:12:20.341207 18037 net.cpp:399] lstm2_ -> c_0
I0913 21:12:20.341217 18037 net.cpp:399] lstm2_ -> h_0
I0913 21:12:20.341269 18037 net.cpp:141] Setting up lstm2_
I0913 21:12:20.341279 18037 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:12:20.341284 18037 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:12:20.341287 18037 net.cpp:156] Memory required for data: 14008
I0913 21:12:20.341292 18037 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0913 21:12:20.341300 18037 net.cpp:91] Creating Layer lstm2_cont_slice
I0913 21:12:20.341305 18037 net.cpp:425] lstm2_cont_slice <- cont
I0913 21:12:20.341312 18037 net.cpp:399] lstm2_cont_slice -> cont_1
I0913 21:12:20.341342 18037 net.cpp:141] Setting up lstm2_cont_slice
I0913 21:12:20.341351 18037 net.cpp:148] Top shape: 1 1 (1)
I0913 21:12:20.341356 18037 net.cpp:156] Memory required for data: 14012
I0913 21:12:20.341361 18037 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0913 21:12:20.341370 18037 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0913 21:12:20.341375 18037 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0913 21:12:20.341382 18037 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0913 21:12:20.341392 18037 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0913 21:12:20.341436 18037 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0913 21:12:20.341444 18037 net.cpp:148] Top shape: 1 1 (1)
I0913 21:12:20.341450 18037 net.cpp:148] Top shape: 1 1 (1)
I0913 21:12:20.341454 18037 net.cpp:156] Memory required for data: 14020
I0913 21:12:20.341459 18037 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0913 21:12:20.341470 18037 net.cpp:91] Creating Layer lstm2_x_transform
I0913 21:12:20.341475 18037 net.cpp:425] lstm2_x_transform <- x
I0913 21:12:20.341482 18037 net.cpp:399] lstm2_x_transform -> W_xc_x
I0913 21:12:20.398602 18037 net.cpp:141] Setting up lstm2_x_transform
I0913 21:12:20.398656 18037 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:12:20.398663 18037 net.cpp:156] Memory required for data: 30020
I0913 21:12:20.398689 18037 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0913 21:12:20.398708 18037 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0913 21:12:20.398716 18037 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0913 21:12:20.398726 18037 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0913 21:12:20.398778 18037 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0913 21:12:20.398787 18037 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:12:20.398792 18037 net.cpp:156] Memory required for data: 46020
I0913 21:12:20.398797 18037 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0913 21:12:20.398808 18037 net.cpp:91] Creating Layer lstm2_h_conted_0
I0913 21:12:20.398813 18037 net.cpp:425] lstm2_h_conted_0 <- h_0
I0913 21:12:20.398818 18037 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0913 21:12:20.398825 18037 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0913 21:12:20.398919 18037 net.cpp:141] Setting up lstm2_h_conted_0
I0913 21:12:20.398928 18037 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:12:20.398932 18037 net.cpp:156] Memory required for data: 50020
I0913 21:12:20.398937 18037 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0913 21:12:20.398950 18037 net.cpp:91] Creating Layer lstm2_transform_1
I0913 21:12:20.398955 18037 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0913 21:12:20.398963 18037 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0913 21:12:20.436787 18037 net.cpp:141] Setting up lstm2_transform_1
I0913 21:12:20.436841 18037 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:12:20.436847 18037 net.cpp:156] Memory required for data: 66020
I0913 21:12:20.436868 18037 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0913 21:12:20.436892 18037 net.cpp:91] Creating Layer lstm2_gate_input_1
I0913 21:12:20.436899 18037 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0913 21:12:20.436908 18037 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0913 21:12:20.436918 18037 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0913 21:12:20.436965 18037 net.cpp:141] Setting up lstm2_gate_input_1
I0913 21:12:20.436978 18037 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:12:20.436982 18037 net.cpp:156] Memory required for data: 82020
I0913 21:12:20.436987 18037 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0913 21:12:20.436996 18037 net.cpp:91] Creating Layer lstm2_unit_1
I0913 21:12:20.437001 18037 net.cpp:425] lstm2_unit_1 <- c_0
I0913 21:12:20.437006 18037 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0913 21:12:20.437012 18037 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0913 21:12:20.437018 18037 net.cpp:399] lstm2_unit_1 -> c_1
I0913 21:12:20.437026 18037 net.cpp:399] lstm2_unit_1 -> h_1
I0913 21:12:20.437086 18037 net.cpp:141] Setting up lstm2_unit_1
I0913 21:12:20.437095 18037 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:12:20.437101 18037 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:12:20.437105 18037 net.cpp:156] Memory required for data: 90020
I0913 21:12:20.437109 18037 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:12:20.437119 18037 net.cpp:91] Creating Layer lstm2_
I0913 21:12:20.437124 18037 net.cpp:425] lstm2_ <- c_1
I0913 21:12:20.437129 18037 net.cpp:399] lstm2_ -> c_T
I0913 21:12:20.437158 18037 net.cpp:141] Setting up lstm2_
I0913 21:12:20.437166 18037 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:12:20.437171 18037 net.cpp:156] Memory required for data: 94020
I0913 21:12:20.437175 18037 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0913 21:12:20.437188 18037 net.cpp:91] Creating Layer lstm2_h_concat
I0913 21:12:20.437193 18037 net.cpp:425] lstm2_h_concat <- h_1
I0913 21:12:20.437201 18037 net.cpp:399] lstm2_h_concat -> h
I0913 21:12:20.437237 18037 net.cpp:141] Setting up lstm2_h_concat
I0913 21:12:20.437244 18037 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:12:20.437249 18037 net.cpp:156] Memory required for data: 98020
I0913 21:12:20.437253 18037 layer_factory.hpp:77] Creating layer h_pseudoloss
I0913 21:12:20.437263 18037 net.cpp:91] Creating Layer h_pseudoloss
I0913 21:12:20.437268 18037 net.cpp:425] h_pseudoloss <- h
I0913 21:12:20.437278 18037 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0913 21:12:20.437366 18037 net.cpp:141] Setting up h_pseudoloss
I0913 21:12:20.437376 18037 net.cpp:148] Top shape: (1)
I0913 21:12:20.437379 18037 net.cpp:151]     with loss weight 1
I0913 21:12:20.437402 18037 net.cpp:156] Memory required for data: 98024
I0913 21:12:20.437408 18037 net.cpp:217] h_pseudoloss needs backward computation.
I0913 21:12:20.437412 18037 net.cpp:217] lstm2_h_concat needs backward computation.
I0913 21:12:20.437417 18037 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:12:20.437422 18037 net.cpp:217] lstm2_unit_1 needs backward computation.
I0913 21:12:20.437427 18037 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0913 21:12:20.437433 18037 net.cpp:217] lstm2_transform_1 needs backward computation.
I0913 21:12:20.437438 18037 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0913 21:12:20.437443 18037 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0913 21:12:20.437448 18037 net.cpp:217] lstm2_x_transform needs backward computation.
I0913 21:12:20.437453 18037 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0913 21:12:20.437458 18037 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0913 21:12:20.437463 18037 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:12:20.437468 18037 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:12:20.437471 18037 net.cpp:261] This network produces output c_T
I0913 21:12:20.437475 18037 net.cpp:261] This network produces output h_pseudoloss
I0913 21:12:20.437492 18037 net.cpp:274] Network initialization done.
I0913 21:12:20.437541 18037 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0913 21:12:20.437546 18037 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0913 21:12:20.437551 18037 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0913 21:12:20.437647 18037 net.cpp:141] Setting up lstm2
I0913 21:12:20.437659 18037 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:12:20.437664 18037 net.cpp:156] Memory required for data: 36412
I0913 21:12:20.437676 18037 layer_factory.hpp:77] Creating layer predict
I0913 21:12:20.437690 18037 net.cpp:91] Creating Layer predict
I0913 21:12:20.437696 18037 net.cpp:425] predict <- lstm2
I0913 21:12:20.437703 18037 net.cpp:399] predict -> predict
I0913 21:12:20.586908 18047 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /home/peifeng/work/run/storm102/data/workers/3acea4ca-d4b8-4d7b-9681-0542def7d4e6/tmp/cvld4291719538085398960/bvlc_reference_caffenet.caffemodel
I0913 21:12:20.586947 18047 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0913 21:12:20.586954 18047 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0913 21:12:20.586958 18047 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /home/peifeng/work/run/storm102/data/workers/3acea4ca-d4b8-4d7b-9681-0542def7d4e6/tmp/cvld4291719538085398960/bvlc_reference_caffenet.caffemodel
I0913 21:12:20.864409 18037 net.cpp:141] Setting up predict
I0913 21:12:20.864466 18037 net.cpp:148] Top shape: 1 1 46168 (46168)
I0913 21:12:20.864473 18037 net.cpp:156] Memory required for data: 221084
I0913 21:12:20.864488 18037 layer_factory.hpp:77] Creating layer probs
I0913 21:12:20.864509 18037 net.cpp:91] Creating Layer probs
I0913 21:12:20.864517 18037 net.cpp:425] probs <- predict
I0913 21:12:20.864531 18037 net.cpp:399] probs -> probs
I0913 21:12:20.865381 18037 net.cpp:141] Setting up probs
I0913 21:12:20.865396 18037 net.cpp:148] Top shape: 1 1 46168 (46168)
I0913 21:12:20.865401 18037 net.cpp:156] Memory required for data: 405756
I0913 21:12:20.865406 18037 net.cpp:219] probs does not need backward computation.
I0913 21:12:20.865411 18037 net.cpp:219] predict does not need backward computation.
I0913 21:12:20.865416 18037 net.cpp:219] lstm2 does not need backward computation.
I0913 21:12:20.865422 18037 net.cpp:219] concat does not need backward computation.
I0913 21:12:20.865428 18037 net.cpp:219] lstm1 does not need backward computation.
I0913 21:12:20.865434 18037 net.cpp:219] embedding does not need backward computation.
I0913 21:12:20.865439 18037 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0913 21:12:20.865444 18037 net.cpp:219] reshape_frames does not need backward computation.
I0913 21:12:20.865449 18037 net.cpp:219] embed_encoder does not need backward computation.
I0913 21:12:20.865454 18037 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0913 21:12:20.865460 18037 net.cpp:219] input does not need backward computation.
I0913 21:12:20.865464 18037 net.cpp:261] This network produces output probs
I0913 21:12:20.865478 18037 net.cpp:274] Network initialization done.
I0913 21:12:20.942004 18047 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0913 21:12:20.989135 18047 net.cpp:752] Ignoring source layer loss
Loading the model + trained: 10046.1ms
Using cv::Size and some other stuff: 0.246ms
I0913 21:12:21.230121 18037 net.cpp:752] Ignoring source layer data
I0913 21:12:21.230176 18037 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0913 21:12:21.230181 18037 net.cpp:752] Ignoring source layer reshape_stg_indicator
Loading the mean file: 1569.69ms
I0913 21:12:21.297796 18037 net.cpp:752] Ignoring source layer cross_entropy_loss
TIMERTIMER 125664052
TIMERTIMER 66701762
TIMERTIMER 66906603
TIMERTIMER 44111675
TIMERTIMER 47588135
TIMERTIMER 45756109
TIMERTIMER 48820949
TIMERTIMER 36766444
TIMERTIMER 48946188
TIMERTIMER 48323787
TIMERTIMER 43626968
TIMERTIMER 48560139
TIMERTIMER 48158648
TIMERTIMER 51720274
TIMERTIMER 53316722
TIMERTIMER 48658316
TIMERTIMER 48979055
TIMERTIMER 46332293
TIMERTIMER 48682711
TIMERTIMER 47287148
TIMERTIMER 37359239
TIMERTIMER 36460770
TIMERTIMER 37611710
TIMERTIMER 31987995
TIMERTIMER 31607895
TIMERTIMER 33344676
TIMERTIMER 31704558
TIMERTIMER 39697541
TIMERTIMER 33286330
TIMERTIMER 38356494
TIMERTIMER 34298801
TIMERTIMER 33574599
TIMERTIMER 31762953
TIMERTIMER 38571200
TIMERTIMER 38141116
TIMERTIMER 39658158
TIMERTIMER 35508817
TIMERTIMER 37704828
TIMERTIMER 40866997
TIMERTIMER 31742609
TIMERTIMER 31375196
TIMERTIMER 37650375
TIMERTIMER 37954776
TIMERTIMER 31573262
TIMERTIMER 37980714
TIMERTIMER 37663652
#
# A fatal error has been detected by the Java Runtime Environment:
#
#  SIGSEGV (0xb) at pc=0x00007fefc1dddee0, pid=17970, tid=140666408486656
#
# JRE version: Java(TM) SE Runtime Environment (8.0_77-b03) (build 1.8.0_77-b03)
# Java VM: Java HotSpot(TM) 64-Bit Server VM (25.77-b03 mixed mode linux-amd64 compressed oops)
# Problematic frame:
# C  [libc.so.6+0x97ee0]
#
# Failed to write core dump. Core dumps have been disabled. To enable core dumping, try "ulimit -c unlimited" before starting Java again
#
# An error report file with more information is saved as:
# /home/peifeng/work/run/storm102/data/workers/3acea4ca-d4b8-4d7b-9681-0542def7d4e6/hs_err_pid17970.log
#
# If you would like to submit a bug report, please visit:
#   http://bugreport.java.com/bugreport/crash.jsp
# The crash happened outside the Java Virtual Machine in native code.
# See problematic frame for where to report the bug.
#
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/peifeng/tools/storm102/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/peifeng/work/run/storm102/data/supervisor/stormdist/captioning-1-1473815501/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /home/peifeng/work/run/storm102/data/workers/88571941-824c-4ddf-9427-847c913aa6a9/tmp/cvld5607761228221289628/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0913 21:13:01.842521 18192 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0913 21:13:01.842720 18192 layer_factory.hpp:77] Creating layer data
I0913 21:13:01.842746 18192 net.cpp:91] Creating Layer data
I0913 21:13:01.842756 18192 net.cpp:399] data -> data
I0913 21:13:02.365111 18192 net.cpp:141] Setting up data
I0913 21:13:02.365216 18192 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0913 21:13:02.365224 18192 net.cpp:156] Memory required for data: 6183480
I0913 21:13:02.365242 18192 layer_factory.hpp:77] Creating layer conv1
I0913 21:13:02.365272 18192 net.cpp:91] Creating Layer conv1
I0913 21:13:02.365279 18192 net.cpp:425] conv1 <- data
I0913 21:13:02.365291 18192 net.cpp:399] conv1 -> conv1
I0913 21:13:02.553849 18192 net.cpp:141] Setting up conv1
I0913 21:13:02.553901 18192 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0913 21:13:02.553908 18192 net.cpp:156] Memory required for data: 17799480
I0913 21:13:02.553939 18192 layer_factory.hpp:77] Creating layer relu1
I0913 21:13:02.553961 18192 net.cpp:91] Creating Layer relu1
I0913 21:13:02.553966 18192 net.cpp:425] relu1 <- conv1
I0913 21:13:02.553974 18192 net.cpp:386] relu1 -> conv1 (in-place)
I0913 21:13:02.554407 18192 net.cpp:141] Setting up relu1
I0913 21:13:02.554420 18192 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0913 21:13:02.554425 18192 net.cpp:156] Memory required for data: 29415480
I0913 21:13:02.554430 18192 layer_factory.hpp:77] Creating layer pool1
I0913 21:13:02.554443 18192 net.cpp:91] Creating Layer pool1
I0913 21:13:02.554448 18192 net.cpp:425] pool1 <- conv1
I0913 21:13:02.554455 18192 net.cpp:399] pool1 -> pool1
I0913 21:13:02.554533 18192 net.cpp:141] Setting up pool1
I0913 21:13:02.554543 18192 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0913 21:13:02.554548 18192 net.cpp:156] Memory required for data: 32214840
I0913 21:13:02.554551 18192 layer_factory.hpp:77] Creating layer norm1
I0913 21:13:02.554571 18192 net.cpp:91] Creating Layer norm1
I0913 21:13:02.554576 18192 net.cpp:425] norm1 <- pool1
I0913 21:13:02.554585 18192 net.cpp:399] norm1 -> norm1
I0913 21:13:02.554865 18192 net.cpp:141] Setting up norm1
I0913 21:13:02.554877 18192 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0913 21:13:02.554883 18192 net.cpp:156] Memory required for data: 35014200
I0913 21:13:02.554888 18192 layer_factory.hpp:77] Creating layer conv2
I0913 21:13:02.554905 18192 net.cpp:91] Creating Layer conv2
I0913 21:13:02.554910 18192 net.cpp:425] conv2 <- norm1
I0913 21:13:02.554920 18192 net.cpp:399] conv2 -> conv2
I0913 21:13:02.558962 18192 net.cpp:141] Setting up conv2
I0913 21:13:02.558997 18192 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0913 21:13:02.559006 18192 net.cpp:156] Memory required for data: 42479160
I0913 21:13:02.559026 18192 layer_factory.hpp:77] Creating layer relu2
I0913 21:13:02.559046 18192 net.cpp:91] Creating Layer relu2
I0913 21:13:02.559056 18192 net.cpp:425] relu2 <- conv2
I0913 21:13:02.559067 18192 net.cpp:386] relu2 -> conv2 (in-place)
I0913 21:13:02.559628 18192 net.cpp:141] Setting up relu2
I0913 21:13:02.559645 18192 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0913 21:13:02.559650 18192 net.cpp:156] Memory required for data: 49944120
I0913 21:13:02.559656 18192 layer_factory.hpp:77] Creating layer pool2
I0913 21:13:02.559666 18192 net.cpp:91] Creating Layer pool2
I0913 21:13:02.559671 18192 net.cpp:425] pool2 <- conv2
I0913 21:13:02.559681 18192 net.cpp:399] pool2 -> pool2
I0913 21:13:02.559742 18192 net.cpp:141] Setting up pool2
I0913 21:13:02.559754 18192 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:13:02.559759 18192 net.cpp:156] Memory required for data: 51674680
I0913 21:13:02.559764 18192 layer_factory.hpp:77] Creating layer norm2
I0913 21:13:02.559777 18192 net.cpp:91] Creating Layer norm2
I0913 21:13:02.559782 18192 net.cpp:425] norm2 <- pool2
I0913 21:13:02.559794 18192 net.cpp:399] norm2 -> norm2
I0913 21:13:02.560048 18192 net.cpp:141] Setting up norm2
I0913 21:13:02.560060 18192 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:13:02.560065 18192 net.cpp:156] Memory required for data: 53405240
I0913 21:13:02.560078 18192 layer_factory.hpp:77] Creating layer conv3
I0913 21:13:02.560098 18192 net.cpp:91] Creating Layer conv3
I0913 21:13:02.560107 18192 net.cpp:425] conv3 <- norm2
I0913 21:13:02.560124 18192 net.cpp:399] conv3 -> conv3
I0913 21:13:02.563835 18192 net.cpp:141] Setting up conv3
I0913 21:13:02.563860 18192 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:13:02.563866 18192 net.cpp:156] Memory required for data: 56001080
I0913 21:13:02.563881 18192 layer_factory.hpp:77] Creating layer relu3
I0913 21:13:02.563895 18192 net.cpp:91] Creating Layer relu3
I0913 21:13:02.563900 18192 net.cpp:425] relu3 <- conv3
I0913 21:13:02.563907 18192 net.cpp:386] relu3 -> conv3 (in-place)
I0913 21:13:02.564144 18192 net.cpp:141] Setting up relu3
I0913 21:13:02.564157 18192 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:13:02.564160 18192 net.cpp:156] Memory required for data: 58596920
I0913 21:13:02.564165 18192 layer_factory.hpp:77] Creating layer conv4
I0913 21:13:02.564179 18192 net.cpp:91] Creating Layer conv4
I0913 21:13:02.564184 18192 net.cpp:425] conv4 <- conv3
I0913 21:13:02.564193 18192 net.cpp:399] conv4 -> conv4
I0913 21:13:02.568234 18192 net.cpp:141] Setting up conv4
I0913 21:13:02.568258 18192 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:13:02.568264 18192 net.cpp:156] Memory required for data: 61192760
I0913 21:13:02.568271 18192 layer_factory.hpp:77] Creating layer relu4
I0913 21:13:02.568281 18192 net.cpp:91] Creating Layer relu4
I0913 21:13:02.568286 18192 net.cpp:425] relu4 <- conv4
I0913 21:13:02.568297 18192 net.cpp:386] relu4 -> conv4 (in-place)
I0913 21:13:02.568686 18192 net.cpp:141] Setting up relu4
I0913 21:13:02.568698 18192 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:13:02.568702 18192 net.cpp:156] Memory required for data: 63788600
I0913 21:13:02.568707 18192 layer_factory.hpp:77] Creating layer conv5
I0913 21:13:02.568722 18192 net.cpp:91] Creating Layer conv5
I0913 21:13:02.568727 18192 net.cpp:425] conv5 <- conv4
I0913 21:13:02.568737 18192 net.cpp:399] conv5 -> conv5
I0913 21:13:02.572398 18192 net.cpp:141] Setting up conv5
I0913 21:13:02.572422 18192 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:13:02.572428 18192 net.cpp:156] Memory required for data: 65519160
I0913 21:13:02.572443 18192 layer_factory.hpp:77] Creating layer relu5
I0913 21:13:02.572453 18192 net.cpp:91] Creating Layer relu5
I0913 21:13:02.572458 18192 net.cpp:425] relu5 <- conv5
I0913 21:13:02.572468 18192 net.cpp:386] relu5 -> conv5 (in-place)
I0913 21:13:02.572873 18192 net.cpp:141] Setting up relu5
I0913 21:13:02.572886 18192 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:13:02.572891 18192 net.cpp:156] Memory required for data: 67249720
I0913 21:13:02.572896 18192 layer_factory.hpp:77] Creating layer pool5
I0913 21:13:02.572909 18192 net.cpp:91] Creating Layer pool5
I0913 21:13:02.572916 18192 net.cpp:425] pool5 <- conv5
I0913 21:13:02.572922 18192 net.cpp:399] pool5 -> pool5
I0913 21:13:02.572986 18192 net.cpp:141] Setting up pool5
I0913 21:13:02.572995 18192 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0913 21:13:02.573000 18192 net.cpp:156] Memory required for data: 67618360
I0913 21:13:02.573004 18192 layer_factory.hpp:77] Creating layer fc6
I0913 21:13:02.573029 18192 net.cpp:91] Creating Layer fc6
I0913 21:13:02.573035 18192 net.cpp:425] fc6 <- pool5
I0913 21:13:02.573042 18192 net.cpp:399] fc6 -> fc6
I0913 21:13:02.664337 18182 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/88571941-824c-4ddf-9427-847c913aa6a9/tmp/cvld5607761228221289628/s2vt.words_to_preds.prototxt
I0913 21:13:02.664423 18182 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0913 21:13:02.664449 18182 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0913 21:13:02.664855 18182 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0913 21:13:02.664994 18182 layer_factory.hpp:77] Creating layer input
I0913 21:13:02.665021 18182 net.cpp:91] Creating Layer input
I0913 21:13:02.665035 18182 net.cpp:399] input -> frames_fc7
I0913 21:13:02.665066 18182 net.cpp:399] input -> cont_sentence
I0913 21:13:02.665091 18182 net.cpp:399] input -> input_sentence
I0913 21:13:02.665107 18182 net.cpp:399] input -> stage_indicator
I0913 21:13:02.665339 18182 net.cpp:141] Setting up input
I0913 21:13:02.665357 18182 net.cpp:148] Top shape: 1 4096 (4096)
I0913 21:13:02.665371 18182 net.cpp:148] Top shape: 1 1 (1)
I0913 21:13:02.665380 18182 net.cpp:148] Top shape: 1 1 (1)
I0913 21:13:02.665390 18182 net.cpp:148] Top shape: 1 1 (1)
I0913 21:13:02.665395 18182 net.cpp:156] Memory required for data: 16396
I0913 21:13:02.665405 18182 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0913 21:13:02.665442 18182 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0913 21:13:02.665458 18182 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0913 21:13:02.665491 18182 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0913 21:13:02.665508 18182 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0913 21:13:02.665586 18182 net.cpp:141] Setting up cont_sentence_input_1_split
I0913 21:13:02.665616 18182 net.cpp:148] Top shape: 1 1 (1)
I0913 21:13:02.665627 18182 net.cpp:148] Top shape: 1 1 (1)
I0913 21:13:02.665648 18182 net.cpp:156] Memory required for data: 16404
I0913 21:13:02.665657 18182 layer_factory.hpp:77] Creating layer embed_encoder
I0913 21:13:02.665673 18182 net.cpp:91] Creating Layer embed_encoder
I0913 21:13:02.665683 18182 net.cpp:425] embed_encoder <- frames_fc7
I0913 21:13:02.665696 18182 net.cpp:399] embed_encoder -> embedded_in_frames
I0913 21:13:02.684229 18192 net.cpp:141] Setting up fc6
I0913 21:13:02.684274 18192 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:13:02.684280 18192 net.cpp:156] Memory required for data: 67782200
I0913 21:13:02.684295 18192 layer_factory.hpp:77] Creating layer relu6
I0913 21:13:02.684331 18192 net.cpp:91] Creating Layer relu6
I0913 21:13:02.684339 18192 net.cpp:425] relu6 <- fc6
I0913 21:13:02.684348 18192 net.cpp:386] relu6 -> fc6 (in-place)
I0913 21:13:02.684710 18192 net.cpp:141] Setting up relu6
I0913 21:13:02.684721 18192 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:13:02.684726 18192 net.cpp:156] Memory required for data: 67946040
I0913 21:13:02.684732 18192 layer_factory.hpp:77] Creating layer drop6
I0913 21:13:02.684754 18192 net.cpp:91] Creating Layer drop6
I0913 21:13:02.684759 18192 net.cpp:425] drop6 <- fc6
I0913 21:13:02.684779 18192 net.cpp:386] drop6 -> fc6 (in-place)
I0913 21:13:02.684830 18192 net.cpp:141] Setting up drop6
I0913 21:13:02.684842 18192 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:13:02.684847 18192 net.cpp:156] Memory required for data: 68109880
I0913 21:13:02.684852 18192 layer_factory.hpp:77] Creating layer fc7
I0913 21:13:02.684864 18192 net.cpp:91] Creating Layer fc7
I0913 21:13:02.684869 18192 net.cpp:425] fc7 <- fc6
I0913 21:13:02.684875 18192 net.cpp:399] fc7 -> fc7
I0913 21:13:02.713853 18182 net.cpp:141] Setting up embed_encoder
I0913 21:13:02.713907 18182 net.cpp:148] Top shape: 1 500 (500)
I0913 21:13:02.713915 18182 net.cpp:156] Memory required for data: 18404
I0913 21:13:02.713943 18182 layer_factory.hpp:77] Creating layer reshape_frames
I0913 21:13:02.713969 18182 net.cpp:91] Creating Layer reshape_frames
I0913 21:13:02.713980 18182 net.cpp:425] reshape_frames <- embedded_in_frames
I0913 21:13:02.713995 18182 net.cpp:399] reshape_frames -> embedded_input_frames
I0913 21:13:02.714085 18182 net.cpp:141] Setting up reshape_frames
I0913 21:13:02.714100 18182 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:13:02.714107 18182 net.cpp:156] Memory required for data: 20404
I0913 21:13:02.714114 18182 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0913 21:13:02.714133 18182 net.cpp:91] Creating Layer reshape_stage_indicator
I0913 21:13:02.714141 18182 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0913 21:13:02.714154 18182 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0913 21:13:02.714208 18182 net.cpp:141] Setting up reshape_stage_indicator
I0913 21:13:02.714221 18182 net.cpp:148] Top shape: 1 1 1 (1)
I0913 21:13:02.714228 18182 net.cpp:156] Memory required for data: 20408
I0913 21:13:02.714236 18182 layer_factory.hpp:77] Creating layer embedding
I0913 21:13:02.714257 18182 net.cpp:91] Creating Layer embedding
I0913 21:13:02.714265 18182 net.cpp:425] embedding <- input_sentence
I0913 21:13:02.714278 18182 net.cpp:399] embedding -> embedded_input_sentence
I0913 21:13:02.767148 18192 net.cpp:141] Setting up fc7
I0913 21:13:02.767199 18192 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:13:02.767205 18192 net.cpp:156] Memory required for data: 68273720
I0913 21:13:02.767221 18192 layer_factory.hpp:77] Creating layer relu7
I0913 21:13:02.767241 18192 net.cpp:91] Creating Layer relu7
I0913 21:13:02.767249 18192 net.cpp:425] relu7 <- fc7
I0913 21:13:02.767267 18192 net.cpp:386] relu7 -> fc7 (in-place)
I0913 21:13:02.767891 18192 net.cpp:141] Setting up relu7
I0913 21:13:02.767909 18192 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:13:02.767913 18192 net.cpp:156] Memory required for data: 68437560
I0913 21:13:02.767918 18192 layer_factory.hpp:77] Creating layer drop7
I0913 21:13:02.767930 18192 net.cpp:91] Creating Layer drop7
I0913 21:13:02.767935 18192 net.cpp:425] drop7 <- fc7
I0913 21:13:02.767945 18192 net.cpp:386] drop7 -> fc7 (in-place)
I0913 21:13:02.767989 18192 net.cpp:141] Setting up drop7
I0913 21:13:02.767998 18192 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:13:02.768002 18192 net.cpp:156] Memory required for data: 68601400
I0913 21:13:02.768007 18192 layer_factory.hpp:77] Creating layer fc8
I0913 21:13:02.768021 18192 net.cpp:91] Creating Layer fc8
I0913 21:13:02.768026 18192 net.cpp:425] fc8 <- fc7
I0913 21:13:02.768033 18192 net.cpp:399] fc8 -> fc8
I0913 21:13:02.782945 18192 net.cpp:141] Setting up fc8
I0913 21:13:02.783004 18192 net.cpp:148] Top shape: 10 1000 (10000)
I0913 21:13:02.783010 18192 net.cpp:156] Memory required for data: 68641400
I0913 21:13:02.783030 18192 layer_factory.hpp:77] Creating layer prob
I0913 21:13:02.783047 18192 net.cpp:91] Creating Layer prob
I0913 21:13:02.783054 18192 net.cpp:425] prob <- fc8
I0913 21:13:02.783071 18192 net.cpp:399] prob -> prob
I0913 21:13:02.783565 18192 net.cpp:141] Setting up prob
I0913 21:13:02.783578 18192 net.cpp:148] Top shape: 10 1000 (10000)
I0913 21:13:02.783583 18192 net.cpp:156] Memory required for data: 68681400
I0913 21:13:02.783588 18192 net.cpp:219] prob does not need backward computation.
I0913 21:13:02.783593 18192 net.cpp:219] fc8 does not need backward computation.
I0913 21:13:02.783598 18192 net.cpp:219] drop7 does not need backward computation.
I0913 21:13:02.783607 18192 net.cpp:219] relu7 does not need backward computation.
I0913 21:13:02.783614 18192 net.cpp:219] fc7 does not need backward computation.
I0913 21:13:02.783623 18192 net.cpp:219] drop6 does not need backward computation.
I0913 21:13:02.783632 18192 net.cpp:219] relu6 does not need backward computation.
I0913 21:13:02.783638 18192 net.cpp:219] fc6 does not need backward computation.
I0913 21:13:02.783648 18192 net.cpp:219] pool5 does not need backward computation.
I0913 21:13:02.783654 18192 net.cpp:219] relu5 does not need backward computation.
I0913 21:13:02.783663 18192 net.cpp:219] conv5 does not need backward computation.
I0913 21:13:02.783671 18192 net.cpp:219] relu4 does not need backward computation.
I0913 21:13:02.783679 18192 net.cpp:219] conv4 does not need backward computation.
I0913 21:13:02.783687 18192 net.cpp:219] relu3 does not need backward computation.
I0913 21:13:02.783692 18192 net.cpp:219] conv3 does not need backward computation.
I0913 21:13:02.783699 18192 net.cpp:219] norm2 does not need backward computation.
I0913 21:13:02.783704 18192 net.cpp:219] pool2 does not need backward computation.
I0913 21:13:02.783707 18192 net.cpp:219] relu2 does not need backward computation.
I0913 21:13:02.783711 18192 net.cpp:219] conv2 does not need backward computation.
I0913 21:13:02.783716 18192 net.cpp:219] norm1 does not need backward computation.
I0913 21:13:02.783723 18192 net.cpp:219] pool1 does not need backward computation.
I0913 21:13:02.783727 18192 net.cpp:219] relu1 does not need backward computation.
I0913 21:13:02.783740 18192 net.cpp:219] conv1 does not need backward computation.
I0913 21:13:02.783745 18192 net.cpp:219] data does not need backward computation.
I0913 21:13:02.783749 18192 net.cpp:261] This network produces output prob
I0913 21:13:02.783776 18192 net.cpp:274] Network initialization done.
I0913 21:13:02.956142 18182 net.cpp:141] Setting up embedding
I0913 21:13:02.956197 18182 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:13:02.956207 18182 net.cpp:156] Memory required for data: 22408
I0913 21:13:02.956231 18182 layer_factory.hpp:77] Creating layer lstm1
I0913 21:13:02.956275 18182 net.cpp:91] Creating Layer lstm1
I0913 21:13:02.956288 18182 net.cpp:425] lstm1 <- embedded_input_frames
I0913 21:13:02.956300 18182 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0913 21:13:02.956313 18182 net.cpp:399] lstm1 -> lstm1
I0913 21:13:02.956349 18182 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0913 21:13:02.956885 18182 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0913 21:13:02.957027 18182 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:13:02.957046 18182 net.cpp:91] Creating Layer lstm1_
I0913 21:13:02.957056 18182 net.cpp:399] lstm1_ -> x
I0913 21:13:02.957073 18182 net.cpp:399] lstm1_ -> cont
I0913 21:13:02.957160 18182 net.cpp:141] Setting up lstm1_
I0913 21:13:02.957175 18182 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:13:02.957185 18182 net.cpp:148] Top shape: 1 1 (1)
I0913 21:13:02.957192 18182 net.cpp:156] Memory required for data: 2004
I0913 21:13:02.957200 18182 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:13:02.957216 18182 net.cpp:91] Creating Layer lstm1_
I0913 21:13:02.957229 18182 net.cpp:399] lstm1_ -> c_0
I0913 21:13:02.957248 18182 net.cpp:399] lstm1_ -> h_0
I0913 21:13:02.957320 18182 net.cpp:141] Setting up lstm1_
I0913 21:13:02.957335 18182 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:13:02.957345 18182 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:13:02.957351 18182 net.cpp:156] Memory required for data: 10004
I0913 21:13:02.957358 18182 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0913 21:13:02.957375 18182 net.cpp:91] Creating Layer lstm1_cont_slice
I0913 21:13:02.957383 18182 net.cpp:425] lstm1_cont_slice <- cont
I0913 21:13:02.957393 18182 net.cpp:399] lstm1_cont_slice -> cont_1
I0913 21:13:02.957447 18182 net.cpp:141] Setting up lstm1_cont_slice
I0913 21:13:02.957460 18182 net.cpp:148] Top shape: 1 1 (1)
I0913 21:13:02.957468 18182 net.cpp:156] Memory required for data: 10008
I0913 21:13:02.957476 18182 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0913 21:13:02.957487 18182 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0913 21:13:02.957494 18182 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0913 21:13:02.957507 18182 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0913 21:13:02.957520 18182 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0913 21:13:02.957592 18182 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0913 21:13:02.957609 18182 net.cpp:148] Top shape: 1 1 (1)
I0913 21:13:02.957618 18182 net.cpp:148] Top shape: 1 1 (1)
I0913 21:13:02.957625 18182 net.cpp:156] Memory required for data: 10016
I0913 21:13:02.957633 18182 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0913 21:13:02.957648 18182 net.cpp:91] Creating Layer lstm1_x_transform
I0913 21:13:02.957654 18182 net.cpp:425] lstm1_x_transform <- x
I0913 21:13:02.957669 18182 net.cpp:399] lstm1_x_transform -> W_xc_x
I0913 21:13:02.985631 18182 net.cpp:141] Setting up lstm1_x_transform
I0913 21:13:02.985689 18182 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:13:02.985699 18182 net.cpp:156] Memory required for data: 26016
I0913 21:13:02.985728 18182 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0913 21:13:02.985752 18182 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0913 21:13:02.985762 18182 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0913 21:13:02.985777 18182 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0913 21:13:02.985842 18182 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0913 21:13:02.985857 18182 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:13:02.985864 18182 net.cpp:156] Memory required for data: 42016
I0913 21:13:02.985872 18182 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0913 21:13:02.985890 18182 net.cpp:91] Creating Layer lstm1_h_conted_0
I0913 21:13:02.985899 18182 net.cpp:425] lstm1_h_conted_0 <- h_0
I0913 21:13:02.985909 18182 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0913 21:13:02.985920 18182 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0913 21:13:02.986060 18182 net.cpp:141] Setting up lstm1_h_conted_0
I0913 21:13:02.986074 18182 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:13:02.986080 18182 net.cpp:156] Memory required for data: 46016
I0913 21:13:02.986088 18182 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0913 21:13:02.986104 18182 net.cpp:91] Creating Layer lstm1_transform_1
I0913 21:13:02.986114 18182 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0913 21:13:02.986125 18182 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0913 21:13:03.023326 18192 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /home/peifeng/work/run/storm102/data/workers/88571941-824c-4ddf-9427-847c913aa6a9/tmp/cvld5607761228221289628/bvlc_reference_caffenet.caffemodel
I0913 21:13:03.023375 18192 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0913 21:13:03.023381 18192 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0913 21:13:03.023386 18192 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /home/peifeng/work/run/storm102/data/workers/88571941-824c-4ddf-9427-847c913aa6a9/tmp/cvld5607761228221289628/bvlc_reference_caffenet.caffemodel
I0913 21:13:03.030474 18182 net.cpp:141] Setting up lstm1_transform_1
I0913 21:13:03.030524 18182 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:13:03.030530 18182 net.cpp:156] Memory required for data: 62016
I0913 21:13:03.030552 18182 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0913 21:13:03.030575 18182 net.cpp:91] Creating Layer lstm1_gate_input_1
I0913 21:13:03.030583 18182 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0913 21:13:03.030592 18182 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0913 21:13:03.030601 18182 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0913 21:13:03.030659 18182 net.cpp:141] Setting up lstm1_gate_input_1
I0913 21:13:03.030669 18182 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:13:03.030673 18182 net.cpp:156] Memory required for data: 78016
I0913 21:13:03.030678 18182 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0913 21:13:03.030689 18182 net.cpp:91] Creating Layer lstm1_unit_1
I0913 21:13:03.030694 18182 net.cpp:425] lstm1_unit_1 <- c_0
I0913 21:13:03.030699 18182 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0913 21:13:03.030705 18182 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0913 21:13:03.030711 18182 net.cpp:399] lstm1_unit_1 -> c_1
I0913 21:13:03.030720 18182 net.cpp:399] lstm1_unit_1 -> h_1
I0913 21:13:03.030782 18182 net.cpp:141] Setting up lstm1_unit_1
I0913 21:13:03.030793 18182 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:13:03.030799 18182 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:13:03.030803 18182 net.cpp:156] Memory required for data: 86016
I0913 21:13:03.030808 18182 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:13:03.030817 18182 net.cpp:91] Creating Layer lstm1_
I0913 21:13:03.030820 18182 net.cpp:425] lstm1_ <- c_1
I0913 21:13:03.030827 18182 net.cpp:399] lstm1_ -> c_T
I0913 21:13:03.030858 18182 net.cpp:141] Setting up lstm1_
I0913 21:13:03.030865 18182 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:13:03.030870 18182 net.cpp:156] Memory required for data: 90016
I0913 21:13:03.030874 18182 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0913 21:13:03.030890 18182 net.cpp:91] Creating Layer lstm1_h_concat
I0913 21:13:03.030896 18182 net.cpp:425] lstm1_h_concat <- h_1
I0913 21:13:03.030902 18182 net.cpp:399] lstm1_h_concat -> h
I0913 21:13:03.030939 18182 net.cpp:141] Setting up lstm1_h_concat
I0913 21:13:03.030948 18182 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:13:03.030952 18182 net.cpp:156] Memory required for data: 94016
I0913 21:13:03.030957 18182 layer_factory.hpp:77] Creating layer h_pseudoloss
I0913 21:13:03.030977 18182 net.cpp:91] Creating Layer h_pseudoloss
I0913 21:13:03.030982 18182 net.cpp:425] h_pseudoloss <- h
I0913 21:13:03.030992 18182 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0913 21:13:03.031077 18182 net.cpp:141] Setting up h_pseudoloss
I0913 21:13:03.031090 18182 net.cpp:148] Top shape: (1)
I0913 21:13:03.031093 18182 net.cpp:151]     with loss weight 1
I0913 21:13:03.031134 18182 net.cpp:156] Memory required for data: 94020
I0913 21:13:03.031141 18182 net.cpp:217] h_pseudoloss needs backward computation.
I0913 21:13:03.031144 18182 net.cpp:217] lstm1_h_concat needs backward computation.
I0913 21:13:03.031149 18182 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:13:03.031154 18182 net.cpp:217] lstm1_unit_1 needs backward computation.
I0913 21:13:03.031159 18182 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0913 21:13:03.031164 18182 net.cpp:217] lstm1_transform_1 needs backward computation.
I0913 21:13:03.031169 18182 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0913 21:13:03.031175 18182 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0913 21:13:03.031179 18182 net.cpp:217] lstm1_x_transform needs backward computation.
I0913 21:13:03.031184 18182 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0913 21:13:03.031189 18182 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0913 21:13:03.031194 18182 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:13:03.031198 18182 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:13:03.031203 18182 net.cpp:261] This network produces output c_T
I0913 21:13:03.031208 18182 net.cpp:261] This network produces output h_pseudoloss
I0913 21:13:03.031224 18182 net.cpp:274] Network initialization done.
I0913 21:13:03.031277 18182 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0913 21:13:03.031285 18182 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0913 21:13:03.031289 18182 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0913 21:13:03.031395 18182 net.cpp:141] Setting up lstm1
I0913 21:13:03.031409 18182 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:13:03.031414 18182 net.cpp:156] Memory required for data: 26408
I0913 21:13:03.031427 18182 layer_factory.hpp:77] Creating layer concat
I0913 21:13:03.031435 18182 net.cpp:91] Creating Layer concat
I0913 21:13:03.031441 18182 net.cpp:425] concat <- lstm1
I0913 21:13:03.031447 18182 net.cpp:425] concat <- embedded_input_sentence
I0913 21:13:03.031452 18182 net.cpp:425] concat <- reshaped_stage_indicator
I0913 21:13:03.031460 18182 net.cpp:399] concat -> lstm1_video_sequence
I0913 21:13:03.031492 18182 net.cpp:141] Setting up concat
I0913 21:13:03.031502 18182 net.cpp:148] Top shape: 1 1 1501 (1501)
I0913 21:13:03.031507 18182 net.cpp:156] Memory required for data: 32412
I0913 21:13:03.031510 18182 layer_factory.hpp:77] Creating layer lstm2
I0913 21:13:03.031522 18182 net.cpp:91] Creating Layer lstm2
I0913 21:13:03.031527 18182 net.cpp:425] lstm2 <- lstm1_video_sequence
I0913 21:13:03.031533 18182 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0913 21:13:03.031540 18182 net.cpp:399] lstm2 -> lstm2
I0913 21:13:03.031550 18182 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0913 21:13:03.031811 18182 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0913 21:13:03.031898 18182 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:13:03.031910 18182 net.cpp:91] Creating Layer lstm2_
I0913 21:13:03.031916 18182 net.cpp:399] lstm2_ -> x
I0913 21:13:03.031926 18182 net.cpp:399] lstm2_ -> cont
I0913 21:13:03.031980 18182 net.cpp:141] Setting up lstm2_
I0913 21:13:03.031990 18182 net.cpp:148] Top shape: 1 1 1501 (1501)
I0913 21:13:03.031996 18182 net.cpp:148] Top shape: 1 1 (1)
I0913 21:13:03.031999 18182 net.cpp:156] Memory required for data: 6008
I0913 21:13:03.032004 18182 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:13:03.032012 18182 net.cpp:91] Creating Layer lstm2_
I0913 21:13:03.032018 18182 net.cpp:399] lstm2_ -> c_0
I0913 21:13:03.032028 18182 net.cpp:399] lstm2_ -> h_0
I0913 21:13:03.032088 18182 net.cpp:141] Setting up lstm2_
I0913 21:13:03.032097 18182 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:13:03.032104 18182 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:13:03.032107 18182 net.cpp:156] Memory required for data: 14008
I0913 21:13:03.032121 18182 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0913 21:13:03.032130 18182 net.cpp:91] Creating Layer lstm2_cont_slice
I0913 21:13:03.032135 18182 net.cpp:425] lstm2_cont_slice <- cont
I0913 21:13:03.032143 18182 net.cpp:399] lstm2_cont_slice -> cont_1
I0913 21:13:03.032176 18182 net.cpp:141] Setting up lstm2_cont_slice
I0913 21:13:03.032186 18182 net.cpp:148] Top shape: 1 1 (1)
I0913 21:13:03.032191 18182 net.cpp:156] Memory required for data: 14012
I0913 21:13:03.032194 18182 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0913 21:13:03.032202 18182 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0913 21:13:03.032207 18182 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0913 21:13:03.032212 18182 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0913 21:13:03.032219 18182 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0913 21:13:03.032265 18182 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0913 21:13:03.032274 18182 net.cpp:148] Top shape: 1 1 (1)
I0913 21:13:03.032279 18182 net.cpp:148] Top shape: 1 1 (1)
I0913 21:13:03.032284 18182 net.cpp:156] Memory required for data: 14020
I0913 21:13:03.032289 18182 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0913 21:13:03.032300 18182 net.cpp:91] Creating Layer lstm2_x_transform
I0913 21:13:03.032305 18182 net.cpp:425] lstm2_x_transform <- x
I0913 21:13:03.032316 18182 net.cpp:399] lstm2_x_transform -> W_xc_x
I0913 21:13:03.089154 18182 net.cpp:141] Setting up lstm2_x_transform
I0913 21:13:03.089205 18182 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:13:03.089211 18182 net.cpp:156] Memory required for data: 30020
I0913 21:13:03.089233 18182 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0913 21:13:03.089253 18182 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0913 21:13:03.089260 18182 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0913 21:13:03.089270 18182 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0913 21:13:03.089314 18182 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0913 21:13:03.089324 18182 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:13:03.089329 18182 net.cpp:156] Memory required for data: 46020
I0913 21:13:03.089334 18182 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0913 21:13:03.089344 18182 net.cpp:91] Creating Layer lstm2_h_conted_0
I0913 21:13:03.089349 18182 net.cpp:425] lstm2_h_conted_0 <- h_0
I0913 21:13:03.089354 18182 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0913 21:13:03.089364 18182 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0913 21:13:03.089453 18182 net.cpp:141] Setting up lstm2_h_conted_0
I0913 21:13:03.089463 18182 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:13:03.089468 18182 net.cpp:156] Memory required for data: 50020
I0913 21:13:03.089473 18182 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0913 21:13:03.089488 18182 net.cpp:91] Creating Layer lstm2_transform_1
I0913 21:13:03.089493 18182 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0913 21:13:03.089500 18182 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0913 21:13:03.128473 18182 net.cpp:141] Setting up lstm2_transform_1
I0913 21:13:03.128528 18182 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:13:03.128535 18182 net.cpp:156] Memory required for data: 66020
I0913 21:13:03.128558 18182 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0913 21:13:03.128585 18182 net.cpp:91] Creating Layer lstm2_gate_input_1
I0913 21:13:03.128593 18182 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0913 21:13:03.128602 18182 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0913 21:13:03.128613 18182 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0913 21:13:03.128664 18182 net.cpp:141] Setting up lstm2_gate_input_1
I0913 21:13:03.128672 18182 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:13:03.128676 18182 net.cpp:156] Memory required for data: 82020
I0913 21:13:03.128681 18182 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0913 21:13:03.128693 18182 net.cpp:91] Creating Layer lstm2_unit_1
I0913 21:13:03.128698 18182 net.cpp:425] lstm2_unit_1 <- c_0
I0913 21:13:03.128705 18182 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0913 21:13:03.128710 18182 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0913 21:13:03.128716 18182 net.cpp:399] lstm2_unit_1 -> c_1
I0913 21:13:03.128725 18182 net.cpp:399] lstm2_unit_1 -> h_1
I0913 21:13:03.128792 18182 net.cpp:141] Setting up lstm2_unit_1
I0913 21:13:03.128800 18182 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:13:03.128806 18182 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:13:03.128811 18182 net.cpp:156] Memory required for data: 90020
I0913 21:13:03.128815 18182 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:13:03.128824 18182 net.cpp:91] Creating Layer lstm2_
I0913 21:13:03.128829 18182 net.cpp:425] lstm2_ <- c_1
I0913 21:13:03.128839 18182 net.cpp:399] lstm2_ -> c_T
I0913 21:13:03.128870 18182 net.cpp:141] Setting up lstm2_
I0913 21:13:03.128878 18182 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:13:03.128883 18182 net.cpp:156] Memory required for data: 94020
I0913 21:13:03.128887 18182 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0913 21:13:03.128896 18182 net.cpp:91] Creating Layer lstm2_h_concat
I0913 21:13:03.128901 18182 net.cpp:425] lstm2_h_concat <- h_1
I0913 21:13:03.128908 18182 net.cpp:399] lstm2_h_concat -> h
I0913 21:13:03.128944 18182 net.cpp:141] Setting up lstm2_h_concat
I0913 21:13:03.128952 18182 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:13:03.128957 18182 net.cpp:156] Memory required for data: 98020
I0913 21:13:03.128962 18182 layer_factory.hpp:77] Creating layer h_pseudoloss
I0913 21:13:03.128971 18182 net.cpp:91] Creating Layer h_pseudoloss
I0913 21:13:03.128976 18182 net.cpp:425] h_pseudoloss <- h
I0913 21:13:03.128983 18182 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0913 21:13:03.129070 18182 net.cpp:141] Setting up h_pseudoloss
I0913 21:13:03.129081 18182 net.cpp:148] Top shape: (1)
I0913 21:13:03.129086 18182 net.cpp:151]     with loss weight 1
I0913 21:13:03.129109 18182 net.cpp:156] Memory required for data: 98024
I0913 21:13:03.129115 18182 net.cpp:217] h_pseudoloss needs backward computation.
I0913 21:13:03.129120 18182 net.cpp:217] lstm2_h_concat needs backward computation.
I0913 21:13:03.129124 18182 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:13:03.129129 18182 net.cpp:217] lstm2_unit_1 needs backward computation.
I0913 21:13:03.129134 18182 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0913 21:13:03.129139 18182 net.cpp:217] lstm2_transform_1 needs backward computation.
I0913 21:13:03.129144 18182 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0913 21:13:03.129149 18182 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0913 21:13:03.129154 18182 net.cpp:217] lstm2_x_transform needs backward computation.
I0913 21:13:03.129159 18182 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0913 21:13:03.129164 18182 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0913 21:13:03.129169 18182 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:13:03.129173 18182 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:13:03.129176 18182 net.cpp:261] This network produces output c_T
I0913 21:13:03.129180 18182 net.cpp:261] This network produces output h_pseudoloss
I0913 21:13:03.129195 18182 net.cpp:274] Network initialization done.
I0913 21:13:03.129246 18182 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0913 21:13:03.129252 18182 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0913 21:13:03.129257 18182 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0913 21:13:03.129360 18182 net.cpp:141] Setting up lstm2
I0913 21:13:03.129371 18182 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:13:03.129376 18182 net.cpp:156] Memory required for data: 36412
I0913 21:13:03.129390 18182 layer_factory.hpp:77] Creating layer predict
I0913 21:13:03.129402 18182 net.cpp:91] Creating Layer predict
I0913 21:13:03.129408 18182 net.cpp:425] predict <- lstm2
I0913 21:13:03.129415 18182 net.cpp:399] predict -> predict
I0913 21:13:03.474309 18192 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0913 21:13:03.521816 18192 net.cpp:752] Ignoring source layer loss
Loading the model + trained: 11545.4ms
Using cv::Size and some other stuff: 0.143ms
I0913 21:13:03.563591 18182 net.cpp:141] Setting up predict
I0913 21:13:03.563640 18182 net.cpp:148] Top shape: 1 1 46168 (46168)
I0913 21:13:03.563647 18182 net.cpp:156] Memory required for data: 221084
I0913 21:13:03.563662 18182 layer_factory.hpp:77] Creating layer probs
I0913 21:13:03.563680 18182 net.cpp:91] Creating Layer probs
I0913 21:13:03.563688 18182 net.cpp:425] probs <- predict
I0913 21:13:03.563700 18182 net.cpp:399] probs -> probs
I0913 21:13:03.564611 18182 net.cpp:141] Setting up probs
I0913 21:13:03.564628 18182 net.cpp:148] Top shape: 1 1 46168 (46168)
I0913 21:13:03.564633 18182 net.cpp:156] Memory required for data: 405756
I0913 21:13:03.564640 18182 net.cpp:219] probs does not need backward computation.
I0913 21:13:03.564647 18182 net.cpp:219] predict does not need backward computation.
I0913 21:13:03.564652 18182 net.cpp:219] lstm2 does not need backward computation.
I0913 21:13:03.564666 18182 net.cpp:219] concat does not need backward computation.
I0913 21:13:03.564672 18182 net.cpp:219] lstm1 does not need backward computation.
I0913 21:13:03.564678 18182 net.cpp:219] embedding does not need backward computation.
I0913 21:13:03.564683 18182 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0913 21:13:03.564689 18182 net.cpp:219] reshape_frames does not need backward computation.
I0913 21:13:03.564693 18182 net.cpp:219] embed_encoder does not need backward computation.
I0913 21:13:03.564698 18182 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0913 21:13:03.564704 18182 net.cpp:219] input does not need backward computation.
I0913 21:13:03.564708 18182 net.cpp:261] This network produces output probs
I0913 21:13:03.564724 18182 net.cpp:274] Network initialization done.
Loading the mean file: 1552.45ms
I0913 21:13:03.951386 18182 net.cpp:752] Ignoring source layer data
I0913 21:13:03.951445 18182 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0913 21:13:03.951450 18182 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0913 21:13:04.025058 18182 net.cpp:752] Ignoring source layer cross_entropy_loss
TIMERTIMER 136862374
TIMERTIMER 72112669
TIMERTIMER 72920205
TIMERTIMER 50591935
TIMERTIMER 50835520
TIMERTIMER 55167428
TIMERTIMER 48667618
TIMERTIMER 46732763
TIMERTIMER 44246580
TIMERTIMER 47293722
TIMERTIMER 50256036
TIMERTIMER 48921010
TIMERTIMER 47866587
TIMERTIMER 53641559
TIMERTIMER 51384565
TIMERTIMER 47264352
TIMERTIMER 49271213
TIMERTIMER 49978078
TIMERTIMER 43316985
TIMERTIMER 32064504
TIMERTIMER 37583482
TIMERTIMER 31300042
TIMERTIMER 31556919
TIMERTIMER 36589637
TIMERTIMER 37169426
TIMERTIMER 31253541
TIMERTIMER 37591819
TIMERTIMER 38080832
TIMERTIMER 31578087
TIMERTIMER 31434590
TIMERTIMER 37596285
TIMERTIMER 37546235
TIMERTIMER 37961487
TIMERTIMER 37987936
TIMERTIMER 31743529
TIMERTIMER 37652492
TIMERTIMER 31302932
TIMERTIMER 31578808
TIMERTIMER 37813392
TIMERTIMER 39102644
TIMERTIMER 37894246
TIMERTIMER 37911340
TIMERTIMER 31350453
TIMERTIMER 31713097
TIMERTIMER 37521405
TIMERTIMER 31692297
TIMERTIMER 31621700
TIMERTIMER 37945729
TIMERTIMER 37991466
TIMERTIMER 31388396
TIMERTIMER 37859281
TIMERTIMER 31248150
TIMERTIMER 42207344
TIMERTIMER 32587277
TIMERTIMER 38254169
TIMERTIMER 31654268
TIMERTIMER 31418629
TIMERTIMER 31594468
TIMERTIMER 31442324
TIMERTIMER 31798685
TIMERTIMER 37666094
TIMERTIMER 38198702
TIMERTIMER 38659981
TIMERTIMER 33407143
TIMERTIMER 31783173
TIMERTIMER 31861588
TIMERTIMER 31879250
TIMERTIMER 37977919
TIMERTIMER 31821840
TIMERTIMER 31958505
TIMERTIMER 38042384
TIMERTIMER 31778078
TIMERTIMER 38340977
TIMERTIMER 31719644
TIMERTIMER 32206887
TIMERTIMER 33788523
TIMERTIMER 32120618
TIMERTIMER 32316918
TIMERTIMER 31468203
TIMERTIMER 31403478
TIMERTIMER 31292650
TIMERTIMER 37712657
TIMERTIMER 37704346
TIMERTIMER 31611742
TIMERTIMER 32475608
TIMERTIMER 32600640
TIMERTIMER 31276065
TIMERTIMER 37608018
TIMERTIMER 37715227
TIMERTIMER 32902627
TIMERTIMER 31872757
TIMERTIMER 31348338
TIMERTIMER 37953891
TIMERTIMER 37509222
TIMERTIMER 32562129
TIMERTIMER 38616522
TIMERTIMER 32257493
TIMERTIMER 31409492
TIMERTIMER 37972761
TIMERTIMER 37908370
TIMERTIMER 35731993
TIMERTIMER 31433020
TIMERTIMER 38345325
TIMERTIMER 38024852
TIMERTIMER 38799323
TIMERTIMER 32720960
TIMERTIMER 32140424
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/peifeng/tools/storm102/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/peifeng/work/run/storm102/data/supervisor/stormdist/captioning-1-1473815501/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /home/peifeng/work/run/storm102/data/workers/8524ec3e-a25b-4ba5-ba1f-17cea38af44d/tmp/cvld5648128456179630686/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0913 21:14:11.142026 18477 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0913 21:14:11.142268 18477 layer_factory.hpp:77] Creating layer data
I0913 21:14:11.142298 18477 net.cpp:91] Creating Layer data
I0913 21:14:11.142310 18477 net.cpp:399] data -> data
I0913 21:14:11.708129 18477 net.cpp:141] Setting up data
I0913 21:14:11.708233 18477 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0913 21:14:11.708241 18477 net.cpp:156] Memory required for data: 6183480
I0913 21:14:11.708262 18477 layer_factory.hpp:77] Creating layer conv1
I0913 21:14:11.708293 18477 net.cpp:91] Creating Layer conv1
I0913 21:14:11.708303 18477 net.cpp:425] conv1 <- data
I0913 21:14:11.708318 18477 net.cpp:399] conv1 -> conv1
I0913 21:14:11.848628 18467 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/8524ec3e-a25b-4ba5-ba1f-17cea38af44d/tmp/cvld5648128456179630686/s2vt.words_to_preds.prototxt
I0913 21:14:11.848695 18467 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0913 21:14:11.848703 18467 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0913 21:14:11.849009 18467 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0913 21:14:11.849126 18467 layer_factory.hpp:77] Creating layer input
I0913 21:14:11.849144 18467 net.cpp:91] Creating Layer input
I0913 21:14:11.849153 18467 net.cpp:399] input -> frames_fc7
I0913 21:14:11.849174 18467 net.cpp:399] input -> cont_sentence
I0913 21:14:11.849186 18467 net.cpp:399] input -> input_sentence
I0913 21:14:11.849197 18467 net.cpp:399] input -> stage_indicator
I0913 21:14:11.849330 18467 net.cpp:141] Setting up input
I0913 21:14:11.849345 18467 net.cpp:148] Top shape: 1 4096 (4096)
I0913 21:14:11.849354 18467 net.cpp:148] Top shape: 1 1 (1)
I0913 21:14:11.849360 18467 net.cpp:148] Top shape: 1 1 (1)
I0913 21:14:11.849366 18467 net.cpp:148] Top shape: 1 1 (1)
I0913 21:14:11.849371 18467 net.cpp:156] Memory required for data: 16396
I0913 21:14:11.849378 18467 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0913 21:14:11.849400 18467 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0913 21:14:11.849407 18467 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0913 21:14:11.849429 18467 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0913 21:14:11.849442 18467 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0913 21:14:11.849663 18467 net.cpp:141] Setting up cont_sentence_input_1_split
I0913 21:14:11.849680 18467 net.cpp:148] Top shape: 1 1 (1)
I0913 21:14:11.849687 18467 net.cpp:148] Top shape: 1 1 (1)
I0913 21:14:11.849692 18467 net.cpp:156] Memory required for data: 16404
I0913 21:14:11.849699 18467 layer_factory.hpp:77] Creating layer embed_encoder
I0913 21:14:11.849721 18467 net.cpp:91] Creating Layer embed_encoder
I0913 21:14:11.849728 18467 net.cpp:425] embed_encoder <- frames_fc7
I0913 21:14:11.849740 18467 net.cpp:399] embed_encoder -> embedded_in_frames
I0913 21:14:11.876138 18467 net.cpp:141] Setting up embed_encoder
I0913 21:14:11.876183 18467 net.cpp:148] Top shape: 1 500 (500)
I0913 21:14:11.876191 18467 net.cpp:156] Memory required for data: 18404
I0913 21:14:11.876219 18467 layer_factory.hpp:77] Creating layer reshape_frames
I0913 21:14:11.876253 18467 net.cpp:91] Creating Layer reshape_frames
I0913 21:14:11.876262 18467 net.cpp:425] reshape_frames <- embedded_in_frames
I0913 21:14:11.876274 18467 net.cpp:399] reshape_frames -> embedded_input_frames
I0913 21:14:11.876399 18467 net.cpp:141] Setting up reshape_frames
I0913 21:14:11.876411 18467 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:14:11.876416 18467 net.cpp:156] Memory required for data: 20404
I0913 21:14:11.876422 18467 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0913 21:14:11.876435 18467 net.cpp:91] Creating Layer reshape_stage_indicator
I0913 21:14:11.876441 18467 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0913 21:14:11.876456 18467 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0913 21:14:11.876646 18467 net.cpp:141] Setting up reshape_stage_indicator
I0913 21:14:11.876658 18467 net.cpp:148] Top shape: 1 1 1 (1)
I0913 21:14:11.876663 18467 net.cpp:156] Memory required for data: 20408
I0913 21:14:11.876669 18467 layer_factory.hpp:77] Creating layer embedding
I0913 21:14:11.876683 18467 net.cpp:91] Creating Layer embedding
I0913 21:14:11.876689 18467 net.cpp:425] embedding <- input_sentence
I0913 21:14:11.876703 18467 net.cpp:399] embedding -> embedded_input_sentence
I0913 21:14:11.978106 18477 net.cpp:141] Setting up conv1
I0913 21:14:11.978164 18477 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0913 21:14:11.978175 18477 net.cpp:156] Memory required for data: 17799480
I0913 21:14:11.978207 18477 layer_factory.hpp:77] Creating layer relu1
I0913 21:14:11.978232 18477 net.cpp:91] Creating Layer relu1
I0913 21:14:11.978245 18477 net.cpp:425] relu1 <- conv1
I0913 21:14:11.978257 18477 net.cpp:386] relu1 -> conv1 (in-place)
I0913 21:14:11.978879 18477 net.cpp:141] Setting up relu1
I0913 21:14:11.978901 18477 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0913 21:14:11.978910 18477 net.cpp:156] Memory required for data: 29415480
I0913 21:14:11.978919 18477 layer_factory.hpp:77] Creating layer pool1
I0913 21:14:11.978945 18477 net.cpp:91] Creating Layer pool1
I0913 21:14:11.978955 18477 net.cpp:425] pool1 <- conv1
I0913 21:14:11.978966 18477 net.cpp:399] pool1 -> pool1
I0913 21:14:11.979082 18477 net.cpp:141] Setting up pool1
I0913 21:14:11.979100 18477 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0913 21:14:11.979109 18477 net.cpp:156] Memory required for data: 32214840
I0913 21:14:11.979117 18477 layer_factory.hpp:77] Creating layer norm1
I0913 21:14:11.979146 18477 net.cpp:91] Creating Layer norm1
I0913 21:14:11.979156 18477 net.cpp:425] norm1 <- pool1
I0913 21:14:11.979167 18477 net.cpp:399] norm1 -> norm1
I0913 21:14:11.979627 18477 net.cpp:141] Setting up norm1
I0913 21:14:11.979648 18477 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0913 21:14:11.979657 18477 net.cpp:156] Memory required for data: 35014200
I0913 21:14:11.979665 18477 layer_factory.hpp:77] Creating layer conv2
I0913 21:14:11.979691 18477 net.cpp:91] Creating Layer conv2
I0913 21:14:11.979699 18477 net.cpp:425] conv2 <- norm1
I0913 21:14:11.979712 18477 net.cpp:399] conv2 -> conv2
I0913 21:14:11.984462 18477 net.cpp:141] Setting up conv2
I0913 21:14:11.984493 18477 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0913 21:14:11.984503 18477 net.cpp:156] Memory required for data: 42479160
I0913 21:14:11.984537 18477 layer_factory.hpp:77] Creating layer relu2
I0913 21:14:11.984560 18477 net.cpp:91] Creating Layer relu2
I0913 21:14:11.984567 18477 net.cpp:425] relu2 <- conv2
I0913 21:14:11.984577 18477 net.cpp:386] relu2 -> conv2 (in-place)
I0913 21:14:11.985136 18477 net.cpp:141] Setting up relu2
I0913 21:14:11.985159 18477 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0913 21:14:11.985167 18477 net.cpp:156] Memory required for data: 49944120
I0913 21:14:11.985175 18477 layer_factory.hpp:77] Creating layer pool2
I0913 21:14:11.985188 18477 net.cpp:91] Creating Layer pool2
I0913 21:14:11.985195 18477 net.cpp:425] pool2 <- conv2
I0913 21:14:11.985209 18477 net.cpp:399] pool2 -> pool2
I0913 21:14:11.985290 18477 net.cpp:141] Setting up pool2
I0913 21:14:11.985306 18477 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:14:11.985313 18477 net.cpp:156] Memory required for data: 51674680
I0913 21:14:11.985321 18477 layer_factory.hpp:77] Creating layer norm2
I0913 21:14:11.985334 18477 net.cpp:91] Creating Layer norm2
I0913 21:14:11.985342 18477 net.cpp:425] norm2 <- pool2
I0913 21:14:11.985357 18477 net.cpp:399] norm2 -> norm2
I0913 21:14:11.985724 18477 net.cpp:141] Setting up norm2
I0913 21:14:11.985743 18477 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:14:11.985749 18477 net.cpp:156] Memory required for data: 53405240
I0913 21:14:11.985756 18477 layer_factory.hpp:77] Creating layer conv3
I0913 21:14:11.985775 18477 net.cpp:91] Creating Layer conv3
I0913 21:14:11.985782 18477 net.cpp:425] conv3 <- norm2
I0913 21:14:11.985797 18477 net.cpp:399] conv3 -> conv3
I0913 21:14:11.990627 18477 net.cpp:141] Setting up conv3
I0913 21:14:11.990653 18477 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:14:11.990661 18477 net.cpp:156] Memory required for data: 56001080
I0913 21:14:11.990679 18477 layer_factory.hpp:77] Creating layer relu3
I0913 21:14:11.990700 18477 net.cpp:91] Creating Layer relu3
I0913 21:14:11.990707 18477 net.cpp:425] relu3 <- conv3
I0913 21:14:11.990717 18477 net.cpp:386] relu3 -> conv3 (in-place)
I0913 21:14:11.991045 18477 net.cpp:141] Setting up relu3
I0913 21:14:11.991063 18477 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:14:11.991070 18477 net.cpp:156] Memory required for data: 58596920
I0913 21:14:11.991077 18477 layer_factory.hpp:77] Creating layer conv4
I0913 21:14:11.991101 18477 net.cpp:91] Creating Layer conv4
I0913 21:14:11.991109 18477 net.cpp:425] conv4 <- conv3
I0913 21:14:11.991120 18477 net.cpp:399] conv4 -> conv4
I0913 21:14:11.996682 18477 net.cpp:141] Setting up conv4
I0913 21:14:11.996711 18477 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:14:11.996719 18477 net.cpp:156] Memory required for data: 61192760
I0913 21:14:11.996734 18477 layer_factory.hpp:77] Creating layer relu4
I0913 21:14:11.996762 18477 net.cpp:91] Creating Layer relu4
I0913 21:14:11.996769 18477 net.cpp:425] relu4 <- conv4
I0913 21:14:11.996784 18477 net.cpp:386] relu4 -> conv4 (in-place)
I0913 21:14:11.997311 18477 net.cpp:141] Setting up relu4
I0913 21:14:11.997330 18477 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:14:11.997336 18477 net.cpp:156] Memory required for data: 63788600
I0913 21:14:11.997344 18477 layer_factory.hpp:77] Creating layer conv5
I0913 21:14:11.997364 18477 net.cpp:91] Creating Layer conv5
I0913 21:14:11.997371 18477 net.cpp:425] conv5 <- conv4
I0913 21:14:11.997385 18477 net.cpp:399] conv5 -> conv5
I0913 21:14:12.002269 18477 net.cpp:141] Setting up conv5
I0913 21:14:12.002295 18477 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:14:12.002302 18477 net.cpp:156] Memory required for data: 65519160
I0913 21:14:12.002320 18477 layer_factory.hpp:77] Creating layer relu5
I0913 21:14:12.002332 18477 net.cpp:91] Creating Layer relu5
I0913 21:14:12.002339 18477 net.cpp:425] relu5 <- conv5
I0913 21:14:12.002354 18477 net.cpp:386] relu5 -> conv5 (in-place)
I0913 21:14:12.002866 18477 net.cpp:141] Setting up relu5
I0913 21:14:12.002883 18477 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:14:12.002890 18477 net.cpp:156] Memory required for data: 67249720
I0913 21:14:12.002898 18477 layer_factory.hpp:77] Creating layer pool5
I0913 21:14:12.002915 18477 net.cpp:91] Creating Layer pool5
I0913 21:14:12.002923 18477 net.cpp:425] pool5 <- conv5
I0913 21:14:12.002933 18477 net.cpp:399] pool5 -> pool5
I0913 21:14:12.003016 18477 net.cpp:141] Setting up pool5
I0913 21:14:12.003031 18477 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0913 21:14:12.003036 18477 net.cpp:156] Memory required for data: 67618360
I0913 21:14:12.003043 18477 layer_factory.hpp:77] Creating layer fc6
I0913 21:14:12.003062 18477 net.cpp:91] Creating Layer fc6
I0913 21:14:12.003069 18477 net.cpp:425] fc6 <- pool5
I0913 21:14:12.003079 18477 net.cpp:399] fc6 -> fc6
I0913 21:14:12.117570 18477 net.cpp:141] Setting up fc6
I0913 21:14:12.117620 18477 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:14:12.117629 18477 net.cpp:156] Memory required for data: 67782200
I0913 21:14:12.117642 18477 layer_factory.hpp:77] Creating layer relu6
I0913 21:14:12.117663 18477 net.cpp:91] Creating Layer relu6
I0913 21:14:12.117671 18477 net.cpp:425] relu6 <- fc6
I0913 21:14:12.117681 18477 net.cpp:386] relu6 -> fc6 (in-place)
I0913 21:14:12.118043 18477 net.cpp:141] Setting up relu6
I0913 21:14:12.118057 18477 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:14:12.118063 18477 net.cpp:156] Memory required for data: 67946040
I0913 21:14:12.118069 18477 layer_factory.hpp:77] Creating layer drop6
I0913 21:14:12.118093 18477 net.cpp:91] Creating Layer drop6
I0913 21:14:12.118098 18477 net.cpp:425] drop6 <- fc6
I0913 21:14:12.118110 18477 net.cpp:386] drop6 -> fc6 (in-place)
I0913 21:14:12.118165 18477 net.cpp:141] Setting up drop6
I0913 21:14:12.118176 18477 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:14:12.118181 18477 net.cpp:156] Memory required for data: 68109880
I0913 21:14:12.118187 18477 layer_factory.hpp:77] Creating layer fc7
I0913 21:14:12.118198 18477 net.cpp:91] Creating Layer fc7
I0913 21:14:12.118203 18477 net.cpp:425] fc7 <- fc6
I0913 21:14:12.118212 18477 net.cpp:399] fc7 -> fc7
I0913 21:14:12.150269 18467 net.cpp:141] Setting up embedding
I0913 21:14:12.150338 18467 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:14:12.150346 18467 net.cpp:156] Memory required for data: 22408
I0913 21:14:12.150367 18467 layer_factory.hpp:77] Creating layer lstm1
I0913 21:14:12.150406 18467 net.cpp:91] Creating Layer lstm1
I0913 21:14:12.150416 18467 net.cpp:425] lstm1 <- embedded_input_frames
I0913 21:14:12.150426 18467 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0913 21:14:12.150439 18467 net.cpp:399] lstm1 -> lstm1
I0913 21:14:12.150473 18467 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0913 21:14:12.150918 18467 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0913 21:14:12.151024 18467 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:14:12.151039 18467 net.cpp:91] Creating Layer lstm1_
I0913 21:14:12.151047 18467 net.cpp:399] lstm1_ -> x
I0913 21:14:12.151060 18467 net.cpp:399] lstm1_ -> cont
I0913 21:14:12.151131 18467 net.cpp:141] Setting up lstm1_
I0913 21:14:12.151142 18467 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:14:12.151150 18467 net.cpp:148] Top shape: 1 1 (1)
I0913 21:14:12.151154 18467 net.cpp:156] Memory required for data: 2004
I0913 21:14:12.151160 18467 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:14:12.151170 18467 net.cpp:91] Creating Layer lstm1_
I0913 21:14:12.151180 18467 net.cpp:399] lstm1_ -> c_0
I0913 21:14:12.151191 18467 net.cpp:399] lstm1_ -> h_0
I0913 21:14:12.151267 18467 net.cpp:141] Setting up lstm1_
I0913 21:14:12.151279 18467 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:14:12.151286 18467 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:14:12.151291 18467 net.cpp:156] Memory required for data: 10004
I0913 21:14:12.151298 18467 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0913 21:14:12.151309 18467 net.cpp:91] Creating Layer lstm1_cont_slice
I0913 21:14:12.151314 18467 net.cpp:425] lstm1_cont_slice <- cont
I0913 21:14:12.151324 18467 net.cpp:399] lstm1_cont_slice -> cont_1
I0913 21:14:12.151365 18467 net.cpp:141] Setting up lstm1_cont_slice
I0913 21:14:12.151376 18467 net.cpp:148] Top shape: 1 1 (1)
I0913 21:14:12.151381 18467 net.cpp:156] Memory required for data: 10008
I0913 21:14:12.151386 18467 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0913 21:14:12.151397 18467 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0913 21:14:12.151403 18467 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0913 21:14:12.151412 18467 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0913 21:14:12.151420 18467 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0913 21:14:12.151474 18467 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0913 21:14:12.151484 18467 net.cpp:148] Top shape: 1 1 (1)
I0913 21:14:12.151491 18467 net.cpp:148] Top shape: 1 1 (1)
I0913 21:14:12.151496 18467 net.cpp:156] Memory required for data: 10016
I0913 21:14:12.151501 18467 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0913 21:14:12.151513 18467 net.cpp:91] Creating Layer lstm1_x_transform
I0913 21:14:12.151518 18467 net.cpp:425] lstm1_x_transform <- x
I0913 21:14:12.151527 18467 net.cpp:399] lstm1_x_transform -> W_xc_x
I0913 21:14:12.168594 18477 net.cpp:141] Setting up fc7
I0913 21:14:12.168640 18477 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:14:12.168648 18477 net.cpp:156] Memory required for data: 68273720
I0913 21:14:12.168663 18477 layer_factory.hpp:77] Creating layer relu7
I0913 21:14:12.168684 18477 net.cpp:91] Creating Layer relu7
I0913 21:14:12.168692 18477 net.cpp:425] relu7 <- fc7
I0913 21:14:12.168702 18477 net.cpp:386] relu7 -> fc7 (in-place)
I0913 21:14:12.169345 18477 net.cpp:141] Setting up relu7
I0913 21:14:12.169366 18477 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:14:12.169373 18477 net.cpp:156] Memory required for data: 68437560
I0913 21:14:12.169378 18477 layer_factory.hpp:77] Creating layer drop7
I0913 21:14:12.169390 18477 net.cpp:91] Creating Layer drop7
I0913 21:14:12.169396 18477 net.cpp:425] drop7 <- fc7
I0913 21:14:12.169406 18477 net.cpp:386] drop7 -> fc7 (in-place)
I0913 21:14:12.169450 18477 net.cpp:141] Setting up drop7
I0913 21:14:12.169459 18477 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:14:12.169464 18477 net.cpp:156] Memory required for data: 68601400
I0913 21:14:12.169469 18477 layer_factory.hpp:77] Creating layer fc8
I0913 21:14:12.169486 18477 net.cpp:91] Creating Layer fc8
I0913 21:14:12.169492 18477 net.cpp:425] fc8 <- fc7
I0913 21:14:12.169499 18477 net.cpp:399] fc8 -> fc8
I0913 21:14:12.177745 18467 net.cpp:141] Setting up lstm1_x_transform
I0913 21:14:12.177795 18467 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:14:12.177801 18467 net.cpp:156] Memory required for data: 26016
I0913 21:14:12.177824 18467 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0913 21:14:12.177846 18467 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0913 21:14:12.177855 18467 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0913 21:14:12.177865 18467 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0913 21:14:12.177916 18467 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0913 21:14:12.177927 18467 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:14:12.177932 18467 net.cpp:156] Memory required for data: 42016
I0913 21:14:12.177937 18467 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0913 21:14:12.177953 18467 net.cpp:91] Creating Layer lstm1_h_conted_0
I0913 21:14:12.177959 18467 net.cpp:425] lstm1_h_conted_0 <- h_0
I0913 21:14:12.177966 18467 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0913 21:14:12.177974 18467 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0913 21:14:12.178076 18467 net.cpp:141] Setting up lstm1_h_conted_0
I0913 21:14:12.178087 18467 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:14:12.178092 18467 net.cpp:156] Memory required for data: 46016
I0913 21:14:12.178098 18467 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0913 21:14:12.178117 18467 net.cpp:91] Creating Layer lstm1_transform_1
I0913 21:14:12.178122 18467 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0913 21:14:12.178131 18467 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0913 21:14:12.186755 18477 net.cpp:141] Setting up fc8
I0913 21:14:12.186808 18477 net.cpp:148] Top shape: 10 1000 (10000)
I0913 21:14:12.186816 18477 net.cpp:156] Memory required for data: 68641400
I0913 21:14:12.186831 18477 layer_factory.hpp:77] Creating layer prob
I0913 21:14:12.186848 18477 net.cpp:91] Creating Layer prob
I0913 21:14:12.186856 18477 net.cpp:425] prob <- fc8
I0913 21:14:12.186873 18477 net.cpp:399] prob -> prob
I0913 21:14:12.187333 18477 net.cpp:141] Setting up prob
I0913 21:14:12.187347 18477 net.cpp:148] Top shape: 10 1000 (10000)
I0913 21:14:12.187353 18477 net.cpp:156] Memory required for data: 68681400
I0913 21:14:12.187360 18477 net.cpp:219] prob does not need backward computation.
I0913 21:14:12.187366 18477 net.cpp:219] fc8 does not need backward computation.
I0913 21:14:12.187371 18477 net.cpp:219] drop7 does not need backward computation.
I0913 21:14:12.187376 18477 net.cpp:219] relu7 does not need backward computation.
I0913 21:14:12.187381 18477 net.cpp:219] fc7 does not need backward computation.
I0913 21:14:12.187386 18477 net.cpp:219] drop6 does not need backward computation.
I0913 21:14:12.187391 18477 net.cpp:219] relu6 does not need backward computation.
I0913 21:14:12.187397 18477 net.cpp:219] fc6 does not need backward computation.
I0913 21:14:12.187402 18477 net.cpp:219] pool5 does not need backward computation.
I0913 21:14:12.187408 18477 net.cpp:219] relu5 does not need backward computation.
I0913 21:14:12.187413 18477 net.cpp:219] conv5 does not need backward computation.
I0913 21:14:12.187418 18477 net.cpp:219] relu4 does not need backward computation.
I0913 21:14:12.187423 18477 net.cpp:219] conv4 does not need backward computation.
I0913 21:14:12.187429 18477 net.cpp:219] relu3 does not need backward computation.
I0913 21:14:12.187434 18477 net.cpp:219] conv3 does not need backward computation.
I0913 21:14:12.187440 18477 net.cpp:219] norm2 does not need backward computation.
I0913 21:14:12.187446 18477 net.cpp:219] pool2 does not need backward computation.
I0913 21:14:12.187451 18477 net.cpp:219] relu2 does not need backward computation.
I0913 21:14:12.187456 18477 net.cpp:219] conv2 does not need backward computation.
I0913 21:14:12.187461 18477 net.cpp:219] norm1 does not need backward computation.
I0913 21:14:12.187466 18477 net.cpp:219] pool1 does not need backward computation.
I0913 21:14:12.187472 18477 net.cpp:219] relu1 does not need backward computation.
I0913 21:14:12.187477 18477 net.cpp:219] conv1 does not need backward computation.
I0913 21:14:12.187482 18477 net.cpp:219] data does not need backward computation.
I0913 21:14:12.187486 18477 net.cpp:261] This network produces output prob
I0913 21:14:12.187511 18477 net.cpp:274] Network initialization done.
I0913 21:14:12.221025 18467 net.cpp:141] Setting up lstm1_transform_1
I0913 21:14:12.221088 18467 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:14:12.221096 18467 net.cpp:156] Memory required for data: 62016
I0913 21:14:12.221120 18467 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0913 21:14:12.221148 18467 net.cpp:91] Creating Layer lstm1_gate_input_1
I0913 21:14:12.221155 18467 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0913 21:14:12.221164 18467 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0913 21:14:12.221174 18467 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0913 21:14:12.221236 18467 net.cpp:141] Setting up lstm1_gate_input_1
I0913 21:14:12.221247 18467 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:14:12.221253 18467 net.cpp:156] Memory required for data: 78016
I0913 21:14:12.221258 18467 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0913 21:14:12.221269 18467 net.cpp:91] Creating Layer lstm1_unit_1
I0913 21:14:12.221274 18467 net.cpp:425] lstm1_unit_1 <- c_0
I0913 21:14:12.221282 18467 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0913 21:14:12.221288 18467 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0913 21:14:12.221299 18467 net.cpp:399] lstm1_unit_1 -> c_1
I0913 21:14:12.221309 18467 net.cpp:399] lstm1_unit_1 -> h_1
I0913 21:14:12.221379 18467 net.cpp:141] Setting up lstm1_unit_1
I0913 21:14:12.221390 18467 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:14:12.221397 18467 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:14:12.221402 18467 net.cpp:156] Memory required for data: 86016
I0913 21:14:12.221408 18467 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:14:12.221418 18467 net.cpp:91] Creating Layer lstm1_
I0913 21:14:12.221423 18467 net.cpp:425] lstm1_ <- c_1
I0913 21:14:12.221431 18467 net.cpp:399] lstm1_ -> c_T
I0913 21:14:12.221468 18467 net.cpp:141] Setting up lstm1_
I0913 21:14:12.221478 18467 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:14:12.221483 18467 net.cpp:156] Memory required for data: 90016
I0913 21:14:12.221488 18467 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0913 21:14:12.221499 18467 net.cpp:91] Creating Layer lstm1_h_concat
I0913 21:14:12.221505 18467 net.cpp:425] lstm1_h_concat <- h_1
I0913 21:14:12.221513 18467 net.cpp:399] lstm1_h_concat -> h
I0913 21:14:12.221555 18467 net.cpp:141] Setting up lstm1_h_concat
I0913 21:14:12.221570 18467 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:14:12.221580 18467 net.cpp:156] Memory required for data: 94016
I0913 21:14:12.221586 18467 layer_factory.hpp:77] Creating layer h_pseudoloss
I0913 21:14:12.221612 18467 net.cpp:91] Creating Layer h_pseudoloss
I0913 21:14:12.221619 18467 net.cpp:425] h_pseudoloss <- h
I0913 21:14:12.221627 18467 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0913 21:14:12.221731 18467 net.cpp:141] Setting up h_pseudoloss
I0913 21:14:12.221743 18467 net.cpp:148] Top shape: (1)
I0913 21:14:12.221748 18467 net.cpp:151]     with loss weight 1
I0913 21:14:12.221793 18467 net.cpp:156] Memory required for data: 94020
I0913 21:14:12.221801 18467 net.cpp:217] h_pseudoloss needs backward computation.
I0913 21:14:12.221807 18467 net.cpp:217] lstm1_h_concat needs backward computation.
I0913 21:14:12.221812 18467 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:14:12.221817 18467 net.cpp:217] lstm1_unit_1 needs backward computation.
I0913 21:14:12.221823 18467 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0913 21:14:12.221829 18467 net.cpp:217] lstm1_transform_1 needs backward computation.
I0913 21:14:12.221834 18467 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0913 21:14:12.221842 18467 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0913 21:14:12.221850 18467 net.cpp:217] lstm1_x_transform needs backward computation.
I0913 21:14:12.221856 18467 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0913 21:14:12.221863 18467 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0913 21:14:12.221868 18467 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:14:12.221873 18467 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:14:12.221879 18467 net.cpp:261] This network produces output c_T
I0913 21:14:12.221884 18467 net.cpp:261] This network produces output h_pseudoloss
I0913 21:14:12.221901 18467 net.cpp:274] Network initialization done.
I0913 21:14:12.221961 18467 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0913 21:14:12.221968 18467 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0913 21:14:12.221974 18467 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0913 21:14:12.222090 18467 net.cpp:141] Setting up lstm1
I0913 21:14:12.222105 18467 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:14:12.222110 18467 net.cpp:156] Memory required for data: 26408
I0913 21:14:12.222124 18467 layer_factory.hpp:77] Creating layer concat
I0913 21:14:12.222134 18467 net.cpp:91] Creating Layer concat
I0913 21:14:12.222141 18467 net.cpp:425] concat <- lstm1
I0913 21:14:12.222148 18467 net.cpp:425] concat <- embedded_input_sentence
I0913 21:14:12.222156 18467 net.cpp:425] concat <- reshaped_stage_indicator
I0913 21:14:12.222163 18467 net.cpp:399] concat -> lstm1_video_sequence
I0913 21:14:12.222200 18467 net.cpp:141] Setting up concat
I0913 21:14:12.222210 18467 net.cpp:148] Top shape: 1 1 1501 (1501)
I0913 21:14:12.222215 18467 net.cpp:156] Memory required for data: 32412
I0913 21:14:12.222220 18467 layer_factory.hpp:77] Creating layer lstm2
I0913 21:14:12.222234 18467 net.cpp:91] Creating Layer lstm2
I0913 21:14:12.222240 18467 net.cpp:425] lstm2 <- lstm1_video_sequence
I0913 21:14:12.222247 18467 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0913 21:14:12.222255 18467 net.cpp:399] lstm2 -> lstm2
I0913 21:14:12.222268 18467 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0913 21:14:12.222568 18467 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0913 21:14:12.222681 18467 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:14:12.222697 18467 net.cpp:91] Creating Layer lstm2_
I0913 21:14:12.222704 18467 net.cpp:399] lstm2_ -> x
I0913 21:14:12.222717 18467 net.cpp:399] lstm2_ -> cont
I0913 21:14:12.222775 18467 net.cpp:141] Setting up lstm2_
I0913 21:14:12.222786 18467 net.cpp:148] Top shape: 1 1 1501 (1501)
I0913 21:14:12.222793 18467 net.cpp:148] Top shape: 1 1 (1)
I0913 21:14:12.222798 18467 net.cpp:156] Memory required for data: 6008
I0913 21:14:12.222803 18467 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:14:12.222813 18467 net.cpp:91] Creating Layer lstm2_
I0913 21:14:12.222823 18467 net.cpp:399] lstm2_ -> c_0
I0913 21:14:12.222834 18467 net.cpp:399] lstm2_ -> h_0
I0913 21:14:12.222888 18467 net.cpp:141] Setting up lstm2_
I0913 21:14:12.222899 18467 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:14:12.222905 18467 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:14:12.222910 18467 net.cpp:156] Memory required for data: 14008
I0913 21:14:12.222915 18467 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0913 21:14:12.222924 18467 net.cpp:91] Creating Layer lstm2_cont_slice
I0913 21:14:12.222930 18467 net.cpp:425] lstm2_cont_slice <- cont
I0913 21:14:12.222939 18467 net.cpp:399] lstm2_cont_slice -> cont_1
I0913 21:14:12.222973 18467 net.cpp:141] Setting up lstm2_cont_slice
I0913 21:14:12.222983 18467 net.cpp:148] Top shape: 1 1 (1)
I0913 21:14:12.222990 18467 net.cpp:156] Memory required for data: 14012
I0913 21:14:12.222995 18467 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0913 21:14:12.223004 18467 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0913 21:14:12.223011 18467 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0913 21:14:12.223017 18467 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0913 21:14:12.223029 18467 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0913 21:14:12.223078 18467 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0913 21:14:12.223088 18467 net.cpp:148] Top shape: 1 1 (1)
I0913 21:14:12.223094 18467 net.cpp:148] Top shape: 1 1 (1)
I0913 21:14:12.223099 18467 net.cpp:156] Memory required for data: 14020
I0913 21:14:12.223104 18467 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0913 21:14:12.223119 18467 net.cpp:91] Creating Layer lstm2_x_transform
I0913 21:14:12.223124 18467 net.cpp:425] lstm2_x_transform <- x
I0913 21:14:12.223134 18467 net.cpp:399] lstm2_x_transform -> W_xc_x
I0913 21:14:12.287251 18467 net.cpp:141] Setting up lstm2_x_transform
I0913 21:14:12.287312 18467 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:14:12.287318 18467 net.cpp:156] Memory required for data: 30020
I0913 21:14:12.287345 18467 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0913 21:14:12.287365 18467 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0913 21:14:12.287374 18467 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0913 21:14:12.287384 18467 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0913 21:14:12.287441 18467 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0913 21:14:12.287452 18467 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:14:12.287457 18467 net.cpp:156] Memory required for data: 46020
I0913 21:14:12.287463 18467 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0913 21:14:12.287475 18467 net.cpp:91] Creating Layer lstm2_h_conted_0
I0913 21:14:12.287482 18467 net.cpp:425] lstm2_h_conted_0 <- h_0
I0913 21:14:12.287488 18467 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0913 21:14:12.287497 18467 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0913 21:14:12.287613 18467 net.cpp:141] Setting up lstm2_h_conted_0
I0913 21:14:12.287626 18467 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:14:12.287631 18467 net.cpp:156] Memory required for data: 50020
I0913 21:14:12.287636 18467 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0913 21:14:12.287652 18467 net.cpp:91] Creating Layer lstm2_transform_1
I0913 21:14:12.287657 18467 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0913 21:14:12.287667 18467 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0913 21:14:12.330421 18467 net.cpp:141] Setting up lstm2_transform_1
I0913 21:14:12.330482 18467 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:14:12.330489 18467 net.cpp:156] Memory required for data: 66020
I0913 21:14:12.330514 18467 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0913 21:14:12.330538 18467 net.cpp:91] Creating Layer lstm2_gate_input_1
I0913 21:14:12.330546 18467 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0913 21:14:12.330555 18467 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0913 21:14:12.330565 18467 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0913 21:14:12.330621 18467 net.cpp:141] Setting up lstm2_gate_input_1
I0913 21:14:12.330631 18467 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:14:12.330636 18467 net.cpp:156] Memory required for data: 82020
I0913 21:14:12.330642 18467 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0913 21:14:12.330654 18467 net.cpp:91] Creating Layer lstm2_unit_1
I0913 21:14:12.330660 18467 net.cpp:425] lstm2_unit_1 <- c_0
I0913 21:14:12.330667 18467 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0913 21:14:12.330674 18467 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0913 21:14:12.330682 18467 net.cpp:399] lstm2_unit_1 -> c_1
I0913 21:14:12.330693 18467 net.cpp:399] lstm2_unit_1 -> h_1
I0913 21:14:12.330759 18467 net.cpp:141] Setting up lstm2_unit_1
I0913 21:14:12.330768 18467 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:14:12.330775 18467 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:14:12.330780 18467 net.cpp:156] Memory required for data: 90020
I0913 21:14:12.330785 18467 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:14:12.330796 18467 net.cpp:91] Creating Layer lstm2_
I0913 21:14:12.330801 18467 net.cpp:425] lstm2_ <- c_1
I0913 21:14:12.330808 18467 net.cpp:399] lstm2_ -> c_T
I0913 21:14:12.330842 18467 net.cpp:141] Setting up lstm2_
I0913 21:14:12.330850 18467 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:14:12.330855 18467 net.cpp:156] Memory required for data: 94020
I0913 21:14:12.330860 18467 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0913 21:14:12.330878 18467 net.cpp:91] Creating Layer lstm2_h_concat
I0913 21:14:12.330888 18467 net.cpp:425] lstm2_h_concat <- h_1
I0913 21:14:12.330901 18467 net.cpp:399] lstm2_h_concat -> h
I0913 21:14:12.330948 18467 net.cpp:141] Setting up lstm2_h_concat
I0913 21:14:12.330958 18467 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:14:12.330965 18467 net.cpp:156] Memory required for data: 98020
I0913 21:14:12.330970 18467 layer_factory.hpp:77] Creating layer h_pseudoloss
I0913 21:14:12.330981 18467 net.cpp:91] Creating Layer h_pseudoloss
I0913 21:14:12.330986 18467 net.cpp:425] h_pseudoloss <- h
I0913 21:14:12.330996 18467 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0913 21:14:12.331092 18467 net.cpp:141] Setting up h_pseudoloss
I0913 21:14:12.331104 18467 net.cpp:148] Top shape: (1)
I0913 21:14:12.331110 18467 net.cpp:151]     with loss weight 1
I0913 21:14:12.331132 18467 net.cpp:156] Memory required for data: 98024
I0913 21:14:12.331138 18467 net.cpp:217] h_pseudoloss needs backward computation.
I0913 21:14:12.331145 18467 net.cpp:217] lstm2_h_concat needs backward computation.
I0913 21:14:12.331149 18467 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:14:12.331154 18467 net.cpp:217] lstm2_unit_1 needs backward computation.
I0913 21:14:12.331161 18467 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0913 21:14:12.331166 18467 net.cpp:217] lstm2_transform_1 needs backward computation.
I0913 21:14:12.331172 18467 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0913 21:14:12.331178 18467 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0913 21:14:12.331184 18467 net.cpp:217] lstm2_x_transform needs backward computation.
I0913 21:14:12.331190 18467 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0913 21:14:12.331197 18467 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0913 21:14:12.331202 18467 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:14:12.331207 18467 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:14:12.331212 18467 net.cpp:261] This network produces output c_T
I0913 21:14:12.331217 18467 net.cpp:261] This network produces output h_pseudoloss
I0913 21:14:12.331236 18467 net.cpp:274] Network initialization done.
I0913 21:14:12.331291 18467 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0913 21:14:12.331300 18467 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0913 21:14:12.331305 18467 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0913 21:14:12.331414 18467 net.cpp:141] Setting up lstm2
I0913 21:14:12.331428 18467 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:14:12.331432 18467 net.cpp:156] Memory required for data: 36412
I0913 21:14:12.331449 18467 layer_factory.hpp:77] Creating layer predict
I0913 21:14:12.331464 18467 net.cpp:91] Creating Layer predict
I0913 21:14:12.331470 18467 net.cpp:425] predict <- lstm2
I0913 21:14:12.331478 18467 net.cpp:399] predict -> predict
I0913 21:14:12.513485 18477 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /home/peifeng/work/run/storm102/data/workers/8524ec3e-a25b-4ba5-ba1f-17cea38af44d/tmp/cvld5648128456179630686/bvlc_reference_caffenet.caffemodel
I0913 21:14:12.513530 18477 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0913 21:14:12.513536 18477 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0913 21:14:12.513541 18477 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /home/peifeng/work/run/storm102/data/workers/8524ec3e-a25b-4ba5-ba1f-17cea38af44d/tmp/cvld5648128456179630686/bvlc_reference_caffenet.caffemodel
I0913 21:14:12.823321 18467 net.cpp:141] Setting up predict
I0913 21:14:12.823388 18467 net.cpp:148] Top shape: 1 1 46168 (46168)
I0913 21:14:12.823396 18467 net.cpp:156] Memory required for data: 221084
I0913 21:14:12.823413 18467 layer_factory.hpp:77] Creating layer probs
I0913 21:14:12.823436 18467 net.cpp:91] Creating Layer probs
I0913 21:14:12.823444 18467 net.cpp:425] probs <- predict
I0913 21:14:12.823457 18467 net.cpp:399] probs -> probs
I0913 21:14:12.825356 18467 net.cpp:141] Setting up probs
I0913 21:14:12.825376 18467 net.cpp:148] Top shape: 1 1 46168 (46168)
I0913 21:14:12.825382 18467 net.cpp:156] Memory required for data: 405756
I0913 21:14:12.825388 18467 net.cpp:219] probs does not need backward computation.
I0913 21:14:12.825394 18467 net.cpp:219] predict does not need backward computation.
I0913 21:14:12.825399 18467 net.cpp:219] lstm2 does not need backward computation.
I0913 21:14:12.825407 18467 net.cpp:219] concat does not need backward computation.
I0913 21:14:12.825413 18467 net.cpp:219] lstm1 does not need backward computation.
I0913 21:14:12.825422 18467 net.cpp:219] embedding does not need backward computation.
I0913 21:14:12.825428 18467 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0913 21:14:12.825433 18467 net.cpp:219] reshape_frames does not need backward computation.
I0913 21:14:12.825438 18467 net.cpp:219] embed_encoder does not need backward computation.
I0913 21:14:12.825445 18467 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0913 21:14:12.825451 18467 net.cpp:219] input does not need backward computation.
I0913 21:14:12.825456 18467 net.cpp:261] This network produces output probs
I0913 21:14:12.825474 18467 net.cpp:274] Network initialization done.
I0913 21:14:12.912189 18477 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0913 21:14:12.964169 18477 net.cpp:752] Ignoring source layer loss
Loading the model + trained: 3621.02ms
Using cv::Size and some other stuff: 0.069ms
Loading the mean file: 564.503ms
I0913 21:14:13.239769 18467 net.cpp:752] Ignoring source layer data
I0913 21:14:13.239819 18467 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0913 21:14:13.239825 18467 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0913 21:14:13.315417 18467 net.cpp:752] Ignoring source layer cross_entropy_loss
