SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/peifeng/tools/storm102/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/peifeng/work/run/storm102/data/supervisor/stormdist/captioning-1-1473815712/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /home/peifeng/work/run/storm102/data/workers/00c98eb2-633c-4b36-b37c-1ca4fb49fdc2/tmp/cvld1927643841251949152/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0913 21:15:51.808508 20218 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0913 21:15:51.808681 20218 layer_factory.hpp:77] Creating layer data
I0913 21:15:51.808703 20218 net.cpp:91] Creating Layer data
I0913 21:15:51.808713 20218 net.cpp:399] data -> data
I0913 21:15:52.306808 20218 net.cpp:141] Setting up data
I0913 21:15:52.306912 20218 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0913 21:15:52.306918 20218 net.cpp:156] Memory required for data: 6183480
I0913 21:15:52.306938 20218 layer_factory.hpp:77] Creating layer conv1
I0913 21:15:52.306973 20218 net.cpp:91] Creating Layer conv1
I0913 21:15:52.306982 20218 net.cpp:425] conv1 <- data
I0913 21:15:52.306996 20218 net.cpp:399] conv1 -> conv1
I0913 21:15:52.471238 20208 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/00c98eb2-633c-4b36-b37c-1ca4fb49fdc2/tmp/cvld1927643841251949152/s2vt.words_to_preds.prototxt
I0913 21:15:52.471302 20208 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0913 21:15:52.471310 20208 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0913 21:15:52.471590 20208 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0913 21:15:52.471688 20208 layer_factory.hpp:77] Creating layer input
I0913 21:15:52.471704 20208 net.cpp:91] Creating Layer input
I0913 21:15:52.471712 20208 net.cpp:399] input -> frames_fc7
I0913 21:15:52.471734 20208 net.cpp:399] input -> cont_sentence
I0913 21:15:52.471743 20208 net.cpp:399] input -> input_sentence
I0913 21:15:52.471752 20208 net.cpp:399] input -> stage_indicator
I0913 21:15:52.472539 20208 net.cpp:141] Setting up input
I0913 21:15:52.472558 20208 net.cpp:148] Top shape: 1 4096 (4096)
I0913 21:15:52.472563 20208 net.cpp:148] Top shape: 1 1 (1)
I0913 21:15:52.472569 20208 net.cpp:148] Top shape: 1 1 (1)
I0913 21:15:52.472574 20208 net.cpp:148] Top shape: 1 1 (1)
I0913 21:15:52.472579 20208 net.cpp:156] Memory required for data: 16396
I0913 21:15:52.472584 20208 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0913 21:15:52.472607 20208 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0913 21:15:52.472614 20208 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0913 21:15:52.472635 20208 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0913 21:15:52.472645 20208 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0913 21:15:52.472890 20208 net.cpp:141] Setting up cont_sentence_input_1_split
I0913 21:15:52.472901 20208 net.cpp:148] Top shape: 1 1 (1)
I0913 21:15:52.472906 20208 net.cpp:148] Top shape: 1 1 (1)
I0913 21:15:52.472910 20208 net.cpp:156] Memory required for data: 16404
I0913 21:15:52.472915 20208 layer_factory.hpp:77] Creating layer embed_encoder
I0913 21:15:52.472935 20208 net.cpp:91] Creating Layer embed_encoder
I0913 21:15:52.472940 20208 net.cpp:425] embed_encoder <- frames_fc7
I0913 21:15:52.472947 20208 net.cpp:399] embed_encoder -> embedded_in_frames
I0913 21:15:52.510232 20208 net.cpp:141] Setting up embed_encoder
I0913 21:15:52.510293 20208 net.cpp:148] Top shape: 1 500 (500)
I0913 21:15:52.510303 20208 net.cpp:156] Memory required for data: 18404
I0913 21:15:52.510341 20208 layer_factory.hpp:77] Creating layer reshape_frames
I0913 21:15:52.510386 20208 net.cpp:91] Creating Layer reshape_frames
I0913 21:15:52.510399 20208 net.cpp:425] reshape_frames <- embedded_in_frames
I0913 21:15:52.510416 20208 net.cpp:399] reshape_frames -> embedded_input_frames
I0913 21:15:52.510653 20208 net.cpp:141] Setting up reshape_frames
I0913 21:15:52.510668 20208 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:15:52.510675 20208 net.cpp:156] Memory required for data: 20404
I0913 21:15:52.510682 20208 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0913 21:15:52.510700 20208 net.cpp:91] Creating Layer reshape_stage_indicator
I0913 21:15:52.510710 20208 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0913 21:15:52.510731 20208 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0913 21:15:52.510913 20208 net.cpp:141] Setting up reshape_stage_indicator
I0913 21:15:52.510928 20208 net.cpp:148] Top shape: 1 1 1 (1)
I0913 21:15:52.510936 20208 net.cpp:156] Memory required for data: 20408
I0913 21:15:52.510942 20208 layer_factory.hpp:77] Creating layer embedding
I0913 21:15:52.510962 20208 net.cpp:91] Creating Layer embedding
I0913 21:15:52.510970 20208 net.cpp:425] embedding <- input_sentence
I0913 21:15:52.510987 20208 net.cpp:399] embedding -> embedded_input_sentence
I0913 21:15:52.556463 20218 net.cpp:141] Setting up conv1
I0913 21:15:52.556524 20218 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0913 21:15:52.556531 20218 net.cpp:156] Memory required for data: 17799480
I0913 21:15:52.556557 20218 layer_factory.hpp:77] Creating layer relu1
I0913 21:15:52.556581 20218 net.cpp:91] Creating Layer relu1
I0913 21:15:52.556589 20218 net.cpp:425] relu1 <- conv1
I0913 21:15:52.556598 20218 net.cpp:386] relu1 -> conv1 (in-place)
I0913 21:15:52.557108 20218 net.cpp:141] Setting up relu1
I0913 21:15:52.557122 20218 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0913 21:15:52.557127 20218 net.cpp:156] Memory required for data: 29415480
I0913 21:15:52.557132 20218 layer_factory.hpp:77] Creating layer pool1
I0913 21:15:52.557147 20218 net.cpp:91] Creating Layer pool1
I0913 21:15:52.557152 20218 net.cpp:425] pool1 <- conv1
I0913 21:15:52.557162 20218 net.cpp:399] pool1 -> pool1
I0913 21:15:52.557246 20218 net.cpp:141] Setting up pool1
I0913 21:15:52.557256 20218 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0913 21:15:52.557261 20218 net.cpp:156] Memory required for data: 32214840
I0913 21:15:52.557266 20218 layer_factory.hpp:77] Creating layer norm1
I0913 21:15:52.557286 20218 net.cpp:91] Creating Layer norm1
I0913 21:15:52.557291 20218 net.cpp:425] norm1 <- pool1
I0913 21:15:52.557297 20218 net.cpp:399] norm1 -> norm1
I0913 21:15:52.557564 20218 net.cpp:141] Setting up norm1
I0913 21:15:52.557576 20218 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0913 21:15:52.557581 20218 net.cpp:156] Memory required for data: 35014200
I0913 21:15:52.557586 20218 layer_factory.hpp:77] Creating layer conv2
I0913 21:15:52.557603 20218 net.cpp:91] Creating Layer conv2
I0913 21:15:52.557608 20218 net.cpp:425] conv2 <- norm1
I0913 21:15:52.557615 20218 net.cpp:399] conv2 -> conv2
I0913 21:15:52.561277 20218 net.cpp:141] Setting up conv2
I0913 21:15:52.561332 20218 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0913 21:15:52.561338 20218 net.cpp:156] Memory required for data: 42479160
I0913 21:15:52.561367 20218 layer_factory.hpp:77] Creating layer relu2
I0913 21:15:52.561388 20218 net.cpp:91] Creating Layer relu2
I0913 21:15:52.561395 20218 net.cpp:425] relu2 <- conv2
I0913 21:15:52.561403 20218 net.cpp:386] relu2 -> conv2 (in-place)
I0913 21:15:52.561832 20218 net.cpp:141] Setting up relu2
I0913 21:15:52.561846 20218 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0913 21:15:52.561849 20218 net.cpp:156] Memory required for data: 49944120
I0913 21:15:52.561854 20218 layer_factory.hpp:77] Creating layer pool2
I0913 21:15:52.561867 20218 net.cpp:91] Creating Layer pool2
I0913 21:15:52.561872 20218 net.cpp:425] pool2 <- conv2
I0913 21:15:52.561882 20218 net.cpp:399] pool2 -> pool2
I0913 21:15:52.561944 20218 net.cpp:141] Setting up pool2
I0913 21:15:52.561952 20218 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:15:52.561956 20218 net.cpp:156] Memory required for data: 51674680
I0913 21:15:52.561961 20218 layer_factory.hpp:77] Creating layer norm2
I0913 21:15:52.561980 20218 net.cpp:91] Creating Layer norm2
I0913 21:15:52.561985 20218 net.cpp:425] norm2 <- pool2
I0913 21:15:52.561995 20218 net.cpp:399] norm2 -> norm2
I0913 21:15:52.562253 20218 net.cpp:141] Setting up norm2
I0913 21:15:52.562264 20218 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:15:52.562269 20218 net.cpp:156] Memory required for data: 53405240
I0913 21:15:52.562274 20218 layer_factory.hpp:77] Creating layer conv3
I0913 21:15:52.562294 20218 net.cpp:91] Creating Layer conv3
I0913 21:15:52.562299 20218 net.cpp:425] conv3 <- norm2
I0913 21:15:52.562307 20218 net.cpp:399] conv3 -> conv3
I0913 21:15:52.566870 20218 net.cpp:141] Setting up conv3
I0913 21:15:52.566926 20218 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:15:52.566932 20218 net.cpp:156] Memory required for data: 56001080
I0913 21:15:52.566961 20218 layer_factory.hpp:77] Creating layer relu3
I0913 21:15:52.566982 20218 net.cpp:91] Creating Layer relu3
I0913 21:15:52.566988 20218 net.cpp:425] relu3 <- conv3
I0913 21:15:52.566998 20218 net.cpp:386] relu3 -> conv3 (in-place)
I0913 21:15:52.567235 20218 net.cpp:141] Setting up relu3
I0913 21:15:52.567245 20218 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:15:52.567250 20218 net.cpp:156] Memory required for data: 58596920
I0913 21:15:52.567255 20218 layer_factory.hpp:77] Creating layer conv4
I0913 21:15:52.567275 20218 net.cpp:91] Creating Layer conv4
I0913 21:15:52.567279 20218 net.cpp:425] conv4 <- conv3
I0913 21:15:52.567286 20218 net.cpp:399] conv4 -> conv4
I0913 21:15:52.571547 20218 net.cpp:141] Setting up conv4
I0913 21:15:52.571575 20218 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:15:52.571580 20218 net.cpp:156] Memory required for data: 61192760
I0913 21:15:52.571591 20218 layer_factory.hpp:77] Creating layer relu4
I0913 21:15:52.571605 20218 net.cpp:91] Creating Layer relu4
I0913 21:15:52.571611 20218 net.cpp:425] relu4 <- conv4
I0913 21:15:52.571619 20218 net.cpp:386] relu4 -> conv4 (in-place)
I0913 21:15:52.572010 20218 net.cpp:141] Setting up relu4
I0913 21:15:52.572023 20218 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:15:52.572027 20218 net.cpp:156] Memory required for data: 63788600
I0913 21:15:52.572033 20218 layer_factory.hpp:77] Creating layer conv5
I0913 21:15:52.572049 20218 net.cpp:91] Creating Layer conv5
I0913 21:15:52.572053 20218 net.cpp:425] conv5 <- conv4
I0913 21:15:52.572064 20218 net.cpp:399] conv5 -> conv5
I0913 21:15:52.575861 20218 net.cpp:141] Setting up conv5
I0913 21:15:52.575902 20218 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:15:52.575908 20218 net.cpp:156] Memory required for data: 65519160
I0913 21:15:52.575929 20218 layer_factory.hpp:77] Creating layer relu5
I0913 21:15:52.575947 20218 net.cpp:91] Creating Layer relu5
I0913 21:15:52.575953 20218 net.cpp:425] relu5 <- conv5
I0913 21:15:52.575963 20218 net.cpp:386] relu5 -> conv5 (in-place)
I0913 21:15:52.576380 20218 net.cpp:141] Setting up relu5
I0913 21:15:52.576393 20218 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:15:52.576398 20218 net.cpp:156] Memory required for data: 67249720
I0913 21:15:52.576403 20218 layer_factory.hpp:77] Creating layer pool5
I0913 21:15:52.576416 20218 net.cpp:91] Creating Layer pool5
I0913 21:15:52.576421 20218 net.cpp:425] pool5 <- conv5
I0913 21:15:52.576432 20218 net.cpp:399] pool5 -> pool5
I0913 21:15:52.576498 20218 net.cpp:141] Setting up pool5
I0913 21:15:52.576506 20218 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0913 21:15:52.576510 20218 net.cpp:156] Memory required for data: 67618360
I0913 21:15:52.576515 20218 layer_factory.hpp:77] Creating layer fc6
I0913 21:15:52.576529 20218 net.cpp:91] Creating Layer fc6
I0913 21:15:52.576534 20218 net.cpp:425] fc6 <- pool5
I0913 21:15:52.576544 20218 net.cpp:399] fc6 -> fc6
I0913 21:15:52.680212 20218 net.cpp:141] Setting up fc6
I0913 21:15:52.680258 20218 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:15:52.680264 20218 net.cpp:156] Memory required for data: 67782200
I0913 21:15:52.680279 20218 layer_factory.hpp:77] Creating layer relu6
I0913 21:15:52.680294 20218 net.cpp:91] Creating Layer relu6
I0913 21:15:52.680300 20218 net.cpp:425] relu6 <- fc6
I0913 21:15:52.680307 20218 net.cpp:386] relu6 -> fc6 (in-place)
I0913 21:15:52.680649 20218 net.cpp:141] Setting up relu6
I0913 21:15:52.680660 20218 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:15:52.680663 20218 net.cpp:156] Memory required for data: 67946040
I0913 21:15:52.680668 20218 layer_factory.hpp:77] Creating layer drop6
I0913 21:15:52.680678 20218 net.cpp:91] Creating Layer drop6
I0913 21:15:52.680685 20218 net.cpp:425] drop6 <- fc6
I0913 21:15:52.680691 20218 net.cpp:386] drop6 -> fc6 (in-place)
I0913 21:15:52.680737 20218 net.cpp:141] Setting up drop6
I0913 21:15:52.680744 20218 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:15:52.680749 20218 net.cpp:156] Memory required for data: 68109880
I0913 21:15:52.680753 20218 layer_factory.hpp:77] Creating layer fc7
I0913 21:15:52.680766 20218 net.cpp:91] Creating Layer fc7
I0913 21:15:52.680771 20218 net.cpp:425] fc7 <- fc6
I0913 21:15:52.680781 20218 net.cpp:399] fc7 -> fc7
I0913 21:15:52.725052 20218 net.cpp:141] Setting up fc7
I0913 21:15:52.725111 20218 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:15:52.725117 20218 net.cpp:156] Memory required for data: 68273720
I0913 21:15:52.725131 20218 layer_factory.hpp:77] Creating layer relu7
I0913 21:15:52.725147 20218 net.cpp:91] Creating Layer relu7
I0913 21:15:52.725154 20218 net.cpp:425] relu7 <- fc7
I0913 21:15:52.725162 20218 net.cpp:386] relu7 -> fc7 (in-place)
I0913 21:15:52.725776 20218 net.cpp:141] Setting up relu7
I0913 21:15:52.725790 20218 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:15:52.725793 20218 net.cpp:156] Memory required for data: 68437560
I0913 21:15:52.725798 20218 layer_factory.hpp:77] Creating layer drop7
I0913 21:15:52.725808 20218 net.cpp:91] Creating Layer drop7
I0913 21:15:52.725812 20218 net.cpp:425] drop7 <- fc7
I0913 21:15:52.725818 20218 net.cpp:386] drop7 -> fc7 (in-place)
I0913 21:15:52.725858 20218 net.cpp:141] Setting up drop7
I0913 21:15:52.725867 20218 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:15:52.725872 20218 net.cpp:156] Memory required for data: 68601400
I0913 21:15:52.725875 20218 layer_factory.hpp:77] Creating layer fc8
I0913 21:15:52.725886 20218 net.cpp:91] Creating Layer fc8
I0913 21:15:52.725891 20218 net.cpp:425] fc8 <- fc7
I0913 21:15:52.725898 20218 net.cpp:399] fc8 -> fc8
I0913 21:15:52.734328 20208 net.cpp:141] Setting up embedding
I0913 21:15:52.734390 20208 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:15:52.734395 20208 net.cpp:156] Memory required for data: 22408
I0913 21:15:52.734419 20208 layer_factory.hpp:77] Creating layer lstm1
I0913 21:15:52.734444 20208 net.cpp:91] Creating Layer lstm1
I0913 21:15:52.734452 20208 net.cpp:425] lstm1 <- embedded_input_frames
I0913 21:15:52.734460 20208 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0913 21:15:52.734475 20208 net.cpp:399] lstm1 -> lstm1
I0913 21:15:52.734519 20208 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0913 21:15:52.734905 20208 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0913 21:15:52.734998 20208 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:15:52.735010 20208 net.cpp:91] Creating Layer lstm1_
I0913 21:15:52.735016 20208 net.cpp:399] lstm1_ -> x
I0913 21:15:52.735028 20208 net.cpp:399] lstm1_ -> cont
I0913 21:15:52.735090 20208 net.cpp:141] Setting up lstm1_
I0913 21:15:52.735098 20208 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:15:52.735103 20208 net.cpp:148] Top shape: 1 1 (1)
I0913 21:15:52.735107 20208 net.cpp:156] Memory required for data: 2004
I0913 21:15:52.735112 20208 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:15:52.735121 20208 net.cpp:91] Creating Layer lstm1_
I0913 21:15:52.735128 20208 net.cpp:399] lstm1_ -> c_0
I0913 21:15:52.735137 20208 net.cpp:399] lstm1_ -> h_0
I0913 21:15:52.735185 20208 net.cpp:141] Setting up lstm1_
I0913 21:15:52.735194 20208 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:15:52.735199 20208 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:15:52.735203 20208 net.cpp:156] Memory required for data: 10004
I0913 21:15:52.735208 20208 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0913 21:15:52.735215 20208 net.cpp:91] Creating Layer lstm1_cont_slice
I0913 21:15:52.735220 20208 net.cpp:425] lstm1_cont_slice <- cont
I0913 21:15:52.735229 20208 net.cpp:399] lstm1_cont_slice -> cont_1
I0913 21:15:52.735261 20208 net.cpp:141] Setting up lstm1_cont_slice
I0913 21:15:52.735270 20208 net.cpp:148] Top shape: 1 1 (1)
I0913 21:15:52.735275 20208 net.cpp:156] Memory required for data: 10008
I0913 21:15:52.735278 20208 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0913 21:15:52.735290 20208 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0913 21:15:52.735293 20208 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0913 21:15:52.735299 20208 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0913 21:15:52.735308 20208 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0913 21:15:52.735355 20208 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0913 21:15:52.735363 20208 net.cpp:148] Top shape: 1 1 (1)
I0913 21:15:52.735369 20208 net.cpp:148] Top shape: 1 1 (1)
I0913 21:15:52.735373 20208 net.cpp:156] Memory required for data: 10016
I0913 21:15:52.735378 20208 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0913 21:15:52.735386 20208 net.cpp:91] Creating Layer lstm1_x_transform
I0913 21:15:52.735391 20208 net.cpp:425] lstm1_x_transform <- x
I0913 21:15:52.735397 20208 net.cpp:399] lstm1_x_transform -> W_xc_x
I0913 21:15:52.739666 20218 net.cpp:141] Setting up fc8
I0913 21:15:52.739706 20218 net.cpp:148] Top shape: 10 1000 (10000)
I0913 21:15:52.739712 20218 net.cpp:156] Memory required for data: 68641400
I0913 21:15:52.739725 20218 layer_factory.hpp:77] Creating layer prob
I0913 21:15:52.739747 20218 net.cpp:91] Creating Layer prob
I0913 21:15:52.739753 20218 net.cpp:425] prob <- fc8
I0913 21:15:52.739761 20218 net.cpp:399] prob -> prob
I0913 21:15:52.740196 20218 net.cpp:141] Setting up prob
I0913 21:15:52.740211 20218 net.cpp:148] Top shape: 10 1000 (10000)
I0913 21:15:52.740216 20218 net.cpp:156] Memory required for data: 68681400
I0913 21:15:52.740222 20218 net.cpp:219] prob does not need backward computation.
I0913 21:15:52.740227 20218 net.cpp:219] fc8 does not need backward computation.
I0913 21:15:52.740231 20218 net.cpp:219] drop7 does not need backward computation.
I0913 21:15:52.740236 20218 net.cpp:219] relu7 does not need backward computation.
I0913 21:15:52.740239 20218 net.cpp:219] fc7 does not need backward computation.
I0913 21:15:52.740243 20218 net.cpp:219] drop6 does not need backward computation.
I0913 21:15:52.740247 20218 net.cpp:219] relu6 does not need backward computation.
I0913 21:15:52.740252 20218 net.cpp:219] fc6 does not need backward computation.
I0913 21:15:52.740255 20218 net.cpp:219] pool5 does not need backward computation.
I0913 21:15:52.740260 20218 net.cpp:219] relu5 does not need backward computation.
I0913 21:15:52.740264 20218 net.cpp:219] conv5 does not need backward computation.
I0913 21:15:52.740269 20218 net.cpp:219] relu4 does not need backward computation.
I0913 21:15:52.740273 20218 net.cpp:219] conv4 does not need backward computation.
I0913 21:15:52.740278 20218 net.cpp:219] relu3 does not need backward computation.
I0913 21:15:52.740281 20218 net.cpp:219] conv3 does not need backward computation.
I0913 21:15:52.740286 20218 net.cpp:219] norm2 does not need backward computation.
I0913 21:15:52.740290 20218 net.cpp:219] pool2 does not need backward computation.
I0913 21:15:52.740295 20218 net.cpp:219] relu2 does not need backward computation.
I0913 21:15:52.740299 20218 net.cpp:219] conv2 does not need backward computation.
I0913 21:15:52.740303 20218 net.cpp:219] norm1 does not need backward computation.
I0913 21:15:52.740308 20218 net.cpp:219] pool1 does not need backward computation.
I0913 21:15:52.740311 20218 net.cpp:219] relu1 does not need backward computation.
I0913 21:15:52.740315 20218 net.cpp:219] conv1 does not need backward computation.
I0913 21:15:52.740319 20218 net.cpp:219] data does not need backward computation.
I0913 21:15:52.740324 20218 net.cpp:261] This network produces output prob
I0913 21:15:52.740344 20218 net.cpp:274] Network initialization done.
I0913 21:15:52.754602 20208 net.cpp:141] Setting up lstm1_x_transform
I0913 21:15:52.754649 20208 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:15:52.754654 20208 net.cpp:156] Memory required for data: 26016
I0913 21:15:52.754678 20208 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0913 21:15:52.754699 20208 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0913 21:15:52.754706 20208 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0913 21:15:52.754716 20208 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0913 21:15:52.754760 20208 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0913 21:15:52.754770 20208 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:15:52.754773 20208 net.cpp:156] Memory required for data: 42016
I0913 21:15:52.754778 20208 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0913 21:15:52.754791 20208 net.cpp:91] Creating Layer lstm1_h_conted_0
I0913 21:15:52.754796 20208 net.cpp:425] lstm1_h_conted_0 <- h_0
I0913 21:15:52.754801 20208 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0913 21:15:52.754808 20208 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0913 21:15:52.754904 20208 net.cpp:141] Setting up lstm1_h_conted_0
I0913 21:15:52.754912 20208 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:15:52.754917 20208 net.cpp:156] Memory required for data: 46016
I0913 21:15:52.754921 20208 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0913 21:15:52.754938 20208 net.cpp:91] Creating Layer lstm1_transform_1
I0913 21:15:52.754943 20208 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0913 21:15:52.754951 20208 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0913 21:15:52.794749 20208 net.cpp:141] Setting up lstm1_transform_1
I0913 21:15:52.794797 20208 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:15:52.794803 20208 net.cpp:156] Memory required for data: 62016
I0913 21:15:52.794821 20208 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0913 21:15:52.794842 20208 net.cpp:91] Creating Layer lstm1_gate_input_1
I0913 21:15:52.794850 20208 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0913 21:15:52.794857 20208 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0913 21:15:52.794865 20208 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0913 21:15:52.794919 20208 net.cpp:141] Setting up lstm1_gate_input_1
I0913 21:15:52.794929 20208 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:15:52.794932 20208 net.cpp:156] Memory required for data: 78016
I0913 21:15:52.794937 20208 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0913 21:15:52.794950 20208 net.cpp:91] Creating Layer lstm1_unit_1
I0913 21:15:52.794953 20208 net.cpp:425] lstm1_unit_1 <- c_0
I0913 21:15:52.794960 20208 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0913 21:15:52.794965 20208 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0913 21:15:52.794970 20208 net.cpp:399] lstm1_unit_1 -> c_1
I0913 21:15:52.794978 20208 net.cpp:399] lstm1_unit_1 -> h_1
I0913 21:15:52.795042 20208 net.cpp:141] Setting up lstm1_unit_1
I0913 21:15:52.795050 20208 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:15:52.795056 20208 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:15:52.795060 20208 net.cpp:156] Memory required for data: 86016
I0913 21:15:52.795064 20208 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:15:52.795073 20208 net.cpp:91] Creating Layer lstm1_
I0913 21:15:52.795078 20208 net.cpp:425] lstm1_ <- c_1
I0913 21:15:52.795086 20208 net.cpp:399] lstm1_ -> c_T
I0913 21:15:52.795117 20208 net.cpp:141] Setting up lstm1_
I0913 21:15:52.795125 20208 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:15:52.795130 20208 net.cpp:156] Memory required for data: 90016
I0913 21:15:52.795133 20208 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0913 21:15:52.795142 20208 net.cpp:91] Creating Layer lstm1_h_concat
I0913 21:15:52.795146 20208 net.cpp:425] lstm1_h_concat <- h_1
I0913 21:15:52.795158 20208 net.cpp:399] lstm1_h_concat -> h
I0913 21:15:52.795203 20208 net.cpp:141] Setting up lstm1_h_concat
I0913 21:15:52.795212 20208 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:15:52.795214 20208 net.cpp:156] Memory required for data: 94016
I0913 21:15:52.795219 20208 layer_factory.hpp:77] Creating layer h_pseudoloss
I0913 21:15:52.795234 20208 net.cpp:91] Creating Layer h_pseudoloss
I0913 21:15:52.795238 20208 net.cpp:425] h_pseudoloss <- h
I0913 21:15:52.795245 20208 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0913 21:15:52.795336 20208 net.cpp:141] Setting up h_pseudoloss
I0913 21:15:52.795346 20208 net.cpp:148] Top shape: (1)
I0913 21:15:52.795351 20208 net.cpp:151]     with loss weight 1
I0913 21:15:52.795382 20208 net.cpp:156] Memory required for data: 94020
I0913 21:15:52.795387 20208 net.cpp:217] h_pseudoloss needs backward computation.
I0913 21:15:52.795392 20208 net.cpp:217] lstm1_h_concat needs backward computation.
I0913 21:15:52.795397 20208 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:15:52.795402 20208 net.cpp:217] lstm1_unit_1 needs backward computation.
I0913 21:15:52.795406 20208 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0913 21:15:52.795411 20208 net.cpp:217] lstm1_transform_1 needs backward computation.
I0913 21:15:52.795415 20208 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0913 21:15:52.795421 20208 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0913 21:15:52.795425 20208 net.cpp:217] lstm1_x_transform needs backward computation.
I0913 21:15:52.795430 20208 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0913 21:15:52.795435 20208 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0913 21:15:52.795440 20208 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:15:52.795444 20208 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:15:52.795447 20208 net.cpp:261] This network produces output c_T
I0913 21:15:52.795451 20208 net.cpp:261] This network produces output h_pseudoloss
I0913 21:15:52.795465 20208 net.cpp:274] Network initialization done.
I0913 21:15:52.795517 20208 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0913 21:15:52.795523 20208 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0913 21:15:52.795527 20208 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0913 21:15:52.795634 20208 net.cpp:141] Setting up lstm1
I0913 21:15:52.795646 20208 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:15:52.795650 20208 net.cpp:156] Memory required for data: 26408
I0913 21:15:52.795663 20208 layer_factory.hpp:77] Creating layer concat
I0913 21:15:52.795671 20208 net.cpp:91] Creating Layer concat
I0913 21:15:52.795677 20208 net.cpp:425] concat <- lstm1
I0913 21:15:52.795683 20208 net.cpp:425] concat <- embedded_input_sentence
I0913 21:15:52.795688 20208 net.cpp:425] concat <- reshaped_stage_indicator
I0913 21:15:52.795694 20208 net.cpp:399] concat -> lstm1_video_sequence
I0913 21:15:52.795727 20208 net.cpp:141] Setting up concat
I0913 21:15:52.795734 20208 net.cpp:148] Top shape: 1 1 1501 (1501)
I0913 21:15:52.795739 20208 net.cpp:156] Memory required for data: 32412
I0913 21:15:52.795743 20208 layer_factory.hpp:77] Creating layer lstm2
I0913 21:15:52.795754 20208 net.cpp:91] Creating Layer lstm2
I0913 21:15:52.795759 20208 net.cpp:425] lstm2 <- lstm1_video_sequence
I0913 21:15:52.795764 20208 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0913 21:15:52.795771 20208 net.cpp:399] lstm2 -> lstm2
I0913 21:15:52.795781 20208 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0913 21:15:52.796011 20208 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0913 21:15:52.796102 20208 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:15:52.796114 20208 net.cpp:91] Creating Layer lstm2_
I0913 21:15:52.796119 20208 net.cpp:399] lstm2_ -> x
I0913 21:15:52.796129 20208 net.cpp:399] lstm2_ -> cont
I0913 21:15:52.796181 20208 net.cpp:141] Setting up lstm2_
I0913 21:15:52.796190 20208 net.cpp:148] Top shape: 1 1 1501 (1501)
I0913 21:15:52.796195 20208 net.cpp:148] Top shape: 1 1 (1)
I0913 21:15:52.796200 20208 net.cpp:156] Memory required for data: 6008
I0913 21:15:52.796205 20208 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:15:52.796216 20208 net.cpp:91] Creating Layer lstm2_
I0913 21:15:52.796222 20208 net.cpp:399] lstm2_ -> c_0
I0913 21:15:52.796231 20208 net.cpp:399] lstm2_ -> h_0
I0913 21:15:52.796278 20208 net.cpp:141] Setting up lstm2_
I0913 21:15:52.796293 20208 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:15:52.796301 20208 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:15:52.796308 20208 net.cpp:156] Memory required for data: 14008
I0913 21:15:52.796314 20208 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0913 21:15:52.796325 20208 net.cpp:91] Creating Layer lstm2_cont_slice
I0913 21:15:52.796330 20208 net.cpp:425] lstm2_cont_slice <- cont
I0913 21:15:52.796337 20208 net.cpp:399] lstm2_cont_slice -> cont_1
I0913 21:15:52.796375 20208 net.cpp:141] Setting up lstm2_cont_slice
I0913 21:15:52.796383 20208 net.cpp:148] Top shape: 1 1 (1)
I0913 21:15:52.796387 20208 net.cpp:156] Memory required for data: 14012
I0913 21:15:52.796391 20208 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0913 21:15:52.796397 20208 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0913 21:15:52.796406 20208 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0913 21:15:52.796411 20208 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0913 21:15:52.796418 20208 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0913 21:15:52.796463 20208 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0913 21:15:52.796471 20208 net.cpp:148] Top shape: 1 1 (1)
I0913 21:15:52.796476 20208 net.cpp:148] Top shape: 1 1 (1)
I0913 21:15:52.796480 20208 net.cpp:156] Memory required for data: 14020
I0913 21:15:52.796484 20208 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0913 21:15:52.796494 20208 net.cpp:91] Creating Layer lstm2_x_transform
I0913 21:15:52.796497 20208 net.cpp:425] lstm2_x_transform <- x
I0913 21:15:52.796507 20208 net.cpp:399] lstm2_x_transform -> W_xc_x
I0913 21:15:52.853694 20208 net.cpp:141] Setting up lstm2_x_transform
I0913 21:15:52.853739 20208 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:15:52.853744 20208 net.cpp:156] Memory required for data: 30020
I0913 21:15:52.853765 20208 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0913 21:15:52.853780 20208 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0913 21:15:52.853785 20208 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0913 21:15:52.853798 20208 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0913 21:15:52.853842 20208 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0913 21:15:52.853852 20208 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:15:52.853855 20208 net.cpp:156] Memory required for data: 46020
I0913 21:15:52.853860 20208 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0913 21:15:52.853869 20208 net.cpp:91] Creating Layer lstm2_h_conted_0
I0913 21:15:52.853874 20208 net.cpp:425] lstm2_h_conted_0 <- h_0
I0913 21:15:52.853880 20208 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0913 21:15:52.853886 20208 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0913 21:15:52.853981 20208 net.cpp:141] Setting up lstm2_h_conted_0
I0913 21:15:52.853991 20208 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:15:52.853994 20208 net.cpp:156] Memory required for data: 50020
I0913 21:15:52.853998 20208 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0913 21:15:52.854010 20208 net.cpp:91] Creating Layer lstm2_transform_1
I0913 21:15:52.854014 20208 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0913 21:15:52.854024 20208 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0913 21:15:52.894269 20208 net.cpp:141] Setting up lstm2_transform_1
I0913 21:15:52.894325 20208 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:15:52.894331 20208 net.cpp:156] Memory required for data: 66020
I0913 21:15:52.894351 20208 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0913 21:15:52.894379 20208 net.cpp:91] Creating Layer lstm2_gate_input_1
I0913 21:15:52.894387 20208 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0913 21:15:52.894393 20208 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0913 21:15:52.894400 20208 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0913 21:15:52.894454 20208 net.cpp:141] Setting up lstm2_gate_input_1
I0913 21:15:52.894467 20208 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:15:52.894474 20208 net.cpp:156] Memory required for data: 82020
I0913 21:15:52.894481 20208 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0913 21:15:52.894493 20208 net.cpp:91] Creating Layer lstm2_unit_1
I0913 21:15:52.894501 20208 net.cpp:425] lstm2_unit_1 <- c_0
I0913 21:15:52.894510 20208 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0913 21:15:52.894518 20208 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0913 21:15:52.894533 20208 net.cpp:399] lstm2_unit_1 -> c_1
I0913 21:15:52.894547 20208 net.cpp:399] lstm2_unit_1 -> h_1
I0913 21:15:52.894649 20208 net.cpp:141] Setting up lstm2_unit_1
I0913 21:15:52.894665 20208 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:15:52.894675 20208 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:15:52.894681 20208 net.cpp:156] Memory required for data: 90020
I0913 21:15:52.894690 20208 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:15:52.894701 20208 net.cpp:91] Creating Layer lstm2_
I0913 21:15:52.894707 20208 net.cpp:425] lstm2_ <- c_1
I0913 21:15:52.894718 20208 net.cpp:399] lstm2_ -> c_T
I0913 21:15:52.894768 20208 net.cpp:141] Setting up lstm2_
I0913 21:15:52.894783 20208 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:15:52.894790 20208 net.cpp:156] Memory required for data: 94020
I0913 21:15:52.894798 20208 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0913 21:15:52.894815 20208 net.cpp:91] Creating Layer lstm2_h_concat
I0913 21:15:52.894824 20208 net.cpp:425] lstm2_h_concat <- h_1
I0913 21:15:52.894836 20208 net.cpp:399] lstm2_h_concat -> h
I0913 21:15:52.894891 20208 net.cpp:141] Setting up lstm2_h_concat
I0913 21:15:52.894906 20208 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:15:52.894913 20208 net.cpp:156] Memory required for data: 98020
I0913 21:15:52.894922 20208 layer_factory.hpp:77] Creating layer h_pseudoloss
I0913 21:15:52.894935 20208 net.cpp:91] Creating Layer h_pseudoloss
I0913 21:15:52.894944 20208 net.cpp:425] h_pseudoloss <- h
I0913 21:15:52.894956 20208 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0913 21:15:52.895083 20208 net.cpp:141] Setting up h_pseudoloss
I0913 21:15:52.895097 20208 net.cpp:148] Top shape: (1)
I0913 21:15:52.895104 20208 net.cpp:151]     with loss weight 1
I0913 21:15:52.895125 20208 net.cpp:156] Memory required for data: 98024
I0913 21:15:52.895133 20208 net.cpp:217] h_pseudoloss needs backward computation.
I0913 21:15:52.895140 20208 net.cpp:217] lstm2_h_concat needs backward computation.
I0913 21:15:52.895148 20208 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:15:52.895154 20208 net.cpp:217] lstm2_unit_1 needs backward computation.
I0913 21:15:52.895164 20208 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0913 21:15:52.895171 20208 net.cpp:217] lstm2_transform_1 needs backward computation.
I0913 21:15:52.895179 20208 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0913 21:15:52.895189 20208 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0913 21:15:52.895196 20208 net.cpp:217] lstm2_x_transform needs backward computation.
I0913 21:15:52.895203 20208 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0913 21:15:52.895212 20208 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0913 21:15:52.895225 20208 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:15:52.895231 20208 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:15:52.895237 20208 net.cpp:261] This network produces output c_T
I0913 21:15:52.895244 20208 net.cpp:261] This network produces output h_pseudoloss
I0913 21:15:52.895267 20208 net.cpp:274] Network initialization done.
I0913 21:15:52.895334 20208 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0913 21:15:52.895344 20208 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0913 21:15:52.895350 20208 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0913 21:15:52.895493 20208 net.cpp:141] Setting up lstm2
I0913 21:15:52.895508 20208 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:15:52.895515 20208 net.cpp:156] Memory required for data: 36412
I0913 21:15:52.895536 20208 layer_factory.hpp:77] Creating layer predict
I0913 21:15:52.895553 20208 net.cpp:91] Creating Layer predict
I0913 21:15:52.895562 20208 net.cpp:425] predict <- lstm2
I0913 21:15:52.895576 20208 net.cpp:399] predict -> predict
I0913 21:15:53.023624 20218 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /home/peifeng/work/run/storm102/data/workers/00c98eb2-633c-4b36-b37c-1ca4fb49fdc2/tmp/cvld1927643841251949152/bvlc_reference_caffenet.caffemodel
I0913 21:15:53.023670 20218 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0913 21:15:53.023675 20218 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0913 21:15:53.023679 20218 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /home/peifeng/work/run/storm102/data/workers/00c98eb2-633c-4b36-b37c-1ca4fb49fdc2/tmp/cvld1927643841251949152/bvlc_reference_caffenet.caffemodel
I0913 21:15:53.330039 20208 net.cpp:141] Setting up predict
I0913 21:15:53.330094 20208 net.cpp:148] Top shape: 1 1 46168 (46168)
I0913 21:15:53.330101 20208 net.cpp:156] Memory required for data: 221084
I0913 21:15:53.330116 20208 layer_factory.hpp:77] Creating layer probs
I0913 21:15:53.330135 20208 net.cpp:91] Creating Layer probs
I0913 21:15:53.330142 20208 net.cpp:425] probs <- predict
I0913 21:15:53.330153 20208 net.cpp:399] probs -> probs
I0913 21:15:53.331012 20208 net.cpp:141] Setting up probs
I0913 21:15:53.331028 20208 net.cpp:148] Top shape: 1 1 46168 (46168)
I0913 21:15:53.331033 20208 net.cpp:156] Memory required for data: 405756
I0913 21:15:53.331039 20208 net.cpp:219] probs does not need backward computation.
I0913 21:15:53.331044 20208 net.cpp:219] predict does not need backward computation.
I0913 21:15:53.331048 20208 net.cpp:219] lstm2 does not need backward computation.
I0913 21:15:53.331055 20208 net.cpp:219] concat does not need backward computation.
I0913 21:15:53.331061 20208 net.cpp:219] lstm1 does not need backward computation.
I0913 21:15:53.331068 20208 net.cpp:219] embedding does not need backward computation.
I0913 21:15:53.331073 20208 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0913 21:15:53.331079 20208 net.cpp:219] reshape_frames does not need backward computation.
I0913 21:15:53.331084 20208 net.cpp:219] embed_encoder does not need backward computation.
I0913 21:15:53.331087 20208 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0913 21:15:53.331094 20208 net.cpp:219] input does not need backward computation.
I0913 21:15:53.331096 20208 net.cpp:261] This network produces output probs
I0913 21:15:53.331115 20208 net.cpp:274] Network initialization done.
I0913 21:15:53.384232 20218 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0913 21:15:53.433013 20218 net.cpp:752] Ignoring source layer loss
Loading the model + trained: 9697.56ms
Using cv::Size and some other stuff: 0.145ms
Loading the mean file: 1822.64ms
I0913 21:15:53.711802 20208 net.cpp:752] Ignoring source layer data
I0913 21:15:53.711838 20208 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0913 21:15:53.711843 20208 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0913 21:15:53.784839 20208 net.cpp:752] Ignoring source layer cross_entropy_loss
TIMERTIMER 130100817
TIMERTIMER 70816352
TIMERTIMER 71990916
TIMERTIMER 49411543
TIMERTIMER 48482391
TIMERTIMER 41708693
TIMERTIMER 46952203
TIMERTIMER 43896480
TIMERTIMER 47391201
TIMERTIMER 46225857
TIMERTIMER 46618134
TIMERTIMER 47305938
TIMERTIMER 48131540
TIMERTIMER 46290827
TIMERTIMER 41836618
TIMERTIMER 50680231
TIMERTIMER 43055437
TIMERTIMER 47366898
TIMERTIMER 49583959
TIMERTIMER 32391849
TIMERTIMER 31280149
TIMERTIMER 31511453
TIMERTIMER 31150605
TIMERTIMER 31955386
TIMERTIMER 31162873
TIMERTIMER 31206760
TIMERTIMER 32063890
TIMERTIMER 33526341
TIMERTIMER 37937280
TIMERTIMER 37809188
TIMERTIMER 38218852
TIMERTIMER 33032737
TIMERTIMER 32010953
TIMERTIMER 38116750
TIMERTIMER 32602332
TIMERTIMER 39636509
TIMERTIMER 32615508
TIMERTIMER 31885903
TIMERTIMER 38555883
TIMERTIMER 38126539
TIMERTIMER 32120799
TIMERTIMER 38285954
TIMERTIMER 38436836
TIMERTIMER 39596322
TIMERTIMER 53207794
TIMERTIMER 31866790
TIMERTIMER 37922985
TIMERTIMER 31812923
TIMERTIMER 31924205
TIMERTIMER 31777840
TIMERTIMER 31766379
TIMERTIMER 32303247
TIMERTIMER 31841556
TIMERTIMER 32207377
TIMERTIMER 31968602
TIMERTIMER 38903046
TIMERTIMER 32076803
TIMERTIMER 31936236
TIMERTIMER 32732687
TIMERTIMER 38163107
TIMERTIMER 38153451
TIMERTIMER 47988363
TIMERTIMER 43145603
TIMERTIMER 31982851
TIMERTIMER 39524727
TIMERTIMER 31866165
TIMERTIMER 39326981
TIMERTIMER 32740754
TIMERTIMER 39135054
TIMERTIMER 33058486
TIMERTIMER 38166921
TIMERTIMER 31962547
TIMERTIMER 31939456
TIMERTIMER 32692036
TIMERTIMER 32475670
TIMERTIMER 32377601
TIMERTIMER 32007589
TIMERTIMER 31731485
TIMERTIMER 31979312
TIMERTIMER 32308292
TIMERTIMER 31960230
TIMERTIMER 32950913
TIMERTIMER 38706795
TIMERTIMER 38030963
TIMERTIMER 32491725
TIMERTIMER 32082469
TIMERTIMER 32212236
TIMERTIMER 32212112
TIMERTIMER 33059105
TIMERTIMER 33620588
TIMERTIMER 41803171
TIMERTIMER 33368723
TIMERTIMER 33604151
TIMERTIMER 31782726
TIMERTIMER 32390322
TIMERTIMER 32062291
TIMERTIMER 31891984
TIMERTIMER 32807449
TIMERTIMER 38853398
TIMERTIMER 38053172
TIMERTIMER 31729288
TIMERTIMER 38802406
TIMERTIMER 33214952
TIMERTIMER 31825860
TIMERTIMER 32073696
TIMERTIMER 31844080
TIMERTIMER 36373012
TIMERTIMER 31786307
TIMERTIMER 31818814
TIMERTIMER 32821679
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/peifeng/tools/storm102/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/peifeng/work/run/storm102/data/supervisor/stormdist/captioning-1-1473815712/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /home/peifeng/work/run/storm102/data/workers/cef86a2e-7d2c-4e58-9cd4-00d749663619/tmp/cvld4365780248502595320/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0913 21:17:13.475771 20368 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0913 21:17:13.475986 20368 layer_factory.hpp:77] Creating layer data
I0913 21:17:13.476016 20368 net.cpp:91] Creating Layer data
I0913 21:17:13.476027 20368 net.cpp:399] data -> data
I0913 21:17:14.088846 20368 net.cpp:141] Setting up data
I0913 21:17:14.088999 20368 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0913 21:17:14.089011 20368 net.cpp:156] Memory required for data: 6183480
I0913 21:17:14.089048 20368 layer_factory.hpp:77] Creating layer conv1
I0913 21:17:14.089103 20368 net.cpp:91] Creating Layer conv1
I0913 21:17:14.089119 20368 net.cpp:425] conv1 <- data
I0913 21:17:14.089140 20368 net.cpp:399] conv1 -> conv1
I0913 21:17:14.162885 20358 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/cef86a2e-7d2c-4e58-9cd4-00d749663619/tmp/cvld4365780248502595320/s2vt.words_to_preds.prototxt
I0913 21:17:14.162941 20358 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0913 21:17:14.162950 20358 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0913 21:17:14.163234 20358 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0913 21:17:14.163331 20358 layer_factory.hpp:77] Creating layer input
I0913 21:17:14.163362 20358 net.cpp:91] Creating Layer input
I0913 21:17:14.163372 20358 net.cpp:399] input -> frames_fc7
I0913 21:17:14.163389 20358 net.cpp:399] input -> cont_sentence
I0913 21:17:14.163399 20358 net.cpp:399] input -> input_sentence
I0913 21:17:14.163409 20358 net.cpp:399] input -> stage_indicator
I0913 21:17:14.165191 20358 net.cpp:141] Setting up input
I0913 21:17:14.165211 20358 net.cpp:148] Top shape: 1 4096 (4096)
I0913 21:17:14.165218 20358 net.cpp:148] Top shape: 1 1 (1)
I0913 21:17:14.165225 20358 net.cpp:148] Top shape: 1 1 (1)
I0913 21:17:14.165230 20358 net.cpp:148] Top shape: 1 1 (1)
I0913 21:17:14.165233 20358 net.cpp:156] Memory required for data: 16396
I0913 21:17:14.165238 20358 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0913 21:17:14.165258 20358 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0913 21:17:14.165264 20358 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0913 21:17:14.165285 20358 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0913 21:17:14.165297 20358 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0913 21:17:14.171155 20358 net.cpp:141] Setting up cont_sentence_input_1_split
I0913 21:17:14.171182 20358 net.cpp:148] Top shape: 1 1 (1)
I0913 21:17:14.171190 20358 net.cpp:148] Top shape: 1 1 (1)
I0913 21:17:14.171193 20358 net.cpp:156] Memory required for data: 16404
I0913 21:17:14.171200 20358 layer_factory.hpp:77] Creating layer embed_encoder
I0913 21:17:14.171224 20358 net.cpp:91] Creating Layer embed_encoder
I0913 21:17:14.171231 20358 net.cpp:425] embed_encoder <- frames_fc7
I0913 21:17:14.171241 20358 net.cpp:399] embed_encoder -> embedded_in_frames
I0913 21:17:14.199445 20358 net.cpp:141] Setting up embed_encoder
I0913 21:17:14.199491 20358 net.cpp:148] Top shape: 1 500 (500)
I0913 21:17:14.199497 20358 net.cpp:156] Memory required for data: 18404
I0913 21:17:14.199523 20358 layer_factory.hpp:77] Creating layer reshape_frames
I0913 21:17:14.199553 20358 net.cpp:91] Creating Layer reshape_frames
I0913 21:17:14.199560 20358 net.cpp:425] reshape_frames <- embedded_in_frames
I0913 21:17:14.199573 20358 net.cpp:399] reshape_frames -> embedded_input_frames
I0913 21:17:14.203590 20358 net.cpp:141] Setting up reshape_frames
I0913 21:17:14.203619 20358 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:17:14.203625 20358 net.cpp:156] Memory required for data: 20404
I0913 21:17:14.203631 20358 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0913 21:17:14.203646 20358 net.cpp:91] Creating Layer reshape_stage_indicator
I0913 21:17:14.203652 20358 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0913 21:17:14.203662 20358 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0913 21:17:14.203819 20358 net.cpp:141] Setting up reshape_stage_indicator
I0913 21:17:14.203830 20358 net.cpp:148] Top shape: 1 1 1 (1)
I0913 21:17:14.203833 20358 net.cpp:156] Memory required for data: 20408
I0913 21:17:14.203838 20358 layer_factory.hpp:77] Creating layer embedding
I0913 21:17:14.203851 20358 net.cpp:91] Creating Layer embedding
I0913 21:17:14.203855 20358 net.cpp:425] embedding <- input_sentence
I0913 21:17:14.203865 20358 net.cpp:399] embedding -> embedded_input_sentence
I0913 21:17:14.351934 20368 net.cpp:141] Setting up conv1
I0913 21:17:14.351989 20368 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0913 21:17:14.351999 20368 net.cpp:156] Memory required for data: 17799480
I0913 21:17:14.352031 20368 layer_factory.hpp:77] Creating layer relu1
I0913 21:17:14.352059 20368 net.cpp:91] Creating Layer relu1
I0913 21:17:14.352083 20368 net.cpp:425] relu1 <- conv1
I0913 21:17:14.352099 20368 net.cpp:386] relu1 -> conv1 (in-place)
I0913 21:17:14.352651 20368 net.cpp:141] Setting up relu1
I0913 21:17:14.352671 20368 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0913 21:17:14.352681 20368 net.cpp:156] Memory required for data: 29415480
I0913 21:17:14.352691 20368 layer_factory.hpp:77] Creating layer pool1
I0913 21:17:14.352715 20368 net.cpp:91] Creating Layer pool1
I0913 21:17:14.352725 20368 net.cpp:425] pool1 <- conv1
I0913 21:17:14.352738 20368 net.cpp:399] pool1 -> pool1
I0913 21:17:14.352857 20368 net.cpp:141] Setting up pool1
I0913 21:17:14.352876 20368 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0913 21:17:14.352886 20368 net.cpp:156] Memory required for data: 32214840
I0913 21:17:14.352896 20368 layer_factory.hpp:77] Creating layer norm1
I0913 21:17:14.352927 20368 net.cpp:91] Creating Layer norm1
I0913 21:17:14.352939 20368 net.cpp:425] norm1 <- pool1
I0913 21:17:14.352954 20368 net.cpp:399] norm1 -> norm1
I0913 21:17:14.353437 20368 net.cpp:141] Setting up norm1
I0913 21:17:14.353458 20368 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0913 21:17:14.353468 20368 net.cpp:156] Memory required for data: 35014200
I0913 21:17:14.353478 20368 layer_factory.hpp:77] Creating layer conv2
I0913 21:17:14.353507 20368 net.cpp:91] Creating Layer conv2
I0913 21:17:14.353518 20368 net.cpp:425] conv2 <- norm1
I0913 21:17:14.353534 20368 net.cpp:399] conv2 -> conv2
I0913 21:17:14.357703 20368 net.cpp:141] Setting up conv2
I0913 21:17:14.357729 20368 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0913 21:17:14.357739 20368 net.cpp:156] Memory required for data: 42479160
I0913 21:17:14.357771 20368 layer_factory.hpp:77] Creating layer relu2
I0913 21:17:14.357795 20368 net.cpp:91] Creating Layer relu2
I0913 21:17:14.357806 20368 net.cpp:425] relu2 <- conv2
I0913 21:17:14.357825 20368 net.cpp:386] relu2 -> conv2 (in-place)
I0913 21:17:14.358443 20368 net.cpp:141] Setting up relu2
I0913 21:17:14.358461 20368 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0913 21:17:14.358471 20368 net.cpp:156] Memory required for data: 49944120
I0913 21:17:14.358484 20368 layer_factory.hpp:77] Creating layer pool2
I0913 21:17:14.358508 20368 net.cpp:91] Creating Layer pool2
I0913 21:17:14.358520 20368 net.cpp:425] pool2 <- conv2
I0913 21:17:14.358535 20368 net.cpp:399] pool2 -> pool2
I0913 21:17:14.358633 20368 net.cpp:141] Setting up pool2
I0913 21:17:14.358649 20368 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:17:14.358659 20368 net.cpp:156] Memory required for data: 51674680
I0913 21:17:14.358669 20368 layer_factory.hpp:77] Creating layer norm2
I0913 21:17:14.358687 20368 net.cpp:91] Creating Layer norm2
I0913 21:17:14.358698 20368 net.cpp:425] norm2 <- pool2
I0913 21:17:14.358718 20368 net.cpp:399] norm2 -> norm2
I0913 21:17:14.359171 20368 net.cpp:141] Setting up norm2
I0913 21:17:14.359194 20368 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:17:14.359205 20368 net.cpp:156] Memory required for data: 53405240
I0913 21:17:14.359215 20368 layer_factory.hpp:77] Creating layer conv3
I0913 21:17:14.359233 20368 net.cpp:91] Creating Layer conv3
I0913 21:17:14.359244 20368 net.cpp:425] conv3 <- norm2
I0913 21:17:14.359266 20368 net.cpp:399] conv3 -> conv3
I0913 21:17:14.364500 20368 net.cpp:141] Setting up conv3
I0913 21:17:14.364531 20368 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:17:14.364542 20368 net.cpp:156] Memory required for data: 56001080
I0913 21:17:14.364570 20368 layer_factory.hpp:77] Creating layer relu3
I0913 21:17:14.364595 20368 net.cpp:91] Creating Layer relu3
I0913 21:17:14.364606 20368 net.cpp:425] relu3 <- conv3
I0913 21:17:14.364620 20368 net.cpp:386] relu3 -> conv3 (in-place)
I0913 21:17:14.365016 20368 net.cpp:141] Setting up relu3
I0913 21:17:14.365036 20368 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:17:14.365046 20368 net.cpp:156] Memory required for data: 58596920
I0913 21:17:14.365061 20368 layer_factory.hpp:77] Creating layer conv4
I0913 21:17:14.365092 20368 net.cpp:91] Creating Layer conv4
I0913 21:17:14.365103 20368 net.cpp:425] conv4 <- conv3
I0913 21:17:14.365120 20368 net.cpp:399] conv4 -> conv4
I0913 21:17:14.369778 20368 net.cpp:141] Setting up conv4
I0913 21:17:14.369817 20368 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:17:14.369827 20368 net.cpp:156] Memory required for data: 61192760
I0913 21:17:14.369845 20368 layer_factory.hpp:77] Creating layer relu4
I0913 21:17:14.369871 20368 net.cpp:91] Creating Layer relu4
I0913 21:17:14.369884 20368 net.cpp:425] relu4 <- conv4
I0913 21:17:14.369897 20368 net.cpp:386] relu4 -> conv4 (in-place)
I0913 21:17:14.370486 20368 net.cpp:141] Setting up relu4
I0913 21:17:14.370507 20368 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:17:14.370515 20368 net.cpp:156] Memory required for data: 63788600
I0913 21:17:14.370527 20368 layer_factory.hpp:77] Creating layer conv5
I0913 21:17:14.370558 20368 net.cpp:91] Creating Layer conv5
I0913 21:17:14.370569 20368 net.cpp:425] conv5 <- conv4
I0913 21:17:14.370585 20368 net.cpp:399] conv5 -> conv5
I0913 21:17:14.374858 20368 net.cpp:141] Setting up conv5
I0913 21:17:14.374886 20368 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:17:14.374897 20368 net.cpp:156] Memory required for data: 65519160
I0913 21:17:14.374922 20368 layer_factory.hpp:77] Creating layer relu5
I0913 21:17:14.374946 20368 net.cpp:91] Creating Layer relu5
I0913 21:17:14.374958 20368 net.cpp:425] relu5 <- conv5
I0913 21:17:14.374970 20368 net.cpp:386] relu5 -> conv5 (in-place)
I0913 21:17:14.375577 20368 net.cpp:141] Setting up relu5
I0913 21:17:14.375598 20368 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:17:14.375608 20368 net.cpp:156] Memory required for data: 67249720
I0913 21:17:14.375617 20368 layer_factory.hpp:77] Creating layer pool5
I0913 21:17:14.375643 20368 net.cpp:91] Creating Layer pool5
I0913 21:17:14.375654 20368 net.cpp:425] pool5 <- conv5
I0913 21:17:14.375669 20368 net.cpp:399] pool5 -> pool5
I0913 21:17:14.375787 20368 net.cpp:141] Setting up pool5
I0913 21:17:14.375804 20368 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0913 21:17:14.375813 20368 net.cpp:156] Memory required for data: 67618360
I0913 21:17:14.375824 20368 layer_factory.hpp:77] Creating layer fc6
I0913 21:17:14.375857 20368 net.cpp:91] Creating Layer fc6
I0913 21:17:14.375869 20368 net.cpp:425] fc6 <- pool5
I0913 21:17:14.375885 20368 net.cpp:399] fc6 -> fc6
I0913 21:17:14.461689 20358 net.cpp:141] Setting up embedding
I0913 21:17:14.461756 20358 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:17:14.461762 20358 net.cpp:156] Memory required for data: 22408
I0913 21:17:14.461782 20358 layer_factory.hpp:77] Creating layer lstm1
I0913 21:17:14.461804 20358 net.cpp:91] Creating Layer lstm1
I0913 21:17:14.461812 20358 net.cpp:425] lstm1 <- embedded_input_frames
I0913 21:17:14.461820 20358 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0913 21:17:14.461835 20358 net.cpp:399] lstm1 -> lstm1
I0913 21:17:14.461877 20358 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0913 21:17:14.462270 20358 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0913 21:17:14.462369 20358 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:17:14.462383 20358 net.cpp:91] Creating Layer lstm1_
I0913 21:17:14.462388 20358 net.cpp:399] lstm1_ -> x
I0913 21:17:14.462400 20358 net.cpp:399] lstm1_ -> cont
I0913 21:17:14.462524 20358 net.cpp:141] Setting up lstm1_
I0913 21:17:14.462534 20358 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:17:14.462540 20358 net.cpp:148] Top shape: 1 1 (1)
I0913 21:17:14.462544 20358 net.cpp:156] Memory required for data: 2004
I0913 21:17:14.462548 20358 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:17:14.462556 20358 net.cpp:91] Creating Layer lstm1_
I0913 21:17:14.462565 20358 net.cpp:399] lstm1_ -> c_0
I0913 21:17:14.462576 20358 net.cpp:399] lstm1_ -> h_0
I0913 21:17:14.462627 20358 net.cpp:141] Setting up lstm1_
I0913 21:17:14.462636 20358 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:17:14.462642 20358 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:17:14.462646 20358 net.cpp:156] Memory required for data: 10004
I0913 21:17:14.462651 20358 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0913 21:17:14.462661 20358 net.cpp:91] Creating Layer lstm1_cont_slice
I0913 21:17:14.462666 20358 net.cpp:425] lstm1_cont_slice <- cont
I0913 21:17:14.462673 20358 net.cpp:399] lstm1_cont_slice -> cont_1
I0913 21:17:14.462708 20358 net.cpp:141] Setting up lstm1_cont_slice
I0913 21:17:14.462718 20358 net.cpp:148] Top shape: 1 1 (1)
I0913 21:17:14.462721 20358 net.cpp:156] Memory required for data: 10008
I0913 21:17:14.462726 20358 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0913 21:17:14.462733 20358 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0913 21:17:14.462738 20358 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0913 21:17:14.462748 20358 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0913 21:17:14.462755 20358 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0913 21:17:14.462803 20358 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0913 21:17:14.462811 20358 net.cpp:148] Top shape: 1 1 (1)
I0913 21:17:14.462816 20358 net.cpp:148] Top shape: 1 1 (1)
I0913 21:17:14.462821 20358 net.cpp:156] Memory required for data: 10016
I0913 21:17:14.462826 20358 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0913 21:17:14.462834 20358 net.cpp:91] Creating Layer lstm1_x_transform
I0913 21:17:14.462838 20358 net.cpp:425] lstm1_x_transform <- x
I0913 21:17:14.462846 20358 net.cpp:399] lstm1_x_transform -> W_xc_x
I0913 21:17:14.483086 20358 net.cpp:141] Setting up lstm1_x_transform
I0913 21:17:14.483129 20358 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:17:14.483134 20358 net.cpp:156] Memory required for data: 26016
I0913 21:17:14.483155 20358 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0913 21:17:14.483173 20358 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0913 21:17:14.483180 20358 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0913 21:17:14.483188 20358 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0913 21:17:14.483232 20358 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0913 21:17:14.483240 20358 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:17:14.483244 20358 net.cpp:156] Memory required for data: 42016
I0913 21:17:14.483249 20358 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0913 21:17:14.483263 20358 net.cpp:91] Creating Layer lstm1_h_conted_0
I0913 21:17:14.483268 20358 net.cpp:425] lstm1_h_conted_0 <- h_0
I0913 21:17:14.483274 20358 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0913 21:17:14.483280 20358 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0913 21:17:14.483371 20358 net.cpp:141] Setting up lstm1_h_conted_0
I0913 21:17:14.483381 20358 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:17:14.483384 20358 net.cpp:156] Memory required for data: 46016
I0913 21:17:14.483388 20358 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0913 21:17:14.483403 20358 net.cpp:91] Creating Layer lstm1_transform_1
I0913 21:17:14.483408 20358 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0913 21:17:14.483415 20358 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0913 21:17:14.491576 20368 net.cpp:141] Setting up fc6
I0913 21:17:14.491633 20368 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:17:14.491649 20368 net.cpp:156] Memory required for data: 67782200
I0913 21:17:14.491677 20368 layer_factory.hpp:77] Creating layer relu6
I0913 21:17:14.491706 20368 net.cpp:91] Creating Layer relu6
I0913 21:17:14.491720 20368 net.cpp:425] relu6 <- fc6
I0913 21:17:14.491744 20368 net.cpp:386] relu6 -> fc6 (in-place)
I0913 21:17:14.492328 20368 net.cpp:141] Setting up relu6
I0913 21:17:14.492350 20368 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:17:14.492362 20368 net.cpp:156] Memory required for data: 67946040
I0913 21:17:14.492377 20368 layer_factory.hpp:77] Creating layer drop6
I0913 21:17:14.492406 20368 net.cpp:91] Creating Layer drop6
I0913 21:17:14.492419 20368 net.cpp:425] drop6 <- fc6
I0913 21:17:14.492432 20368 net.cpp:386] drop6 -> fc6 (in-place)
I0913 21:17:14.492513 20368 net.cpp:141] Setting up drop6
I0913 21:17:14.492530 20368 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:17:14.492538 20368 net.cpp:156] Memory required for data: 68109880
I0913 21:17:14.492548 20368 layer_factory.hpp:77] Creating layer fc7
I0913 21:17:14.492566 20368 net.cpp:91] Creating Layer fc7
I0913 21:17:14.492576 20368 net.cpp:425] fc7 <- fc6
I0913 21:17:14.492599 20368 net.cpp:399] fc7 -> fc7
I0913 21:17:14.524446 20358 net.cpp:141] Setting up lstm1_transform_1
I0913 21:17:14.524492 20358 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:17:14.524498 20358 net.cpp:156] Memory required for data: 62016
I0913 21:17:14.524518 20358 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0913 21:17:14.524543 20358 net.cpp:91] Creating Layer lstm1_gate_input_1
I0913 21:17:14.524550 20358 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0913 21:17:14.524557 20358 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0913 21:17:14.524567 20358 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0913 21:17:14.524623 20358 net.cpp:141] Setting up lstm1_gate_input_1
I0913 21:17:14.524632 20358 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:17:14.524636 20358 net.cpp:156] Memory required for data: 78016
I0913 21:17:14.524641 20358 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0913 21:17:14.524653 20358 net.cpp:91] Creating Layer lstm1_unit_1
I0913 21:17:14.524658 20358 net.cpp:425] lstm1_unit_1 <- c_0
I0913 21:17:14.524664 20358 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0913 21:17:14.524669 20358 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0913 21:17:14.524675 20358 net.cpp:399] lstm1_unit_1 -> c_1
I0913 21:17:14.524684 20358 net.cpp:399] lstm1_unit_1 -> h_1
I0913 21:17:14.524747 20358 net.cpp:141] Setting up lstm1_unit_1
I0913 21:17:14.524756 20358 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:17:14.524761 20358 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:17:14.524765 20358 net.cpp:156] Memory required for data: 86016
I0913 21:17:14.524770 20358 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:17:14.524778 20358 net.cpp:91] Creating Layer lstm1_
I0913 21:17:14.524782 20358 net.cpp:425] lstm1_ <- c_1
I0913 21:17:14.524791 20358 net.cpp:399] lstm1_ -> c_T
I0913 21:17:14.524821 20358 net.cpp:141] Setting up lstm1_
I0913 21:17:14.524828 20358 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:17:14.524832 20358 net.cpp:156] Memory required for data: 90016
I0913 21:17:14.524837 20358 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0913 21:17:14.524847 20358 net.cpp:91] Creating Layer lstm1_h_concat
I0913 21:17:14.524850 20358 net.cpp:425] lstm1_h_concat <- h_1
I0913 21:17:14.524857 20358 net.cpp:399] lstm1_h_concat -> h
I0913 21:17:14.524902 20358 net.cpp:141] Setting up lstm1_h_concat
I0913 21:17:14.524911 20358 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:17:14.524915 20358 net.cpp:156] Memory required for data: 94016
I0913 21:17:14.524919 20358 layer_factory.hpp:77] Creating layer h_pseudoloss
I0913 21:17:14.524935 20358 net.cpp:91] Creating Layer h_pseudoloss
I0913 21:17:14.524940 20358 net.cpp:425] h_pseudoloss <- h
I0913 21:17:14.524945 20358 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0913 21:17:14.525032 20358 net.cpp:141] Setting up h_pseudoloss
I0913 21:17:14.525043 20358 net.cpp:148] Top shape: (1)
I0913 21:17:14.525048 20358 net.cpp:151]     with loss weight 1
I0913 21:17:14.525081 20358 net.cpp:156] Memory required for data: 94020
I0913 21:17:14.525086 20358 net.cpp:217] h_pseudoloss needs backward computation.
I0913 21:17:14.525091 20358 net.cpp:217] lstm1_h_concat needs backward computation.
I0913 21:17:14.525095 20358 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:17:14.525100 20358 net.cpp:217] lstm1_unit_1 needs backward computation.
I0913 21:17:14.525105 20358 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0913 21:17:14.525110 20358 net.cpp:217] lstm1_transform_1 needs backward computation.
I0913 21:17:14.525115 20358 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0913 21:17:14.525120 20358 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0913 21:17:14.525125 20358 net.cpp:217] lstm1_x_transform needs backward computation.
I0913 21:17:14.525130 20358 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0913 21:17:14.525135 20358 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0913 21:17:14.525140 20358 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:17:14.525143 20358 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:17:14.525146 20358 net.cpp:261] This network produces output c_T
I0913 21:17:14.525151 20358 net.cpp:261] This network produces output h_pseudoloss
I0913 21:17:14.525166 20358 net.cpp:274] Network initialization done.
I0913 21:17:14.525223 20358 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0913 21:17:14.525229 20358 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0913 21:17:14.525233 20358 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0913 21:17:14.525341 20358 net.cpp:141] Setting up lstm1
I0913 21:17:14.525353 20358 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:17:14.525357 20358 net.cpp:156] Memory required for data: 26408
I0913 21:17:14.525370 20358 layer_factory.hpp:77] Creating layer concat
I0913 21:17:14.525378 20358 net.cpp:91] Creating Layer concat
I0913 21:17:14.525384 20358 net.cpp:425] concat <- lstm1
I0913 21:17:14.525390 20358 net.cpp:425] concat <- embedded_input_sentence
I0913 21:17:14.525395 20358 net.cpp:425] concat <- reshaped_stage_indicator
I0913 21:17:14.525403 20358 net.cpp:399] concat -> lstm1_video_sequence
I0913 21:17:14.525434 20358 net.cpp:141] Setting up concat
I0913 21:17:14.525442 20358 net.cpp:148] Top shape: 1 1 1501 (1501)
I0913 21:17:14.525446 20358 net.cpp:156] Memory required for data: 32412
I0913 21:17:14.525452 20358 layer_factory.hpp:77] Creating layer lstm2
I0913 21:17:14.525465 20358 net.cpp:91] Creating Layer lstm2
I0913 21:17:14.525470 20358 net.cpp:425] lstm2 <- lstm1_video_sequence
I0913 21:17:14.525475 20358 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0913 21:17:14.525481 20358 net.cpp:399] lstm2 -> lstm2
I0913 21:17:14.525492 20358 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0913 21:17:14.525738 20358 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0913 21:17:14.525822 20358 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:17:14.525835 20358 net.cpp:91] Creating Layer lstm2_
I0913 21:17:14.525840 20358 net.cpp:399] lstm2_ -> x
I0913 21:17:14.525851 20358 net.cpp:399] lstm2_ -> cont
I0913 21:17:14.525902 20358 net.cpp:141] Setting up lstm2_
I0913 21:17:14.525912 20358 net.cpp:148] Top shape: 1 1 1501 (1501)
I0913 21:17:14.525918 20358 net.cpp:148] Top shape: 1 1 (1)
I0913 21:17:14.525921 20358 net.cpp:156] Memory required for data: 6008
I0913 21:17:14.525925 20358 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:17:14.525936 20358 net.cpp:91] Creating Layer lstm2_
I0913 21:17:14.525943 20358 net.cpp:399] lstm2_ -> c_0
I0913 21:17:14.525952 20358 net.cpp:399] lstm2_ -> h_0
I0913 21:17:14.526001 20358 net.cpp:141] Setting up lstm2_
I0913 21:17:14.526010 20358 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:17:14.526016 20358 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:17:14.526020 20358 net.cpp:156] Memory required for data: 14008
I0913 21:17:14.526024 20358 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0913 21:17:14.526032 20358 net.cpp:91] Creating Layer lstm2_cont_slice
I0913 21:17:14.526036 20358 net.cpp:425] lstm2_cont_slice <- cont
I0913 21:17:14.526043 20358 net.cpp:399] lstm2_cont_slice -> cont_1
I0913 21:17:14.526080 20358 net.cpp:141] Setting up lstm2_cont_slice
I0913 21:17:14.526089 20358 net.cpp:148] Top shape: 1 1 (1)
I0913 21:17:14.526094 20358 net.cpp:156] Memory required for data: 14012
I0913 21:17:14.526098 20358 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0913 21:17:14.526105 20358 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0913 21:17:14.526110 20358 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0913 21:17:14.526118 20358 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0913 21:17:14.526126 20358 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0913 21:17:14.526170 20358 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0913 21:17:14.526180 20358 net.cpp:148] Top shape: 1 1 (1)
I0913 21:17:14.526186 20358 net.cpp:148] Top shape: 1 1 (1)
I0913 21:17:14.526190 20358 net.cpp:156] Memory required for data: 14020
I0913 21:17:14.526195 20358 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0913 21:17:14.526203 20358 net.cpp:91] Creating Layer lstm2_x_transform
I0913 21:17:14.526208 20358 net.cpp:425] lstm2_x_transform <- x
I0913 21:17:14.526217 20358 net.cpp:399] lstm2_x_transform -> W_xc_x
I0913 21:17:14.545828 20368 net.cpp:141] Setting up fc7
I0913 21:17:14.545881 20368 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:17:14.545893 20368 net.cpp:156] Memory required for data: 68273720
I0913 21:17:14.545918 20368 layer_factory.hpp:77] Creating layer relu7
I0913 21:17:14.545958 20368 net.cpp:91] Creating Layer relu7
I0913 21:17:14.545974 20368 net.cpp:425] relu7 <- fc7
I0913 21:17:14.545992 20368 net.cpp:386] relu7 -> fc7 (in-place)
I0913 21:17:14.546926 20368 net.cpp:141] Setting up relu7
I0913 21:17:14.546946 20368 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:17:14.546955 20368 net.cpp:156] Memory required for data: 68437560
I0913 21:17:14.546965 20368 layer_factory.hpp:77] Creating layer drop7
I0913 21:17:14.546988 20368 net.cpp:91] Creating Layer drop7
I0913 21:17:14.547000 20368 net.cpp:425] drop7 <- fc7
I0913 21:17:14.547014 20368 net.cpp:386] drop7 -> fc7 (in-place)
I0913 21:17:14.547083 20368 net.cpp:141] Setting up drop7
I0913 21:17:14.547101 20368 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:17:14.547111 20368 net.cpp:156] Memory required for data: 68601400
I0913 21:17:14.547119 20368 layer_factory.hpp:77] Creating layer fc8
I0913 21:17:14.547137 20368 net.cpp:91] Creating Layer fc8
I0913 21:17:14.547148 20368 net.cpp:425] fc8 <- fc7
I0913 21:17:14.547168 20368 net.cpp:399] fc8 -> fc8
I0913 21:17:14.563299 20368 net.cpp:141] Setting up fc8
I0913 21:17:14.563352 20368 net.cpp:148] Top shape: 10 1000 (10000)
I0913 21:17:14.563365 20368 net.cpp:156] Memory required for data: 68641400
I0913 21:17:14.563392 20368 layer_factory.hpp:77] Creating layer prob
I0913 21:17:14.563432 20368 net.cpp:91] Creating Layer prob
I0913 21:17:14.563447 20368 net.cpp:425] prob <- fc8
I0913 21:17:14.563467 20368 net.cpp:399] prob -> prob
I0913 21:17:14.564162 20368 net.cpp:141] Setting up prob
I0913 21:17:14.564177 20368 net.cpp:148] Top shape: 10 1000 (10000)
I0913 21:17:14.564182 20368 net.cpp:156] Memory required for data: 68681400
I0913 21:17:14.564188 20368 net.cpp:219] prob does not need backward computation.
I0913 21:17:14.564193 20368 net.cpp:219] fc8 does not need backward computation.
I0913 21:17:14.564198 20368 net.cpp:219] drop7 does not need backward computation.
I0913 21:17:14.564203 20368 net.cpp:219] relu7 does not need backward computation.
I0913 21:17:14.564206 20368 net.cpp:219] fc7 does not need backward computation.
I0913 21:17:14.564211 20368 net.cpp:219] drop6 does not need backward computation.
I0913 21:17:14.564215 20368 net.cpp:219] relu6 does not need backward computation.
I0913 21:17:14.564220 20368 net.cpp:219] fc6 does not need backward computation.
I0913 21:17:14.564225 20368 net.cpp:219] pool5 does not need backward computation.
I0913 21:17:14.564230 20368 net.cpp:219] relu5 does not need backward computation.
I0913 21:17:14.564234 20368 net.cpp:219] conv5 does not need backward computation.
I0913 21:17:14.564239 20368 net.cpp:219] relu4 does not need backward computation.
I0913 21:17:14.564244 20368 net.cpp:219] conv4 does not need backward computation.
I0913 21:17:14.564249 20368 net.cpp:219] relu3 does not need backward computation.
I0913 21:17:14.564252 20368 net.cpp:219] conv3 does not need backward computation.
I0913 21:17:14.564259 20368 net.cpp:219] norm2 does not need backward computation.
I0913 21:17:14.564263 20368 net.cpp:219] pool2 does not need backward computation.
I0913 21:17:14.564267 20368 net.cpp:219] relu2 does not need backward computation.
I0913 21:17:14.564272 20368 net.cpp:219] conv2 does not need backward computation.
I0913 21:17:14.564276 20368 net.cpp:219] norm1 does not need backward computation.
I0913 21:17:14.564281 20368 net.cpp:219] pool1 does not need backward computation.
I0913 21:17:14.564285 20368 net.cpp:219] relu1 does not need backward computation.
I0913 21:17:14.564291 20368 net.cpp:219] conv1 does not need backward computation.
I0913 21:17:14.564294 20368 net.cpp:219] data does not need backward computation.
I0913 21:17:14.564298 20368 net.cpp:261] This network produces output prob
I0913 21:17:14.564318 20368 net.cpp:274] Network initialization done.
I0913 21:17:14.583559 20358 net.cpp:141] Setting up lstm2_x_transform
I0913 21:17:14.583603 20358 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:17:14.583609 20358 net.cpp:156] Memory required for data: 30020
I0913 21:17:14.583629 20358 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0913 21:17:14.583644 20358 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0913 21:17:14.583652 20358 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0913 21:17:14.583660 20358 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0913 21:17:14.583709 20358 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0913 21:17:14.583719 20358 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:17:14.583722 20358 net.cpp:156] Memory required for data: 46020
I0913 21:17:14.583726 20358 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0913 21:17:14.583736 20358 net.cpp:91] Creating Layer lstm2_h_conted_0
I0913 21:17:14.583741 20358 net.cpp:425] lstm2_h_conted_0 <- h_0
I0913 21:17:14.583746 20358 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0913 21:17:14.583753 20358 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0913 21:17:14.583845 20358 net.cpp:141] Setting up lstm2_h_conted_0
I0913 21:17:14.583854 20358 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:17:14.583858 20358 net.cpp:156] Memory required for data: 50020
I0913 21:17:14.583863 20358 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0913 21:17:14.583875 20358 net.cpp:91] Creating Layer lstm2_transform_1
I0913 21:17:14.583880 20358 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0913 21:17:14.583889 20358 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0913 21:17:14.624441 20358 net.cpp:141] Setting up lstm2_transform_1
I0913 21:17:14.624491 20358 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:17:14.624497 20358 net.cpp:156] Memory required for data: 66020
I0913 21:17:14.624516 20358 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0913 21:17:14.624541 20358 net.cpp:91] Creating Layer lstm2_gate_input_1
I0913 21:17:14.624549 20358 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0913 21:17:14.624557 20358 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0913 21:17:14.624564 20358 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0913 21:17:14.624616 20358 net.cpp:141] Setting up lstm2_gate_input_1
I0913 21:17:14.624625 20358 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:17:14.624629 20358 net.cpp:156] Memory required for data: 82020
I0913 21:17:14.624634 20358 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0913 21:17:14.624642 20358 net.cpp:91] Creating Layer lstm2_unit_1
I0913 21:17:14.624647 20358 net.cpp:425] lstm2_unit_1 <- c_0
I0913 21:17:14.624653 20358 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0913 21:17:14.624660 20358 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0913 21:17:14.624667 20358 net.cpp:399] lstm2_unit_1 -> c_1
I0913 21:17:14.624676 20358 net.cpp:399] lstm2_unit_1 -> h_1
I0913 21:17:14.624737 20358 net.cpp:141] Setting up lstm2_unit_1
I0913 21:17:14.624745 20358 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:17:14.624750 20358 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:17:14.624754 20358 net.cpp:156] Memory required for data: 90020
I0913 21:17:14.624758 20358 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:17:14.624769 20358 net.cpp:91] Creating Layer lstm2_
I0913 21:17:14.624774 20358 net.cpp:425] lstm2_ <- c_1
I0913 21:17:14.624781 20358 net.cpp:399] lstm2_ -> c_T
I0913 21:17:14.624810 20358 net.cpp:141] Setting up lstm2_
I0913 21:17:14.624817 20358 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:17:14.624821 20358 net.cpp:156] Memory required for data: 94020
I0913 21:17:14.624825 20358 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0913 21:17:14.624835 20358 net.cpp:91] Creating Layer lstm2_h_concat
I0913 21:17:14.624840 20358 net.cpp:425] lstm2_h_concat <- h_1
I0913 21:17:14.624850 20358 net.cpp:399] lstm2_h_concat -> h
I0913 21:17:14.624886 20358 net.cpp:141] Setting up lstm2_h_concat
I0913 21:17:14.624893 20358 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:17:14.624897 20358 net.cpp:156] Memory required for data: 98020
I0913 21:17:14.624902 20358 layer_factory.hpp:77] Creating layer h_pseudoloss
I0913 21:17:14.624912 20358 net.cpp:91] Creating Layer h_pseudoloss
I0913 21:17:14.624915 20358 net.cpp:425] h_pseudoloss <- h
I0913 21:17:14.624922 20358 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0913 21:17:14.625005 20358 net.cpp:141] Setting up h_pseudoloss
I0913 21:17:14.625013 20358 net.cpp:148] Top shape: (1)
I0913 21:17:14.625017 20358 net.cpp:151]     with loss weight 1
I0913 21:17:14.625036 20358 net.cpp:156] Memory required for data: 98024
I0913 21:17:14.625041 20358 net.cpp:217] h_pseudoloss needs backward computation.
I0913 21:17:14.625044 20358 net.cpp:217] lstm2_h_concat needs backward computation.
I0913 21:17:14.625049 20358 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:17:14.625053 20358 net.cpp:217] lstm2_unit_1 needs backward computation.
I0913 21:17:14.625058 20358 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0913 21:17:14.625063 20358 net.cpp:217] lstm2_transform_1 needs backward computation.
I0913 21:17:14.625068 20358 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0913 21:17:14.625077 20358 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0913 21:17:14.625082 20358 net.cpp:217] lstm2_x_transform needs backward computation.
I0913 21:17:14.625085 20358 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0913 21:17:14.625092 20358 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0913 21:17:14.625097 20358 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:17:14.625100 20358 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:17:14.625103 20358 net.cpp:261] This network produces output c_T
I0913 21:17:14.625108 20358 net.cpp:261] This network produces output h_pseudoloss
I0913 21:17:14.625123 20358 net.cpp:274] Network initialization done.
I0913 21:17:14.625171 20358 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0913 21:17:14.625176 20358 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0913 21:17:14.625181 20358 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0913 21:17:14.625279 20358 net.cpp:141] Setting up lstm2
I0913 21:17:14.625290 20358 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:17:14.625294 20358 net.cpp:156] Memory required for data: 36412
I0913 21:17:14.625308 20358 layer_factory.hpp:77] Creating layer predict
I0913 21:17:14.625320 20358 net.cpp:91] Creating Layer predict
I0913 21:17:14.625326 20358 net.cpp:425] predict <- lstm2
I0913 21:17:14.625334 20358 net.cpp:399] predict -> predict
I0913 21:17:14.845080 20368 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /home/peifeng/work/run/storm102/data/workers/cef86a2e-7d2c-4e58-9cd4-00d749663619/tmp/cvld4365780248502595320/bvlc_reference_caffenet.caffemodel
I0913 21:17:14.845134 20368 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0913 21:17:14.845141 20368 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0913 21:17:14.845146 20368 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /home/peifeng/work/run/storm102/data/workers/cef86a2e-7d2c-4e58-9cd4-00d749663619/tmp/cvld4365780248502595320/bvlc_reference_caffenet.caffemodel
I0913 21:17:15.055932 20358 net.cpp:141] Setting up predict
I0913 21:17:15.055975 20358 net.cpp:148] Top shape: 1 1 46168 (46168)
I0913 21:17:15.055981 20358 net.cpp:156] Memory required for data: 221084
I0913 21:17:15.055995 20358 layer_factory.hpp:77] Creating layer probs
I0913 21:17:15.056013 20358 net.cpp:91] Creating Layer probs
I0913 21:17:15.056020 20358 net.cpp:425] probs <- predict
I0913 21:17:15.056030 20358 net.cpp:399] probs -> probs
I0913 21:17:15.056798 20358 net.cpp:141] Setting up probs
I0913 21:17:15.056813 20358 net.cpp:148] Top shape: 1 1 46168 (46168)
I0913 21:17:15.056818 20358 net.cpp:156] Memory required for data: 405756
I0913 21:17:15.056823 20358 net.cpp:219] probs does not need backward computation.
I0913 21:17:15.056828 20358 net.cpp:219] predict does not need backward computation.
I0913 21:17:15.056833 20358 net.cpp:219] lstm2 does not need backward computation.
I0913 21:17:15.056838 20358 net.cpp:219] concat does not need backward computation.
I0913 21:17:15.056844 20358 net.cpp:219] lstm1 does not need backward computation.
I0913 21:17:15.056850 20358 net.cpp:219] embedding does not need backward computation.
I0913 21:17:15.056854 20358 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0913 21:17:15.056859 20358 net.cpp:219] reshape_frames does not need backward computation.
I0913 21:17:15.056864 20358 net.cpp:219] embed_encoder does not need backward computation.
I0913 21:17:15.056869 20358 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0913 21:17:15.056874 20358 net.cpp:219] input does not need backward computation.
I0913 21:17:15.056877 20358 net.cpp:261] This network produces output probs
I0913 21:17:15.056891 20358 net.cpp:274] Network initialization done.
I0913 21:17:15.255228 20368 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0913 21:17:15.313750 20368 net.cpp:752] Ignoring source layer loss
Loading the model + trained: 12605.3ms
Using cv::Size and some other stuff: 0.228ms
I0913 21:17:15.417955 20358 net.cpp:752] Ignoring source layer data
I0913 21:17:15.417989 20358 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0913 21:17:15.417994 20358 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0913 21:17:15.546375 20358 net.cpp:752] Ignoring source layer cross_entropy_loss
Loading the mean file: 1616.69ms
TIMERTIMER 131522599
TIMERTIMER 69759711
TIMERTIMER 70133395
TIMERTIMER 47970655
TIMERTIMER 50110996
TIMERTIMER 42870546
TIMERTIMER 49497556
TIMERTIMER 49406440
TIMERTIMER 44779644
TIMERTIMER 49648115
TIMERTIMER 48028423
TIMERTIMER 52769689
TIMERTIMER 53050897
TIMERTIMER 43397944
TIMERTIMER 46818396
TIMERTIMER 42094648
TIMERTIMER 44502695
TIMERTIMER 31258920
TIMERTIMER 33469361
TIMERTIMER 37235367
TIMERTIMER 31748644
TIMERTIMER 31428066
TIMERTIMER 38097637
TIMERTIMER 38624195
TIMERTIMER 31427111
TIMERTIMER 34756212
TIMERTIMER 31840923
TIMERTIMER 31395446
TIMERTIMER 37570905
TIMERTIMER 38753813
TIMERTIMER 31519403
TIMERTIMER 31432580
TIMERTIMER 36952980
TIMERTIMER 31310724
TIMERTIMER 37280460
TIMERTIMER 31452881
TIMERTIMER 37420850
TIMERTIMER 31896520
TIMERTIMER 33059083
TIMERTIMER 33148419
TIMERTIMER 31797127
TIMERTIMER 43033153
TIMERTIMER 39349366
TIMERTIMER 32071385
TIMERTIMER 32132191
TIMERTIMER 43052057
TIMERTIMER 31963117
TIMERTIMER 32123708
TIMERTIMER 31953886
TIMERTIMER 31892881
