SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/peifeng/tools/storm102/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/peifeng/work/run/storm102/data/supervisor/stormdist/captioning-1-1473816557/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /home/peifeng/work/run/storm102/data/workers/34555c76-fb1d-4e49-b502-f6cd8a0508f0/tmp/cvld402619504795223441/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0913 21:29:56.097129 28340 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0913 21:29:56.097398 28340 layer_factory.hpp:77] Creating layer data
I0913 21:29:56.097430 28340 net.cpp:91] Creating Layer data
I0913 21:29:56.097445 28340 net.cpp:399] data -> data
I0913 21:29:56.629137 28340 net.cpp:141] Setting up data
I0913 21:29:56.629247 28340 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0913 21:29:56.629254 28340 net.cpp:156] Memory required for data: 6183480
I0913 21:29:56.629276 28340 layer_factory.hpp:77] Creating layer conv1
I0913 21:29:56.629314 28340 net.cpp:91] Creating Layer conv1
I0913 21:29:56.629325 28340 net.cpp:425] conv1 <- data
I0913 21:29:56.629340 28340 net.cpp:399] conv1 -> conv1
I0913 21:29:56.806191 28340 net.cpp:141] Setting up conv1
I0913 21:29:56.806241 28340 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0913 21:29:56.806247 28340 net.cpp:156] Memory required for data: 17799480
I0913 21:29:56.806277 28340 layer_factory.hpp:77] Creating layer relu1
I0913 21:29:56.806298 28340 net.cpp:91] Creating Layer relu1
I0913 21:29:56.806304 28340 net.cpp:425] relu1 <- conv1
I0913 21:29:56.806311 28340 net.cpp:386] relu1 -> conv1 (in-place)
I0913 21:29:56.806699 28340 net.cpp:141] Setting up relu1
I0913 21:29:56.806712 28340 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0913 21:29:56.806717 28340 net.cpp:156] Memory required for data: 29415480
I0913 21:29:56.806722 28340 layer_factory.hpp:77] Creating layer pool1
I0913 21:29:56.806735 28340 net.cpp:91] Creating Layer pool1
I0913 21:29:56.806740 28340 net.cpp:425] pool1 <- conv1
I0913 21:29:56.806747 28340 net.cpp:399] pool1 -> pool1
I0913 21:29:56.806819 28340 net.cpp:141] Setting up pool1
I0913 21:29:56.806829 28340 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0913 21:29:56.806833 28340 net.cpp:156] Memory required for data: 32214840
I0913 21:29:56.806838 28340 layer_factory.hpp:77] Creating layer norm1
I0913 21:29:56.806855 28340 net.cpp:91] Creating Layer norm1
I0913 21:29:56.806860 28340 net.cpp:425] norm1 <- pool1
I0913 21:29:56.806866 28340 net.cpp:399] norm1 -> norm1
I0913 21:29:56.807126 28340 net.cpp:141] Setting up norm1
I0913 21:29:56.807138 28340 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0913 21:29:56.807142 28340 net.cpp:156] Memory required for data: 35014200
I0913 21:29:56.807147 28340 layer_factory.hpp:77] Creating layer conv2
I0913 21:29:56.807162 28340 net.cpp:91] Creating Layer conv2
I0913 21:29:56.807166 28340 net.cpp:425] conv2 <- norm1
I0913 21:29:56.807173 28340 net.cpp:399] conv2 -> conv2
I0913 21:29:56.810873 28340 net.cpp:141] Setting up conv2
I0913 21:29:56.810894 28340 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0913 21:29:56.810899 28340 net.cpp:156] Memory required for data: 42479160
I0913 21:29:56.810912 28340 layer_factory.hpp:77] Creating layer relu2
I0913 21:29:56.810926 28340 net.cpp:91] Creating Layer relu2
I0913 21:29:56.810932 28340 net.cpp:425] relu2 <- conv2
I0913 21:29:56.810940 28340 net.cpp:386] relu2 -> conv2 (in-place)
I0913 21:29:56.811316 28340 net.cpp:141] Setting up relu2
I0913 21:29:56.811329 28340 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0913 21:29:56.811334 28340 net.cpp:156] Memory required for data: 49944120
I0913 21:29:56.811342 28340 layer_factory.hpp:77] Creating layer pool2
I0913 21:29:56.811352 28340 net.cpp:91] Creating Layer pool2
I0913 21:29:56.811357 28340 net.cpp:425] pool2 <- conv2
I0913 21:29:56.811365 28340 net.cpp:399] pool2 -> pool2
I0913 21:29:56.811416 28340 net.cpp:141] Setting up pool2
I0913 21:29:56.811424 28340 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:29:56.811429 28340 net.cpp:156] Memory required for data: 51674680
I0913 21:29:56.811434 28340 layer_factory.hpp:77] Creating layer norm2
I0913 21:29:56.811444 28340 net.cpp:91] Creating Layer norm2
I0913 21:29:56.811450 28340 net.cpp:425] norm2 <- pool2
I0913 21:29:56.811456 28340 net.cpp:399] norm2 -> norm2
I0913 21:29:56.811688 28340 net.cpp:141] Setting up norm2
I0913 21:29:56.811699 28340 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:29:56.811704 28340 net.cpp:156] Memory required for data: 53405240
I0913 21:29:56.811709 28340 layer_factory.hpp:77] Creating layer conv3
I0913 21:29:56.811722 28340 net.cpp:91] Creating Layer conv3
I0913 21:29:56.811727 28340 net.cpp:425] conv3 <- norm2
I0913 21:29:56.811734 28340 net.cpp:399] conv3 -> conv3
I0913 21:29:56.815258 28340 net.cpp:141] Setting up conv3
I0913 21:29:56.815290 28340 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:29:56.815296 28340 net.cpp:156] Memory required for data: 56001080
I0913 21:29:56.815312 28340 layer_factory.hpp:77] Creating layer relu3
I0913 21:29:56.815325 28340 net.cpp:91] Creating Layer relu3
I0913 21:29:56.815330 28340 net.cpp:425] relu3 <- conv3
I0913 21:29:56.815341 28340 net.cpp:386] relu3 -> conv3 (in-place)
I0913 21:29:56.815562 28340 net.cpp:141] Setting up relu3
I0913 21:29:56.815574 28340 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:29:56.815579 28340 net.cpp:156] Memory required for data: 58596920
I0913 21:29:56.815587 28340 layer_factory.hpp:77] Creating layer conv4
I0913 21:29:56.815600 28340 net.cpp:91] Creating Layer conv4
I0913 21:29:56.815605 28340 net.cpp:425] conv4 <- conv3
I0913 21:29:56.815615 28340 net.cpp:399] conv4 -> conv4
I0913 21:29:56.819596 28340 net.cpp:141] Setting up conv4
I0913 21:29:56.819619 28340 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:29:56.819625 28340 net.cpp:156] Memory required for data: 61192760
I0913 21:29:56.819636 28340 layer_factory.hpp:77] Creating layer relu4
I0913 21:29:56.819646 28340 net.cpp:91] Creating Layer relu4
I0913 21:29:56.819651 28340 net.cpp:425] relu4 <- conv4
I0913 21:29:56.819658 28340 net.cpp:386] relu4 -> conv4 (in-place)
I0913 21:29:56.820047 28340 net.cpp:141] Setting up relu4
I0913 21:29:56.820060 28340 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:29:56.820065 28340 net.cpp:156] Memory required for data: 63788600
I0913 21:29:56.820080 28340 layer_factory.hpp:77] Creating layer conv5
I0913 21:29:56.820097 28340 net.cpp:91] Creating Layer conv5
I0913 21:29:56.820102 28340 net.cpp:425] conv5 <- conv4
I0913 21:29:56.820111 28340 net.cpp:399] conv5 -> conv5
I0913 21:29:56.823817 28340 net.cpp:141] Setting up conv5
I0913 21:29:56.823839 28340 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:29:56.823845 28340 net.cpp:156] Memory required for data: 65519160
I0913 21:29:56.823863 28340 layer_factory.hpp:77] Creating layer relu5
I0913 21:29:56.823873 28340 net.cpp:91] Creating Layer relu5
I0913 21:29:56.823878 28340 net.cpp:425] relu5 <- conv5
I0913 21:29:56.823884 28340 net.cpp:386] relu5 -> conv5 (in-place)
I0913 21:29:56.824301 28340 net.cpp:141] Setting up relu5
I0913 21:29:56.824316 28340 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:29:56.824319 28340 net.cpp:156] Memory required for data: 67249720
I0913 21:29:56.824324 28340 layer_factory.hpp:77] Creating layer pool5
I0913 21:29:56.824336 28340 net.cpp:91] Creating Layer pool5
I0913 21:29:56.824340 28340 net.cpp:425] pool5 <- conv5
I0913 21:29:56.824350 28340 net.cpp:399] pool5 -> pool5
I0913 21:29:56.824410 28340 net.cpp:141] Setting up pool5
I0913 21:29:56.824419 28340 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0913 21:29:56.824424 28340 net.cpp:156] Memory required for data: 67618360
I0913 21:29:56.824427 28340 layer_factory.hpp:77] Creating layer fc6
I0913 21:29:56.824443 28340 net.cpp:91] Creating Layer fc6
I0913 21:29:56.824448 28340 net.cpp:425] fc6 <- pool5
I0913 21:29:56.824455 28340 net.cpp:399] fc6 -> fc6
I0913 21:29:56.889699 28330 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/34555c76-fb1d-4e49-b502-f6cd8a0508f0/tmp/cvld402619504795223441/s2vt.words_to_preds.prototxt
I0913 21:29:56.889750 28330 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0913 21:29:56.889765 28330 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0913 21:29:56.890017 28330 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0913 21:29:56.890111 28330 layer_factory.hpp:77] Creating layer input
I0913 21:29:56.890127 28330 net.cpp:91] Creating Layer input
I0913 21:29:56.890136 28330 net.cpp:399] input -> frames_fc7
I0913 21:29:56.890152 28330 net.cpp:399] input -> cont_sentence
I0913 21:29:56.890162 28330 net.cpp:399] input -> input_sentence
I0913 21:29:56.890172 28330 net.cpp:399] input -> stage_indicator
I0913 21:29:56.890293 28330 net.cpp:141] Setting up input
I0913 21:29:56.890306 28330 net.cpp:148] Top shape: 1 4096 (4096)
I0913 21:29:56.890312 28330 net.cpp:148] Top shape: 1 1 (1)
I0913 21:29:56.890317 28330 net.cpp:148] Top shape: 1 1 (1)
I0913 21:29:56.890323 28330 net.cpp:148] Top shape: 1 1 (1)
I0913 21:29:56.890327 28330 net.cpp:156] Memory required for data: 16396
I0913 21:29:56.890332 28330 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0913 21:29:56.890344 28330 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0913 21:29:56.890350 28330 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0913 21:29:56.890367 28330 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0913 21:29:56.890377 28330 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0913 21:29:56.890426 28330 net.cpp:141] Setting up cont_sentence_input_1_split
I0913 21:29:56.890436 28330 net.cpp:148] Top shape: 1 1 (1)
I0913 21:29:56.890441 28330 net.cpp:148] Top shape: 1 1 (1)
I0913 21:29:56.890446 28330 net.cpp:156] Memory required for data: 16404
I0913 21:29:56.890450 28330 layer_factory.hpp:77] Creating layer embed_encoder
I0913 21:29:56.890462 28330 net.cpp:91] Creating Layer embed_encoder
I0913 21:29:56.890468 28330 net.cpp:425] embed_encoder <- frames_fc7
I0913 21:29:56.890476 28330 net.cpp:399] embed_encoder -> embedded_in_frames
I0913 21:29:56.910878 28330 net.cpp:141] Setting up embed_encoder
I0913 21:29:56.910930 28330 net.cpp:148] Top shape: 1 500 (500)
I0913 21:29:56.910936 28330 net.cpp:156] Memory required for data: 18404
I0913 21:29:56.910961 28330 layer_factory.hpp:77] Creating layer reshape_frames
I0913 21:29:56.911000 28330 net.cpp:91] Creating Layer reshape_frames
I0913 21:29:56.911010 28330 net.cpp:425] reshape_frames <- embedded_in_frames
I0913 21:29:56.911022 28330 net.cpp:399] reshape_frames -> embedded_input_frames
I0913 21:29:56.911087 28330 net.cpp:141] Setting up reshape_frames
I0913 21:29:56.911097 28330 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:29:56.911100 28330 net.cpp:156] Memory required for data: 20404
I0913 21:29:56.911105 28330 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0913 21:29:56.911118 28330 net.cpp:91] Creating Layer reshape_stage_indicator
I0913 21:29:56.911123 28330 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0913 21:29:56.911131 28330 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0913 21:29:56.911170 28330 net.cpp:141] Setting up reshape_stage_indicator
I0913 21:29:56.911178 28330 net.cpp:148] Top shape: 1 1 1 (1)
I0913 21:29:56.911182 28330 net.cpp:156] Memory required for data: 20408
I0913 21:29:56.911187 28330 layer_factory.hpp:77] Creating layer embedding
I0913 21:29:56.911202 28330 net.cpp:91] Creating Layer embedding
I0913 21:29:56.911207 28330 net.cpp:425] embedding <- input_sentence
I0913 21:29:56.911216 28330 net.cpp:399] embedding -> embedded_input_sentence
I0913 21:29:56.951154 28340 net.cpp:141] Setting up fc6
I0913 21:29:56.951207 28340 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:29:56.951213 28340 net.cpp:156] Memory required for data: 67782200
I0913 21:29:56.951230 28340 layer_factory.hpp:77] Creating layer relu6
I0913 21:29:56.951252 28340 net.cpp:91] Creating Layer relu6
I0913 21:29:56.951261 28340 net.cpp:425] relu6 <- fc6
I0913 21:29:56.951272 28340 net.cpp:386] relu6 -> fc6 (in-place)
I0913 21:29:56.951601 28340 net.cpp:141] Setting up relu6
I0913 21:29:56.951614 28340 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:29:56.951619 28340 net.cpp:156] Memory required for data: 67946040
I0913 21:29:56.951625 28340 layer_factory.hpp:77] Creating layer drop6
I0913 21:29:56.951649 28340 net.cpp:91] Creating Layer drop6
I0913 21:29:56.951654 28340 net.cpp:425] drop6 <- fc6
I0913 21:29:56.951660 28340 net.cpp:386] drop6 -> fc6 (in-place)
I0913 21:29:56.951712 28340 net.cpp:141] Setting up drop6
I0913 21:29:56.951721 28340 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:29:56.951725 28340 net.cpp:156] Memory required for data: 68109880
I0913 21:29:56.951730 28340 layer_factory.hpp:77] Creating layer fc7
I0913 21:29:56.951742 28340 net.cpp:91] Creating Layer fc7
I0913 21:29:56.951747 28340 net.cpp:425] fc7 <- fc6
I0913 21:29:56.951753 28340 net.cpp:399] fc7 -> fc7
I0913 21:29:56.999462 28340 net.cpp:141] Setting up fc7
I0913 21:29:56.999526 28340 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:29:56.999536 28340 net.cpp:156] Memory required for data: 68273720
I0913 21:29:56.999558 28340 layer_factory.hpp:77] Creating layer relu7
I0913 21:29:56.999591 28340 net.cpp:91] Creating Layer relu7
I0913 21:29:56.999601 28340 net.cpp:425] relu7 <- fc7
I0913 21:29:56.999614 28340 net.cpp:386] relu7 -> fc7 (in-place)
I0913 21:29:57.000430 28340 net.cpp:141] Setting up relu7
I0913 21:29:57.000447 28340 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:29:57.000454 28340 net.cpp:156] Memory required for data: 68437560
I0913 21:29:57.000461 28340 layer_factory.hpp:77] Creating layer drop7
I0913 21:29:57.000479 28340 net.cpp:91] Creating Layer drop7
I0913 21:29:57.000486 28340 net.cpp:425] drop7 <- fc7
I0913 21:29:57.000497 28340 net.cpp:386] drop7 -> fc7 (in-place)
I0913 21:29:57.000547 28340 net.cpp:141] Setting up drop7
I0913 21:29:57.000560 28340 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:29:57.000566 28340 net.cpp:156] Memory required for data: 68601400
I0913 21:29:57.000573 28340 layer_factory.hpp:77] Creating layer fc8
I0913 21:29:57.000586 28340 net.cpp:91] Creating Layer fc8
I0913 21:29:57.000593 28340 net.cpp:425] fc8 <- fc7
I0913 21:29:57.000608 28340 net.cpp:399] fc8 -> fc8
I0913 21:29:57.014988 28340 net.cpp:141] Setting up fc8
I0913 21:29:57.015045 28340 net.cpp:148] Top shape: 10 1000 (10000)
I0913 21:29:57.015055 28340 net.cpp:156] Memory required for data: 68641400
I0913 21:29:57.015075 28340 layer_factory.hpp:77] Creating layer prob
I0913 21:29:57.015097 28340 net.cpp:91] Creating Layer prob
I0913 21:29:57.015108 28340 net.cpp:425] prob <- fc8
I0913 21:29:57.015121 28340 net.cpp:399] prob -> prob
I0913 21:29:57.015699 28340 net.cpp:141] Setting up prob
I0913 21:29:57.015715 28340 net.cpp:148] Top shape: 10 1000 (10000)
I0913 21:29:57.015722 28340 net.cpp:156] Memory required for data: 68681400
I0913 21:29:57.015732 28340 net.cpp:219] prob does not need backward computation.
I0913 21:29:57.015739 28340 net.cpp:219] fc8 does not need backward computation.
I0913 21:29:57.015746 28340 net.cpp:219] drop7 does not need backward computation.
I0913 21:29:57.015754 28340 net.cpp:219] relu7 does not need backward computation.
I0913 21:29:57.015761 28340 net.cpp:219] fc7 does not need backward computation.
I0913 21:29:57.015768 28340 net.cpp:219] drop6 does not need backward computation.
I0913 21:29:57.015774 28340 net.cpp:219] relu6 does not need backward computation.
I0913 21:29:57.015781 28340 net.cpp:219] fc6 does not need backward computation.
I0913 21:29:57.015789 28340 net.cpp:219] pool5 does not need backward computation.
I0913 21:29:57.015797 28340 net.cpp:219] relu5 does not need backward computation.
I0913 21:29:57.015805 28340 net.cpp:219] conv5 does not need backward computation.
I0913 21:29:57.015811 28340 net.cpp:219] relu4 does not need backward computation.
I0913 21:29:57.015820 28340 net.cpp:219] conv4 does not need backward computation.
I0913 21:29:57.015827 28340 net.cpp:219] relu3 does not need backward computation.
I0913 21:29:57.015833 28340 net.cpp:219] conv3 does not need backward computation.
I0913 21:29:57.015843 28340 net.cpp:219] norm2 does not need backward computation.
I0913 21:29:57.015854 28340 net.cpp:219] pool2 does not need backward computation.
I0913 21:29:57.015861 28340 net.cpp:219] relu2 does not need backward computation.
I0913 21:29:57.015867 28340 net.cpp:219] conv2 does not need backward computation.
I0913 21:29:57.015875 28340 net.cpp:219] norm1 does not need backward computation.
I0913 21:29:57.015882 28340 net.cpp:219] pool1 does not need backward computation.
I0913 21:29:57.015890 28340 net.cpp:219] relu1 does not need backward computation.
I0913 21:29:57.015897 28340 net.cpp:219] conv1 does not need backward computation.
I0913 21:29:57.015904 28340 net.cpp:219] data does not need backward computation.
I0913 21:29:57.015910 28340 net.cpp:261] This network produces output prob
I0913 21:29:57.015939 28340 net.cpp:274] Network initialization done.
I0913 21:29:57.128859 28330 net.cpp:141] Setting up embedding
I0913 21:29:57.128913 28330 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:29:57.128919 28330 net.cpp:156] Memory required for data: 22408
I0913 21:29:57.128938 28330 layer_factory.hpp:77] Creating layer lstm1
I0913 21:29:57.128967 28330 net.cpp:91] Creating Layer lstm1
I0913 21:29:57.128974 28330 net.cpp:425] lstm1 <- embedded_input_frames
I0913 21:29:57.128983 28330 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0913 21:29:57.128993 28330 net.cpp:399] lstm1 -> lstm1
I0913 21:29:57.129021 28330 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0913 21:29:57.129390 28330 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0913 21:29:57.129488 28330 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:29:57.129499 28330 net.cpp:91] Creating Layer lstm1_
I0913 21:29:57.129505 28330 net.cpp:399] lstm1_ -> x
I0913 21:29:57.129518 28330 net.cpp:399] lstm1_ -> cont
I0913 21:29:57.129576 28330 net.cpp:141] Setting up lstm1_
I0913 21:29:57.129586 28330 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:29:57.129591 28330 net.cpp:148] Top shape: 1 1 (1)
I0913 21:29:57.129595 28330 net.cpp:156] Memory required for data: 2004
I0913 21:29:57.129601 28330 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:29:57.129611 28330 net.cpp:91] Creating Layer lstm1_
I0913 21:29:57.129619 28330 net.cpp:399] lstm1_ -> c_0
I0913 21:29:57.129629 28330 net.cpp:399] lstm1_ -> h_0
I0913 21:29:57.129675 28330 net.cpp:141] Setting up lstm1_
I0913 21:29:57.129686 28330 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:29:57.129693 28330 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:29:57.129696 28330 net.cpp:156] Memory required for data: 10004
I0913 21:29:57.129700 28330 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0913 21:29:57.129709 28330 net.cpp:91] Creating Layer lstm1_cont_slice
I0913 21:29:57.129714 28330 net.cpp:425] lstm1_cont_slice <- cont
I0913 21:29:57.129719 28330 net.cpp:399] lstm1_cont_slice -> cont_1
I0913 21:29:57.129755 28330 net.cpp:141] Setting up lstm1_cont_slice
I0913 21:29:57.129765 28330 net.cpp:148] Top shape: 1 1 (1)
I0913 21:29:57.129768 28330 net.cpp:156] Memory required for data: 10008
I0913 21:29:57.129773 28330 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0913 21:29:57.129781 28330 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0913 21:29:57.129786 28330 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0913 21:29:57.129796 28330 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0913 21:29:57.129804 28330 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0913 21:29:57.129854 28330 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0913 21:29:57.129863 28330 net.cpp:148] Top shape: 1 1 (1)
I0913 21:29:57.129868 28330 net.cpp:148] Top shape: 1 1 (1)
I0913 21:29:57.129873 28330 net.cpp:156] Memory required for data: 10016
I0913 21:29:57.129876 28330 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0913 21:29:57.129885 28330 net.cpp:91] Creating Layer lstm1_x_transform
I0913 21:29:57.129890 28330 net.cpp:425] lstm1_x_transform <- x
I0913 21:29:57.129899 28330 net.cpp:399] lstm1_x_transform -> W_xc_x
I0913 21:29:57.149579 28330 net.cpp:141] Setting up lstm1_x_transform
I0913 21:29:57.149624 28330 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:29:57.149631 28330 net.cpp:156] Memory required for data: 26016
I0913 21:29:57.149653 28330 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0913 21:29:57.149670 28330 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0913 21:29:57.149677 28330 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0913 21:29:57.149685 28330 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0913 21:29:57.149734 28330 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0913 21:29:57.149742 28330 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:29:57.149746 28330 net.cpp:156] Memory required for data: 42016
I0913 21:29:57.149751 28330 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0913 21:29:57.149761 28330 net.cpp:91] Creating Layer lstm1_h_conted_0
I0913 21:29:57.149766 28330 net.cpp:425] lstm1_h_conted_0 <- h_0
I0913 21:29:57.149772 28330 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0913 21:29:57.149780 28330 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0913 21:29:57.149875 28330 net.cpp:141] Setting up lstm1_h_conted_0
I0913 21:29:57.149884 28330 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:29:57.149888 28330 net.cpp:156] Memory required for data: 46016
I0913 21:29:57.149893 28330 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0913 21:29:57.149905 28330 net.cpp:91] Creating Layer lstm1_transform_1
I0913 21:29:57.149910 28330 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0913 21:29:57.149919 28330 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0913 21:29:57.188886 28330 net.cpp:141] Setting up lstm1_transform_1
I0913 21:29:57.188935 28330 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:29:57.188941 28330 net.cpp:156] Memory required for data: 62016
I0913 21:29:57.188961 28330 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0913 21:29:57.188982 28330 net.cpp:91] Creating Layer lstm1_gate_input_1
I0913 21:29:57.188989 28330 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0913 21:29:57.188997 28330 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0913 21:29:57.189004 28330 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0913 21:29:57.189061 28330 net.cpp:141] Setting up lstm1_gate_input_1
I0913 21:29:57.189071 28330 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:29:57.189075 28330 net.cpp:156] Memory required for data: 78016
I0913 21:29:57.189080 28330 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0913 21:29:57.189091 28330 net.cpp:91] Creating Layer lstm1_unit_1
I0913 21:29:57.189096 28330 net.cpp:425] lstm1_unit_1 <- c_0
I0913 21:29:57.189102 28330 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0913 21:29:57.189108 28330 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0913 21:29:57.189115 28330 net.cpp:399] lstm1_unit_1 -> c_1
I0913 21:29:57.189123 28330 net.cpp:399] lstm1_unit_1 -> h_1
I0913 21:29:57.189184 28330 net.cpp:141] Setting up lstm1_unit_1
I0913 21:29:57.189193 28330 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:29:57.189199 28330 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:29:57.189203 28330 net.cpp:156] Memory required for data: 86016
I0913 21:29:57.189208 28330 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:29:57.189215 28330 net.cpp:91] Creating Layer lstm1_
I0913 21:29:57.189220 28330 net.cpp:425] lstm1_ <- c_1
I0913 21:29:57.189226 28330 net.cpp:399] lstm1_ -> c_T
I0913 21:29:57.189255 28330 net.cpp:141] Setting up lstm1_
I0913 21:29:57.189265 28330 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:29:57.189268 28330 net.cpp:156] Memory required for data: 90016
I0913 21:29:57.189272 28330 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0913 21:29:57.189296 28330 net.cpp:91] Creating Layer lstm1_h_concat
I0913 21:29:57.189301 28330 net.cpp:425] lstm1_h_concat <- h_1
I0913 21:29:57.189307 28330 net.cpp:399] lstm1_h_concat -> h
I0913 21:29:57.189342 28330 net.cpp:141] Setting up lstm1_h_concat
I0913 21:29:57.189350 28330 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:29:57.189354 28330 net.cpp:156] Memory required for data: 94016
I0913 21:29:57.189358 28330 layer_factory.hpp:77] Creating layer h_pseudoloss
I0913 21:29:57.189368 28330 net.cpp:91] Creating Layer h_pseudoloss
I0913 21:29:57.189373 28330 net.cpp:425] h_pseudoloss <- h
I0913 21:29:57.189380 28330 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0913 21:29:57.189473 28330 net.cpp:141] Setting up h_pseudoloss
I0913 21:29:57.189484 28330 net.cpp:148] Top shape: (1)
I0913 21:29:57.189488 28330 net.cpp:151]     with loss weight 1
I0913 21:29:57.189524 28330 net.cpp:156] Memory required for data: 94020
I0913 21:29:57.189529 28330 net.cpp:217] h_pseudoloss needs backward computation.
I0913 21:29:57.189534 28330 net.cpp:217] lstm1_h_concat needs backward computation.
I0913 21:29:57.189538 28330 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:29:57.189543 28330 net.cpp:217] lstm1_unit_1 needs backward computation.
I0913 21:29:57.189548 28330 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0913 21:29:57.189553 28330 net.cpp:217] lstm1_transform_1 needs backward computation.
I0913 21:29:57.189558 28330 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0913 21:29:57.189563 28330 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0913 21:29:57.189568 28330 net.cpp:217] lstm1_x_transform needs backward computation.
I0913 21:29:57.189574 28330 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0913 21:29:57.189579 28330 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0913 21:29:57.189584 28330 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:29:57.189587 28330 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:29:57.189590 28330 net.cpp:261] This network produces output c_T
I0913 21:29:57.189595 28330 net.cpp:261] This network produces output h_pseudoloss
I0913 21:29:57.189611 28330 net.cpp:274] Network initialization done.
I0913 21:29:57.189677 28330 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0913 21:29:57.189687 28330 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0913 21:29:57.189690 28330 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0913 21:29:57.189797 28330 net.cpp:141] Setting up lstm1
I0913 21:29:57.189808 28330 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:29:57.189812 28330 net.cpp:156] Memory required for data: 26408
I0913 21:29:57.189826 28330 layer_factory.hpp:77] Creating layer concat
I0913 21:29:57.189834 28330 net.cpp:91] Creating Layer concat
I0913 21:29:57.189841 28330 net.cpp:425] concat <- lstm1
I0913 21:29:57.189848 28330 net.cpp:425] concat <- embedded_input_sentence
I0913 21:29:57.189853 28330 net.cpp:425] concat <- reshaped_stage_indicator
I0913 21:29:57.189859 28330 net.cpp:399] concat -> lstm1_video_sequence
I0913 21:29:57.189891 28330 net.cpp:141] Setting up concat
I0913 21:29:57.189899 28330 net.cpp:148] Top shape: 1 1 1501 (1501)
I0913 21:29:57.189904 28330 net.cpp:156] Memory required for data: 32412
I0913 21:29:57.189910 28330 layer_factory.hpp:77] Creating layer lstm2
I0913 21:29:57.189923 28330 net.cpp:91] Creating Layer lstm2
I0913 21:29:57.189927 28330 net.cpp:425] lstm2 <- lstm1_video_sequence
I0913 21:29:57.189934 28330 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0913 21:29:57.189939 28330 net.cpp:399] lstm2 -> lstm2
I0913 21:29:57.189949 28330 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0913 21:29:57.190201 28330 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0913 21:29:57.190282 28330 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:29:57.190294 28330 net.cpp:91] Creating Layer lstm2_
I0913 21:29:57.190300 28330 net.cpp:399] lstm2_ -> x
I0913 21:29:57.190310 28330 net.cpp:399] lstm2_ -> cont
I0913 21:29:57.190362 28330 net.cpp:141] Setting up lstm2_
I0913 21:29:57.190372 28330 net.cpp:148] Top shape: 1 1 1501 (1501)
I0913 21:29:57.190378 28330 net.cpp:148] Top shape: 1 1 (1)
I0913 21:29:57.190382 28330 net.cpp:156] Memory required for data: 6008
I0913 21:29:57.190387 28330 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:29:57.190394 28330 net.cpp:91] Creating Layer lstm2_
I0913 21:29:57.190399 28330 net.cpp:399] lstm2_ -> c_0
I0913 21:29:57.190408 28330 net.cpp:399] lstm2_ -> h_0
I0913 21:29:57.190480 28330 net.cpp:141] Setting up lstm2_
I0913 21:29:57.190495 28330 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:29:57.190503 28330 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:29:57.190510 28330 net.cpp:156] Memory required for data: 14008
I0913 21:29:57.190517 28330 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0913 21:29:57.190531 28330 net.cpp:91] Creating Layer lstm2_cont_slice
I0913 21:29:57.190539 28330 net.cpp:425] lstm2_cont_slice <- cont
I0913 21:29:57.190552 28330 net.cpp:399] lstm2_cont_slice -> cont_1
I0913 21:29:57.190603 28330 net.cpp:141] Setting up lstm2_cont_slice
I0913 21:29:57.190616 28330 net.cpp:148] Top shape: 1 1 (1)
I0913 21:29:57.190625 28330 net.cpp:156] Memory required for data: 14012
I0913 21:29:57.190632 28330 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0913 21:29:57.190642 28330 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0913 21:29:57.190650 28330 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0913 21:29:57.190661 28330 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0913 21:29:57.190678 28330 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0913 21:29:57.190748 28330 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0913 21:29:57.190763 28330 net.cpp:148] Top shape: 1 1 (1)
I0913 21:29:57.190773 28330 net.cpp:148] Top shape: 1 1 (1)
I0913 21:29:57.190780 28330 net.cpp:156] Memory required for data: 14020
I0913 21:29:57.190788 28330 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0913 21:29:57.190809 28330 net.cpp:91] Creating Layer lstm2_x_transform
I0913 21:29:57.190816 28330 net.cpp:425] lstm2_x_transform <- x
I0913 21:29:57.190829 28330 net.cpp:399] lstm2_x_transform -> W_xc_x
I0913 21:29:57.243881 28340 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /home/peifeng/work/run/storm102/data/workers/34555c76-fb1d-4e49-b502-f6cd8a0508f0/tmp/cvld402619504795223441/bvlc_reference_caffenet.caffemodel
I0913 21:29:57.243928 28340 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0913 21:29:57.243933 28340 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0913 21:29:57.243937 28340 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /home/peifeng/work/run/storm102/data/workers/34555c76-fb1d-4e49-b502-f6cd8a0508f0/tmp/cvld402619504795223441/bvlc_reference_caffenet.caffemodel
I0913 21:29:57.247771 28330 net.cpp:141] Setting up lstm2_x_transform
I0913 21:29:57.247810 28330 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:29:57.247817 28330 net.cpp:156] Memory required for data: 30020
I0913 21:29:57.247835 28330 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0913 21:29:57.247879 28330 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0913 21:29:57.247886 28330 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0913 21:29:57.247896 28330 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0913 21:29:57.247939 28330 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0913 21:29:57.247949 28330 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:29:57.247953 28330 net.cpp:156] Memory required for data: 46020
I0913 21:29:57.247957 28330 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0913 21:29:57.247970 28330 net.cpp:91] Creating Layer lstm2_h_conted_0
I0913 21:29:57.247977 28330 net.cpp:425] lstm2_h_conted_0 <- h_0
I0913 21:29:57.247982 28330 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0913 21:29:57.247988 28330 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0913 21:29:57.248090 28330 net.cpp:141] Setting up lstm2_h_conted_0
I0913 21:29:57.248100 28330 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:29:57.248103 28330 net.cpp:156] Memory required for data: 50020
I0913 21:29:57.248108 28330 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0913 21:29:57.248123 28330 net.cpp:91] Creating Layer lstm2_transform_1
I0913 21:29:57.248128 28330 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0913 21:29:57.248136 28330 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0913 21:29:57.285665 28330 net.cpp:141] Setting up lstm2_transform_1
I0913 21:29:57.285703 28330 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:29:57.285709 28330 net.cpp:156] Memory required for data: 66020
I0913 21:29:57.285727 28330 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0913 21:29:57.285747 28330 net.cpp:91] Creating Layer lstm2_gate_input_1
I0913 21:29:57.285753 28330 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0913 21:29:57.285760 28330 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0913 21:29:57.285770 28330 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0913 21:29:57.285815 28330 net.cpp:141] Setting up lstm2_gate_input_1
I0913 21:29:57.285825 28330 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:29:57.285830 28330 net.cpp:156] Memory required for data: 82020
I0913 21:29:57.285833 28330 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0913 21:29:57.285845 28330 net.cpp:91] Creating Layer lstm2_unit_1
I0913 21:29:57.285851 28330 net.cpp:425] lstm2_unit_1 <- c_0
I0913 21:29:57.285856 28330 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0913 21:29:57.285861 28330 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0913 21:29:57.285867 28330 net.cpp:399] lstm2_unit_1 -> c_1
I0913 21:29:57.285876 28330 net.cpp:399] lstm2_unit_1 -> h_1
I0913 21:29:57.285935 28330 net.cpp:141] Setting up lstm2_unit_1
I0913 21:29:57.285943 28330 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:29:57.285949 28330 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:29:57.285953 28330 net.cpp:156] Memory required for data: 90020
I0913 21:29:57.285958 28330 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:29:57.285966 28330 net.cpp:91] Creating Layer lstm2_
I0913 21:29:57.285970 28330 net.cpp:425] lstm2_ <- c_1
I0913 21:29:57.285979 28330 net.cpp:399] lstm2_ -> c_T
I0913 21:29:57.286008 28330 net.cpp:141] Setting up lstm2_
I0913 21:29:57.286016 28330 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:29:57.286020 28330 net.cpp:156] Memory required for data: 94020
I0913 21:29:57.286025 28330 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0913 21:29:57.286034 28330 net.cpp:91] Creating Layer lstm2_h_concat
I0913 21:29:57.286038 28330 net.cpp:425] lstm2_h_concat <- h_1
I0913 21:29:57.286044 28330 net.cpp:399] lstm2_h_concat -> h
I0913 21:29:57.286078 28330 net.cpp:141] Setting up lstm2_h_concat
I0913 21:29:57.286087 28330 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:29:57.286090 28330 net.cpp:156] Memory required for data: 98020
I0913 21:29:57.286095 28330 layer_factory.hpp:77] Creating layer h_pseudoloss
I0913 21:29:57.286104 28330 net.cpp:91] Creating Layer h_pseudoloss
I0913 21:29:57.286109 28330 net.cpp:425] h_pseudoloss <- h
I0913 21:29:57.286115 28330 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0913 21:29:57.286203 28330 net.cpp:141] Setting up h_pseudoloss
I0913 21:29:57.286213 28330 net.cpp:148] Top shape: (1)
I0913 21:29:57.286217 28330 net.cpp:151]     with loss weight 1
I0913 21:29:57.286231 28330 net.cpp:156] Memory required for data: 98024
I0913 21:29:57.286237 28330 net.cpp:217] h_pseudoloss needs backward computation.
I0913 21:29:57.286240 28330 net.cpp:217] lstm2_h_concat needs backward computation.
I0913 21:29:57.286244 28330 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:29:57.286248 28330 net.cpp:217] lstm2_unit_1 needs backward computation.
I0913 21:29:57.286254 28330 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0913 21:29:57.286258 28330 net.cpp:217] lstm2_transform_1 needs backward computation.
I0913 21:29:57.286263 28330 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0913 21:29:57.286269 28330 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0913 21:29:57.286273 28330 net.cpp:217] lstm2_x_transform needs backward computation.
I0913 21:29:57.286278 28330 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0913 21:29:57.286283 28330 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0913 21:29:57.286288 28330 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:29:57.286291 28330 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:29:57.286295 28330 net.cpp:261] This network produces output c_T
I0913 21:29:57.286299 28330 net.cpp:261] This network produces output h_pseudoloss
I0913 21:29:57.286312 28330 net.cpp:274] Network initialization done.
I0913 21:29:57.286362 28330 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0913 21:29:57.286368 28330 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0913 21:29:57.286372 28330 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0913 21:29:57.286469 28330 net.cpp:141] Setting up lstm2
I0913 21:29:57.286481 28330 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:29:57.286485 28330 net.cpp:156] Memory required for data: 36412
I0913 21:29:57.286499 28330 layer_factory.hpp:77] Creating layer predict
I0913 21:29:57.286512 28330 net.cpp:91] Creating Layer predict
I0913 21:29:57.286520 28330 net.cpp:425] predict <- lstm2
I0913 21:29:57.286526 28330 net.cpp:399] predict -> predict
I0913 21:29:57.618156 28340 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0913 21:29:57.664960 28340 net.cpp:752] Ignoring source layer loss
Loading the model + trained: 9735.5ms
Using cv::Size and some other stuff: 0.112ms
I0913 21:29:57.733541 28330 net.cpp:141] Setting up predict
I0913 21:29:57.733603 28330 net.cpp:148] Top shape: 1 1 46168 (46168)
I0913 21:29:57.733609 28330 net.cpp:156] Memory required for data: 221084
I0913 21:29:57.733623 28330 layer_factory.hpp:77] Creating layer probs
I0913 21:29:57.733641 28330 net.cpp:91] Creating Layer probs
I0913 21:29:57.733649 28330 net.cpp:425] probs <- predict
I0913 21:29:57.733659 28330 net.cpp:399] probs -> probs
I0913 21:29:57.734524 28330 net.cpp:141] Setting up probs
I0913 21:29:57.734537 28330 net.cpp:148] Top shape: 1 1 46168 (46168)
I0913 21:29:57.734541 28330 net.cpp:156] Memory required for data: 405756
I0913 21:29:57.734546 28330 net.cpp:219] probs does not need backward computation.
I0913 21:29:57.734551 28330 net.cpp:219] predict does not need backward computation.
I0913 21:29:57.734556 28330 net.cpp:219] lstm2 does not need backward computation.
I0913 21:29:57.734562 28330 net.cpp:219] concat does not need backward computation.
I0913 21:29:57.734568 28330 net.cpp:219] lstm1 does not need backward computation.
I0913 21:29:57.734575 28330 net.cpp:219] embedding does not need backward computation.
I0913 21:29:57.734586 28330 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0913 21:29:57.734591 28330 net.cpp:219] reshape_frames does not need backward computation.
I0913 21:29:57.734596 28330 net.cpp:219] embed_encoder does not need backward computation.
I0913 21:29:57.734601 28330 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0913 21:29:57.734609 28330 net.cpp:219] input does not need backward computation.
I0913 21:29:57.734614 28330 net.cpp:261] This network produces output probs
I0913 21:29:57.734628 28330 net.cpp:274] Network initialization done.
Loading the mean file: 1584.36ms
I0913 21:29:58.102089 28330 net.cpp:752] Ignoring source layer data
I0913 21:29:58.102133 28330 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0913 21:29:58.102139 28330 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0913 21:29:58.172474 28330 net.cpp:752] Ignoring source layer cross_entropy_loss
TIMERTIMER 125544126
TIMERTIMER 66951522
TIMERTIMER 74158247
TIMERTIMER 42722463
TIMERTIMER 48412741
TIMERTIMER 47452975
TIMERTIMER 42460970
TIMERTIMER 47081205
TIMERTIMER 49523502
TIMERTIMER 48203177
TIMERTIMER 63476620
TIMERTIMER 48248680
TIMERTIMER 47894872
TIMERTIMER 46477444
TIMERTIMER 42541599
TIMERTIMER 49871301
TIMERTIMER 44577868
TIMERTIMER 46233753
TIMERTIMER 37549053
TIMERTIMER 42500128
TIMERTIMER 32017390
TIMERTIMER 31584669
TIMERTIMER 31552743
TIMERTIMER 32030579
TIMERTIMER 31542654
TIMERTIMER 31581267
TIMERTIMER 39051452
TIMERTIMER 31488166
TIMERTIMER 31318373
TIMERTIMER 32440793
TIMERTIMER 37785800
TIMERTIMER 31425984
TIMERTIMER 31489639
TIMERTIMER 31636089
TIMERTIMER 31423728
TIMERTIMER 31639191
TIMERTIMER 31547268
TIMERTIMER 44263090
#
# A fatal error has been detected by the Java Runtime Environment:
#
#  SIGSEGV (0xb) at pc=0x00007f68595a2ee0, pid=28263, tid=140085372581632
#
# JRE version: Java(TM) SE Runtime Environment (8.0_77-b03) (build 1.8.0_77-b03)
# Java VM: Java HotSpot(TM) 64-Bit Server VM (25.77-b03 mixed mode linux-amd64 compressed oops)
# Problematic frame:
# C  [libc.so.6+0x97ee0]
#
# Failed to write core dump. Core dumps have been disabled. To enable core dumping, try "ulimit -c unlimited" before starting Java again
#
# An error report file with more information is saved as:
# /home/peifeng/work/run/storm102/data/workers/34555c76-fb1d-4e49-b502-f6cd8a0508f0/hs_err_pid28263.log
#
# If you would like to submit a bug report, please visit:
#   http://bugreport.java.com/bugreport/crash.jsp
# The crash happened outside the Java Virtual Machine in native code.
# See problematic frame for where to report the bug.
#
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/peifeng/tools/storm102/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/peifeng/work/run/storm102/data/supervisor/stormdist/captioning-1-1473816557/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /home/peifeng/work/run/storm102/data/workers/0d8f4157-6e5d-40f9-8d70-f67e5aaacfc7/tmp/cvld8009820919722664855/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0913 21:30:29.667886 28486 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0913 21:30:29.668097 28486 layer_factory.hpp:77] Creating layer data
I0913 21:30:29.668124 28486 net.cpp:91] Creating Layer data
I0913 21:30:29.668134 28486 net.cpp:399] data -> data
I0913 21:30:30.245901 28486 net.cpp:141] Setting up data
I0913 21:30:30.246037 28486 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0913 21:30:30.246043 28486 net.cpp:156] Memory required for data: 6183480
I0913 21:30:30.246065 28486 layer_factory.hpp:77] Creating layer conv1
I0913 21:30:30.246100 28486 net.cpp:91] Creating Layer conv1
I0913 21:30:30.246109 28486 net.cpp:425] conv1 <- data
I0913 21:30:30.246124 28486 net.cpp:399] conv1 -> conv1
I0913 21:30:30.351270 28476 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/0d8f4157-6e5d-40f9-8d70-f67e5aaacfc7/tmp/cvld8009820919722664855/s2vt.words_to_preds.prototxt
I0913 21:30:30.351326 28476 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0913 21:30:30.351336 28476 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0913 21:30:30.351606 28476 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0913 21:30:30.351704 28476 layer_factory.hpp:77] Creating layer input
I0913 21:30:30.351718 28476 net.cpp:91] Creating Layer input
I0913 21:30:30.351727 28476 net.cpp:399] input -> frames_fc7
I0913 21:30:30.351744 28476 net.cpp:399] input -> cont_sentence
I0913 21:30:30.351754 28476 net.cpp:399] input -> input_sentence
I0913 21:30:30.351764 28476 net.cpp:399] input -> stage_indicator
I0913 21:30:30.352514 28476 net.cpp:141] Setting up input
I0913 21:30:30.352533 28476 net.cpp:148] Top shape: 1 4096 (4096)
I0913 21:30:30.352540 28476 net.cpp:148] Top shape: 1 1 (1)
I0913 21:30:30.352545 28476 net.cpp:148] Top shape: 1 1 (1)
I0913 21:30:30.352550 28476 net.cpp:148] Top shape: 1 1 (1)
I0913 21:30:30.352555 28476 net.cpp:156] Memory required for data: 16396
I0913 21:30:30.352560 28476 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0913 21:30:30.352581 28476 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0913 21:30:30.352586 28476 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0913 21:30:30.352608 28476 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0913 21:30:30.352620 28476 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0913 21:30:30.362102 28476 net.cpp:141] Setting up cont_sentence_input_1_split
I0913 21:30:30.362159 28476 net.cpp:148] Top shape: 1 1 (1)
I0913 21:30:30.362167 28476 net.cpp:148] Top shape: 1 1 (1)
I0913 21:30:30.362171 28476 net.cpp:156] Memory required for data: 16404
I0913 21:30:30.362184 28476 layer_factory.hpp:77] Creating layer embed_encoder
I0913 21:30:30.363018 28476 net.cpp:91] Creating Layer embed_encoder
I0913 21:30:30.363040 28476 net.cpp:425] embed_encoder <- frames_fc7
I0913 21:30:30.363060 28476 net.cpp:399] embed_encoder -> embedded_in_frames
I0913 21:30:30.392454 28476 net.cpp:141] Setting up embed_encoder
I0913 21:30:30.392499 28476 net.cpp:148] Top shape: 1 500 (500)
I0913 21:30:30.392505 28476 net.cpp:156] Memory required for data: 18404
I0913 21:30:30.392532 28476 layer_factory.hpp:77] Creating layer reshape_frames
I0913 21:30:30.392565 28476 net.cpp:91] Creating Layer reshape_frames
I0913 21:30:30.392572 28476 net.cpp:425] reshape_frames <- embedded_in_frames
I0913 21:30:30.392582 28476 net.cpp:399] reshape_frames -> embedded_input_frames
I0913 21:30:30.392748 28476 net.cpp:141] Setting up reshape_frames
I0913 21:30:30.392758 28476 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:30:30.392762 28476 net.cpp:156] Memory required for data: 20404
I0913 21:30:30.392767 28476 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0913 21:30:30.392778 28476 net.cpp:91] Creating Layer reshape_stage_indicator
I0913 21:30:30.392783 28476 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0913 21:30:30.392792 28476 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0913 21:30:30.396343 28476 net.cpp:141] Setting up reshape_stage_indicator
I0913 21:30:30.396358 28476 net.cpp:148] Top shape: 1 1 1 (1)
I0913 21:30:30.396363 28476 net.cpp:156] Memory required for data: 20408
I0913 21:30:30.396366 28476 layer_factory.hpp:77] Creating layer embedding
I0913 21:30:30.396378 28476 net.cpp:91] Creating Layer embedding
I0913 21:30:30.396383 28476 net.cpp:425] embedding <- input_sentence
I0913 21:30:30.396392 28476 net.cpp:399] embedding -> embedded_input_sentence
I0913 21:30:30.479883 28486 net.cpp:141] Setting up conv1
I0913 21:30:30.479935 28486 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0913 21:30:30.479941 28486 net.cpp:156] Memory required for data: 17799480
I0913 21:30:30.479964 28486 layer_factory.hpp:77] Creating layer relu1
I0913 21:30:30.479984 28486 net.cpp:91] Creating Layer relu1
I0913 21:30:30.479990 28486 net.cpp:425] relu1 <- conv1
I0913 21:30:30.479997 28486 net.cpp:386] relu1 -> conv1 (in-place)
I0913 21:30:30.480386 28486 net.cpp:141] Setting up relu1
I0913 21:30:30.480398 28486 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0913 21:30:30.480403 28486 net.cpp:156] Memory required for data: 29415480
I0913 21:30:30.480408 28486 layer_factory.hpp:77] Creating layer pool1
I0913 21:30:30.480429 28486 net.cpp:91] Creating Layer pool1
I0913 21:30:30.480434 28486 net.cpp:425] pool1 <- conv1
I0913 21:30:30.480443 28486 net.cpp:399] pool1 -> pool1
I0913 21:30:30.480510 28486 net.cpp:141] Setting up pool1
I0913 21:30:30.480520 28486 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0913 21:30:30.480525 28486 net.cpp:156] Memory required for data: 32214840
I0913 21:30:30.480530 28486 layer_factory.hpp:77] Creating layer norm1
I0913 21:30:30.480545 28486 net.cpp:91] Creating Layer norm1
I0913 21:30:30.480551 28486 net.cpp:425] norm1 <- pool1
I0913 21:30:30.480557 28486 net.cpp:399] norm1 -> norm1
I0913 21:30:30.480798 28486 net.cpp:141] Setting up norm1
I0913 21:30:30.480811 28486 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0913 21:30:30.480815 28486 net.cpp:156] Memory required for data: 35014200
I0913 21:30:30.480820 28486 layer_factory.hpp:77] Creating layer conv2
I0913 21:30:30.480846 28486 net.cpp:91] Creating Layer conv2
I0913 21:30:30.480851 28486 net.cpp:425] conv2 <- norm1
I0913 21:30:30.480859 28486 net.cpp:399] conv2 -> conv2
I0913 21:30:30.484068 28486 net.cpp:141] Setting up conv2
I0913 21:30:30.484093 28486 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0913 21:30:30.484098 28486 net.cpp:156] Memory required for data: 42479160
I0913 21:30:30.484110 28486 layer_factory.hpp:77] Creating layer relu2
I0913 21:30:30.484127 28486 net.cpp:91] Creating Layer relu2
I0913 21:30:30.484132 28486 net.cpp:425] relu2 <- conv2
I0913 21:30:30.484138 28486 net.cpp:386] relu2 -> conv2 (in-place)
I0913 21:30:30.484547 28486 net.cpp:141] Setting up relu2
I0913 21:30:30.484560 28486 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0913 21:30:30.484565 28486 net.cpp:156] Memory required for data: 49944120
I0913 21:30:30.484568 28486 layer_factory.hpp:77] Creating layer pool2
I0913 21:30:30.484576 28486 net.cpp:91] Creating Layer pool2
I0913 21:30:30.484580 28486 net.cpp:425] pool2 <- conv2
I0913 21:30:30.484591 28486 net.cpp:399] pool2 -> pool2
I0913 21:30:30.484645 28486 net.cpp:141] Setting up pool2
I0913 21:30:30.484654 28486 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:30:30.484658 28486 net.cpp:156] Memory required for data: 51674680
I0913 21:30:30.484663 28486 layer_factory.hpp:77] Creating layer norm2
I0913 21:30:30.484674 28486 net.cpp:91] Creating Layer norm2
I0913 21:30:30.484679 28486 net.cpp:425] norm2 <- pool2
I0913 21:30:30.484685 28486 net.cpp:399] norm2 -> norm2
I0913 21:30:30.484932 28486 net.cpp:141] Setting up norm2
I0913 21:30:30.484944 28486 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:30:30.484948 28486 net.cpp:156] Memory required for data: 53405240
I0913 21:30:30.484952 28486 layer_factory.hpp:77] Creating layer conv3
I0913 21:30:30.484966 28486 net.cpp:91] Creating Layer conv3
I0913 21:30:30.484972 28486 net.cpp:425] conv3 <- norm2
I0913 21:30:30.484978 28486 net.cpp:399] conv3 -> conv3
I0913 21:30:30.488674 28486 net.cpp:141] Setting up conv3
I0913 21:30:30.488704 28486 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:30:30.488710 28486 net.cpp:156] Memory required for data: 56001080
I0913 21:30:30.488726 28486 layer_factory.hpp:77] Creating layer relu3
I0913 21:30:30.488739 28486 net.cpp:91] Creating Layer relu3
I0913 21:30:30.488744 28486 net.cpp:425] relu3 <- conv3
I0913 21:30:30.488751 28486 net.cpp:386] relu3 -> conv3 (in-place)
I0913 21:30:30.488983 28486 net.cpp:141] Setting up relu3
I0913 21:30:30.488994 28486 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:30:30.488998 28486 net.cpp:156] Memory required for data: 58596920
I0913 21:30:30.489002 28486 layer_factory.hpp:77] Creating layer conv4
I0913 21:30:30.489015 28486 net.cpp:91] Creating Layer conv4
I0913 21:30:30.489020 28486 net.cpp:425] conv4 <- conv3
I0913 21:30:30.489029 28486 net.cpp:399] conv4 -> conv4
I0913 21:30:30.493291 28486 net.cpp:141] Setting up conv4
I0913 21:30:30.493324 28486 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:30:30.493330 28486 net.cpp:156] Memory required for data: 61192760
I0913 21:30:30.493340 28486 layer_factory.hpp:77] Creating layer relu4
I0913 21:30:30.493351 28486 net.cpp:91] Creating Layer relu4
I0913 21:30:30.493357 28486 net.cpp:425] relu4 <- conv4
I0913 21:30:30.493363 28486 net.cpp:386] relu4 -> conv4 (in-place)
I0913 21:30:30.493753 28486 net.cpp:141] Setting up relu4
I0913 21:30:30.493767 28486 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:30:30.493770 28486 net.cpp:156] Memory required for data: 63788600
I0913 21:30:30.493775 28486 layer_factory.hpp:77] Creating layer conv5
I0913 21:30:30.493787 28486 net.cpp:91] Creating Layer conv5
I0913 21:30:30.493791 28486 net.cpp:425] conv5 <- conv4
I0913 21:30:30.493806 28486 net.cpp:399] conv5 -> conv5
I0913 21:30:30.497501 28486 net.cpp:141] Setting up conv5
I0913 21:30:30.497521 28486 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:30:30.497526 28486 net.cpp:156] Memory required for data: 65519160
I0913 21:30:30.497544 28486 layer_factory.hpp:77] Creating layer relu5
I0913 21:30:30.497552 28486 net.cpp:91] Creating Layer relu5
I0913 21:30:30.497557 28486 net.cpp:425] relu5 <- conv5
I0913 21:30:30.497563 28486 net.cpp:386] relu5 -> conv5 (in-place)
I0913 21:30:30.497959 28486 net.cpp:141] Setting up relu5
I0913 21:30:30.497974 28486 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:30:30.497978 28486 net.cpp:156] Memory required for data: 67249720
I0913 21:30:30.497983 28486 layer_factory.hpp:77] Creating layer pool5
I0913 21:30:30.497995 28486 net.cpp:91] Creating Layer pool5
I0913 21:30:30.498000 28486 net.cpp:425] pool5 <- conv5
I0913 21:30:30.498008 28486 net.cpp:399] pool5 -> pool5
I0913 21:30:30.498070 28486 net.cpp:141] Setting up pool5
I0913 21:30:30.498078 28486 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0913 21:30:30.498082 28486 net.cpp:156] Memory required for data: 67618360
I0913 21:30:30.498087 28486 layer_factory.hpp:77] Creating layer fc6
I0913 21:30:30.498102 28486 net.cpp:91] Creating Layer fc6
I0913 21:30:30.498107 28486 net.cpp:425] fc6 <- pool5
I0913 21:30:30.498114 28486 net.cpp:399] fc6 -> fc6
I0913 21:30:30.617543 28476 net.cpp:141] Setting up embedding
I0913 21:30:30.617591 28476 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:30:30.617597 28476 net.cpp:156] Memory required for data: 22408
I0913 21:30:30.617615 28476 layer_factory.hpp:77] Creating layer lstm1
I0913 21:30:30.617647 28476 net.cpp:91] Creating Layer lstm1
I0913 21:30:30.617655 28476 net.cpp:425] lstm1 <- embedded_input_frames
I0913 21:30:30.617663 28476 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0913 21:30:30.617683 28476 net.cpp:399] lstm1 -> lstm1
I0913 21:30:30.617688 28486 net.cpp:141] Setting up fc6
I0913 21:30:30.617710 28476 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0913 21:30:30.617729 28486 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:30:30.617736 28486 net.cpp:156] Memory required for data: 67782200
I0913 21:30:30.617750 28486 layer_factory.hpp:77] Creating layer relu6
I0913 21:30:30.617764 28486 net.cpp:91] Creating Layer relu6
I0913 21:30:30.617770 28486 net.cpp:425] relu6 <- fc6
I0913 21:30:30.617782 28486 net.cpp:386] relu6 -> fc6 (in-place)
I0913 21:30:30.618106 28476 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0913 21:30:30.618163 28486 net.cpp:141] Setting up relu6
I0913 21:30:30.618175 28486 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:30:30.618182 28486 net.cpp:156] Memory required for data: 67946040
I0913 21:30:30.618191 28486 layer_factory.hpp:77] Creating layer drop6
I0913 21:30:30.618199 28476 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:30:30.618208 28486 net.cpp:91] Creating Layer drop6
I0913 21:30:30.618211 28476 net.cpp:91] Creating Layer lstm1_
I0913 21:30:30.618213 28486 net.cpp:425] drop6 <- fc6
I0913 21:30:30.618218 28476 net.cpp:399] lstm1_ -> x
I0913 21:30:30.618221 28486 net.cpp:386] drop6 -> fc6 (in-place)
I0913 21:30:30.618230 28476 net.cpp:399] lstm1_ -> cont
I0913 21:30:30.618276 28486 net.cpp:141] Setting up drop6
I0913 21:30:30.618286 28486 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:30:30.618290 28486 net.cpp:156] Memory required for data: 68109880
I0913 21:30:30.618294 28486 layer_factory.hpp:77] Creating layer fc7
I0913 21:30:30.618304 28486 net.cpp:91] Creating Layer fc7
I0913 21:30:30.618309 28486 net.cpp:425] fc7 <- fc6
I0913 21:30:30.618317 28486 net.cpp:399] fc7 -> fc7
I0913 21:30:30.618342 28476 net.cpp:141] Setting up lstm1_
I0913 21:30:30.618355 28476 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:30:30.618360 28476 net.cpp:148] Top shape: 1 1 (1)
I0913 21:30:30.618365 28476 net.cpp:156] Memory required for data: 2004
I0913 21:30:30.618371 28476 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:30:30.618378 28476 net.cpp:91] Creating Layer lstm1_
I0913 21:30:30.618388 28476 net.cpp:399] lstm1_ -> c_0
I0913 21:30:30.618398 28476 net.cpp:399] lstm1_ -> h_0
I0913 21:30:30.646829 28476 net.cpp:141] Setting up lstm1_
I0913 21:30:30.646880 28476 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:30:30.646888 28476 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:30:30.646893 28476 net.cpp:156] Memory required for data: 10004
I0913 21:30:30.646901 28476 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0913 21:30:30.646920 28476 net.cpp:91] Creating Layer lstm1_cont_slice
I0913 21:30:30.646929 28476 net.cpp:425] lstm1_cont_slice <- cont
I0913 21:30:30.646944 28476 net.cpp:399] lstm1_cont_slice -> cont_1
I0913 21:30:30.647033 28476 net.cpp:141] Setting up lstm1_cont_slice
I0913 21:30:30.647045 28476 net.cpp:148] Top shape: 1 1 (1)
I0913 21:30:30.647049 28476 net.cpp:156] Memory required for data: 10008
I0913 21:30:30.647054 28476 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0913 21:30:30.647065 28476 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0913 21:30:30.647070 28476 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0913 21:30:30.647078 28476 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0913 21:30:30.647110 28476 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0913 21:30:30.647176 28476 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0913 21:30:30.647186 28476 net.cpp:148] Top shape: 1 1 (1)
I0913 21:30:30.647192 28476 net.cpp:148] Top shape: 1 1 (1)
I0913 21:30:30.647194 28476 net.cpp:156] Memory required for data: 10016
I0913 21:30:30.647199 28476 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0913 21:30:30.647214 28476 net.cpp:91] Creating Layer lstm1_x_transform
I0913 21:30:30.647219 28476 net.cpp:425] lstm1_x_transform <- x
I0913 21:30:30.647229 28476 net.cpp:399] lstm1_x_transform -> W_xc_x
I0913 21:30:30.663816 28486 net.cpp:141] Setting up fc7
I0913 21:30:30.663877 28486 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:30:30.663882 28486 net.cpp:156] Memory required for data: 68273720
I0913 21:30:30.663897 28486 layer_factory.hpp:77] Creating layer relu7
I0913 21:30:30.663923 28486 net.cpp:91] Creating Layer relu7
I0913 21:30:30.663931 28486 net.cpp:425] relu7 <- fc7
I0913 21:30:30.663943 28486 net.cpp:386] relu7 -> fc7 (in-place)
I0913 21:30:30.664587 28486 net.cpp:141] Setting up relu7
I0913 21:30:30.664600 28486 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:30:30.664605 28486 net.cpp:156] Memory required for data: 68437560
I0913 21:30:30.664610 28486 layer_factory.hpp:77] Creating layer drop7
I0913 21:30:30.664620 28486 net.cpp:91] Creating Layer drop7
I0913 21:30:30.664625 28486 net.cpp:425] drop7 <- fc7
I0913 21:30:30.664634 28486 net.cpp:386] drop7 -> fc7 (in-place)
I0913 21:30:30.664674 28486 net.cpp:141] Setting up drop7
I0913 21:30:30.664682 28486 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:30:30.664687 28486 net.cpp:156] Memory required for data: 68601400
I0913 21:30:30.664691 28486 layer_factory.hpp:77] Creating layer fc8
I0913 21:30:30.664701 28486 net.cpp:91] Creating Layer fc8
I0913 21:30:30.664705 28486 net.cpp:425] fc8 <- fc7
I0913 21:30:30.664711 28486 net.cpp:399] fc8 -> fc8
I0913 21:30:30.672255 28476 net.cpp:141] Setting up lstm1_x_transform
I0913 21:30:30.672313 28476 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:30:30.672325 28476 net.cpp:156] Memory required for data: 26016
I0913 21:30:30.672355 28476 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0913 21:30:30.672382 28476 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0913 21:30:30.672392 28476 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0913 21:30:30.672413 28476 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0913 21:30:30.672485 28476 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0913 21:30:30.672502 28476 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:30:30.672508 28476 net.cpp:156] Memory required for data: 42016
I0913 21:30:30.672515 28476 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0913 21:30:30.672533 28476 net.cpp:91] Creating Layer lstm1_h_conted_0
I0913 21:30:30.672541 28476 net.cpp:425] lstm1_h_conted_0 <- h_0
I0913 21:30:30.672551 28476 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0913 21:30:30.672562 28476 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0913 21:30:30.672703 28476 net.cpp:141] Setting up lstm1_h_conted_0
I0913 21:30:30.672719 28476 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:30:30.672725 28476 net.cpp:156] Memory required for data: 46016
I0913 21:30:30.672734 28476 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0913 21:30:30.672754 28476 net.cpp:91] Creating Layer lstm1_transform_1
I0913 21:30:30.672761 28476 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0913 21:30:30.672775 28476 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0913 21:30:30.682899 28486 net.cpp:141] Setting up fc8
I0913 21:30:30.682947 28486 net.cpp:148] Top shape: 10 1000 (10000)
I0913 21:30:30.682953 28486 net.cpp:156] Memory required for data: 68641400
I0913 21:30:30.682967 28486 layer_factory.hpp:77] Creating layer prob
I0913 21:30:30.683063 28486 net.cpp:91] Creating Layer prob
I0913 21:30:30.683114 28486 net.cpp:425] prob <- fc8
I0913 21:30:30.683145 28486 net.cpp:399] prob -> prob
I0913 21:30:30.684203 28486 net.cpp:141] Setting up prob
I0913 21:30:30.684247 28486 net.cpp:148] Top shape: 10 1000 (10000)
I0913 21:30:30.684262 28486 net.cpp:156] Memory required for data: 68681400
I0913 21:30:30.684278 28486 net.cpp:219] prob does not need backward computation.
I0913 21:30:30.684293 28486 net.cpp:219] fc8 does not need backward computation.
I0913 21:30:30.684308 28486 net.cpp:219] drop7 does not need backward computation.
I0913 21:30:30.684319 28486 net.cpp:219] relu7 does not need backward computation.
I0913 21:30:30.684331 28486 net.cpp:219] fc7 does not need backward computation.
I0913 21:30:30.684345 28486 net.cpp:219] drop6 does not need backward computation.
I0913 21:30:30.684358 28486 net.cpp:219] relu6 does not need backward computation.
I0913 21:30:30.684370 28486 net.cpp:219] fc6 does not need backward computation.
I0913 21:30:30.684392 28486 net.cpp:219] pool5 does not need backward computation.
I0913 21:30:30.684406 28486 net.cpp:219] relu5 does not need backward computation.
I0913 21:30:30.684419 28486 net.cpp:219] conv5 does not need backward computation.
I0913 21:30:30.684432 28486 net.cpp:219] relu4 does not need backward computation.
I0913 21:30:30.684443 28486 net.cpp:219] conv4 does not need backward computation.
I0913 21:30:30.684455 28486 net.cpp:219] relu3 does not need backward computation.
I0913 21:30:30.684466 28486 net.cpp:219] conv3 does not need backward computation.
I0913 21:30:30.684479 28486 net.cpp:219] norm2 does not need backward computation.
I0913 21:30:30.684492 28486 net.cpp:219] pool2 does not need backward computation.
I0913 21:30:30.684504 28486 net.cpp:219] relu2 does not need backward computation.
I0913 21:30:30.684516 28486 net.cpp:219] conv2 does not need backward computation.
I0913 21:30:30.684528 28486 net.cpp:219] norm1 does not need backward computation.
I0913 21:30:30.684540 28486 net.cpp:219] pool1 does not need backward computation.
I0913 21:30:30.684554 28486 net.cpp:219] relu1 does not need backward computation.
I0913 21:30:30.684566 28486 net.cpp:219] conv1 does not need backward computation.
I0913 21:30:30.684579 28486 net.cpp:219] data does not need backward computation.
I0913 21:30:30.684589 28486 net.cpp:261] This network produces output prob
I0913 21:30:30.684639 28486 net.cpp:274] Network initialization done.
I0913 21:30:30.727398 28476 net.cpp:141] Setting up lstm1_transform_1
I0913 21:30:30.728260 28476 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:30:30.728641 28476 net.cpp:156] Memory required for data: 62016
I0913 21:30:30.728922 28476 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0913 21:30:30.729177 28476 net.cpp:91] Creating Layer lstm1_gate_input_1
I0913 21:30:30.729511 28476 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0913 21:30:30.729734 28476 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0913 21:30:30.729972 28476 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0913 21:30:30.730381 28476 net.cpp:141] Setting up lstm1_gate_input_1
I0913 21:30:30.730543 28476 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:30:30.730682 28476 net.cpp:156] Memory required for data: 78016
I0913 21:30:30.730835 28476 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0913 21:30:30.730985 28476 net.cpp:91] Creating Layer lstm1_unit_1
I0913 21:30:30.731202 28476 net.cpp:425] lstm1_unit_1 <- c_0
I0913 21:30:30.731354 28476 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0913 21:30:30.731503 28476 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0913 21:30:30.731653 28476 net.cpp:399] lstm1_unit_1 -> c_1
I0913 21:30:30.731781 28476 net.cpp:399] lstm1_unit_1 -> h_1
I0913 21:30:30.731887 28476 net.cpp:141] Setting up lstm1_unit_1
I0913 21:30:30.731899 28476 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:30:30.731905 28476 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:30:30.731909 28476 net.cpp:156] Memory required for data: 86016
I0913 21:30:30.731914 28476 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:30:30.731923 28476 net.cpp:91] Creating Layer lstm1_
I0913 21:30:30.731928 28476 net.cpp:425] lstm1_ <- c_1
I0913 21:30:30.731937 28476 net.cpp:399] lstm1_ -> c_T
I0913 21:30:30.731971 28476 net.cpp:141] Setting up lstm1_
I0913 21:30:30.731979 28476 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:30:30.731983 28476 net.cpp:156] Memory required for data: 90016
I0913 21:30:30.731988 28476 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0913 21:30:30.732002 28476 net.cpp:91] Creating Layer lstm1_h_concat
I0913 21:30:30.732009 28476 net.cpp:425] lstm1_h_concat <- h_1
I0913 21:30:30.732017 28476 net.cpp:399] lstm1_h_concat -> h
I0913 21:30:30.732056 28476 net.cpp:141] Setting up lstm1_h_concat
I0913 21:30:30.732065 28476 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:30:30.732069 28476 net.cpp:156] Memory required for data: 94016
I0913 21:30:30.732084 28476 layer_factory.hpp:77] Creating layer h_pseudoloss
I0913 21:30:30.732107 28476 net.cpp:91] Creating Layer h_pseudoloss
I0913 21:30:30.732112 28476 net.cpp:425] h_pseudoloss <- h
I0913 21:30:30.732120 28476 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0913 21:30:30.732218 28476 net.cpp:141] Setting up h_pseudoloss
I0913 21:30:30.732229 28476 net.cpp:148] Top shape: (1)
I0913 21:30:30.732234 28476 net.cpp:151]     with loss weight 1
I0913 21:30:30.732269 28476 net.cpp:156] Memory required for data: 94020
I0913 21:30:30.732273 28476 net.cpp:217] h_pseudoloss needs backward computation.
I0913 21:30:30.732278 28476 net.cpp:217] lstm1_h_concat needs backward computation.
I0913 21:30:30.732282 28476 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:30:30.732286 28476 net.cpp:217] lstm1_unit_1 needs backward computation.
I0913 21:30:30.732295 28476 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0913 21:30:30.732300 28476 net.cpp:217] lstm1_transform_1 needs backward computation.
I0913 21:30:30.732305 28476 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0913 21:30:30.732309 28476 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0913 21:30:30.732313 28476 net.cpp:217] lstm1_x_transform needs backward computation.
I0913 21:30:30.732318 28476 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0913 21:30:30.732323 28476 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0913 21:30:30.732328 28476 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:30:30.732331 28476 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:30:30.732336 28476 net.cpp:261] This network produces output c_T
I0913 21:30:30.732339 28476 net.cpp:261] This network produces output h_pseudoloss
I0913 21:30:30.732353 28476 net.cpp:274] Network initialization done.
I0913 21:30:30.732405 28476 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0913 21:30:30.732411 28476 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0913 21:30:30.732415 28476 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0913 21:30:30.732517 28476 net.cpp:141] Setting up lstm1
I0913 21:30:30.732528 28476 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:30:30.732532 28476 net.cpp:156] Memory required for data: 26408
I0913 21:30:30.732545 28476 layer_factory.hpp:77] Creating layer concat
I0913 21:30:30.732553 28476 net.cpp:91] Creating Layer concat
I0913 21:30:30.732559 28476 net.cpp:425] concat <- lstm1
I0913 21:30:30.732564 28476 net.cpp:425] concat <- embedded_input_sentence
I0913 21:30:30.732570 28476 net.cpp:425] concat <- reshaped_stage_indicator
I0913 21:30:30.732576 28476 net.cpp:399] concat -> lstm1_video_sequence
I0913 21:30:30.732609 28476 net.cpp:141] Setting up concat
I0913 21:30:30.732616 28476 net.cpp:148] Top shape: 1 1 1501 (1501)
I0913 21:30:30.732620 28476 net.cpp:156] Memory required for data: 32412
I0913 21:30:30.732625 28476 layer_factory.hpp:77] Creating layer lstm2
I0913 21:30:30.732636 28476 net.cpp:91] Creating Layer lstm2
I0913 21:30:30.732641 28476 net.cpp:425] lstm2 <- lstm1_video_sequence
I0913 21:30:30.732646 28476 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0913 21:30:30.732653 28476 net.cpp:399] lstm2 -> lstm2
I0913 21:30:30.732664 28476 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0913 21:30:30.732923 28476 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0913 21:30:30.733055 28476 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:30:30.733072 28476 net.cpp:91] Creating Layer lstm2_
I0913 21:30:30.733078 28476 net.cpp:399] lstm2_ -> x
I0913 21:30:30.733088 28476 net.cpp:399] lstm2_ -> cont
I0913 21:30:30.733139 28476 net.cpp:141] Setting up lstm2_
I0913 21:30:30.733149 28476 net.cpp:148] Top shape: 1 1 1501 (1501)
I0913 21:30:30.733155 28476 net.cpp:148] Top shape: 1 1 (1)
I0913 21:30:30.733158 28476 net.cpp:156] Memory required for data: 6008
I0913 21:30:30.733162 28476 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:30:30.733173 28476 net.cpp:91] Creating Layer lstm2_
I0913 21:30:30.733180 28476 net.cpp:399] lstm2_ -> c_0
I0913 21:30:30.733188 28476 net.cpp:399] lstm2_ -> h_0
I0913 21:30:30.733237 28476 net.cpp:141] Setting up lstm2_
I0913 21:30:30.733245 28476 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:30:30.733250 28476 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:30:30.733254 28476 net.cpp:156] Memory required for data: 14008
I0913 21:30:30.733258 28476 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0913 21:30:30.733266 28476 net.cpp:91] Creating Layer lstm2_cont_slice
I0913 21:30:30.733270 28476 net.cpp:425] lstm2_cont_slice <- cont
I0913 21:30:30.733278 28476 net.cpp:399] lstm2_cont_slice -> cont_1
I0913 21:30:30.733310 28476 net.cpp:141] Setting up lstm2_cont_slice
I0913 21:30:30.733319 28476 net.cpp:148] Top shape: 1 1 (1)
I0913 21:30:30.733322 28476 net.cpp:156] Memory required for data: 14012
I0913 21:30:30.733326 28476 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0913 21:30:30.733332 28476 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0913 21:30:30.733336 28476 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0913 21:30:30.733345 28476 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0913 21:30:30.733352 28476 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0913 21:30:30.733397 28476 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0913 21:30:30.733404 28476 net.cpp:148] Top shape: 1 1 (1)
I0913 21:30:30.733409 28476 net.cpp:148] Top shape: 1 1 (1)
I0913 21:30:30.733413 28476 net.cpp:156] Memory required for data: 14020
I0913 21:30:30.733417 28476 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0913 21:30:30.733428 28476 net.cpp:91] Creating Layer lstm2_x_transform
I0913 21:30:30.733433 28476 net.cpp:425] lstm2_x_transform <- x
I0913 21:30:30.733453 28476 net.cpp:399] lstm2_x_transform -> W_xc_x
I0913 21:30:30.791079 28476 net.cpp:141] Setting up lstm2_x_transform
I0913 21:30:30.791131 28476 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:30:30.791136 28476 net.cpp:156] Memory required for data: 30020
I0913 21:30:30.791157 28476 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0913 21:30:30.791174 28476 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0913 21:30:30.791180 28476 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0913 21:30:30.791189 28476 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0913 21:30:30.791240 28476 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0913 21:30:30.791250 28476 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:30:30.791254 28476 net.cpp:156] Memory required for data: 46020
I0913 21:30:30.791259 28476 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0913 21:30:30.791268 28476 net.cpp:91] Creating Layer lstm2_h_conted_0
I0913 21:30:30.791273 28476 net.cpp:425] lstm2_h_conted_0 <- h_0
I0913 21:30:30.791280 28476 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0913 21:30:30.791286 28476 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0913 21:30:30.791373 28476 net.cpp:141] Setting up lstm2_h_conted_0
I0913 21:30:30.791383 28476 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:30:30.791386 28476 net.cpp:156] Memory required for data: 50020
I0913 21:30:30.791390 28476 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0913 21:30:30.791402 28476 net.cpp:91] Creating Layer lstm2_transform_1
I0913 21:30:30.791407 28476 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0913 21:30:30.791414 28476 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0913 21:30:30.830163 28476 net.cpp:141] Setting up lstm2_transform_1
I0913 21:30:30.830214 28476 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:30:30.830219 28476 net.cpp:156] Memory required for data: 66020
I0913 21:30:30.830238 28476 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0913 21:30:30.830258 28476 net.cpp:91] Creating Layer lstm2_gate_input_1
I0913 21:30:30.830265 28476 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0913 21:30:30.830272 28476 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0913 21:30:30.830286 28476 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0913 21:30:30.830338 28476 net.cpp:141] Setting up lstm2_gate_input_1
I0913 21:30:30.830348 28476 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:30:30.830350 28476 net.cpp:156] Memory required for data: 82020
I0913 21:30:30.830355 28476 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0913 21:30:30.830363 28476 net.cpp:91] Creating Layer lstm2_unit_1
I0913 21:30:30.830368 28476 net.cpp:425] lstm2_unit_1 <- c_0
I0913 21:30:30.830374 28476 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0913 21:30:30.830379 28476 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0913 21:30:30.830384 28476 net.cpp:399] lstm2_unit_1 -> c_1
I0913 21:30:30.830395 28476 net.cpp:399] lstm2_unit_1 -> h_1
I0913 21:30:30.830456 28476 net.cpp:141] Setting up lstm2_unit_1
I0913 21:30:30.830463 28476 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:30:30.830469 28476 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:30:30.830473 28476 net.cpp:156] Memory required for data: 90020
I0913 21:30:30.830477 28476 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:30:30.830487 28476 net.cpp:91] Creating Layer lstm2_
I0913 21:30:30.830492 28476 net.cpp:425] lstm2_ <- c_1
I0913 21:30:30.830497 28476 net.cpp:399] lstm2_ -> c_T
I0913 21:30:30.830529 28476 net.cpp:141] Setting up lstm2_
I0913 21:30:30.830538 28476 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:30:30.830541 28476 net.cpp:156] Memory required for data: 94020
I0913 21:30:30.830546 28476 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0913 21:30:30.830555 28476 net.cpp:91] Creating Layer lstm2_h_concat
I0913 21:30:30.830560 28476 net.cpp:425] lstm2_h_concat <- h_1
I0913 21:30:30.830569 28476 net.cpp:399] lstm2_h_concat -> h
I0913 21:30:30.830601 28476 net.cpp:141] Setting up lstm2_h_concat
I0913 21:30:30.830608 28476 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:30:30.830612 28476 net.cpp:156] Memory required for data: 98020
I0913 21:30:30.830617 28476 layer_factory.hpp:77] Creating layer h_pseudoloss
I0913 21:30:30.830628 28476 net.cpp:91] Creating Layer h_pseudoloss
I0913 21:30:30.830632 28476 net.cpp:425] h_pseudoloss <- h
I0913 21:30:30.830639 28476 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0913 21:30:30.830729 28476 net.cpp:141] Setting up h_pseudoloss
I0913 21:30:30.830737 28476 net.cpp:148] Top shape: (1)
I0913 21:30:30.830742 28476 net.cpp:151]     with loss weight 1
I0913 21:30:30.830760 28476 net.cpp:156] Memory required for data: 98024
I0913 21:30:30.830765 28476 net.cpp:217] h_pseudoloss needs backward computation.
I0913 21:30:30.830768 28476 net.cpp:217] lstm2_h_concat needs backward computation.
I0913 21:30:30.830772 28476 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:30:30.830776 28476 net.cpp:217] lstm2_unit_1 needs backward computation.
I0913 21:30:30.830781 28476 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0913 21:30:30.830785 28476 net.cpp:217] lstm2_transform_1 needs backward computation.
I0913 21:30:30.830790 28476 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0913 21:30:30.830796 28476 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0913 21:30:30.830799 28476 net.cpp:217] lstm2_x_transform needs backward computation.
I0913 21:30:30.830804 28476 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0913 21:30:30.830808 28476 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0913 21:30:30.830813 28476 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:30:30.830816 28476 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:30:30.830821 28476 net.cpp:261] This network produces output c_T
I0913 21:30:30.830824 28476 net.cpp:261] This network produces output h_pseudoloss
I0913 21:30:30.830840 28476 net.cpp:274] Network initialization done.
I0913 21:30:30.830893 28476 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0913 21:30:30.830899 28476 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0913 21:30:30.830902 28476 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0913 21:30:30.830999 28476 net.cpp:141] Setting up lstm2
I0913 21:30:30.831010 28476 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:30:30.831015 28476 net.cpp:156] Memory required for data: 36412
I0913 21:30:30.831028 28476 layer_factory.hpp:77] Creating layer predict
I0913 21:30:30.831042 28476 net.cpp:91] Creating Layer predict
I0913 21:30:30.831048 28476 net.cpp:425] predict <- lstm2
I0913 21:30:30.831054 28476 net.cpp:399] predict -> predict
I0913 21:30:30.984493 28486 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /home/peifeng/work/run/storm102/data/workers/0d8f4157-6e5d-40f9-8d70-f67e5aaacfc7/tmp/cvld8009820919722664855/bvlc_reference_caffenet.caffemodel
I0913 21:30:30.984539 28486 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0913 21:30:30.984545 28486 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0913 21:30:30.984549 28486 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /home/peifeng/work/run/storm102/data/workers/0d8f4157-6e5d-40f9-8d70-f67e5aaacfc7/tmp/cvld8009820919722664855/bvlc_reference_caffenet.caffemodel
I0913 21:30:31.272778 28476 net.cpp:141] Setting up predict
I0913 21:30:31.272831 28476 net.cpp:148] Top shape: 1 1 46168 (46168)
I0913 21:30:31.272837 28476 net.cpp:156] Memory required for data: 221084
I0913 21:30:31.272851 28476 layer_factory.hpp:77] Creating layer probs
I0913 21:30:31.272868 28476 net.cpp:91] Creating Layer probs
I0913 21:30:31.272876 28476 net.cpp:425] probs <- predict
I0913 21:30:31.272886 28476 net.cpp:399] probs -> probs
I0913 21:30:31.273659 28476 net.cpp:141] Setting up probs
I0913 21:30:31.273672 28476 net.cpp:148] Top shape: 1 1 46168 (46168)
I0913 21:30:31.273676 28476 net.cpp:156] Memory required for data: 405756
I0913 21:30:31.273681 28476 net.cpp:219] probs does not need backward computation.
I0913 21:30:31.273685 28476 net.cpp:219] predict does not need backward computation.
I0913 21:30:31.273690 28476 net.cpp:219] lstm2 does not need backward computation.
I0913 21:30:31.273695 28476 net.cpp:219] concat does not need backward computation.
I0913 21:30:31.273701 28476 net.cpp:219] lstm1 does not need backward computation.
I0913 21:30:31.273707 28476 net.cpp:219] embedding does not need backward computation.
I0913 21:30:31.273712 28476 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0913 21:30:31.273716 28476 net.cpp:219] reshape_frames does not need backward computation.
I0913 21:30:31.273721 28476 net.cpp:219] embed_encoder does not need backward computation.
I0913 21:30:31.273725 28476 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0913 21:30:31.273730 28476 net.cpp:219] input does not need backward computation.
I0913 21:30:31.273733 28476 net.cpp:261] This network produces output probs
I0913 21:30:31.273746 28476 net.cpp:274] Network initialization done.
I0913 21:30:31.366552 28486 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0913 21:30:31.422025 28486 net.cpp:752] Ignoring source layer loss
Loading the model + trained: 11361.8ms
Using cv::Size and some other stuff: 0.174ms
Loading the mean file: 1647.59ms
I0913 21:30:31.681352 28476 net.cpp:752] Ignoring source layer data
I0913 21:30:31.681402 28476 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0913 21:30:31.681407 28476 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0913 21:30:31.760599 28476 net.cpp:752] Ignoring source layer cross_entropy_loss
TIMERTIMER 136131901
TIMERTIMER 71743484
TIMERTIMER 73534425
TIMERTIMER 48314041
TIMERTIMER 49732985
TIMERTIMER 50055695
TIMERTIMER 48720624
TIMERTIMER 48991593
TIMERTIMER 50141926
TIMERTIMER 43811763
TIMERTIMER 48935357
TIMERTIMER 44652078
TIMERTIMER 49730766
TIMERTIMER 49358198
TIMERTIMER 48038595
TIMERTIMER 49729744
TIMERTIMER 50039057
TIMERTIMER 50356962
TIMERTIMER 49778488
TIMERTIMER 37693502
TIMERTIMER 31321114
TIMERTIMER 31070687
TIMERTIMER 37558920
TIMERTIMER 31633758
TIMERTIMER 34573630
TIMERTIMER 31299672
TIMERTIMER 32165198
TIMERTIMER 34581469
TIMERTIMER 31446825
TIMERTIMER 31374388
TIMERTIMER 31878235
TIMERTIMER 38539933
TIMERTIMER 37154533
TIMERTIMER 35662261
TIMERTIMER 37544444
TIMERTIMER 34408521
TIMERTIMER 32648645
TIMERTIMER 37469315
TIMERTIMER 38649561
TIMERTIMER 31198500
TIMERTIMER 31194314
TIMERTIMER 38271853
TIMERTIMER 32171608
TIMERTIMER 37587682
TIMERTIMER 37916406
TIMERTIMER 31167314
TIMERTIMER 31231665
TIMERTIMER 32830841
TIMERTIMER 33071112
TIMERTIMER 37593895
TIMERTIMER 31321437
TIMERTIMER 31671250
TIMERTIMER 37289469
TIMERTIMER 37581123
TIMERTIMER 32556304
TIMERTIMER 39091180
TIMERTIMER 39933092
TIMERTIMER 32574371
TIMERTIMER 37077579
TIMERTIMER 31362225
TIMERTIMER 31239715
TIMERTIMER 33235314
TIMERTIMER 38247632
TIMERTIMER 38267037
TIMERTIMER 31743485
TIMERTIMER 37992173
TIMERTIMER 32316615
TIMERTIMER 31592339
TIMERTIMER 31786126
TIMERTIMER 31781119
TIMERTIMER 37786419
TIMERTIMER 31809867
TIMERTIMER 51706303
TIMERTIMER 33056270
TIMERTIMER 31840541
TIMERTIMER 38504344
TIMERTIMER 31724239
TIMERTIMER 37714436
TIMERTIMER 31818618
TIMERTIMER 32600900
TIMERTIMER 49992905
TIMERTIMER 31722639
TIMERTIMER 37910059
TIMERTIMER 31626568
TIMERTIMER 38089970
TIMERTIMER 40644033
TIMERTIMER 32523615
TIMERTIMER 31566110
TIMERTIMER 31695332
TIMERTIMER 32317260
TIMERTIMER 31687137
TIMERTIMER 38299492
TIMERTIMER 32444863
TIMERTIMER 31624078
TIMERTIMER 32075367
TIMERTIMER 41698094
TIMERTIMER 38387482
TIMERTIMER 31858199
TIMERTIMER 31774564
TIMERTIMER 38545333
TIMERTIMER 38703046
TIMERTIMER 31609563
TIMERTIMER 32202270
TIMERTIMER 33000978
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/peifeng/tools/storm102/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/peifeng/work/run/storm102/data/supervisor/stormdist/captioning-1-1473816557/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /home/peifeng/work/run/storm102/data/workers/eb8f5b3a-f7e2-4ebe-8aa6-ff07e0356181/tmp/cvld1167890082610586237/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0913 21:31:38.792316 28638 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0913 21:31:38.792489 28638 layer_factory.hpp:77] Creating layer data
I0913 21:31:38.792513 28638 net.cpp:91] Creating Layer data
I0913 21:31:38.792523 28638 net.cpp:399] data -> data
I0913 21:31:39.326532 28638 net.cpp:141] Setting up data
I0913 21:31:39.326616 28638 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0913 21:31:39.326622 28638 net.cpp:156] Memory required for data: 6183480
I0913 21:31:39.326638 28638 layer_factory.hpp:77] Creating layer conv1
I0913 21:31:39.326665 28638 net.cpp:91] Creating Layer conv1
I0913 21:31:39.326673 28638 net.cpp:425] conv1 <- data
I0913 21:31:39.326685 28638 net.cpp:399] conv1 -> conv1
I0913 21:31:39.503654 28638 net.cpp:141] Setting up conv1
I0913 21:31:39.503701 28638 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0913 21:31:39.503708 28638 net.cpp:156] Memory required for data: 17799480
I0913 21:31:39.503736 28638 layer_factory.hpp:77] Creating layer relu1
I0913 21:31:39.503752 28638 net.cpp:91] Creating Layer relu1
I0913 21:31:39.503758 28638 net.cpp:425] relu1 <- conv1
I0913 21:31:39.503767 28638 net.cpp:386] relu1 -> conv1 (in-place)
I0913 21:31:39.504163 28638 net.cpp:141] Setting up relu1
I0913 21:31:39.504178 28638 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0913 21:31:39.504181 28638 net.cpp:156] Memory required for data: 29415480
I0913 21:31:39.504186 28638 layer_factory.hpp:77] Creating layer pool1
I0913 21:31:39.504200 28638 net.cpp:91] Creating Layer pool1
I0913 21:31:39.504205 28638 net.cpp:425] pool1 <- conv1
I0913 21:31:39.504212 28638 net.cpp:399] pool1 -> pool1
I0913 21:31:39.504287 28638 net.cpp:141] Setting up pool1
I0913 21:31:39.504297 28638 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0913 21:31:39.504302 28638 net.cpp:156] Memory required for data: 32214840
I0913 21:31:39.504305 28638 layer_factory.hpp:77] Creating layer norm1
I0913 21:31:39.504320 28638 net.cpp:91] Creating Layer norm1
I0913 21:31:39.504325 28638 net.cpp:425] norm1 <- pool1
I0913 21:31:39.504334 28638 net.cpp:399] norm1 -> norm1
I0913 21:31:39.504597 28638 net.cpp:141] Setting up norm1
I0913 21:31:39.504608 28638 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0913 21:31:39.504613 28638 net.cpp:156] Memory required for data: 35014200
I0913 21:31:39.504617 28638 layer_factory.hpp:77] Creating layer conv2
I0913 21:31:39.504629 28638 net.cpp:91] Creating Layer conv2
I0913 21:31:39.504634 28638 net.cpp:425] conv2 <- norm1
I0913 21:31:39.504644 28638 net.cpp:399] conv2 -> conv2
I0913 21:31:39.508462 28638 net.cpp:141] Setting up conv2
I0913 21:31:39.508481 28638 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0913 21:31:39.508486 28638 net.cpp:156] Memory required for data: 42479160
I0913 21:31:39.508497 28638 layer_factory.hpp:77] Creating layer relu2
I0913 21:31:39.508507 28638 net.cpp:91] Creating Layer relu2
I0913 21:31:39.508512 28638 net.cpp:425] relu2 <- conv2
I0913 21:31:39.508522 28638 net.cpp:386] relu2 -> conv2 (in-place)
I0913 21:31:39.508908 28638 net.cpp:141] Setting up relu2
I0913 21:31:39.508919 28638 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0913 21:31:39.508924 28638 net.cpp:156] Memory required for data: 49944120
I0913 21:31:39.508929 28638 layer_factory.hpp:77] Creating layer pool2
I0913 21:31:39.508941 28638 net.cpp:91] Creating Layer pool2
I0913 21:31:39.508946 28638 net.cpp:425] pool2 <- conv2
I0913 21:31:39.508952 28638 net.cpp:399] pool2 -> pool2
I0913 21:31:39.509009 28638 net.cpp:141] Setting up pool2
I0913 21:31:39.509018 28638 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:31:39.509022 28638 net.cpp:156] Memory required for data: 51674680
I0913 21:31:39.509027 28638 layer_factory.hpp:77] Creating layer norm2
I0913 21:31:39.509037 28638 net.cpp:91] Creating Layer norm2
I0913 21:31:39.509042 28638 net.cpp:425] norm2 <- pool2
I0913 21:31:39.509048 28638 net.cpp:399] norm2 -> norm2
I0913 21:31:39.509296 28638 net.cpp:141] Setting up norm2
I0913 21:31:39.509308 28638 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:31:39.509312 28638 net.cpp:156] Memory required for data: 53405240
I0913 21:31:39.509317 28638 layer_factory.hpp:77] Creating layer conv3
I0913 21:31:39.509330 28638 net.cpp:91] Creating Layer conv3
I0913 21:31:39.509335 28638 net.cpp:425] conv3 <- norm2
I0913 21:31:39.509342 28638 net.cpp:399] conv3 -> conv3
I0913 21:31:39.514266 28638 net.cpp:141] Setting up conv3
I0913 21:31:39.514300 28638 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:31:39.514307 28638 net.cpp:156] Memory required for data: 56001080
I0913 21:31:39.514323 28638 layer_factory.hpp:77] Creating layer relu3
I0913 21:31:39.514335 28638 net.cpp:91] Creating Layer relu3
I0913 21:31:39.514341 28638 net.cpp:425] relu3 <- conv3
I0913 21:31:39.514350 28638 net.cpp:386] relu3 -> conv3 (in-place)
I0913 21:31:39.514571 28638 net.cpp:141] Setting up relu3
I0913 21:31:39.514583 28638 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:31:39.514587 28638 net.cpp:156] Memory required for data: 58596920
I0913 21:31:39.514592 28638 layer_factory.hpp:77] Creating layer conv4
I0913 21:31:39.514606 28638 net.cpp:91] Creating Layer conv4
I0913 21:31:39.514611 28638 net.cpp:425] conv4 <- conv3
I0913 21:31:39.514621 28638 net.cpp:399] conv4 -> conv4
I0913 21:31:39.518584 28638 net.cpp:141] Setting up conv4
I0913 21:31:39.518607 28638 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:31:39.518613 28638 net.cpp:156] Memory required for data: 61192760
I0913 21:31:39.518622 28638 layer_factory.hpp:77] Creating layer relu4
I0913 21:31:39.518631 28638 net.cpp:91] Creating Layer relu4
I0913 21:31:39.518636 28638 net.cpp:425] relu4 <- conv4
I0913 21:31:39.518643 28638 net.cpp:386] relu4 -> conv4 (in-place)
I0913 21:31:39.519028 28638 net.cpp:141] Setting up relu4
I0913 21:31:39.519042 28638 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:31:39.519045 28638 net.cpp:156] Memory required for data: 63788600
I0913 21:31:39.519050 28638 layer_factory.hpp:77] Creating layer conv5
I0913 21:31:39.519063 28638 net.cpp:91] Creating Layer conv5
I0913 21:31:39.519068 28638 net.cpp:425] conv5 <- conv4
I0913 21:31:39.519075 28638 net.cpp:399] conv5 -> conv5
I0913 21:31:39.522666 28638 net.cpp:141] Setting up conv5
I0913 21:31:39.522685 28638 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:31:39.522691 28638 net.cpp:156] Memory required for data: 65519160
I0913 21:31:39.522706 28638 layer_factory.hpp:77] Creating layer relu5
I0913 21:31:39.522714 28638 net.cpp:91] Creating Layer relu5
I0913 21:31:39.522719 28638 net.cpp:425] relu5 <- conv5
I0913 21:31:39.522725 28638 net.cpp:386] relu5 -> conv5 (in-place)
I0913 21:31:39.523118 28638 net.cpp:141] Setting up relu5
I0913 21:31:39.523131 28638 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:31:39.523135 28638 net.cpp:156] Memory required for data: 67249720
I0913 21:31:39.523140 28638 layer_factory.hpp:77] Creating layer pool5
I0913 21:31:39.523150 28638 net.cpp:91] Creating Layer pool5
I0913 21:31:39.523154 28638 net.cpp:425] pool5 <- conv5
I0913 21:31:39.523161 28638 net.cpp:399] pool5 -> pool5
I0913 21:31:39.523222 28638 net.cpp:141] Setting up pool5
I0913 21:31:39.523231 28638 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0913 21:31:39.523236 28638 net.cpp:156] Memory required for data: 67618360
I0913 21:31:39.523241 28638 layer_factory.hpp:77] Creating layer fc6
I0913 21:31:39.523263 28638 net.cpp:91] Creating Layer fc6
I0913 21:31:39.523269 28638 net.cpp:425] fc6 <- pool5
I0913 21:31:39.523275 28638 net.cpp:399] fc6 -> fc6
I0913 21:31:39.627358 28638 net.cpp:141] Setting up fc6
I0913 21:31:39.627403 28638 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:31:39.627413 28638 net.cpp:156] Memory required for data: 67782200
I0913 21:31:39.627430 28638 layer_factory.hpp:77] Creating layer relu6
I0913 21:31:39.627449 28638 net.cpp:91] Creating Layer relu6
I0913 21:31:39.627459 28638 net.cpp:425] relu6 <- fc6
I0913 21:31:39.627477 28638 net.cpp:386] relu6 -> fc6 (in-place)
I0913 21:31:39.627933 28638 net.cpp:141] Setting up relu6
I0913 21:31:39.627954 28638 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:31:39.627962 28638 net.cpp:156] Memory required for data: 67946040
I0913 21:31:39.627970 28638 layer_factory.hpp:77] Creating layer drop6
I0913 21:31:39.627993 28638 net.cpp:91] Creating Layer drop6
I0913 21:31:39.628003 28638 net.cpp:425] drop6 <- fc6
I0913 21:31:39.628015 28638 net.cpp:386] drop6 -> fc6 (in-place)
I0913 21:31:39.628098 28638 net.cpp:141] Setting up drop6
I0913 21:31:39.628113 28638 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:31:39.628121 28638 net.cpp:156] Memory required for data: 68109880
I0913 21:31:39.628130 28638 layer_factory.hpp:77] Creating layer fc7
I0913 21:31:39.628147 28638 net.cpp:91] Creating Layer fc7
I0913 21:31:39.628156 28638 net.cpp:425] fc7 <- fc6
I0913 21:31:39.628168 28638 net.cpp:399] fc7 -> fc7
I0913 21:31:39.671494 28627 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/eb8f5b3a-f7e2-4ebe-8aa6-ff07e0356181/tmp/cvld1167890082610586237/s2vt.words_to_preds.prototxt
I0913 21:31:39.671558 28627 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0913 21:31:39.671571 28627 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0913 21:31:39.671932 28627 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0913 21:31:39.672067 28627 layer_factory.hpp:77] Creating layer input
I0913 21:31:39.672098 28627 net.cpp:91] Creating Layer input
I0913 21:31:39.672111 28627 net.cpp:399] input -> frames_fc7
I0913 21:31:39.672132 28627 net.cpp:399] input -> cont_sentence
I0913 21:31:39.672148 28627 net.cpp:399] input -> input_sentence
I0913 21:31:39.672163 28627 net.cpp:399] input -> stage_indicator
I0913 21:31:39.672353 28627 net.cpp:141] Setting up input
I0913 21:31:39.672372 28627 net.cpp:148] Top shape: 1 4096 (4096)
I0913 21:31:39.672382 28627 net.cpp:148] Top shape: 1 1 (1)
I0913 21:31:39.672391 28627 net.cpp:148] Top shape: 1 1 (1)
I0913 21:31:39.672400 28627 net.cpp:148] Top shape: 1 1 (1)
I0913 21:31:39.672407 28627 net.cpp:156] Memory required for data: 16396
I0913 21:31:39.672415 28627 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0913 21:31:39.672442 28627 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0913 21:31:39.672451 28627 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0913 21:31:39.672482 28627 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0913 21:31:39.672497 28627 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0913 21:31:39.672571 28627 net.cpp:141] Setting up cont_sentence_input_1_split
I0913 21:31:39.672586 28627 net.cpp:148] Top shape: 1 1 (1)
I0913 21:31:39.672597 28627 net.cpp:148] Top shape: 1 1 (1)
I0913 21:31:39.672603 28627 net.cpp:156] Memory required for data: 16404
I0913 21:31:39.672610 28627 layer_factory.hpp:77] Creating layer embed_encoder
I0913 21:31:39.672626 28627 net.cpp:91] Creating Layer embed_encoder
I0913 21:31:39.672633 28627 net.cpp:425] embed_encoder <- frames_fc7
I0913 21:31:39.672648 28627 net.cpp:399] embed_encoder -> embedded_in_frames
I0913 21:31:39.678247 28638 net.cpp:141] Setting up fc7
I0913 21:31:39.678293 28638 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:31:39.678305 28638 net.cpp:156] Memory required for data: 68273720
I0913 21:31:39.678328 28638 layer_factory.hpp:77] Creating layer relu7
I0913 21:31:39.678351 28638 net.cpp:91] Creating Layer relu7
I0913 21:31:39.678364 28638 net.cpp:425] relu7 <- fc7
I0913 21:31:39.678386 28638 net.cpp:386] relu7 -> fc7 (in-place)
I0913 21:31:39.679177 28638 net.cpp:141] Setting up relu7
I0913 21:31:39.679196 28638 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:31:39.679205 28638 net.cpp:156] Memory required for data: 68437560
I0913 21:31:39.679214 28638 layer_factory.hpp:77] Creating layer drop7
I0913 21:31:39.679229 28638 net.cpp:91] Creating Layer drop7
I0913 21:31:39.679239 28638 net.cpp:425] drop7 <- fc7
I0913 21:31:39.679257 28638 net.cpp:386] drop7 -> fc7 (in-place)
I0913 21:31:39.679322 28638 net.cpp:141] Setting up drop7
I0913 21:31:39.679339 28638 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:31:39.679348 28638 net.cpp:156] Memory required for data: 68601400
I0913 21:31:39.679357 28638 layer_factory.hpp:77] Creating layer fc8
I0913 21:31:39.679371 28638 net.cpp:91] Creating Layer fc8
I0913 21:31:39.679381 28638 net.cpp:425] fc8 <- fc7
I0913 21:31:39.679395 28638 net.cpp:399] fc8 -> fc8
I0913 21:31:39.694880 28638 net.cpp:141] Setting up fc8
I0913 21:31:39.694926 28638 net.cpp:148] Top shape: 10 1000 (10000)
I0913 21:31:39.694938 28638 net.cpp:156] Memory required for data: 68641400
I0913 21:31:39.694959 28638 layer_factory.hpp:77] Creating layer prob
I0913 21:31:39.694983 28638 net.cpp:91] Creating Layer prob
I0913 21:31:39.694994 28638 net.cpp:425] prob <- fc8
I0913 21:31:39.695015 28638 net.cpp:399] prob -> prob
I0913 21:31:39.695678 28638 net.cpp:141] Setting up prob
I0913 21:31:39.695698 28638 net.cpp:148] Top shape: 10 1000 (10000)
I0913 21:31:39.695708 28638 net.cpp:156] Memory required for data: 68681400
I0913 21:31:39.695718 28638 net.cpp:219] prob does not need backward computation.
I0913 21:31:39.695727 28638 net.cpp:219] fc8 does not need backward computation.
I0913 21:31:39.695736 28638 net.cpp:219] drop7 does not need backward computation.
I0913 21:31:39.695744 28638 net.cpp:219] relu7 does not need backward computation.
I0913 21:31:39.695754 28638 net.cpp:219] fc7 does not need backward computation.
I0913 21:31:39.695761 28638 net.cpp:219] drop6 does not need backward computation.
I0913 21:31:39.695770 28638 net.cpp:219] relu6 does not need backward computation.
I0913 21:31:39.695778 28638 net.cpp:219] fc6 does not need backward computation.
I0913 21:31:39.695787 28638 net.cpp:219] pool5 does not need backward computation.
I0913 21:31:39.695796 28638 net.cpp:219] relu5 does not need backward computation.
I0913 21:31:39.695806 28638 net.cpp:219] conv5 does not need backward computation.
I0913 21:31:39.695814 28638 net.cpp:219] relu4 does not need backward computation.
I0913 21:31:39.695823 28638 net.cpp:219] conv4 does not need backward computation.
I0913 21:31:39.695832 28638 net.cpp:219] relu3 does not need backward computation.
I0913 21:31:39.695840 28638 net.cpp:219] conv3 does not need backward computation.
I0913 21:31:39.695850 28638 net.cpp:219] norm2 does not need backward computation.
I0913 21:31:39.695859 28638 net.cpp:219] pool2 does not need backward computation.
I0913 21:31:39.695868 28638 net.cpp:219] relu2 does not need backward computation.
I0913 21:31:39.695878 28638 net.cpp:219] conv2 does not need backward computation.
I0913 21:31:39.695885 28638 net.cpp:219] norm1 does not need backward computation.
I0913 21:31:39.695894 28638 net.cpp:219] pool1 does not need backward computation.
I0913 21:31:39.695904 28638 net.cpp:219] relu1 does not need backward computation.
I0913 21:31:39.695912 28638 net.cpp:219] conv1 does not need backward computation.
I0913 21:31:39.695921 28638 net.cpp:219] data does not need backward computation.
I0913 21:31:39.695929 28638 net.cpp:261] This network produces output prob
I0913 21:31:39.695966 28638 net.cpp:274] Network initialization done.
I0913 21:31:39.710942 28627 net.cpp:141] Setting up embed_encoder
I0913 21:31:39.710984 28627 net.cpp:148] Top shape: 1 500 (500)
I0913 21:31:39.710994 28627 net.cpp:156] Memory required for data: 18404
I0913 21:31:39.711019 28627 layer_factory.hpp:77] Creating layer reshape_frames
I0913 21:31:39.711426 28627 net.cpp:91] Creating Layer reshape_frames
I0913 21:31:39.711438 28627 net.cpp:425] reshape_frames <- embedded_in_frames
I0913 21:31:39.711453 28627 net.cpp:399] reshape_frames -> embedded_input_frames
I0913 21:31:39.711537 28627 net.cpp:141] Setting up reshape_frames
I0913 21:31:39.711551 28627 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:31:39.711558 28627 net.cpp:156] Memory required for data: 20404
I0913 21:31:39.711566 28627 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0913 21:31:39.711580 28627 net.cpp:91] Creating Layer reshape_stage_indicator
I0913 21:31:39.711587 28627 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0913 21:31:39.711599 28627 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0913 21:31:39.711653 28627 net.cpp:141] Setting up reshape_stage_indicator
I0913 21:31:39.711668 28627 net.cpp:148] Top shape: 1 1 1 (1)
I0913 21:31:39.711674 28627 net.cpp:156] Memory required for data: 20408
I0913 21:31:39.711681 28627 layer_factory.hpp:77] Creating layer embedding
I0913 21:31:39.711699 28627 net.cpp:91] Creating Layer embedding
I0913 21:31:39.711709 28627 net.cpp:425] embedding <- input_sentence
I0913 21:31:39.711719 28627 net.cpp:399] embedding -> embedded_input_sentence
I0913 21:31:39.930541 28638 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /home/peifeng/work/run/storm102/data/workers/eb8f5b3a-f7e2-4ebe-8aa6-ff07e0356181/tmp/cvld1167890082610586237/bvlc_reference_caffenet.caffemodel
I0913 21:31:39.930579 28638 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0913 21:31:39.930588 28638 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0913 21:31:39.930594 28638 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /home/peifeng/work/run/storm102/data/workers/eb8f5b3a-f7e2-4ebe-8aa6-ff07e0356181/tmp/cvld1167890082610586237/bvlc_reference_caffenet.caffemodel
I0913 21:31:39.944932 28627 net.cpp:141] Setting up embedding
I0913 21:31:39.944973 28627 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:31:39.944979 28627 net.cpp:156] Memory required for data: 22408
I0913 21:31:39.944994 28627 layer_factory.hpp:77] Creating layer lstm1
I0913 21:31:39.945024 28627 net.cpp:91] Creating Layer lstm1
I0913 21:31:39.945031 28627 net.cpp:425] lstm1 <- embedded_input_frames
I0913 21:31:39.945039 28627 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0913 21:31:39.945050 28627 net.cpp:399] lstm1 -> lstm1
I0913 21:31:39.945073 28627 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0913 21:31:39.945399 28627 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0913 21:31:39.945487 28627 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:31:39.945499 28627 net.cpp:91] Creating Layer lstm1_
I0913 21:31:39.945504 28627 net.cpp:399] lstm1_ -> x
I0913 21:31:39.945515 28627 net.cpp:399] lstm1_ -> cont
I0913 21:31:39.945579 28627 net.cpp:141] Setting up lstm1_
I0913 21:31:39.945588 28627 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:31:39.945595 28627 net.cpp:148] Top shape: 1 1 (1)
I0913 21:31:39.945598 28627 net.cpp:156] Memory required for data: 2004
I0913 21:31:39.945603 28627 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:31:39.945611 28627 net.cpp:91] Creating Layer lstm1_
I0913 21:31:39.945619 28627 net.cpp:399] lstm1_ -> c_0
I0913 21:31:39.945628 28627 net.cpp:399] lstm1_ -> h_0
I0913 21:31:39.945675 28627 net.cpp:141] Setting up lstm1_
I0913 21:31:39.945686 28627 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:31:39.945693 28627 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:31:39.945696 28627 net.cpp:156] Memory required for data: 10004
I0913 21:31:39.945700 28627 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0913 21:31:39.945708 28627 net.cpp:91] Creating Layer lstm1_cont_slice
I0913 21:31:39.945713 28627 net.cpp:425] lstm1_cont_slice <- cont
I0913 21:31:39.945719 28627 net.cpp:399] lstm1_cont_slice -> cont_1
I0913 21:31:39.945755 28627 net.cpp:141] Setting up lstm1_cont_slice
I0913 21:31:39.945763 28627 net.cpp:148] Top shape: 1 1 (1)
I0913 21:31:39.945768 28627 net.cpp:156] Memory required for data: 10008
I0913 21:31:39.945772 28627 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0913 21:31:39.945781 28627 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0913 21:31:39.945785 28627 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0913 21:31:39.945792 28627 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0913 21:31:39.945799 28627 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0913 21:31:39.945847 28627 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0913 21:31:39.945855 28627 net.cpp:148] Top shape: 1 1 (1)
I0913 21:31:39.945860 28627 net.cpp:148] Top shape: 1 1 (1)
I0913 21:31:39.945864 28627 net.cpp:156] Memory required for data: 10016
I0913 21:31:39.945868 28627 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0913 21:31:39.945878 28627 net.cpp:91] Creating Layer lstm1_x_transform
I0913 21:31:39.945883 28627 net.cpp:425] lstm1_x_transform <- x
I0913 21:31:39.945891 28627 net.cpp:399] lstm1_x_transform -> W_xc_x
I0913 21:31:39.965379 28627 net.cpp:141] Setting up lstm1_x_transform
I0913 21:31:39.965415 28627 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:31:39.965420 28627 net.cpp:156] Memory required for data: 26016
I0913 21:31:39.965437 28627 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0913 21:31:39.965451 28627 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0913 21:31:39.965457 28627 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0913 21:31:39.965466 28627 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0913 21:31:39.965515 28627 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0913 21:31:39.965525 28627 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:31:39.965529 28627 net.cpp:156] Memory required for data: 42016
I0913 21:31:39.965533 28627 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0913 21:31:39.965543 28627 net.cpp:91] Creating Layer lstm1_h_conted_0
I0913 21:31:39.965546 28627 net.cpp:425] lstm1_h_conted_0 <- h_0
I0913 21:31:39.965553 28627 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0913 21:31:39.965559 28627 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0913 21:31:39.965651 28627 net.cpp:141] Setting up lstm1_h_conted_0
I0913 21:31:39.965659 28627 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:31:39.965663 28627 net.cpp:156] Memory required for data: 46016
I0913 21:31:39.965668 28627 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0913 21:31:39.965679 28627 net.cpp:91] Creating Layer lstm1_transform_1
I0913 21:31:39.965683 28627 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0913 21:31:39.965693 28627 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0913 21:31:40.013737 28627 net.cpp:141] Setting up lstm1_transform_1
I0913 21:31:40.013785 28627 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:31:40.013792 28627 net.cpp:156] Memory required for data: 62016
I0913 21:31:40.013809 28627 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0913 21:31:40.013839 28627 net.cpp:91] Creating Layer lstm1_gate_input_1
I0913 21:31:40.013846 28627 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0913 21:31:40.013854 28627 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0913 21:31:40.013864 28627 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0913 21:31:40.013918 28627 net.cpp:141] Setting up lstm1_gate_input_1
I0913 21:31:40.013927 28627 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:31:40.013932 28627 net.cpp:156] Memory required for data: 78016
I0913 21:31:40.013936 28627 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0913 21:31:40.013944 28627 net.cpp:91] Creating Layer lstm1_unit_1
I0913 21:31:40.013949 28627 net.cpp:425] lstm1_unit_1 <- c_0
I0913 21:31:40.013955 28627 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0913 21:31:40.013960 28627 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0913 21:31:40.013967 28627 net.cpp:399] lstm1_unit_1 -> c_1
I0913 21:31:40.013977 28627 net.cpp:399] lstm1_unit_1 -> h_1
I0913 21:31:40.014039 28627 net.cpp:141] Setting up lstm1_unit_1
I0913 21:31:40.014047 28627 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:31:40.014053 28627 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:31:40.014057 28627 net.cpp:156] Memory required for data: 86016
I0913 21:31:40.014061 28627 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:31:40.014070 28627 net.cpp:91] Creating Layer lstm1_
I0913 21:31:40.014073 28627 net.cpp:425] lstm1_ <- c_1
I0913 21:31:40.014081 28627 net.cpp:399] lstm1_ -> c_T
I0913 21:31:40.014112 28627 net.cpp:141] Setting up lstm1_
I0913 21:31:40.014122 28627 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:31:40.014125 28627 net.cpp:156] Memory required for data: 90016
I0913 21:31:40.014129 28627 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0913 21:31:40.014138 28627 net.cpp:91] Creating Layer lstm1_h_concat
I0913 21:31:40.014142 28627 net.cpp:425] lstm1_h_concat <- h_1
I0913 21:31:40.014152 28627 net.cpp:399] lstm1_h_concat -> h
I0913 21:31:40.014183 28627 net.cpp:141] Setting up lstm1_h_concat
I0913 21:31:40.014191 28627 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:31:40.014195 28627 net.cpp:156] Memory required for data: 94016
I0913 21:31:40.014200 28627 layer_factory.hpp:77] Creating layer h_pseudoloss
I0913 21:31:40.014219 28627 net.cpp:91] Creating Layer h_pseudoloss
I0913 21:31:40.014222 28627 net.cpp:425] h_pseudoloss <- h
I0913 21:31:40.014230 28627 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0913 21:31:40.014313 28627 net.cpp:141] Setting up h_pseudoloss
I0913 21:31:40.014323 28627 net.cpp:148] Top shape: (1)
I0913 21:31:40.014328 28627 net.cpp:151]     with loss weight 1
I0913 21:31:40.014360 28627 net.cpp:156] Memory required for data: 94020
I0913 21:31:40.014365 28627 net.cpp:217] h_pseudoloss needs backward computation.
I0913 21:31:40.014370 28627 net.cpp:217] lstm1_h_concat needs backward computation.
I0913 21:31:40.014374 28627 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:31:40.014379 28627 net.cpp:217] lstm1_unit_1 needs backward computation.
I0913 21:31:40.014384 28627 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0913 21:31:40.014389 28627 net.cpp:217] lstm1_transform_1 needs backward computation.
I0913 21:31:40.014394 28627 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0913 21:31:40.014400 28627 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0913 21:31:40.014405 28627 net.cpp:217] lstm1_x_transform needs backward computation.
I0913 21:31:40.014410 28627 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0913 21:31:40.014415 28627 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0913 21:31:40.014420 28627 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:31:40.014423 28627 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:31:40.014427 28627 net.cpp:261] This network produces output c_T
I0913 21:31:40.014431 28627 net.cpp:261] This network produces output h_pseudoloss
I0913 21:31:40.014447 28627 net.cpp:274] Network initialization done.
I0913 21:31:40.014497 28627 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0913 21:31:40.014503 28627 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0913 21:31:40.014506 28627 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0913 21:31:40.014606 28627 net.cpp:141] Setting up lstm1
I0913 21:31:40.014618 28627 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:31:40.014622 28627 net.cpp:156] Memory required for data: 26408
I0913 21:31:40.014634 28627 layer_factory.hpp:77] Creating layer concat
I0913 21:31:40.014643 28627 net.cpp:91] Creating Layer concat
I0913 21:31:40.014648 28627 net.cpp:425] concat <- lstm1
I0913 21:31:40.014654 28627 net.cpp:425] concat <- embedded_input_sentence
I0913 21:31:40.014660 28627 net.cpp:425] concat <- reshaped_stage_indicator
I0913 21:31:40.014667 28627 net.cpp:399] concat -> lstm1_video_sequence
I0913 21:31:40.014699 28627 net.cpp:141] Setting up concat
I0913 21:31:40.014708 28627 net.cpp:148] Top shape: 1 1 1501 (1501)
I0913 21:31:40.014711 28627 net.cpp:156] Memory required for data: 32412
I0913 21:31:40.014715 28627 layer_factory.hpp:77] Creating layer lstm2
I0913 21:31:40.014727 28627 net.cpp:91] Creating Layer lstm2
I0913 21:31:40.014731 28627 net.cpp:425] lstm2 <- lstm1_video_sequence
I0913 21:31:40.014737 28627 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0913 21:31:40.014744 28627 net.cpp:399] lstm2 -> lstm2
I0913 21:31:40.014753 28627 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0913 21:31:40.014992 28627 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0913 21:31:40.015074 28627 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:31:40.015084 28627 net.cpp:91] Creating Layer lstm2_
I0913 21:31:40.015089 28627 net.cpp:399] lstm2_ -> x
I0913 21:31:40.015100 28627 net.cpp:399] lstm2_ -> cont
I0913 21:31:40.015152 28627 net.cpp:141] Setting up lstm2_
I0913 21:31:40.015161 28627 net.cpp:148] Top shape: 1 1 1501 (1501)
I0913 21:31:40.015167 28627 net.cpp:148] Top shape: 1 1 (1)
I0913 21:31:40.015172 28627 net.cpp:156] Memory required for data: 6008
I0913 21:31:40.015177 28627 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:31:40.015183 28627 net.cpp:91] Creating Layer lstm2_
I0913 21:31:40.015194 28627 net.cpp:399] lstm2_ -> c_0
I0913 21:31:40.015204 28627 net.cpp:399] lstm2_ -> h_0
I0913 21:31:40.015249 28627 net.cpp:141] Setting up lstm2_
I0913 21:31:40.015257 28627 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:31:40.015264 28627 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:31:40.015266 28627 net.cpp:156] Memory required for data: 14008
I0913 21:31:40.015271 28627 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0913 21:31:40.015281 28627 net.cpp:91] Creating Layer lstm2_cont_slice
I0913 21:31:40.015286 28627 net.cpp:425] lstm2_cont_slice <- cont
I0913 21:31:40.015292 28627 net.cpp:399] lstm2_cont_slice -> cont_1
I0913 21:31:40.015323 28627 net.cpp:141] Setting up lstm2_cont_slice
I0913 21:31:40.015332 28627 net.cpp:148] Top shape: 1 1 (1)
I0913 21:31:40.015336 28627 net.cpp:156] Memory required for data: 14012
I0913 21:31:40.015341 28627 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0913 21:31:40.015347 28627 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0913 21:31:40.015350 28627 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0913 21:31:40.015359 28627 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0913 21:31:40.015367 28627 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0913 21:31:40.015413 28627 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0913 21:31:40.015422 28627 net.cpp:148] Top shape: 1 1 (1)
I0913 21:31:40.015427 28627 net.cpp:148] Top shape: 1 1 (1)
I0913 21:31:40.015431 28627 net.cpp:156] Memory required for data: 14020
I0913 21:31:40.015435 28627 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0913 21:31:40.015444 28627 net.cpp:91] Creating Layer lstm2_x_transform
I0913 21:31:40.015449 28627 net.cpp:425] lstm2_x_transform <- x
I0913 21:31:40.015455 28627 net.cpp:399] lstm2_x_transform -> W_xc_x
I0913 21:31:40.073488 28627 net.cpp:141] Setting up lstm2_x_transform
I0913 21:31:40.073541 28627 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:31:40.073547 28627 net.cpp:156] Memory required for data: 30020
I0913 21:31:40.073565 28627 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0913 21:31:40.073580 28627 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0913 21:31:40.073586 28627 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0913 21:31:40.073595 28627 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0913 21:31:40.073637 28627 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0913 21:31:40.073647 28627 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:31:40.073650 28627 net.cpp:156] Memory required for data: 46020
I0913 21:31:40.073654 28627 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0913 21:31:40.073671 28627 net.cpp:91] Creating Layer lstm2_h_conted_0
I0913 21:31:40.073676 28627 net.cpp:425] lstm2_h_conted_0 <- h_0
I0913 21:31:40.073683 28627 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0913 21:31:40.073688 28627 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0913 21:31:40.073777 28627 net.cpp:141] Setting up lstm2_h_conted_0
I0913 21:31:40.073787 28627 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:31:40.073791 28627 net.cpp:156] Memory required for data: 50020
I0913 21:31:40.073796 28627 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0913 21:31:40.073807 28627 net.cpp:91] Creating Layer lstm2_transform_1
I0913 21:31:40.073812 28627 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0913 21:31:40.073819 28627 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0913 21:31:40.112593 28627 net.cpp:141] Setting up lstm2_transform_1
I0913 21:31:40.112635 28627 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:31:40.112642 28627 net.cpp:156] Memory required for data: 66020
I0913 21:31:40.112658 28627 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0913 21:31:40.112679 28627 net.cpp:91] Creating Layer lstm2_gate_input_1
I0913 21:31:40.112685 28627 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0913 21:31:40.112692 28627 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0913 21:31:40.112700 28627 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0913 21:31:40.112756 28627 net.cpp:141] Setting up lstm2_gate_input_1
I0913 21:31:40.112764 28627 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:31:40.112768 28627 net.cpp:156] Memory required for data: 82020
I0913 21:31:40.112772 28627 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0913 21:31:40.112781 28627 net.cpp:91] Creating Layer lstm2_unit_1
I0913 21:31:40.112785 28627 net.cpp:425] lstm2_unit_1 <- c_0
I0913 21:31:40.112790 28627 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0913 21:31:40.112795 28627 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0913 21:31:40.112802 28627 net.cpp:399] lstm2_unit_1 -> c_1
I0913 21:31:40.112809 28627 net.cpp:399] lstm2_unit_1 -> h_1
I0913 21:31:40.112871 28627 net.cpp:141] Setting up lstm2_unit_1
I0913 21:31:40.112880 28627 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:31:40.112885 28627 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:31:40.112890 28627 net.cpp:156] Memory required for data: 90020
I0913 21:31:40.112895 28627 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:31:40.112905 28627 net.cpp:91] Creating Layer lstm2_
I0913 21:31:40.112908 28627 net.cpp:425] lstm2_ <- c_1
I0913 21:31:40.112915 28627 net.cpp:399] lstm2_ -> c_T
I0913 21:31:40.112946 28627 net.cpp:141] Setting up lstm2_
I0913 21:31:40.112953 28627 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:31:40.112957 28627 net.cpp:156] Memory required for data: 94020
I0913 21:31:40.112962 28627 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0913 21:31:40.112970 28627 net.cpp:91] Creating Layer lstm2_h_concat
I0913 21:31:40.112975 28627 net.cpp:425] lstm2_h_concat <- h_1
I0913 21:31:40.112984 28627 net.cpp:399] lstm2_h_concat -> h
I0913 21:31:40.113018 28627 net.cpp:141] Setting up lstm2_h_concat
I0913 21:31:40.113028 28627 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:31:40.113031 28627 net.cpp:156] Memory required for data: 98020
I0913 21:31:40.113035 28627 layer_factory.hpp:77] Creating layer h_pseudoloss
I0913 21:31:40.113044 28627 net.cpp:91] Creating Layer h_pseudoloss
I0913 21:31:40.113049 28627 net.cpp:425] h_pseudoloss <- h
I0913 21:31:40.113054 28627 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0913 21:31:40.113132 28627 net.cpp:141] Setting up h_pseudoloss
I0913 21:31:40.113142 28627 net.cpp:148] Top shape: (1)
I0913 21:31:40.113145 28627 net.cpp:151]     with loss weight 1
I0913 21:31:40.113162 28627 net.cpp:156] Memory required for data: 98024
I0913 21:31:40.113167 28627 net.cpp:217] h_pseudoloss needs backward computation.
I0913 21:31:40.113171 28627 net.cpp:217] lstm2_h_concat needs backward computation.
I0913 21:31:40.113175 28627 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:31:40.113180 28627 net.cpp:217] lstm2_unit_1 needs backward computation.
I0913 21:31:40.113185 28627 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0913 21:31:40.113190 28627 net.cpp:217] lstm2_transform_1 needs backward computation.
I0913 21:31:40.113195 28627 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0913 21:31:40.113204 28627 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0913 21:31:40.113207 28627 net.cpp:217] lstm2_x_transform needs backward computation.
I0913 21:31:40.113212 28627 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0913 21:31:40.113217 28627 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0913 21:31:40.113222 28627 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:31:40.113226 28627 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:31:40.113230 28627 net.cpp:261] This network produces output c_T
I0913 21:31:40.113234 28627 net.cpp:261] This network produces output h_pseudoloss
I0913 21:31:40.113248 28627 net.cpp:274] Network initialization done.
I0913 21:31:40.113293 28627 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0913 21:31:40.113299 28627 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0913 21:31:40.113303 28627 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0913 21:31:40.113397 28627 net.cpp:141] Setting up lstm2
I0913 21:31:40.113415 28627 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:31:40.113421 28627 net.cpp:156] Memory required for data: 36412
I0913 21:31:40.113441 28627 layer_factory.hpp:77] Creating layer predict
I0913 21:31:40.113457 28627 net.cpp:91] Creating Layer predict
I0913 21:31:40.113463 28627 net.cpp:425] predict <- lstm2
I0913 21:31:40.113471 28627 net.cpp:399] predict -> predict
I0913 21:31:40.347450 28638 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0913 21:31:40.394045 28638 net.cpp:752] Ignoring source layer loss
Loading the model + trained: 10814.1ms
Using cv::Size and some other stuff: 0.583ms
I0913 21:31:40.601186 28627 net.cpp:141] Setting up predict
I0913 21:31:40.601232 28627 net.cpp:148] Top shape: 1 1 46168 (46168)
I0913 21:31:40.601238 28627 net.cpp:156] Memory required for data: 221084
I0913 21:31:40.601249 28627 layer_factory.hpp:77] Creating layer probs
I0913 21:31:40.601264 28627 net.cpp:91] Creating Layer probs
I0913 21:31:40.601271 28627 net.cpp:425] probs <- predict
I0913 21:31:40.601280 28627 net.cpp:399] probs -> probs
I0913 21:31:40.602383 28627 net.cpp:141] Setting up probs
I0913 21:31:40.602413 28627 net.cpp:148] Top shape: 1 1 46168 (46168)
I0913 21:31:40.602419 28627 net.cpp:156] Memory required for data: 405756
I0913 21:31:40.602427 28627 net.cpp:219] probs does not need backward computation.
I0913 21:31:40.602433 28627 net.cpp:219] predict does not need backward computation.
I0913 21:31:40.602438 28627 net.cpp:219] lstm2 does not need backward computation.
I0913 21:31:40.602443 28627 net.cpp:219] concat does not need backward computation.
I0913 21:31:40.602449 28627 net.cpp:219] lstm1 does not need backward computation.
I0913 21:31:40.602455 28627 net.cpp:219] embedding does not need backward computation.
I0913 21:31:40.602460 28627 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0913 21:31:40.602464 28627 net.cpp:219] reshape_frames does not need backward computation.
I0913 21:31:40.602469 28627 net.cpp:219] embed_encoder does not need backward computation.
I0913 21:31:40.602473 28627 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0913 21:31:40.602478 28627 net.cpp:219] input does not need backward computation.
I0913 21:31:40.602483 28627 net.cpp:261] This network produces output probs
I0913 21:31:40.602497 28627 net.cpp:274] Network initialization done.
Loading the mean file: 2580.15ms
I0913 21:31:40.922395 28627 net.cpp:752] Ignoring source layer data
I0913 21:31:40.922431 28627 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0913 21:31:40.922438 28627 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0913 21:31:40.992905 28627 net.cpp:752] Ignoring source layer cross_entropy_loss
TIMERTIMER 125433377
TIMERTIMER 69412227
TIMERTIMER 57119571
TIMERTIMER 50028274
TIMERTIMER 51673062
TIMERTIMER 49660660
TIMERTIMER 43643289
TIMERTIMER 44043959
TIMERTIMER 44401042
TIMERTIMER 42618826
TIMERTIMER 44654665
TIMERTIMER 41702538
TIMERTIMER 47547071
TIMERTIMER 48135144
TIMERTIMER 46668429
TIMERTIMER 48436232
TIMERTIMER 43661850
