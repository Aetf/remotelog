SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/peifeng/tools/storm102/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/peifeng/work/run/storm102/data/supervisor/stormdist/captioning-1-1473816352/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /home/peifeng/work/run/storm102/data/workers/c17af068-7eab-4c25-be5a-969cc7470880/tmp/cvld8056213664080312608/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0913 21:26:32.303838 26319 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0913 21:26:32.304013 26319 layer_factory.hpp:77] Creating layer data
I0913 21:26:32.304036 26319 net.cpp:91] Creating Layer data
I0913 21:26:32.304046 26319 net.cpp:399] data -> data
I0913 21:26:32.805654 26319 net.cpp:141] Setting up data
I0913 21:26:32.805800 26319 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0913 21:26:32.805809 26319 net.cpp:156] Memory required for data: 6183480
I0913 21:26:32.805832 26319 layer_factory.hpp:77] Creating layer conv1
I0913 21:26:32.805862 26319 net.cpp:91] Creating Layer conv1
I0913 21:26:32.805871 26319 net.cpp:425] conv1 <- data
I0913 21:26:32.805884 26319 net.cpp:399] conv1 -> conv1
I0913 21:26:32.984910 26319 net.cpp:141] Setting up conv1
I0913 21:26:32.984987 26319 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0913 21:26:32.984998 26319 net.cpp:156] Memory required for data: 17799480
I0913 21:26:32.985051 26319 layer_factory.hpp:77] Creating layer relu1
I0913 21:26:32.985095 26319 net.cpp:91] Creating Layer relu1
I0913 21:26:32.985108 26319 net.cpp:425] relu1 <- conv1
I0913 21:26:32.985123 26319 net.cpp:386] relu1 -> conv1 (in-place)
I0913 21:26:32.985870 26319 net.cpp:141] Setting up relu1
I0913 21:26:32.985898 26319 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0913 21:26:32.985908 26319 net.cpp:156] Memory required for data: 29415480
I0913 21:26:32.985920 26319 layer_factory.hpp:77] Creating layer pool1
I0913 21:26:32.985957 26319 net.cpp:91] Creating Layer pool1
I0913 21:26:32.985970 26319 net.cpp:425] pool1 <- conv1
I0913 21:26:32.985986 26319 net.cpp:399] pool1 -> pool1
I0913 21:26:32.986131 26319 net.cpp:141] Setting up pool1
I0913 21:26:32.986152 26319 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0913 21:26:32.986162 26319 net.cpp:156] Memory required for data: 32214840
I0913 21:26:32.986173 26319 layer_factory.hpp:77] Creating layer norm1
I0913 21:26:32.986214 26319 net.cpp:91] Creating Layer norm1
I0913 21:26:32.986224 26319 net.cpp:425] norm1 <- pool1
I0913 21:26:32.986239 26319 net.cpp:399] norm1 -> norm1
I0913 21:26:32.986753 26319 net.cpp:141] Setting up norm1
I0913 21:26:32.986778 26319 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0913 21:26:32.986786 26319 net.cpp:156] Memory required for data: 35014200
I0913 21:26:32.986796 26319 layer_factory.hpp:77] Creating layer conv2
I0913 21:26:32.986824 26319 net.cpp:91] Creating Layer conv2
I0913 21:26:32.986835 26319 net.cpp:425] conv2 <- norm1
I0913 21:26:32.986850 26319 net.cpp:399] conv2 -> conv2
I0913 21:26:32.996695 26319 net.cpp:141] Setting up conv2
I0913 21:26:32.996740 26319 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0913 21:26:32.996748 26319 net.cpp:156] Memory required for data: 42479160
I0913 21:26:32.996767 26319 layer_factory.hpp:77] Creating layer relu2
I0913 21:26:32.996785 26319 net.cpp:91] Creating Layer relu2
I0913 21:26:32.996793 26319 net.cpp:425] relu2 <- conv2
I0913 21:26:32.996801 26319 net.cpp:386] relu2 -> conv2 (in-place)
I0913 21:26:32.997190 26319 net.cpp:141] Setting up relu2
I0913 21:26:32.997205 26319 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0913 21:26:32.997210 26319 net.cpp:156] Memory required for data: 49944120
I0913 21:26:32.997215 26319 layer_factory.hpp:77] Creating layer pool2
I0913 21:26:32.997226 26319 net.cpp:91] Creating Layer pool2
I0913 21:26:32.997231 26319 net.cpp:425] pool2 <- conv2
I0913 21:26:32.997241 26319 net.cpp:399] pool2 -> pool2
I0913 21:26:32.997294 26319 net.cpp:141] Setting up pool2
I0913 21:26:32.997303 26319 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:26:32.997308 26319 net.cpp:156] Memory required for data: 51674680
I0913 21:26:32.997315 26319 layer_factory.hpp:77] Creating layer norm2
I0913 21:26:32.997328 26319 net.cpp:91] Creating Layer norm2
I0913 21:26:32.997334 26319 net.cpp:425] norm2 <- pool2
I0913 21:26:32.997341 26319 net.cpp:399] norm2 -> norm2
I0913 21:26:32.997575 26319 net.cpp:141] Setting up norm2
I0913 21:26:32.997586 26319 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:26:32.997591 26319 net.cpp:156] Memory required for data: 53405240
I0913 21:26:32.997596 26319 layer_factory.hpp:77] Creating layer conv3
I0913 21:26:32.997609 26319 net.cpp:91] Creating Layer conv3
I0913 21:26:32.997615 26319 net.cpp:425] conv3 <- norm2
I0913 21:26:32.997623 26319 net.cpp:399] conv3 -> conv3
I0913 21:26:33.001020 26319 net.cpp:141] Setting up conv3
I0913 21:26:33.001042 26319 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:26:33.001047 26319 net.cpp:156] Memory required for data: 56001080
I0913 21:26:33.001061 26319 layer_factory.hpp:77] Creating layer relu3
I0913 21:26:33.001071 26319 net.cpp:91] Creating Layer relu3
I0913 21:26:33.001077 26319 net.cpp:425] relu3 <- conv3
I0913 21:26:33.001085 26319 net.cpp:386] relu3 -> conv3 (in-place)
I0913 21:26:33.001286 26319 net.cpp:141] Setting up relu3
I0913 21:26:33.001298 26319 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:26:33.001303 26319 net.cpp:156] Memory required for data: 58596920
I0913 21:26:33.001308 26319 layer_factory.hpp:77] Creating layer conv4
I0913 21:26:33.001320 26319 net.cpp:91] Creating Layer conv4
I0913 21:26:33.001325 26319 net.cpp:425] conv4 <- conv3
I0913 21:26:33.001333 26319 net.cpp:399] conv4 -> conv4
I0913 21:26:33.005106 26319 net.cpp:141] Setting up conv4
I0913 21:26:33.005131 26319 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:26:33.005137 26319 net.cpp:156] Memory required for data: 61192760
I0913 21:26:33.005149 26319 layer_factory.hpp:77] Creating layer relu4
I0913 21:26:33.005159 26319 net.cpp:91] Creating Layer relu4
I0913 21:26:33.005164 26319 net.cpp:425] relu4 <- conv4
I0913 21:26:33.005173 26319 net.cpp:386] relu4 -> conv4 (in-place)
I0913 21:26:33.005551 26319 net.cpp:141] Setting up relu4
I0913 21:26:33.005564 26319 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:26:33.005569 26319 net.cpp:156] Memory required for data: 63788600
I0913 21:26:33.005574 26319 layer_factory.hpp:77] Creating layer conv5
I0913 21:26:33.005587 26319 net.cpp:91] Creating Layer conv5
I0913 21:26:33.005594 26319 net.cpp:425] conv5 <- conv4
I0913 21:26:33.005600 26319 net.cpp:399] conv5 -> conv5
I0913 21:26:33.009176 26319 net.cpp:141] Setting up conv5
I0913 21:26:33.009194 26319 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:26:33.009199 26319 net.cpp:156] Memory required for data: 65519160
I0913 21:26:33.009214 26319 layer_factory.hpp:77] Creating layer relu5
I0913 21:26:33.009230 26319 net.cpp:91] Creating Layer relu5
I0913 21:26:33.009237 26319 net.cpp:425] relu5 <- conv5
I0913 21:26:33.009243 26319 net.cpp:386] relu5 -> conv5 (in-place)
I0913 21:26:33.009647 26319 net.cpp:141] Setting up relu5
I0913 21:26:33.009660 26319 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:26:33.009665 26319 net.cpp:156] Memory required for data: 67249720
I0913 21:26:33.009670 26319 layer_factory.hpp:77] Creating layer pool5
I0913 21:26:33.009680 26319 net.cpp:91] Creating Layer pool5
I0913 21:26:33.009685 26319 net.cpp:425] pool5 <- conv5
I0913 21:26:33.009696 26319 net.cpp:399] pool5 -> pool5
I0913 21:26:33.009757 26319 net.cpp:141] Setting up pool5
I0913 21:26:33.009768 26319 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0913 21:26:33.009773 26319 net.cpp:156] Memory required for data: 67618360
I0913 21:26:33.009778 26319 layer_factory.hpp:77] Creating layer fc6
I0913 21:26:33.009798 26319 net.cpp:91] Creating Layer fc6
I0913 21:26:33.009804 26319 net.cpp:425] fc6 <- pool5
I0913 21:26:33.009810 26319 net.cpp:399] fc6 -> fc6
I0913 21:26:33.077615 26309 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/c17af068-7eab-4c25-be5a-969cc7470880/tmp/cvld8056213664080312608/s2vt.words_to_preds.prototxt
I0913 21:26:33.077680 26309 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0913 21:26:33.077689 26309 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0913 21:26:33.077975 26309 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0913 21:26:33.078081 26309 layer_factory.hpp:77] Creating layer input
I0913 21:26:33.078099 26309 net.cpp:91] Creating Layer input
I0913 21:26:33.078107 26309 net.cpp:399] input -> frames_fc7
I0913 21:26:33.078127 26309 net.cpp:399] input -> cont_sentence
I0913 21:26:33.078138 26309 net.cpp:399] input -> input_sentence
I0913 21:26:33.078148 26309 net.cpp:399] input -> stage_indicator
I0913 21:26:33.078275 26309 net.cpp:141] Setting up input
I0913 21:26:33.078289 26309 net.cpp:148] Top shape: 1 4096 (4096)
I0913 21:26:33.078294 26309 net.cpp:148] Top shape: 1 1 (1)
I0913 21:26:33.078300 26309 net.cpp:148] Top shape: 1 1 (1)
I0913 21:26:33.078306 26309 net.cpp:148] Top shape: 1 1 (1)
I0913 21:26:33.078311 26309 net.cpp:156] Memory required for data: 16396
I0913 21:26:33.078317 26309 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0913 21:26:33.078337 26309 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0913 21:26:33.078344 26309 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0913 21:26:33.078363 26309 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0913 21:26:33.078373 26309 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0913 21:26:33.078425 26309 net.cpp:141] Setting up cont_sentence_input_1_split
I0913 21:26:33.078436 26309 net.cpp:148] Top shape: 1 1 (1)
I0913 21:26:33.078443 26309 net.cpp:148] Top shape: 1 1 (1)
I0913 21:26:33.078447 26309 net.cpp:156] Memory required for data: 16404
I0913 21:26:33.078452 26309 layer_factory.hpp:77] Creating layer embed_encoder
I0913 21:26:33.078466 26309 net.cpp:91] Creating Layer embed_encoder
I0913 21:26:33.078471 26309 net.cpp:425] embed_encoder <- frames_fc7
I0913 21:26:33.078481 26309 net.cpp:399] embed_encoder -> embedded_in_frames
I0913 21:26:33.098263 26309 net.cpp:141] Setting up embed_encoder
I0913 21:26:33.098311 26309 net.cpp:148] Top shape: 1 500 (500)
I0913 21:26:33.098318 26309 net.cpp:156] Memory required for data: 18404
I0913 21:26:33.098341 26309 layer_factory.hpp:77] Creating layer reshape_frames
I0913 21:26:33.098376 26309 net.cpp:91] Creating Layer reshape_frames
I0913 21:26:33.098387 26309 net.cpp:425] reshape_frames <- embedded_in_frames
I0913 21:26:33.098398 26309 net.cpp:399] reshape_frames -> embedded_input_frames
I0913 21:26:33.098459 26309 net.cpp:141] Setting up reshape_frames
I0913 21:26:33.098469 26309 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:26:33.098472 26309 net.cpp:156] Memory required for data: 20404
I0913 21:26:33.098477 26309 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0913 21:26:33.098490 26309 net.cpp:91] Creating Layer reshape_stage_indicator
I0913 21:26:33.098496 26309 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0913 21:26:33.098506 26309 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0913 21:26:33.098547 26309 net.cpp:141] Setting up reshape_stage_indicator
I0913 21:26:33.098557 26309 net.cpp:148] Top shape: 1 1 1 (1)
I0913 21:26:33.098562 26309 net.cpp:156] Memory required for data: 20408
I0913 21:26:33.098567 26309 layer_factory.hpp:77] Creating layer embedding
I0913 21:26:33.098583 26309 net.cpp:91] Creating Layer embedding
I0913 21:26:33.098588 26309 net.cpp:425] embedding <- input_sentence
I0913 21:26:33.098597 26309 net.cpp:399] embedding -> embedded_input_sentence
I0913 21:26:33.138281 26319 net.cpp:141] Setting up fc6
I0913 21:26:33.138336 26319 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:26:33.138342 26319 net.cpp:156] Memory required for data: 67782200
I0913 21:26:33.138360 26319 layer_factory.hpp:77] Creating layer relu6
I0913 21:26:33.138377 26319 net.cpp:91] Creating Layer relu6
I0913 21:26:33.138384 26319 net.cpp:425] relu6 <- fc6
I0913 21:26:33.138392 26319 net.cpp:386] relu6 -> fc6 (in-place)
I0913 21:26:33.138737 26319 net.cpp:141] Setting up relu6
I0913 21:26:33.138751 26319 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:26:33.138756 26319 net.cpp:156] Memory required for data: 67946040
I0913 21:26:33.138761 26319 layer_factory.hpp:77] Creating layer drop6
I0913 21:26:33.138775 26319 net.cpp:91] Creating Layer drop6
I0913 21:26:33.138780 26319 net.cpp:425] drop6 <- fc6
I0913 21:26:33.138787 26319 net.cpp:386] drop6 -> fc6 (in-place)
I0913 21:26:33.138845 26319 net.cpp:141] Setting up drop6
I0913 21:26:33.138854 26319 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:26:33.138859 26319 net.cpp:156] Memory required for data: 68109880
I0913 21:26:33.138864 26319 layer_factory.hpp:77] Creating layer fc7
I0913 21:26:33.138875 26319 net.cpp:91] Creating Layer fc7
I0913 21:26:33.138880 26319 net.cpp:425] fc7 <- fc6
I0913 21:26:33.138891 26319 net.cpp:399] fc7 -> fc7
I0913 21:26:33.193200 26319 net.cpp:141] Setting up fc7
I0913 21:26:33.193269 26319 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:26:33.193275 26319 net.cpp:156] Memory required for data: 68273720
I0913 21:26:33.193294 26319 layer_factory.hpp:77] Creating layer relu7
I0913 21:26:33.193313 26319 net.cpp:91] Creating Layer relu7
I0913 21:26:33.193320 26319 net.cpp:425] relu7 <- fc7
I0913 21:26:33.193330 26319 net.cpp:386] relu7 -> fc7 (in-place)
I0913 21:26:33.194039 26319 net.cpp:141] Setting up relu7
I0913 21:26:33.194056 26319 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:26:33.194061 26319 net.cpp:156] Memory required for data: 68437560
I0913 21:26:33.194066 26319 layer_factory.hpp:77] Creating layer drop7
I0913 21:26:33.194092 26319 net.cpp:91] Creating Layer drop7
I0913 21:26:33.194098 26319 net.cpp:425] drop7 <- fc7
I0913 21:26:33.194105 26319 net.cpp:386] drop7 -> fc7 (in-place)
I0913 21:26:33.194149 26319 net.cpp:141] Setting up drop7
I0913 21:26:33.194157 26319 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:26:33.194162 26319 net.cpp:156] Memory required for data: 68601400
I0913 21:26:33.194167 26319 layer_factory.hpp:77] Creating layer fc8
I0913 21:26:33.194180 26319 net.cpp:91] Creating Layer fc8
I0913 21:26:33.194185 26319 net.cpp:425] fc8 <- fc7
I0913 21:26:33.194192 26319 net.cpp:399] fc8 -> fc8
I0913 21:26:33.205888 26319 net.cpp:141] Setting up fc8
I0913 21:26:33.205938 26319 net.cpp:148] Top shape: 10 1000 (10000)
I0913 21:26:33.205946 26319 net.cpp:156] Memory required for data: 68641400
I0913 21:26:33.205962 26319 layer_factory.hpp:77] Creating layer prob
I0913 21:26:33.205991 26319 net.cpp:91] Creating Layer prob
I0913 21:26:33.205999 26319 net.cpp:425] prob <- fc8
I0913 21:26:33.206009 26319 net.cpp:399] prob -> prob
I0913 21:26:33.206533 26319 net.cpp:141] Setting up prob
I0913 21:26:33.206550 26319 net.cpp:148] Top shape: 10 1000 (10000)
I0913 21:26:33.206557 26319 net.cpp:156] Memory required for data: 68681400
I0913 21:26:33.206562 26319 net.cpp:219] prob does not need backward computation.
I0913 21:26:33.206568 26319 net.cpp:219] fc8 does not need backward computation.
I0913 21:26:33.206571 26319 net.cpp:219] drop7 does not need backward computation.
I0913 21:26:33.206578 26319 net.cpp:219] relu7 does not need backward computation.
I0913 21:26:33.206583 26319 net.cpp:219] fc7 does not need backward computation.
I0913 21:26:33.206588 26319 net.cpp:219] drop6 does not need backward computation.
I0913 21:26:33.206593 26319 net.cpp:219] relu6 does not need backward computation.
I0913 21:26:33.206598 26319 net.cpp:219] fc6 does not need backward computation.
I0913 21:26:33.206603 26319 net.cpp:219] pool5 does not need backward computation.
I0913 21:26:33.206607 26319 net.cpp:219] relu5 does not need backward computation.
I0913 21:26:33.206611 26319 net.cpp:219] conv5 does not need backward computation.
I0913 21:26:33.206616 26319 net.cpp:219] relu4 does not need backward computation.
I0913 21:26:33.206620 26319 net.cpp:219] conv4 does not need backward computation.
I0913 21:26:33.206625 26319 net.cpp:219] relu3 does not need backward computation.
I0913 21:26:33.206634 26319 net.cpp:219] conv3 does not need backward computation.
I0913 21:26:33.206640 26319 net.cpp:219] norm2 does not need backward computation.
I0913 21:26:33.206646 26319 net.cpp:219] pool2 does not need backward computation.
I0913 21:26:33.206652 26319 net.cpp:219] relu2 does not need backward computation.
I0913 21:26:33.206658 26319 net.cpp:219] conv2 does not need backward computation.
I0913 21:26:33.206665 26319 net.cpp:219] norm1 does not need backward computation.
I0913 21:26:33.206670 26319 net.cpp:219] pool1 does not need backward computation.
I0913 21:26:33.206676 26319 net.cpp:219] relu1 does not need backward computation.
I0913 21:26:33.206679 26319 net.cpp:219] conv1 does not need backward computation.
I0913 21:26:33.206684 26319 net.cpp:219] data does not need backward computation.
I0913 21:26:33.206689 26319 net.cpp:261] This network produces output prob
I0913 21:26:33.206715 26319 net.cpp:274] Network initialization done.
I0913 21:26:33.328436 26309 net.cpp:141] Setting up embedding
I0913 21:26:33.328477 26309 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:26:33.328485 26309 net.cpp:156] Memory required for data: 22408
I0913 21:26:33.328500 26309 layer_factory.hpp:77] Creating layer lstm1
I0913 21:26:33.328521 26309 net.cpp:91] Creating Layer lstm1
I0913 21:26:33.328529 26309 net.cpp:425] lstm1 <- embedded_input_frames
I0913 21:26:33.328537 26309 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0913 21:26:33.328548 26309 net.cpp:399] lstm1 -> lstm1
I0913 21:26:33.328573 26309 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0913 21:26:33.328922 26309 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0913 21:26:33.329010 26309 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:26:33.329022 26309 net.cpp:91] Creating Layer lstm1_
I0913 21:26:33.329028 26309 net.cpp:399] lstm1_ -> x
I0913 21:26:33.329041 26309 net.cpp:399] lstm1_ -> cont
I0913 21:26:33.329104 26309 net.cpp:141] Setting up lstm1_
I0913 21:26:33.329114 26309 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:26:33.329121 26309 net.cpp:148] Top shape: 1 1 (1)
I0913 21:26:33.329125 26309 net.cpp:156] Memory required for data: 2004
I0913 21:26:33.329130 26309 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:26:33.329138 26309 net.cpp:91] Creating Layer lstm1_
I0913 21:26:33.329147 26309 net.cpp:399] lstm1_ -> c_0
I0913 21:26:33.329156 26309 net.cpp:399] lstm1_ -> h_0
I0913 21:26:33.329211 26309 net.cpp:141] Setting up lstm1_
I0913 21:26:33.329223 26309 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:26:33.329229 26309 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:26:33.329234 26309 net.cpp:156] Memory required for data: 10004
I0913 21:26:33.329238 26309 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0913 21:26:33.329247 26309 net.cpp:91] Creating Layer lstm1_cont_slice
I0913 21:26:33.329252 26309 net.cpp:425] lstm1_cont_slice <- cont
I0913 21:26:33.329259 26309 net.cpp:399] lstm1_cont_slice -> cont_1
I0913 21:26:33.329295 26309 net.cpp:141] Setting up lstm1_cont_slice
I0913 21:26:33.329305 26309 net.cpp:148] Top shape: 1 1 (1)
I0913 21:26:33.329309 26309 net.cpp:156] Memory required for data: 10008
I0913 21:26:33.329314 26309 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0913 21:26:33.329324 26309 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0913 21:26:33.329329 26309 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0913 21:26:33.329335 26309 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0913 21:26:33.329344 26309 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0913 21:26:33.329391 26309 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0913 21:26:33.329401 26309 net.cpp:148] Top shape: 1 1 (1)
I0913 21:26:33.329406 26309 net.cpp:148] Top shape: 1 1 (1)
I0913 21:26:33.329411 26309 net.cpp:156] Memory required for data: 10016
I0913 21:26:33.329416 26309 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0913 21:26:33.329424 26309 net.cpp:91] Creating Layer lstm1_x_transform
I0913 21:26:33.329429 26309 net.cpp:425] lstm1_x_transform <- x
I0913 21:26:33.329439 26309 net.cpp:399] lstm1_x_transform -> W_xc_x
I0913 21:26:33.348784 26309 net.cpp:141] Setting up lstm1_x_transform
I0913 21:26:33.348855 26309 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:26:33.348863 26309 net.cpp:156] Memory required for data: 26016
I0913 21:26:33.348896 26309 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0913 21:26:33.348920 26309 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0913 21:26:33.348929 26309 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0913 21:26:33.348943 26309 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0913 21:26:33.349009 26309 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0913 21:26:33.349023 26309 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:26:33.349030 26309 net.cpp:156] Memory required for data: 42016
I0913 21:26:33.349037 26309 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0913 21:26:33.349052 26309 net.cpp:91] Creating Layer lstm1_h_conted_0
I0913 21:26:33.349061 26309 net.cpp:425] lstm1_h_conted_0 <- h_0
I0913 21:26:33.349071 26309 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0913 21:26:33.349081 26309 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0913 21:26:33.349222 26309 net.cpp:141] Setting up lstm1_h_conted_0
I0913 21:26:33.349236 26309 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:26:33.349242 26309 net.cpp:156] Memory required for data: 46016
I0913 21:26:33.349249 26309 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0913 21:26:33.349267 26309 net.cpp:91] Creating Layer lstm1_transform_1
I0913 21:26:33.349274 26309 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0913 21:26:33.349287 26309 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0913 21:26:33.390036 26309 net.cpp:141] Setting up lstm1_transform_1
I0913 21:26:33.390102 26309 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:26:33.390110 26309 net.cpp:156] Memory required for data: 62016
I0913 21:26:33.390135 26309 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0913 21:26:33.390158 26309 net.cpp:91] Creating Layer lstm1_gate_input_1
I0913 21:26:33.390167 26309 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0913 21:26:33.390175 26309 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0913 21:26:33.390187 26309 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0913 21:26:33.390247 26309 net.cpp:141] Setting up lstm1_gate_input_1
I0913 21:26:33.390260 26309 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:26:33.390265 26309 net.cpp:156] Memory required for data: 78016
I0913 21:26:33.390271 26309 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0913 21:26:33.390280 26309 net.cpp:91] Creating Layer lstm1_unit_1
I0913 21:26:33.390285 26309 net.cpp:425] lstm1_unit_1 <- c_0
I0913 21:26:33.390291 26309 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0913 21:26:33.390297 26309 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0913 21:26:33.390305 26309 net.cpp:399] lstm1_unit_1 -> c_1
I0913 21:26:33.390312 26309 net.cpp:399] lstm1_unit_1 -> h_1
I0913 21:26:33.390374 26309 net.cpp:141] Setting up lstm1_unit_1
I0913 21:26:33.390383 26309 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:26:33.390389 26309 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:26:33.390394 26309 net.cpp:156] Memory required for data: 86016
I0913 21:26:33.390399 26309 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:26:33.390408 26309 net.cpp:91] Creating Layer lstm1_
I0913 21:26:33.390413 26309 net.cpp:425] lstm1_ <- c_1
I0913 21:26:33.390419 26309 net.cpp:399] lstm1_ -> c_T
I0913 21:26:33.390450 26309 net.cpp:141] Setting up lstm1_
I0913 21:26:33.390458 26309 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:26:33.390462 26309 net.cpp:156] Memory required for data: 90016
I0913 21:26:33.390467 26309 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0913 21:26:33.390493 26309 net.cpp:91] Creating Layer lstm1_h_concat
I0913 21:26:33.390499 26309 net.cpp:425] lstm1_h_concat <- h_1
I0913 21:26:33.390506 26309 net.cpp:399] lstm1_h_concat -> h
I0913 21:26:33.390542 26309 net.cpp:141] Setting up lstm1_h_concat
I0913 21:26:33.390550 26309 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:26:33.390555 26309 net.cpp:156] Memory required for data: 94016
I0913 21:26:33.390560 26309 layer_factory.hpp:77] Creating layer h_pseudoloss
I0913 21:26:33.390578 26309 net.cpp:91] Creating Layer h_pseudoloss
I0913 21:26:33.390583 26309 net.cpp:425] h_pseudoloss <- h
I0913 21:26:33.390591 26309 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0913 21:26:33.390686 26309 net.cpp:141] Setting up h_pseudoloss
I0913 21:26:33.390696 26309 net.cpp:148] Top shape: (1)
I0913 21:26:33.390699 26309 net.cpp:151]     with loss weight 1
I0913 21:26:33.390739 26309 net.cpp:156] Memory required for data: 94020
I0913 21:26:33.390744 26309 net.cpp:217] h_pseudoloss needs backward computation.
I0913 21:26:33.390749 26309 net.cpp:217] lstm1_h_concat needs backward computation.
I0913 21:26:33.390754 26309 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:26:33.390759 26309 net.cpp:217] lstm1_unit_1 needs backward computation.
I0913 21:26:33.390765 26309 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0913 21:26:33.390770 26309 net.cpp:217] lstm1_transform_1 needs backward computation.
I0913 21:26:33.390775 26309 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0913 21:26:33.390780 26309 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0913 21:26:33.390785 26309 net.cpp:217] lstm1_x_transform needs backward computation.
I0913 21:26:33.390790 26309 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0913 21:26:33.390796 26309 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0913 21:26:33.390801 26309 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:26:33.390805 26309 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:26:33.390810 26309 net.cpp:261] This network produces output c_T
I0913 21:26:33.390815 26309 net.cpp:261] This network produces output h_pseudoloss
I0913 21:26:33.390831 26309 net.cpp:274] Network initialization done.
I0913 21:26:33.390890 26309 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0913 21:26:33.390897 26309 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0913 21:26:33.390902 26309 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0913 21:26:33.391016 26309 net.cpp:141] Setting up lstm1
I0913 21:26:33.391028 26309 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:26:33.391033 26309 net.cpp:156] Memory required for data: 26408
I0913 21:26:33.391047 26309 layer_factory.hpp:77] Creating layer concat
I0913 21:26:33.391057 26309 net.cpp:91] Creating Layer concat
I0913 21:26:33.391063 26309 net.cpp:425] concat <- lstm1
I0913 21:26:33.391070 26309 net.cpp:425] concat <- embedded_input_sentence
I0913 21:26:33.391077 26309 net.cpp:425] concat <- reshaped_stage_indicator
I0913 21:26:33.391083 26309 net.cpp:399] concat -> lstm1_video_sequence
I0913 21:26:33.391115 26309 net.cpp:141] Setting up concat
I0913 21:26:33.391124 26309 net.cpp:148] Top shape: 1 1 1501 (1501)
I0913 21:26:33.391129 26309 net.cpp:156] Memory required for data: 32412
I0913 21:26:33.391134 26309 layer_factory.hpp:77] Creating layer lstm2
I0913 21:26:33.391146 26309 net.cpp:91] Creating Layer lstm2
I0913 21:26:33.391151 26309 net.cpp:425] lstm2 <- lstm1_video_sequence
I0913 21:26:33.391157 26309 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0913 21:26:33.391165 26309 net.cpp:399] lstm2 -> lstm2
I0913 21:26:33.391175 26309 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0913 21:26:33.391470 26309 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0913 21:26:33.391566 26309 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:26:33.391577 26309 net.cpp:91] Creating Layer lstm2_
I0913 21:26:33.391584 26309 net.cpp:399] lstm2_ -> x
I0913 21:26:33.391594 26309 net.cpp:399] lstm2_ -> cont
I0913 21:26:33.391649 26309 net.cpp:141] Setting up lstm2_
I0913 21:26:33.391659 26309 net.cpp:148] Top shape: 1 1 1501 (1501)
I0913 21:26:33.391665 26309 net.cpp:148] Top shape: 1 1 (1)
I0913 21:26:33.391670 26309 net.cpp:156] Memory required for data: 6008
I0913 21:26:33.391675 26309 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:26:33.391683 26309 net.cpp:91] Creating Layer lstm2_
I0913 21:26:33.391690 26309 net.cpp:399] lstm2_ -> c_0
I0913 21:26:33.391702 26309 net.cpp:399] lstm2_ -> h_0
I0913 21:26:33.391752 26309 net.cpp:141] Setting up lstm2_
I0913 21:26:33.391762 26309 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:26:33.391767 26309 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:26:33.391772 26309 net.cpp:156] Memory required for data: 14008
I0913 21:26:33.391775 26309 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0913 21:26:33.391789 26309 net.cpp:91] Creating Layer lstm2_cont_slice
I0913 21:26:33.391794 26309 net.cpp:425] lstm2_cont_slice <- cont
I0913 21:26:33.391801 26309 net.cpp:399] lstm2_cont_slice -> cont_1
I0913 21:26:33.391834 26309 net.cpp:141] Setting up lstm2_cont_slice
I0913 21:26:33.391842 26309 net.cpp:148] Top shape: 1 1 (1)
I0913 21:26:33.391846 26309 net.cpp:156] Memory required for data: 14012
I0913 21:26:33.391851 26309 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0913 21:26:33.391858 26309 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0913 21:26:33.391863 26309 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0913 21:26:33.391872 26309 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0913 21:26:33.391881 26309 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0913 21:26:33.391927 26309 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0913 21:26:33.391937 26309 net.cpp:148] Top shape: 1 1 (1)
I0913 21:26:33.391942 26309 net.cpp:148] Top shape: 1 1 (1)
I0913 21:26:33.391947 26309 net.cpp:156] Memory required for data: 14020
I0913 21:26:33.391952 26309 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0913 21:26:33.391963 26309 net.cpp:91] Creating Layer lstm2_x_transform
I0913 21:26:33.391968 26309 net.cpp:425] lstm2_x_transform <- x
I0913 21:26:33.391976 26309 net.cpp:399] lstm2_x_transform -> W_xc_x
I0913 21:26:33.437651 26319 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /home/peifeng/work/run/storm102/data/workers/c17af068-7eab-4c25-be5a-969cc7470880/tmp/cvld8056213664080312608/bvlc_reference_caffenet.caffemodel
I0913 21:26:33.437702 26319 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0913 21:26:33.437708 26319 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0913 21:26:33.437712 26319 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /home/peifeng/work/run/storm102/data/workers/c17af068-7eab-4c25-be5a-969cc7470880/tmp/cvld8056213664080312608/bvlc_reference_caffenet.caffemodel
I0913 21:26:33.455168 26309 net.cpp:141] Setting up lstm2_x_transform
I0913 21:26:33.455229 26309 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:26:33.455238 26309 net.cpp:156] Memory required for data: 30020
I0913 21:26:33.455270 26309 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0913 21:26:33.455297 26309 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0913 21:26:33.455309 26309 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0913 21:26:33.455324 26309 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0913 21:26:33.455399 26309 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0913 21:26:33.455415 26309 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:26:33.455423 26309 net.cpp:156] Memory required for data: 46020
I0913 21:26:33.455431 26309 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0913 21:26:33.455451 26309 net.cpp:91] Creating Layer lstm2_h_conted_0
I0913 21:26:33.455459 26309 net.cpp:425] lstm2_h_conted_0 <- h_0
I0913 21:26:33.455469 26309 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0913 21:26:33.455481 26309 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0913 21:26:33.455623 26309 net.cpp:141] Setting up lstm2_h_conted_0
I0913 21:26:33.455641 26309 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:26:33.455648 26309 net.cpp:156] Memory required for data: 50020
I0913 21:26:33.455667 26309 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0913 21:26:33.455689 26309 net.cpp:91] Creating Layer lstm2_transform_1
I0913 21:26:33.455700 26309 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0913 21:26:33.455713 26309 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0913 21:26:33.496039 26309 net.cpp:141] Setting up lstm2_transform_1
I0913 21:26:33.496104 26309 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:26:33.496114 26309 net.cpp:156] Memory required for data: 66020
I0913 21:26:33.496142 26309 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0913 21:26:33.496176 26309 net.cpp:91] Creating Layer lstm2_gate_input_1
I0913 21:26:33.496188 26309 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0913 21:26:33.496201 26309 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0913 21:26:33.496217 26309 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0913 21:26:33.496282 26309 net.cpp:141] Setting up lstm2_gate_input_1
I0913 21:26:33.496299 26309 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:26:33.496306 26309 net.cpp:156] Memory required for data: 82020
I0913 21:26:33.496315 26309 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0913 21:26:33.496332 26309 net.cpp:91] Creating Layer lstm2_unit_1
I0913 21:26:33.496341 26309 net.cpp:425] lstm2_unit_1 <- c_0
I0913 21:26:33.496352 26309 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0913 21:26:33.496361 26309 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0913 21:26:33.496371 26309 net.cpp:399] lstm2_unit_1 -> c_1
I0913 21:26:33.496384 26309 net.cpp:399] lstm2_unit_1 -> h_1
I0913 21:26:33.496495 26309 net.cpp:141] Setting up lstm2_unit_1
I0913 21:26:33.496511 26309 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:26:33.496520 26309 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:26:33.496528 26309 net.cpp:156] Memory required for data: 90020
I0913 21:26:33.496536 26309 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:26:33.496556 26309 net.cpp:91] Creating Layer lstm2_
I0913 21:26:33.496564 26309 net.cpp:425] lstm2_ <- c_1
I0913 21:26:33.496577 26309 net.cpp:399] lstm2_ -> c_T
I0913 21:26:33.496628 26309 net.cpp:141] Setting up lstm2_
I0913 21:26:33.496644 26309 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:26:33.496651 26309 net.cpp:156] Memory required for data: 94020
I0913 21:26:33.496659 26309 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0913 21:26:33.496675 26309 net.cpp:91] Creating Layer lstm2_h_concat
I0913 21:26:33.496685 26309 net.cpp:425] lstm2_h_concat <- h_1
I0913 21:26:33.496701 26309 net.cpp:399] lstm2_h_concat -> h
I0913 21:26:33.496760 26309 net.cpp:141] Setting up lstm2_h_concat
I0913 21:26:33.496778 26309 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:26:33.496786 26309 net.cpp:156] Memory required for data: 98020
I0913 21:26:33.496796 26309 layer_factory.hpp:77] Creating layer h_pseudoloss
I0913 21:26:33.496812 26309 net.cpp:91] Creating Layer h_pseudoloss
I0913 21:26:33.496824 26309 net.cpp:425] h_pseudoloss <- h
I0913 21:26:33.496837 26309 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0913 21:26:33.496989 26309 net.cpp:141] Setting up h_pseudoloss
I0913 21:26:33.497007 26309 net.cpp:148] Top shape: (1)
I0913 21:26:33.497025 26309 net.cpp:151]     with loss weight 1
I0913 21:26:33.497052 26309 net.cpp:156] Memory required for data: 98024
I0913 21:26:33.497064 26309 net.cpp:217] h_pseudoloss needs backward computation.
I0913 21:26:33.497073 26309 net.cpp:217] lstm2_h_concat needs backward computation.
I0913 21:26:33.497082 26309 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:26:33.497092 26309 net.cpp:217] lstm2_unit_1 needs backward computation.
I0913 21:26:33.497103 26309 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0913 21:26:33.497113 26309 net.cpp:217] lstm2_transform_1 needs backward computation.
I0913 21:26:33.497123 26309 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0913 21:26:33.497133 26309 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0913 21:26:33.497143 26309 net.cpp:217] lstm2_x_transform needs backward computation.
I0913 21:26:33.497153 26309 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0913 21:26:33.497164 26309 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0913 21:26:33.497174 26309 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:26:33.497184 26309 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:26:33.497190 26309 net.cpp:261] This network produces output c_T
I0913 21:26:33.497200 26309 net.cpp:261] This network produces output h_pseudoloss
I0913 21:26:33.497229 26309 net.cpp:274] Network initialization done.
I0913 21:26:33.497313 26309 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0913 21:26:33.497326 26309 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0913 21:26:33.497335 26309 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0913 21:26:33.497508 26309 net.cpp:141] Setting up lstm2
I0913 21:26:33.497529 26309 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:26:33.497539 26309 net.cpp:156] Memory required for data: 36412
I0913 21:26:33.497571 26309 layer_factory.hpp:77] Creating layer predict
I0913 21:26:33.497594 26309 net.cpp:91] Creating Layer predict
I0913 21:26:33.497606 26309 net.cpp:425] predict <- lstm2
I0913 21:26:33.497622 26309 net.cpp:399] predict -> predict
I0913 21:26:33.844064 26319 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0913 21:26:33.900115 26319 net.cpp:752] Ignoring source layer loss
Loading the model + trained: 10389.3ms
Using cv::Size and some other stuff: 0.171ms
I0913 21:26:33.941017 26309 net.cpp:141] Setting up predict
I0913 21:26:33.941068 26309 net.cpp:148] Top shape: 1 1 46168 (46168)
I0913 21:26:33.941076 26309 net.cpp:156] Memory required for data: 221084
I0913 21:26:33.941092 26309 layer_factory.hpp:77] Creating layer probs
I0913 21:26:33.941112 26309 net.cpp:91] Creating Layer probs
I0913 21:26:33.941121 26309 net.cpp:425] probs <- predict
I0913 21:26:33.941131 26309 net.cpp:399] probs -> probs
I0913 21:26:33.942028 26309 net.cpp:141] Setting up probs
I0913 21:26:33.942044 26309 net.cpp:148] Top shape: 1 1 46168 (46168)
I0913 21:26:33.942049 26309 net.cpp:156] Memory required for data: 405756
I0913 21:26:33.942055 26309 net.cpp:219] probs does not need backward computation.
I0913 21:26:33.942060 26309 net.cpp:219] predict does not need backward computation.
I0913 21:26:33.942065 26309 net.cpp:219] lstm2 does not need backward computation.
I0913 21:26:33.942072 26309 net.cpp:219] concat does not need backward computation.
I0913 21:26:33.942078 26309 net.cpp:219] lstm1 does not need backward computation.
I0913 21:26:33.942087 26309 net.cpp:219] embedding does not need backward computation.
I0913 21:26:33.942093 26309 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0913 21:26:33.942100 26309 net.cpp:219] reshape_frames does not need backward computation.
I0913 21:26:33.942104 26309 net.cpp:219] embed_encoder does not need backward computation.
I0913 21:26:33.942111 26309 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0913 21:26:33.942116 26309 net.cpp:219] input does not need backward computation.
I0913 21:26:33.942121 26309 net.cpp:261] This network produces output probs
I0913 21:26:33.942136 26309 net.cpp:274] Network initialization done.
Loading the mean file: 1579.29ms
I0913 21:26:34.332569 26309 net.cpp:752] Ignoring source layer data
I0913 21:26:34.332600 26309 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0913 21:26:34.332607 26309 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0913 21:26:34.414875 26309 net.cpp:752] Ignoring source layer cross_entropy_loss
TIMERTIMER 132660118
TIMERTIMER 71916479
TIMERTIMER 63000157
TIMERTIMER 47973368
TIMERTIMER 47580235
TIMERTIMER 49470137
TIMERTIMER 47969972
TIMERTIMER 49078417
TIMERTIMER 54308428
TIMERTIMER 50998184
TIMERTIMER 43495041
TIMERTIMER 42944183
TIMERTIMER 47835553
TIMERTIMER 49567263
TIMERTIMER 47683514
TIMERTIMER 48340019
TIMERTIMER 47831264
TIMERTIMER 61252944
TIMERTIMER 31261899
TIMERTIMER 32841747
TIMERTIMER 32509954
TIMERTIMER 31252263
TIMERTIMER 31666248
TIMERTIMER 37734252
TIMERTIMER 37736661
TIMERTIMER 31667618
TIMERTIMER 33374336
TIMERTIMER 31672328
TIMERTIMER 37999506
TIMERTIMER 32603292
TIMERTIMER 31580782
TIMERTIMER 38802556
TIMERTIMER 33289312
TIMERTIMER 31629951
TIMERTIMER 37978021
TIMERTIMER 31708813
TIMERTIMER 38195162
TIMERTIMER 31635719
TIMERTIMER 32107892
TIMERTIMER 31689589
TIMERTIMER 31700069
TIMERTIMER 38220018
TIMERTIMER 32062370
TIMERTIMER 36630882
TIMERTIMER 37778419
TIMERTIMER 31661546
TIMERTIMER 32636389
TIMERTIMER 31570902
TIMERTIMER 31675988
TIMERTIMER 31532700
TIMERTIMER 38350889
TIMERTIMER 37793130
TIMERTIMER 33968563
TIMERTIMER 31543492
TIMERTIMER 31606896
TIMERTIMER 31672672
TIMERTIMER 36393900
TIMERTIMER 31706704
TIMERTIMER 32440108
TIMERTIMER 37766722
TIMERTIMER 37916781
TIMERTIMER 31797134
TIMERTIMER 33040601
TIMERTIMER 31742811
TIMERTIMER 37783600
TIMERTIMER 31479414
TIMERTIMER 32720699
TIMERTIMER 32343064
TIMERTIMER 32267998
TIMERTIMER 44082959
TIMERTIMER 31605679
TIMERTIMER 31701559
TIMERTIMER 40055708
#
# A fatal error has been detected by the Java Runtime Environment:
#
#  SIGSEGV (0xb) at pc=0x00007f930aa08ee0, pid=26242, tid=140268064356096
#
# JRE version: Java(TM) SE Runtime Environment (8.0_77-b03) (build 1.8.0_77-b03)
# Java VM: Java HotSpot(TM) 64-Bit Server VM (25.77-b03 mixed mode linux-amd64 compressed oops)
# Problematic frame:
# C  [libc.so.6+0x97ee0]
#
# Failed to write core dump. Core dumps have been disabled. To enable core dumping, try "ulimit -c unlimited" before starting Java again
#
# An error report file with more information is saved as:
# /home/peifeng/work/run/storm102/data/workers/c17af068-7eab-4c25-be5a-969cc7470880/hs_err_pid26242.log
#
# If you would like to submit a bug report, please visit:
#   http://bugreport.java.com/bugreport/crash.jsp
# The crash happened outside the Java Virtual Machine in native code.
# See problematic frame for where to report the bug.
#
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/peifeng/tools/storm102/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/peifeng/work/run/storm102/data/supervisor/stormdist/captioning-1-1473816352/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /home/peifeng/work/run/storm102/data/workers/7e05c4e1-6986-4c27-9585-79818a6ea0f7/tmp/cvld2674790556905324548/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0913 21:27:30.777891 26469 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0913 21:27:30.778103 26469 layer_factory.hpp:77] Creating layer data
I0913 21:27:30.778132 26469 net.cpp:91] Creating Layer data
I0913 21:27:30.778144 26469 net.cpp:399] data -> data
I0913 21:27:31.348934 26469 net.cpp:141] Setting up data
I0913 21:27:31.349045 26469 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0913 21:27:31.349057 26469 net.cpp:156] Memory required for data: 6183480
I0913 21:27:31.349078 26469 layer_factory.hpp:77] Creating layer conv1
I0913 21:27:31.349117 26469 net.cpp:91] Creating Layer conv1
I0913 21:27:31.349126 26469 net.cpp:425] conv1 <- data
I0913 21:27:31.349141 26469 net.cpp:399] conv1 -> conv1
I0913 21:27:31.538511 26459 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/7e05c4e1-6986-4c27-9585-79818a6ea0f7/tmp/cvld2674790556905324548/s2vt.words_to_preds.prototxt
I0913 21:27:31.538558 26459 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0913 21:27:31.538565 26459 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0913 21:27:31.538786 26459 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0913 21:27:31.538872 26459 layer_factory.hpp:77] Creating layer input
I0913 21:27:31.538885 26459 net.cpp:91] Creating Layer input
I0913 21:27:31.538893 26459 net.cpp:399] input -> frames_fc7
I0913 21:27:31.538908 26459 net.cpp:399] input -> cont_sentence
I0913 21:27:31.538918 26459 net.cpp:399] input -> input_sentence
I0913 21:27:31.538928 26459 net.cpp:399] input -> stage_indicator
I0913 21:27:31.544517 26459 net.cpp:141] Setting up input
I0913 21:27:31.544548 26459 net.cpp:148] Top shape: 1 4096 (4096)
I0913 21:27:31.544554 26459 net.cpp:148] Top shape: 1 1 (1)
I0913 21:27:31.544559 26459 net.cpp:148] Top shape: 1 1 (1)
I0913 21:27:31.544564 26459 net.cpp:148] Top shape: 1 1 (1)
I0913 21:27:31.544569 26459 net.cpp:156] Memory required for data: 16396
I0913 21:27:31.544574 26459 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0913 21:27:31.544594 26459 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0913 21:27:31.544598 26459 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0913 21:27:31.544615 26459 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0913 21:27:31.544626 26459 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0913 21:27:31.544703 26459 net.cpp:141] Setting up cont_sentence_input_1_split
I0913 21:27:31.544713 26459 net.cpp:148] Top shape: 1 1 (1)
I0913 21:27:31.544718 26459 net.cpp:148] Top shape: 1 1 (1)
I0913 21:27:31.544723 26459 net.cpp:156] Memory required for data: 16404
I0913 21:27:31.544728 26459 layer_factory.hpp:77] Creating layer embed_encoder
I0913 21:27:31.544744 26459 net.cpp:91] Creating Layer embed_encoder
I0913 21:27:31.544749 26459 net.cpp:425] embed_encoder <- frames_fc7
I0913 21:27:31.544755 26459 net.cpp:399] embed_encoder -> embedded_in_frames
I0913 21:27:31.565155 26469 net.cpp:141] Setting up conv1
I0913 21:27:31.565222 26469 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0913 21:27:31.565233 26469 net.cpp:156] Memory required for data: 17799480
I0913 21:27:31.565284 26469 layer_factory.hpp:77] Creating layer relu1
I0913 21:27:31.565311 26469 net.cpp:91] Creating Layer relu1
I0913 21:27:31.565325 26469 net.cpp:425] relu1 <- conv1
I0913 21:27:31.565338 26469 net.cpp:386] relu1 -> conv1 (in-place)
I0913 21:27:31.566457 26459 net.cpp:141] Setting up embed_encoder
I0913 21:27:31.566486 26459 net.cpp:148] Top shape: 1 500 (500)
I0913 21:27:31.566491 26459 net.cpp:156] Memory required for data: 18404
I0913 21:27:31.566507 26459 layer_factory.hpp:77] Creating layer reshape_frames
I0913 21:27:31.566529 26459 net.cpp:91] Creating Layer reshape_frames
I0913 21:27:31.566536 26459 net.cpp:425] reshape_frames <- embedded_in_frames
I0913 21:27:31.566545 26459 net.cpp:399] reshape_frames -> embedded_input_frames
I0913 21:27:31.566565 26469 net.cpp:141] Setting up relu1
I0913 21:27:31.566583 26469 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0913 21:27:31.566589 26469 net.cpp:156] Memory required for data: 29415480
I0913 21:27:31.566596 26459 net.cpp:141] Setting up reshape_frames
I0913 21:27:31.566596 26469 layer_factory.hpp:77] Creating layer pool1
I0913 21:27:31.566609 26459 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:27:31.566614 26459 net.cpp:156] Memory required for data: 20404
I0913 21:27:31.566618 26459 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0913 21:27:31.566623 26469 net.cpp:91] Creating Layer pool1
I0913 21:27:31.566627 26459 net.cpp:91] Creating Layer reshape_stage_indicator
I0913 21:27:31.566630 26469 net.cpp:425] pool1 <- conv1
I0913 21:27:31.566633 26459 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0913 21:27:31.566642 26469 net.cpp:399] pool1 -> pool1
I0913 21:27:31.566642 26459 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0913 21:27:31.566692 26459 net.cpp:141] Setting up reshape_stage_indicator
I0913 21:27:31.566701 26459 net.cpp:148] Top shape: 1 1 1 (1)
I0913 21:27:31.566705 26459 net.cpp:156] Memory required for data: 20408
I0913 21:27:31.566710 26459 layer_factory.hpp:77] Creating layer embedding
I0913 21:27:31.566720 26459 net.cpp:91] Creating Layer embedding
I0913 21:27:31.566725 26459 net.cpp:425] embedding <- input_sentence
I0913 21:27:31.566731 26459 net.cpp:399] embedding -> embedded_input_sentence
I0913 21:27:31.566761 26469 net.cpp:141] Setting up pool1
I0913 21:27:31.566773 26469 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0913 21:27:31.566779 26469 net.cpp:156] Memory required for data: 32214840
I0913 21:27:31.566793 26469 layer_factory.hpp:77] Creating layer norm1
I0913 21:27:31.566813 26469 net.cpp:91] Creating Layer norm1
I0913 21:27:31.566820 26469 net.cpp:425] norm1 <- pool1
I0913 21:27:31.566828 26469 net.cpp:399] norm1 -> norm1
I0913 21:27:31.605192 26469 net.cpp:141] Setting up norm1
I0913 21:27:31.605257 26469 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0913 21:27:31.605264 26469 net.cpp:156] Memory required for data: 35014200
I0913 21:27:31.605275 26469 layer_factory.hpp:77] Creating layer conv2
I0913 21:27:31.605309 26469 net.cpp:91] Creating Layer conv2
I0913 21:27:31.605316 26469 net.cpp:425] conv2 <- norm1
I0913 21:27:31.605330 26469 net.cpp:399] conv2 -> conv2
I0913 21:27:31.609195 26469 net.cpp:141] Setting up conv2
I0913 21:27:31.609218 26469 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0913 21:27:31.609225 26469 net.cpp:156] Memory required for data: 42479160
I0913 21:27:31.609242 26469 layer_factory.hpp:77] Creating layer relu2
I0913 21:27:31.609258 26469 net.cpp:91] Creating Layer relu2
I0913 21:27:31.609264 26469 net.cpp:425] relu2 <- conv2
I0913 21:27:31.609272 26469 net.cpp:386] relu2 -> conv2 (in-place)
I0913 21:27:31.609710 26469 net.cpp:141] Setting up relu2
I0913 21:27:31.609725 26469 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0913 21:27:31.609731 26469 net.cpp:156] Memory required for data: 49944120
I0913 21:27:31.609736 26469 layer_factory.hpp:77] Creating layer pool2
I0913 21:27:31.609748 26469 net.cpp:91] Creating Layer pool2
I0913 21:27:31.609755 26469 net.cpp:425] pool2 <- conv2
I0913 21:27:31.609764 26469 net.cpp:399] pool2 -> pool2
I0913 21:27:31.609827 26469 net.cpp:141] Setting up pool2
I0913 21:27:31.609839 26469 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:27:31.609844 26469 net.cpp:156] Memory required for data: 51674680
I0913 21:27:31.609849 26469 layer_factory.hpp:77] Creating layer norm2
I0913 21:27:31.609865 26469 net.cpp:91] Creating Layer norm2
I0913 21:27:31.609870 26469 net.cpp:425] norm2 <- pool2
I0913 21:27:31.609881 26469 net.cpp:399] norm2 -> norm2
I0913 21:27:31.610162 26469 net.cpp:141] Setting up norm2
I0913 21:27:31.610175 26469 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:27:31.610180 26469 net.cpp:156] Memory required for data: 53405240
I0913 21:27:31.610185 26469 layer_factory.hpp:77] Creating layer conv3
I0913 21:27:31.610199 26469 net.cpp:91] Creating Layer conv3
I0913 21:27:31.610205 26469 net.cpp:425] conv3 <- norm2
I0913 21:27:31.610216 26469 net.cpp:399] conv3 -> conv3
I0913 21:27:31.614215 26469 net.cpp:141] Setting up conv3
I0913 21:27:31.614243 26469 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:27:31.614249 26469 net.cpp:156] Memory required for data: 56001080
I0913 21:27:31.614264 26469 layer_factory.hpp:77] Creating layer relu3
I0913 21:27:31.614279 26469 net.cpp:91] Creating Layer relu3
I0913 21:27:31.614285 26469 net.cpp:425] relu3 <- conv3
I0913 21:27:31.614292 26469 net.cpp:386] relu3 -> conv3 (in-place)
I0913 21:27:31.614543 26469 net.cpp:141] Setting up relu3
I0913 21:27:31.614555 26469 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:27:31.614560 26469 net.cpp:156] Memory required for data: 58596920
I0913 21:27:31.614567 26469 layer_factory.hpp:77] Creating layer conv4
I0913 21:27:31.614581 26469 net.cpp:91] Creating Layer conv4
I0913 21:27:31.614586 26469 net.cpp:425] conv4 <- conv3
I0913 21:27:31.614594 26469 net.cpp:399] conv4 -> conv4
I0913 21:27:31.620651 26469 net.cpp:141] Setting up conv4
I0913 21:27:31.620688 26469 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:27:31.620695 26469 net.cpp:156] Memory required for data: 61192760
I0913 21:27:31.620709 26469 layer_factory.hpp:77] Creating layer relu4
I0913 21:27:31.620726 26469 net.cpp:91] Creating Layer relu4
I0913 21:27:31.620733 26469 net.cpp:425] relu4 <- conv4
I0913 21:27:31.620743 26469 net.cpp:386] relu4 -> conv4 (in-place)
I0913 21:27:31.621186 26469 net.cpp:141] Setting up relu4
I0913 21:27:31.621201 26469 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:27:31.621206 26469 net.cpp:156] Memory required for data: 63788600
I0913 21:27:31.621212 26469 layer_factory.hpp:77] Creating layer conv5
I0913 21:27:31.621228 26469 net.cpp:91] Creating Layer conv5
I0913 21:27:31.621234 26469 net.cpp:425] conv5 <- conv4
I0913 21:27:31.621245 26469 net.cpp:399] conv5 -> conv5
I0913 21:27:31.625476 26469 net.cpp:141] Setting up conv5
I0913 21:27:31.625510 26469 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:27:31.625522 26469 net.cpp:156] Memory required for data: 65519160
I0913 21:27:31.625550 26469 layer_factory.hpp:77] Creating layer relu5
I0913 21:27:31.625569 26469 net.cpp:91] Creating Layer relu5
I0913 21:27:31.625581 26469 net.cpp:425] relu5 <- conv5
I0913 21:27:31.625602 26469 net.cpp:386] relu5 -> conv5 (in-place)
I0913 21:27:31.626279 26469 net.cpp:141] Setting up relu5
I0913 21:27:31.626302 26469 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:27:31.626313 26469 net.cpp:156] Memory required for data: 67249720
I0913 21:27:31.626324 26469 layer_factory.hpp:77] Creating layer pool5
I0913 21:27:31.626356 26469 net.cpp:91] Creating Layer pool5
I0913 21:27:31.626371 26469 net.cpp:425] pool5 <- conv5
I0913 21:27:31.626387 26469 net.cpp:399] pool5 -> pool5
I0913 21:27:31.626507 26469 net.cpp:141] Setting up pool5
I0913 21:27:31.626528 26469 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0913 21:27:31.626538 26469 net.cpp:156] Memory required for data: 67618360
I0913 21:27:31.626549 26469 layer_factory.hpp:77] Creating layer fc6
I0913 21:27:31.626577 26469 net.cpp:91] Creating Layer fc6
I0913 21:27:31.626590 26469 net.cpp:425] fc6 <- pool5
I0913 21:27:31.626606 26469 net.cpp:399] fc6 -> fc6
I0913 21:27:31.739919 26469 net.cpp:141] Setting up fc6
I0913 21:27:31.739989 26469 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:27:31.740000 26469 net.cpp:156] Memory required for data: 67782200
I0913 21:27:31.740023 26469 layer_factory.hpp:77] Creating layer relu6
I0913 21:27:31.740054 26469 net.cpp:91] Creating Layer relu6
I0913 21:27:31.740068 26469 net.cpp:425] relu6 <- fc6
I0913 21:27:31.740108 26469 net.cpp:386] relu6 -> fc6 (in-place)
I0913 21:27:31.740641 26469 net.cpp:141] Setting up relu6
I0913 21:27:31.740664 26469 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:27:31.740674 26469 net.cpp:156] Memory required for data: 67946040
I0913 21:27:31.740684 26469 layer_factory.hpp:77] Creating layer drop6
I0913 21:27:31.740720 26469 net.cpp:91] Creating Layer drop6
I0913 21:27:31.740733 26469 net.cpp:425] drop6 <- fc6
I0913 21:27:31.740756 26469 net.cpp:386] drop6 -> fc6 (in-place)
I0913 21:27:31.740842 26469 net.cpp:141] Setting up drop6
I0913 21:27:31.740861 26469 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:27:31.740872 26469 net.cpp:156] Memory required for data: 68109880
I0913 21:27:31.740882 26469 layer_factory.hpp:77] Creating layer fc7
I0913 21:27:31.740902 26469 net.cpp:91] Creating Layer fc7
I0913 21:27:31.740914 26469 net.cpp:425] fc7 <- fc6
I0913 21:27:31.740931 26469 net.cpp:399] fc7 -> fc7
I0913 21:27:31.773638 26459 net.cpp:141] Setting up embedding
I0913 21:27:31.773681 26459 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:27:31.773687 26459 net.cpp:156] Memory required for data: 22408
I0913 21:27:31.773701 26459 layer_factory.hpp:77] Creating layer lstm1
I0913 21:27:31.773725 26459 net.cpp:91] Creating Layer lstm1
I0913 21:27:31.773732 26459 net.cpp:425] lstm1 <- embedded_input_frames
I0913 21:27:31.773741 26459 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0913 21:27:31.773752 26459 net.cpp:399] lstm1 -> lstm1
I0913 21:27:31.773777 26459 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0913 21:27:31.774130 26459 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0913 21:27:31.774219 26459 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:27:31.774230 26459 net.cpp:91] Creating Layer lstm1_
I0913 21:27:31.774236 26459 net.cpp:399] lstm1_ -> x
I0913 21:27:31.774247 26459 net.cpp:399] lstm1_ -> cont
I0913 21:27:31.774307 26459 net.cpp:141] Setting up lstm1_
I0913 21:27:31.774329 26459 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:27:31.774335 26459 net.cpp:148] Top shape: 1 1 (1)
I0913 21:27:31.774339 26459 net.cpp:156] Memory required for data: 2004
I0913 21:27:31.774343 26459 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:27:31.774351 26459 net.cpp:91] Creating Layer lstm1_
I0913 21:27:31.774359 26459 net.cpp:399] lstm1_ -> c_0
I0913 21:27:31.774369 26459 net.cpp:399] lstm1_ -> h_0
I0913 21:27:31.774412 26459 net.cpp:141] Setting up lstm1_
I0913 21:27:31.774421 26459 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:27:31.774426 26459 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:27:31.774430 26459 net.cpp:156] Memory required for data: 10004
I0913 21:27:31.774435 26459 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0913 21:27:31.774444 26459 net.cpp:91] Creating Layer lstm1_cont_slice
I0913 21:27:31.774448 26459 net.cpp:425] lstm1_cont_slice <- cont
I0913 21:27:31.774456 26459 net.cpp:399] lstm1_cont_slice -> cont_1
I0913 21:27:31.774487 26459 net.cpp:141] Setting up lstm1_cont_slice
I0913 21:27:31.774494 26459 net.cpp:148] Top shape: 1 1 (1)
I0913 21:27:31.774499 26459 net.cpp:156] Memory required for data: 10008
I0913 21:27:31.774503 26459 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0913 21:27:31.774509 26459 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0913 21:27:31.774513 26459 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0913 21:27:31.774521 26459 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0913 21:27:31.774529 26459 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0913 21:27:31.774569 26459 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0913 21:27:31.774577 26459 net.cpp:148] Top shape: 1 1 (1)
I0913 21:27:31.774582 26459 net.cpp:148] Top shape: 1 1 (1)
I0913 21:27:31.774586 26459 net.cpp:156] Memory required for data: 10016
I0913 21:27:31.774590 26459 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0913 21:27:31.774601 26459 net.cpp:91] Creating Layer lstm1_x_transform
I0913 21:27:31.774605 26459 net.cpp:425] lstm1_x_transform <- x
I0913 21:27:31.774612 26459 net.cpp:399] lstm1_x_transform -> W_xc_x
I0913 21:27:31.793171 26459 net.cpp:141] Setting up lstm1_x_transform
I0913 21:27:31.793205 26459 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:27:31.793210 26459 net.cpp:156] Memory required for data: 26016
I0913 21:27:31.793227 26459 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0913 21:27:31.793243 26459 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0913 21:27:31.793251 26459 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0913 21:27:31.793258 26459 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0913 21:27:31.793297 26459 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0913 21:27:31.793305 26459 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:27:31.793310 26459 net.cpp:156] Memory required for data: 42016
I0913 21:27:31.793314 26459 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0913 21:27:31.793323 26459 net.cpp:91] Creating Layer lstm1_h_conted_0
I0913 21:27:31.793329 26459 net.cpp:425] lstm1_h_conted_0 <- h_0
I0913 21:27:31.793334 26459 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0913 21:27:31.793344 26459 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0913 21:27:31.793476 26459 net.cpp:141] Setting up lstm1_h_conted_0
I0913 21:27:31.793486 26459 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:27:31.793490 26459 net.cpp:156] Memory required for data: 46016
I0913 21:27:31.793495 26459 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0913 21:27:31.793506 26459 net.cpp:91] Creating Layer lstm1_transform_1
I0913 21:27:31.793510 26459 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0913 21:27:31.793520 26459 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0913 21:27:31.801085 26469 net.cpp:141] Setting up fc7
I0913 21:27:31.801148 26469 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:27:31.801162 26469 net.cpp:156] Memory required for data: 68273720
I0913 21:27:31.801190 26469 layer_factory.hpp:77] Creating layer relu7
I0913 21:27:31.801220 26469 net.cpp:91] Creating Layer relu7
I0913 21:27:31.801236 26469 net.cpp:425] relu7 <- fc7
I0913 21:27:31.801259 26469 net.cpp:386] relu7 -> fc7 (in-place)
I0913 21:27:31.802254 26469 net.cpp:141] Setting up relu7
I0913 21:27:31.802278 26469 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:27:31.802289 26469 net.cpp:156] Memory required for data: 68437560
I0913 21:27:31.802300 26469 layer_factory.hpp:77] Creating layer drop7
I0913 21:27:31.802327 26469 net.cpp:91] Creating Layer drop7
I0913 21:27:31.802341 26469 net.cpp:425] drop7 <- fc7
I0913 21:27:31.802357 26469 net.cpp:386] drop7 -> fc7 (in-place)
I0913 21:27:31.802424 26469 net.cpp:141] Setting up drop7
I0913 21:27:31.802444 26469 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:27:31.802454 26469 net.cpp:156] Memory required for data: 68601400
I0913 21:27:31.802464 26469 layer_factory.hpp:77] Creating layer fc8
I0913 21:27:31.802491 26469 net.cpp:91] Creating Layer fc8
I0913 21:27:31.802505 26469 net.cpp:425] fc8 <- fc7
I0913 21:27:31.802525 26469 net.cpp:399] fc8 -> fc8
I0913 21:27:31.818658 26469 net.cpp:141] Setting up fc8
I0913 21:27:31.818717 26469 net.cpp:148] Top shape: 10 1000 (10000)
I0913 21:27:31.818729 26469 net.cpp:156] Memory required for data: 68641400
I0913 21:27:31.818753 26469 layer_factory.hpp:77] Creating layer prob
I0913 21:27:31.818789 26469 net.cpp:91] Creating Layer prob
I0913 21:27:31.818804 26469 net.cpp:425] prob <- fc8
I0913 21:27:31.818820 26469 net.cpp:399] prob -> prob
I0913 21:27:31.819506 26469 net.cpp:141] Setting up prob
I0913 21:27:31.819530 26469 net.cpp:148] Top shape: 10 1000 (10000)
I0913 21:27:31.819540 26469 net.cpp:156] Memory required for data: 68681400
I0913 21:27:31.819550 26469 net.cpp:219] prob does not need backward computation.
I0913 21:27:31.819561 26469 net.cpp:219] fc8 does not need backward computation.
I0913 21:27:31.819571 26469 net.cpp:219] drop7 does not need backward computation.
I0913 21:27:31.819581 26469 net.cpp:219] relu7 does not need backward computation.
I0913 21:27:31.819591 26469 net.cpp:219] fc7 does not need backward computation.
I0913 21:27:31.819600 26469 net.cpp:219] drop6 does not need backward computation.
I0913 21:27:31.819610 26469 net.cpp:219] relu6 does not need backward computation.
I0913 21:27:31.819620 26469 net.cpp:219] fc6 does not need backward computation.
I0913 21:27:31.819631 26469 net.cpp:219] pool5 does not need backward computation.
I0913 21:27:31.819643 26469 net.cpp:219] relu5 does not need backward computation.
I0913 21:27:31.819653 26469 net.cpp:219] conv5 does not need backward computation.
I0913 21:27:31.819663 26469 net.cpp:219] relu4 does not need backward computation.
I0913 21:27:31.819672 26469 net.cpp:219] conv4 does not need backward computation.
I0913 21:27:31.819684 26469 net.cpp:219] relu3 does not need backward computation.
I0913 21:27:31.819694 26469 net.cpp:219] conv3 does not need backward computation.
I0913 21:27:31.819705 26469 net.cpp:219] norm2 does not need backward computation.
I0913 21:27:31.819716 26469 net.cpp:219] pool2 does not need backward computation.
I0913 21:27:31.819733 26469 net.cpp:219] relu2 does not need backward computation.
I0913 21:27:31.819743 26469 net.cpp:219] conv2 does not need backward computation.
I0913 21:27:31.819754 26469 net.cpp:219] norm1 does not need backward computation.
I0913 21:27:31.819766 26469 net.cpp:219] pool1 does not need backward computation.
I0913 21:27:31.819777 26469 net.cpp:219] relu1 does not need backward computation.
I0913 21:27:31.819787 26469 net.cpp:219] conv1 does not need backward computation.
I0913 21:27:31.819798 26469 net.cpp:219] data does not need backward computation.
I0913 21:27:31.819808 26469 net.cpp:261] This network produces output prob
I0913 21:27:31.819850 26469 net.cpp:274] Network initialization done.
I0913 21:27:31.831221 26459 net.cpp:141] Setting up lstm1_transform_1
I0913 21:27:31.831261 26459 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:27:31.831266 26459 net.cpp:156] Memory required for data: 62016
I0913 21:27:31.831284 26459 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0913 21:27:31.831305 26459 net.cpp:91] Creating Layer lstm1_gate_input_1
I0913 21:27:31.831310 26459 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0913 21:27:31.831318 26459 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0913 21:27:31.831326 26459 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0913 21:27:31.831378 26459 net.cpp:141] Setting up lstm1_gate_input_1
I0913 21:27:31.831387 26459 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:27:31.831393 26459 net.cpp:156] Memory required for data: 78016
I0913 21:27:31.831396 26459 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0913 21:27:31.831418 26459 net.cpp:91] Creating Layer lstm1_unit_1
I0913 21:27:31.831423 26459 net.cpp:425] lstm1_unit_1 <- c_0
I0913 21:27:31.831428 26459 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0913 21:27:31.831432 26459 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0913 21:27:31.831440 26459 net.cpp:399] lstm1_unit_1 -> c_1
I0913 21:27:31.831449 26459 net.cpp:399] lstm1_unit_1 -> h_1
I0913 21:27:31.831506 26459 net.cpp:141] Setting up lstm1_unit_1
I0913 21:27:31.831516 26459 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:27:31.831521 26459 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:27:31.831524 26459 net.cpp:156] Memory required for data: 86016
I0913 21:27:31.831528 26459 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:27:31.831537 26459 net.cpp:91] Creating Layer lstm1_
I0913 21:27:31.831540 26459 net.cpp:425] lstm1_ <- c_1
I0913 21:27:31.831547 26459 net.cpp:399] lstm1_ -> c_T
I0913 21:27:31.831576 26459 net.cpp:141] Setting up lstm1_
I0913 21:27:31.831584 26459 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:27:31.831588 26459 net.cpp:156] Memory required for data: 90016
I0913 21:27:31.831593 26459 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0913 21:27:31.831600 26459 net.cpp:91] Creating Layer lstm1_h_concat
I0913 21:27:31.831604 26459 net.cpp:425] lstm1_h_concat <- h_1
I0913 21:27:31.831610 26459 net.cpp:399] lstm1_h_concat -> h
I0913 21:27:31.831643 26459 net.cpp:141] Setting up lstm1_h_concat
I0913 21:27:31.831651 26459 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:27:31.831655 26459 net.cpp:156] Memory required for data: 94016
I0913 21:27:31.831660 26459 layer_factory.hpp:77] Creating layer h_pseudoloss
I0913 21:27:31.831677 26459 net.cpp:91] Creating Layer h_pseudoloss
I0913 21:27:31.831681 26459 net.cpp:425] h_pseudoloss <- h
I0913 21:27:31.831687 26459 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0913 21:27:31.831775 26459 net.cpp:141] Setting up h_pseudoloss
I0913 21:27:31.831785 26459 net.cpp:148] Top shape: (1)
I0913 21:27:31.831789 26459 net.cpp:151]     with loss weight 1
I0913 21:27:31.831823 26459 net.cpp:156] Memory required for data: 94020
I0913 21:27:31.831828 26459 net.cpp:217] h_pseudoloss needs backward computation.
I0913 21:27:31.831832 26459 net.cpp:217] lstm1_h_concat needs backward computation.
I0913 21:27:31.831836 26459 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:27:31.831841 26459 net.cpp:217] lstm1_unit_1 needs backward computation.
I0913 21:27:31.831846 26459 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0913 21:27:31.831851 26459 net.cpp:217] lstm1_transform_1 needs backward computation.
I0913 21:27:31.831856 26459 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0913 21:27:31.831863 26459 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0913 21:27:31.831868 26459 net.cpp:217] lstm1_x_transform needs backward computation.
I0913 21:27:31.831872 26459 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0913 21:27:31.831877 26459 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0913 21:27:31.831882 26459 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:27:31.831887 26459 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:27:31.831889 26459 net.cpp:261] This network produces output c_T
I0913 21:27:31.831894 26459 net.cpp:261] This network produces output h_pseudoloss
I0913 21:27:31.831907 26459 net.cpp:274] Network initialization done.
I0913 21:27:31.831955 26459 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0913 21:27:31.831960 26459 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0913 21:27:31.831964 26459 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0913 21:27:31.832059 26459 net.cpp:141] Setting up lstm1
I0913 21:27:31.832077 26459 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:27:31.832095 26459 net.cpp:156] Memory required for data: 26408
I0913 21:27:31.832108 26459 layer_factory.hpp:77] Creating layer concat
I0913 21:27:31.832116 26459 net.cpp:91] Creating Layer concat
I0913 21:27:31.832123 26459 net.cpp:425] concat <- lstm1
I0913 21:27:31.832129 26459 net.cpp:425] concat <- embedded_input_sentence
I0913 21:27:31.832134 26459 net.cpp:425] concat <- reshaped_stage_indicator
I0913 21:27:31.832140 26459 net.cpp:399] concat -> lstm1_video_sequence
I0913 21:27:31.832173 26459 net.cpp:141] Setting up concat
I0913 21:27:31.832181 26459 net.cpp:148] Top shape: 1 1 1501 (1501)
I0913 21:27:31.832186 26459 net.cpp:156] Memory required for data: 32412
I0913 21:27:31.832191 26459 layer_factory.hpp:77] Creating layer lstm2
I0913 21:27:31.832202 26459 net.cpp:91] Creating Layer lstm2
I0913 21:27:31.832207 26459 net.cpp:425] lstm2 <- lstm1_video_sequence
I0913 21:27:31.832213 26459 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0913 21:27:31.832221 26459 net.cpp:399] lstm2 -> lstm2
I0913 21:27:31.832229 26459 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0913 21:27:31.832468 26459 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0913 21:27:31.832557 26459 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:27:31.832568 26459 net.cpp:91] Creating Layer lstm2_
I0913 21:27:31.832573 26459 net.cpp:399] lstm2_ -> x
I0913 21:27:31.832583 26459 net.cpp:399] lstm2_ -> cont
I0913 21:27:31.832633 26459 net.cpp:141] Setting up lstm2_
I0913 21:27:31.832641 26459 net.cpp:148] Top shape: 1 1 1501 (1501)
I0913 21:27:31.832646 26459 net.cpp:148] Top shape: 1 1 (1)
I0913 21:27:31.832650 26459 net.cpp:156] Memory required for data: 6008
I0913 21:27:31.832654 26459 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:27:31.832662 26459 net.cpp:91] Creating Layer lstm2_
I0913 21:27:31.832670 26459 net.cpp:399] lstm2_ -> c_0
I0913 21:27:31.832679 26459 net.cpp:399] lstm2_ -> h_0
I0913 21:27:31.832723 26459 net.cpp:141] Setting up lstm2_
I0913 21:27:31.832732 26459 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:27:31.832737 26459 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:27:31.832741 26459 net.cpp:156] Memory required for data: 14008
I0913 21:27:31.832746 26459 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0913 21:27:31.832753 26459 net.cpp:91] Creating Layer lstm2_cont_slice
I0913 21:27:31.832757 26459 net.cpp:425] lstm2_cont_slice <- cont
I0913 21:27:31.832763 26459 net.cpp:399] lstm2_cont_slice -> cont_1
I0913 21:27:31.832792 26459 net.cpp:141] Setting up lstm2_cont_slice
I0913 21:27:31.832799 26459 net.cpp:148] Top shape: 1 1 (1)
I0913 21:27:31.832804 26459 net.cpp:156] Memory required for data: 14012
I0913 21:27:31.832809 26459 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0913 21:27:31.832818 26459 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0913 21:27:31.832821 26459 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0913 21:27:31.832828 26459 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0913 21:27:31.832836 26459 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0913 21:27:31.832878 26459 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0913 21:27:31.832885 26459 net.cpp:148] Top shape: 1 1 (1)
I0913 21:27:31.832891 26459 net.cpp:148] Top shape: 1 1 (1)
I0913 21:27:31.832895 26459 net.cpp:156] Memory required for data: 14020
I0913 21:27:31.832900 26459 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0913 21:27:31.832909 26459 net.cpp:91] Creating Layer lstm2_x_transform
I0913 21:27:31.832914 26459 net.cpp:425] lstm2_x_transform <- x
I0913 21:27:31.832921 26459 net.cpp:399] lstm2_x_transform -> W_xc_x
I0913 21:27:31.894063 26459 net.cpp:141] Setting up lstm2_x_transform
I0913 21:27:31.894105 26459 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:27:31.894111 26459 net.cpp:156] Memory required for data: 30020
I0913 21:27:31.894129 26459 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0913 21:27:31.894147 26459 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0913 21:27:31.894155 26459 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0913 21:27:31.894163 26459 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0913 21:27:31.894202 26459 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0913 21:27:31.894212 26459 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:27:31.894215 26459 net.cpp:156] Memory required for data: 46020
I0913 21:27:31.894220 26459 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0913 21:27:31.894232 26459 net.cpp:91] Creating Layer lstm2_h_conted_0
I0913 21:27:31.894237 26459 net.cpp:425] lstm2_h_conted_0 <- h_0
I0913 21:27:31.894243 26459 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0913 21:27:31.894249 26459 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0913 21:27:31.894337 26459 net.cpp:141] Setting up lstm2_h_conted_0
I0913 21:27:31.894346 26459 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:27:31.894351 26459 net.cpp:156] Memory required for data: 50020
I0913 21:27:31.894356 26459 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0913 21:27:31.894366 26459 net.cpp:91] Creating Layer lstm2_transform_1
I0913 21:27:31.894371 26459 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0913 21:27:31.894377 26459 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0913 21:27:31.933012 26459 net.cpp:141] Setting up lstm2_transform_1
I0913 21:27:31.933051 26459 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:27:31.933059 26459 net.cpp:156] Memory required for data: 66020
I0913 21:27:31.933075 26459 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0913 21:27:31.933095 26459 net.cpp:91] Creating Layer lstm2_gate_input_1
I0913 21:27:31.933104 26459 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0913 21:27:31.933110 26459 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0913 21:27:31.933117 26459 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0913 21:27:31.933163 26459 net.cpp:141] Setting up lstm2_gate_input_1
I0913 21:27:31.933171 26459 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:27:31.933176 26459 net.cpp:156] Memory required for data: 82020
I0913 21:27:31.933181 26459 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0913 21:27:31.933188 26459 net.cpp:91] Creating Layer lstm2_unit_1
I0913 21:27:31.933193 26459 net.cpp:425] lstm2_unit_1 <- c_0
I0913 21:27:31.933198 26459 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0913 21:27:31.933203 26459 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0913 21:27:31.933210 26459 net.cpp:399] lstm2_unit_1 -> c_1
I0913 21:27:31.933219 26459 net.cpp:399] lstm2_unit_1 -> h_1
I0913 21:27:31.933279 26459 net.cpp:141] Setting up lstm2_unit_1
I0913 21:27:31.933289 26459 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:27:31.933293 26459 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:27:31.933298 26459 net.cpp:156] Memory required for data: 90020
I0913 21:27:31.933302 26459 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:27:31.933312 26459 net.cpp:91] Creating Layer lstm2_
I0913 21:27:31.933316 26459 net.cpp:425] lstm2_ <- c_1
I0913 21:27:31.933323 26459 net.cpp:399] lstm2_ -> c_T
I0913 21:27:31.933351 26459 net.cpp:141] Setting up lstm2_
I0913 21:27:31.933358 26459 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:27:31.933362 26459 net.cpp:156] Memory required for data: 94020
I0913 21:27:31.933367 26459 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0913 21:27:31.933375 26459 net.cpp:91] Creating Layer lstm2_h_concat
I0913 21:27:31.933380 26459 net.cpp:425] lstm2_h_concat <- h_1
I0913 21:27:31.933389 26459 net.cpp:399] lstm2_h_concat -> h
I0913 21:27:31.933420 26459 net.cpp:141] Setting up lstm2_h_concat
I0913 21:27:31.933429 26459 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:27:31.933432 26459 net.cpp:156] Memory required for data: 98020
I0913 21:27:31.933436 26459 layer_factory.hpp:77] Creating layer h_pseudoloss
I0913 21:27:31.933445 26459 net.cpp:91] Creating Layer h_pseudoloss
I0913 21:27:31.933449 26459 net.cpp:425] h_pseudoloss <- h
I0913 21:27:31.933456 26459 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0913 21:27:31.933542 26459 net.cpp:141] Setting up h_pseudoloss
I0913 21:27:31.933552 26459 net.cpp:148] Top shape: (1)
I0913 21:27:31.933555 26459 net.cpp:151]     with loss weight 1
I0913 21:27:31.933573 26459 net.cpp:156] Memory required for data: 98024
I0913 21:27:31.933578 26459 net.cpp:217] h_pseudoloss needs backward computation.
I0913 21:27:31.933583 26459 net.cpp:217] lstm2_h_concat needs backward computation.
I0913 21:27:31.933586 26459 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:27:31.933590 26459 net.cpp:217] lstm2_unit_1 needs backward computation.
I0913 21:27:31.933596 26459 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0913 21:27:31.933600 26459 net.cpp:217] lstm2_transform_1 needs backward computation.
I0913 21:27:31.933605 26459 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0913 21:27:31.933610 26459 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0913 21:27:31.933615 26459 net.cpp:217] lstm2_x_transform needs backward computation.
I0913 21:27:31.933620 26459 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0913 21:27:31.933627 26459 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0913 21:27:31.933632 26459 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:27:31.933636 26459 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:27:31.933640 26459 net.cpp:261] This network produces output c_T
I0913 21:27:31.933645 26459 net.cpp:261] This network produces output h_pseudoloss
I0913 21:27:31.933658 26459 net.cpp:274] Network initialization done.
I0913 21:27:31.933703 26459 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0913 21:27:31.933709 26459 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0913 21:27:31.933713 26459 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0913 21:27:31.933806 26459 net.cpp:141] Setting up lstm2
I0913 21:27:31.933816 26459 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:27:31.933821 26459 net.cpp:156] Memory required for data: 36412
I0913 21:27:31.933833 26459 layer_factory.hpp:77] Creating layer predict
I0913 21:27:31.933845 26459 net.cpp:91] Creating Layer predict
I0913 21:27:31.933851 26459 net.cpp:425] predict <- lstm2
I0913 21:27:31.933858 26459 net.cpp:399] predict -> predict
I0913 21:27:32.089663 26469 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /home/peifeng/work/run/storm102/data/workers/7e05c4e1-6986-4c27-9585-79818a6ea0f7/tmp/cvld2674790556905324548/bvlc_reference_caffenet.caffemodel
I0913 21:27:32.089701 26469 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0913 21:27:32.089707 26469 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0913 21:27:32.089711 26469 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /home/peifeng/work/run/storm102/data/workers/7e05c4e1-6986-4c27-9585-79818a6ea0f7/tmp/cvld2674790556905324548/bvlc_reference_caffenet.caffemodel
I0913 21:27:32.379559 26459 net.cpp:141] Setting up predict
I0913 21:27:32.379601 26459 net.cpp:148] Top shape: 1 1 46168 (46168)
I0913 21:27:32.379607 26459 net.cpp:156] Memory required for data: 221084
I0913 21:27:32.379622 26459 layer_factory.hpp:77] Creating layer probs
I0913 21:27:32.379637 26459 net.cpp:91] Creating Layer probs
I0913 21:27:32.379643 26459 net.cpp:425] probs <- predict
I0913 21:27:32.379652 26459 net.cpp:399] probs -> probs
I0913 21:27:32.380734 26459 net.cpp:141] Setting up probs
I0913 21:27:32.380751 26459 net.cpp:148] Top shape: 1 1 46168 (46168)
I0913 21:27:32.380756 26459 net.cpp:156] Memory required for data: 405756
I0913 21:27:32.380762 26459 net.cpp:219] probs does not need backward computation.
I0913 21:27:32.380766 26459 net.cpp:219] predict does not need backward computation.
I0913 21:27:32.380771 26459 net.cpp:219] lstm2 does not need backward computation.
I0913 21:27:32.380777 26459 net.cpp:219] concat does not need backward computation.
I0913 21:27:32.380784 26459 net.cpp:219] lstm1 does not need backward computation.
I0913 21:27:32.380789 26459 net.cpp:219] embedding does not need backward computation.
I0913 21:27:32.380794 26459 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0913 21:27:32.380798 26459 net.cpp:219] reshape_frames does not need backward computation.
I0913 21:27:32.380803 26459 net.cpp:219] embed_encoder does not need backward computation.
I0913 21:27:32.380808 26459 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0913 21:27:32.380815 26459 net.cpp:219] input does not need backward computation.
I0913 21:27:32.380817 26459 net.cpp:261] This network produces output probs
I0913 21:27:32.380831 26459 net.cpp:274] Network initialization done.
I0913 21:27:32.508496 26469 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0913 21:27:32.561862 26469 net.cpp:752] Ignoring source layer loss
Loading the model + trained: 12097.2ms
Using cv::Size and some other stuff: 0.136ms
I0913 21:27:32.742508 26459 net.cpp:752] Ignoring source layer data
I0913 21:27:32.742543 26459 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0913 21:27:32.742548 26459 net.cpp:752] Ignoring source layer reshape_stg_indicator
Loading the mean file: 1770.08ms
I0913 21:27:32.834542 26459 net.cpp:752] Ignoring source layer cross_entropy_loss
TIMERTIMER 120223231
TIMERTIMER 65261441
TIMERTIMER 64722562
TIMERTIMER 41054975
TIMERTIMER 44712132
TIMERTIMER 38411324
TIMERTIMER 41571278
TIMERTIMER 43447369
TIMERTIMER 42454355
TIMERTIMER 44010054
TIMERTIMER 42295036
TIMERTIMER 43203208
TIMERTIMER 43710249
TIMERTIMER 49695848
TIMERTIMER 49645036
TIMERTIMER 41870148
TIMERTIMER 43748914
TIMERTIMER 48007624
TIMERTIMER 43061277
TIMERTIMER 37750626
TIMERTIMER 31490177
TIMERTIMER 37510253
TIMERTIMER 31948071
TIMERTIMER 36236488
TIMERTIMER 35603249
TIMERTIMER 31636452
TIMERTIMER 31587825
TIMERTIMER 37801175
TIMERTIMER 31440906
TIMERTIMER 31377638
TIMERTIMER 31732281
TIMERTIMER 37703503
TIMERTIMER 32733653
TIMERTIMER 38019090
TIMERTIMER 31660029
TIMERTIMER 38359507
TIMERTIMER 37669674
TIMERTIMER 31552800
TIMERTIMER 38646008
TIMERTIMER 40074657
TIMERTIMER 35183079
TIMERTIMER 32718443
TIMERTIMER 31832599
TIMERTIMER 31889272
TIMERTIMER 31965272
TIMERTIMER 31986047
TIMERTIMER 31778191
TIMERTIMER 31839600
TIMERTIMER 39273292
TIMERTIMER 33391717
TIMERTIMER 32407202
TIMERTIMER 32049150
TIMERTIMER 32168003
TIMERTIMER 31997172
TIMERTIMER 32154303
TIMERTIMER 38055794
TIMERTIMER 39251994
TIMERTIMER 32688528
TIMERTIMER 38394534
TIMERTIMER 36345331
TIMERTIMER 31888024
TIMERTIMER 38508002
TIMERTIMER 31960743
TIMERTIMER 31941288
TIMERTIMER 32909848
TIMERTIMER 31933222
TIMERTIMER 38957435
TIMERTIMER 31947080
TIMERTIMER 31625163
TIMERTIMER 31716742
TIMERTIMER 32100582
TIMERTIMER 31668642
TIMERTIMER 37485745
TIMERTIMER 38574359
TIMERTIMER 32528238
TIMERTIMER 44249482
TIMERTIMER 31445104
TIMERTIMER 31416693
