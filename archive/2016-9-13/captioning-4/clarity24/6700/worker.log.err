SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/peifeng/tools/storm102/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/peifeng/work/run/storm102/data/supervisor/stormdist/captioning-1-1473815287/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /home/peifeng/work/run/storm102/data/workers/f4c9eef3-fc13-471c-af35-f5488dc9b140/tmp/cvld6247232077880358917/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0913 21:08:47.302068 15917 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0913 21:08:47.302265 15917 layer_factory.hpp:77] Creating layer data
I0913 21:08:47.302292 15917 net.cpp:91] Creating Layer data
I0913 21:08:47.302302 15917 net.cpp:399] data -> data
I0913 21:08:47.880925 15917 net.cpp:141] Setting up data
I0913 21:08:47.881084 15917 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0913 21:08:47.881094 15917 net.cpp:156] Memory required for data: 6183480
I0913 21:08:47.881117 15917 layer_factory.hpp:77] Creating layer conv1
I0913 21:08:47.881153 15917 net.cpp:91] Creating Layer conv1
I0913 21:08:47.881163 15917 net.cpp:425] conv1 <- data
I0913 21:08:47.881177 15917 net.cpp:399] conv1 -> conv1
I0913 21:08:48.076941 15917 net.cpp:141] Setting up conv1
I0913 21:08:48.076988 15917 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0913 21:08:48.076997 15917 net.cpp:156] Memory required for data: 17799480
I0913 21:08:48.077026 15917 layer_factory.hpp:77] Creating layer relu1
I0913 21:08:48.077049 15917 net.cpp:91] Creating Layer relu1
I0913 21:08:48.077057 15917 net.cpp:425] relu1 <- conv1
I0913 21:08:48.077065 15917 net.cpp:386] relu1 -> conv1 (in-place)
I0913 21:08:48.077579 15917 net.cpp:141] Setting up relu1
I0913 21:08:48.077600 15917 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0913 21:08:48.077611 15917 net.cpp:156] Memory required for data: 29415480
I0913 21:08:48.077622 15917 layer_factory.hpp:77] Creating layer pool1
I0913 21:08:48.077651 15917 net.cpp:91] Creating Layer pool1
I0913 21:08:48.077666 15917 net.cpp:425] pool1 <- conv1
I0913 21:08:48.077678 15917 net.cpp:399] pool1 -> pool1
I0913 21:08:48.077769 15917 net.cpp:141] Setting up pool1
I0913 21:08:48.077783 15917 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0913 21:08:48.077788 15917 net.cpp:156] Memory required for data: 32214840
I0913 21:08:48.077795 15917 layer_factory.hpp:77] Creating layer norm1
I0913 21:08:48.077816 15917 net.cpp:91] Creating Layer norm1
I0913 21:08:48.077822 15917 net.cpp:425] norm1 <- pool1
I0913 21:08:48.077829 15917 net.cpp:399] norm1 -> norm1
I0913 21:08:48.078140 15917 net.cpp:141] Setting up norm1
I0913 21:08:48.078155 15917 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0913 21:08:48.078161 15917 net.cpp:156] Memory required for data: 35014200
I0913 21:08:48.078166 15917 layer_factory.hpp:77] Creating layer conv2
I0913 21:08:48.078186 15917 net.cpp:91] Creating Layer conv2
I0913 21:08:48.078192 15917 net.cpp:425] conv2 <- norm1
I0913 21:08:48.078200 15917 net.cpp:399] conv2 -> conv2
I0913 21:08:48.082479 15917 net.cpp:141] Setting up conv2
I0913 21:08:48.082497 15917 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0913 21:08:48.082504 15917 net.cpp:156] Memory required for data: 42479160
I0913 21:08:48.082517 15917 layer_factory.hpp:77] Creating layer relu2
I0913 21:08:48.082527 15917 net.cpp:91] Creating Layer relu2
I0913 21:08:48.082536 15917 net.cpp:425] relu2 <- conv2
I0913 21:08:48.082545 15917 net.cpp:386] relu2 -> conv2 (in-place)
I0913 21:08:48.082978 15917 net.cpp:141] Setting up relu2
I0913 21:08:48.082991 15917 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0913 21:08:48.082999 15917 net.cpp:156] Memory required for data: 49944120
I0913 21:08:48.083005 15917 layer_factory.hpp:77] Creating layer pool2
I0913 21:08:48.083019 15917 net.cpp:91] Creating Layer pool2
I0913 21:08:48.083024 15917 net.cpp:425] pool2 <- conv2
I0913 21:08:48.083032 15917 net.cpp:399] pool2 -> pool2
I0913 21:08:48.083096 15917 net.cpp:141] Setting up pool2
I0913 21:08:48.083106 15917 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:08:48.083112 15917 net.cpp:156] Memory required for data: 51674680
I0913 21:08:48.083117 15917 layer_factory.hpp:77] Creating layer norm2
I0913 21:08:48.083132 15917 net.cpp:91] Creating Layer norm2
I0913 21:08:48.083137 15917 net.cpp:425] norm2 <- pool2
I0913 21:08:48.083144 15917 net.cpp:399] norm2 -> norm2
I0913 21:08:48.083431 15917 net.cpp:141] Setting up norm2
I0913 21:08:48.083443 15917 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:08:48.083449 15917 net.cpp:156] Memory required for data: 53405240
I0913 21:08:48.083454 15917 layer_factory.hpp:77] Creating layer conv3
I0913 21:08:48.083469 15917 net.cpp:91] Creating Layer conv3
I0913 21:08:48.083475 15917 net.cpp:425] conv3 <- norm2
I0913 21:08:48.083483 15917 net.cpp:399] conv3 -> conv3
I0913 21:08:48.087353 15917 net.cpp:141] Setting up conv3
I0913 21:08:48.087375 15917 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:08:48.087381 15917 net.cpp:156] Memory required for data: 56001080
I0913 21:08:48.087399 15917 layer_factory.hpp:77] Creating layer relu3
I0913 21:08:48.087409 15917 net.cpp:91] Creating Layer relu3
I0913 21:08:48.087417 15917 net.cpp:425] relu3 <- conv3
I0913 21:08:48.087425 15917 net.cpp:386] relu3 -> conv3 (in-place)
I0913 21:08:48.087680 15917 net.cpp:141] Setting up relu3
I0913 21:08:48.087693 15917 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:08:48.087698 15917 net.cpp:156] Memory required for data: 58596920
I0913 21:08:48.087704 15917 layer_factory.hpp:77] Creating layer conv4
I0913 21:08:48.087721 15917 net.cpp:91] Creating Layer conv4
I0913 21:08:48.087728 15917 net.cpp:425] conv4 <- conv3
I0913 21:08:48.087738 15917 net.cpp:399] conv4 -> conv4
I0913 21:08:48.092164 15917 net.cpp:141] Setting up conv4
I0913 21:08:48.092188 15917 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:08:48.092195 15917 net.cpp:156] Memory required for data: 61192760
I0913 21:08:48.092206 15917 layer_factory.hpp:77] Creating layer relu4
I0913 21:08:48.092216 15917 net.cpp:91] Creating Layer relu4
I0913 21:08:48.092222 15917 net.cpp:425] relu4 <- conv4
I0913 21:08:48.092233 15917 net.cpp:386] relu4 -> conv4 (in-place)
I0913 21:08:48.092664 15917 net.cpp:141] Setting up relu4
I0913 21:08:48.092679 15917 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:08:48.092684 15917 net.cpp:156] Memory required for data: 63788600
I0913 21:08:48.092690 15917 layer_factory.hpp:77] Creating layer conv5
I0913 21:08:48.092705 15917 net.cpp:91] Creating Layer conv5
I0913 21:08:48.092711 15917 net.cpp:425] conv5 <- conv4
I0913 21:08:48.092720 15917 net.cpp:399] conv5 -> conv5
I0913 21:08:48.096700 15917 net.cpp:141] Setting up conv5
I0913 21:08:48.096720 15917 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:08:48.096726 15917 net.cpp:156] Memory required for data: 65519160
I0913 21:08:48.096745 15917 layer_factory.hpp:77] Creating layer relu5
I0913 21:08:48.096758 15917 net.cpp:91] Creating Layer relu5
I0913 21:08:48.096765 15917 net.cpp:425] relu5 <- conv5
I0913 21:08:48.096771 15917 net.cpp:386] relu5 -> conv5 (in-place)
I0913 21:08:48.097220 15917 net.cpp:141] Setting up relu5
I0913 21:08:48.097234 15917 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:08:48.097240 15917 net.cpp:156] Memory required for data: 67249720
I0913 21:08:48.097246 15917 layer_factory.hpp:77] Creating layer pool5
I0913 21:08:48.097260 15917 net.cpp:91] Creating Layer pool5
I0913 21:08:48.097266 15917 net.cpp:425] pool5 <- conv5
I0913 21:08:48.097277 15917 net.cpp:399] pool5 -> pool5
I0913 21:08:48.097342 15917 net.cpp:141] Setting up pool5
I0913 21:08:48.097355 15917 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0913 21:08:48.097360 15917 net.cpp:156] Memory required for data: 67618360
I0913 21:08:48.097367 15917 layer_factory.hpp:77] Creating layer fc6
I0913 21:08:48.097388 15917 net.cpp:91] Creating Layer fc6
I0913 21:08:48.097394 15917 net.cpp:425] fc6 <- pool5
I0913 21:08:48.097401 15917 net.cpp:399] fc6 -> fc6
I0913 21:08:48.209692 15917 net.cpp:141] Setting up fc6
I0913 21:08:48.209741 15917 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:08:48.209748 15917 net.cpp:156] Memory required for data: 67782200
I0913 21:08:48.209763 15917 layer_factory.hpp:77] Creating layer relu6
I0913 21:08:48.209782 15917 net.cpp:91] Creating Layer relu6
I0913 21:08:48.209789 15917 net.cpp:425] relu6 <- fc6
I0913 21:08:48.209800 15917 net.cpp:386] relu6 -> fc6 (in-place)
I0913 21:08:48.210167 15917 net.cpp:141] Setting up relu6
I0913 21:08:48.210180 15917 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:08:48.210186 15917 net.cpp:156] Memory required for data: 67946040
I0913 21:08:48.210191 15917 layer_factory.hpp:77] Creating layer drop6
I0913 21:08:48.210207 15917 net.cpp:91] Creating Layer drop6
I0913 21:08:48.210213 15917 net.cpp:425] drop6 <- fc6
I0913 21:08:48.210222 15917 net.cpp:386] drop6 -> fc6 (in-place)
I0913 21:08:48.210361 15917 net.cpp:141] Setting up drop6
I0913 21:08:48.210372 15917 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:08:48.210378 15917 net.cpp:156] Memory required for data: 68109880
I0913 21:08:48.210384 15917 layer_factory.hpp:77] Creating layer fc7
I0913 21:08:48.210402 15917 net.cpp:91] Creating Layer fc7
I0913 21:08:48.210407 15917 net.cpp:425] fc7 <- fc6
I0913 21:08:48.210415 15917 net.cpp:399] fc7 -> fc7
I0913 21:08:48.259696 15917 net.cpp:141] Setting up fc7
I0913 21:08:48.259747 15917 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:08:48.259754 15917 net.cpp:156] Memory required for data: 68273720
I0913 21:08:48.259768 15917 layer_factory.hpp:77] Creating layer relu7
I0913 21:08:48.259789 15917 net.cpp:91] Creating Layer relu7
I0913 21:08:48.259798 15917 net.cpp:425] relu7 <- fc7
I0913 21:08:48.259806 15917 net.cpp:386] relu7 -> fc7 (in-place)
I0913 21:08:48.260478 15917 net.cpp:141] Setting up relu7
I0913 21:08:48.260493 15917 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:08:48.260500 15917 net.cpp:156] Memory required for data: 68437560
I0913 21:08:48.260507 15917 layer_factory.hpp:77] Creating layer drop7
I0913 21:08:48.260519 15917 net.cpp:91] Creating Layer drop7
I0913 21:08:48.260524 15917 net.cpp:425] drop7 <- fc7
I0913 21:08:48.260531 15917 net.cpp:386] drop7 -> fc7 (in-place)
I0913 21:08:48.260576 15917 net.cpp:141] Setting up drop7
I0913 21:08:48.260586 15917 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:08:48.260591 15917 net.cpp:156] Memory required for data: 68601400
I0913 21:08:48.260597 15917 layer_factory.hpp:77] Creating layer fc8
I0913 21:08:48.260608 15917 net.cpp:91] Creating Layer fc8
I0913 21:08:48.260613 15917 net.cpp:425] fc8 <- fc7
I0913 21:08:48.260623 15917 net.cpp:399] fc8 -> fc8
I0913 21:08:48.272863 15917 net.cpp:141] Setting up fc8
I0913 21:08:48.272907 15917 net.cpp:148] Top shape: 10 1000 (10000)
I0913 21:08:48.272915 15917 net.cpp:156] Memory required for data: 68641400
I0913 21:08:48.272931 15917 layer_factory.hpp:77] Creating layer prob
I0913 21:08:48.272963 15917 net.cpp:91] Creating Layer prob
I0913 21:08:48.272970 15917 net.cpp:425] prob <- fc8
I0913 21:08:48.273001 15917 net.cpp:399] prob -> prob
I0913 21:08:48.273502 15917 net.cpp:141] Setting up prob
I0913 21:08:48.273516 15917 net.cpp:148] Top shape: 10 1000 (10000)
I0913 21:08:48.273524 15917 net.cpp:156] Memory required for data: 68681400
I0913 21:08:48.273530 15917 net.cpp:219] prob does not need backward computation.
I0913 21:08:48.273536 15917 net.cpp:219] fc8 does not need backward computation.
I0913 21:08:48.273541 15917 net.cpp:219] drop7 does not need backward computation.
I0913 21:08:48.273546 15917 net.cpp:219] relu7 does not need backward computation.
I0913 21:08:48.273551 15917 net.cpp:219] fc7 does not need backward computation.
I0913 21:08:48.273557 15917 net.cpp:219] drop6 does not need backward computation.
I0913 21:08:48.273563 15917 net.cpp:219] relu6 does not need backward computation.
I0913 21:08:48.273569 15917 net.cpp:219] fc6 does not need backward computation.
I0913 21:08:48.273576 15917 net.cpp:219] pool5 does not need backward computation.
I0913 21:08:48.273581 15917 net.cpp:219] relu5 does not need backward computation.
I0913 21:08:48.273586 15917 net.cpp:219] conv5 does not need backward computation.
I0913 21:08:48.273591 15917 net.cpp:219] relu4 does not need backward computation.
I0913 21:08:48.273597 15917 net.cpp:219] conv4 does not need backward computation.
I0913 21:08:48.273602 15917 net.cpp:219] relu3 does not need backward computation.
I0913 21:08:48.273607 15917 net.cpp:219] conv3 does not need backward computation.
I0913 21:08:48.273613 15917 net.cpp:219] norm2 does not need backward computation.
I0913 21:08:48.273618 15917 net.cpp:219] pool2 does not need backward computation.
I0913 21:08:48.273623 15917 net.cpp:219] relu2 does not need backward computation.
I0913 21:08:48.273628 15917 net.cpp:219] conv2 does not need backward computation.
I0913 21:08:48.273634 15917 net.cpp:219] norm1 does not need backward computation.
I0913 21:08:48.273639 15917 net.cpp:219] pool1 does not need backward computation.
I0913 21:08:48.273645 15917 net.cpp:219] relu1 does not need backward computation.
I0913 21:08:48.273650 15917 net.cpp:219] conv1 does not need backward computation.
I0913 21:08:48.273655 15917 net.cpp:219] data does not need backward computation.
I0913 21:08:48.273660 15917 net.cpp:261] This network produces output prob
I0913 21:08:48.273700 15917 net.cpp:274] Network initialization done.
I0913 21:08:48.287235 15907 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/f4c9eef3-fc13-471c-af35-f5488dc9b140/tmp/cvld6247232077880358917/s2vt.words_to_preds.prototxt
I0913 21:08:48.287286 15907 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0913 21:08:48.287295 15907 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0913 21:08:48.287580 15907 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0913 21:08:48.287686 15907 layer_factory.hpp:77] Creating layer input
I0913 21:08:48.287703 15907 net.cpp:91] Creating Layer input
I0913 21:08:48.287711 15907 net.cpp:399] input -> frames_fc7
I0913 21:08:48.287730 15907 net.cpp:399] input -> cont_sentence
I0913 21:08:48.287741 15907 net.cpp:399] input -> input_sentence
I0913 21:08:48.287752 15907 net.cpp:399] input -> stage_indicator
I0913 21:08:48.287878 15907 net.cpp:141] Setting up input
I0913 21:08:48.287891 15907 net.cpp:148] Top shape: 1 4096 (4096)
I0913 21:08:48.287899 15907 net.cpp:148] Top shape: 1 1 (1)
I0913 21:08:48.287904 15907 net.cpp:148] Top shape: 1 1 (1)
I0913 21:08:48.287910 15907 net.cpp:148] Top shape: 1 1 (1)
I0913 21:08:48.287915 15907 net.cpp:156] Memory required for data: 16396
I0913 21:08:48.287921 15907 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0913 21:08:48.287941 15907 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0913 21:08:48.287947 15907 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0913 21:08:48.287964 15907 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0913 21:08:48.287976 15907 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0913 21:08:48.288028 15907 net.cpp:141] Setting up cont_sentence_input_1_split
I0913 21:08:48.288040 15907 net.cpp:148] Top shape: 1 1 (1)
I0913 21:08:48.288048 15907 net.cpp:148] Top shape: 1 1 (1)
I0913 21:08:48.288053 15907 net.cpp:156] Memory required for data: 16404
I0913 21:08:48.288058 15907 layer_factory.hpp:77] Creating layer embed_encoder
I0913 21:08:48.288085 15907 net.cpp:91] Creating Layer embed_encoder
I0913 21:08:48.288094 15907 net.cpp:425] embed_encoder <- frames_fc7
I0913 21:08:48.288105 15907 net.cpp:399] embed_encoder -> embedded_in_frames
I0913 21:08:48.311504 15907 net.cpp:141] Setting up embed_encoder
I0913 21:08:48.311555 15907 net.cpp:148] Top shape: 1 500 (500)
I0913 21:08:48.311561 15907 net.cpp:156] Memory required for data: 18404
I0913 21:08:48.311594 15907 layer_factory.hpp:77] Creating layer reshape_frames
I0913 21:08:48.311626 15907 net.cpp:91] Creating Layer reshape_frames
I0913 21:08:48.311635 15907 net.cpp:425] reshape_frames <- embedded_in_frames
I0913 21:08:48.311646 15907 net.cpp:399] reshape_frames -> embedded_input_frames
I0913 21:08:48.311707 15907 net.cpp:141] Setting up reshape_frames
I0913 21:08:48.311718 15907 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:08:48.311723 15907 net.cpp:156] Memory required for data: 20404
I0913 21:08:48.311729 15907 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0913 21:08:48.311740 15907 net.cpp:91] Creating Layer reshape_stage_indicator
I0913 21:08:48.311746 15907 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0913 21:08:48.311755 15907 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0913 21:08:48.311800 15907 net.cpp:141] Setting up reshape_stage_indicator
I0913 21:08:48.311811 15907 net.cpp:148] Top shape: 1 1 1 (1)
I0913 21:08:48.311816 15907 net.cpp:156] Memory required for data: 20408
I0913 21:08:48.311821 15907 layer_factory.hpp:77] Creating layer embedding
I0913 21:08:48.311835 15907 net.cpp:91] Creating Layer embedding
I0913 21:08:48.311839 15907 net.cpp:425] embedding <- input_sentence
I0913 21:08:48.311848 15907 net.cpp:399] embedding -> embedded_input_sentence
I0913 21:08:48.551744 15907 net.cpp:141] Setting up embedding
I0913 21:08:48.551812 15907 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:08:48.551818 15907 net.cpp:156] Memory required for data: 22408
I0913 21:08:48.551841 15907 layer_factory.hpp:77] Creating layer lstm1
I0913 21:08:48.551914 15907 net.cpp:91] Creating Layer lstm1
I0913 21:08:48.551924 15907 net.cpp:425] lstm1 <- embedded_input_frames
I0913 21:08:48.551934 15907 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0913 21:08:48.551944 15907 net.cpp:399] lstm1 -> lstm1
I0913 21:08:48.551990 15907 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0913 21:08:48.552458 15907 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0913 21:08:48.552552 15907 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:08:48.552566 15907 net.cpp:91] Creating Layer lstm1_
I0913 21:08:48.552572 15907 net.cpp:399] lstm1_ -> x
I0913 21:08:48.552583 15907 net.cpp:399] lstm1_ -> cont
I0913 21:08:48.552647 15907 net.cpp:141] Setting up lstm1_
I0913 21:08:48.552659 15907 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:08:48.552664 15907 net.cpp:148] Top shape: 1 1 (1)
I0913 21:08:48.552669 15907 net.cpp:156] Memory required for data: 2004
I0913 21:08:48.552673 15907 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:08:48.552685 15907 net.cpp:91] Creating Layer lstm1_
I0913 21:08:48.552690 15907 net.cpp:399] lstm1_ -> c_0
I0913 21:08:48.552700 15907 net.cpp:399] lstm1_ -> h_0
I0913 21:08:48.552747 15907 net.cpp:141] Setting up lstm1_
I0913 21:08:48.552757 15907 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:08:48.552762 15907 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:08:48.552767 15907 net.cpp:156] Memory required for data: 10004
I0913 21:08:48.552772 15907 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0913 21:08:48.552779 15907 net.cpp:91] Creating Layer lstm1_cont_slice
I0913 21:08:48.552784 15907 net.cpp:425] lstm1_cont_slice <- cont
I0913 21:08:48.552793 15907 net.cpp:399] lstm1_cont_slice -> cont_1
I0913 21:08:48.552830 15907 net.cpp:141] Setting up lstm1_cont_slice
I0913 21:08:48.552839 15907 net.cpp:148] Top shape: 1 1 (1)
I0913 21:08:48.552845 15907 net.cpp:156] Memory required for data: 10008
I0913 21:08:48.552848 15907 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0913 21:08:48.552857 15907 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0913 21:08:48.552862 15907 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0913 21:08:48.552868 15907 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0913 21:08:48.552876 15907 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0913 21:08:48.552923 15907 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0913 21:08:48.552932 15907 net.cpp:148] Top shape: 1 1 (1)
I0913 21:08:48.552937 15907 net.cpp:148] Top shape: 1 1 (1)
I0913 21:08:48.552942 15907 net.cpp:156] Memory required for data: 10016
I0913 21:08:48.552947 15907 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0913 21:08:48.552958 15907 net.cpp:91] Creating Layer lstm1_x_transform
I0913 21:08:48.552963 15907 net.cpp:425] lstm1_x_transform <- x
I0913 21:08:48.552971 15907 net.cpp:399] lstm1_x_transform -> W_xc_x
I0913 21:08:48.573323 15907 net.cpp:141] Setting up lstm1_x_transform
I0913 21:08:48.573374 15907 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:08:48.573381 15907 net.cpp:156] Memory required for data: 26016
I0913 21:08:48.573405 15907 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0913 21:08:48.573424 15907 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0913 21:08:48.573431 15907 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0913 21:08:48.573443 15907 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0913 21:08:48.573490 15907 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0913 21:08:48.573500 15907 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:08:48.573505 15907 net.cpp:156] Memory required for data: 42016
I0913 21:08:48.573510 15907 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0913 21:08:48.573523 15907 net.cpp:91] Creating Layer lstm1_h_conted_0
I0913 21:08:48.573531 15907 net.cpp:425] lstm1_h_conted_0 <- h_0
I0913 21:08:48.573544 15907 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0913 21:08:48.573554 15907 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0913 21:08:48.573658 15907 net.cpp:141] Setting up lstm1_h_conted_0
I0913 21:08:48.573668 15907 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:08:48.573673 15907 net.cpp:156] Memory required for data: 46016
I0913 21:08:48.573678 15907 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0913 21:08:48.573696 15907 net.cpp:91] Creating Layer lstm1_transform_1
I0913 21:08:48.573701 15907 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0913 21:08:48.573709 15907 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0913 21:08:48.585937 15917 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /home/peifeng/work/run/storm102/data/workers/f4c9eef3-fc13-471c-af35-f5488dc9b140/tmp/cvld6247232077880358917/bvlc_reference_caffenet.caffemodel
I0913 21:08:48.585981 15917 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0913 21:08:48.585988 15917 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0913 21:08:48.585991 15917 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /home/peifeng/work/run/storm102/data/workers/f4c9eef3-fc13-471c-af35-f5488dc9b140/tmp/cvld6247232077880358917/bvlc_reference_caffenet.caffemodel
I0913 21:08:48.612866 15907 net.cpp:141] Setting up lstm1_transform_1
I0913 21:08:48.612916 15907 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:08:48.612923 15907 net.cpp:156] Memory required for data: 62016
I0913 21:08:48.612944 15907 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0913 21:08:48.612970 15907 net.cpp:91] Creating Layer lstm1_gate_input_1
I0913 21:08:48.612978 15907 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0913 21:08:48.612987 15907 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0913 21:08:48.612998 15907 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0913 21:08:48.613055 15907 net.cpp:141] Setting up lstm1_gate_input_1
I0913 21:08:48.613065 15907 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:08:48.613070 15907 net.cpp:156] Memory required for data: 78016
I0913 21:08:48.613075 15907 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0913 21:08:48.613086 15907 net.cpp:91] Creating Layer lstm1_unit_1
I0913 21:08:48.613091 15907 net.cpp:425] lstm1_unit_1 <- c_0
I0913 21:08:48.613097 15907 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0913 21:08:48.613102 15907 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0913 21:08:48.613109 15907 net.cpp:399] lstm1_unit_1 -> c_1
I0913 21:08:48.613117 15907 net.cpp:399] lstm1_unit_1 -> h_1
I0913 21:08:48.613178 15907 net.cpp:141] Setting up lstm1_unit_1
I0913 21:08:48.613188 15907 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:08:48.613193 15907 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:08:48.613198 15907 net.cpp:156] Memory required for data: 86016
I0913 21:08:48.613201 15907 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:08:48.613210 15907 net.cpp:91] Creating Layer lstm1_
I0913 21:08:48.613214 15907 net.cpp:425] lstm1_ <- c_1
I0913 21:08:48.613221 15907 net.cpp:399] lstm1_ -> c_T
I0913 21:08:48.613252 15907 net.cpp:141] Setting up lstm1_
I0913 21:08:48.613261 15907 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:08:48.613265 15907 net.cpp:156] Memory required for data: 90016
I0913 21:08:48.613270 15907 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0913 21:08:48.613281 15907 net.cpp:91] Creating Layer lstm1_h_concat
I0913 21:08:48.613284 15907 net.cpp:425] lstm1_h_concat <- h_1
I0913 21:08:48.613291 15907 net.cpp:399] lstm1_h_concat -> h
I0913 21:08:48.613340 15907 net.cpp:141] Setting up lstm1_h_concat
I0913 21:08:48.613349 15907 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:08:48.613353 15907 net.cpp:156] Memory required for data: 94016
I0913 21:08:48.613358 15907 layer_factory.hpp:77] Creating layer h_pseudoloss
I0913 21:08:48.613374 15907 net.cpp:91] Creating Layer h_pseudoloss
I0913 21:08:48.613379 15907 net.cpp:425] h_pseudoloss <- h
I0913 21:08:48.613386 15907 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0913 21:08:48.613474 15907 net.cpp:141] Setting up h_pseudoloss
I0913 21:08:48.613484 15907 net.cpp:148] Top shape: (1)
I0913 21:08:48.613488 15907 net.cpp:151]     with loss weight 1
I0913 21:08:48.613529 15907 net.cpp:156] Memory required for data: 94020
I0913 21:08:48.613535 15907 net.cpp:217] h_pseudoloss needs backward computation.
I0913 21:08:48.613540 15907 net.cpp:217] lstm1_h_concat needs backward computation.
I0913 21:08:48.613544 15907 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:08:48.613549 15907 net.cpp:217] lstm1_unit_1 needs backward computation.
I0913 21:08:48.613555 15907 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0913 21:08:48.613562 15907 net.cpp:217] lstm1_transform_1 needs backward computation.
I0913 21:08:48.613567 15907 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0913 21:08:48.613574 15907 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0913 21:08:48.613579 15907 net.cpp:217] lstm1_x_transform needs backward computation.
I0913 21:08:48.613584 15907 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0913 21:08:48.613589 15907 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0913 21:08:48.613593 15907 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:08:48.613597 15907 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:08:48.613601 15907 net.cpp:261] This network produces output c_T
I0913 21:08:48.613605 15907 net.cpp:261] This network produces output h_pseudoloss
I0913 21:08:48.613620 15907 net.cpp:274] Network initialization done.
I0913 21:08:48.613677 15907 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0913 21:08:48.613682 15907 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0913 21:08:48.613687 15907 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0913 21:08:48.613798 15907 net.cpp:141] Setting up lstm1
I0913 21:08:48.613811 15907 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:08:48.613816 15907 net.cpp:156] Memory required for data: 26408
I0913 21:08:48.613829 15907 layer_factory.hpp:77] Creating layer concat
I0913 21:08:48.613839 15907 net.cpp:91] Creating Layer concat
I0913 21:08:48.613845 15907 net.cpp:425] concat <- lstm1
I0913 21:08:48.613852 15907 net.cpp:425] concat <- embedded_input_sentence
I0913 21:08:48.613860 15907 net.cpp:425] concat <- reshaped_stage_indicator
I0913 21:08:48.613867 15907 net.cpp:399] concat -> lstm1_video_sequence
I0913 21:08:48.613899 15907 net.cpp:141] Setting up concat
I0913 21:08:48.613908 15907 net.cpp:148] Top shape: 1 1 1501 (1501)
I0913 21:08:48.613911 15907 net.cpp:156] Memory required for data: 32412
I0913 21:08:48.613916 15907 layer_factory.hpp:77] Creating layer lstm2
I0913 21:08:48.613929 15907 net.cpp:91] Creating Layer lstm2
I0913 21:08:48.613934 15907 net.cpp:425] lstm2 <- lstm1_video_sequence
I0913 21:08:48.613940 15907 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0913 21:08:48.613946 15907 net.cpp:399] lstm2 -> lstm2
I0913 21:08:48.613957 15907 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0913 21:08:48.614226 15907 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0913 21:08:48.614313 15907 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:08:48.614326 15907 net.cpp:91] Creating Layer lstm2_
I0913 21:08:48.614331 15907 net.cpp:399] lstm2_ -> x
I0913 21:08:48.614341 15907 net.cpp:399] lstm2_ -> cont
I0913 21:08:48.614393 15907 net.cpp:141] Setting up lstm2_
I0913 21:08:48.614403 15907 net.cpp:148] Top shape: 1 1 1501 (1501)
I0913 21:08:48.614409 15907 net.cpp:148] Top shape: 1 1 (1)
I0913 21:08:48.614413 15907 net.cpp:156] Memory required for data: 6008
I0913 21:08:48.614418 15907 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:08:48.614429 15907 net.cpp:91] Creating Layer lstm2_
I0913 21:08:48.614436 15907 net.cpp:399] lstm2_ -> c_0
I0913 21:08:48.614445 15907 net.cpp:399] lstm2_ -> h_0
I0913 21:08:48.614490 15907 net.cpp:141] Setting up lstm2_
I0913 21:08:48.614500 15907 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:08:48.614504 15907 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:08:48.614508 15907 net.cpp:156] Memory required for data: 14008
I0913 21:08:48.614513 15907 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0913 21:08:48.614521 15907 net.cpp:91] Creating Layer lstm2_cont_slice
I0913 21:08:48.614526 15907 net.cpp:425] lstm2_cont_slice <- cont
I0913 21:08:48.614532 15907 net.cpp:399] lstm2_cont_slice -> cont_1
I0913 21:08:48.614567 15907 net.cpp:141] Setting up lstm2_cont_slice
I0913 21:08:48.614576 15907 net.cpp:148] Top shape: 1 1 (1)
I0913 21:08:48.614581 15907 net.cpp:156] Memory required for data: 14012
I0913 21:08:48.614585 15907 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0913 21:08:48.614593 15907 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0913 21:08:48.614596 15907 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0913 21:08:48.614605 15907 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0913 21:08:48.614614 15907 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0913 21:08:48.614657 15907 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0913 21:08:48.614665 15907 net.cpp:148] Top shape: 1 1 (1)
I0913 21:08:48.614671 15907 net.cpp:148] Top shape: 1 1 (1)
I0913 21:08:48.614675 15907 net.cpp:156] Memory required for data: 14020
I0913 21:08:48.614681 15907 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0913 21:08:48.614691 15907 net.cpp:91] Creating Layer lstm2_x_transform
I0913 21:08:48.614696 15907 net.cpp:425] lstm2_x_transform <- x
I0913 21:08:48.614706 15907 net.cpp:399] lstm2_x_transform -> W_xc_x
I0913 21:08:48.671586 15907 net.cpp:141] Setting up lstm2_x_transform
I0913 21:08:48.671638 15907 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:08:48.671643 15907 net.cpp:156] Memory required for data: 30020
I0913 21:08:48.671667 15907 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0913 21:08:48.671687 15907 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0913 21:08:48.671695 15907 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0913 21:08:48.671705 15907 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0913 21:08:48.671756 15907 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0913 21:08:48.671766 15907 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:08:48.671771 15907 net.cpp:156] Memory required for data: 46020
I0913 21:08:48.671775 15907 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0913 21:08:48.671787 15907 net.cpp:91] Creating Layer lstm2_h_conted_0
I0913 21:08:48.671792 15907 net.cpp:425] lstm2_h_conted_0 <- h_0
I0913 21:08:48.671797 15907 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0913 21:08:48.671804 15907 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0913 21:08:48.671901 15907 net.cpp:141] Setting up lstm2_h_conted_0
I0913 21:08:48.671911 15907 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:08:48.671916 15907 net.cpp:156] Memory required for data: 50020
I0913 21:08:48.671921 15907 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0913 21:08:48.671934 15907 net.cpp:91] Creating Layer lstm2_transform_1
I0913 21:08:48.671939 15907 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0913 21:08:48.671947 15907 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0913 21:08:48.712222 15907 net.cpp:141] Setting up lstm2_transform_1
I0913 21:08:48.712283 15907 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:08:48.712293 15907 net.cpp:156] Memory required for data: 66020
I0913 21:08:48.712322 15907 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0913 21:08:48.712352 15907 net.cpp:91] Creating Layer lstm2_gate_input_1
I0913 21:08:48.712364 15907 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0913 21:08:48.712376 15907 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0913 21:08:48.712394 15907 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0913 21:08:48.712463 15907 net.cpp:141] Setting up lstm2_gate_input_1
I0913 21:08:48.712488 15907 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:08:48.712496 15907 net.cpp:156] Memory required for data: 82020
I0913 21:08:48.712504 15907 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0913 21:08:48.712519 15907 net.cpp:91] Creating Layer lstm2_unit_1
I0913 21:08:48.712527 15907 net.cpp:425] lstm2_unit_1 <- c_0
I0913 21:08:48.712538 15907 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0913 21:08:48.712546 15907 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0913 21:08:48.712558 15907 net.cpp:399] lstm2_unit_1 -> c_1
I0913 21:08:48.712571 15907 net.cpp:399] lstm2_unit_1 -> h_1
I0913 21:08:48.712671 15907 net.cpp:141] Setting up lstm2_unit_1
I0913 21:08:48.712687 15907 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:08:48.712697 15907 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:08:48.712705 15907 net.cpp:156] Memory required for data: 90020
I0913 21:08:48.712714 15907 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:08:48.712728 15907 net.cpp:91] Creating Layer lstm2_
I0913 21:08:48.712736 15907 net.cpp:425] lstm2_ <- c_1
I0913 21:08:48.712749 15907 net.cpp:399] lstm2_ -> c_T
I0913 21:08:48.712800 15907 net.cpp:141] Setting up lstm2_
I0913 21:08:48.712815 15907 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:08:48.712824 15907 net.cpp:156] Memory required for data: 94020
I0913 21:08:48.712833 15907 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0913 21:08:48.712853 15907 net.cpp:91] Creating Layer lstm2_h_concat
I0913 21:08:48.712865 15907 net.cpp:425] lstm2_h_concat <- h_1
I0913 21:08:48.712883 15907 net.cpp:399] lstm2_h_concat -> h
I0913 21:08:48.712941 15907 net.cpp:141] Setting up lstm2_h_concat
I0913 21:08:48.712960 15907 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:08:48.712968 15907 net.cpp:156] Memory required for data: 98020
I0913 21:08:48.712978 15907 layer_factory.hpp:77] Creating layer h_pseudoloss
I0913 21:08:48.712999 15907 net.cpp:91] Creating Layer h_pseudoloss
I0913 21:08:48.713011 15907 net.cpp:425] h_pseudoloss <- h
I0913 21:08:48.713024 15907 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0913 21:08:48.713178 15907 net.cpp:141] Setting up h_pseudoloss
I0913 21:08:48.713196 15907 net.cpp:148] Top shape: (1)
I0913 21:08:48.713205 15907 net.cpp:151]     with loss weight 1
I0913 21:08:48.713237 15907 net.cpp:156] Memory required for data: 98024
I0913 21:08:48.713248 15907 net.cpp:217] h_pseudoloss needs backward computation.
I0913 21:08:48.713258 15907 net.cpp:217] lstm2_h_concat needs backward computation.
I0913 21:08:48.713266 15907 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:08:48.713275 15907 net.cpp:217] lstm2_unit_1 needs backward computation.
I0913 21:08:48.713285 15907 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0913 21:08:48.713296 15907 net.cpp:217] lstm2_transform_1 needs backward computation.
I0913 21:08:48.713306 15907 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0913 21:08:48.713316 15907 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0913 21:08:48.713326 15907 net.cpp:217] lstm2_x_transform needs backward computation.
I0913 21:08:48.713336 15907 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0913 21:08:48.713346 15907 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0913 21:08:48.713356 15907 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:08:48.713366 15907 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:08:48.713372 15907 net.cpp:261] This network produces output c_T
I0913 21:08:48.713382 15907 net.cpp:261] This network produces output h_pseudoloss
I0913 21:08:48.713410 15907 net.cpp:274] Network initialization done.
I0913 21:08:48.713490 15907 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0913 21:08:48.713505 15907 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0913 21:08:48.713513 15907 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0913 21:08:48.713683 15907 net.cpp:141] Setting up lstm2
I0913 21:08:48.713704 15907 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:08:48.713714 15907 net.cpp:156] Memory required for data: 36412
I0913 21:08:48.713737 15907 layer_factory.hpp:77] Creating layer predict
I0913 21:08:48.713757 15907 net.cpp:91] Creating Layer predict
I0913 21:08:48.713768 15907 net.cpp:425] predict <- lstm2
I0913 21:08:48.713781 15907 net.cpp:399] predict -> predict
I0913 21:08:49.051128 15917 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0913 21:08:49.114246 15917 net.cpp:752] Ignoring source layer loss
Loading the model + trained: 12675.4ms
Using cv::Size and some other stuff: 0.428ms
I0913 21:08:49.246104 15907 net.cpp:141] Setting up predict
I0913 21:08:49.246167 15907 net.cpp:148] Top shape: 1 1 46168 (46168)
I0913 21:08:49.246176 15907 net.cpp:156] Memory required for data: 221084
I0913 21:08:49.246193 15907 layer_factory.hpp:77] Creating layer probs
I0913 21:08:49.246217 15907 net.cpp:91] Creating Layer probs
I0913 21:08:49.246225 15907 net.cpp:425] probs <- predict
I0913 21:08:49.246237 15907 net.cpp:399] probs -> probs
I0913 21:08:49.255444 15907 net.cpp:141] Setting up probs
I0913 21:08:49.255511 15907 net.cpp:148] Top shape: 1 1 46168 (46168)
I0913 21:08:49.255520 15907 net.cpp:156] Memory required for data: 405756
I0913 21:08:49.255537 15907 net.cpp:219] probs does not need backward computation.
I0913 21:08:49.255549 15907 net.cpp:219] predict does not need backward computation.
I0913 21:08:49.255560 15907 net.cpp:219] lstm2 does not need backward computation.
I0913 21:08:49.255573 15907 net.cpp:219] concat does not need backward computation.
I0913 21:08:49.255585 15907 net.cpp:219] lstm1 does not need backward computation.
I0913 21:08:49.255597 15907 net.cpp:219] embedding does not need backward computation.
I0913 21:08:49.255607 15907 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0913 21:08:49.255617 15907 net.cpp:219] reshape_frames does not need backward computation.
I0913 21:08:49.255627 15907 net.cpp:219] embed_encoder does not need backward computation.
I0913 21:08:49.255637 15907 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0913 21:08:49.255647 15907 net.cpp:219] input does not need backward computation.
I0913 21:08:49.255656 15907 net.cpp:261] This network produces output probs
I0913 21:08:49.255683 15907 net.cpp:274] Network initialization done.
Loading the mean file: 1767.86ms
I0913 21:08:49.639657 15907 net.cpp:752] Ignoring source layer data
I0913 21:08:49.639693 15907 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0913 21:08:49.639698 15907 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0913 21:08:49.727571 15907 net.cpp:752] Ignoring source layer cross_entropy_loss
TIMERTIMER 131257097
TIMERTIMER 65417295
TIMERTIMER 71500906
TIMERTIMER 49840085
TIMERTIMER 50713914
TIMERTIMER 49414283
TIMERTIMER 50617397
TIMERTIMER 49018314
TIMERTIMER 48649964
TIMERTIMER 51008660
TIMERTIMER 44243393
TIMERTIMER 44125693
TIMERTIMER 49471808
TIMERTIMER 46878142
TIMERTIMER 49540385
TIMERTIMER 46971291
TIMERTIMER 49478336
TIMERTIMER 44590490
TIMERTIMER 36356224
TIMERTIMER 32193066
TIMERTIMER 32011175
TIMERTIMER 37964767
TIMERTIMER 31505487
TIMERTIMER 34342442
TIMERTIMER 37627169
TIMERTIMER 32642652
TIMERTIMER 36192598
TIMERTIMER 37804566
TIMERTIMER 39627254
TIMERTIMER 31884961
TIMERTIMER 31955944
TIMERTIMER 31715742
TIMERTIMER 33188082
TIMERTIMER 31673003
TIMERTIMER 32066773
TIMERTIMER 38348419
TIMERTIMER 38353534
TIMERTIMER 33946215
TIMERTIMER 32666972
TIMERTIMER 33302373
TIMERTIMER 39028273
TIMERTIMER 32102611
TIMERTIMER 32793204
TIMERTIMER 31507490
TIMERTIMER 38889009
TIMERTIMER 33066585
TIMERTIMER 31643821
TIMERTIMER 32010196
TIMERTIMER 37607049
TIMERTIMER 31552308
#
# A fatal error has been detected by the Java Runtime Environment:
#
#  SIGSEGV (0xb) at pc=0x00007fe70ad60ee0, pid=15840, tid=140628978685696
#
# JRE version: Java(TM) SE Runtime Environment (8.0_77-b03) (build 1.8.0_77-b03)
# Java VM: Java HotSpot(TM) 64-Bit Server VM (25.77-b03 mixed mode linux-amd64 compressed oops)
# Problematic frame:
# C  [libc.so.6+0x97ee0]
#
# Failed to write core dump. Core dumps have been disabled. To enable core dumping, try "ulimit -c unlimited" before starting Java again
#
# An error report file with more information is saved as:
# /home/peifeng/work/run/storm102/data/workers/f4c9eef3-fc13-471c-af35-f5488dc9b140/hs_err_pid15840.log
#
# If you would like to submit a bug report, please visit:
#   http://bugreport.java.com/bugreport/crash.jsp
# The crash happened outside the Java Virtual Machine in native code.
# See problematic frame for where to report the bug.
#
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/peifeng/tools/storm102/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/peifeng/work/run/storm102/data/supervisor/stormdist/captioning-1-1473815287/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /home/peifeng/work/run/storm102/data/workers/f7ddf71a-7f45-4ba7-a9f9-29d276bcd388/tmp/cvld2994469667959769379/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0913 21:09:34.082875 16067 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0913 21:09:34.083092 16067 layer_factory.hpp:77] Creating layer data
I0913 21:09:34.083122 16067 net.cpp:91] Creating Layer data
I0913 21:09:34.083133 16067 net.cpp:399] data -> data
I0913 21:09:34.649087 16067 net.cpp:141] Setting up data
I0913 21:09:34.649197 16067 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0913 21:09:34.649204 16067 net.cpp:156] Memory required for data: 6183480
I0913 21:09:34.649224 16067 layer_factory.hpp:77] Creating layer conv1
I0913 21:09:34.649257 16067 net.cpp:91] Creating Layer conv1
I0913 21:09:34.649266 16067 net.cpp:425] conv1 <- data
I0913 21:09:34.649281 16067 net.cpp:399] conv1 -> conv1
I0913 21:09:34.794886 16057 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/f7ddf71a-7f45-4ba7-a9f9-29d276bcd388/tmp/cvld2994469667959769379/s2vt.words_to_preds.prototxt
I0913 21:09:34.794950 16057 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0913 21:09:34.794958 16057 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0913 21:09:34.795240 16057 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0913 21:09:34.795367 16057 layer_factory.hpp:77] Creating layer input
I0913 21:09:34.795389 16057 net.cpp:91] Creating Layer input
I0913 21:09:34.795399 16057 net.cpp:399] input -> frames_fc7
I0913 21:09:34.795428 16057 net.cpp:399] input -> cont_sentence
I0913 21:09:34.795449 16057 net.cpp:399] input -> input_sentence
I0913 21:09:34.795466 16057 net.cpp:399] input -> stage_indicator
I0913 21:09:34.797719 16057 net.cpp:141] Setting up input
I0913 21:09:34.797744 16057 net.cpp:148] Top shape: 1 4096 (4096)
I0913 21:09:34.797750 16057 net.cpp:148] Top shape: 1 1 (1)
I0913 21:09:34.797756 16057 net.cpp:148] Top shape: 1 1 (1)
I0913 21:09:34.797762 16057 net.cpp:148] Top shape: 1 1 (1)
I0913 21:09:34.797766 16057 net.cpp:156] Memory required for data: 16396
I0913 21:09:34.797775 16057 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0913 21:09:34.797807 16057 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0913 21:09:34.797821 16057 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0913 21:09:34.797855 16057 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0913 21:09:34.797874 16057 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0913 21:09:34.798828 16057 net.cpp:141] Setting up cont_sentence_input_1_split
I0913 21:09:34.798848 16057 net.cpp:148] Top shape: 1 1 (1)
I0913 21:09:34.798861 16057 net.cpp:148] Top shape: 1 1 (1)
I0913 21:09:34.798868 16057 net.cpp:156] Memory required for data: 16404
I0913 21:09:34.798877 16057 layer_factory.hpp:77] Creating layer embed_encoder
I0913 21:09:34.798907 16057 net.cpp:91] Creating Layer embed_encoder
I0913 21:09:34.798918 16057 net.cpp:425] embed_encoder <- frames_fc7
I0913 21:09:34.798935 16057 net.cpp:399] embed_encoder -> embedded_in_frames
I0913 21:09:34.824971 16057 net.cpp:141] Setting up embed_encoder
I0913 21:09:34.825022 16057 net.cpp:148] Top shape: 1 500 (500)
I0913 21:09:34.825028 16057 net.cpp:156] Memory required for data: 18404
I0913 21:09:34.825057 16057 layer_factory.hpp:77] Creating layer reshape_frames
I0913 21:09:34.825091 16057 net.cpp:91] Creating Layer reshape_frames
I0913 21:09:34.825100 16057 net.cpp:425] reshape_frames <- embedded_in_frames
I0913 21:09:34.825112 16057 net.cpp:399] reshape_frames -> embedded_input_frames
I0913 21:09:34.825232 16057 net.cpp:141] Setting up reshape_frames
I0913 21:09:34.825242 16057 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:09:34.825247 16057 net.cpp:156] Memory required for data: 20404
I0913 21:09:34.825250 16057 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0913 21:09:34.825261 16057 net.cpp:91] Creating Layer reshape_stage_indicator
I0913 21:09:34.825268 16057 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0913 21:09:34.825275 16057 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0913 21:09:34.826347 16057 net.cpp:141] Setting up reshape_stage_indicator
I0913 21:09:34.826364 16057 net.cpp:148] Top shape: 1 1 1 (1)
I0913 21:09:34.826370 16057 net.cpp:156] Memory required for data: 20408
I0913 21:09:34.826375 16057 layer_factory.hpp:77] Creating layer embedding
I0913 21:09:34.826390 16057 net.cpp:91] Creating Layer embedding
I0913 21:09:34.826395 16057 net.cpp:425] embedding <- input_sentence
I0913 21:09:34.826403 16057 net.cpp:399] embedding -> embedded_input_sentence
I0913 21:09:34.900743 16067 net.cpp:141] Setting up conv1
I0913 21:09:34.900807 16067 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0913 21:09:34.900816 16067 net.cpp:156] Memory required for data: 17799480
I0913 21:09:34.900841 16067 layer_factory.hpp:77] Creating layer relu1
I0913 21:09:34.900862 16067 net.cpp:91] Creating Layer relu1
I0913 21:09:34.900869 16067 net.cpp:425] relu1 <- conv1
I0913 21:09:34.900877 16067 net.cpp:386] relu1 -> conv1 (in-place)
I0913 21:09:34.901280 16067 net.cpp:141] Setting up relu1
I0913 21:09:34.901294 16067 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0913 21:09:34.901299 16067 net.cpp:156] Memory required for data: 29415480
I0913 21:09:34.901304 16067 layer_factory.hpp:77] Creating layer pool1
I0913 21:09:34.901317 16067 net.cpp:91] Creating Layer pool1
I0913 21:09:34.901324 16067 net.cpp:425] pool1 <- conv1
I0913 21:09:34.901331 16067 net.cpp:399] pool1 -> pool1
I0913 21:09:34.901398 16067 net.cpp:141] Setting up pool1
I0913 21:09:34.901408 16067 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0913 21:09:34.901413 16067 net.cpp:156] Memory required for data: 32214840
I0913 21:09:34.901417 16067 layer_factory.hpp:77] Creating layer norm1
I0913 21:09:34.901435 16067 net.cpp:91] Creating Layer norm1
I0913 21:09:34.901440 16067 net.cpp:425] norm1 <- pool1
I0913 21:09:34.901446 16067 net.cpp:399] norm1 -> norm1
I0913 21:09:34.901692 16067 net.cpp:141] Setting up norm1
I0913 21:09:34.901705 16067 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0913 21:09:34.901710 16067 net.cpp:156] Memory required for data: 35014200
I0913 21:09:34.901715 16067 layer_factory.hpp:77] Creating layer conv2
I0913 21:09:34.901731 16067 net.cpp:91] Creating Layer conv2
I0913 21:09:34.901736 16067 net.cpp:425] conv2 <- norm1
I0913 21:09:34.901743 16067 net.cpp:399] conv2 -> conv2
I0913 21:09:34.904840 16067 net.cpp:141] Setting up conv2
I0913 21:09:34.904873 16067 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0913 21:09:34.904880 16067 net.cpp:156] Memory required for data: 42479160
I0913 21:09:34.904892 16067 layer_factory.hpp:77] Creating layer relu2
I0913 21:09:34.904901 16067 net.cpp:91] Creating Layer relu2
I0913 21:09:34.904907 16067 net.cpp:425] relu2 <- conv2
I0913 21:09:34.904914 16067 net.cpp:386] relu2 -> conv2 (in-place)
I0913 21:09:34.905297 16067 net.cpp:141] Setting up relu2
I0913 21:09:34.905310 16067 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0913 21:09:34.905315 16067 net.cpp:156] Memory required for data: 49944120
I0913 21:09:34.905320 16067 layer_factory.hpp:77] Creating layer pool2
I0913 21:09:34.905329 16067 net.cpp:91] Creating Layer pool2
I0913 21:09:34.905334 16067 net.cpp:425] pool2 <- conv2
I0913 21:09:34.905342 16067 net.cpp:399] pool2 -> pool2
I0913 21:09:34.905392 16067 net.cpp:141] Setting up pool2
I0913 21:09:34.905401 16067 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:09:34.905405 16067 net.cpp:156] Memory required for data: 51674680
I0913 21:09:34.905411 16067 layer_factory.hpp:77] Creating layer norm2
I0913 21:09:34.905421 16067 net.cpp:91] Creating Layer norm2
I0913 21:09:34.905426 16067 net.cpp:425] norm2 <- pool2
I0913 21:09:34.905432 16067 net.cpp:399] norm2 -> norm2
I0913 21:09:34.905669 16067 net.cpp:141] Setting up norm2
I0913 21:09:34.905681 16067 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:09:34.905686 16067 net.cpp:156] Memory required for data: 53405240
I0913 21:09:34.905691 16067 layer_factory.hpp:77] Creating layer conv3
I0913 21:09:34.905702 16067 net.cpp:91] Creating Layer conv3
I0913 21:09:34.905707 16067 net.cpp:425] conv3 <- norm2
I0913 21:09:34.905715 16067 net.cpp:399] conv3 -> conv3
I0913 21:09:34.909257 16067 net.cpp:141] Setting up conv3
I0913 21:09:34.909291 16067 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:09:34.909297 16067 net.cpp:156] Memory required for data: 56001080
I0913 21:09:34.909312 16067 layer_factory.hpp:77] Creating layer relu3
I0913 21:09:34.909320 16067 net.cpp:91] Creating Layer relu3
I0913 21:09:34.909325 16067 net.cpp:425] relu3 <- conv3
I0913 21:09:34.909333 16067 net.cpp:386] relu3 -> conv3 (in-place)
I0913 21:09:34.909550 16067 net.cpp:141] Setting up relu3
I0913 21:09:34.909561 16067 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:09:34.909569 16067 net.cpp:156] Memory required for data: 58596920
I0913 21:09:34.909574 16067 layer_factory.hpp:77] Creating layer conv4
I0913 21:09:34.909584 16067 net.cpp:91] Creating Layer conv4
I0913 21:09:34.909589 16067 net.cpp:425] conv4 <- conv3
I0913 21:09:34.909598 16067 net.cpp:399] conv4 -> conv4
I0913 21:09:34.913733 16067 net.cpp:141] Setting up conv4
I0913 21:09:34.913771 16067 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:09:34.913777 16067 net.cpp:156] Memory required for data: 61192760
I0913 21:09:34.913789 16067 layer_factory.hpp:77] Creating layer relu4
I0913 21:09:34.913802 16067 net.cpp:91] Creating Layer relu4
I0913 21:09:34.913808 16067 net.cpp:425] relu4 <- conv4
I0913 21:09:34.913815 16067 net.cpp:386] relu4 -> conv4 (in-place)
I0913 21:09:34.914223 16067 net.cpp:141] Setting up relu4
I0913 21:09:34.914237 16067 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:09:34.914240 16067 net.cpp:156] Memory required for data: 63788600
I0913 21:09:34.914245 16067 layer_factory.hpp:77] Creating layer conv5
I0913 21:09:34.914261 16067 net.cpp:91] Creating Layer conv5
I0913 21:09:34.914266 16067 net.cpp:425] conv5 <- conv4
I0913 21:09:34.914274 16067 net.cpp:399] conv5 -> conv5
I0913 21:09:34.918092 16067 net.cpp:141] Setting up conv5
I0913 21:09:34.918109 16067 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:09:34.918115 16067 net.cpp:156] Memory required for data: 65519160
I0913 21:09:34.918133 16067 layer_factory.hpp:77] Creating layer relu5
I0913 21:09:34.918141 16067 net.cpp:91] Creating Layer relu5
I0913 21:09:34.918146 16067 net.cpp:425] relu5 <- conv5
I0913 21:09:34.918153 16067 net.cpp:386] relu5 -> conv5 (in-place)
I0913 21:09:34.918556 16067 net.cpp:141] Setting up relu5
I0913 21:09:34.918570 16067 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:09:34.918573 16067 net.cpp:156] Memory required for data: 67249720
I0913 21:09:34.918578 16067 layer_factory.hpp:77] Creating layer pool5
I0913 21:09:34.918589 16067 net.cpp:91] Creating Layer pool5
I0913 21:09:34.918594 16067 net.cpp:425] pool5 <- conv5
I0913 21:09:34.918604 16067 net.cpp:399] pool5 -> pool5
I0913 21:09:34.918663 16067 net.cpp:141] Setting up pool5
I0913 21:09:34.918671 16067 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0913 21:09:34.918675 16067 net.cpp:156] Memory required for data: 67618360
I0913 21:09:34.918680 16067 layer_factory.hpp:77] Creating layer fc6
I0913 21:09:34.918697 16067 net.cpp:91] Creating Layer fc6
I0913 21:09:34.918702 16067 net.cpp:425] fc6 <- pool5
I0913 21:09:34.918709 16067 net.cpp:399] fc6 -> fc6
I0913 21:09:35.023219 16067 net.cpp:141] Setting up fc6
I0913 21:09:35.023280 16067 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:09:35.023286 16067 net.cpp:156] Memory required for data: 67782200
I0913 21:09:35.023301 16067 layer_factory.hpp:77] Creating layer relu6
I0913 21:09:35.023319 16067 net.cpp:91] Creating Layer relu6
I0913 21:09:35.023325 16067 net.cpp:425] relu6 <- fc6
I0913 21:09:35.023339 16067 net.cpp:386] relu6 -> fc6 (in-place)
I0913 21:09:35.023658 16067 net.cpp:141] Setting up relu6
I0913 21:09:35.023671 16067 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:09:35.023676 16067 net.cpp:156] Memory required for data: 67946040
I0913 21:09:35.023681 16067 layer_factory.hpp:77] Creating layer drop6
I0913 21:09:35.023691 16067 net.cpp:91] Creating Layer drop6
I0913 21:09:35.023695 16067 net.cpp:425] drop6 <- fc6
I0913 21:09:35.023702 16067 net.cpp:386] drop6 -> fc6 (in-place)
I0913 21:09:35.023753 16067 net.cpp:141] Setting up drop6
I0913 21:09:35.023762 16067 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:09:35.023766 16067 net.cpp:156] Memory required for data: 68109880
I0913 21:09:35.023771 16067 layer_factory.hpp:77] Creating layer fc7
I0913 21:09:35.023782 16067 net.cpp:91] Creating Layer fc7
I0913 21:09:35.023787 16067 net.cpp:425] fc7 <- fc6
I0913 21:09:35.023794 16067 net.cpp:399] fc7 -> fc7
I0913 21:09:35.068725 16067 net.cpp:141] Setting up fc7
I0913 21:09:35.068781 16067 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:09:35.068788 16067 net.cpp:156] Memory required for data: 68273720
I0913 21:09:35.068802 16067 layer_factory.hpp:77] Creating layer relu7
I0913 21:09:35.068819 16067 net.cpp:91] Creating Layer relu7
I0913 21:09:35.068825 16067 net.cpp:425] relu7 <- fc7
I0913 21:09:35.068840 16067 net.cpp:386] relu7 -> fc7 (in-place)
I0913 21:09:35.069524 16067 net.cpp:141] Setting up relu7
I0913 21:09:35.069536 16067 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:09:35.069541 16067 net.cpp:156] Memory required for data: 68437560
I0913 21:09:35.069546 16067 layer_factory.hpp:77] Creating layer drop7
I0913 21:09:35.069560 16067 net.cpp:91] Creating Layer drop7
I0913 21:09:35.069564 16067 net.cpp:425] drop7 <- fc7
I0913 21:09:35.069571 16067 net.cpp:386] drop7 -> fc7 (in-place)
I0913 21:09:35.069612 16067 net.cpp:141] Setting up drop7
I0913 21:09:35.069620 16067 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:09:35.069625 16067 net.cpp:156] Memory required for data: 68601400
I0913 21:09:35.069629 16067 layer_factory.hpp:77] Creating layer fc8
I0913 21:09:35.069639 16067 net.cpp:91] Creating Layer fc8
I0913 21:09:35.069643 16067 net.cpp:425] fc8 <- fc7
I0913 21:09:35.069654 16067 net.cpp:399] fc8 -> fc8
I0913 21:09:35.077201 16057 net.cpp:141] Setting up embedding
I0913 21:09:35.077257 16057 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:09:35.077265 16057 net.cpp:156] Memory required for data: 22408
I0913 21:09:35.077283 16057 layer_factory.hpp:77] Creating layer lstm1
I0913 21:09:35.077368 16057 net.cpp:91] Creating Layer lstm1
I0913 21:09:35.077404 16057 net.cpp:425] lstm1 <- embedded_input_frames
I0913 21:09:35.077416 16057 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0913 21:09:35.077427 16057 net.cpp:399] lstm1 -> lstm1
I0913 21:09:35.077476 16057 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0913 21:09:35.077874 16057 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0913 21:09:35.077970 16057 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:09:35.077986 16057 net.cpp:91] Creating Layer lstm1_
I0913 21:09:35.077991 16057 net.cpp:399] lstm1_ -> x
I0913 21:09:35.078003 16057 net.cpp:399] lstm1_ -> cont
I0913 21:09:35.078120 16057 net.cpp:141] Setting up lstm1_
I0913 21:09:35.078132 16057 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:09:35.078138 16057 net.cpp:148] Top shape: 1 1 (1)
I0913 21:09:35.078142 16057 net.cpp:156] Memory required for data: 2004
I0913 21:09:35.078148 16057 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:09:35.078156 16057 net.cpp:91] Creating Layer lstm1_
I0913 21:09:35.078161 16057 net.cpp:399] lstm1_ -> c_0
I0913 21:09:35.078173 16057 net.cpp:399] lstm1_ -> h_0
I0913 21:09:35.078227 16057 net.cpp:141] Setting up lstm1_
I0913 21:09:35.078236 16057 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:09:35.078243 16057 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:09:35.078248 16057 net.cpp:156] Memory required for data: 10004
I0913 21:09:35.078251 16057 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0913 21:09:35.078263 16057 net.cpp:91] Creating Layer lstm1_cont_slice
I0913 21:09:35.078268 16057 net.cpp:425] lstm1_cont_slice <- cont
I0913 21:09:35.078275 16057 net.cpp:399] lstm1_cont_slice -> cont_1
I0913 21:09:35.078310 16057 net.cpp:141] Setting up lstm1_cont_slice
I0913 21:09:35.078320 16057 net.cpp:148] Top shape: 1 1 (1)
I0913 21:09:35.078325 16057 net.cpp:156] Memory required for data: 10008
I0913 21:09:35.078328 16057 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0913 21:09:35.078336 16057 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0913 21:09:35.078341 16057 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0913 21:09:35.078351 16057 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0913 21:09:35.078358 16057 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0913 21:09:35.078404 16057 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0913 21:09:35.078418 16057 net.cpp:148] Top shape: 1 1 (1)
I0913 21:09:35.078429 16057 net.cpp:148] Top shape: 1 1 (1)
I0913 21:09:35.078436 16057 net.cpp:156] Memory required for data: 10016
I0913 21:09:35.078444 16057 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0913 21:09:35.078461 16057 net.cpp:91] Creating Layer lstm1_x_transform
I0913 21:09:35.078466 16057 net.cpp:425] lstm1_x_transform <- x
I0913 21:09:35.078474 16057 net.cpp:399] lstm1_x_transform -> W_xc_x
I0913 21:09:35.082777 16067 net.cpp:141] Setting up fc8
I0913 21:09:35.082813 16067 net.cpp:148] Top shape: 10 1000 (10000)
I0913 21:09:35.082819 16067 net.cpp:156] Memory required for data: 68641400
I0913 21:09:35.082833 16067 layer_factory.hpp:77] Creating layer prob
I0913 21:09:35.082849 16067 net.cpp:91] Creating Layer prob
I0913 21:09:35.082855 16067 net.cpp:425] prob <- fc8
I0913 21:09:35.082870 16067 net.cpp:399] prob -> prob
I0913 21:09:35.083287 16067 net.cpp:141] Setting up prob
I0913 21:09:35.083299 16067 net.cpp:148] Top shape: 10 1000 (10000)
I0913 21:09:35.083304 16067 net.cpp:156] Memory required for data: 68681400
I0913 21:09:35.083310 16067 net.cpp:219] prob does not need backward computation.
I0913 21:09:35.083315 16067 net.cpp:219] fc8 does not need backward computation.
I0913 21:09:35.083319 16067 net.cpp:219] drop7 does not need backward computation.
I0913 21:09:35.083324 16067 net.cpp:219] relu7 does not need backward computation.
I0913 21:09:35.083328 16067 net.cpp:219] fc7 does not need backward computation.
I0913 21:09:35.083333 16067 net.cpp:219] drop6 does not need backward computation.
I0913 21:09:35.083338 16067 net.cpp:219] relu6 does not need backward computation.
I0913 21:09:35.083341 16067 net.cpp:219] fc6 does not need backward computation.
I0913 21:09:35.083345 16067 net.cpp:219] pool5 does not need backward computation.
I0913 21:09:35.083350 16067 net.cpp:219] relu5 does not need backward computation.
I0913 21:09:35.083355 16067 net.cpp:219] conv5 does not need backward computation.
I0913 21:09:35.083359 16067 net.cpp:219] relu4 does not need backward computation.
I0913 21:09:35.083364 16067 net.cpp:219] conv4 does not need backward computation.
I0913 21:09:35.083369 16067 net.cpp:219] relu3 does not need backward computation.
I0913 21:09:35.083372 16067 net.cpp:219] conv3 does not need backward computation.
I0913 21:09:35.083377 16067 net.cpp:219] norm2 does not need backward computation.
I0913 21:09:35.083381 16067 net.cpp:219] pool2 does not need backward computation.
I0913 21:09:35.083386 16067 net.cpp:219] relu2 does not need backward computation.
I0913 21:09:35.083390 16067 net.cpp:219] conv2 does not need backward computation.
I0913 21:09:35.083395 16067 net.cpp:219] norm1 does not need backward computation.
I0913 21:09:35.083400 16067 net.cpp:219] pool1 does not need backward computation.
I0913 21:09:35.083403 16067 net.cpp:219] relu1 does not need backward computation.
I0913 21:09:35.083408 16067 net.cpp:219] conv1 does not need backward computation.
I0913 21:09:35.083412 16067 net.cpp:219] data does not need backward computation.
I0913 21:09:35.083416 16067 net.cpp:261] This network produces output prob
I0913 21:09:35.083439 16067 net.cpp:274] Network initialization done.
I0913 21:09:35.098125 16057 net.cpp:141] Setting up lstm1_x_transform
I0913 21:09:35.098167 16057 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:09:35.098172 16057 net.cpp:156] Memory required for data: 26016
I0913 21:09:35.098192 16057 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0913 21:09:35.098209 16057 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0913 21:09:35.098215 16057 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0913 21:09:35.098227 16057 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0913 21:09:35.098271 16057 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0913 21:09:35.098281 16057 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:09:35.098285 16057 net.cpp:156] Memory required for data: 42016
I0913 21:09:35.098289 16057 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0913 21:09:35.098299 16057 net.cpp:91] Creating Layer lstm1_h_conted_0
I0913 21:09:35.098304 16057 net.cpp:425] lstm1_h_conted_0 <- h_0
I0913 21:09:35.098310 16057 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0913 21:09:35.098320 16057 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0913 21:09:35.098413 16057 net.cpp:141] Setting up lstm1_h_conted_0
I0913 21:09:35.098423 16057 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:09:35.098428 16057 net.cpp:156] Memory required for data: 46016
I0913 21:09:35.098431 16057 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0913 21:09:35.098448 16057 net.cpp:91] Creating Layer lstm1_transform_1
I0913 21:09:35.098453 16057 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0913 21:09:35.098461 16057 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0913 21:09:35.136575 16057 net.cpp:141] Setting up lstm1_transform_1
I0913 21:09:35.136625 16057 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:09:35.136631 16057 net.cpp:156] Memory required for data: 62016
I0913 21:09:35.136651 16057 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0913 21:09:35.136677 16057 net.cpp:91] Creating Layer lstm1_gate_input_1
I0913 21:09:35.136685 16057 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0913 21:09:35.136693 16057 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0913 21:09:35.136703 16057 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0913 21:09:35.136755 16057 net.cpp:141] Setting up lstm1_gate_input_1
I0913 21:09:35.136765 16057 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:09:35.136770 16057 net.cpp:156] Memory required for data: 78016
I0913 21:09:35.136773 16057 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0913 21:09:35.136785 16057 net.cpp:91] Creating Layer lstm1_unit_1
I0913 21:09:35.136790 16057 net.cpp:425] lstm1_unit_1 <- c_0
I0913 21:09:35.136796 16057 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0913 21:09:35.136801 16057 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0913 21:09:35.136807 16057 net.cpp:399] lstm1_unit_1 -> c_1
I0913 21:09:35.136816 16057 net.cpp:399] lstm1_unit_1 -> h_1
I0913 21:09:35.136876 16057 net.cpp:141] Setting up lstm1_unit_1
I0913 21:09:35.136885 16057 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:09:35.136891 16057 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:09:35.136895 16057 net.cpp:156] Memory required for data: 86016
I0913 21:09:35.136899 16057 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:09:35.136907 16057 net.cpp:91] Creating Layer lstm1_
I0913 21:09:35.136911 16057 net.cpp:425] lstm1_ <- c_1
I0913 21:09:35.136919 16057 net.cpp:399] lstm1_ -> c_T
I0913 21:09:35.136950 16057 net.cpp:141] Setting up lstm1_
I0913 21:09:35.136958 16057 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:09:35.136962 16057 net.cpp:156] Memory required for data: 90016
I0913 21:09:35.136966 16057 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0913 21:09:35.136976 16057 net.cpp:91] Creating Layer lstm1_h_concat
I0913 21:09:35.136981 16057 net.cpp:425] lstm1_h_concat <- h_1
I0913 21:09:35.136986 16057 net.cpp:399] lstm1_h_concat -> h
I0913 21:09:35.137035 16057 net.cpp:141] Setting up lstm1_h_concat
I0913 21:09:35.137044 16057 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:09:35.137048 16057 net.cpp:156] Memory required for data: 94016
I0913 21:09:35.137053 16057 layer_factory.hpp:77] Creating layer h_pseudoloss
I0913 21:09:35.137069 16057 net.cpp:91] Creating Layer h_pseudoloss
I0913 21:09:35.137073 16057 net.cpp:425] h_pseudoloss <- h
I0913 21:09:35.137080 16057 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0913 21:09:35.137162 16057 net.cpp:141] Setting up h_pseudoloss
I0913 21:09:35.137172 16057 net.cpp:148] Top shape: (1)
I0913 21:09:35.137177 16057 net.cpp:151]     with loss weight 1
I0913 21:09:35.137213 16057 net.cpp:156] Memory required for data: 94020
I0913 21:09:35.137219 16057 net.cpp:217] h_pseudoloss needs backward computation.
I0913 21:09:35.137224 16057 net.cpp:217] lstm1_h_concat needs backward computation.
I0913 21:09:35.137228 16057 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:09:35.137233 16057 net.cpp:217] lstm1_unit_1 needs backward computation.
I0913 21:09:35.137239 16057 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0913 21:09:35.137246 16057 net.cpp:217] lstm1_transform_1 needs backward computation.
I0913 21:09:35.137251 16057 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0913 21:09:35.137257 16057 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0913 21:09:35.137262 16057 net.cpp:217] lstm1_x_transform needs backward computation.
I0913 21:09:35.137267 16057 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0913 21:09:35.137272 16057 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0913 21:09:35.137277 16057 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:09:35.137281 16057 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:09:35.137285 16057 net.cpp:261] This network produces output c_T
I0913 21:09:35.137290 16057 net.cpp:261] This network produces output h_pseudoloss
I0913 21:09:35.137305 16057 net.cpp:274] Network initialization done.
I0913 21:09:35.137359 16057 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0913 21:09:35.137365 16057 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0913 21:09:35.137370 16057 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0913 21:09:35.137472 16057 net.cpp:141] Setting up lstm1
I0913 21:09:35.137485 16057 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:09:35.137490 16057 net.cpp:156] Memory required for data: 26408
I0913 21:09:35.137502 16057 layer_factory.hpp:77] Creating layer concat
I0913 21:09:35.137511 16057 net.cpp:91] Creating Layer concat
I0913 21:09:35.137516 16057 net.cpp:425] concat <- lstm1
I0913 21:09:35.137522 16057 net.cpp:425] concat <- embedded_input_sentence
I0913 21:09:35.137528 16057 net.cpp:425] concat <- reshaped_stage_indicator
I0913 21:09:35.137534 16057 net.cpp:399] concat -> lstm1_video_sequence
I0913 21:09:35.137567 16057 net.cpp:141] Setting up concat
I0913 21:09:35.137575 16057 net.cpp:148] Top shape: 1 1 1501 (1501)
I0913 21:09:35.137579 16057 net.cpp:156] Memory required for data: 32412
I0913 21:09:35.137583 16057 layer_factory.hpp:77] Creating layer lstm2
I0913 21:09:35.137595 16057 net.cpp:91] Creating Layer lstm2
I0913 21:09:35.137600 16057 net.cpp:425] lstm2 <- lstm1_video_sequence
I0913 21:09:35.137606 16057 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0913 21:09:35.137612 16057 net.cpp:399] lstm2 -> lstm2
I0913 21:09:35.137624 16057 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0913 21:09:35.137877 16057 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0913 21:09:35.137962 16057 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:09:35.137974 16057 net.cpp:91] Creating Layer lstm2_
I0913 21:09:35.137979 16057 net.cpp:399] lstm2_ -> x
I0913 21:09:35.137989 16057 net.cpp:399] lstm2_ -> cont
I0913 21:09:35.138041 16057 net.cpp:141] Setting up lstm2_
I0913 21:09:35.138051 16057 net.cpp:148] Top shape: 1 1 1501 (1501)
I0913 21:09:35.138057 16057 net.cpp:148] Top shape: 1 1 (1)
I0913 21:09:35.138062 16057 net.cpp:156] Memory required for data: 6008
I0913 21:09:35.138067 16057 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:09:35.138077 16057 net.cpp:91] Creating Layer lstm2_
I0913 21:09:35.138083 16057 net.cpp:399] lstm2_ -> c_0
I0913 21:09:35.138092 16057 net.cpp:399] lstm2_ -> h_0
I0913 21:09:35.138139 16057 net.cpp:141] Setting up lstm2_
I0913 21:09:35.138149 16057 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:09:35.138154 16057 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:09:35.138157 16057 net.cpp:156] Memory required for data: 14008
I0913 21:09:35.138162 16057 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0913 21:09:35.138170 16057 net.cpp:91] Creating Layer lstm2_cont_slice
I0913 21:09:35.138175 16057 net.cpp:425] lstm2_cont_slice <- cont
I0913 21:09:35.138181 16057 net.cpp:399] lstm2_cont_slice -> cont_1
I0913 21:09:35.138216 16057 net.cpp:141] Setting up lstm2_cont_slice
I0913 21:09:35.138226 16057 net.cpp:148] Top shape: 1 1 (1)
I0913 21:09:35.138229 16057 net.cpp:156] Memory required for data: 14012
I0913 21:09:35.138233 16057 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0913 21:09:35.138239 16057 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0913 21:09:35.138244 16057 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0913 21:09:35.138252 16057 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0913 21:09:35.138260 16057 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0913 21:09:35.138303 16057 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0913 21:09:35.138311 16057 net.cpp:148] Top shape: 1 1 (1)
I0913 21:09:35.138316 16057 net.cpp:148] Top shape: 1 1 (1)
I0913 21:09:35.138320 16057 net.cpp:156] Memory required for data: 14020
I0913 21:09:35.138325 16057 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0913 21:09:35.138337 16057 net.cpp:91] Creating Layer lstm2_x_transform
I0913 21:09:35.138342 16057 net.cpp:425] lstm2_x_transform <- x
I0913 21:09:35.138351 16057 net.cpp:399] lstm2_x_transform -> W_xc_x
I0913 21:09:35.195994 16057 net.cpp:141] Setting up lstm2_x_transform
I0913 21:09:35.196043 16057 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:09:35.196049 16057 net.cpp:156] Memory required for data: 30020
I0913 21:09:35.196076 16057 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0913 21:09:35.196095 16057 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0913 21:09:35.196102 16057 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0913 21:09:35.196112 16057 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0913 21:09:35.196163 16057 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0913 21:09:35.196173 16057 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:09:35.196177 16057 net.cpp:156] Memory required for data: 46020
I0913 21:09:35.196182 16057 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0913 21:09:35.196192 16057 net.cpp:91] Creating Layer lstm2_h_conted_0
I0913 21:09:35.196198 16057 net.cpp:425] lstm2_h_conted_0 <- h_0
I0913 21:09:35.196203 16057 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0913 21:09:35.196210 16057 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0913 21:09:35.196301 16057 net.cpp:141] Setting up lstm2_h_conted_0
I0913 21:09:35.196310 16057 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:09:35.196315 16057 net.cpp:156] Memory required for data: 50020
I0913 21:09:35.196319 16057 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0913 21:09:35.196331 16057 net.cpp:91] Creating Layer lstm2_transform_1
I0913 21:09:35.196336 16057 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0913 21:09:35.196344 16057 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0913 21:09:35.233899 16057 net.cpp:141] Setting up lstm2_transform_1
I0913 21:09:35.233947 16057 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:09:35.233953 16057 net.cpp:156] Memory required for data: 66020
I0913 21:09:35.233973 16057 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0913 21:09:35.233995 16057 net.cpp:91] Creating Layer lstm2_gate_input_1
I0913 21:09:35.234002 16057 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0913 21:09:35.234010 16057 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0913 21:09:35.234021 16057 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0913 21:09:35.234068 16057 net.cpp:141] Setting up lstm2_gate_input_1
I0913 21:09:35.234079 16057 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:09:35.234083 16057 net.cpp:156] Memory required for data: 82020
I0913 21:09:35.234088 16057 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0913 21:09:35.234097 16057 net.cpp:91] Creating Layer lstm2_unit_1
I0913 21:09:35.234102 16057 net.cpp:425] lstm2_unit_1 <- c_0
I0913 21:09:35.234107 16057 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0913 21:09:35.234112 16057 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0913 21:09:35.234119 16057 net.cpp:399] lstm2_unit_1 -> c_1
I0913 21:09:35.234127 16057 net.cpp:399] lstm2_unit_1 -> h_1
I0913 21:09:35.234190 16057 net.cpp:141] Setting up lstm2_unit_1
I0913 21:09:35.234200 16057 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:09:35.234205 16057 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:09:35.234210 16057 net.cpp:156] Memory required for data: 90020
I0913 21:09:35.234213 16057 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:09:35.234221 16057 net.cpp:91] Creating Layer lstm2_
I0913 21:09:35.234225 16057 net.cpp:425] lstm2_ <- c_1
I0913 21:09:35.234232 16057 net.cpp:399] lstm2_ -> c_T
I0913 21:09:35.234261 16057 net.cpp:141] Setting up lstm2_
I0913 21:09:35.234272 16057 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:09:35.234277 16057 net.cpp:156] Memory required for data: 94020
I0913 21:09:35.234282 16057 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0913 21:09:35.234290 16057 net.cpp:91] Creating Layer lstm2_h_concat
I0913 21:09:35.234294 16057 net.cpp:425] lstm2_h_concat <- h_1
I0913 21:09:35.234304 16057 net.cpp:399] lstm2_h_concat -> h
I0913 21:09:35.234336 16057 net.cpp:141] Setting up lstm2_h_concat
I0913 21:09:35.234345 16057 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:09:35.234349 16057 net.cpp:156] Memory required for data: 98020
I0913 21:09:35.234354 16057 layer_factory.hpp:77] Creating layer h_pseudoloss
I0913 21:09:35.234364 16057 net.cpp:91] Creating Layer h_pseudoloss
I0913 21:09:35.234369 16057 net.cpp:425] h_pseudoloss <- h
I0913 21:09:35.234375 16057 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0913 21:09:35.234460 16057 net.cpp:141] Setting up h_pseudoloss
I0913 21:09:35.234469 16057 net.cpp:148] Top shape: (1)
I0913 21:09:35.234473 16057 net.cpp:151]     with loss weight 1
I0913 21:09:35.234485 16057 net.cpp:156] Memory required for data: 98024
I0913 21:09:35.234490 16057 net.cpp:217] h_pseudoloss needs backward computation.
I0913 21:09:35.234495 16057 net.cpp:217] lstm2_h_concat needs backward computation.
I0913 21:09:35.234499 16057 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:09:35.234504 16057 net.cpp:217] lstm2_unit_1 needs backward computation.
I0913 21:09:35.234509 16057 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0913 21:09:35.234514 16057 net.cpp:217] lstm2_transform_1 needs backward computation.
I0913 21:09:35.234519 16057 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0913 21:09:35.234525 16057 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0913 21:09:35.234529 16057 net.cpp:217] lstm2_x_transform needs backward computation.
I0913 21:09:35.234534 16057 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0913 21:09:35.234539 16057 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0913 21:09:35.234544 16057 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:09:35.234549 16057 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:09:35.234552 16057 net.cpp:261] This network produces output c_T
I0913 21:09:35.234556 16057 net.cpp:261] This network produces output h_pseudoloss
I0913 21:09:35.234573 16057 net.cpp:274] Network initialization done.
I0913 21:09:35.234623 16057 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0913 21:09:35.234629 16057 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0913 21:09:35.234634 16057 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0913 21:09:35.234730 16057 net.cpp:141] Setting up lstm2
I0913 21:09:35.234740 16057 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:09:35.234745 16057 net.cpp:156] Memory required for data: 36412
I0913 21:09:35.234757 16057 layer_factory.hpp:77] Creating layer predict
I0913 21:09:35.234771 16057 net.cpp:91] Creating Layer predict
I0913 21:09:35.234776 16057 net.cpp:425] predict <- lstm2
I0913 21:09:35.234783 16057 net.cpp:399] predict -> predict
I0913 21:09:35.385506 16067 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /home/peifeng/work/run/storm102/data/workers/f7ddf71a-7f45-4ba7-a9f9-29d276bcd388/tmp/cvld2994469667959769379/bvlc_reference_caffenet.caffemodel
I0913 21:09:35.385557 16067 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0913 21:09:35.385563 16067 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0913 21:09:35.385568 16067 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /home/peifeng/work/run/storm102/data/workers/f7ddf71a-7f45-4ba7-a9f9-29d276bcd388/tmp/cvld2994469667959769379/bvlc_reference_caffenet.caffemodel
I0913 21:09:35.671684 16057 net.cpp:141] Setting up predict
I0913 21:09:35.671739 16057 net.cpp:148] Top shape: 1 1 46168 (46168)
I0913 21:09:35.671746 16057 net.cpp:156] Memory required for data: 221084
I0913 21:09:35.671762 16057 layer_factory.hpp:77] Creating layer probs
I0913 21:09:35.671782 16057 net.cpp:91] Creating Layer probs
I0913 21:09:35.671792 16057 net.cpp:425] probs <- predict
I0913 21:09:35.671802 16057 net.cpp:399] probs -> probs
I0913 21:09:35.672696 16057 net.cpp:141] Setting up probs
I0913 21:09:35.672713 16057 net.cpp:148] Top shape: 1 1 46168 (46168)
I0913 21:09:35.672719 16057 net.cpp:156] Memory required for data: 405756
I0913 21:09:35.672724 16057 net.cpp:219] probs does not need backward computation.
I0913 21:09:35.672730 16057 net.cpp:219] predict does not need backward computation.
I0913 21:09:35.672735 16057 net.cpp:219] lstm2 does not need backward computation.
I0913 21:09:35.672744 16057 net.cpp:219] concat does not need backward computation.
I0913 21:09:35.672750 16057 net.cpp:219] lstm1 does not need backward computation.
I0913 21:09:35.672757 16057 net.cpp:219] embedding does not need backward computation.
I0913 21:09:35.672763 16057 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0913 21:09:35.672770 16057 net.cpp:219] reshape_frames does not need backward computation.
I0913 21:09:35.672775 16057 net.cpp:219] embed_encoder does not need backward computation.
I0913 21:09:35.672781 16057 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0913 21:09:35.672788 16057 net.cpp:219] input does not need backward computation.
I0913 21:09:35.672792 16057 net.cpp:261] This network produces output probs
I0913 21:09:35.672809 16057 net.cpp:274] Network initialization done.
I0913 21:09:35.756011 16067 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0913 21:09:35.805162 16067 net.cpp:752] Ignoring source layer loss
Loading the model + trained: 11151.4ms
Using cv::Size and some other stuff: 0.168ms
Loading the mean file: 1622.76ms
I0913 21:09:36.073236 16057 net.cpp:752] Ignoring source layer data
I0913 21:09:36.073276 16057 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0913 21:09:36.073281 16057 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0913 21:09:36.146960 16057 net.cpp:752] Ignoring source layer cross_entropy_loss
TIMERTIMER 139689814
TIMERTIMER 64098608
TIMERTIMER 72413202
TIMERTIMER 49007116
TIMERTIMER 48213106
TIMERTIMER 49937675
TIMERTIMER 49573940
TIMERTIMER 48783458
TIMERTIMER 37489460
TIMERTIMER 50961785
TIMERTIMER 43734356
TIMERTIMER 50822365
TIMERTIMER 54778430
TIMERTIMER 48752889
TIMERTIMER 48646873
TIMERTIMER 49101008
TIMERTIMER 49741201
TIMERTIMER 47957549
TIMERTIMER 48740032
TIMERTIMER 31379315
TIMERTIMER 31279125
TIMERTIMER 31725580
TIMERTIMER 31515309
TIMERTIMER 31399552
TIMERTIMER 37718132
TIMERTIMER 37397596
TIMERTIMER 44856840
TIMERTIMER 32033363
TIMERTIMER 31546358
TIMERTIMER 38473206
TIMERTIMER 31462943
TIMERTIMER 37524525
TIMERTIMER 31443983
TIMERTIMER 31551126
TIMERTIMER 43700332
TIMERTIMER 35409584
TIMERTIMER 32248795
TIMERTIMER 32132254
TIMERTIMER 31584959
TIMERTIMER 37778544
TIMERTIMER 31500358
TIMERTIMER 38380661
TIMERTIMER 32389315
TIMERTIMER 36227499
TIMERTIMER 38447042
TIMERTIMER 32107067
TIMERTIMER 31897797
TIMERTIMER 36356138
TIMERTIMER 31785203
TIMERTIMER 37782120
TIMERTIMER 40985833
TIMERTIMER 34154482
TIMERTIMER 31818861
TIMERTIMER 37831311
TIMERTIMER 35208888
TIMERTIMER 37826699
TIMERTIMER 31804293
TIMERTIMER 31631692
TIMERTIMER 31571090
TIMERTIMER 39596560
TIMERTIMER 37704800
TIMERTIMER 37723714
TIMERTIMER 31634734
TIMERTIMER 32273987
TIMERTIMER 31572671
TIMERTIMER 31905703
TIMERTIMER 52830726
TIMERTIMER 31761578
TIMERTIMER 38065139
TIMERTIMER 31597591
TIMERTIMER 31968499
TIMERTIMER 31667610
TIMERTIMER 31649464
TIMERTIMER 32416730
TIMERTIMER 32418837
TIMERTIMER 31511300
TIMERTIMER 38160608
TIMERTIMER 32460666
TIMERTIMER 32146988
TIMERTIMER 31715112
TIMERTIMER 37780442
TIMERTIMER 37814918
TIMERTIMER 32042703
TIMERTIMER 31598947
TIMERTIMER 37902219
TIMERTIMER 31730818
TIMERTIMER 31927405
TIMERTIMER 31720185
TIMERTIMER 38664822
TIMERTIMER 31447210
TIMERTIMER 33165772
TIMERTIMER 31717092
TIMERTIMER 32710430
TIMERTIMER 31578913
TIMERTIMER 37905406
TIMERTIMER 38011142
TIMERTIMER 37534119
TIMERTIMER 32309701
TIMERTIMER 37730926
TIMERTIMER 31626575
TIMERTIMER 31583632
TIMERTIMER 32855782
TIMERTIMER 37580366
TIMERTIMER 32975038
TIMERTIMER 36011422
#
# A fatal error has been detected by the Java Runtime Environment:
#
#  SIGSEGV (0xb) at pc=0x00007f8c0edbe399, pid=15990, tid=140237812696832
#
# JRE version: Java(TM) SE Runtime Environment (8.0_77-b03) (build 1.8.0_77-b03)
# Java VM: Java HotSpot(TM) 64-Bit Server VM (25.77-b03 mixed mode linux-amd64 compressed oops)
# Problematic frame:
# C  [libc.so.6+0x80399][thread 140233968441088 also had an error]
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/peifeng/tools/storm102/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/peifeng/work/run/storm102/data/supervisor/stormdist/captioning-1-1473815287/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
