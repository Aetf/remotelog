SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/peifeng/tools/storm102/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/peifeng/work/run/storm102/data/supervisor/stormdist/captioning-1-1473815922/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /home/peifeng/work/run/storm102/data/workers/064bc5ad-656e-498e-81db-fb51a99eaa85/tmp/cvld5311359139217322975/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0913 21:19:21.372961 22262 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0913 21:19:21.373157 22262 layer_factory.hpp:77] Creating layer data
I0913 21:19:21.373183 22262 net.cpp:91] Creating Layer data
I0913 21:19:21.373193 22262 net.cpp:399] data -> data
I0913 21:19:21.945986 22262 net.cpp:141] Setting up data
I0913 21:19:21.946094 22262 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0913 21:19:21.946101 22262 net.cpp:156] Memory required for data: 6183480
I0913 21:19:21.946122 22262 layer_factory.hpp:77] Creating layer conv1
I0913 21:19:21.946156 22262 net.cpp:91] Creating Layer conv1
I0913 21:19:21.946164 22262 net.cpp:425] conv1 <- data
I0913 21:19:21.946178 22262 net.cpp:399] conv1 -> conv1
I0913 21:19:22.136711 22262 net.cpp:141] Setting up conv1
I0913 21:19:22.136761 22262 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0913 21:19:22.136768 22262 net.cpp:156] Memory required for data: 17799480
I0913 21:19:22.136796 22262 layer_factory.hpp:77] Creating layer relu1
I0913 21:19:22.136858 22262 net.cpp:91] Creating Layer relu1
I0913 21:19:22.136875 22262 net.cpp:425] relu1 <- conv1
I0913 21:19:22.136883 22262 net.cpp:386] relu1 -> conv1 (in-place)
I0913 21:19:22.137305 22262 net.cpp:141] Setting up relu1
I0913 21:19:22.137320 22262 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0913 21:19:22.137325 22262 net.cpp:156] Memory required for data: 29415480
I0913 21:19:22.137331 22262 layer_factory.hpp:77] Creating layer pool1
I0913 21:19:22.137367 22262 net.cpp:91] Creating Layer pool1
I0913 21:19:22.137373 22262 net.cpp:425] pool1 <- conv1
I0913 21:19:22.137380 22262 net.cpp:399] pool1 -> pool1
I0913 21:19:22.137462 22262 net.cpp:141] Setting up pool1
I0913 21:19:22.137473 22262 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0913 21:19:22.137477 22262 net.cpp:156] Memory required for data: 32214840
I0913 21:19:22.137482 22262 layer_factory.hpp:77] Creating layer norm1
I0913 21:19:22.137502 22262 net.cpp:91] Creating Layer norm1
I0913 21:19:22.137508 22262 net.cpp:425] norm1 <- pool1
I0913 21:19:22.137514 22262 net.cpp:399] norm1 -> norm1
I0913 21:19:22.137778 22262 net.cpp:141] Setting up norm1
I0913 21:19:22.137790 22262 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0913 21:19:22.137795 22262 net.cpp:156] Memory required for data: 35014200
I0913 21:19:22.137800 22262 layer_factory.hpp:77] Creating layer conv2
I0913 21:19:22.137831 22262 net.cpp:91] Creating Layer conv2
I0913 21:19:22.137838 22262 net.cpp:425] conv2 <- norm1
I0913 21:19:22.137845 22262 net.cpp:399] conv2 -> conv2
I0913 21:19:22.141762 22262 net.cpp:141] Setting up conv2
I0913 21:19:22.141780 22262 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0913 21:19:22.141785 22262 net.cpp:156] Memory required for data: 42479160
I0913 21:19:22.141798 22262 layer_factory.hpp:77] Creating layer relu2
I0913 21:19:22.141813 22262 net.cpp:91] Creating Layer relu2
I0913 21:19:22.141819 22262 net.cpp:425] relu2 <- conv2
I0913 21:19:22.141824 22262 net.cpp:386] relu2 -> conv2 (in-place)
I0913 21:19:22.142216 22262 net.cpp:141] Setting up relu2
I0913 21:19:22.142230 22262 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0913 21:19:22.142235 22262 net.cpp:156] Memory required for data: 49944120
I0913 21:19:22.142240 22262 layer_factory.hpp:77] Creating layer pool2
I0913 21:19:22.142251 22262 net.cpp:91] Creating Layer pool2
I0913 21:19:22.142256 22262 net.cpp:425] pool2 <- conv2
I0913 21:19:22.142266 22262 net.cpp:399] pool2 -> pool2
I0913 21:19:22.142318 22262 net.cpp:141] Setting up pool2
I0913 21:19:22.142326 22262 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:19:22.142330 22262 net.cpp:156] Memory required for data: 51674680
I0913 21:19:22.142338 22262 layer_factory.hpp:77] Creating layer norm2
I0913 21:19:22.142349 22262 net.cpp:91] Creating Layer norm2
I0913 21:19:22.142354 22262 net.cpp:425] norm2 <- pool2
I0913 21:19:22.142359 22262 net.cpp:399] norm2 -> norm2
I0913 21:19:22.142602 22262 net.cpp:141] Setting up norm2
I0913 21:19:22.142613 22262 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:19:22.142617 22262 net.cpp:156] Memory required for data: 53405240
I0913 21:19:22.142622 22262 layer_factory.hpp:77] Creating layer conv3
I0913 21:19:22.142634 22262 net.cpp:91] Creating Layer conv3
I0913 21:19:22.142639 22262 net.cpp:425] conv3 <- norm2
I0913 21:19:22.142647 22262 net.cpp:399] conv3 -> conv3
I0913 21:19:22.146272 22262 net.cpp:141] Setting up conv3
I0913 21:19:22.146302 22262 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:19:22.146308 22262 net.cpp:156] Memory required for data: 56001080
I0913 21:19:22.146323 22262 layer_factory.hpp:77] Creating layer relu3
I0913 21:19:22.146339 22262 net.cpp:91] Creating Layer relu3
I0913 21:19:22.146345 22262 net.cpp:425] relu3 <- conv3
I0913 21:19:22.146351 22262 net.cpp:386] relu3 -> conv3 (in-place)
I0913 21:19:22.146574 22262 net.cpp:141] Setting up relu3
I0913 21:19:22.146584 22262 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:19:22.146589 22262 net.cpp:156] Memory required for data: 58596920
I0913 21:19:22.146594 22262 layer_factory.hpp:77] Creating layer conv4
I0913 21:19:22.146608 22262 net.cpp:91] Creating Layer conv4
I0913 21:19:22.146615 22262 net.cpp:425] conv4 <- conv3
I0913 21:19:22.146621 22262 net.cpp:399] conv4 -> conv4
I0913 21:19:22.150924 22262 net.cpp:141] Setting up conv4
I0913 21:19:22.150967 22262 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:19:22.150974 22262 net.cpp:156] Memory required for data: 61192760
I0913 21:19:22.150988 22262 layer_factory.hpp:77] Creating layer relu4
I0913 21:19:22.151005 22262 net.cpp:91] Creating Layer relu4
I0913 21:19:22.151012 22262 net.cpp:425] relu4 <- conv4
I0913 21:19:22.151024 22262 net.cpp:386] relu4 -> conv4 (in-place)
I0913 21:19:22.151414 22262 net.cpp:141] Setting up relu4
I0913 21:19:22.151427 22262 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:19:22.151432 22262 net.cpp:156] Memory required for data: 63788600
I0913 21:19:22.151437 22262 layer_factory.hpp:77] Creating layer conv5
I0913 21:19:22.151455 22262 net.cpp:91] Creating Layer conv5
I0913 21:19:22.151461 22262 net.cpp:425] conv5 <- conv4
I0913 21:19:22.151471 22262 net.cpp:399] conv5 -> conv5
I0913 21:19:22.155071 22262 net.cpp:141] Setting up conv5
I0913 21:19:22.155093 22262 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:19:22.155099 22262 net.cpp:156] Memory required for data: 65519160
I0913 21:19:22.155113 22262 layer_factory.hpp:77] Creating layer relu5
I0913 21:19:22.155123 22262 net.cpp:91] Creating Layer relu5
I0913 21:19:22.155128 22262 net.cpp:425] relu5 <- conv5
I0913 21:19:22.155139 22262 net.cpp:386] relu5 -> conv5 (in-place)
I0913 21:19:22.155551 22262 net.cpp:141] Setting up relu5
I0913 21:19:22.155563 22262 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:19:22.155568 22262 net.cpp:156] Memory required for data: 67249720
I0913 21:19:22.155573 22262 layer_factory.hpp:77] Creating layer pool5
I0913 21:19:22.155585 22262 net.cpp:91] Creating Layer pool5
I0913 21:19:22.155588 22262 net.cpp:425] pool5 <- conv5
I0913 21:19:22.155599 22262 net.cpp:399] pool5 -> pool5
I0913 21:19:22.155658 22262 net.cpp:141] Setting up pool5
I0913 21:19:22.155666 22262 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0913 21:19:22.155670 22262 net.cpp:156] Memory required for data: 67618360
I0913 21:19:22.155675 22262 layer_factory.hpp:77] Creating layer fc6
I0913 21:19:22.155704 22262 net.cpp:91] Creating Layer fc6
I0913 21:19:22.155709 22262 net.cpp:425] fc6 <- pool5
I0913 21:19:22.155717 22262 net.cpp:399] fc6 -> fc6
I0913 21:19:22.241561 22252 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/064bc5ad-656e-498e-81db-fb51a99eaa85/tmp/cvld5311359139217322975/s2vt.words_to_preds.prototxt
I0913 21:19:22.241626 22252 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0913 21:19:22.241633 22252 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0913 21:19:22.241904 22252 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0913 21:19:22.241996 22252 layer_factory.hpp:77] Creating layer input
I0913 21:19:22.242009 22252 net.cpp:91] Creating Layer input
I0913 21:19:22.242017 22252 net.cpp:399] input -> frames_fc7
I0913 21:19:22.242033 22252 net.cpp:399] input -> cont_sentence
I0913 21:19:22.242043 22252 net.cpp:399] input -> input_sentence
I0913 21:19:22.242053 22252 net.cpp:399] input -> stage_indicator
I0913 21:19:22.242172 22252 net.cpp:141] Setting up input
I0913 21:19:22.242184 22252 net.cpp:148] Top shape: 1 4096 (4096)
I0913 21:19:22.242190 22252 net.cpp:148] Top shape: 1 1 (1)
I0913 21:19:22.242195 22252 net.cpp:148] Top shape: 1 1 (1)
I0913 21:19:22.242202 22252 net.cpp:148] Top shape: 1 1 (1)
I0913 21:19:22.242205 22252 net.cpp:156] Memory required for data: 16396
I0913 21:19:22.242210 22252 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0913 21:19:22.242228 22252 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0913 21:19:22.242234 22252 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0913 21:19:22.242251 22252 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0913 21:19:22.242261 22252 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0913 21:19:22.242310 22252 net.cpp:141] Setting up cont_sentence_input_1_split
I0913 21:19:22.242319 22252 net.cpp:148] Top shape: 1 1 (1)
I0913 21:19:22.242326 22252 net.cpp:148] Top shape: 1 1 (1)
I0913 21:19:22.242329 22252 net.cpp:156] Memory required for data: 16404
I0913 21:19:22.242333 22252 layer_factory.hpp:77] Creating layer embed_encoder
I0913 21:19:22.242344 22252 net.cpp:91] Creating Layer embed_encoder
I0913 21:19:22.242349 22252 net.cpp:425] embed_encoder <- frames_fc7
I0913 21:19:22.242357 22252 net.cpp:399] embed_encoder -> embedded_in_frames
I0913 21:19:22.261526 22262 net.cpp:141] Setting up fc6
I0913 21:19:22.261574 22262 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:19:22.261590 22262 net.cpp:156] Memory required for data: 67782200
I0913 21:19:22.261605 22262 layer_factory.hpp:77] Creating layer relu6
I0913 21:19:22.261627 22262 net.cpp:91] Creating Layer relu6
I0913 21:19:22.261636 22262 net.cpp:425] relu6 <- fc6
I0913 21:19:22.261644 22262 net.cpp:386] relu6 -> fc6 (in-place)
I0913 21:19:22.262094 22252 net.cpp:141] Setting up embed_encoder
I0913 21:19:22.262122 22252 net.cpp:148] Top shape: 1 500 (500)
I0913 21:19:22.262127 22252 net.cpp:156] Memory required for data: 18404
I0913 21:19:22.262145 22252 layer_factory.hpp:77] Creating layer reshape_frames
I0913 21:19:22.262169 22252 net.cpp:91] Creating Layer reshape_frames
I0913 21:19:22.262177 22252 net.cpp:425] reshape_frames <- embedded_in_frames
I0913 21:19:22.262178 22262 net.cpp:141] Setting up relu6
I0913 21:19:22.262188 22252 net.cpp:399] reshape_frames -> embedded_input_frames
I0913 21:19:22.262192 22262 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:19:22.262197 22262 net.cpp:156] Memory required for data: 67946040
I0913 21:19:22.262202 22262 layer_factory.hpp:77] Creating layer drop6
I0913 21:19:22.262212 22262 net.cpp:91] Creating Layer drop6
I0913 21:19:22.262217 22262 net.cpp:425] drop6 <- fc6
I0913 21:19:22.262226 22262 net.cpp:386] drop6 -> fc6 (in-place)
I0913 21:19:22.262246 22252 net.cpp:141] Setting up reshape_frames
I0913 21:19:22.262256 22252 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:19:22.262260 22252 net.cpp:156] Memory required for data: 20404
I0913 21:19:22.262265 22252 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0913 21:19:22.262276 22252 net.cpp:91] Creating Layer reshape_stage_indicator
I0913 21:19:22.262281 22252 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0913 21:19:22.262290 22252 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0913 21:19:22.262289 22262 net.cpp:141] Setting up drop6
I0913 21:19:22.262310 22262 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:19:22.262315 22262 net.cpp:156] Memory required for data: 68109880
I0913 21:19:22.262320 22262 layer_factory.hpp:77] Creating layer fc7
I0913 21:19:22.262331 22262 net.cpp:91] Creating Layer fc7
I0913 21:19:22.262334 22262 net.cpp:425] fc7 <- fc6
I0913 21:19:22.262338 22252 net.cpp:141] Setting up reshape_stage_indicator
I0913 21:19:22.262341 22262 net.cpp:399] fc7 -> fc7
I0913 21:19:22.262349 22252 net.cpp:148] Top shape: 1 1 1 (1)
I0913 21:19:22.262353 22252 net.cpp:156] Memory required for data: 20408
I0913 21:19:22.262357 22252 layer_factory.hpp:77] Creating layer embedding
I0913 21:19:22.262368 22252 net.cpp:91] Creating Layer embedding
I0913 21:19:22.262373 22252 net.cpp:425] embedding <- input_sentence
I0913 21:19:22.262383 22252 net.cpp:399] embedding -> embedded_input_sentence
I0913 21:19:22.329289 22262 net.cpp:141] Setting up fc7
I0913 21:19:22.329341 22262 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:19:22.329350 22262 net.cpp:156] Memory required for data: 68273720
I0913 21:19:22.329372 22262 layer_factory.hpp:77] Creating layer relu7
I0913 21:19:22.329402 22262 net.cpp:91] Creating Layer relu7
I0913 21:19:22.329414 22262 net.cpp:425] relu7 <- fc7
I0913 21:19:22.329433 22262 net.cpp:386] relu7 -> fc7 (in-place)
I0913 21:19:22.330268 22262 net.cpp:141] Setting up relu7
I0913 21:19:22.330289 22262 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:19:22.330298 22262 net.cpp:156] Memory required for data: 68437560
I0913 21:19:22.330307 22262 layer_factory.hpp:77] Creating layer drop7
I0913 21:19:22.330328 22262 net.cpp:91] Creating Layer drop7
I0913 21:19:22.330339 22262 net.cpp:425] drop7 <- fc7
I0913 21:19:22.330356 22262 net.cpp:386] drop7 -> fc7 (in-place)
I0913 21:19:22.330415 22262 net.cpp:141] Setting up drop7
I0913 21:19:22.330430 22262 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:19:22.330440 22262 net.cpp:156] Memory required for data: 68601400
I0913 21:19:22.330448 22262 layer_factory.hpp:77] Creating layer fc8
I0913 21:19:22.330471 22262 net.cpp:91] Creating Layer fc8
I0913 21:19:22.330483 22262 net.cpp:425] fc8 <- fc7
I0913 21:19:22.330497 22262 net.cpp:399] fc8 -> fc8
I0913 21:19:22.346634 22262 net.cpp:141] Setting up fc8
I0913 21:19:22.346694 22262 net.cpp:148] Top shape: 10 1000 (10000)
I0913 21:19:22.346702 22262 net.cpp:156] Memory required for data: 68641400
I0913 21:19:22.346724 22262 layer_factory.hpp:77] Creating layer prob
I0913 21:19:22.346743 22262 net.cpp:91] Creating Layer prob
I0913 21:19:22.346753 22262 net.cpp:425] prob <- fc8
I0913 21:19:22.346787 22262 net.cpp:399] prob -> prob
I0913 21:19:22.347403 22262 net.cpp:141] Setting up prob
I0913 21:19:22.347417 22262 net.cpp:148] Top shape: 10 1000 (10000)
I0913 21:19:22.347424 22262 net.cpp:156] Memory required for data: 68681400
I0913 21:19:22.347431 22262 net.cpp:219] prob does not need backward computation.
I0913 21:19:22.347439 22262 net.cpp:219] fc8 does not need backward computation.
I0913 21:19:22.347445 22262 net.cpp:219] drop7 does not need backward computation.
I0913 21:19:22.347451 22262 net.cpp:219] relu7 does not need backward computation.
I0913 21:19:22.347457 22262 net.cpp:219] fc7 does not need backward computation.
I0913 21:19:22.347465 22262 net.cpp:219] drop6 does not need backward computation.
I0913 21:19:22.347470 22262 net.cpp:219] relu6 does not need backward computation.
I0913 21:19:22.347477 22262 net.cpp:219] fc6 does not need backward computation.
I0913 21:19:22.347484 22262 net.cpp:219] pool5 does not need backward computation.
I0913 21:19:22.347491 22262 net.cpp:219] relu5 does not need backward computation.
I0913 21:19:22.347496 22262 net.cpp:219] conv5 does not need backward computation.
I0913 21:19:22.347503 22262 net.cpp:219] relu4 does not need backward computation.
I0913 21:19:22.347509 22262 net.cpp:219] conv4 does not need backward computation.
I0913 21:19:22.347517 22262 net.cpp:219] relu3 does not need backward computation.
I0913 21:19:22.347522 22262 net.cpp:219] conv3 does not need backward computation.
I0913 21:19:22.347529 22262 net.cpp:219] norm2 does not need backward computation.
I0913 21:19:22.347537 22262 net.cpp:219] pool2 does not need backward computation.
I0913 21:19:22.347543 22262 net.cpp:219] relu2 does not need backward computation.
I0913 21:19:22.347548 22262 net.cpp:219] conv2 does not need backward computation.
I0913 21:19:22.347555 22262 net.cpp:219] norm1 does not need backward computation.
I0913 21:19:22.347561 22262 net.cpp:219] pool1 does not need backward computation.
I0913 21:19:22.347568 22262 net.cpp:219] relu1 does not need backward computation.
I0913 21:19:22.347574 22262 net.cpp:219] conv1 does not need backward computation.
I0913 21:19:22.347580 22262 net.cpp:219] data does not need backward computation.
I0913 21:19:22.347586 22262 net.cpp:261] This network produces output prob
I0913 21:19:22.347615 22262 net.cpp:274] Network initialization done.
I0913 21:19:22.509954 22252 net.cpp:141] Setting up embedding
I0913 21:19:22.510007 22252 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:19:22.510013 22252 net.cpp:156] Memory required for data: 22408
I0913 21:19:22.510032 22252 layer_factory.hpp:77] Creating layer lstm1
I0913 21:19:22.510056 22252 net.cpp:91] Creating Layer lstm1
I0913 21:19:22.510062 22252 net.cpp:425] lstm1 <- embedded_input_frames
I0913 21:19:22.510074 22252 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0913 21:19:22.510084 22252 net.cpp:399] lstm1 -> lstm1
I0913 21:19:22.510113 22252 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0913 21:19:22.510504 22252 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0913 21:19:22.510596 22252 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:19:22.510608 22252 net.cpp:91] Creating Layer lstm1_
I0913 21:19:22.510614 22252 net.cpp:399] lstm1_ -> x
I0913 21:19:22.510625 22252 net.cpp:399] lstm1_ -> cont
I0913 21:19:22.510685 22252 net.cpp:141] Setting up lstm1_
I0913 21:19:22.510694 22252 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:19:22.510700 22252 net.cpp:148] Top shape: 1 1 (1)
I0913 21:19:22.510704 22252 net.cpp:156] Memory required for data: 2004
I0913 21:19:22.510710 22252 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:19:22.510720 22252 net.cpp:91] Creating Layer lstm1_
I0913 21:19:22.510726 22252 net.cpp:399] lstm1_ -> c_0
I0913 21:19:22.510735 22252 net.cpp:399] lstm1_ -> h_0
I0913 21:19:22.510787 22252 net.cpp:141] Setting up lstm1_
I0913 21:19:22.510795 22252 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:19:22.510802 22252 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:19:22.510805 22252 net.cpp:156] Memory required for data: 10004
I0913 21:19:22.510809 22252 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0913 21:19:22.510818 22252 net.cpp:91] Creating Layer lstm1_cont_slice
I0913 21:19:22.510823 22252 net.cpp:425] lstm1_cont_slice <- cont
I0913 21:19:22.510831 22252 net.cpp:399] lstm1_cont_slice -> cont_1
I0913 21:19:22.510865 22252 net.cpp:141] Setting up lstm1_cont_slice
I0913 21:19:22.510874 22252 net.cpp:148] Top shape: 1 1 (1)
I0913 21:19:22.510879 22252 net.cpp:156] Memory required for data: 10008
I0913 21:19:22.510882 22252 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0913 21:19:22.510892 22252 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0913 21:19:22.510896 22252 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0913 21:19:22.510903 22252 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0913 21:19:22.510913 22252 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0913 21:19:22.510957 22252 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0913 21:19:22.510965 22252 net.cpp:148] Top shape: 1 1 (1)
I0913 21:19:22.510970 22252 net.cpp:148] Top shape: 1 1 (1)
I0913 21:19:22.510974 22252 net.cpp:156] Memory required for data: 10016
I0913 21:19:22.510978 22252 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0913 21:19:22.510988 22252 net.cpp:91] Creating Layer lstm1_x_transform
I0913 21:19:22.510993 22252 net.cpp:425] lstm1_x_transform <- x
I0913 21:19:22.511003 22252 net.cpp:399] lstm1_x_transform -> W_xc_x
I0913 21:19:22.531937 22252 net.cpp:141] Setting up lstm1_x_transform
I0913 21:19:22.531992 22252 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:19:22.531998 22252 net.cpp:156] Memory required for data: 26016
I0913 21:19:22.532026 22252 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0913 21:19:22.532044 22252 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0913 21:19:22.532052 22252 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0913 21:19:22.532060 22252 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0913 21:19:22.532126 22252 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0913 21:19:22.532136 22252 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:19:22.532140 22252 net.cpp:156] Memory required for data: 42016
I0913 21:19:22.532145 22252 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0913 21:19:22.532160 22252 net.cpp:91] Creating Layer lstm1_h_conted_0
I0913 21:19:22.532166 22252 net.cpp:425] lstm1_h_conted_0 <- h_0
I0913 21:19:22.532171 22252 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0913 21:19:22.532178 22252 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0913 21:19:22.532281 22252 net.cpp:141] Setting up lstm1_h_conted_0
I0913 21:19:22.532290 22252 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:19:22.532294 22252 net.cpp:156] Memory required for data: 46016
I0913 21:19:22.532299 22252 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0913 21:19:22.532312 22252 net.cpp:91] Creating Layer lstm1_transform_1
I0913 21:19:22.532317 22252 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0913 21:19:22.532325 22252 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0913 21:19:22.572021 22252 net.cpp:141] Setting up lstm1_transform_1
I0913 21:19:22.572079 22252 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:19:22.572087 22252 net.cpp:156] Memory required for data: 62016
I0913 21:19:22.572108 22252 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0913 21:19:22.572132 22252 net.cpp:91] Creating Layer lstm1_gate_input_1
I0913 21:19:22.572140 22252 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0913 21:19:22.572149 22252 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0913 21:19:22.572156 22252 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0913 21:19:22.572212 22252 net.cpp:141] Setting up lstm1_gate_input_1
I0913 21:19:22.572221 22252 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:19:22.572226 22252 net.cpp:156] Memory required for data: 78016
I0913 21:19:22.572230 22252 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0913 21:19:22.572239 22252 net.cpp:91] Creating Layer lstm1_unit_1
I0913 21:19:22.572243 22252 net.cpp:425] lstm1_unit_1 <- c_0
I0913 21:19:22.572248 22252 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0913 21:19:22.572253 22252 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0913 21:19:22.572260 22252 net.cpp:399] lstm1_unit_1 -> c_1
I0913 21:19:22.572268 22252 net.cpp:399] lstm1_unit_1 -> h_1
I0913 21:19:22.572327 22252 net.cpp:141] Setting up lstm1_unit_1
I0913 21:19:22.572336 22252 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:19:22.572342 22252 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:19:22.572346 22252 net.cpp:156] Memory required for data: 86016
I0913 21:19:22.572350 22252 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:19:22.572361 22252 net.cpp:91] Creating Layer lstm1_
I0913 21:19:22.572366 22252 net.cpp:425] lstm1_ <- c_1
I0913 21:19:22.572372 22252 net.cpp:399] lstm1_ -> c_T
I0913 21:19:22.572402 22252 net.cpp:141] Setting up lstm1_
I0913 21:19:22.572409 22252 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:19:22.572413 22252 net.cpp:156] Memory required for data: 90016
I0913 21:19:22.572418 22252 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0913 21:19:22.572427 22252 net.cpp:91] Creating Layer lstm1_h_concat
I0913 21:19:22.572432 22252 net.cpp:425] lstm1_h_concat <- h_1
I0913 21:19:22.572441 22252 net.cpp:399] lstm1_h_concat -> h
I0913 21:19:22.572485 22252 net.cpp:141] Setting up lstm1_h_concat
I0913 21:19:22.572494 22252 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:19:22.572497 22252 net.cpp:156] Memory required for data: 94016
I0913 21:19:22.572502 22252 layer_factory.hpp:77] Creating layer h_pseudoloss
I0913 21:19:22.572520 22252 net.cpp:91] Creating Layer h_pseudoloss
I0913 21:19:22.572525 22252 net.cpp:425] h_pseudoloss <- h
I0913 21:19:22.572540 22252 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0913 21:19:22.572629 22252 net.cpp:141] Setting up h_pseudoloss
I0913 21:19:22.572645 22252 net.cpp:148] Top shape: (1)
I0913 21:19:22.572652 22252 net.cpp:151]     with loss weight 1
I0913 21:19:22.572690 22252 net.cpp:156] Memory required for data: 94020
I0913 21:19:22.572695 22252 net.cpp:217] h_pseudoloss needs backward computation.
I0913 21:19:22.572700 22252 net.cpp:217] lstm1_h_concat needs backward computation.
I0913 21:19:22.572705 22252 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:19:22.572710 22252 net.cpp:217] lstm1_unit_1 needs backward computation.
I0913 21:19:22.572715 22252 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0913 21:19:22.572720 22252 net.cpp:217] lstm1_transform_1 needs backward computation.
I0913 21:19:22.572724 22252 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0913 21:19:22.572729 22252 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0913 21:19:22.572738 22252 net.cpp:217] lstm1_x_transform needs backward computation.
I0913 21:19:22.572743 22252 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0913 21:19:22.572748 22252 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0913 21:19:22.572753 22252 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:19:22.572757 22252 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:19:22.572762 22252 net.cpp:261] This network produces output c_T
I0913 21:19:22.572765 22252 net.cpp:261] This network produces output h_pseudoloss
I0913 21:19:22.572779 22252 net.cpp:274] Network initialization done.
I0913 21:19:22.572836 22252 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0913 21:19:22.572842 22252 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0913 21:19:22.572846 22252 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0913 21:19:22.572960 22252 net.cpp:141] Setting up lstm1
I0913 21:19:22.572973 22252 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:19:22.572978 22252 net.cpp:156] Memory required for data: 26408
I0913 21:19:22.572990 22252 layer_factory.hpp:77] Creating layer concat
I0913 21:19:22.572999 22252 net.cpp:91] Creating Layer concat
I0913 21:19:22.573006 22252 net.cpp:425] concat <- lstm1
I0913 21:19:22.573014 22252 net.cpp:425] concat <- embedded_input_sentence
I0913 21:19:22.573019 22252 net.cpp:425] concat <- reshaped_stage_indicator
I0913 21:19:22.573024 22252 net.cpp:399] concat -> lstm1_video_sequence
I0913 21:19:22.573056 22252 net.cpp:141] Setting up concat
I0913 21:19:22.573065 22252 net.cpp:148] Top shape: 1 1 1501 (1501)
I0913 21:19:22.573068 22252 net.cpp:156] Memory required for data: 32412
I0913 21:19:22.573073 22252 layer_factory.hpp:77] Creating layer lstm2
I0913 21:19:22.573086 22252 net.cpp:91] Creating Layer lstm2
I0913 21:19:22.573091 22252 net.cpp:425] lstm2 <- lstm1_video_sequence
I0913 21:19:22.573096 22252 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0913 21:19:22.573102 22252 net.cpp:399] lstm2 -> lstm2
I0913 21:19:22.573112 22252 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0913 21:19:22.573377 22252 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0913 21:19:22.573464 22252 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:19:22.573475 22252 net.cpp:91] Creating Layer lstm2_
I0913 21:19:22.573482 22252 net.cpp:399] lstm2_ -> x
I0913 21:19:22.573492 22252 net.cpp:399] lstm2_ -> cont
I0913 21:19:22.573549 22252 net.cpp:141] Setting up lstm2_
I0913 21:19:22.573559 22252 net.cpp:148] Top shape: 1 1 1501 (1501)
I0913 21:19:22.573565 22252 net.cpp:148] Top shape: 1 1 (1)
I0913 21:19:22.573568 22252 net.cpp:156] Memory required for data: 6008
I0913 21:19:22.573573 22252 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:19:22.573581 22252 net.cpp:91] Creating Layer lstm2_
I0913 21:19:22.573590 22252 net.cpp:399] lstm2_ -> c_0
I0913 21:19:22.573598 22252 net.cpp:399] lstm2_ -> h_0
I0913 21:19:22.573648 22252 net.cpp:141] Setting up lstm2_
I0913 21:19:22.573657 22252 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:19:22.573662 22252 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:19:22.573665 22252 net.cpp:156] Memory required for data: 14008
I0913 21:19:22.573670 22252 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0913 21:19:22.573678 22252 net.cpp:91] Creating Layer lstm2_cont_slice
I0913 21:19:22.573683 22252 net.cpp:425] lstm2_cont_slice <- cont
I0913 21:19:22.573689 22252 net.cpp:399] lstm2_cont_slice -> cont_1
I0913 21:19:22.573725 22252 net.cpp:141] Setting up lstm2_cont_slice
I0913 21:19:22.573734 22252 net.cpp:148] Top shape: 1 1 (1)
I0913 21:19:22.573741 22252 net.cpp:156] Memory required for data: 14012
I0913 21:19:22.573745 22252 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0913 21:19:22.573752 22252 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0913 21:19:22.573757 22252 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0913 21:19:22.573763 22252 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0913 21:19:22.573770 22252 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0913 21:19:22.573814 22252 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0913 21:19:22.573823 22252 net.cpp:148] Top shape: 1 1 (1)
I0913 21:19:22.573828 22252 net.cpp:148] Top shape: 1 1 (1)
I0913 21:19:22.573832 22252 net.cpp:156] Memory required for data: 14020
I0913 21:19:22.573837 22252 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0913 21:19:22.573848 22252 net.cpp:91] Creating Layer lstm2_x_transform
I0913 21:19:22.573853 22252 net.cpp:425] lstm2_x_transform <- x
I0913 21:19:22.573859 22252 net.cpp:399] lstm2_x_transform -> W_xc_x
I0913 21:19:22.583712 22262 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /home/peifeng/work/run/storm102/data/workers/064bc5ad-656e-498e-81db-fb51a99eaa85/tmp/cvld5311359139217322975/bvlc_reference_caffenet.caffemodel
I0913 21:19:22.583770 22262 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0913 21:19:22.583775 22262 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0913 21:19:22.583780 22262 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /home/peifeng/work/run/storm102/data/workers/064bc5ad-656e-498e-81db-fb51a99eaa85/tmp/cvld5311359139217322975/bvlc_reference_caffenet.caffemodel
I0913 21:19:22.635346 22252 net.cpp:141] Setting up lstm2_x_transform
I0913 21:19:22.635397 22252 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:19:22.635403 22252 net.cpp:156] Memory required for data: 30020
I0913 21:19:22.635426 22252 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0913 21:19:22.635442 22252 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0913 21:19:22.635449 22252 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0913 21:19:22.635463 22252 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0913 21:19:22.635509 22252 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0913 21:19:22.635517 22252 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:19:22.635521 22252 net.cpp:156] Memory required for data: 46020
I0913 21:19:22.635526 22252 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0913 21:19:22.635536 22252 net.cpp:91] Creating Layer lstm2_h_conted_0
I0913 21:19:22.635541 22252 net.cpp:425] lstm2_h_conted_0 <- h_0
I0913 21:19:22.635547 22252 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0913 21:19:22.635556 22252 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0913 21:19:22.635644 22252 net.cpp:141] Setting up lstm2_h_conted_0
I0913 21:19:22.635653 22252 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:19:22.635658 22252 net.cpp:156] Memory required for data: 50020
I0913 21:19:22.635663 22252 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0913 21:19:22.635677 22252 net.cpp:91] Creating Layer lstm2_transform_1
I0913 21:19:22.635682 22252 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0913 21:19:22.635690 22252 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0913 21:19:22.676292 22252 net.cpp:141] Setting up lstm2_transform_1
I0913 21:19:22.676350 22252 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:19:22.676357 22252 net.cpp:156] Memory required for data: 66020
I0913 21:19:22.676378 22252 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0913 21:19:22.676403 22252 net.cpp:91] Creating Layer lstm2_gate_input_1
I0913 21:19:22.676409 22252 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0913 21:19:22.676417 22252 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0913 21:19:22.676425 22252 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0913 21:19:22.676475 22252 net.cpp:141] Setting up lstm2_gate_input_1
I0913 21:19:22.676483 22252 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:19:22.676487 22252 net.cpp:156] Memory required for data: 82020
I0913 21:19:22.676491 22252 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0913 21:19:22.676503 22252 net.cpp:91] Creating Layer lstm2_unit_1
I0913 21:19:22.676508 22252 net.cpp:425] lstm2_unit_1 <- c_0
I0913 21:19:22.676514 22252 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0913 21:19:22.676519 22252 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0913 21:19:22.676525 22252 net.cpp:399] lstm2_unit_1 -> c_1
I0913 21:19:22.676533 22252 net.cpp:399] lstm2_unit_1 -> h_1
I0913 21:19:22.676594 22252 net.cpp:141] Setting up lstm2_unit_1
I0913 21:19:22.676604 22252 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:19:22.676609 22252 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:19:22.676614 22252 net.cpp:156] Memory required for data: 90020
I0913 21:19:22.676617 22252 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:19:22.676625 22252 net.cpp:91] Creating Layer lstm2_
I0913 21:19:22.676630 22252 net.cpp:425] lstm2_ <- c_1
I0913 21:19:22.676636 22252 net.cpp:399] lstm2_ -> c_T
I0913 21:19:22.676667 22252 net.cpp:141] Setting up lstm2_
I0913 21:19:22.676676 22252 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:19:22.676681 22252 net.cpp:156] Memory required for data: 94020
I0913 21:19:22.676684 22252 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0913 21:19:22.676694 22252 net.cpp:91] Creating Layer lstm2_h_concat
I0913 21:19:22.676698 22252 net.cpp:425] lstm2_h_concat <- h_1
I0913 21:19:22.676705 22252 net.cpp:399] lstm2_h_concat -> h
I0913 21:19:22.676741 22252 net.cpp:141] Setting up lstm2_h_concat
I0913 21:19:22.676749 22252 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:19:22.676753 22252 net.cpp:156] Memory required for data: 98020
I0913 21:19:22.676759 22252 layer_factory.hpp:77] Creating layer h_pseudoloss
I0913 21:19:22.676767 22252 net.cpp:91] Creating Layer h_pseudoloss
I0913 21:19:22.676771 22252 net.cpp:425] h_pseudoloss <- h
I0913 21:19:22.676779 22252 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0913 21:19:22.676862 22252 net.cpp:141] Setting up h_pseudoloss
I0913 21:19:22.676870 22252 net.cpp:148] Top shape: (1)
I0913 21:19:22.676874 22252 net.cpp:151]     with loss weight 1
I0913 21:19:22.676895 22252 net.cpp:156] Memory required for data: 98024
I0913 21:19:22.676900 22252 net.cpp:217] h_pseudoloss needs backward computation.
I0913 21:19:22.676905 22252 net.cpp:217] lstm2_h_concat needs backward computation.
I0913 21:19:22.676909 22252 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:19:22.676914 22252 net.cpp:217] lstm2_unit_1 needs backward computation.
I0913 21:19:22.676919 22252 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0913 21:19:22.676924 22252 net.cpp:217] lstm2_transform_1 needs backward computation.
I0913 21:19:22.676931 22252 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0913 21:19:22.676937 22252 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0913 21:19:22.676941 22252 net.cpp:217] lstm2_x_transform needs backward computation.
I0913 21:19:22.676946 22252 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0913 21:19:22.676951 22252 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0913 21:19:22.676956 22252 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:19:22.676960 22252 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:19:22.676964 22252 net.cpp:261] This network produces output c_T
I0913 21:19:22.676969 22252 net.cpp:261] This network produces output h_pseudoloss
I0913 21:19:22.676982 22252 net.cpp:274] Network initialization done.
I0913 21:19:22.677031 22252 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0913 21:19:22.677038 22252 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0913 21:19:22.677042 22252 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0913 21:19:22.677144 22252 net.cpp:141] Setting up lstm2
I0913 21:19:22.677155 22252 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:19:22.677160 22252 net.cpp:156] Memory required for data: 36412
I0913 21:19:22.677173 22252 layer_factory.hpp:77] Creating layer predict
I0913 21:19:22.677186 22252 net.cpp:91] Creating Layer predict
I0913 21:19:22.677193 22252 net.cpp:425] predict <- lstm2
I0913 21:19:22.677201 22252 net.cpp:399] predict -> predict
I0913 21:19:23.012451 22262 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0913 21:19:23.061054 22262 net.cpp:752] Ignoring source layer loss
Loading the model + trained: 12215.8ms
Using cv::Size and some other stuff: 0.458ms
I0913 21:19:23.117877 22252 net.cpp:141] Setting up predict
I0913 21:19:23.117941 22252 net.cpp:148] Top shape: 1 1 46168 (46168)
I0913 21:19:23.117952 22252 net.cpp:156] Memory required for data: 221084
I0913 21:19:23.117974 22252 layer_factory.hpp:77] Creating layer probs
I0913 21:19:23.117998 22252 net.cpp:91] Creating Layer probs
I0913 21:19:23.118010 22252 net.cpp:425] probs <- predict
I0913 21:19:23.118027 22252 net.cpp:399] probs -> probs
I0913 21:19:23.119402 22252 net.cpp:141] Setting up probs
I0913 21:19:23.119432 22252 net.cpp:148] Top shape: 1 1 46168 (46168)
I0913 21:19:23.119441 22252 net.cpp:156] Memory required for data: 405756
I0913 21:19:23.119451 22252 net.cpp:219] probs does not need backward computation.
I0913 21:19:23.119459 22252 net.cpp:219] predict does not need backward computation.
I0913 21:19:23.119469 22252 net.cpp:219] lstm2 does not need backward computation.
I0913 21:19:23.119479 22252 net.cpp:219] concat does not need backward computation.
I0913 21:19:23.119489 22252 net.cpp:219] lstm1 does not need backward computation.
I0913 21:19:23.119500 22252 net.cpp:219] embedding does not need backward computation.
I0913 21:19:23.119508 22252 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0913 21:19:23.119518 22252 net.cpp:219] reshape_frames does not need backward computation.
I0913 21:19:23.119526 22252 net.cpp:219] embed_encoder does not need backward computation.
I0913 21:19:23.119535 22252 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0913 21:19:23.119544 22252 net.cpp:219] input does not need backward computation.
I0913 21:19:23.119551 22252 net.cpp:261] This network produces output probs
I0913 21:19:23.119591 22252 net.cpp:274] Network initialization done.
Loading the mean file: 1378.4ms
I0913 21:19:23.572878 22252 net.cpp:752] Ignoring source layer data
I0913 21:19:23.572921 22252 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0913 21:19:23.572926 22252 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0913 21:19:23.656042 22252 net.cpp:752] Ignoring source layer cross_entropy_loss
TIMERTIMER 138678687
TIMERTIMER 68846152
TIMERTIMER 69453494
TIMERTIMER 48424931
TIMERTIMER 48904844
TIMERTIMER 43546385
TIMERTIMER 44020658
TIMERTIMER 44078956
TIMERTIMER 43032101
TIMERTIMER 48487219
TIMERTIMER 43192666
TIMERTIMER 48607056
TIMERTIMER 49295709
TIMERTIMER 48858310
TIMERTIMER 47033748
TIMERTIMER 43976638
TIMERTIMER 49524826
TIMERTIMER 46154860
TIMERTIMER 43734086
TIMERTIMER 31452808
TIMERTIMER 31577827
TIMERTIMER 31465903
TIMERTIMER 31306409
TIMERTIMER 32041400
TIMERTIMER 31735725
TIMERTIMER 32825685
TIMERTIMER 33335146
TIMERTIMER 32314368
TIMERTIMER 31779333
TIMERTIMER 31657543
TIMERTIMER 38395267
TIMERTIMER 31871935
TIMERTIMER 31923129
TIMERTIMER 32294114
TIMERTIMER 38102395
TIMERTIMER 32148678
TIMERTIMER 31663105
TIMERTIMER 38246325
TIMERTIMER 32622983
TIMERTIMER 32423363
TIMERTIMER 32794619
TIMERTIMER 32072332
TIMERTIMER 39045791
TIMERTIMER 38218284
TIMERTIMER 32358106
TIMERTIMER 32092993
TIMERTIMER 32842542
TIMERTIMER 32648389
TIMERTIMER 38392010
TIMERTIMER 38355139
TIMERTIMER 32350996
TIMERTIMER 32876148
TIMERTIMER 38056695
TIMERTIMER 31627660
TIMERTIMER 36650485
TIMERTIMER 37976614
TIMERTIMER 38754601
TIMERTIMER 37794956
TIMERTIMER 38797442
TIMERTIMER 31653356
TIMERTIMER 31674398
TIMERTIMER 31426924
TIMERTIMER 37598541
TIMERTIMER 37826258
TIMERTIMER 37288265
TIMERTIMER 32073688
TIMERTIMER 35878225
TIMERTIMER 31147175
TIMERTIMER 41322922
TIMERTIMER 31194703
TIMERTIMER 37155646
TIMERTIMER 37368967
TIMERTIMER 31238425
TIMERTIMER 37383927
TIMERTIMER 44848237
TIMERTIMER 37926214
TIMERTIMER 37333299
TIMERTIMER 31225897
TIMERTIMER 32017651
TIMERTIMER 31443003
TIMERTIMER 31264177
TIMERTIMER 40762631
TIMERTIMER 31195148
TIMERTIMER 35018300
TIMERTIMER 37388041
TIMERTIMER 43922947
TIMERTIMER 32037437
TIMERTIMER 36771468
TIMERTIMER 34438010
#
# A fatal error has been detected by the Java Runtime Environment:
#
#  SIGSEGV (0xb) at pc=0x00007f5886c30ee0, pid=22185, tid=140016944232192
#
# JRE version: Java(TM) SE Runtime Environment (8.0_77-b03) (build 1.8.0_77-b03)
# Java VM: Java HotSpot(TM) 64-Bit Server VM (25.77-b03 mixed mode linux-amd64 compressed oops)
# Problematic frame:
# C  [libc.so.6+0x97ee0]
#
# Failed to write core dump. Core dumps have been disabled. To enable core dumping, try "ulimit -c unlimited" before starting Java again
#
# An error report file with more information is saved as:
# /home/peifeng/work/run/storm102/data/workers/064bc5ad-656e-498e-81db-fb51a99eaa85/hs_err_pid22185.log
#
# If you would like to submit a bug report, please visit:
#   http://bugreport.java.com/bugreport/crash.jsp
# The crash happened outside the Java Virtual Machine in native code.
# See problematic frame for where to report the bug.
#
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/peifeng/tools/storm102/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/peifeng/work/run/storm102/data/supervisor/stormdist/captioning-1-1473815922/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /home/peifeng/work/run/storm102/data/workers/9cc78d8c-90ee-4e63-95a8-5651ab7cac57/tmp/cvld3057566666840304819/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0913 21:20:28.742410 22417 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0913 21:20:28.742607 22417 layer_factory.hpp:77] Creating layer data
I0913 21:20:28.742633 22417 net.cpp:91] Creating Layer data
I0913 21:20:28.742643 22417 net.cpp:399] data -> data
I0913 21:20:29.250514 22417 net.cpp:141] Setting up data
I0913 21:20:29.250648 22417 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0913 21:20:29.250656 22417 net.cpp:156] Memory required for data: 6183480
I0913 21:20:29.250675 22417 layer_factory.hpp:77] Creating layer conv1
I0913 21:20:29.250712 22417 net.cpp:91] Creating Layer conv1
I0913 21:20:29.250722 22417 net.cpp:425] conv1 <- data
I0913 21:20:29.250737 22417 net.cpp:399] conv1 -> conv1
I0913 21:20:29.436377 22417 net.cpp:141] Setting up conv1
I0913 21:20:29.436426 22417 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0913 21:20:29.436434 22417 net.cpp:156] Memory required for data: 17799480
I0913 21:20:29.436463 22417 layer_factory.hpp:77] Creating layer relu1
I0913 21:20:29.436486 22417 net.cpp:91] Creating Layer relu1
I0913 21:20:29.436492 22417 net.cpp:425] relu1 <- conv1
I0913 21:20:29.436499 22417 net.cpp:386] relu1 -> conv1 (in-place)
I0913 21:20:29.436899 22417 net.cpp:141] Setting up relu1
I0913 21:20:29.436913 22417 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0913 21:20:29.436918 22417 net.cpp:156] Memory required for data: 29415480
I0913 21:20:29.436923 22417 layer_factory.hpp:77] Creating layer pool1
I0913 21:20:29.436939 22417 net.cpp:91] Creating Layer pool1
I0913 21:20:29.436944 22417 net.cpp:425] pool1 <- conv1
I0913 21:20:29.436951 22417 net.cpp:399] pool1 -> pool1
I0913 21:20:29.437029 22417 net.cpp:141] Setting up pool1
I0913 21:20:29.437039 22417 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0913 21:20:29.437044 22417 net.cpp:156] Memory required for data: 32214840
I0913 21:20:29.437048 22417 layer_factory.hpp:77] Creating layer norm1
I0913 21:20:29.437068 22417 net.cpp:91] Creating Layer norm1
I0913 21:20:29.437074 22417 net.cpp:425] norm1 <- pool1
I0913 21:20:29.437082 22417 net.cpp:399] norm1 -> norm1
I0913 21:20:29.437343 22417 net.cpp:141] Setting up norm1
I0913 21:20:29.437355 22417 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0913 21:20:29.437361 22417 net.cpp:156] Memory required for data: 35014200
I0913 21:20:29.437366 22417 layer_factory.hpp:77] Creating layer conv2
I0913 21:20:29.437382 22417 net.cpp:91] Creating Layer conv2
I0913 21:20:29.437388 22417 net.cpp:425] conv2 <- norm1
I0913 21:20:29.437394 22417 net.cpp:399] conv2 -> conv2
I0913 21:20:29.441216 22417 net.cpp:141] Setting up conv2
I0913 21:20:29.441237 22417 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0913 21:20:29.441243 22417 net.cpp:156] Memory required for data: 42479160
I0913 21:20:29.441256 22417 layer_factory.hpp:77] Creating layer relu2
I0913 21:20:29.441264 22417 net.cpp:91] Creating Layer relu2
I0913 21:20:29.441269 22417 net.cpp:425] relu2 <- conv2
I0913 21:20:29.441279 22417 net.cpp:386] relu2 -> conv2 (in-place)
I0913 21:20:29.441676 22417 net.cpp:141] Setting up relu2
I0913 21:20:29.441689 22417 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0913 21:20:29.441694 22417 net.cpp:156] Memory required for data: 49944120
I0913 21:20:29.441699 22417 layer_factory.hpp:77] Creating layer pool2
I0913 21:20:29.441711 22417 net.cpp:91] Creating Layer pool2
I0913 21:20:29.441716 22417 net.cpp:425] pool2 <- conv2
I0913 21:20:29.441723 22417 net.cpp:399] pool2 -> pool2
I0913 21:20:29.441777 22417 net.cpp:141] Setting up pool2
I0913 21:20:29.441787 22417 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:20:29.441790 22417 net.cpp:156] Memory required for data: 51674680
I0913 21:20:29.441795 22417 layer_factory.hpp:77] Creating layer norm2
I0913 21:20:29.441807 22417 net.cpp:91] Creating Layer norm2
I0913 21:20:29.441812 22417 net.cpp:425] norm2 <- pool2
I0913 21:20:29.441817 22417 net.cpp:399] norm2 -> norm2
I0913 21:20:29.442065 22417 net.cpp:141] Setting up norm2
I0913 21:20:29.442076 22417 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:20:29.442080 22417 net.cpp:156] Memory required for data: 53405240
I0913 21:20:29.442085 22417 layer_factory.hpp:77] Creating layer conv3
I0913 21:20:29.442097 22417 net.cpp:91] Creating Layer conv3
I0913 21:20:29.442102 22417 net.cpp:425] conv3 <- norm2
I0913 21:20:29.442109 22417 net.cpp:399] conv3 -> conv3
I0913 21:20:29.445626 22417 net.cpp:141] Setting up conv3
I0913 21:20:29.445650 22417 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:20:29.445657 22417 net.cpp:156] Memory required for data: 56001080
I0913 21:20:29.445670 22417 layer_factory.hpp:77] Creating layer relu3
I0913 21:20:29.445678 22417 net.cpp:91] Creating Layer relu3
I0913 21:20:29.445684 22417 net.cpp:425] relu3 <- conv3
I0913 21:20:29.445694 22417 net.cpp:386] relu3 -> conv3 (in-place)
I0913 21:20:29.445911 22417 net.cpp:141] Setting up relu3
I0913 21:20:29.445924 22417 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:20:29.445930 22417 net.cpp:156] Memory required for data: 58596920
I0913 21:20:29.445935 22417 layer_factory.hpp:77] Creating layer conv4
I0913 21:20:29.445945 22417 net.cpp:91] Creating Layer conv4
I0913 21:20:29.445950 22417 net.cpp:425] conv4 <- conv3
I0913 21:20:29.445960 22417 net.cpp:399] conv4 -> conv4
I0913 21:20:29.449964 22417 net.cpp:141] Setting up conv4
I0913 21:20:29.449991 22417 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:20:29.449997 22417 net.cpp:156] Memory required for data: 61192760
I0913 21:20:29.450006 22417 layer_factory.hpp:77] Creating layer relu4
I0913 21:20:29.450016 22417 net.cpp:91] Creating Layer relu4
I0913 21:20:29.450021 22417 net.cpp:425] relu4 <- conv4
I0913 21:20:29.450029 22417 net.cpp:386] relu4 -> conv4 (in-place)
I0913 21:20:29.450423 22417 net.cpp:141] Setting up relu4
I0913 21:20:29.450435 22417 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:20:29.450439 22417 net.cpp:156] Memory required for data: 63788600
I0913 21:20:29.450444 22417 layer_factory.hpp:77] Creating layer conv5
I0913 21:20:29.450460 22417 net.cpp:91] Creating Layer conv5
I0913 21:20:29.450465 22417 net.cpp:425] conv5 <- conv4
I0913 21:20:29.450474 22417 net.cpp:399] conv5 -> conv5
I0913 21:20:29.454198 22417 net.cpp:141] Setting up conv5
I0913 21:20:29.454219 22417 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:20:29.454226 22417 net.cpp:156] Memory required for data: 65519160
I0913 21:20:29.454239 22417 layer_factory.hpp:77] Creating layer relu5
I0913 21:20:29.454248 22417 net.cpp:91] Creating Layer relu5
I0913 21:20:29.454253 22417 net.cpp:425] relu5 <- conv5
I0913 21:20:29.454259 22417 net.cpp:386] relu5 -> conv5 (in-place)
I0913 21:20:29.454659 22417 net.cpp:141] Setting up relu5
I0913 21:20:29.454673 22417 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:20:29.454676 22417 net.cpp:156] Memory required for data: 67249720
I0913 21:20:29.454682 22417 layer_factory.hpp:77] Creating layer pool5
I0913 21:20:29.454692 22417 net.cpp:91] Creating Layer pool5
I0913 21:20:29.454697 22417 net.cpp:425] pool5 <- conv5
I0913 21:20:29.454707 22417 net.cpp:399] pool5 -> pool5
I0913 21:20:29.454763 22417 net.cpp:141] Setting up pool5
I0913 21:20:29.454772 22417 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0913 21:20:29.454777 22417 net.cpp:156] Memory required for data: 67618360
I0913 21:20:29.454782 22417 layer_factory.hpp:77] Creating layer fc6
I0913 21:20:29.454808 22417 net.cpp:91] Creating Layer fc6
I0913 21:20:29.454814 22417 net.cpp:425] fc6 <- pool5
I0913 21:20:29.454823 22417 net.cpp:399] fc6 -> fc6
I0913 21:20:29.527091 22407 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/9cc78d8c-90ee-4e63-95a8-5651ab7cac57/tmp/cvld3057566666840304819/s2vt.words_to_preds.prototxt
I0913 21:20:29.527168 22407 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0913 21:20:29.527176 22407 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0913 21:20:29.527428 22407 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0913 21:20:29.527523 22407 layer_factory.hpp:77] Creating layer input
I0913 21:20:29.527539 22407 net.cpp:91] Creating Layer input
I0913 21:20:29.527549 22407 net.cpp:399] input -> frames_fc7
I0913 21:20:29.527566 22407 net.cpp:399] input -> cont_sentence
I0913 21:20:29.527576 22407 net.cpp:399] input -> input_sentence
I0913 21:20:29.527585 22407 net.cpp:399] input -> stage_indicator
I0913 21:20:29.527729 22407 net.cpp:141] Setting up input
I0913 21:20:29.527741 22407 net.cpp:148] Top shape: 1 4096 (4096)
I0913 21:20:29.527748 22407 net.cpp:148] Top shape: 1 1 (1)
I0913 21:20:29.527753 22407 net.cpp:148] Top shape: 1 1 (1)
I0913 21:20:29.527760 22407 net.cpp:148] Top shape: 1 1 (1)
I0913 21:20:29.527763 22407 net.cpp:156] Memory required for data: 16396
I0913 21:20:29.527768 22407 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0913 21:20:29.527791 22407 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0913 21:20:29.527797 22407 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0913 21:20:29.527820 22407 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0913 21:20:29.527830 22407 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0913 21:20:29.527875 22407 net.cpp:141] Setting up cont_sentence_input_1_split
I0913 21:20:29.527885 22407 net.cpp:148] Top shape: 1 1 (1)
I0913 21:20:29.527891 22407 net.cpp:148] Top shape: 1 1 (1)
I0913 21:20:29.527896 22407 net.cpp:156] Memory required for data: 16404
I0913 21:20:29.527900 22407 layer_factory.hpp:77] Creating layer embed_encoder
I0913 21:20:29.527910 22407 net.cpp:91] Creating Layer embed_encoder
I0913 21:20:29.527915 22407 net.cpp:425] embed_encoder <- frames_fc7
I0913 21:20:29.527925 22407 net.cpp:399] embed_encoder -> embedded_in_frames
I0913 21:20:29.548784 22407 net.cpp:141] Setting up embed_encoder
I0913 21:20:29.548830 22407 net.cpp:148] Top shape: 1 500 (500)
I0913 21:20:29.548836 22407 net.cpp:156] Memory required for data: 18404
I0913 21:20:29.548857 22407 layer_factory.hpp:77] Creating layer reshape_frames
I0913 21:20:29.548878 22407 net.cpp:91] Creating Layer reshape_frames
I0913 21:20:29.548885 22407 net.cpp:425] reshape_frames <- embedded_in_frames
I0913 21:20:29.548895 22407 net.cpp:399] reshape_frames -> embedded_input_frames
I0913 21:20:29.548954 22407 net.cpp:141] Setting up reshape_frames
I0913 21:20:29.548964 22407 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:20:29.548969 22407 net.cpp:156] Memory required for data: 20404
I0913 21:20:29.548974 22407 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0913 21:20:29.548984 22407 net.cpp:91] Creating Layer reshape_stage_indicator
I0913 21:20:29.548988 22407 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0913 21:20:29.548996 22407 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0913 21:20:29.549033 22407 net.cpp:141] Setting up reshape_stage_indicator
I0913 21:20:29.549042 22407 net.cpp:148] Top shape: 1 1 1 (1)
I0913 21:20:29.549046 22407 net.cpp:156] Memory required for data: 20408
I0913 21:20:29.549052 22407 layer_factory.hpp:77] Creating layer embedding
I0913 21:20:29.549063 22407 net.cpp:91] Creating Layer embedding
I0913 21:20:29.549068 22407 net.cpp:425] embedding <- input_sentence
I0913 21:20:29.549077 22407 net.cpp:399] embedding -> embedded_input_sentence
I0913 21:20:29.587565 22417 net.cpp:141] Setting up fc6
I0913 21:20:29.587636 22417 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:20:29.587646 22417 net.cpp:156] Memory required for data: 67782200
I0913 21:20:29.587664 22417 layer_factory.hpp:77] Creating layer relu6
I0913 21:20:29.587682 22417 net.cpp:91] Creating Layer relu6
I0913 21:20:29.587689 22417 net.cpp:425] relu6 <- fc6
I0913 21:20:29.587702 22417 net.cpp:386] relu6 -> fc6 (in-place)
I0913 21:20:29.588181 22417 net.cpp:141] Setting up relu6
I0913 21:20:29.588193 22417 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:20:29.588197 22417 net.cpp:156] Memory required for data: 67946040
I0913 21:20:29.588203 22417 layer_factory.hpp:77] Creating layer drop6
I0913 21:20:29.588225 22417 net.cpp:91] Creating Layer drop6
I0913 21:20:29.588232 22417 net.cpp:425] drop6 <- fc6
I0913 21:20:29.588238 22417 net.cpp:386] drop6 -> fc6 (in-place)
I0913 21:20:29.588292 22417 net.cpp:141] Setting up drop6
I0913 21:20:29.588301 22417 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:20:29.588305 22417 net.cpp:156] Memory required for data: 68109880
I0913 21:20:29.588310 22417 layer_factory.hpp:77] Creating layer fc7
I0913 21:20:29.588323 22417 net.cpp:91] Creating Layer fc7
I0913 21:20:29.588328 22417 net.cpp:425] fc7 <- fc6
I0913 21:20:29.588335 22417 net.cpp:399] fc7 -> fc7
I0913 21:20:29.633152 22417 net.cpp:141] Setting up fc7
I0913 21:20:29.633222 22417 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:20:29.633229 22417 net.cpp:156] Memory required for data: 68273720
I0913 21:20:29.633244 22417 layer_factory.hpp:77] Creating layer relu7
I0913 21:20:29.633265 22417 net.cpp:91] Creating Layer relu7
I0913 21:20:29.633271 22417 net.cpp:425] relu7 <- fc7
I0913 21:20:29.633280 22417 net.cpp:386] relu7 -> fc7 (in-place)
I0913 21:20:29.633935 22417 net.cpp:141] Setting up relu7
I0913 21:20:29.633949 22417 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:20:29.633954 22417 net.cpp:156] Memory required for data: 68437560
I0913 21:20:29.633958 22417 layer_factory.hpp:77] Creating layer drop7
I0913 21:20:29.633971 22417 net.cpp:91] Creating Layer drop7
I0913 21:20:29.633977 22417 net.cpp:425] drop7 <- fc7
I0913 21:20:29.633985 22417 net.cpp:386] drop7 -> fc7 (in-place)
I0913 21:20:29.634022 22417 net.cpp:141] Setting up drop7
I0913 21:20:29.634030 22417 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:20:29.634035 22417 net.cpp:156] Memory required for data: 68601400
I0913 21:20:29.634039 22417 layer_factory.hpp:77] Creating layer fc8
I0913 21:20:29.634049 22417 net.cpp:91] Creating Layer fc8
I0913 21:20:29.634054 22417 net.cpp:425] fc8 <- fc7
I0913 21:20:29.634065 22417 net.cpp:399] fc8 -> fc8
I0913 21:20:29.645010 22417 net.cpp:141] Setting up fc8
I0913 21:20:29.645076 22417 net.cpp:148] Top shape: 10 1000 (10000)
I0913 21:20:29.645081 22417 net.cpp:156] Memory required for data: 68641400
I0913 21:20:29.645097 22417 layer_factory.hpp:77] Creating layer prob
I0913 21:20:29.645113 22417 net.cpp:91] Creating Layer prob
I0913 21:20:29.645120 22417 net.cpp:425] prob <- fc8
I0913 21:20:29.645133 22417 net.cpp:399] prob -> prob
I0913 21:20:29.645550 22417 net.cpp:141] Setting up prob
I0913 21:20:29.645561 22417 net.cpp:148] Top shape: 10 1000 (10000)
I0913 21:20:29.645566 22417 net.cpp:156] Memory required for data: 68681400
I0913 21:20:29.645572 22417 net.cpp:219] prob does not need backward computation.
I0913 21:20:29.645577 22417 net.cpp:219] fc8 does not need backward computation.
I0913 21:20:29.645581 22417 net.cpp:219] drop7 does not need backward computation.
I0913 21:20:29.645586 22417 net.cpp:219] relu7 does not need backward computation.
I0913 21:20:29.645591 22417 net.cpp:219] fc7 does not need backward computation.
I0913 21:20:29.645594 22417 net.cpp:219] drop6 does not need backward computation.
I0913 21:20:29.645599 22417 net.cpp:219] relu6 does not need backward computation.
I0913 21:20:29.645603 22417 net.cpp:219] fc6 does not need backward computation.
I0913 21:20:29.645607 22417 net.cpp:219] pool5 does not need backward computation.
I0913 21:20:29.645612 22417 net.cpp:219] relu5 does not need backward computation.
I0913 21:20:29.645617 22417 net.cpp:219] conv5 does not need backward computation.
I0913 21:20:29.645622 22417 net.cpp:219] relu4 does not need backward computation.
I0913 21:20:29.645625 22417 net.cpp:219] conv4 does not need backward computation.
I0913 21:20:29.645635 22417 net.cpp:219] relu3 does not need backward computation.
I0913 21:20:29.645639 22417 net.cpp:219] conv3 does not need backward computation.
I0913 21:20:29.645644 22417 net.cpp:219] norm2 does not need backward computation.
I0913 21:20:29.645649 22417 net.cpp:219] pool2 does not need backward computation.
I0913 21:20:29.645654 22417 net.cpp:219] relu2 does not need backward computation.
I0913 21:20:29.645658 22417 net.cpp:219] conv2 does not need backward computation.
I0913 21:20:29.645663 22417 net.cpp:219] norm1 does not need backward computation.
I0913 21:20:29.645668 22417 net.cpp:219] pool1 does not need backward computation.
I0913 21:20:29.645673 22417 net.cpp:219] relu1 does not need backward computation.
I0913 21:20:29.645678 22417 net.cpp:219] conv1 does not need backward computation.
I0913 21:20:29.645683 22417 net.cpp:219] data does not need backward computation.
I0913 21:20:29.645686 22417 net.cpp:261] This network produces output prob
I0913 21:20:29.645706 22417 net.cpp:274] Network initialization done.
I0913 21:20:29.762845 22407 net.cpp:141] Setting up embedding
I0913 21:20:29.762914 22407 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:20:29.762922 22407 net.cpp:156] Memory required for data: 22408
I0913 21:20:29.762938 22407 layer_factory.hpp:77] Creating layer lstm1
I0913 21:20:29.762977 22407 net.cpp:91] Creating Layer lstm1
I0913 21:20:29.762984 22407 net.cpp:425] lstm1 <- embedded_input_frames
I0913 21:20:29.762992 22407 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0913 21:20:29.763002 22407 net.cpp:399] lstm1 -> lstm1
I0913 21:20:29.763030 22407 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0913 21:20:29.763403 22407 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0913 21:20:29.763495 22407 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:20:29.763507 22407 net.cpp:91] Creating Layer lstm1_
I0913 21:20:29.763514 22407 net.cpp:399] lstm1_ -> x
I0913 21:20:29.763525 22407 net.cpp:399] lstm1_ -> cont
I0913 21:20:29.763586 22407 net.cpp:141] Setting up lstm1_
I0913 21:20:29.763597 22407 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:20:29.763604 22407 net.cpp:148] Top shape: 1 1 (1)
I0913 21:20:29.763608 22407 net.cpp:156] Memory required for data: 2004
I0913 21:20:29.763613 22407 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:20:29.763622 22407 net.cpp:91] Creating Layer lstm1_
I0913 21:20:29.763628 22407 net.cpp:399] lstm1_ -> c_0
I0913 21:20:29.763639 22407 net.cpp:399] lstm1_ -> h_0
I0913 21:20:29.763685 22407 net.cpp:141] Setting up lstm1_
I0913 21:20:29.763695 22407 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:20:29.763700 22407 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:20:29.763705 22407 net.cpp:156] Memory required for data: 10004
I0913 21:20:29.763710 22407 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0913 21:20:29.763720 22407 net.cpp:91] Creating Layer lstm1_cont_slice
I0913 21:20:29.763725 22407 net.cpp:425] lstm1_cont_slice <- cont
I0913 21:20:29.763731 22407 net.cpp:399] lstm1_cont_slice -> cont_1
I0913 21:20:29.763769 22407 net.cpp:141] Setting up lstm1_cont_slice
I0913 21:20:29.763778 22407 net.cpp:148] Top shape: 1 1 (1)
I0913 21:20:29.763782 22407 net.cpp:156] Memory required for data: 10008
I0913 21:20:29.763787 22407 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0913 21:20:29.763794 22407 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0913 21:20:29.763799 22407 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0913 21:20:29.763808 22407 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0913 21:20:29.763816 22407 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0913 21:20:29.763862 22407 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0913 21:20:29.763870 22407 net.cpp:148] Top shape: 1 1 (1)
I0913 21:20:29.763876 22407 net.cpp:148] Top shape: 1 1 (1)
I0913 21:20:29.763880 22407 net.cpp:156] Memory required for data: 10016
I0913 21:20:29.763885 22407 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0913 21:20:29.763896 22407 net.cpp:91] Creating Layer lstm1_x_transform
I0913 21:20:29.763901 22407 net.cpp:425] lstm1_x_transform <- x
I0913 21:20:29.763908 22407 net.cpp:399] lstm1_x_transform -> W_xc_x
I0913 21:20:29.783435 22407 net.cpp:141] Setting up lstm1_x_transform
I0913 21:20:29.783493 22407 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:20:29.783499 22407 net.cpp:156] Memory required for data: 26016
I0913 21:20:29.783521 22407 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0913 21:20:29.783537 22407 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0913 21:20:29.783543 22407 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0913 21:20:29.783555 22407 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0913 21:20:29.783598 22407 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0913 21:20:29.783608 22407 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:20:29.783612 22407 net.cpp:156] Memory required for data: 42016
I0913 21:20:29.783617 22407 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0913 21:20:29.783627 22407 net.cpp:91] Creating Layer lstm1_h_conted_0
I0913 21:20:29.783632 22407 net.cpp:425] lstm1_h_conted_0 <- h_0
I0913 21:20:29.783638 22407 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0913 21:20:29.783648 22407 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0913 21:20:29.783747 22407 net.cpp:141] Setting up lstm1_h_conted_0
I0913 21:20:29.783757 22407 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:20:29.783761 22407 net.cpp:156] Memory required for data: 46016
I0913 21:20:29.783766 22407 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0913 21:20:29.783782 22407 net.cpp:91] Creating Layer lstm1_transform_1
I0913 21:20:29.783787 22407 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0913 21:20:29.783795 22407 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0913 21:20:29.822268 22407 net.cpp:141] Setting up lstm1_transform_1
I0913 21:20:29.822335 22407 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:20:29.822341 22407 net.cpp:156] Memory required for data: 62016
I0913 21:20:29.822361 22407 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0913 21:20:29.822384 22407 net.cpp:91] Creating Layer lstm1_gate_input_1
I0913 21:20:29.822391 22407 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0913 21:20:29.822401 22407 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0913 21:20:29.822408 22407 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0913 21:20:29.822465 22407 net.cpp:141] Setting up lstm1_gate_input_1
I0913 21:20:29.822474 22407 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:20:29.822479 22407 net.cpp:156] Memory required for data: 78016
I0913 21:20:29.822484 22407 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0913 21:20:29.822495 22407 net.cpp:91] Creating Layer lstm1_unit_1
I0913 21:20:29.822500 22407 net.cpp:425] lstm1_unit_1 <- c_0
I0913 21:20:29.822505 22407 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0913 21:20:29.822510 22407 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0913 21:20:29.822517 22407 net.cpp:399] lstm1_unit_1 -> c_1
I0913 21:20:29.822525 22407 net.cpp:399] lstm1_unit_1 -> h_1
I0913 21:20:29.822585 22407 net.cpp:141] Setting up lstm1_unit_1
I0913 21:20:29.822595 22407 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:20:29.822600 22407 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:20:29.822604 22407 net.cpp:156] Memory required for data: 86016
I0913 21:20:29.822609 22407 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:20:29.822618 22407 net.cpp:91] Creating Layer lstm1_
I0913 21:20:29.822623 22407 net.cpp:425] lstm1_ <- c_1
I0913 21:20:29.822629 22407 net.cpp:399] lstm1_ -> c_T
I0913 21:20:29.822660 22407 net.cpp:141] Setting up lstm1_
I0913 21:20:29.822669 22407 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:20:29.822674 22407 net.cpp:156] Memory required for data: 90016
I0913 21:20:29.822679 22407 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0913 21:20:29.822688 22407 net.cpp:91] Creating Layer lstm1_h_concat
I0913 21:20:29.822692 22407 net.cpp:425] lstm1_h_concat <- h_1
I0913 21:20:29.822700 22407 net.cpp:399] lstm1_h_concat -> h
I0913 21:20:29.822734 22407 net.cpp:141] Setting up lstm1_h_concat
I0913 21:20:29.822743 22407 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:20:29.822747 22407 net.cpp:156] Memory required for data: 94016
I0913 21:20:29.822751 22407 layer_factory.hpp:77] Creating layer h_pseudoloss
I0913 21:20:29.822774 22407 net.cpp:91] Creating Layer h_pseudoloss
I0913 21:20:29.822779 22407 net.cpp:425] h_pseudoloss <- h
I0913 21:20:29.822787 22407 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0913 21:20:29.822871 22407 net.cpp:141] Setting up h_pseudoloss
I0913 21:20:29.822885 22407 net.cpp:148] Top shape: (1)
I0913 21:20:29.822893 22407 net.cpp:151]     with loss weight 1
I0913 21:20:29.822942 22407 net.cpp:156] Memory required for data: 94020
I0913 21:20:29.822949 22407 net.cpp:217] h_pseudoloss needs backward computation.
I0913 21:20:29.822953 22407 net.cpp:217] lstm1_h_concat needs backward computation.
I0913 21:20:29.822958 22407 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:20:29.822963 22407 net.cpp:217] lstm1_unit_1 needs backward computation.
I0913 21:20:29.822968 22407 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0913 21:20:29.822973 22407 net.cpp:217] lstm1_transform_1 needs backward computation.
I0913 21:20:29.822981 22407 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0913 21:20:29.822988 22407 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0913 21:20:29.822993 22407 net.cpp:217] lstm1_x_transform needs backward computation.
I0913 21:20:29.822998 22407 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0913 21:20:29.823002 22407 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0913 21:20:29.823007 22407 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:20:29.823011 22407 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:20:29.823015 22407 net.cpp:261] This network produces output c_T
I0913 21:20:29.823020 22407 net.cpp:261] This network produces output h_pseudoloss
I0913 21:20:29.823034 22407 net.cpp:274] Network initialization done.
I0913 21:20:29.823087 22407 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0913 21:20:29.823093 22407 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0913 21:20:29.823098 22407 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0913 21:20:29.823204 22407 net.cpp:141] Setting up lstm1
I0913 21:20:29.823220 22407 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:20:29.823228 22407 net.cpp:156] Memory required for data: 26408
I0913 21:20:29.823251 22407 layer_factory.hpp:77] Creating layer concat
I0913 21:20:29.823262 22407 net.cpp:91] Creating Layer concat
I0913 21:20:29.823268 22407 net.cpp:425] concat <- lstm1
I0913 21:20:29.823274 22407 net.cpp:425] concat <- embedded_input_sentence
I0913 21:20:29.823279 22407 net.cpp:425] concat <- reshaped_stage_indicator
I0913 21:20:29.823287 22407 net.cpp:399] concat -> lstm1_video_sequence
I0913 21:20:29.823321 22407 net.cpp:141] Setting up concat
I0913 21:20:29.823330 22407 net.cpp:148] Top shape: 1 1 1501 (1501)
I0913 21:20:29.823334 22407 net.cpp:156] Memory required for data: 32412
I0913 21:20:29.823339 22407 layer_factory.hpp:77] Creating layer lstm2
I0913 21:20:29.823351 22407 net.cpp:91] Creating Layer lstm2
I0913 21:20:29.823356 22407 net.cpp:425] lstm2 <- lstm1_video_sequence
I0913 21:20:29.823362 22407 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0913 21:20:29.823376 22407 net.cpp:399] lstm2 -> lstm2
I0913 21:20:29.823386 22407 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0913 21:20:29.823634 22407 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0913 21:20:29.823719 22407 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:20:29.823731 22407 net.cpp:91] Creating Layer lstm2_
I0913 21:20:29.823745 22407 net.cpp:399] lstm2_ -> x
I0913 21:20:29.823755 22407 net.cpp:399] lstm2_ -> cont
I0913 21:20:29.823807 22407 net.cpp:141] Setting up lstm2_
I0913 21:20:29.823815 22407 net.cpp:148] Top shape: 1 1 1501 (1501)
I0913 21:20:29.823822 22407 net.cpp:148] Top shape: 1 1 (1)
I0913 21:20:29.823825 22407 net.cpp:156] Memory required for data: 6008
I0913 21:20:29.823830 22407 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:20:29.823842 22407 net.cpp:91] Creating Layer lstm2_
I0913 21:20:29.823848 22407 net.cpp:399] lstm2_ -> c_0
I0913 21:20:29.823858 22407 net.cpp:399] lstm2_ -> h_0
I0913 21:20:29.823907 22407 net.cpp:141] Setting up lstm2_
I0913 21:20:29.823916 22407 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:20:29.823922 22407 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:20:29.823926 22407 net.cpp:156] Memory required for data: 14008
I0913 21:20:29.823930 22407 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0913 21:20:29.823938 22407 net.cpp:91] Creating Layer lstm2_cont_slice
I0913 21:20:29.823943 22407 net.cpp:425] lstm2_cont_slice <- cont
I0913 21:20:29.823950 22407 net.cpp:399] lstm2_cont_slice -> cont_1
I0913 21:20:29.823981 22407 net.cpp:141] Setting up lstm2_cont_slice
I0913 21:20:29.823989 22407 net.cpp:148] Top shape: 1 1 (1)
I0913 21:20:29.823993 22407 net.cpp:156] Memory required for data: 14012
I0913 21:20:29.823997 22407 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0913 21:20:29.824007 22407 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0913 21:20:29.824012 22407 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0913 21:20:29.824018 22407 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0913 21:20:29.824028 22407 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0913 21:20:29.824089 22407 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0913 21:20:29.824101 22407 net.cpp:148] Top shape: 1 1 (1)
I0913 21:20:29.824111 22407 net.cpp:148] Top shape: 1 1 (1)
I0913 21:20:29.824120 22407 net.cpp:156] Memory required for data: 14020
I0913 21:20:29.824126 22407 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0913 21:20:29.824139 22407 net.cpp:91] Creating Layer lstm2_x_transform
I0913 21:20:29.824144 22407 net.cpp:425] lstm2_x_transform <- x
I0913 21:20:29.824154 22407 net.cpp:399] lstm2_x_transform -> W_xc_x
I0913 21:20:29.867976 22417 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /home/peifeng/work/run/storm102/data/workers/9cc78d8c-90ee-4e63-95a8-5651ab7cac57/tmp/cvld3057566666840304819/bvlc_reference_caffenet.caffemodel
I0913 21:20:29.868051 22417 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0913 21:20:29.868057 22417 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0913 21:20:29.868060 22417 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /home/peifeng/work/run/storm102/data/workers/9cc78d8c-90ee-4e63-95a8-5651ab7cac57/tmp/cvld3057566666840304819/bvlc_reference_caffenet.caffemodel
I0913 21:20:29.882684 22407 net.cpp:141] Setting up lstm2_x_transform
I0913 21:20:29.882758 22407 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:20:29.882766 22407 net.cpp:156] Memory required for data: 30020
I0913 21:20:29.882797 22407 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0913 21:20:29.882822 22407 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0913 21:20:29.882829 22407 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0913 21:20:29.882839 22407 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0913 21:20:29.882890 22407 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0913 21:20:29.882900 22407 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:20:29.882905 22407 net.cpp:156] Memory required for data: 46020
I0913 21:20:29.882910 22407 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0913 21:20:29.882925 22407 net.cpp:91] Creating Layer lstm2_h_conted_0
I0913 21:20:29.882930 22407 net.cpp:425] lstm2_h_conted_0 <- h_0
I0913 21:20:29.882936 22407 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0913 21:20:29.882943 22407 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0913 21:20:29.883038 22407 net.cpp:141] Setting up lstm2_h_conted_0
I0913 21:20:29.883047 22407 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:20:29.883051 22407 net.cpp:156] Memory required for data: 50020
I0913 21:20:29.883056 22407 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0913 21:20:29.883072 22407 net.cpp:91] Creating Layer lstm2_transform_1
I0913 21:20:29.883077 22407 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0913 21:20:29.883085 22407 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0913 21:20:29.922174 22407 net.cpp:141] Setting up lstm2_transform_1
I0913 21:20:29.922229 22407 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:20:29.922235 22407 net.cpp:156] Memory required for data: 66020
I0913 21:20:29.922256 22407 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0913 21:20:29.922279 22407 net.cpp:91] Creating Layer lstm2_gate_input_1
I0913 21:20:29.922286 22407 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0913 21:20:29.922293 22407 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0913 21:20:29.922304 22407 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0913 21:20:29.922351 22407 net.cpp:141] Setting up lstm2_gate_input_1
I0913 21:20:29.922363 22407 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:20:29.922368 22407 net.cpp:156] Memory required for data: 82020
I0913 21:20:29.922379 22407 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0913 21:20:29.922389 22407 net.cpp:91] Creating Layer lstm2_unit_1
I0913 21:20:29.922394 22407 net.cpp:425] lstm2_unit_1 <- c_0
I0913 21:20:29.922399 22407 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0913 21:20:29.922405 22407 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0913 21:20:29.922410 22407 net.cpp:399] lstm2_unit_1 -> c_1
I0913 21:20:29.922418 22407 net.cpp:399] lstm2_unit_1 -> h_1
I0913 21:20:29.922477 22407 net.cpp:141] Setting up lstm2_unit_1
I0913 21:20:29.922487 22407 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:20:29.922492 22407 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:20:29.922497 22407 net.cpp:156] Memory required for data: 90020
I0913 21:20:29.922500 22407 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:20:29.922508 22407 net.cpp:91] Creating Layer lstm2_
I0913 21:20:29.922513 22407 net.cpp:425] lstm2_ <- c_1
I0913 21:20:29.922520 22407 net.cpp:399] lstm2_ -> c_T
I0913 21:20:29.922547 22407 net.cpp:141] Setting up lstm2_
I0913 21:20:29.922556 22407 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:20:29.922560 22407 net.cpp:156] Memory required for data: 94020
I0913 21:20:29.922564 22407 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0913 21:20:29.922577 22407 net.cpp:91] Creating Layer lstm2_h_concat
I0913 21:20:29.922582 22407 net.cpp:425] lstm2_h_concat <- h_1
I0913 21:20:29.922590 22407 net.cpp:399] lstm2_h_concat -> h
I0913 21:20:29.922622 22407 net.cpp:141] Setting up lstm2_h_concat
I0913 21:20:29.922631 22407 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:20:29.922634 22407 net.cpp:156] Memory required for data: 98020
I0913 21:20:29.922639 22407 layer_factory.hpp:77] Creating layer h_pseudoloss
I0913 21:20:29.922649 22407 net.cpp:91] Creating Layer h_pseudoloss
I0913 21:20:29.922654 22407 net.cpp:425] h_pseudoloss <- h
I0913 21:20:29.922663 22407 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0913 21:20:29.922747 22407 net.cpp:141] Setting up h_pseudoloss
I0913 21:20:29.922756 22407 net.cpp:148] Top shape: (1)
I0913 21:20:29.922761 22407 net.cpp:151]     with loss weight 1
I0913 21:20:29.922782 22407 net.cpp:156] Memory required for data: 98024
I0913 21:20:29.922787 22407 net.cpp:217] h_pseudoloss needs backward computation.
I0913 21:20:29.922792 22407 net.cpp:217] lstm2_h_concat needs backward computation.
I0913 21:20:29.922796 22407 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:20:29.922801 22407 net.cpp:217] lstm2_unit_1 needs backward computation.
I0913 21:20:29.922807 22407 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0913 21:20:29.922811 22407 net.cpp:217] lstm2_transform_1 needs backward computation.
I0913 21:20:29.922817 22407 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0913 21:20:29.922822 22407 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0913 21:20:29.922827 22407 net.cpp:217] lstm2_x_transform needs backward computation.
I0913 21:20:29.922832 22407 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0913 21:20:29.922837 22407 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0913 21:20:29.922842 22407 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:20:29.922845 22407 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:20:29.922849 22407 net.cpp:261] This network produces output c_T
I0913 21:20:29.922853 22407 net.cpp:261] This network produces output h_pseudoloss
I0913 21:20:29.922869 22407 net.cpp:274] Network initialization done.
I0913 21:20:29.922924 22407 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0913 21:20:29.922931 22407 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0913 21:20:29.922935 22407 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0913 21:20:29.923048 22407 net.cpp:141] Setting up lstm2
I0913 21:20:29.923061 22407 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:20:29.923066 22407 net.cpp:156] Memory required for data: 36412
I0913 21:20:29.923082 22407 layer_factory.hpp:77] Creating layer predict
I0913 21:20:29.923096 22407 net.cpp:91] Creating Layer predict
I0913 21:20:29.923105 22407 net.cpp:425] predict <- lstm2
I0913 21:20:29.923111 22407 net.cpp:399] predict -> predict
I0913 21:20:30.256065 22417 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0913 21:20:30.301654 22417 net.cpp:752] Ignoring source layer loss
Loading the model + trained: 10261.7ms
Using cv::Size and some other stuff: 0.228ms
I0913 21:20:30.370738 22407 net.cpp:141] Setting up predict
I0913 21:20:30.370790 22407 net.cpp:148] Top shape: 1 1 46168 (46168)
I0913 21:20:30.370796 22407 net.cpp:156] Memory required for data: 221084
I0913 21:20:30.370811 22407 layer_factory.hpp:77] Creating layer probs
I0913 21:20:30.370829 22407 net.cpp:91] Creating Layer probs
I0913 21:20:30.370838 22407 net.cpp:425] probs <- predict
I0913 21:20:30.370848 22407 net.cpp:399] probs -> probs
I0913 21:20:30.373447 22407 net.cpp:141] Setting up probs
I0913 21:20:30.373505 22407 net.cpp:148] Top shape: 1 1 46168 (46168)
I0913 21:20:30.373517 22407 net.cpp:156] Memory required for data: 405756
I0913 21:20:30.373529 22407 net.cpp:219] probs does not need backward computation.
I0913 21:20:30.373540 22407 net.cpp:219] predict does not need backward computation.
I0913 21:20:30.373549 22407 net.cpp:219] lstm2 does not need backward computation.
I0913 21:20:30.373561 22407 net.cpp:219] concat does not need backward computation.
I0913 21:20:30.373572 22407 net.cpp:219] lstm1 does not need backward computation.
I0913 21:20:30.373582 22407 net.cpp:219] embedding does not need backward computation.
I0913 21:20:30.373590 22407 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0913 21:20:30.373600 22407 net.cpp:219] reshape_frames does not need backward computation.
I0913 21:20:30.373610 22407 net.cpp:219] embed_encoder does not need backward computation.
I0913 21:20:30.373618 22407 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0913 21:20:30.373627 22407 net.cpp:219] input does not need backward computation.
I0913 21:20:30.373634 22407 net.cpp:261] This network produces output probs
I0913 21:20:30.373661 22407 net.cpp:274] Network initialization done.
Loading the mean file: 1870.96ms
I0913 21:20:30.791532 22407 net.cpp:752] Ignoring source layer data
I0913 21:20:30.791570 22407 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0913 21:20:30.791575 22407 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0913 21:20:30.864789 22407 net.cpp:752] Ignoring source layer cross_entropy_loss
TIMERTIMER 126942921
TIMERTIMER 61550174
TIMERTIMER 66806615
TIMERTIMER 49502411
TIMERTIMER 49237462
TIMERTIMER 48944614
TIMERTIMER 48752319
TIMERTIMER 51793654
TIMERTIMER 47762729
TIMERTIMER 48483713
TIMERTIMER 50518485
TIMERTIMER 50657098
TIMERTIMER 54127267
TIMERTIMER 47469913
TIMERTIMER 46914023
TIMERTIMER 49592270
TIMERTIMER 42967164
TIMERTIMER 37566920
TIMERTIMER 31809797
TIMERTIMER 32333402
TIMERTIMER 31346261
TIMERTIMER 43937592
TIMERTIMER 32993819
TIMERTIMER 36601267
TIMERTIMER 38861241
TIMERTIMER 33893057
TIMERTIMER 31299871
TIMERTIMER 31465813
TIMERTIMER 37031045
TIMERTIMER 37970941
TIMERTIMER 37577072
TIMERTIMER 37271426
TIMERTIMER 37562510
TIMERTIMER 39013496
TIMERTIMER 37547126
TIMERTIMER 38741242
TIMERTIMER 39092335
TIMERTIMER 38225795
TIMERTIMER 38766946
TIMERTIMER 31232944
TIMERTIMER 32680523
TIMERTIMER 37564600
TIMERTIMER 37471384
TIMERTIMER 32477074
TIMERTIMER 32944790
TIMERTIMER 38512580
TIMERTIMER 31392051
TIMERTIMER 37989483
TIMERTIMER 33347560
TIMERTIMER 39028835
TIMERTIMER 32491396
TIMERTIMER 31386124
TIMERTIMER 31426531
TIMERTIMER 37562222
TIMERTIMER 31834274
TIMERTIMER 31293950
TIMERTIMER 38495524
TIMERTIMER 33728860
TIMERTIMER 37786714
TIMERTIMER 32259737
TIMERTIMER 37522678
TIMERTIMER 31820361
TIMERTIMER 31715328
TIMERTIMER 37569356
TIMERTIMER 31422723
TIMERTIMER 32014175
TIMERTIMER 32575402
TIMERTIMER 38411666
TIMERTIMER 31304083
TIMERTIMER 37674768
TIMERTIMER 31391813
TIMERTIMER 31394671
TIMERTIMER 31321421
TIMERTIMER 32368202
TIMERTIMER 31792420
TIMERTIMER 43648164
TIMERTIMER 31169881
TIMERTIMER 31301437
TIMERTIMER 31716910
TIMERTIMER 32066525
TIMERTIMER 38264618
TIMERTIMER 38040957
TIMERTIMER 35135345
TIMERTIMER 37400401
TIMERTIMER 31309739
TIMERTIMER 31507454
TIMERTIMER 32257253
