SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/peifeng/tools/storm102/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/peifeng/work/run/storm102/data/supervisor/stormdist/captioning-1-1473815071/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /home/peifeng/work/run/storm102/data/workers/78277562-7263-45cf-a8c5-10b407bd07b2/tmp/cvld2876351053615315575/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0913 21:05:10.518441 13902 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0913 21:05:10.518640 13902 layer_factory.hpp:77] Creating layer data
I0913 21:05:10.518669 13902 net.cpp:91] Creating Layer data
I0913 21:05:10.518679 13902 net.cpp:399] data -> data
I0913 21:05:11.043761 13902 net.cpp:141] Setting up data
I0913 21:05:11.043858 13902 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0913 21:05:11.043864 13902 net.cpp:156] Memory required for data: 6183480
I0913 21:05:11.043882 13902 layer_factory.hpp:77] Creating layer conv1
I0913 21:05:11.043913 13902 net.cpp:91] Creating Layer conv1
I0913 21:05:11.043922 13902 net.cpp:425] conv1 <- data
I0913 21:05:11.043936 13902 net.cpp:399] conv1 -> conv1
I0913 21:05:11.210844 13892 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/78277562-7263-45cf-a8c5-10b407bd07b2/tmp/cvld2876351053615315575/s2vt.words_to_preds.prototxt
I0913 21:05:11.210892 13892 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0913 21:05:11.210901 13892 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0913 21:05:11.211143 13892 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0913 21:05:11.211237 13892 layer_factory.hpp:77] Creating layer input
I0913 21:05:11.211252 13892 net.cpp:91] Creating Layer input
I0913 21:05:11.211261 13892 net.cpp:399] input -> frames_fc7
I0913 21:05:11.211277 13892 net.cpp:399] input -> cont_sentence
I0913 21:05:11.211289 13892 net.cpp:399] input -> input_sentence
I0913 21:05:11.211298 13892 net.cpp:399] input -> stage_indicator
I0913 21:05:11.217373 13892 net.cpp:141] Setting up input
I0913 21:05:11.217391 13892 net.cpp:148] Top shape: 1 4096 (4096)
I0913 21:05:11.217398 13892 net.cpp:148] Top shape: 1 1 (1)
I0913 21:05:11.217403 13892 net.cpp:148] Top shape: 1 1 (1)
I0913 21:05:11.217408 13892 net.cpp:148] Top shape: 1 1 (1)
I0913 21:05:11.217412 13892 net.cpp:156] Memory required for data: 16396
I0913 21:05:11.217417 13892 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0913 21:05:11.217434 13892 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0913 21:05:11.217440 13892 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0913 21:05:11.217458 13892 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0913 21:05:11.217468 13892 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0913 21:05:11.220212 13892 net.cpp:141] Setting up cont_sentence_input_1_split
I0913 21:05:11.220232 13892 net.cpp:148] Top shape: 1 1 (1)
I0913 21:05:11.220238 13892 net.cpp:148] Top shape: 1 1 (1)
I0913 21:05:11.220242 13892 net.cpp:156] Memory required for data: 16404
I0913 21:05:11.220247 13892 layer_factory.hpp:77] Creating layer embed_encoder
I0913 21:05:11.220264 13892 net.cpp:91] Creating Layer embed_encoder
I0913 21:05:11.220270 13892 net.cpp:425] embed_encoder <- frames_fc7
I0913 21:05:11.220280 13892 net.cpp:399] embed_encoder -> embedded_in_frames
I0913 21:05:11.233181 13902 net.cpp:141] Setting up conv1
I0913 21:05:11.233233 13902 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0913 21:05:11.233245 13902 net.cpp:156] Memory required for data: 17799480
I0913 21:05:11.233286 13902 layer_factory.hpp:77] Creating layer relu1
I0913 21:05:11.233314 13902 net.cpp:91] Creating Layer relu1
I0913 21:05:11.233325 13902 net.cpp:425] relu1 <- conv1
I0913 21:05:11.233337 13902 net.cpp:386] relu1 -> conv1 (in-place)
I0913 21:05:11.233865 13902 net.cpp:141] Setting up relu1
I0913 21:05:11.233885 13902 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0913 21:05:11.233893 13902 net.cpp:156] Memory required for data: 29415480
I0913 21:05:11.233901 13902 layer_factory.hpp:77] Creating layer pool1
I0913 21:05:11.233919 13902 net.cpp:91] Creating Layer pool1
I0913 21:05:11.233927 13902 net.cpp:425] pool1 <- conv1
I0913 21:05:11.233940 13902 net.cpp:399] pool1 -> pool1
I0913 21:05:11.234045 13902 net.cpp:141] Setting up pool1
I0913 21:05:11.234063 13902 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0913 21:05:11.234072 13902 net.cpp:156] Memory required for data: 32214840
I0913 21:05:11.234081 13902 layer_factory.hpp:77] Creating layer norm1
I0913 21:05:11.234107 13902 net.cpp:91] Creating Layer norm1
I0913 21:05:11.234113 13902 net.cpp:425] norm1 <- pool1
I0913 21:05:11.234120 13902 net.cpp:399] norm1 -> norm1
I0913 21:05:11.234378 13902 net.cpp:141] Setting up norm1
I0913 21:05:11.234390 13902 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0913 21:05:11.234395 13902 net.cpp:156] Memory required for data: 35014200
I0913 21:05:11.234400 13902 layer_factory.hpp:77] Creating layer conv2
I0913 21:05:11.234414 13902 net.cpp:91] Creating Layer conv2
I0913 21:05:11.234419 13902 net.cpp:425] conv2 <- norm1
I0913 21:05:11.234426 13902 net.cpp:399] conv2 -> conv2
I0913 21:05:11.238122 13902 net.cpp:141] Setting up conv2
I0913 21:05:11.238142 13902 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0913 21:05:11.238147 13902 net.cpp:156] Memory required for data: 42479160
I0913 21:05:11.238159 13902 layer_factory.hpp:77] Creating layer relu2
I0913 21:05:11.238168 13902 net.cpp:91] Creating Layer relu2
I0913 21:05:11.238173 13902 net.cpp:425] relu2 <- conv2
I0913 21:05:11.238180 13902 net.cpp:386] relu2 -> conv2 (in-place)
I0913 21:05:11.238572 13902 net.cpp:141] Setting up relu2
I0913 21:05:11.238585 13902 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0913 21:05:11.238590 13902 net.cpp:156] Memory required for data: 49944120
I0913 21:05:11.238595 13902 layer_factory.hpp:77] Creating layer pool2
I0913 21:05:11.238606 13902 net.cpp:91] Creating Layer pool2
I0913 21:05:11.238611 13902 net.cpp:425] pool2 <- conv2
I0913 21:05:11.238618 13902 net.cpp:399] pool2 -> pool2
I0913 21:05:11.238673 13902 net.cpp:141] Setting up pool2
I0913 21:05:11.238682 13902 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:05:11.238687 13902 net.cpp:156] Memory required for data: 51674680
I0913 21:05:11.238692 13902 layer_factory.hpp:77] Creating layer norm2
I0913 21:05:11.238703 13902 net.cpp:91] Creating Layer norm2
I0913 21:05:11.238706 13902 net.cpp:425] norm2 <- pool2
I0913 21:05:11.238713 13902 net.cpp:399] norm2 -> norm2
I0913 21:05:11.238965 13902 net.cpp:141] Setting up norm2
I0913 21:05:11.238979 13902 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:05:11.238984 13902 net.cpp:156] Memory required for data: 53405240
I0913 21:05:11.238989 13902 layer_factory.hpp:77] Creating layer conv3
I0913 21:05:11.239001 13902 net.cpp:91] Creating Layer conv3
I0913 21:05:11.239006 13902 net.cpp:425] conv3 <- norm2
I0913 21:05:11.239012 13902 net.cpp:399] conv3 -> conv3
I0913 21:05:11.241072 13892 net.cpp:141] Setting up embed_encoder
I0913 21:05:11.241122 13892 net.cpp:148] Top shape: 1 500 (500)
I0913 21:05:11.241127 13892 net.cpp:156] Memory required for data: 18404
I0913 21:05:11.241147 13892 layer_factory.hpp:77] Creating layer reshape_frames
I0913 21:05:11.241163 13892 net.cpp:91] Creating Layer reshape_frames
I0913 21:05:11.241169 13892 net.cpp:425] reshape_frames <- embedded_in_frames
I0913 21:05:11.241180 13892 net.cpp:399] reshape_frames -> embedded_input_frames
I0913 21:05:11.241230 13892 net.cpp:141] Setting up reshape_frames
I0913 21:05:11.241238 13892 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:05:11.241243 13892 net.cpp:156] Memory required for data: 20404
I0913 21:05:11.241247 13892 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0913 21:05:11.241258 13892 net.cpp:91] Creating Layer reshape_stage_indicator
I0913 21:05:11.241263 13892 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0913 21:05:11.241271 13892 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0913 21:05:11.241305 13892 net.cpp:141] Setting up reshape_stage_indicator
I0913 21:05:11.241313 13892 net.cpp:148] Top shape: 1 1 1 (1)
I0913 21:05:11.241317 13892 net.cpp:156] Memory required for data: 20408
I0913 21:05:11.241322 13892 layer_factory.hpp:77] Creating layer embedding
I0913 21:05:11.241334 13892 net.cpp:91] Creating Layer embedding
I0913 21:05:11.241339 13892 net.cpp:425] embedding <- input_sentence
I0913 21:05:11.241346 13892 net.cpp:399] embedding -> embedded_input_sentence
I0913 21:05:11.280936 13902 net.cpp:141] Setting up conv3
I0913 21:05:11.281008 13902 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:05:11.281018 13902 net.cpp:156] Memory required for data: 56001080
I0913 21:05:11.281050 13902 layer_factory.hpp:77] Creating layer relu3
I0913 21:05:11.281078 13902 net.cpp:91] Creating Layer relu3
I0913 21:05:11.281090 13902 net.cpp:425] relu3 <- conv3
I0913 21:05:11.281111 13902 net.cpp:386] relu3 -> conv3 (in-place)
I0913 21:05:11.281440 13902 net.cpp:141] Setting up relu3
I0913 21:05:11.281456 13902 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:05:11.281464 13902 net.cpp:156] Memory required for data: 58596920
I0913 21:05:11.281472 13902 layer_factory.hpp:77] Creating layer conv4
I0913 21:05:11.281499 13902 net.cpp:91] Creating Layer conv4
I0913 21:05:11.281507 13902 net.cpp:425] conv4 <- conv3
I0913 21:05:11.281525 13902 net.cpp:399] conv4 -> conv4
I0913 21:05:11.286924 13902 net.cpp:141] Setting up conv4
I0913 21:05:11.286973 13902 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:05:11.286979 13902 net.cpp:156] Memory required for data: 61192760
I0913 21:05:11.286993 13902 layer_factory.hpp:77] Creating layer relu4
I0913 21:05:11.287010 13902 net.cpp:91] Creating Layer relu4
I0913 21:05:11.287016 13902 net.cpp:425] relu4 <- conv4
I0913 21:05:11.287029 13902 net.cpp:386] relu4 -> conv4 (in-place)
I0913 21:05:11.287441 13902 net.cpp:141] Setting up relu4
I0913 21:05:11.287452 13902 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:05:11.287457 13902 net.cpp:156] Memory required for data: 63788600
I0913 21:05:11.287462 13902 layer_factory.hpp:77] Creating layer conv5
I0913 21:05:11.287480 13902 net.cpp:91] Creating Layer conv5
I0913 21:05:11.287485 13902 net.cpp:425] conv5 <- conv4
I0913 21:05:11.287492 13902 net.cpp:399] conv5 -> conv5
I0913 21:05:11.291184 13902 net.cpp:141] Setting up conv5
I0913 21:05:11.291205 13902 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:05:11.291210 13902 net.cpp:156] Memory required for data: 65519160
I0913 21:05:11.291225 13902 layer_factory.hpp:77] Creating layer relu5
I0913 21:05:11.291234 13902 net.cpp:91] Creating Layer relu5
I0913 21:05:11.291239 13902 net.cpp:425] relu5 <- conv5
I0913 21:05:11.291245 13902 net.cpp:386] relu5 -> conv5 (in-place)
I0913 21:05:11.291637 13902 net.cpp:141] Setting up relu5
I0913 21:05:11.291651 13902 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:05:11.291654 13902 net.cpp:156] Memory required for data: 67249720
I0913 21:05:11.291659 13902 layer_factory.hpp:77] Creating layer pool5
I0913 21:05:11.291669 13902 net.cpp:91] Creating Layer pool5
I0913 21:05:11.291673 13902 net.cpp:425] pool5 <- conv5
I0913 21:05:11.291684 13902 net.cpp:399] pool5 -> pool5
I0913 21:05:11.291743 13902 net.cpp:141] Setting up pool5
I0913 21:05:11.291752 13902 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0913 21:05:11.291756 13902 net.cpp:156] Memory required for data: 67618360
I0913 21:05:11.291761 13902 layer_factory.hpp:77] Creating layer fc6
I0913 21:05:11.291777 13902 net.cpp:91] Creating Layer fc6
I0913 21:05:11.291782 13902 net.cpp:425] fc6 <- pool5
I0913 21:05:11.291790 13902 net.cpp:399] fc6 -> fc6
I0913 21:05:11.392323 13902 net.cpp:141] Setting up fc6
I0913 21:05:11.392371 13902 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:05:11.392376 13902 net.cpp:156] Memory required for data: 67782200
I0913 21:05:11.392391 13902 layer_factory.hpp:77] Creating layer relu6
I0913 21:05:11.392412 13902 net.cpp:91] Creating Layer relu6
I0913 21:05:11.392419 13902 net.cpp:425] relu6 <- fc6
I0913 21:05:11.392428 13902 net.cpp:386] relu6 -> fc6 (in-place)
I0913 21:05:11.392743 13902 net.cpp:141] Setting up relu6
I0913 21:05:11.392758 13902 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:05:11.392766 13902 net.cpp:156] Memory required for data: 67946040
I0913 21:05:11.392774 13902 layer_factory.hpp:77] Creating layer drop6
I0913 21:05:11.392787 13902 net.cpp:91] Creating Layer drop6
I0913 21:05:11.392792 13902 net.cpp:425] drop6 <- fc6
I0913 21:05:11.392802 13902 net.cpp:386] drop6 -> fc6 (in-place)
I0913 21:05:11.392850 13902 net.cpp:141] Setting up drop6
I0913 21:05:11.392858 13902 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:05:11.392863 13902 net.cpp:156] Memory required for data: 68109880
I0913 21:05:11.392868 13902 layer_factory.hpp:77] Creating layer fc7
I0913 21:05:11.392879 13902 net.cpp:91] Creating Layer fc7
I0913 21:05:11.392884 13902 net.cpp:425] fc7 <- fc6
I0913 21:05:11.392890 13902 net.cpp:399] fc7 -> fc7
I0913 21:05:11.442776 13902 net.cpp:141] Setting up fc7
I0913 21:05:11.442824 13902 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:05:11.442831 13902 net.cpp:156] Memory required for data: 68273720
I0913 21:05:11.442845 13902 layer_factory.hpp:77] Creating layer relu7
I0913 21:05:11.442865 13902 net.cpp:91] Creating Layer relu7
I0913 21:05:11.442873 13902 net.cpp:425] relu7 <- fc7
I0913 21:05:11.442881 13902 net.cpp:386] relu7 -> fc7 (in-place)
I0913 21:05:11.443517 13902 net.cpp:141] Setting up relu7
I0913 21:05:11.443531 13902 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:05:11.443534 13902 net.cpp:156] Memory required for data: 68437560
I0913 21:05:11.443539 13902 layer_factory.hpp:77] Creating layer drop7
I0913 21:05:11.443553 13902 net.cpp:91] Creating Layer drop7
I0913 21:05:11.443558 13902 net.cpp:425] drop7 <- fc7
I0913 21:05:11.443564 13902 net.cpp:386] drop7 -> fc7 (in-place)
I0913 21:05:11.443604 13902 net.cpp:141] Setting up drop7
I0913 21:05:11.443613 13902 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:05:11.443617 13902 net.cpp:156] Memory required for data: 68601400
I0913 21:05:11.443621 13902 layer_factory.hpp:77] Creating layer fc8
I0913 21:05:11.443630 13902 net.cpp:91] Creating Layer fc8
I0913 21:05:11.443634 13902 net.cpp:425] fc8 <- fc7
I0913 21:05:11.443645 13902 net.cpp:399] fc8 -> fc8
I0913 21:05:11.452736 13892 net.cpp:141] Setting up embedding
I0913 21:05:11.452780 13892 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:05:11.452785 13892 net.cpp:156] Memory required for data: 22408
I0913 21:05:11.452801 13892 layer_factory.hpp:77] Creating layer lstm1
I0913 21:05:11.452822 13892 net.cpp:91] Creating Layer lstm1
I0913 21:05:11.452829 13892 net.cpp:425] lstm1 <- embedded_input_frames
I0913 21:05:11.452837 13892 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0913 21:05:11.452847 13892 net.cpp:399] lstm1 -> lstm1
I0913 21:05:11.452880 13892 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0913 21:05:11.453243 13892 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0913 21:05:11.453337 13892 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:05:11.453351 13892 net.cpp:91] Creating Layer lstm1_
I0913 21:05:11.453356 13892 net.cpp:399] lstm1_ -> x
I0913 21:05:11.453367 13892 net.cpp:399] lstm1_ -> cont
I0913 21:05:11.453431 13892 net.cpp:141] Setting up lstm1_
I0913 21:05:11.453441 13892 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:05:11.453447 13892 net.cpp:148] Top shape: 1 1 (1)
I0913 21:05:11.453450 13892 net.cpp:156] Memory required for data: 2004
I0913 21:05:11.453455 13892 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:05:11.453466 13892 net.cpp:91] Creating Layer lstm1_
I0913 21:05:11.453472 13892 net.cpp:399] lstm1_ -> c_0
I0913 21:05:11.453483 13892 net.cpp:399] lstm1_ -> h_0
I0913 21:05:11.453532 13892 net.cpp:141] Setting up lstm1_
I0913 21:05:11.453541 13892 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:05:11.453547 13892 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:05:11.453550 13892 net.cpp:156] Memory required for data: 10004
I0913 21:05:11.453554 13892 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0913 21:05:11.453565 13892 net.cpp:91] Creating Layer lstm1_cont_slice
I0913 21:05:11.453570 13892 net.cpp:425] lstm1_cont_slice <- cont
I0913 21:05:11.453583 13892 net.cpp:399] lstm1_cont_slice -> cont_1
I0913 21:05:11.453629 13892 net.cpp:141] Setting up lstm1_cont_slice
I0913 21:05:11.453637 13892 net.cpp:148] Top shape: 1 1 (1)
I0913 21:05:11.453642 13892 net.cpp:156] Memory required for data: 10008
I0913 21:05:11.453646 13892 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0913 21:05:11.453655 13892 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0913 21:05:11.453658 13892 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0913 21:05:11.453667 13892 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0913 21:05:11.453675 13892 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0913 21:05:11.453722 13892 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0913 21:05:11.453729 13892 net.cpp:148] Top shape: 1 1 (1)
I0913 21:05:11.453737 13892 net.cpp:148] Top shape: 1 1 (1)
I0913 21:05:11.453740 13892 net.cpp:156] Memory required for data: 10016
I0913 21:05:11.453745 13892 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0913 21:05:11.453754 13892 net.cpp:91] Creating Layer lstm1_x_transform
I0913 21:05:11.453759 13892 net.cpp:425] lstm1_x_transform <- x
I0913 21:05:11.453768 13892 net.cpp:399] lstm1_x_transform -> W_xc_x
I0913 21:05:11.458014 13902 net.cpp:141] Setting up fc8
I0913 21:05:11.458060 13902 net.cpp:148] Top shape: 10 1000 (10000)
I0913 21:05:11.458065 13902 net.cpp:156] Memory required for data: 68641400
I0913 21:05:11.458079 13902 layer_factory.hpp:77] Creating layer prob
I0913 21:05:11.458099 13902 net.cpp:91] Creating Layer prob
I0913 21:05:11.458106 13902 net.cpp:425] prob <- fc8
I0913 21:05:11.458115 13902 net.cpp:399] prob -> prob
I0913 21:05:11.458530 13902 net.cpp:141] Setting up prob
I0913 21:05:11.458542 13902 net.cpp:148] Top shape: 10 1000 (10000)
I0913 21:05:11.458546 13902 net.cpp:156] Memory required for data: 68681400
I0913 21:05:11.458552 13902 net.cpp:219] prob does not need backward computation.
I0913 21:05:11.458557 13902 net.cpp:219] fc8 does not need backward computation.
I0913 21:05:11.458561 13902 net.cpp:219] drop7 does not need backward computation.
I0913 21:05:11.458565 13902 net.cpp:219] relu7 does not need backward computation.
I0913 21:05:11.458570 13902 net.cpp:219] fc7 does not need backward computation.
I0913 21:05:11.458572 13902 net.cpp:219] drop6 does not need backward computation.
I0913 21:05:11.458576 13902 net.cpp:219] relu6 does not need backward computation.
I0913 21:05:11.458580 13902 net.cpp:219] fc6 does not need backward computation.
I0913 21:05:11.458585 13902 net.cpp:219] pool5 does not need backward computation.
I0913 21:05:11.458588 13902 net.cpp:219] relu5 does not need backward computation.
I0913 21:05:11.458592 13902 net.cpp:219] conv5 does not need backward computation.
I0913 21:05:11.458596 13902 net.cpp:219] relu4 does not need backward computation.
I0913 21:05:11.458600 13902 net.cpp:219] conv4 does not need backward computation.
I0913 21:05:11.458603 13902 net.cpp:219] relu3 does not need backward computation.
I0913 21:05:11.458607 13902 net.cpp:219] conv3 does not need backward computation.
I0913 21:05:11.458611 13902 net.cpp:219] norm2 does not need backward computation.
I0913 21:05:11.458616 13902 net.cpp:219] pool2 does not need backward computation.
I0913 21:05:11.458621 13902 net.cpp:219] relu2 does not need backward computation.
I0913 21:05:11.458623 13902 net.cpp:219] conv2 does not need backward computation.
I0913 21:05:11.458627 13902 net.cpp:219] norm1 does not need backward computation.
I0913 21:05:11.458631 13902 net.cpp:219] pool1 does not need backward computation.
I0913 21:05:11.458636 13902 net.cpp:219] relu1 does not need backward computation.
I0913 21:05:11.458639 13902 net.cpp:219] conv1 does not need backward computation.
I0913 21:05:11.458643 13902 net.cpp:219] data does not need backward computation.
I0913 21:05:11.458647 13902 net.cpp:261] This network produces output prob
I0913 21:05:11.458670 13902 net.cpp:274] Network initialization done.
I0913 21:05:11.472988 13892 net.cpp:141] Setting up lstm1_x_transform
I0913 21:05:11.473028 13892 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:05:11.473036 13892 net.cpp:156] Memory required for data: 26016
I0913 21:05:11.473054 13892 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0913 21:05:11.473069 13892 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0913 21:05:11.473076 13892 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0913 21:05:11.473085 13892 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0913 21:05:11.473126 13892 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0913 21:05:11.473136 13892 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:05:11.473140 13892 net.cpp:156] Memory required for data: 42016
I0913 21:05:11.473145 13892 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0913 21:05:11.473157 13892 net.cpp:91] Creating Layer lstm1_h_conted_0
I0913 21:05:11.473162 13892 net.cpp:425] lstm1_h_conted_0 <- h_0
I0913 21:05:11.473168 13892 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0913 21:05:11.473176 13892 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0913 21:05:11.473275 13892 net.cpp:141] Setting up lstm1_h_conted_0
I0913 21:05:11.473284 13892 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:05:11.473289 13892 net.cpp:156] Memory required for data: 46016
I0913 21:05:11.473294 13892 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0913 21:05:11.473305 13892 net.cpp:91] Creating Layer lstm1_transform_1
I0913 21:05:11.473310 13892 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0913 21:05:11.473317 13892 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0913 21:05:11.510953 13892 net.cpp:141] Setting up lstm1_transform_1
I0913 21:05:11.510993 13892 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:05:11.511000 13892 net.cpp:156] Memory required for data: 62016
I0913 21:05:11.511016 13892 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0913 21:05:11.511037 13892 net.cpp:91] Creating Layer lstm1_gate_input_1
I0913 21:05:11.511044 13892 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0913 21:05:11.511051 13892 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0913 21:05:11.511059 13892 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0913 21:05:11.511114 13892 net.cpp:141] Setting up lstm1_gate_input_1
I0913 21:05:11.511123 13892 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:05:11.511128 13892 net.cpp:156] Memory required for data: 78016
I0913 21:05:11.511132 13892 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0913 21:05:11.511142 13892 net.cpp:91] Creating Layer lstm1_unit_1
I0913 21:05:11.511145 13892 net.cpp:425] lstm1_unit_1 <- c_0
I0913 21:05:11.511152 13892 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0913 21:05:11.511157 13892 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0913 21:05:11.511163 13892 net.cpp:399] lstm1_unit_1 -> c_1
I0913 21:05:11.511171 13892 net.cpp:399] lstm1_unit_1 -> h_1
I0913 21:05:11.511234 13892 net.cpp:141] Setting up lstm1_unit_1
I0913 21:05:11.511242 13892 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:05:11.511248 13892 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:05:11.511252 13892 net.cpp:156] Memory required for data: 86016
I0913 21:05:11.511256 13892 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:05:11.511266 13892 net.cpp:91] Creating Layer lstm1_
I0913 21:05:11.511271 13892 net.cpp:425] lstm1_ <- c_1
I0913 21:05:11.511277 13892 net.cpp:399] lstm1_ -> c_T
I0913 21:05:11.511307 13892 net.cpp:141] Setting up lstm1_
I0913 21:05:11.511314 13892 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:05:11.511318 13892 net.cpp:156] Memory required for data: 90016
I0913 21:05:11.511322 13892 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0913 21:05:11.511332 13892 net.cpp:91] Creating Layer lstm1_h_concat
I0913 21:05:11.511335 13892 net.cpp:425] lstm1_h_concat <- h_1
I0913 21:05:11.511345 13892 net.cpp:399] lstm1_h_concat -> h
I0913 21:05:11.511390 13892 net.cpp:141] Setting up lstm1_h_concat
I0913 21:05:11.511399 13892 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:05:11.511402 13892 net.cpp:156] Memory required for data: 94016
I0913 21:05:11.511406 13892 layer_factory.hpp:77] Creating layer h_pseudoloss
I0913 21:05:11.511421 13892 net.cpp:91] Creating Layer h_pseudoloss
I0913 21:05:11.511426 13892 net.cpp:425] h_pseudoloss <- h
I0913 21:05:11.511435 13892 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0913 21:05:11.511533 13892 net.cpp:141] Setting up h_pseudoloss
I0913 21:05:11.511543 13892 net.cpp:148] Top shape: (1)
I0913 21:05:11.511548 13892 net.cpp:151]     with loss weight 1
I0913 21:05:11.511586 13892 net.cpp:156] Memory required for data: 94020
I0913 21:05:11.511591 13892 net.cpp:217] h_pseudoloss needs backward computation.
I0913 21:05:11.511596 13892 net.cpp:217] lstm1_h_concat needs backward computation.
I0913 21:05:11.511600 13892 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:05:11.511605 13892 net.cpp:217] lstm1_unit_1 needs backward computation.
I0913 21:05:11.511610 13892 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0913 21:05:11.511615 13892 net.cpp:217] lstm1_transform_1 needs backward computation.
I0913 21:05:11.511618 13892 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0913 21:05:11.511623 13892 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0913 21:05:11.511627 13892 net.cpp:217] lstm1_x_transform needs backward computation.
I0913 21:05:11.511632 13892 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0913 21:05:11.511636 13892 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0913 21:05:11.511641 13892 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:05:11.511646 13892 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:05:11.511648 13892 net.cpp:261] This network produces output c_T
I0913 21:05:11.511652 13892 net.cpp:261] This network produces output h_pseudoloss
I0913 21:05:11.511668 13892 net.cpp:274] Network initialization done.
I0913 21:05:11.511718 13892 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0913 21:05:11.511723 13892 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0913 21:05:11.511728 13892 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0913 21:05:11.511829 13892 net.cpp:141] Setting up lstm1
I0913 21:05:11.511839 13892 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:05:11.511843 13892 net.cpp:156] Memory required for data: 26408
I0913 21:05:11.511855 13892 layer_factory.hpp:77] Creating layer concat
I0913 21:05:11.511864 13892 net.cpp:91] Creating Layer concat
I0913 21:05:11.511869 13892 net.cpp:425] concat <- lstm1
I0913 21:05:11.511876 13892 net.cpp:425] concat <- embedded_input_sentence
I0913 21:05:11.511881 13892 net.cpp:425] concat <- reshaped_stage_indicator
I0913 21:05:11.511888 13892 net.cpp:399] concat -> lstm1_video_sequence
I0913 21:05:11.511920 13892 net.cpp:141] Setting up concat
I0913 21:05:11.511929 13892 net.cpp:148] Top shape: 1 1 1501 (1501)
I0913 21:05:11.511932 13892 net.cpp:156] Memory required for data: 32412
I0913 21:05:11.511937 13892 layer_factory.hpp:77] Creating layer lstm2
I0913 21:05:11.511950 13892 net.cpp:91] Creating Layer lstm2
I0913 21:05:11.511955 13892 net.cpp:425] lstm2 <- lstm1_video_sequence
I0913 21:05:11.511960 13892 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0913 21:05:11.511965 13892 net.cpp:399] lstm2 -> lstm2
I0913 21:05:11.511976 13892 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0913 21:05:11.512219 13892 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0913 21:05:11.512302 13892 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:05:11.512318 13892 net.cpp:91] Creating Layer lstm2_
I0913 21:05:11.512325 13892 net.cpp:399] lstm2_ -> x
I0913 21:05:11.512336 13892 net.cpp:399] lstm2_ -> cont
I0913 21:05:11.512387 13892 net.cpp:141] Setting up lstm2_
I0913 21:05:11.512395 13892 net.cpp:148] Top shape: 1 1 1501 (1501)
I0913 21:05:11.512401 13892 net.cpp:148] Top shape: 1 1 (1)
I0913 21:05:11.512405 13892 net.cpp:156] Memory required for data: 6008
I0913 21:05:11.512409 13892 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:05:11.512418 13892 net.cpp:91] Creating Layer lstm2_
I0913 21:05:11.512423 13892 net.cpp:399] lstm2_ -> c_0
I0913 21:05:11.512431 13892 net.cpp:399] lstm2_ -> h_0
I0913 21:05:11.512477 13892 net.cpp:141] Setting up lstm2_
I0913 21:05:11.512486 13892 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:05:11.512491 13892 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:05:11.512495 13892 net.cpp:156] Memory required for data: 14008
I0913 21:05:11.512500 13892 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0913 21:05:11.512507 13892 net.cpp:91] Creating Layer lstm2_cont_slice
I0913 21:05:11.512511 13892 net.cpp:425] lstm2_cont_slice <- cont
I0913 21:05:11.512521 13892 net.cpp:399] lstm2_cont_slice -> cont_1
I0913 21:05:11.512552 13892 net.cpp:141] Setting up lstm2_cont_slice
I0913 21:05:11.512559 13892 net.cpp:148] Top shape: 1 1 (1)
I0913 21:05:11.512564 13892 net.cpp:156] Memory required for data: 14012
I0913 21:05:11.512569 13892 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0913 21:05:11.512575 13892 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0913 21:05:11.512579 13892 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0913 21:05:11.512585 13892 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0913 21:05:11.512593 13892 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0913 21:05:11.512637 13892 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0913 21:05:11.512646 13892 net.cpp:148] Top shape: 1 1 (1)
I0913 21:05:11.512651 13892 net.cpp:148] Top shape: 1 1 (1)
I0913 21:05:11.512655 13892 net.cpp:156] Memory required for data: 14020
I0913 21:05:11.512660 13892 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0913 21:05:11.512670 13892 net.cpp:91] Creating Layer lstm2_x_transform
I0913 21:05:11.512676 13892 net.cpp:425] lstm2_x_transform <- x
I0913 21:05:11.512682 13892 net.cpp:399] lstm2_x_transform -> W_xc_x
I0913 21:05:11.569020 13892 net.cpp:141] Setting up lstm2_x_transform
I0913 21:05:11.569063 13892 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:05:11.569069 13892 net.cpp:156] Memory required for data: 30020
I0913 21:05:11.569088 13892 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0913 21:05:11.569104 13892 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0913 21:05:11.569111 13892 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0913 21:05:11.569124 13892 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0913 21:05:11.569167 13892 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0913 21:05:11.569176 13892 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:05:11.569181 13892 net.cpp:156] Memory required for data: 46020
I0913 21:05:11.569185 13892 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0913 21:05:11.569196 13892 net.cpp:91] Creating Layer lstm2_h_conted_0
I0913 21:05:11.569201 13892 net.cpp:425] lstm2_h_conted_0 <- h_0
I0913 21:05:11.569206 13892 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0913 21:05:11.569216 13892 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0913 21:05:11.569308 13892 net.cpp:141] Setting up lstm2_h_conted_0
I0913 21:05:11.569316 13892 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:05:11.569320 13892 net.cpp:156] Memory required for data: 50020
I0913 21:05:11.569325 13892 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0913 21:05:11.569339 13892 net.cpp:91] Creating Layer lstm2_transform_1
I0913 21:05:11.569344 13892 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0913 21:05:11.569351 13892 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0913 21:05:11.606889 13892 net.cpp:141] Setting up lstm2_transform_1
I0913 21:05:11.606927 13892 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:05:11.606933 13892 net.cpp:156] Memory required for data: 66020
I0913 21:05:11.606950 13892 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0913 21:05:11.606971 13892 net.cpp:91] Creating Layer lstm2_gate_input_1
I0913 21:05:11.606978 13892 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0913 21:05:11.606986 13892 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0913 21:05:11.606995 13892 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0913 21:05:11.607043 13892 net.cpp:141] Setting up lstm2_gate_input_1
I0913 21:05:11.607051 13892 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:05:11.607055 13892 net.cpp:156] Memory required for data: 82020
I0913 21:05:11.607060 13892 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0913 21:05:11.607072 13892 net.cpp:91] Creating Layer lstm2_unit_1
I0913 21:05:11.607076 13892 net.cpp:425] lstm2_unit_1 <- c_0
I0913 21:05:11.607082 13892 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0913 21:05:11.607087 13892 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0913 21:05:11.607094 13892 net.cpp:399] lstm2_unit_1 -> c_1
I0913 21:05:11.607101 13892 net.cpp:399] lstm2_unit_1 -> h_1
I0913 21:05:11.607161 13892 net.cpp:141] Setting up lstm2_unit_1
I0913 21:05:11.607170 13892 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:05:11.607175 13892 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:05:11.607179 13892 net.cpp:156] Memory required for data: 90020
I0913 21:05:11.607184 13892 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:05:11.607192 13892 net.cpp:91] Creating Layer lstm2_
I0913 21:05:11.607197 13892 net.cpp:425] lstm2_ <- c_1
I0913 21:05:11.607205 13892 net.cpp:399] lstm2_ -> c_T
I0913 21:05:11.607234 13892 net.cpp:141] Setting up lstm2_
I0913 21:05:11.607242 13892 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:05:11.607246 13892 net.cpp:156] Memory required for data: 94020
I0913 21:05:11.607251 13892 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0913 21:05:11.607260 13892 net.cpp:91] Creating Layer lstm2_h_concat
I0913 21:05:11.607264 13892 net.cpp:425] lstm2_h_concat <- h_1
I0913 21:05:11.607270 13892 net.cpp:399] lstm2_h_concat -> h
I0913 21:05:11.607305 13892 net.cpp:141] Setting up lstm2_h_concat
I0913 21:05:11.607313 13892 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:05:11.607317 13892 net.cpp:156] Memory required for data: 98020
I0913 21:05:11.607321 13892 layer_factory.hpp:77] Creating layer h_pseudoloss
I0913 21:05:11.607329 13892 net.cpp:91] Creating Layer h_pseudoloss
I0913 21:05:11.607334 13892 net.cpp:425] h_pseudoloss <- h
I0913 21:05:11.607341 13892 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0913 21:05:11.607429 13892 net.cpp:141] Setting up h_pseudoloss
I0913 21:05:11.607439 13892 net.cpp:148] Top shape: (1)
I0913 21:05:11.607442 13892 net.cpp:151]     with loss weight 1
I0913 21:05:11.607460 13892 net.cpp:156] Memory required for data: 98024
I0913 21:05:11.607463 13892 net.cpp:217] h_pseudoloss needs backward computation.
I0913 21:05:11.607468 13892 net.cpp:217] lstm2_h_concat needs backward computation.
I0913 21:05:11.607472 13892 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:05:11.607476 13892 net.cpp:217] lstm2_unit_1 needs backward computation.
I0913 21:05:11.607483 13892 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0913 21:05:11.607488 13892 net.cpp:217] lstm2_transform_1 needs backward computation.
I0913 21:05:11.607493 13892 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0913 21:05:11.607498 13892 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0913 21:05:11.607503 13892 net.cpp:217] lstm2_x_transform needs backward computation.
I0913 21:05:11.607507 13892 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0913 21:05:11.607512 13892 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0913 21:05:11.607517 13892 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:05:11.607520 13892 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:05:11.607523 13892 net.cpp:261] This network produces output c_T
I0913 21:05:11.607527 13892 net.cpp:261] This network produces output h_pseudoloss
I0913 21:05:11.607542 13892 net.cpp:274] Network initialization done.
I0913 21:05:11.607585 13892 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0913 21:05:11.607591 13892 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0913 21:05:11.607595 13892 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0913 21:05:11.607689 13892 net.cpp:141] Setting up lstm2
I0913 21:05:11.607702 13892 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:05:11.607705 13892 net.cpp:156] Memory required for data: 36412
I0913 21:05:11.607718 13892 layer_factory.hpp:77] Creating layer predict
I0913 21:05:11.607730 13892 net.cpp:91] Creating Layer predict
I0913 21:05:11.607735 13892 net.cpp:425] predict <- lstm2
I0913 21:05:11.607743 13892 net.cpp:399] predict -> predict
I0913 21:05:11.743752 13902 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /home/peifeng/work/run/storm102/data/workers/78277562-7263-45cf-a8c5-10b407bd07b2/tmp/cvld2876351053615315575/bvlc_reference_caffenet.caffemodel
I0913 21:05:11.743796 13902 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0913 21:05:11.743803 13902 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0913 21:05:11.743806 13902 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /home/peifeng/work/run/storm102/data/workers/78277562-7263-45cf-a8c5-10b407bd07b2/tmp/cvld2876351053615315575/bvlc_reference_caffenet.caffemodel
I0913 21:05:12.039563 13892 net.cpp:141] Setting up predict
I0913 21:05:12.039605 13892 net.cpp:148] Top shape: 1 1 46168 (46168)
I0913 21:05:12.039611 13892 net.cpp:156] Memory required for data: 221084
I0913 21:05:12.039624 13892 layer_factory.hpp:77] Creating layer probs
I0913 21:05:12.039640 13892 net.cpp:91] Creating Layer probs
I0913 21:05:12.039647 13892 net.cpp:425] probs <- predict
I0913 21:05:12.039656 13892 net.cpp:399] probs -> probs
I0913 21:05:12.040477 13892 net.cpp:141] Setting up probs
I0913 21:05:12.040490 13892 net.cpp:148] Top shape: 1 1 46168 (46168)
I0913 21:05:12.040494 13892 net.cpp:156] Memory required for data: 405756
I0913 21:05:12.040499 13892 net.cpp:219] probs does not need backward computation.
I0913 21:05:12.040504 13892 net.cpp:219] predict does not need backward computation.
I0913 21:05:12.040508 13892 net.cpp:219] lstm2 does not need backward computation.
I0913 21:05:12.040513 13892 net.cpp:219] concat does not need backward computation.
I0913 21:05:12.040518 13892 net.cpp:219] lstm1 does not need backward computation.
I0913 21:05:12.040524 13892 net.cpp:219] embedding does not need backward computation.
I0913 21:05:12.040527 13892 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0913 21:05:12.040532 13892 net.cpp:219] reshape_frames does not need backward computation.
I0913 21:05:12.040536 13892 net.cpp:219] embed_encoder does not need backward computation.
I0913 21:05:12.040540 13892 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0913 21:05:12.040545 13892 net.cpp:219] input does not need backward computation.
I0913 21:05:12.040549 13892 net.cpp:261] This network produces output probs
I0913 21:05:12.040565 13892 net.cpp:274] Network initialization done.
I0913 21:05:12.111134 13902 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0913 21:05:12.157774 13902 net.cpp:752] Ignoring source layer loss
Loading the model + trained: 10450.6ms
Using cv::Size and some other stuff: 0.139ms
I0913 21:05:12.408035 13892 net.cpp:752] Ignoring source layer data
I0913 21:05:12.408067 13892 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0913 21:05:12.408082 13892 net.cpp:752] Ignoring source layer reshape_stg_indicator
Loading the mean file: 1802.96ms
I0913 21:05:12.473780 13892 net.cpp:752] Ignoring source layer cross_entropy_loss
TIMERTIMER 124765063
TIMERTIMER 63197774
TIMERTIMER 66232009
TIMERTIMER 47439143
TIMERTIMER 47864260
TIMERTIMER 45165549
TIMERTIMER 46585892
TIMERTIMER 48221308
TIMERTIMER 47785534
TIMERTIMER 44922643
TIMERTIMER 48580749
TIMERTIMER 48628259
TIMERTIMER 49149264
TIMERTIMER 49566407
TIMERTIMER 49389480
TIMERTIMER 43695680
TIMERTIMER 45609393
TIMERTIMER 43707907
TIMERTIMER 49736363
TIMERTIMER 31146013
TIMERTIMER 37659270
TIMERTIMER 31661044
TIMERTIMER 38254964
TIMERTIMER 37780602
TIMERTIMER 31386047
TIMERTIMER 37495924
TIMERTIMER 35715548
TIMERTIMER 31934189
TIMERTIMER 31457335
TIMERTIMER 37493168
TIMERTIMER 31311432
TIMERTIMER 37619837
TIMERTIMER 37901226
TIMERTIMER 35172736
TIMERTIMER 31377512
TIMERTIMER 31775879
TIMERTIMER 32035554
TIMERTIMER 32210763
TIMERTIMER 31517155
TIMERTIMER 31761742
TIMERTIMER 38687977
TIMERTIMER 38052203
TIMERTIMER 37983470
TIMERTIMER 31847732
TIMERTIMER 38947084
TIMERTIMER 38106186
TIMERTIMER 31566215
TIMERTIMER 31943951
TIMERTIMER 38296589
TIMERTIMER 38538957
TIMERTIMER 32468094
TIMERTIMER 38037901
TIMERTIMER 38243812
TIMERTIMER 37880073
TIMERTIMER 32047673
TIMERTIMER 38196153
TIMERTIMER 36021973
TIMERTIMER 38433536
TIMERTIMER 33503228
TIMERTIMER 38220333
TIMERTIMER 33307925
TIMERTIMER 31849643
TIMERTIMER 32059652
TIMERTIMER 38329782
TIMERTIMER 32150200
TIMERTIMER 38428152
TIMERTIMER 31816541
TIMERTIMER 31733714
TIMERTIMER 32160955
TIMERTIMER 31958201
TIMERTIMER 37909053
TIMERTIMER 31879713
TIMERTIMER 32653984
TIMERTIMER 38572985
TIMERTIMER 31858580
TIMERTIMER 31713644
TIMERTIMER 38267570
TIMERTIMER 31925304
TIMERTIMER 31859702
TIMERTIMER 31729989
TIMERTIMER 31868388
TIMERTIMER 38051849
TIMERTIMER 39108663
TIMERTIMER 38426155
TIMERTIMER 31825957
TIMERTIMER 38380136
TIMERTIMER 31787825
TIMERTIMER 33107290
TIMERTIMER 32878640
TIMERTIMER 31729749
TIMERTIMER 37804439
TIMERTIMER 31905436
TIMERTIMER 38950405
TIMERTIMER 32697025
TIMERTIMER 38306535
TIMERTIMER 31701395
TIMERTIMER 31812253
TIMERTIMER 32018772
TIMERTIMER 32425279
TIMERTIMER 37962409
TIMERTIMER 32550750
TIMERTIMER 37800046
TIMERTIMER 38062829
TIMERTIMER 33708864
TIMERTIMER 37844921
TIMERTIMER 38623350
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/peifeng/tools/storm102/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/peifeng/work/run/storm102/data/supervisor/stormdist/captioning-1-1473815071/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /home/peifeng/work/run/storm102/data/workers/c35e6a57-bee3-4006-b186-a1251ae5127a/tmp/cvld2549614463368891675/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0913 21:06:22.956809 14047 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0913 21:06:22.957015 14047 layer_factory.hpp:77] Creating layer data
I0913 21:06:22.957046 14047 net.cpp:91] Creating Layer data
I0913 21:06:22.957056 14047 net.cpp:399] data -> data
I0913 21:06:23.507169 14047 net.cpp:141] Setting up data
I0913 21:06:23.507292 14047 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0913 21:06:23.507299 14047 net.cpp:156] Memory required for data: 6183480
I0913 21:06:23.507318 14047 layer_factory.hpp:77] Creating layer conv1
I0913 21:06:23.507352 14047 net.cpp:91] Creating Layer conv1
I0913 21:06:23.507362 14047 net.cpp:425] conv1 <- data
I0913 21:06:23.507376 14047 net.cpp:399] conv1 -> conv1
I0913 21:06:23.682517 14047 net.cpp:141] Setting up conv1
I0913 21:06:23.682569 14047 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0913 21:06:23.682575 14047 net.cpp:156] Memory required for data: 17799480
I0913 21:06:23.682605 14047 layer_factory.hpp:77] Creating layer relu1
I0913 21:06:23.682629 14047 net.cpp:91] Creating Layer relu1
I0913 21:06:23.682636 14047 net.cpp:425] relu1 <- conv1
I0913 21:06:23.682644 14047 net.cpp:386] relu1 -> conv1 (in-place)
I0913 21:06:23.683046 14047 net.cpp:141] Setting up relu1
I0913 21:06:23.683059 14047 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0913 21:06:23.683063 14047 net.cpp:156] Memory required for data: 29415480
I0913 21:06:23.683068 14047 layer_factory.hpp:77] Creating layer pool1
I0913 21:06:23.683081 14047 net.cpp:91] Creating Layer pool1
I0913 21:06:23.683086 14047 net.cpp:425] pool1 <- conv1
I0913 21:06:23.683097 14047 net.cpp:399] pool1 -> pool1
I0913 21:06:23.683166 14047 net.cpp:141] Setting up pool1
I0913 21:06:23.683176 14047 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0913 21:06:23.683181 14047 net.cpp:156] Memory required for data: 32214840
I0913 21:06:23.683185 14047 layer_factory.hpp:77] Creating layer norm1
I0913 21:06:23.683205 14047 net.cpp:91] Creating Layer norm1
I0913 21:06:23.683212 14047 net.cpp:425] norm1 <- pool1
I0913 21:06:23.683219 14047 net.cpp:399] norm1 -> norm1
I0913 21:06:23.683486 14047 net.cpp:141] Setting up norm1
I0913 21:06:23.683498 14047 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0913 21:06:23.683502 14047 net.cpp:156] Memory required for data: 35014200
I0913 21:06:23.683507 14047 layer_factory.hpp:77] Creating layer conv2
I0913 21:06:23.683526 14047 net.cpp:91] Creating Layer conv2
I0913 21:06:23.683531 14047 net.cpp:425] conv2 <- norm1
I0913 21:06:23.683540 14047 net.cpp:399] conv2 -> conv2
I0913 21:06:23.688861 14047 net.cpp:141] Setting up conv2
I0913 21:06:23.688890 14047 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0913 21:06:23.688895 14047 net.cpp:156] Memory required for data: 42479160
I0913 21:06:23.688910 14047 layer_factory.hpp:77] Creating layer relu2
I0913 21:06:23.688926 14047 net.cpp:91] Creating Layer relu2
I0913 21:06:23.688932 14047 net.cpp:425] relu2 <- conv2
I0913 21:06:23.688940 14047 net.cpp:386] relu2 -> conv2 (in-place)
I0913 21:06:23.689349 14047 net.cpp:141] Setting up relu2
I0913 21:06:23.689363 14047 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0913 21:06:23.689368 14047 net.cpp:156] Memory required for data: 49944120
I0913 21:06:23.689373 14047 layer_factory.hpp:77] Creating layer pool2
I0913 21:06:23.689381 14047 net.cpp:91] Creating Layer pool2
I0913 21:06:23.689386 14047 net.cpp:425] pool2 <- conv2
I0913 21:06:23.689395 14047 net.cpp:399] pool2 -> pool2
I0913 21:06:23.689452 14047 net.cpp:141] Setting up pool2
I0913 21:06:23.689463 14047 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:06:23.689467 14047 net.cpp:156] Memory required for data: 51674680
I0913 21:06:23.689472 14047 layer_factory.hpp:77] Creating layer norm2
I0913 21:06:23.689483 14047 net.cpp:91] Creating Layer norm2
I0913 21:06:23.689487 14047 net.cpp:425] norm2 <- pool2
I0913 21:06:23.689497 14047 net.cpp:399] norm2 -> norm2
I0913 21:06:23.689746 14047 net.cpp:141] Setting up norm2
I0913 21:06:23.689759 14047 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:06:23.689764 14047 net.cpp:156] Memory required for data: 53405240
I0913 21:06:23.689769 14047 layer_factory.hpp:77] Creating layer conv3
I0913 21:06:23.689781 14047 net.cpp:91] Creating Layer conv3
I0913 21:06:23.689786 14047 net.cpp:425] conv3 <- norm2
I0913 21:06:23.689796 14047 net.cpp:399] conv3 -> conv3
I0913 21:06:23.693615 14047 net.cpp:141] Setting up conv3
I0913 21:06:23.693639 14047 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:06:23.693645 14047 net.cpp:156] Memory required for data: 56001080
I0913 21:06:23.693657 14047 layer_factory.hpp:77] Creating layer relu3
I0913 21:06:23.693672 14047 net.cpp:91] Creating Layer relu3
I0913 21:06:23.693677 14047 net.cpp:425] relu3 <- conv3
I0913 21:06:23.693684 14047 net.cpp:386] relu3 -> conv3 (in-place)
I0913 21:06:23.693908 14047 net.cpp:141] Setting up relu3
I0913 21:06:23.693920 14047 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:06:23.693924 14047 net.cpp:156] Memory required for data: 58596920
I0913 21:06:23.693929 14047 layer_factory.hpp:77] Creating layer conv4
I0913 21:06:23.693943 14047 net.cpp:91] Creating Layer conv4
I0913 21:06:23.693948 14047 net.cpp:425] conv4 <- conv3
I0913 21:06:23.693955 14047 net.cpp:399] conv4 -> conv4
I0913 21:06:23.698006 14047 net.cpp:141] Setting up conv4
I0913 21:06:23.698047 14047 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:06:23.698053 14047 net.cpp:156] Memory required for data: 61192760
I0913 21:06:23.698065 14047 layer_factory.hpp:77] Creating layer relu4
I0913 21:06:23.698087 14047 net.cpp:91] Creating Layer relu4
I0913 21:06:23.698094 14047 net.cpp:425] relu4 <- conv4
I0913 21:06:23.698102 14047 net.cpp:386] relu4 -> conv4 (in-place)
I0913 21:06:23.698493 14047 net.cpp:141] Setting up relu4
I0913 21:06:23.698505 14047 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0913 21:06:23.698510 14047 net.cpp:156] Memory required for data: 63788600
I0913 21:06:23.698515 14047 layer_factory.hpp:77] Creating layer conv5
I0913 21:06:23.698532 14047 net.cpp:91] Creating Layer conv5
I0913 21:06:23.698539 14047 net.cpp:425] conv5 <- conv4
I0913 21:06:23.698549 14047 net.cpp:399] conv5 -> conv5
I0913 21:06:23.702431 14047 net.cpp:141] Setting up conv5
I0913 21:06:23.702471 14047 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:06:23.702476 14047 net.cpp:156] Memory required for data: 65519160
I0913 21:06:23.702496 14047 layer_factory.hpp:77] Creating layer relu5
I0913 21:06:23.702510 14047 net.cpp:91] Creating Layer relu5
I0913 21:06:23.702515 14047 net.cpp:425] relu5 <- conv5
I0913 21:06:23.702527 14047 net.cpp:386] relu5 -> conv5 (in-place)
I0913 21:06:23.702932 14047 net.cpp:141] Setting up relu5
I0913 21:06:23.702945 14047 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0913 21:06:23.702950 14047 net.cpp:156] Memory required for data: 67249720
I0913 21:06:23.702955 14047 layer_factory.hpp:77] Creating layer pool5
I0913 21:06:23.702968 14047 net.cpp:91] Creating Layer pool5
I0913 21:06:23.702973 14047 net.cpp:425] pool5 <- conv5
I0913 21:06:23.702981 14047 net.cpp:399] pool5 -> pool5
I0913 21:06:23.703044 14047 net.cpp:141] Setting up pool5
I0913 21:06:23.703053 14047 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0913 21:06:23.703058 14047 net.cpp:156] Memory required for data: 67618360
I0913 21:06:23.703063 14047 layer_factory.hpp:77] Creating layer fc6
I0913 21:06:23.703090 14047 net.cpp:91] Creating Layer fc6
I0913 21:06:23.703095 14047 net.cpp:425] fc6 <- pool5
I0913 21:06:23.703102 14047 net.cpp:399] fc6 -> fc6
I0913 21:06:23.804896 14047 net.cpp:141] Setting up fc6
I0913 21:06:23.804946 14047 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:06:23.804951 14047 net.cpp:156] Memory required for data: 67782200
I0913 21:06:23.804966 14047 layer_factory.hpp:77] Creating layer relu6
I0913 21:06:23.804985 14047 net.cpp:91] Creating Layer relu6
I0913 21:06:23.804991 14047 net.cpp:425] relu6 <- fc6
I0913 21:06:23.805002 14047 net.cpp:386] relu6 -> fc6 (in-place)
I0913 21:06:23.805321 14047 net.cpp:141] Setting up relu6
I0913 21:06:23.805332 14047 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:06:23.805337 14047 net.cpp:156] Memory required for data: 67946040
I0913 21:06:23.805341 14047 layer_factory.hpp:77] Creating layer drop6
I0913 21:06:23.805351 14047 net.cpp:91] Creating Layer drop6
I0913 21:06:23.805356 14047 net.cpp:425] drop6 <- fc6
I0913 21:06:23.805366 14047 net.cpp:386] drop6 -> fc6 (in-place)
I0913 21:06:23.805415 14047 net.cpp:141] Setting up drop6
I0913 21:06:23.805424 14047 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:06:23.805428 14047 net.cpp:156] Memory required for data: 68109880
I0913 21:06:23.805433 14047 layer_factory.hpp:77] Creating layer fc7
I0913 21:06:23.805443 14047 net.cpp:91] Creating Layer fc7
I0913 21:06:23.805447 14047 net.cpp:425] fc7 <- fc6
I0913 21:06:23.805459 14047 net.cpp:399] fc7 -> fc7
I0913 21:06:23.844761 14037 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/c35e6a57-bee3-4006-b186-a1251ae5127a/tmp/cvld2549614463368891675/s2vt.words_to_preds.prototxt
I0913 21:06:23.844826 14037 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0913 21:06:23.844835 14037 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0913 21:06:23.845105 14037 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0913 21:06:23.845207 14037 layer_factory.hpp:77] Creating layer input
I0913 21:06:23.845223 14037 net.cpp:91] Creating Layer input
I0913 21:06:23.845232 14037 net.cpp:399] input -> frames_fc7
I0913 21:06:23.845252 14037 net.cpp:399] input -> cont_sentence
I0913 21:06:23.845263 14037 net.cpp:399] input -> input_sentence
I0913 21:06:23.845273 14037 net.cpp:399] input -> stage_indicator
I0913 21:06:23.845420 14037 net.cpp:141] Setting up input
I0913 21:06:23.845433 14037 net.cpp:148] Top shape: 1 4096 (4096)
I0913 21:06:23.845439 14037 net.cpp:148] Top shape: 1 1 (1)
I0913 21:06:23.845444 14037 net.cpp:148] Top shape: 1 1 (1)
I0913 21:06:23.845449 14037 net.cpp:148] Top shape: 1 1 (1)
I0913 21:06:23.845453 14037 net.cpp:156] Memory required for data: 16396
I0913 21:06:23.845459 14037 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0913 21:06:23.845480 14037 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0913 21:06:23.845487 14037 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0913 21:06:23.845510 14037 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0913 21:06:23.845520 14037 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0913 21:06:23.845569 14037 net.cpp:141] Setting up cont_sentence_input_1_split
I0913 21:06:23.845582 14037 net.cpp:148] Top shape: 1 1 (1)
I0913 21:06:23.845587 14037 net.cpp:148] Top shape: 1 1 (1)
I0913 21:06:23.845592 14037 net.cpp:156] Memory required for data: 16404
I0913 21:06:23.845595 14037 layer_factory.hpp:77] Creating layer embed_encoder
I0913 21:06:23.845605 14037 net.cpp:91] Creating Layer embed_encoder
I0913 21:06:23.845610 14037 net.cpp:425] embed_encoder <- frames_fc7
I0913 21:06:23.845619 14037 net.cpp:399] embed_encoder -> embedded_in_frames
I0913 21:06:23.851202 14047 net.cpp:141] Setting up fc7
I0913 21:06:23.851248 14047 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:06:23.851254 14047 net.cpp:156] Memory required for data: 68273720
I0913 21:06:23.851269 14047 layer_factory.hpp:77] Creating layer relu7
I0913 21:06:23.851290 14047 net.cpp:91] Creating Layer relu7
I0913 21:06:23.851299 14047 net.cpp:425] relu7 <- fc7
I0913 21:06:23.851310 14047 net.cpp:386] relu7 -> fc7 (in-place)
I0913 21:06:23.851936 14047 net.cpp:141] Setting up relu7
I0913 21:06:23.851949 14047 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:06:23.851954 14047 net.cpp:156] Memory required for data: 68437560
I0913 21:06:23.851959 14047 layer_factory.hpp:77] Creating layer drop7
I0913 21:06:23.851970 14047 net.cpp:91] Creating Layer drop7
I0913 21:06:23.851975 14047 net.cpp:425] drop7 <- fc7
I0913 21:06:23.851985 14047 net.cpp:386] drop7 -> fc7 (in-place)
I0913 21:06:23.852022 14047 net.cpp:141] Setting up drop7
I0913 21:06:23.852031 14047 net.cpp:148] Top shape: 10 4096 (40960)
I0913 21:06:23.852035 14047 net.cpp:156] Memory required for data: 68601400
I0913 21:06:23.852040 14047 layer_factory.hpp:77] Creating layer fc8
I0913 21:06:23.852053 14047 net.cpp:91] Creating Layer fc8
I0913 21:06:23.852058 14047 net.cpp:425] fc8 <- fc7
I0913 21:06:23.852066 14047 net.cpp:399] fc8 -> fc8
I0913 21:06:23.863637 14047 net.cpp:141] Setting up fc8
I0913 21:06:23.863682 14047 net.cpp:148] Top shape: 10 1000 (10000)
I0913 21:06:23.863687 14047 net.cpp:156] Memory required for data: 68641400
I0913 21:06:23.863703 14047 layer_factory.hpp:77] Creating layer prob
I0913 21:06:23.863720 14047 net.cpp:91] Creating Layer prob
I0913 21:06:23.863726 14047 net.cpp:425] prob <- fc8
I0913 21:06:23.863736 14047 net.cpp:399] prob -> prob
I0913 21:06:23.864164 14047 net.cpp:141] Setting up prob
I0913 21:06:23.864176 14047 net.cpp:148] Top shape: 10 1000 (10000)
I0913 21:06:23.864181 14047 net.cpp:156] Memory required for data: 68681400
I0913 21:06:23.864187 14047 net.cpp:219] prob does not need backward computation.
I0913 21:06:23.864192 14047 net.cpp:219] fc8 does not need backward computation.
I0913 21:06:23.864197 14047 net.cpp:219] drop7 does not need backward computation.
I0913 21:06:23.864200 14047 net.cpp:219] relu7 does not need backward computation.
I0913 21:06:23.864204 14047 net.cpp:219] fc7 does not need backward computation.
I0913 21:06:23.864208 14047 net.cpp:219] drop6 does not need backward computation.
I0913 21:06:23.864212 14047 net.cpp:219] relu6 does not need backward computation.
I0913 21:06:23.864217 14047 net.cpp:219] fc6 does not need backward computation.
I0913 21:06:23.864222 14047 net.cpp:219] pool5 does not need backward computation.
I0913 21:06:23.864225 14047 net.cpp:219] relu5 does not need backward computation.
I0913 21:06:23.864229 14047 net.cpp:219] conv5 does not need backward computation.
I0913 21:06:23.864234 14047 net.cpp:219] relu4 does not need backward computation.
I0913 21:06:23.864238 14047 net.cpp:219] conv4 does not need backward computation.
I0913 21:06:23.864243 14047 net.cpp:219] relu3 does not need backward computation.
I0913 21:06:23.864246 14047 net.cpp:219] conv3 does not need backward computation.
I0913 21:06:23.864251 14047 net.cpp:219] norm2 does not need backward computation.
I0913 21:06:23.864256 14047 net.cpp:219] pool2 does not need backward computation.
I0913 21:06:23.864260 14047 net.cpp:219] relu2 does not need backward computation.
I0913 21:06:23.864264 14047 net.cpp:219] conv2 does not need backward computation.
I0913 21:06:23.864269 14047 net.cpp:219] norm1 does not need backward computation.
I0913 21:06:23.864274 14047 net.cpp:219] pool1 does not need backward computation.
I0913 21:06:23.864277 14047 net.cpp:219] relu1 does not need backward computation.
I0913 21:06:23.864281 14047 net.cpp:219] conv1 does not need backward computation.
I0913 21:06:23.864285 14047 net.cpp:219] data does not need backward computation.
I0913 21:06:23.864289 14047 net.cpp:261] This network produces output prob
I0913 21:06:23.864310 14047 net.cpp:274] Network initialization done.
I0913 21:06:23.866137 14037 net.cpp:141] Setting up embed_encoder
I0913 21:06:23.866155 14037 net.cpp:148] Top shape: 1 500 (500)
I0913 21:06:23.866160 14037 net.cpp:156] Memory required for data: 18404
I0913 21:06:23.866178 14037 layer_factory.hpp:77] Creating layer reshape_frames
I0913 21:06:23.866200 14037 net.cpp:91] Creating Layer reshape_frames
I0913 21:06:23.866206 14037 net.cpp:425] reshape_frames <- embedded_in_frames
I0913 21:06:23.866216 14037 net.cpp:399] reshape_frames -> embedded_input_frames
I0913 21:06:23.866264 14037 net.cpp:141] Setting up reshape_frames
I0913 21:06:23.866273 14037 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:06:23.866278 14037 net.cpp:156] Memory required for data: 20404
I0913 21:06:23.866282 14037 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0913 21:06:23.866294 14037 net.cpp:91] Creating Layer reshape_stage_indicator
I0913 21:06:23.866299 14037 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0913 21:06:23.866307 14037 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0913 21:06:23.866343 14037 net.cpp:141] Setting up reshape_stage_indicator
I0913 21:06:23.866353 14037 net.cpp:148] Top shape: 1 1 1 (1)
I0913 21:06:23.866356 14037 net.cpp:156] Memory required for data: 20408
I0913 21:06:23.866361 14037 layer_factory.hpp:77] Creating layer embedding
I0913 21:06:23.866372 14037 net.cpp:91] Creating Layer embedding
I0913 21:06:23.866376 14037 net.cpp:425] embedding <- input_sentence
I0913 21:06:23.866385 14037 net.cpp:399] embedding -> embedded_input_sentence
I0913 21:06:24.094239 14037 net.cpp:141] Setting up embedding
I0913 21:06:24.094307 14037 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:06:24.094315 14037 net.cpp:156] Memory required for data: 22408
I0913 21:06:24.094331 14037 layer_factory.hpp:77] Creating layer lstm1
I0913 21:06:24.094353 14037 net.cpp:91] Creating Layer lstm1
I0913 21:06:24.094362 14037 net.cpp:425] lstm1 <- embedded_input_frames
I0913 21:06:24.094372 14037 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0913 21:06:24.094380 14037 net.cpp:399] lstm1 -> lstm1
I0913 21:06:24.094408 14037 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0913 21:06:24.094786 14037 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0913 21:06:24.094878 14037 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:06:24.094892 14037 net.cpp:91] Creating Layer lstm1_
I0913 21:06:24.094897 14037 net.cpp:399] lstm1_ -> x
I0913 21:06:24.094909 14037 net.cpp:399] lstm1_ -> cont
I0913 21:06:24.094967 14037 net.cpp:141] Setting up lstm1_
I0913 21:06:24.094977 14037 net.cpp:148] Top shape: 1 1 500 (500)
I0913 21:06:24.094983 14037 net.cpp:148] Top shape: 1 1 (1)
I0913 21:06:24.094987 14037 net.cpp:156] Memory required for data: 2004
I0913 21:06:24.094992 14037 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:06:24.095003 14037 net.cpp:91] Creating Layer lstm1_
I0913 21:06:24.095010 14037 net.cpp:399] lstm1_ -> c_0
I0913 21:06:24.095019 14037 net.cpp:399] lstm1_ -> h_0
I0913 21:06:24.095067 14037 net.cpp:141] Setting up lstm1_
I0913 21:06:24.095082 14037 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:06:24.095089 14037 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:06:24.095093 14037 net.cpp:156] Memory required for data: 10004
I0913 21:06:24.095098 14037 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0913 21:06:24.095106 14037 net.cpp:91] Creating Layer lstm1_cont_slice
I0913 21:06:24.095110 14037 net.cpp:425] lstm1_cont_slice <- cont
I0913 21:06:24.095120 14037 net.cpp:399] lstm1_cont_slice -> cont_1
I0913 21:06:24.095155 14037 net.cpp:141] Setting up lstm1_cont_slice
I0913 21:06:24.095165 14037 net.cpp:148] Top shape: 1 1 (1)
I0913 21:06:24.095170 14037 net.cpp:156] Memory required for data: 10008
I0913 21:06:24.095173 14037 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0913 21:06:24.095185 14037 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0913 21:06:24.095191 14037 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0913 21:06:24.095196 14037 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0913 21:06:24.095206 14037 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0913 21:06:24.095253 14037 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0913 21:06:24.095263 14037 net.cpp:148] Top shape: 1 1 (1)
I0913 21:06:24.095268 14037 net.cpp:148] Top shape: 1 1 (1)
I0913 21:06:24.095271 14037 net.cpp:156] Memory required for data: 10016
I0913 21:06:24.095275 14037 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0913 21:06:24.095285 14037 net.cpp:91] Creating Layer lstm1_x_transform
I0913 21:06:24.095290 14037 net.cpp:425] lstm1_x_transform <- x
I0913 21:06:24.095299 14037 net.cpp:399] lstm1_x_transform -> W_xc_x
I0913 21:06:24.114861 14037 net.cpp:141] Setting up lstm1_x_transform
I0913 21:06:24.114910 14037 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:06:24.114917 14037 net.cpp:156] Memory required for data: 26016
I0913 21:06:24.114939 14037 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0913 21:06:24.114956 14037 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0913 21:06:24.114964 14037 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0913 21:06:24.114972 14037 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0913 21:06:24.115020 14037 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0913 21:06:24.115031 14037 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:06:24.115036 14037 net.cpp:156] Memory required for data: 42016
I0913 21:06:24.115039 14037 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0913 21:06:24.115049 14037 net.cpp:91] Creating Layer lstm1_h_conted_0
I0913 21:06:24.115054 14037 net.cpp:425] lstm1_h_conted_0 <- h_0
I0913 21:06:24.115061 14037 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0913 21:06:24.115067 14037 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0913 21:06:24.115160 14037 net.cpp:141] Setting up lstm1_h_conted_0
I0913 21:06:24.115170 14037 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:06:24.115175 14037 net.cpp:156] Memory required for data: 46016
I0913 21:06:24.115178 14037 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0913 21:06:24.115191 14037 net.cpp:91] Creating Layer lstm1_transform_1
I0913 21:06:24.115196 14037 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0913 21:06:24.115203 14037 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0913 21:06:24.125268 14047 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /home/peifeng/work/run/storm102/data/workers/c35e6a57-bee3-4006-b186-a1251ae5127a/tmp/cvld2549614463368891675/bvlc_reference_caffenet.caffemodel
I0913 21:06:24.125314 14047 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0913 21:06:24.125320 14047 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0913 21:06:24.125324 14047 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /home/peifeng/work/run/storm102/data/workers/c35e6a57-bee3-4006-b186-a1251ae5127a/tmp/cvld2549614463368891675/bvlc_reference_caffenet.caffemodel
I0913 21:06:24.155315 14037 net.cpp:141] Setting up lstm1_transform_1
I0913 21:06:24.155382 14037 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:06:24.155388 14037 net.cpp:156] Memory required for data: 62016
I0913 21:06:24.155410 14037 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0913 21:06:24.155431 14037 net.cpp:91] Creating Layer lstm1_gate_input_1
I0913 21:06:24.155438 14037 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0913 21:06:24.155447 14037 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0913 21:06:24.155453 14037 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0913 21:06:24.155509 14037 net.cpp:141] Setting up lstm1_gate_input_1
I0913 21:06:24.155519 14037 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:06:24.155524 14037 net.cpp:156] Memory required for data: 78016
I0913 21:06:24.155527 14037 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0913 21:06:24.155539 14037 net.cpp:91] Creating Layer lstm1_unit_1
I0913 21:06:24.155544 14037 net.cpp:425] lstm1_unit_1 <- c_0
I0913 21:06:24.155550 14037 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0913 21:06:24.155555 14037 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0913 21:06:24.155560 14037 net.cpp:399] lstm1_unit_1 -> c_1
I0913 21:06:24.155568 14037 net.cpp:399] lstm1_unit_1 -> h_1
I0913 21:06:24.155630 14037 net.cpp:141] Setting up lstm1_unit_1
I0913 21:06:24.155639 14037 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:06:24.155644 14037 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:06:24.155648 14037 net.cpp:156] Memory required for data: 86016
I0913 21:06:24.155653 14037 layer_factory.hpp:77] Creating layer lstm1_
I0913 21:06:24.155661 14037 net.cpp:91] Creating Layer lstm1_
I0913 21:06:24.155665 14037 net.cpp:425] lstm1_ <- c_1
I0913 21:06:24.155671 14037 net.cpp:399] lstm1_ -> c_T
I0913 21:06:24.155712 14037 net.cpp:141] Setting up lstm1_
I0913 21:06:24.155720 14037 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:06:24.155725 14037 net.cpp:156] Memory required for data: 90016
I0913 21:06:24.155728 14037 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0913 21:06:24.155740 14037 net.cpp:91] Creating Layer lstm1_h_concat
I0913 21:06:24.155745 14037 net.cpp:425] lstm1_h_concat <- h_1
I0913 21:06:24.155751 14037 net.cpp:399] lstm1_h_concat -> h
I0913 21:06:24.155802 14037 net.cpp:141] Setting up lstm1_h_concat
I0913 21:06:24.155812 14037 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:06:24.155814 14037 net.cpp:156] Memory required for data: 94016
I0913 21:06:24.155819 14037 layer_factory.hpp:77] Creating layer h_pseudoloss
I0913 21:06:24.155836 14037 net.cpp:91] Creating Layer h_pseudoloss
I0913 21:06:24.155840 14037 net.cpp:425] h_pseudoloss <- h
I0913 21:06:24.155849 14037 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0913 21:06:24.155931 14037 net.cpp:141] Setting up h_pseudoloss
I0913 21:06:24.155943 14037 net.cpp:148] Top shape: (1)
I0913 21:06:24.155947 14037 net.cpp:151]     with loss weight 1
I0913 21:06:24.155977 14037 net.cpp:156] Memory required for data: 94020
I0913 21:06:24.155982 14037 net.cpp:217] h_pseudoloss needs backward computation.
I0913 21:06:24.155987 14037 net.cpp:217] lstm1_h_concat needs backward computation.
I0913 21:06:24.155992 14037 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:06:24.155995 14037 net.cpp:217] lstm1_unit_1 needs backward computation.
I0913 21:06:24.156000 14037 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0913 21:06:24.156005 14037 net.cpp:217] lstm1_transform_1 needs backward computation.
I0913 21:06:24.156010 14037 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0913 21:06:24.156015 14037 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0913 21:06:24.156019 14037 net.cpp:217] lstm1_x_transform needs backward computation.
I0913 21:06:24.156024 14037 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0913 21:06:24.156028 14037 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0913 21:06:24.156033 14037 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:06:24.156038 14037 net.cpp:219] lstm1_ does not need backward computation.
I0913 21:06:24.156041 14037 net.cpp:261] This network produces output c_T
I0913 21:06:24.156045 14037 net.cpp:261] This network produces output h_pseudoloss
I0913 21:06:24.156061 14037 net.cpp:274] Network initialization done.
I0913 21:06:24.156119 14037 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0913 21:06:24.156127 14037 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0913 21:06:24.156131 14037 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0913 21:06:24.156239 14037 net.cpp:141] Setting up lstm1
I0913 21:06:24.156250 14037 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:06:24.156255 14037 net.cpp:156] Memory required for data: 26408
I0913 21:06:24.156267 14037 layer_factory.hpp:77] Creating layer concat
I0913 21:06:24.156275 14037 net.cpp:91] Creating Layer concat
I0913 21:06:24.156281 14037 net.cpp:425] concat <- lstm1
I0913 21:06:24.156287 14037 net.cpp:425] concat <- embedded_input_sentence
I0913 21:06:24.156292 14037 net.cpp:425] concat <- reshaped_stage_indicator
I0913 21:06:24.156298 14037 net.cpp:399] concat -> lstm1_video_sequence
I0913 21:06:24.156329 14037 net.cpp:141] Setting up concat
I0913 21:06:24.156337 14037 net.cpp:148] Top shape: 1 1 1501 (1501)
I0913 21:06:24.156342 14037 net.cpp:156] Memory required for data: 32412
I0913 21:06:24.156345 14037 layer_factory.hpp:77] Creating layer lstm2
I0913 21:06:24.156357 14037 net.cpp:91] Creating Layer lstm2
I0913 21:06:24.156361 14037 net.cpp:425] lstm2 <- lstm1_video_sequence
I0913 21:06:24.156366 14037 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0913 21:06:24.156373 14037 net.cpp:399] lstm2 -> lstm2
I0913 21:06:24.156383 14037 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0913 21:06:24.156651 14037 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0913 21:06:24.156738 14037 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:06:24.156749 14037 net.cpp:91] Creating Layer lstm2_
I0913 21:06:24.156755 14037 net.cpp:399] lstm2_ -> x
I0913 21:06:24.156779 14037 net.cpp:399] lstm2_ -> cont
I0913 21:06:24.156831 14037 net.cpp:141] Setting up lstm2_
I0913 21:06:24.156838 14037 net.cpp:148] Top shape: 1 1 1501 (1501)
I0913 21:06:24.156844 14037 net.cpp:148] Top shape: 1 1 (1)
I0913 21:06:24.156848 14037 net.cpp:156] Memory required for data: 6008
I0913 21:06:24.156852 14037 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:06:24.156860 14037 net.cpp:91] Creating Layer lstm2_
I0913 21:06:24.156865 14037 net.cpp:399] lstm2_ -> c_0
I0913 21:06:24.156874 14037 net.cpp:399] lstm2_ -> h_0
I0913 21:06:24.156919 14037 net.cpp:141] Setting up lstm2_
I0913 21:06:24.156926 14037 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:06:24.156931 14037 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:06:24.156935 14037 net.cpp:156] Memory required for data: 14008
I0913 21:06:24.156939 14037 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0913 21:06:24.156946 14037 net.cpp:91] Creating Layer lstm2_cont_slice
I0913 21:06:24.156951 14037 net.cpp:425] lstm2_cont_slice <- cont
I0913 21:06:24.156960 14037 net.cpp:399] lstm2_cont_slice -> cont_1
I0913 21:06:24.156990 14037 net.cpp:141] Setting up lstm2_cont_slice
I0913 21:06:24.156998 14037 net.cpp:148] Top shape: 1 1 (1)
I0913 21:06:24.157002 14037 net.cpp:156] Memory required for data: 14012
I0913 21:06:24.157006 14037 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0913 21:06:24.157012 14037 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0913 21:06:24.157016 14037 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0913 21:06:24.157022 14037 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0913 21:06:24.157029 14037 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0913 21:06:24.157073 14037 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0913 21:06:24.157080 14037 net.cpp:148] Top shape: 1 1 (1)
I0913 21:06:24.157085 14037 net.cpp:148] Top shape: 1 1 (1)
I0913 21:06:24.157089 14037 net.cpp:156] Memory required for data: 14020
I0913 21:06:24.157094 14037 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0913 21:06:24.157105 14037 net.cpp:91] Creating Layer lstm2_x_transform
I0913 21:06:24.157109 14037 net.cpp:425] lstm2_x_transform <- x
I0913 21:06:24.157116 14037 net.cpp:399] lstm2_x_transform -> W_xc_x
I0913 21:06:24.213982 14037 net.cpp:141] Setting up lstm2_x_transform
I0913 21:06:24.214045 14037 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:06:24.214049 14037 net.cpp:156] Memory required for data: 30020
I0913 21:06:24.214073 14037 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0913 21:06:24.214092 14037 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0913 21:06:24.214100 14037 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0913 21:06:24.214109 14037 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0913 21:06:24.214154 14037 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0913 21:06:24.214162 14037 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:06:24.214166 14037 net.cpp:156] Memory required for data: 46020
I0913 21:06:24.214171 14037 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0913 21:06:24.214180 14037 net.cpp:91] Creating Layer lstm2_h_conted_0
I0913 21:06:24.214185 14037 net.cpp:425] lstm2_h_conted_0 <- h_0
I0913 21:06:24.214191 14037 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0913 21:06:24.214200 14037 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0913 21:06:24.214288 14037 net.cpp:141] Setting up lstm2_h_conted_0
I0913 21:06:24.214298 14037 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:06:24.214301 14037 net.cpp:156] Memory required for data: 50020
I0913 21:06:24.214306 14037 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0913 21:06:24.214321 14037 net.cpp:91] Creating Layer lstm2_transform_1
I0913 21:06:24.214326 14037 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0913 21:06:24.214334 14037 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0913 21:06:24.252161 14037 net.cpp:141] Setting up lstm2_transform_1
I0913 21:06:24.252208 14037 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:06:24.252214 14037 net.cpp:156] Memory required for data: 66020
I0913 21:06:24.252236 14037 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0913 21:06:24.252259 14037 net.cpp:91] Creating Layer lstm2_gate_input_1
I0913 21:06:24.252266 14037 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0913 21:06:24.252275 14037 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0913 21:06:24.252285 14037 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0913 21:06:24.252331 14037 net.cpp:141] Setting up lstm2_gate_input_1
I0913 21:06:24.252339 14037 net.cpp:148] Top shape: 1 1 4000 (4000)
I0913 21:06:24.252343 14037 net.cpp:156] Memory required for data: 82020
I0913 21:06:24.252347 14037 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0913 21:06:24.252359 14037 net.cpp:91] Creating Layer lstm2_unit_1
I0913 21:06:24.252364 14037 net.cpp:425] lstm2_unit_1 <- c_0
I0913 21:06:24.252370 14037 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0913 21:06:24.252375 14037 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0913 21:06:24.252382 14037 net.cpp:399] lstm2_unit_1 -> c_1
I0913 21:06:24.252390 14037 net.cpp:399] lstm2_unit_1 -> h_1
I0913 21:06:24.252450 14037 net.cpp:141] Setting up lstm2_unit_1
I0913 21:06:24.252460 14037 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:06:24.252465 14037 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:06:24.252470 14037 net.cpp:156] Memory required for data: 90020
I0913 21:06:24.252473 14037 layer_factory.hpp:77] Creating layer lstm2_
I0913 21:06:24.252481 14037 net.cpp:91] Creating Layer lstm2_
I0913 21:06:24.252485 14037 net.cpp:425] lstm2_ <- c_1
I0913 21:06:24.252497 14037 net.cpp:399] lstm2_ -> c_T
I0913 21:06:24.252527 14037 net.cpp:141] Setting up lstm2_
I0913 21:06:24.252535 14037 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:06:24.252539 14037 net.cpp:156] Memory required for data: 94020
I0913 21:06:24.252543 14037 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0913 21:06:24.252552 14037 net.cpp:91] Creating Layer lstm2_h_concat
I0913 21:06:24.252557 14037 net.cpp:425] lstm2_h_concat <- h_1
I0913 21:06:24.252563 14037 net.cpp:399] lstm2_h_concat -> h
I0913 21:06:24.252599 14037 net.cpp:141] Setting up lstm2_h_concat
I0913 21:06:24.252606 14037 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:06:24.252610 14037 net.cpp:156] Memory required for data: 98020
I0913 21:06:24.252615 14037 layer_factory.hpp:77] Creating layer h_pseudoloss
I0913 21:06:24.252624 14037 net.cpp:91] Creating Layer h_pseudoloss
I0913 21:06:24.252629 14037 net.cpp:425] h_pseudoloss <- h
I0913 21:06:24.252635 14037 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0913 21:06:24.252717 14037 net.cpp:141] Setting up h_pseudoloss
I0913 21:06:24.252727 14037 net.cpp:148] Top shape: (1)
I0913 21:06:24.252732 14037 net.cpp:151]     with loss weight 1
I0913 21:06:24.252753 14037 net.cpp:156] Memory required for data: 98024
I0913 21:06:24.252758 14037 net.cpp:217] h_pseudoloss needs backward computation.
I0913 21:06:24.252763 14037 net.cpp:217] lstm2_h_concat needs backward computation.
I0913 21:06:24.252768 14037 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:06:24.252771 14037 net.cpp:217] lstm2_unit_1 needs backward computation.
I0913 21:06:24.252777 14037 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0913 21:06:24.252781 14037 net.cpp:217] lstm2_transform_1 needs backward computation.
I0913 21:06:24.252786 14037 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0913 21:06:24.252791 14037 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0913 21:06:24.252796 14037 net.cpp:217] lstm2_x_transform needs backward computation.
I0913 21:06:24.252801 14037 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0913 21:06:24.252806 14037 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0913 21:06:24.252811 14037 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:06:24.252815 14037 net.cpp:219] lstm2_ does not need backward computation.
I0913 21:06:24.252818 14037 net.cpp:261] This network produces output c_T
I0913 21:06:24.252823 14037 net.cpp:261] This network produces output h_pseudoloss
I0913 21:06:24.252837 14037 net.cpp:274] Network initialization done.
I0913 21:06:24.252884 14037 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0913 21:06:24.252890 14037 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0913 21:06:24.252894 14037 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0913 21:06:24.253005 14037 net.cpp:141] Setting up lstm2
I0913 21:06:24.253016 14037 net.cpp:148] Top shape: 1 1 1000 (1000)
I0913 21:06:24.253021 14037 net.cpp:156] Memory required for data: 36412
I0913 21:06:24.253034 14037 layer_factory.hpp:77] Creating layer predict
I0913 21:06:24.253046 14037 net.cpp:91] Creating Layer predict
I0913 21:06:24.253051 14037 net.cpp:425] predict <- lstm2
I0913 21:06:24.253058 14037 net.cpp:399] predict -> predict
I0913 21:06:24.578295 14047 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0913 21:06:24.636901 14047 net.cpp:752] Ignoring source layer loss
Loading the model + trained: 10661.6ms
Using cv::Size and some other stuff: 0.275ms
I0913 21:06:24.700306 14037 net.cpp:141] Setting up predict
I0913 21:06:24.700356 14037 net.cpp:148] Top shape: 1 1 46168 (46168)
I0913 21:06:24.700362 14037 net.cpp:156] Memory required for data: 221084
I0913 21:06:24.700376 14037 layer_factory.hpp:77] Creating layer probs
I0913 21:06:24.700394 14037 net.cpp:91] Creating Layer probs
I0913 21:06:24.700402 14037 net.cpp:425] probs <- predict
I0913 21:06:24.700412 14037 net.cpp:399] probs -> probs
I0913 21:06:24.707883 14037 net.cpp:141] Setting up probs
I0913 21:06:24.707938 14037 net.cpp:148] Top shape: 1 1 46168 (46168)
I0913 21:06:24.707944 14037 net.cpp:156] Memory required for data: 405756
I0913 21:06:24.707954 14037 net.cpp:219] probs does not need backward computation.
I0913 21:06:24.707962 14037 net.cpp:219] predict does not need backward computation.
I0913 21:06:24.707967 14037 net.cpp:219] lstm2 does not need backward computation.
I0913 21:06:24.707973 14037 net.cpp:219] concat does not need backward computation.
I0913 21:06:24.707978 14037 net.cpp:219] lstm1 does not need backward computation.
I0913 21:06:24.707984 14037 net.cpp:219] embedding does not need backward computation.
I0913 21:06:24.707989 14037 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0913 21:06:24.707994 14037 net.cpp:219] reshape_frames does not need backward computation.
I0913 21:06:24.707999 14037 net.cpp:219] embed_encoder does not need backward computation.
I0913 21:06:24.708003 14037 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0913 21:06:24.708009 14037 net.cpp:219] input does not need backward computation.
I0913 21:06:24.708012 14037 net.cpp:261] This network produces output probs
I0913 21:06:24.708032 14037 net.cpp:274] Network initialization done.
Loading the mean file: 1840.35ms
I0913 21:06:25.092468 14037 net.cpp:752] Ignoring source layer data
I0913 21:06:25.092504 14037 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0913 21:06:25.092509 14037 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0913 21:06:25.187568 14037 net.cpp:752] Ignoring source layer cross_entropy_loss
TIMERTIMER 130669040
TIMERTIMER 64601691
TIMERTIMER 69147311
TIMERTIMER 43876649
TIMERTIMER 47152373
TIMERTIMER 47253732
TIMERTIMER 49521984
TIMERTIMER 49470238
TIMERTIMER 49101884
TIMERTIMER 48221290
TIMERTIMER 49029752
TIMERTIMER 47490661
TIMERTIMER 49262729
TIMERTIMER 50160618
TIMERTIMER 49632790
TIMERTIMER 49508165
TIMERTIMER 49774161
TIMERTIMER 42386376
TIMERTIMER 37520296
TIMERTIMER 37543825
TIMERTIMER 31615842
TIMERTIMER 32161227
TIMERTIMER 31189005
TIMERTIMER 38778376
TIMERTIMER 37634396
TIMERTIMER 34239470
TIMERTIMER 31457453
TIMERTIMER 31407436
TIMERTIMER 31804541
TIMERTIMER 37790444
TIMERTIMER 37652277
TIMERTIMER 31468968
TIMERTIMER 31512696
TIMERTIMER 37551228
TIMERTIMER 47891523
TIMERTIMER 31440024
TIMERTIMER 32264216
TIMERTIMER 31936352
TIMERTIMER 31397706
TIMERTIMER 32314130
TIMERTIMER 35384400
TIMERTIMER 32967601
TIMERTIMER 32827785
TIMERTIMER 32683807
TIMERTIMER 37705731
TIMERTIMER 31416822
TIMERTIMER 31829154
TIMERTIMER 31629696
TIMERTIMER 37469761
TIMERTIMER 51478006
TIMERTIMER 31516812
TIMERTIMER 33091014
TIMERTIMER 32602209
TIMERTIMER 31790852
TIMERTIMER 31841973
TIMERTIMER 37623603
TIMERTIMER 33036303
TIMERTIMER 33477478
TIMERTIMER 39056068
TIMERTIMER 40136130
TIMERTIMER 32965617
TIMERTIMER 33120558
TIMERTIMER 31610688
TIMERTIMER 39183672
TIMERTIMER 33098282
TIMERTIMER 38024492
TIMERTIMER 37683579
TIMERTIMER 31364161
