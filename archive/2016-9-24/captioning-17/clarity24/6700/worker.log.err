SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/peifeng/tools/storm102/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/peifeng/work/run/storm102/data/supervisor/stormdist/captioning-1-1474699380/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /home/peifeng/work/run/storm102/data/workers/e62c82ba-7b76-4d9e-811a-f49d4e4bae2d/tmp/cvld4290061136186027110/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0924 02:43:44.928683  2274 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/e62c82ba-7b76-4d9e-811a-f49d4e4bae2d/tmp/cvld4290061136186027110/s2vt.words_to_preds.prototxt
I0924 02:43:44.928725  2286 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/e62c82ba-7b76-4d9e-811a-f49d4e4bae2d/tmp/cvld4290061136186027110/s2vt.words_to_preds.prototxt
I0924 02:43:44.928683  2268 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/e62c82ba-7b76-4d9e-811a-f49d4e4bae2d/tmp/cvld4290061136186027110/s2vt.words_to_preds.prototxt
I0924 02:43:44.928683  2264 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/e62c82ba-7b76-4d9e-811a-f49d4e4bae2d/tmp/cvld4290061136186027110/s2vt.words_to_preds.prototxt
I0924 02:43:44.928839  2274 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
I0924 02:43:44.928843  2286 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
I0924 02:43:44.928849  2268 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0924 02:43:44.928856  2274 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
W0924 02:43:44.928861  2268 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0924 02:43:44.928864  2264 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0924 02:43:44.928858  2286 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
W0924 02:43:44.928879  2264 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0924 02:43:44.928885  2272 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0924 02:43:44.929023  2272 layer_factory.hpp:77] Creating layer data
I0924 02:43:44.929049  2272 net.cpp:91] Creating Layer data
I0924 02:43:44.929059  2272 net.cpp:399] data -> data
I0924 02:43:44.929225  2268 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0924 02:43:44.929246  2264 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0924 02:43:44.929253  2274 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0924 02:43:44.929360  2286 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0924 02:43:44.929383  2274 layer_factory.hpp:77] Creating layer input
I0924 02:43:44.929388  2268 layer_factory.hpp:77] Creating layer input
I0924 02:43:44.929384  2264 layer_factory.hpp:77] Creating layer input
I0924 02:43:44.929410  2268 net.cpp:91] Creating Layer input
I0924 02:43:44.929422  2264 net.cpp:91] Creating Layer input
I0924 02:43:44.929431  2268 net.cpp:399] input -> frames_fc7
I0924 02:43:44.929410  2274 net.cpp:91] Creating Layer input
I0924 02:43:44.929445  2264 net.cpp:399] input -> frames_fc7
I0924 02:43:44.929452  2274 net.cpp:399] input -> frames_fc7
I0924 02:43:44.928683  2292 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/e62c82ba-7b76-4d9e-811a-f49d4e4bae2d/tmp/cvld4290061136186027110/s2vt.words_to_preds.prototxt
I0924 02:43:44.929469  2264 net.cpp:399] input -> cont_sentence
I0924 02:43:44.929479  2292 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
I0924 02:43:44.929484  2274 net.cpp:399] input -> cont_sentence
W0924 02:43:44.929491  2292 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0924 02:43:44.929494  2264 net.cpp:399] input -> input_sentence
I0924 02:43:44.929505  2274 net.cpp:399] input -> input_sentence
I0924 02:43:44.929517  2264 net.cpp:399] input -> stage_indicator
I0924 02:43:44.929527  2274 net.cpp:399] input -> stage_indicator
I0924 02:43:44.929533  2286 layer_factory.hpp:77] Creating layer input
I0924 02:43:44.929558  2286 net.cpp:91] Creating Layer input
I0924 02:43:44.929571  2286 net.cpp:399] input -> frames_fc7
I0924 02:43:44.929596  2286 net.cpp:399] input -> cont_sentence
I0924 02:43:44.929615  2286 net.cpp:399] input -> input_sentence
I0924 02:43:44.929631  2286 net.cpp:399] input -> stage_indicator
I0924 02:43:44.929826  2292 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0924 02:43:44.929963  2292 layer_factory.hpp:77] Creating layer input
I0924 02:43:44.929986  2292 net.cpp:91] Creating Layer input
I0924 02:43:44.930002  2292 net.cpp:399] input -> frames_fc7
I0924 02:43:44.930024  2292 net.cpp:399] input -> cont_sentence
I0924 02:43:44.930045  2292 net.cpp:399] input -> input_sentence
I0924 02:43:44.930066  2292 net.cpp:399] input -> stage_indicator
I0924 02:43:44.929455  2268 net.cpp:399] input -> cont_sentence
I0924 02:43:44.930111  2268 net.cpp:399] input -> input_sentence
I0924 02:43:44.930132  2268 net.cpp:399] input -> stage_indicator
I0924 02:43:45.595033  2272 net.cpp:141] Setting up data
I0924 02:43:45.595130  2272 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0924 02:43:45.595144  2272 net.cpp:156] Memory required for data: 6183480
I0924 02:43:45.595175  2272 layer_factory.hpp:77] Creating layer conv1
I0924 02:43:45.595221  2272 net.cpp:91] Creating Layer conv1
I0924 02:43:45.595235  2272 net.cpp:425] conv1 <- data
I0924 02:43:45.595258  2272 net.cpp:399] conv1 -> conv1
I0924 02:43:45.595317  2292 net.cpp:141] Setting up input
I0924 02:43:45.595358  2292 net.cpp:148] Top shape: 1 4096 (4096)
I0924 02:43:45.595366  2292 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.595373  2292 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.595378  2292 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.595383  2292 net.cpp:156] Memory required for data: 16396
I0924 02:43:45.595391  2292 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0924 02:43:45.595422  2292 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0924 02:43:45.595434  2292 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0924 02:43:45.595437  2264 net.cpp:141] Setting up input
I0924 02:43:45.595453  2264 net.cpp:148] Top shape: 1 4096 (4096)
I0924 02:43:45.595463  2264 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.595473  2264 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.595475  2292 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0924 02:43:45.595484  2264 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.595491  2264 net.cpp:156] Memory required for data: 16396
I0924 02:43:45.595494  2292 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0924 02:43:45.595500  2264 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0924 02:43:45.595515  2264 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0924 02:43:45.595525  2264 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0924 02:43:45.595536  2264 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0924 02:43:45.595547  2264 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0924 02:43:45.595543  2274 net.cpp:141] Setting up input
I0924 02:43:45.595566  2274 net.cpp:148] Top shape: 1 4096 (4096)
I0924 02:43:45.595578  2274 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.595578  2286 net.cpp:141] Setting up input
I0924 02:43:45.595588  2274 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.595597  2286 net.cpp:148] Top shape: 1 4096 (4096)
I0924 02:43:45.595598  2274 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.595605  2286 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.595607  2274 net.cpp:156] Memory required for data: 16396
I0924 02:43:45.595612  2286 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.595618  2286 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.595618  2274 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0924 02:43:45.595623  2286 net.cpp:156] Memory required for data: 16396
I0924 02:43:45.595621  2268 net.cpp:141] Setting up input
I0924 02:43:45.595633  2274 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0924 02:43:45.595630  2286 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0924 02:43:45.595643  2274 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0924 02:43:45.595644  2268 net.cpp:148] Top shape: 1 4096 (4096)
I0924 02:43:45.595661  2268 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.595680  2264 net.cpp:141] Setting up cont_sentence_input_1_split
I0924 02:43:45.595660  2274 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0924 02:43:45.595692  2268 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.595700  2268 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.595700  2264 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.595693  2286 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0924 02:43:45.595715  2292 net.cpp:141] Setting up cont_sentence_input_1_split
I0924 02:43:45.595705  2268 net.cpp:156] Memory required for data: 16396
I0924 02:43:45.595705  2274 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0924 02:43:45.595711  2264 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.595737  2292 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.595741  2268 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0924 02:43:45.595729  2286 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0924 02:43:45.595755  2268 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0924 02:43:45.595746  2264 net.cpp:156] Memory required for data: 16404
I0924 02:43:45.595749  2292 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.595772  2268 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0924 02:43:45.595774  2286 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0924 02:43:45.595777  2264 layer_factory.hpp:77] Creating layer embed_encoder
I0924 02:43:45.595785  2268 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0924 02:43:45.595777  2292 net.cpp:156] Memory required for data: 16404
I0924 02:43:45.595796  2286 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0924 02:43:45.595803  2268 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0924 02:43:45.595798  2292 layer_factory.hpp:77] Creating layer embed_encoder
I0924 02:43:45.595813  2264 net.cpp:91] Creating Layer embed_encoder
I0924 02:43:45.595823  2264 net.cpp:425] embed_encoder <- frames_fc7
I0924 02:43:45.595829  2292 net.cpp:91] Creating Layer embed_encoder
I0924 02:43:45.595837  2292 net.cpp:425] embed_encoder <- frames_fc7
I0924 02:43:45.595837  2264 net.cpp:399] embed_encoder -> embedded_in_frames
I0924 02:43:45.595860  2292 net.cpp:399] embed_encoder -> embedded_in_frames
I0924 02:43:45.595868  2274 net.cpp:141] Setting up cont_sentence_input_1_split
I0924 02:43:45.595885  2274 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.595896  2274 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.595902  2274 net.cpp:156] Memory required for data: 16404
I0924 02:43:45.595911  2274 layer_factory.hpp:77] Creating layer embed_encoder
I0924 02:43:45.595926  2268 net.cpp:141] Setting up cont_sentence_input_1_split
I0924 02:43:45.595928  2274 net.cpp:91] Creating Layer embed_encoder
I0924 02:43:45.595944  2268 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.595950  2268 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.595949  2274 net.cpp:425] embed_encoder <- frames_fc7
I0924 02:43:45.595959  2268 net.cpp:156] Memory required for data: 16404
I0924 02:43:45.595968  2268 layer_factory.hpp:77] Creating layer embed_encoder
I0924 02:43:45.595985  2268 net.cpp:91] Creating Layer embed_encoder
I0924 02:43:45.595993  2268 net.cpp:425] embed_encoder <- frames_fc7
I0924 02:43:45.595993  2274 net.cpp:399] embed_encoder -> embedded_in_frames
I0924 02:43:45.596004  2268 net.cpp:399] embed_encoder -> embedded_in_frames
I0924 02:43:45.596249  2286 net.cpp:141] Setting up cont_sentence_input_1_split
I0924 02:43:45.596263  2286 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.596271  2286 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.596274  2286 net.cpp:156] Memory required for data: 16404
I0924 02:43:45.596281  2286 layer_factory.hpp:77] Creating layer embed_encoder
I0924 02:43:45.596294  2286 net.cpp:91] Creating Layer embed_encoder
I0924 02:43:45.596300  2286 net.cpp:425] embed_encoder <- frames_fc7
I0924 02:43:45.596312  2286 net.cpp:399] embed_encoder -> embedded_in_frames
I0924 02:43:45.632751  2264 net.cpp:141] Setting up embed_encoder
I0924 02:43:45.632802  2264 net.cpp:148] Top shape: 1 500 (500)
I0924 02:43:45.632812  2264 net.cpp:156] Memory required for data: 18404
I0924 02:43:45.632832  2292 net.cpp:141] Setting up embed_encoder
I0924 02:43:45.632846  2264 layer_factory.hpp:77] Creating layer reshape_frames
I0924 02:43:45.632863  2292 net.cpp:148] Top shape: 1 500 (500)
I0924 02:43:45.632879  2292 net.cpp:156] Memory required for data: 18404
I0924 02:43:45.632882  2264 net.cpp:91] Creating Layer reshape_frames
I0924 02:43:45.632897  2264 net.cpp:425] reshape_frames <- embedded_in_frames
I0924 02:43:45.632915  2264 net.cpp:399] reshape_frames -> embedded_input_frames
I0924 02:43:45.632915  2292 layer_factory.hpp:77] Creating layer reshape_frames
I0924 02:43:45.632944  2292 net.cpp:91] Creating Layer reshape_frames
I0924 02:43:45.632962  2292 net.cpp:425] reshape_frames <- embedded_in_frames
I0924 02:43:45.632990  2292 net.cpp:399] reshape_frames -> embedded_input_frames
I0924 02:43:45.640075  2264 net.cpp:141] Setting up reshape_frames
I0924 02:43:45.640107  2292 net.cpp:141] Setting up reshape_frames
I0924 02:43:45.640125  2264 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:43:45.640127  2292 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:43:45.640136  2264 net.cpp:156] Memory required for data: 20404
I0924 02:43:45.640137  2292 net.cpp:156] Memory required for data: 20404
I0924 02:43:45.640158  2264 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0924 02:43:45.640161  2292 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0924 02:43:45.640189  2292 net.cpp:91] Creating Layer reshape_stage_indicator
I0924 02:43:45.640189  2264 net.cpp:91] Creating Layer reshape_stage_indicator
I0924 02:43:45.640209  2292 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0924 02:43:45.640215  2264 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0924 02:43:45.640225  2292 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0924 02:43:45.640233  2264 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0924 02:43:45.640374  2274 net.cpp:141] Setting up embed_encoder
I0924 02:43:45.640395  2274 net.cpp:148] Top shape: 1 500 (500)
I0924 02:43:45.640404  2274 net.cpp:156] Memory required for data: 18404
I0924 02:43:45.640408  2264 net.cpp:141] Setting up reshape_stage_indicator
I0924 02:43:45.640429  2264 net.cpp:148] Top shape: 1 1 1 (1)
I0924 02:43:45.640434  2274 layer_factory.hpp:77] Creating layer reshape_frames
I0924 02:43:45.640439  2264 net.cpp:156] Memory required for data: 20408
I0924 02:43:45.640447  2264 layer_factory.hpp:77] Creating layer embedding
I0924 02:43:45.640450  2274 net.cpp:91] Creating Layer reshape_frames
I0924 02:43:45.640460  2274 net.cpp:425] reshape_frames <- embedded_in_frames
I0924 02:43:45.640465  2264 net.cpp:91] Creating Layer embedding
I0924 02:43:45.640475  2264 net.cpp:425] embedding <- input_sentence
I0924 02:43:45.640477  2274 net.cpp:399] reshape_frames -> embedded_input_frames
I0924 02:43:45.640487  2264 net.cpp:399] embedding -> embedded_input_sentence
I0924 02:43:45.640565  2286 net.cpp:141] Setting up embed_encoder
I0924 02:43:45.640602  2286 net.cpp:148] Top shape: 1 500 (500)
I0924 02:43:45.640609  2286 net.cpp:156] Memory required for data: 18404
I0924 02:43:45.640627  2286 layer_factory.hpp:77] Creating layer reshape_frames
I0924 02:43:45.640645  2286 net.cpp:91] Creating Layer reshape_frames
I0924 02:43:45.640655  2286 net.cpp:425] reshape_frames <- embedded_in_frames
I0924 02:43:45.640657  2274 net.cpp:141] Setting up reshape_frames
I0924 02:43:45.640664  2286 net.cpp:399] reshape_frames -> embedded_input_frames
I0924 02:43:45.640673  2274 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:43:45.640681  2274 net.cpp:156] Memory required for data: 20404
I0924 02:43:45.640691  2274 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0924 02:43:45.640704  2292 net.cpp:141] Setting up reshape_stage_indicator
I0924 02:43:45.640720  2292 net.cpp:148] Top shape: 1 1 1 (1)
I0924 02:43:45.640728  2292 net.cpp:156] Memory required for data: 20408
I0924 02:43:45.640733  2274 net.cpp:91] Creating Layer reshape_stage_indicator
I0924 02:43:45.640736  2292 layer_factory.hpp:77] Creating layer embedding
I0924 02:43:45.640743  2274 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0924 02:43:45.640751  2292 net.cpp:91] Creating Layer embedding
I0924 02:43:45.640756  2274 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0924 02:43:45.640760  2292 net.cpp:425] embedding <- input_sentence
I0924 02:43:45.640774  2292 net.cpp:399] embedding -> embedded_input_sentence
I0924 02:43:45.640813  2286 net.cpp:141] Setting up reshape_frames
I0924 02:43:45.640825  2286 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:43:45.640830  2286 net.cpp:156] Memory required for data: 20404
I0924 02:43:45.640836  2286 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0924 02:43:45.640849  2286 net.cpp:91] Creating Layer reshape_stage_indicator
I0924 02:43:45.640856  2286 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0924 02:43:45.640863  2286 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0924 02:43:45.683346  2268 net.cpp:141] Setting up embed_encoder
I0924 02:43:45.683394  2268 net.cpp:148] Top shape: 1 500 (500)
I0924 02:43:45.683401  2268 net.cpp:156] Memory required for data: 18404
I0924 02:43:45.683423  2268 layer_factory.hpp:77] Creating layer reshape_frames
I0924 02:43:45.683423  2274 net.cpp:141] Setting up reshape_stage_indicator
I0924 02:43:45.683444  2268 net.cpp:91] Creating Layer reshape_frames
I0924 02:43:45.683446  2274 net.cpp:148] Top shape: 1 1 1 (1)
I0924 02:43:45.683454  2268 net.cpp:425] reshape_frames <- embedded_in_frames
I0924 02:43:45.683455  2274 net.cpp:156] Memory required for data: 20408
I0924 02:43:45.683465  2268 net.cpp:399] reshape_frames -> embedded_input_frames
I0924 02:43:45.683465  2274 layer_factory.hpp:77] Creating layer embedding
I0924 02:43:45.683519  2274 net.cpp:91] Creating Layer embedding
I0924 02:43:45.683531  2274 net.cpp:425] embedding <- input_sentence
I0924 02:43:45.683547  2274 net.cpp:399] embedding -> embedded_input_sentence
I0924 02:43:45.683568  2286 net.cpp:141] Setting up reshape_stage_indicator
I0924 02:43:45.683624  2286 net.cpp:148] Top shape: 1 1 1 (1)
I0924 02:43:45.683634  2286 net.cpp:156] Memory required for data: 20408
I0924 02:43:45.683642  2286 layer_factory.hpp:77] Creating layer embedding
I0924 02:43:45.683688  2286 net.cpp:91] Creating Layer embedding
I0924 02:43:45.683699  2286 net.cpp:425] embedding <- input_sentence
I0924 02:43:45.683713  2286 net.cpp:399] embedding -> embedded_input_sentence
I0924 02:43:45.732970  2268 net.cpp:141] Setting up reshape_frames
I0924 02:43:45.733058  2268 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:43:45.733073  2268 net.cpp:156] Memory required for data: 20404
I0924 02:43:45.733093  2268 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0924 02:43:45.733134  2268 net.cpp:91] Creating Layer reshape_stage_indicator
I0924 02:43:45.733150  2268 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0924 02:43:45.733176  2268 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0924 02:43:45.733307  2268 net.cpp:141] Setting up reshape_stage_indicator
I0924 02:43:45.733330  2268 net.cpp:148] Top shape: 1 1 1 (1)
I0924 02:43:45.733340  2268 net.cpp:156] Memory required for data: 20408
I0924 02:43:45.733351  2268 layer_factory.hpp:77] Creating layer embedding
I0924 02:43:45.733382  2268 net.cpp:91] Creating Layer embedding
I0924 02:43:45.733393  2268 net.cpp:425] embedding <- input_sentence
I0924 02:43:45.733413  2268 net.cpp:399] embedding -> embedded_input_sentence
I0924 02:43:45.866381  2264 net.cpp:141] Setting up embedding
I0924 02:43:45.866436  2264 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:43:45.866441  2264 net.cpp:156] Memory required for data: 22408
I0924 02:43:45.866458  2264 layer_factory.hpp:77] Creating layer lstm1
I0924 02:43:45.866490  2264 net.cpp:91] Creating Layer lstm1
I0924 02:43:45.866499  2264 net.cpp:425] lstm1 <- embedded_input_frames
I0924 02:43:45.866508  2264 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0924 02:43:45.866518  2264 net.cpp:399] lstm1 -> lstm1
I0924 02:43:45.866544  2264 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0924 02:43:45.866955  2264 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0924 02:43:45.867046  2264 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:43:45.867059  2264 net.cpp:91] Creating Layer lstm1_
I0924 02:43:45.867066  2264 net.cpp:399] lstm1_ -> x
I0924 02:43:45.867079  2264 net.cpp:399] lstm1_ -> cont
I0924 02:43:45.870293  2264 net.cpp:141] Setting up lstm1_
I0924 02:43:45.870326  2264 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:43:45.870333  2264 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.870338  2264 net.cpp:156] Memory required for data: 2004
I0924 02:43:45.870345  2264 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:43:45.870373  2264 net.cpp:91] Creating Layer lstm1_
I0924 02:43:45.870380  2264 net.cpp:399] lstm1_ -> c_0
I0924 02:43:45.870396  2264 net.cpp:399] lstm1_ -> h_0
I0924 02:43:45.873463  2264 net.cpp:141] Setting up lstm1_
I0924 02:43:45.873487  2264 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:45.873497  2264 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:45.873504  2264 net.cpp:156] Memory required for data: 10004
I0924 02:43:45.873512  2264 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0924 02:43:45.873528  2264 net.cpp:91] Creating Layer lstm1_cont_slice
I0924 02:43:45.873536  2264 net.cpp:425] lstm1_cont_slice <- cont
I0924 02:43:45.873553  2264 net.cpp:399] lstm1_cont_slice -> cont_1
I0924 02:43:45.876025  2264 net.cpp:141] Setting up lstm1_cont_slice
I0924 02:43:45.876049  2264 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.876058  2264 net.cpp:156] Memory required for data: 10008
I0924 02:43:45.876068  2264 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0924 02:43:45.876080  2264 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0924 02:43:45.876085  2264 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0924 02:43:45.876092  2264 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0924 02:43:45.876102  2264 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0924 02:43:45.876374  2264 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0924 02:43:45.876386  2264 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.876397  2264 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.876406  2264 net.cpp:156] Memory required for data: 10016
I0924 02:43:45.876412  2264 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0924 02:43:45.876431  2264 net.cpp:91] Creating Layer lstm1_x_transform
I0924 02:43:45.876436  2264 net.cpp:425] lstm1_x_transform <- x
I0924 02:43:45.876446  2264 net.cpp:399] lstm1_x_transform -> W_xc_x
I0924 02:43:45.901144  2264 net.cpp:141] Setting up lstm1_x_transform
I0924 02:43:45.901193  2264 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:45.901201  2264 net.cpp:156] Memory required for data: 26016
I0924 02:43:45.901219  2264 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0924 02:43:45.901240  2264 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0924 02:43:45.901252  2264 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0924 02:43:45.901262  2264 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0924 02:43:45.902436  2264 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0924 02:43:45.902456  2264 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:45.902462  2264 net.cpp:156] Memory required for data: 42016
I0924 02:43:45.902467  2264 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0924 02:43:45.902487  2264 net.cpp:91] Creating Layer lstm1_h_conted_0
I0924 02:43:45.902494  2264 net.cpp:425] lstm1_h_conted_0 <- h_0
I0924 02:43:45.902505  2264 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0924 02:43:45.902518  2264 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0924 02:43:45.907102  2264 net.cpp:141] Setting up lstm1_h_conted_0
I0924 02:43:45.907119  2264 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:45.907124  2264 net.cpp:156] Memory required for data: 46016
I0924 02:43:45.907130  2264 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0924 02:43:45.907145  2264 net.cpp:91] Creating Layer lstm1_transform_1
I0924 02:43:45.907150  2264 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0924 02:43:45.907160  2264 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0924 02:43:45.940027  2292 net.cpp:141] Setting up embedding
I0924 02:43:45.940081  2292 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:43:45.940091  2292 net.cpp:156] Memory required for data: 22408
I0924 02:43:45.940114  2292 layer_factory.hpp:77] Creating layer lstm1
I0924 02:43:45.940136  2292 net.cpp:91] Creating Layer lstm1
I0924 02:43:45.940146  2292 net.cpp:425] lstm1 <- embedded_input_frames
I0924 02:43:45.940158  2292 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0924 02:43:45.940174  2292 net.cpp:399] lstm1 -> lstm1
I0924 02:43:45.940196  2292 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0924 02:43:45.940608  2292 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0924 02:43:45.940737  2292 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:43:45.940755  2292 net.cpp:91] Creating Layer lstm1_
I0924 02:43:45.940765  2292 net.cpp:399] lstm1_ -> x
I0924 02:43:45.940783  2292 net.cpp:399] lstm1_ -> cont
I0924 02:43:45.940968  2292 net.cpp:141] Setting up lstm1_
I0924 02:43:45.940984  2292 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:43:45.940994  2292 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.941002  2292 net.cpp:156] Memory required for data: 2004
I0924 02:43:45.941010  2292 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:43:45.941025  2292 net.cpp:91] Creating Layer lstm1_
I0924 02:43:45.941040  2292 net.cpp:399] lstm1_ -> c_0
I0924 02:43:45.941056  2292 net.cpp:399] lstm1_ -> h_0
I0924 02:43:45.943334  2292 net.cpp:141] Setting up lstm1_
I0924 02:43:45.943356  2292 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:45.943367  2292 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:45.943375  2292 net.cpp:156] Memory required for data: 10004
I0924 02:43:45.943382  2292 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0924 02:43:45.943402  2292 net.cpp:91] Creating Layer lstm1_cont_slice
I0924 02:43:45.943410  2292 net.cpp:425] lstm1_cont_slice <- cont
I0924 02:43:45.943421  2292 net.cpp:399] lstm1_cont_slice -> cont_1
I0924 02:43:45.944847  2292 net.cpp:141] Setting up lstm1_cont_slice
I0924 02:43:45.944864  2292 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.944872  2292 net.cpp:156] Memory required for data: 10008
I0924 02:43:45.944881  2292 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0924 02:43:45.944893  2292 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0924 02:43:45.944901  2292 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0924 02:43:45.944916  2292 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0924 02:43:45.944931  2292 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0924 02:43:45.945523  2292 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0924 02:43:45.945538  2292 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.945547  2292 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.945554  2292 net.cpp:156] Memory required for data: 10016
I0924 02:43:45.945564  2292 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0924 02:43:45.945585  2292 net.cpp:91] Creating Layer lstm1_x_transform
I0924 02:43:45.945592  2292 net.cpp:425] lstm1_x_transform <- x
I0924 02:43:45.945606  2292 net.cpp:399] lstm1_x_transform -> W_xc_x
I0924 02:43:45.950237  2264 net.cpp:141] Setting up lstm1_transform_1
I0924 02:43:45.950278  2264 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:45.950286  2264 net.cpp:156] Memory required for data: 62016
I0924 02:43:45.950306  2264 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0924 02:43:45.950333  2264 net.cpp:91] Creating Layer lstm1_gate_input_1
I0924 02:43:45.950345  2264 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0924 02:43:45.950358  2264 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0924 02:43:45.950373  2264 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0924 02:43:45.954246  2264 net.cpp:141] Setting up lstm1_gate_input_1
I0924 02:43:45.954298  2264 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:45.954313  2264 net.cpp:156] Memory required for data: 78016
I0924 02:43:45.954329  2264 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0924 02:43:45.954360  2264 net.cpp:91] Creating Layer lstm1_unit_1
I0924 02:43:45.954376  2264 net.cpp:425] lstm1_unit_1 <- c_0
I0924 02:43:45.954396  2264 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0924 02:43:45.954413  2264 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0924 02:43:45.954434  2264 net.cpp:399] lstm1_unit_1 -> c_1
I0924 02:43:45.954460  2264 net.cpp:399] lstm1_unit_1 -> h_1
I0924 02:43:45.962393  2264 net.cpp:141] Setting up lstm1_unit_1
I0924 02:43:45.962433  2264 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:45.962443  2264 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:45.962451  2264 net.cpp:156] Memory required for data: 86016
I0924 02:43:45.962462  2264 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:43:45.962484  2264 net.cpp:91] Creating Layer lstm1_
I0924 02:43:45.962493  2264 net.cpp:425] lstm1_ <- c_1
I0924 02:43:45.962508  2264 net.cpp:399] lstm1_ -> c_T
I0924 02:43:45.963737  2264 net.cpp:141] Setting up lstm1_
I0924 02:43:45.963752  2264 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:45.963759  2264 net.cpp:156] Memory required for data: 90016
I0924 02:43:45.963768  2264 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0924 02:43:45.963780  2264 net.cpp:91] Creating Layer lstm1_h_concat
I0924 02:43:45.963788  2264 net.cpp:425] lstm1_h_concat <- h_1
I0924 02:43:45.963804  2264 net.cpp:399] lstm1_h_concat -> h
I0924 02:43:45.964706  2264 net.cpp:141] Setting up lstm1_h_concat
I0924 02:43:45.964720  2264 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:45.964727  2264 net.cpp:156] Memory required for data: 94016
I0924 02:43:45.964735  2264 layer_factory.hpp:77] Creating layer h_pseudoloss
I0924 02:43:45.964758  2264 net.cpp:91] Creating Layer h_pseudoloss
I0924 02:43:45.964766  2264 net.cpp:425] h_pseudoloss <- h
I0924 02:43:45.964777  2264 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0924 02:43:45.970165  2264 net.cpp:141] Setting up h_pseudoloss
I0924 02:43:45.970206  2264 net.cpp:148] Top shape: (1)
I0924 02:43:45.970216  2264 net.cpp:151]     with loss weight 1
I0924 02:43:45.970252  2286 net.cpp:141] Setting up embedding
I0924 02:43:45.970266  2264 net.cpp:156] Memory required for data: 94020
I0924 02:43:45.970298  2286 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:43:45.970304  2286 net.cpp:156] Memory required for data: 22408
I0924 02:43:45.970304  2264 net.cpp:217] h_pseudoloss needs backward computation.
I0924 02:43:45.970319  2264 net.cpp:217] lstm1_h_concat needs backward computation.
I0924 02:43:45.970324  2286 layer_factory.hpp:77] Creating layer lstm1
I0924 02:43:45.970329  2264 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:43:45.970340  2264 net.cpp:217] lstm1_unit_1 needs backward computation.
I0924 02:43:45.970350  2286 net.cpp:91] Creating Layer lstm1
I0924 02:43:45.970351  2264 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0924 02:43:45.970358  2286 net.cpp:425] lstm1 <- embedded_input_frames
I0924 02:43:45.970361  2264 net.cpp:217] lstm1_transform_1 needs backward computation.
I0924 02:43:45.970368  2286 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0924 02:43:45.970372  2264 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0924 02:43:45.970381  2286 net.cpp:399] lstm1 -> lstm1
I0924 02:43:45.970386  2264 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0924 02:43:45.970396  2264 net.cpp:217] lstm1_x_transform needs backward computation.
I0924 02:43:45.970401  2286 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0924 02:43:45.970407  2264 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0924 02:43:45.970418  2264 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0924 02:43:45.970428  2264 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:43:45.970438  2264 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:43:45.970444  2264 net.cpp:261] This network produces output c_T
I0924 02:43:45.970455  2264 net.cpp:261] This network produces output h_pseudoloss
I0924 02:43:45.970490  2264 net.cpp:274] Network initialization done.
I0924 02:43:45.970582  2264 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0924 02:43:45.970610  2264 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0924 02:43:45.970621  2264 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0924 02:43:45.970741  2286 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0924 02:43:45.970847  2286 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:43:45.970862  2286 net.cpp:91] Creating Layer lstm1_
I0924 02:43:45.970868  2286 net.cpp:399] lstm1_ -> x
I0924 02:43:45.970880  2286 net.cpp:399] lstm1_ -> cont
I0924 02:43:45.972816  2286 net.cpp:141] Setting up lstm1_
I0924 02:43:45.972834  2286 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:43:45.972841  2286 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.972846  2286 net.cpp:156] Memory required for data: 2004
I0924 02:43:45.972851  2286 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:43:45.972872  2286 net.cpp:91] Creating Layer lstm1_
I0924 02:43:45.972887  2286 net.cpp:399] lstm1_ -> c_0
I0924 02:43:45.972898  2286 net.cpp:399] lstm1_ -> h_0
I0924 02:43:45.972993  2264 net.cpp:141] Setting up lstm1
I0924 02:43:45.973018  2264 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:45.973029  2264 net.cpp:156] Memory required for data: 26408
I0924 02:43:45.973057  2264 layer_factory.hpp:77] Creating layer concat
I0924 02:43:45.973058  2286 net.cpp:141] Setting up lstm1_
I0924 02:43:45.973090  2286 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:45.973089  2264 net.cpp:91] Creating Layer concat
I0924 02:43:45.973099  2286 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:45.973104  2286 net.cpp:156] Memory required for data: 10004
I0924 02:43:45.973107  2264 net.cpp:425] concat <- lstm1
I0924 02:43:45.973110  2286 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0924 02:43:45.973127  2264 net.cpp:425] concat <- embedded_input_sentence
I0924 02:43:45.973136  2286 net.cpp:91] Creating Layer lstm1_cont_slice
I0924 02:43:45.973142  2264 net.cpp:425] concat <- reshaped_stage_indicator
I0924 02:43:45.973145  2286 net.cpp:425] lstm1_cont_slice <- cont
I0924 02:43:45.973153  2292 net.cpp:141] Setting up lstm1_x_transform
I0924 02:43:45.973163  2264 net.cpp:399] concat -> lstm1_video_sequence
I0924 02:43:45.973166  2286 net.cpp:399] lstm1_cont_slice -> cont_1
I0924 02:43:45.973178  2292 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:45.973206  2292 net.cpp:156] Memory required for data: 26016
I0924 02:43:45.973228  2292 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0924 02:43:45.973233  2264 net.cpp:141] Setting up concat
I0924 02:43:45.973251  2292 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0924 02:43:45.973253  2264 net.cpp:148] Top shape: 1 1 1501 (1501)
I0924 02:43:45.973278  2286 net.cpp:141] Setting up lstm1_cont_slice
I0924 02:43:45.973281  2292 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0924 02:43:45.973289  2264 net.cpp:156] Memory required for data: 32412
I0924 02:43:45.973294  2286 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.973299  2292 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0924 02:43:45.973304  2286 net.cpp:156] Memory required for data: 10008
I0924 02:43:45.973312  2286 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0924 02:43:45.973301  2264 layer_factory.hpp:77] Creating layer lstm2
I0924 02:43:45.973322  2286 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0924 02:43:45.973340  2286 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0924 02:43:45.973348  2264 net.cpp:91] Creating Layer lstm2
I0924 02:43:45.973352  2286 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0924 02:43:45.973368  2264 net.cpp:425] lstm2 <- lstm1_video_sequence
I0924 02:43:45.973377  2286 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0924 02:43:45.973383  2264 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0924 02:43:45.973388  2292 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0924 02:43:45.973400  2264 net.cpp:399] lstm2 -> lstm2
I0924 02:43:45.973408  2292 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:45.973417  2292 net.cpp:156] Memory required for data: 42016
I0924 02:43:45.973423  2264 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0924 02:43:45.973428  2292 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0924 02:43:45.973448  2292 net.cpp:91] Creating Layer lstm1_h_conted_0
I0924 02:43:45.973456  2286 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0924 02:43:45.973460  2292 net.cpp:425] lstm1_h_conted_0 <- h_0
I0924 02:43:45.973469  2286 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.973474  2292 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0924 02:43:45.973481  2286 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.973491  2286 net.cpp:156] Memory required for data: 10016
I0924 02:43:45.973491  2292 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0924 02:43:45.973496  2286 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0924 02:43:45.973508  2286 net.cpp:91] Creating Layer lstm1_x_transform
I0924 02:43:45.973513  2286 net.cpp:425] lstm1_x_transform <- x
I0924 02:43:45.973526  2286 net.cpp:399] lstm1_x_transform -> W_xc_x
I0924 02:43:45.973835  2264 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0924 02:43:45.973984  2264 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:43:45.974005  2264 net.cpp:91] Creating Layer lstm2_
I0924 02:43:45.974020  2264 net.cpp:399] lstm2_ -> x
I0924 02:43:45.974041  2264 net.cpp:399] lstm2_ -> cont
I0924 02:43:45.980684  2264 net.cpp:141] Setting up lstm2_
I0924 02:43:45.980726  2264 net.cpp:148] Top shape: 1 1 1501 (1501)
I0924 02:43:45.980741  2264 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.980748  2264 net.cpp:156] Memory required for data: 6008
I0924 02:43:45.980762  2264 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:43:45.980788  2264 net.cpp:91] Creating Layer lstm2_
I0924 02:43:45.980809  2264 net.cpp:399] lstm2_ -> c_0
I0924 02:43:45.980837  2264 net.cpp:399] lstm2_ -> h_0
I0924 02:43:45.982120  2264 net.cpp:141] Setting up lstm2_
I0924 02:43:45.982141  2264 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:45.982154  2264 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:45.982163  2264 net.cpp:156] Memory required for data: 14008
I0924 02:43:45.982172  2264 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0924 02:43:45.982192  2264 net.cpp:91] Creating Layer lstm2_cont_slice
I0924 02:43:45.982204  2264 net.cpp:425] lstm2_cont_slice <- cont
I0924 02:43:45.982220  2264 net.cpp:399] lstm2_cont_slice -> cont_1
I0924 02:43:45.982285  2264 net.cpp:141] Setting up lstm2_cont_slice
I0924 02:43:45.982305  2264 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.982314  2264 net.cpp:156] Memory required for data: 14012
I0924 02:43:45.982324  2264 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0924 02:43:45.982343  2264 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0924 02:43:45.982355  2264 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0924 02:43:45.982369  2264 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0924 02:43:45.982386  2264 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0924 02:43:45.982475  2264 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0924 02:43:45.982491  2264 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.982503  2264 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:45.982512  2264 net.cpp:156] Memory required for data: 14020
I0924 02:43:45.982522  2264 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0924 02:43:45.982527  2292 net.cpp:141] Setting up lstm1_h_conted_0
I0924 02:43:45.982544  2264 net.cpp:91] Creating Layer lstm2_x_transform
I0924 02:43:45.982548  2292 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:45.982556  2264 net.cpp:425] lstm2_x_transform <- x
I0924 02:43:45.982558  2292 net.cpp:156] Memory required for data: 46016
I0924 02:43:45.982569  2292 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0924 02:43:45.982578  2264 net.cpp:399] lstm2_x_transform -> W_xc_x
I0924 02:43:45.982589  2292 net.cpp:91] Creating Layer lstm1_transform_1
I0924 02:43:45.982631  2292 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0924 02:43:45.982650  2292 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0924 02:43:46.028342  2268 net.cpp:141] Setting up embedding
I0924 02:43:46.028393  2268 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:43:46.028400  2268 net.cpp:156] Memory required for data: 22408
I0924 02:43:46.028421  2268 layer_factory.hpp:77] Creating layer lstm1
I0924 02:43:46.028453  2268 net.cpp:91] Creating Layer lstm1
I0924 02:43:46.028467  2268 net.cpp:425] lstm1 <- embedded_input_frames
I0924 02:43:46.028481  2268 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0924 02:43:46.028470  2286 net.cpp:141] Setting up lstm1_x_transform
I0924 02:43:46.028502  2268 net.cpp:399] lstm1 -> lstm1
I0924 02:43:46.028518  2286 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:46.028525  2286 net.cpp:156] Memory required for data: 26016
I0924 02:43:46.028530  2268 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0924 02:43:46.028550  2286 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0924 02:43:46.028574  2286 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0924 02:43:46.028583  2286 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0924 02:43:46.028592  2286 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0924 02:43:46.028645  2286 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0924 02:43:46.028655  2286 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:46.028659  2286 net.cpp:156] Memory required for data: 42016
I0924 02:43:46.028664  2286 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0924 02:43:46.028676  2286 net.cpp:91] Creating Layer lstm1_h_conted_0
I0924 02:43:46.028681  2286 net.cpp:425] lstm1_h_conted_0 <- h_0
I0924 02:43:46.028688  2286 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0924 02:43:46.028695  2286 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0924 02:43:46.028911  2286 net.cpp:141] Setting up lstm1_h_conted_0
I0924 02:43:46.028923  2286 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.028928  2286 net.cpp:156] Memory required for data: 46016
I0924 02:43:46.028925  2268 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0924 02:43:46.028934  2286 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0924 02:43:46.028960  2286 net.cpp:91] Creating Layer lstm1_transform_1
I0924 02:43:46.028966  2286 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0924 02:43:46.028980  2286 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0924 02:43:46.029065  2268 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:43:46.029089  2268 net.cpp:91] Creating Layer lstm1_
I0924 02:43:46.029101  2268 net.cpp:399] lstm1_ -> x
I0924 02:43:46.029119  2268 net.cpp:399] lstm1_ -> cont
I0924 02:43:46.042184  2268 net.cpp:141] Setting up lstm1_
I0924 02:43:46.042237  2268 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:43:46.042246  2268 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:46.042251  2268 net.cpp:156] Memory required for data: 2004
I0924 02:43:46.042266  2268 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:43:46.042305  2268 net.cpp:91] Creating Layer lstm1_
I0924 02:43:46.042316  2268 net.cpp:399] lstm1_ -> c_0
I0924 02:43:46.042345  2268 net.cpp:399] lstm1_ -> h_0
I0924 02:43:46.048902  2292 net.cpp:141] Setting up lstm1_transform_1
I0924 02:43:46.048950  2268 net.cpp:141] Setting up lstm1_
I0924 02:43:46.048993  2268 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.049010  2268 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.049021  2268 net.cpp:156] Memory required for data: 10004
I0924 02:43:46.049032  2268 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0924 02:43:46.049059  2268 net.cpp:91] Creating Layer lstm1_cont_slice
I0924 02:43:46.049069  2268 net.cpp:425] lstm1_cont_slice <- cont
I0924 02:43:46.049088  2268 net.cpp:399] lstm1_cont_slice -> cont_1
I0924 02:43:46.049685  2268 net.cpp:141] Setting up lstm1_cont_slice
I0924 02:43:46.049701  2268 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:46.049706  2268 net.cpp:156] Memory required for data: 10008
I0924 02:43:46.049713  2268 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0924 02:43:46.049727  2268 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0924 02:43:46.049736  2268 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0924 02:43:46.049743  2268 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0924 02:43:46.049753  2268 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0924 02:43:46.048962  2292 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:46.050647  2292 net.cpp:156] Memory required for data: 62016
I0924 02:43:46.050676  2292 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0924 02:43:46.050707  2292 net.cpp:91] Creating Layer lstm1_gate_input_1
I0924 02:43:46.050719  2292 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0924 02:43:46.050730  2292 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0924 02:43:46.050743  2292 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0924 02:43:46.051684  2268 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0924 02:43:46.051704  2268 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:46.051712  2268 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:46.051715  2268 net.cpp:156] Memory required for data: 10016
I0924 02:43:46.051723  2268 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0924 02:43:46.051740  2268 net.cpp:91] Creating Layer lstm1_x_transform
I0924 02:43:46.051748  2268 net.cpp:425] lstm1_x_transform <- x
I0924 02:43:46.051756  2268 net.cpp:399] lstm1_x_transform -> W_xc_x
I0924 02:43:46.055912  2292 net.cpp:141] Setting up lstm1_gate_input_1
I0924 02:43:46.055964  2292 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:46.055971  2292 net.cpp:156] Memory required for data: 78016
I0924 02:43:46.055979  2292 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0924 02:43:46.055997  2292 net.cpp:91] Creating Layer lstm1_unit_1
I0924 02:43:46.056005  2292 net.cpp:425] lstm1_unit_1 <- c_0
I0924 02:43:46.056004  2274 net.cpp:141] Setting up embedding
I0924 02:43:46.056028  2292 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0924 02:43:46.056048  2274 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:43:46.056051  2292 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0924 02:43:46.056056  2274 net.cpp:156] Memory required for data: 22408
I0924 02:43:46.056061  2292 net.cpp:399] lstm1_unit_1 -> c_1
I0924 02:43:46.056076  2292 net.cpp:399] lstm1_unit_1 -> h_1
I0924 02:43:46.056077  2274 layer_factory.hpp:77] Creating layer lstm1
I0924 02:43:46.056116  2274 net.cpp:91] Creating Layer lstm1
I0924 02:43:46.056126  2274 net.cpp:425] lstm1 <- embedded_input_frames
I0924 02:43:46.056135  2274 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0924 02:43:46.056146  2274 net.cpp:399] lstm1 -> lstm1
I0924 02:43:46.056167  2274 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0924 02:43:46.056489  2274 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0924 02:43:46.056588  2274 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:43:46.056602  2274 net.cpp:91] Creating Layer lstm1_
I0924 02:43:46.056608  2274 net.cpp:399] lstm1_ -> x
I0924 02:43:46.056620  2274 net.cpp:399] lstm1_ -> cont
I0924 02:43:46.058724  2292 net.cpp:141] Setting up lstm1_unit_1
I0924 02:43:46.058775  2292 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.058789  2292 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.058797  2292 net.cpp:156] Memory required for data: 86016
I0924 02:43:46.058811  2292 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:43:46.058828  2274 net.cpp:141] Setting up lstm1_
I0924 02:43:46.058838  2292 net.cpp:91] Creating Layer lstm1_
I0924 02:43:46.058873  2274 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:43:46.058882  2274 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:46.058881  2292 net.cpp:425] lstm1_ <- c_1
I0924 02:43:46.058887  2274 net.cpp:156] Memory required for data: 2004
I0924 02:43:46.058897  2274 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:43:46.058902  2292 net.cpp:399] lstm1_ -> c_T
I0924 02:43:46.058931  2274 net.cpp:91] Creating Layer lstm1_
I0924 02:43:46.058943  2274 net.cpp:399] lstm1_ -> c_0
I0924 02:43:46.058960  2274 net.cpp:399] lstm1_ -> h_0
I0924 02:43:46.062688  2292 net.cpp:141] Setting up lstm1_
I0924 02:43:46.062722  2292 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.062731  2292 net.cpp:156] Memory required for data: 90016
I0924 02:43:46.062741  2292 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0924 02:43:46.062758  2292 net.cpp:91] Creating Layer lstm1_h_concat
I0924 02:43:46.062767  2292 net.cpp:425] lstm1_h_concat <- h_1
I0924 02:43:46.062783  2274 net.cpp:141] Setting up lstm1_
I0924 02:43:46.062788  2292 net.cpp:399] lstm1_h_concat -> h
I0924 02:43:46.062868  2292 net.cpp:141] Setting up lstm1_h_concat
I0924 02:43:46.062885  2292 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.062891  2292 net.cpp:156] Memory required for data: 94016
I0924 02:43:46.062899  2292 layer_factory.hpp:77] Creating layer h_pseudoloss
I0924 02:43:46.062916  2292 net.cpp:91] Creating Layer h_pseudoloss
I0924 02:43:46.062924  2292 net.cpp:425] h_pseudoloss <- h
I0924 02:43:46.062937  2292 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0924 02:43:46.063060  2292 net.cpp:141] Setting up h_pseudoloss
I0924 02:43:46.063074  2292 net.cpp:148] Top shape: (1)
I0924 02:43:46.063081  2292 net.cpp:151]     with loss weight 1
I0924 02:43:46.063102  2292 net.cpp:156] Memory required for data: 94020
I0924 02:43:46.063112  2292 net.cpp:217] h_pseudoloss needs backward computation.
I0924 02:43:46.063118  2292 net.cpp:217] lstm1_h_concat needs backward computation.
I0924 02:43:46.063125  2292 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:43:46.063133  2292 net.cpp:217] lstm1_unit_1 needs backward computation.
I0924 02:43:46.063143  2292 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0924 02:43:46.063153  2292 net.cpp:217] lstm1_transform_1 needs backward computation.
I0924 02:43:46.063159  2292 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0924 02:43:46.063169  2292 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0924 02:43:46.063176  2292 net.cpp:217] lstm1_x_transform needs backward computation.
I0924 02:43:46.063185  2292 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0924 02:43:46.063194  2292 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0924 02:43:46.063201  2292 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:43:46.063208  2292 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:43:46.063215  2292 net.cpp:261] This network produces output c_T
I0924 02:43:46.063222  2292 net.cpp:261] This network produces output h_pseudoloss
I0924 02:43:46.063246  2292 net.cpp:274] Network initialization done.
I0924 02:43:46.063319  2292 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0924 02:43:46.063329  2292 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0924 02:43:46.063336  2292 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0924 02:43:46.063469  2292 net.cpp:141] Setting up lstm1
I0924 02:43:46.063484  2292 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.063491  2292 net.cpp:156] Memory required for data: 26408
I0924 02:43:46.063514  2292 layer_factory.hpp:77] Creating layer concat
I0924 02:43:46.063529  2292 net.cpp:91] Creating Layer concat
I0924 02:43:46.063539  2292 net.cpp:425] concat <- lstm1
I0924 02:43:46.063549  2292 net.cpp:425] concat <- embedded_input_sentence
I0924 02:43:46.063557  2292 net.cpp:425] concat <- reshaped_stage_indicator
I0924 02:43:46.063567  2292 net.cpp:399] concat -> lstm1_video_sequence
I0924 02:43:46.063608  2292 net.cpp:141] Setting up concat
I0924 02:43:46.063621  2292 net.cpp:148] Top shape: 1 1 1501 (1501)
I0924 02:43:46.063627  2292 net.cpp:156] Memory required for data: 32412
I0924 02:43:46.063634  2292 layer_factory.hpp:77] Creating layer lstm2
I0924 02:43:46.063653  2292 net.cpp:91] Creating Layer lstm2
I0924 02:43:46.063662  2292 net.cpp:425] lstm2 <- lstm1_video_sequence
I0924 02:43:46.063670  2292 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0924 02:43:46.063683  2292 net.cpp:399] lstm2 -> lstm2
I0924 02:43:46.063697  2292 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0924 02:43:46.064060  2292 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0924 02:43:46.064185  2292 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:43:46.064200  2292 net.cpp:91] Creating Layer lstm2_
I0924 02:43:46.064209  2292 net.cpp:399] lstm2_ -> x
I0924 02:43:46.064225  2292 net.cpp:399] lstm2_ -> cont
I0924 02:43:46.064296  2292 net.cpp:141] Setting up lstm2_
I0924 02:43:46.064309  2292 net.cpp:148] Top shape: 1 1 1501 (1501)
I0924 02:43:46.064319  2292 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:46.064326  2292 net.cpp:156] Memory required for data: 6008
I0924 02:43:46.064333  2292 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:43:46.064345  2292 net.cpp:91] Creating Layer lstm2_
I0924 02:43:46.064358  2292 net.cpp:399] lstm2_ -> c_0
I0924 02:43:46.064373  2292 net.cpp:399] lstm2_ -> h_0
I0924 02:43:46.064442  2292 net.cpp:141] Setting up lstm2_
I0924 02:43:46.064455  2292 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.064465  2292 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.064471  2292 net.cpp:156] Memory required for data: 14008
I0924 02:43:46.064478  2292 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0924 02:43:46.064491  2292 net.cpp:91] Creating Layer lstm2_cont_slice
I0924 02:43:46.064497  2292 net.cpp:425] lstm2_cont_slice <- cont
I0924 02:43:46.064508  2292 net.cpp:399] lstm2_cont_slice -> cont_1
I0924 02:43:46.064551  2292 net.cpp:141] Setting up lstm2_cont_slice
I0924 02:43:46.064563  2292 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:46.064570  2292 net.cpp:156] Memory required for data: 14012
I0924 02:43:46.064577  2292 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0924 02:43:46.064589  2292 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0924 02:43:46.064599  2292 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0924 02:43:46.064610  2292 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0924 02:43:46.064621  2292 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0924 02:43:46.064680  2292 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0924 02:43:46.064692  2292 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:46.064702  2292 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:46.064709  2292 net.cpp:156] Memory required for data: 14020
I0924 02:43:46.064716  2292 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0924 02:43:46.064730  2292 net.cpp:91] Creating Layer lstm2_x_transform
I0924 02:43:46.064736  2292 net.cpp:425] lstm2_x_transform <- x
I0924 02:43:46.064751  2292 net.cpp:399] lstm2_x_transform -> W_xc_x
I0924 02:43:46.069018  2274 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.069043  2274 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.069049  2274 net.cpp:156] Memory required for data: 10004
I0924 02:43:46.069057  2274 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0924 02:43:46.074473  2274 net.cpp:91] Creating Layer lstm1_cont_slice
I0924 02:43:46.074512  2274 net.cpp:425] lstm1_cont_slice <- cont
I0924 02:43:46.074535  2274 net.cpp:399] lstm1_cont_slice -> cont_1
I0924 02:43:46.075764  2286 net.cpp:141] Setting up lstm1_transform_1
I0924 02:43:46.075788  2286 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:46.075793  2286 net.cpp:156] Memory required for data: 62016
I0924 02:43:46.075809  2286 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0924 02:43:46.075826  2286 net.cpp:91] Creating Layer lstm1_gate_input_1
I0924 02:43:46.075832  2286 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0924 02:43:46.075839  2286 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0924 02:43:46.075850  2286 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0924 02:43:46.075917  2286 net.cpp:141] Setting up lstm1_gate_input_1
I0924 02:43:46.075933  2286 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:46.075942  2286 net.cpp:156] Memory required for data: 78016
I0924 02:43:46.075949  2286 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0924 02:43:46.075959  2286 net.cpp:91] Creating Layer lstm1_unit_1
I0924 02:43:46.075964  2286 net.cpp:425] lstm1_unit_1 <- c_0
I0924 02:43:46.075970  2286 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0924 02:43:46.075976  2286 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0924 02:43:46.075986  2286 net.cpp:399] lstm1_unit_1 -> c_1
I0924 02:43:46.075996  2286 net.cpp:399] lstm1_unit_1 -> h_1
I0924 02:43:46.076006  2274 net.cpp:141] Setting up lstm1_cont_slice
I0924 02:43:46.076026  2274 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:46.076035  2274 net.cpp:156] Memory required for data: 10008
I0924 02:43:46.076043  2274 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0924 02:43:46.076059  2274 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0924 02:43:46.076067  2274 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0924 02:43:46.076081  2274 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0924 02:43:46.076097  2274 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0924 02:43:46.076169  2286 net.cpp:141] Setting up lstm1_unit_1
I0924 02:43:46.076184  2286 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.076191  2286 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.076195  2286 net.cpp:156] Memory required for data: 86016
I0924 02:43:46.076200  2286 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:43:46.076208  2286 net.cpp:91] Creating Layer lstm1_
I0924 02:43:46.076217  2286 net.cpp:425] lstm1_ <- c_1
I0924 02:43:46.076230  2286 net.cpp:399] lstm1_ -> c_T
I0924 02:43:46.076252  2274 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0924 02:43:46.076272  2274 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:46.076280  2286 net.cpp:141] Setting up lstm1_
I0924 02:43:46.076282  2274 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:46.076302  2286 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.076304  2274 net.cpp:156] Memory required for data: 10016
I0924 02:43:46.076311  2286 net.cpp:156] Memory required for data: 90016
I0924 02:43:46.076314  2274 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0924 02:43:46.076320  2286 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0924 02:43:46.076336  2274 net.cpp:91] Creating Layer lstm1_x_transform
I0924 02:43:46.076336  2286 net.cpp:91] Creating Layer lstm1_h_concat
I0924 02:43:46.076361  2274 net.cpp:425] lstm1_x_transform <- x
I0924 02:43:46.076365  2286 net.cpp:425] lstm1_h_concat <- h_1
I0924 02:43:46.076387  2286 net.cpp:399] lstm1_h_concat -> h
I0924 02:43:46.076392  2274 net.cpp:399] lstm1_x_transform -> W_xc_x
I0924 02:43:46.076603  2286 net.cpp:141] Setting up lstm1_h_concat
I0924 02:43:46.076617  2286 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.076620  2286 net.cpp:156] Memory required for data: 94016
I0924 02:43:46.076627  2286 layer_factory.hpp:77] Creating layer h_pseudoloss
I0924 02:43:46.076639  2286 net.cpp:91] Creating Layer h_pseudoloss
I0924 02:43:46.076645  2286 net.cpp:425] h_pseudoloss <- h
I0924 02:43:46.076653  2286 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0924 02:43:46.076791  2268 net.cpp:141] Setting up lstm1_x_transform
I0924 02:43:46.076831  2268 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:46.076840  2268 net.cpp:156] Memory required for data: 26016
I0924 02:43:46.076865  2268 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0924 02:43:46.076885  2268 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0924 02:43:46.076896  2268 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0924 02:43:46.076913  2268 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0924 02:43:46.086488  2268 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0924 02:43:46.086530  2268 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:46.086539  2268 net.cpp:156] Memory required for data: 42016
I0924 02:43:46.086551  2268 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0924 02:43:46.086572  2268 net.cpp:91] Creating Layer lstm1_h_conted_0
I0924 02:43:46.086583  2268 net.cpp:425] lstm1_h_conted_0 <- h_0
I0924 02:43:46.086607  2268 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0924 02:43:46.086628  2268 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0924 02:43:46.086794  2268 net.cpp:141] Setting up lstm1_h_conted_0
I0924 02:43:46.086809  2268 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.086817  2268 net.cpp:156] Memory required for data: 46016
I0924 02:43:46.086825  2268 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0924 02:43:46.086844  2268 net.cpp:91] Creating Layer lstm1_transform_1
I0924 02:43:46.086853  2268 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0924 02:43:46.086866  2268 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0924 02:43:46.086992  2286 net.cpp:141] Setting up h_pseudoloss
I0924 02:43:46.087033  2286 net.cpp:148] Top shape: (1)
I0924 02:43:46.087041  2286 net.cpp:151]     with loss weight 1
I0924 02:43:46.087061  2286 net.cpp:156] Memory required for data: 94020
I0924 02:43:46.087075  2286 net.cpp:217] h_pseudoloss needs backward computation.
I0924 02:43:46.087085  2286 net.cpp:217] lstm1_h_concat needs backward computation.
I0924 02:43:46.087093  2286 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:43:46.087098  2264 net.cpp:141] Setting up lstm2_x_transform
I0924 02:43:46.087103  2286 net.cpp:217] lstm1_unit_1 needs backward computation.
I0924 02:43:46.087131  2264 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:46.087141  2264 net.cpp:156] Memory required for data: 30020
I0924 02:43:46.087141  2286 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0924 02:43:46.087162  2286 net.cpp:217] lstm1_transform_1 needs backward computation.
I0924 02:43:46.087165  2264 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0924 02:43:46.087172  2286 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0924 02:43:46.087182  2264 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0924 02:43:46.087183  2286 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0924 02:43:46.087198  2264 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0924 02:43:46.087204  2286 net.cpp:217] lstm1_x_transform needs backward computation.
I0924 02:43:46.087211  2264 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0924 02:43:46.087214  2286 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0924 02:43:46.087225  2286 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0924 02:43:46.087234  2286 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:43:46.087242  2286 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:43:46.087249  2286 net.cpp:261] This network produces output c_T
I0924 02:43:46.087258  2286 net.cpp:261] This network produces output h_pseudoloss
I0924 02:43:46.087287  2286 net.cpp:274] Network initialization done.
I0924 02:43:46.087358  2286 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0924 02:43:46.087368  2286 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0924 02:43:46.087375  2286 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0924 02:43:46.126348  2264 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0924 02:43:46.126402  2264 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:46.126411  2264 net.cpp:156] Memory required for data: 46020
I0924 02:43:46.126423  2264 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0924 02:43:46.126443  2264 net.cpp:91] Creating Layer lstm2_h_conted_0
I0924 02:43:46.126452  2264 net.cpp:425] lstm2_h_conted_0 <- h_0
I0924 02:43:46.126464  2264 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0924 02:43:46.126477  2264 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0924 02:43:46.126652  2264 net.cpp:141] Setting up lstm2_h_conted_0
I0924 02:43:46.126668  2264 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.126675  2264 net.cpp:156] Memory required for data: 50020
I0924 02:43:46.126683  2264 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0924 02:43:46.126700  2264 net.cpp:91] Creating Layer lstm2_transform_1
I0924 02:43:46.126708  2264 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0924 02:43:46.126724  2264 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0924 02:43:46.138525  2286 net.cpp:141] Setting up lstm1
I0924 02:43:46.138581  2286 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.138679  2274 net.cpp:141] Setting up lstm1_x_transform
I0924 02:43:46.138702  2274 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:46.138712  2274 net.cpp:156] Memory required for data: 26016
I0924 02:43:46.138732  2292 net.cpp:141] Setting up lstm2_x_transform
I0924 02:43:46.138746  2274 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0924 02:43:46.138749  2292 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:46.138756  2292 net.cpp:156] Memory required for data: 30020
I0924 02:43:46.138772  2274 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0924 02:43:46.138772  2292 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0924 02:43:46.138790  2274 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0924 02:43:46.138799  2292 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0924 02:43:46.138806  2274 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0924 02:43:46.138808  2292 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0924 02:43:46.138885  2274 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0924 02:43:46.138897  2292 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0924 02:43:46.138900  2274 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:46.138921  2274 net.cpp:156] Memory required for data: 42016
I0924 02:43:46.138931  2274 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0924 02:43:46.138954  2274 net.cpp:91] Creating Layer lstm1_h_conted_0
I0924 02:43:46.138964  2274 net.cpp:425] lstm1_h_conted_0 <- h_0
I0924 02:43:46.138967  2292 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0924 02:43:46.138977  2274 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0924 02:43:46.138980  2292 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:46.138988  2292 net.cpp:156] Memory required for data: 46020
I0924 02:43:46.138989  2274 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0924 02:43:46.139004  2292 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0924 02:43:46.139019  2292 net.cpp:91] Creating Layer lstm2_h_conted_0
I0924 02:43:46.139029  2292 net.cpp:425] lstm2_h_conted_0 <- h_0
I0924 02:43:46.139039  2292 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0924 02:43:46.139051  2292 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0924 02:43:46.138591  2286 net.cpp:156] Memory required for data: 26408
I0924 02:43:46.141790  2286 layer_factory.hpp:77] Creating layer concat
I0924 02:43:46.141811  2286 net.cpp:91] Creating Layer concat
I0924 02:43:46.141821  2286 net.cpp:425] concat <- lstm1
I0924 02:43:46.141832  2286 net.cpp:425] concat <- embedded_input_sentence
I0924 02:43:46.141842  2286 net.cpp:425] concat <- reshaped_stage_indicator
I0924 02:43:46.141855  2286 net.cpp:399] concat -> lstm1_video_sequence
I0924 02:43:46.142295  2274 net.cpp:141] Setting up lstm1_h_conted_0
I0924 02:43:46.142315  2274 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.142324  2274 net.cpp:156] Memory required for data: 46016
I0924 02:43:46.142333  2274 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0924 02:43:46.142352  2274 net.cpp:91] Creating Layer lstm1_transform_1
I0924 02:43:46.142362  2274 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0924 02:43:46.142382  2274 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0924 02:43:46.142421  2292 net.cpp:141] Setting up lstm2_h_conted_0
I0924 02:43:46.142436  2292 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.142441  2292 net.cpp:156] Memory required for data: 50020
I0924 02:43:46.142446  2292 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0924 02:43:46.142457  2292 net.cpp:91] Creating Layer lstm2_transform_1
I0924 02:43:46.142462  2292 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0924 02:43:46.142479  2292 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0924 02:43:46.161641  2268 net.cpp:141] Setting up lstm1_transform_1
I0924 02:43:46.161697  2268 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:46.161708  2268 net.cpp:156] Memory required for data: 62016
I0924 02:43:46.161715  2286 net.cpp:141] Setting up concat
I0924 02:43:46.161734  2268 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0924 02:43:46.161763  2286 net.cpp:148] Top shape: 1 1 1501 (1501)
I0924 02:43:46.161775  2286 net.cpp:156] Memory required for data: 32412
I0924 02:43:46.161782  2268 net.cpp:91] Creating Layer lstm1_gate_input_1
I0924 02:43:46.161788  2286 layer_factory.hpp:77] Creating layer lstm2
I0924 02:43:46.161795  2268 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0924 02:43:46.161808  2268 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0924 02:43:46.161819  2286 net.cpp:91] Creating Layer lstm2
I0924 02:43:46.161823  2268 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0924 02:43:46.161833  2286 net.cpp:425] lstm2 <- lstm1_video_sequence
I0924 02:43:46.161847  2286 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0924 02:43:46.161862  2286 net.cpp:399] lstm2 -> lstm2
I0924 02:43:46.161887  2286 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0924 02:43:46.162331  2286 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0924 02:43:46.162477  2286 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:43:46.162497  2286 net.cpp:91] Creating Layer lstm2_
I0924 02:43:46.162509  2286 net.cpp:399] lstm2_ -> x
I0924 02:43:46.162539  2286 net.cpp:399] lstm2_ -> cont
I0924 02:43:46.162988  2268 net.cpp:141] Setting up lstm1_gate_input_1
I0924 02:43:46.163007  2268 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:46.163015  2268 net.cpp:156] Memory required for data: 78016
I0924 02:43:46.163023  2268 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0924 02:43:46.163043  2268 net.cpp:91] Creating Layer lstm1_unit_1
I0924 02:43:46.163050  2268 net.cpp:425] lstm1_unit_1 <- c_0
I0924 02:43:46.163060  2268 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0924 02:43:46.163069  2268 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0924 02:43:46.163081  2268 net.cpp:399] lstm1_unit_1 -> c_1
I0924 02:43:46.163079  2286 net.cpp:141] Setting up lstm2_
I0924 02:43:46.163103  2268 net.cpp:399] lstm1_unit_1 -> h_1
I0924 02:43:46.163115  2286 net.cpp:148] Top shape: 1 1 1501 (1501)
I0924 02:43:46.163130  2286 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:46.163137  2286 net.cpp:156] Memory required for data: 6008
I0924 02:43:46.163147  2286 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:43:46.163162  2286 net.cpp:91] Creating Layer lstm2_
I0924 02:43:46.163180  2286 net.cpp:399] lstm2_ -> c_0
I0924 02:43:46.163200  2286 net.cpp:399] lstm2_ -> h_0
I0924 02:43:46.174620  2264 net.cpp:141] Setting up lstm2_transform_1
I0924 02:43:46.174679  2264 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:46.174688  2264 net.cpp:156] Memory required for data: 66020
I0924 02:43:46.174720  2264 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0924 02:43:46.174754  2264 net.cpp:91] Creating Layer lstm2_gate_input_1
I0924 02:43:46.174767  2264 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0924 02:43:46.174778  2264 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0924 02:43:46.174793  2264 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0924 02:43:46.174859  2264 net.cpp:141] Setting up lstm2_gate_input_1
I0924 02:43:46.174872  2264 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:46.174880  2264 net.cpp:156] Memory required for data: 82020
I0924 02:43:46.174888  2264 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0924 02:43:46.174903  2264 net.cpp:91] Creating Layer lstm2_unit_1
I0924 02:43:46.174911  2264 net.cpp:425] lstm2_unit_1 <- c_0
I0924 02:43:46.174921  2264 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0924 02:43:46.174931  2264 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0924 02:43:46.174945  2264 net.cpp:399] lstm2_unit_1 -> c_1
I0924 02:43:46.174960  2264 net.cpp:399] lstm2_unit_1 -> h_1
I0924 02:43:46.175057  2264 net.cpp:141] Setting up lstm2_unit_1
I0924 02:43:46.175071  2264 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.175081  2264 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.175089  2264 net.cpp:156] Memory required for data: 90020
I0924 02:43:46.175097  2264 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:43:46.175110  2264 net.cpp:91] Creating Layer lstm2_
I0924 02:43:46.175118  2264 net.cpp:425] lstm2_ <- c_1
I0924 02:43:46.175129  2264 net.cpp:399] lstm2_ -> c_T
I0924 02:43:46.175180  2264 net.cpp:141] Setting up lstm2_
I0924 02:43:46.175194  2264 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.175201  2264 net.cpp:156] Memory required for data: 94020
I0924 02:43:46.175209  2264 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0924 02:43:46.175225  2264 net.cpp:91] Creating Layer lstm2_h_concat
I0924 02:43:46.175233  2264 net.cpp:425] lstm2_h_concat <- h_1
I0924 02:43:46.175247  2264 net.cpp:399] lstm2_h_concat -> h
I0924 02:43:46.175298  2264 net.cpp:141] Setting up lstm2_h_concat
I0924 02:43:46.175312  2264 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.175318  2264 net.cpp:156] Memory required for data: 98020
I0924 02:43:46.175328  2264 layer_factory.hpp:77] Creating layer h_pseudoloss
I0924 02:43:46.175345  2264 net.cpp:91] Creating Layer h_pseudoloss
I0924 02:43:46.175354  2264 net.cpp:425] h_pseudoloss <- h
I0924 02:43:46.175366  2264 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0924 02:43:46.175498  2264 net.cpp:141] Setting up h_pseudoloss
I0924 02:43:46.175513  2264 net.cpp:148] Top shape: (1)
I0924 02:43:46.175521  2264 net.cpp:151]     with loss weight 1
I0924 02:43:46.175544  2264 net.cpp:156] Memory required for data: 98024
I0924 02:43:46.175552  2264 net.cpp:217] h_pseudoloss needs backward computation.
I0924 02:43:46.175560  2264 net.cpp:217] lstm2_h_concat needs backward computation.
I0924 02:43:46.175567  2264 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:43:46.175576  2264 net.cpp:217] lstm2_unit_1 needs backward computation.
I0924 02:43:46.175586  2264 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0924 02:43:46.175595  2264 net.cpp:217] lstm2_transform_1 needs backward computation.
I0924 02:43:46.175603  2264 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0924 02:43:46.175613  2264 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0924 02:43:46.175622  2264 net.cpp:217] lstm2_x_transform needs backward computation.
I0924 02:43:46.175631  2264 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0924 02:43:46.175640  2264 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0924 02:43:46.175650  2264 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:43:46.175657  2264 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:43:46.175665  2264 net.cpp:261] This network produces output c_T
I0924 02:43:46.175673  2264 net.cpp:261] This network produces output h_pseudoloss
I0924 02:43:46.175700  2264 net.cpp:274] Network initialization done.
I0924 02:43:46.175776  2264 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0924 02:43:46.175786  2264 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0924 02:43:46.175792  2264 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0924 02:43:46.175946  2264 net.cpp:141] Setting up lstm2
I0924 02:43:46.175963  2264 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.175971  2264 net.cpp:156] Memory required for data: 36412
I0924 02:43:46.175992  2264 layer_factory.hpp:77] Creating layer predict
I0924 02:43:46.176012  2264 net.cpp:91] Creating Layer predict
I0924 02:43:46.176023  2264 net.cpp:425] predict <- lstm2
I0924 02:43:46.176035  2264 net.cpp:399] predict -> predict
I0924 02:43:46.265992  2286 net.cpp:141] Setting up lstm2_
I0924 02:43:46.266067  2286 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.266079  2292 net.cpp:141] Setting up lstm2_transform_1
I0924 02:43:46.266091  2286 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.266104  2292 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:46.266106  2286 net.cpp:156] Memory required for data: 14008
I0924 02:43:46.266114  2292 net.cpp:156] Memory required for data: 66020
I0924 02:43:46.266129  2286 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0924 02:43:46.266136  2274 net.cpp:141] Setting up lstm1_transform_1
I0924 02:43:46.266141  2292 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0924 02:43:46.266160  2274 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:46.266167  2274 net.cpp:156] Memory required for data: 62016
I0924 02:43:46.266173  2292 net.cpp:91] Creating Layer lstm2_gate_input_1
I0924 02:43:46.266178  2286 net.cpp:91] Creating Layer lstm2_cont_slice
I0924 02:43:46.266185  2292 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0924 02:43:46.266183  2274 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0924 02:43:46.266206  2286 net.cpp:425] lstm2_cont_slice <- cont
I0924 02:43:46.266217  2292 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0924 02:43:46.266222  2274 net.cpp:91] Creating Layer lstm1_gate_input_1
I0924 02:43:46.266228  2268 net.cpp:141] Setting up lstm1_unit_1
I0924 02:43:46.266232  2286 net.cpp:399] lstm2_cont_slice -> cont_1
I0924 02:43:46.266232  2274 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0924 02:43:46.266257  2268 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.266233  2292 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0924 02:43:46.266270  2268 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.266270  2274 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0924 02:43:46.266284  2268 net.cpp:156] Memory required for data: 86016
I0924 02:43:46.266296  2268 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:43:46.266302  2274 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0924 02:43:46.266314  2268 net.cpp:91] Creating Layer lstm1_
I0924 02:43:46.266324  2268 net.cpp:425] lstm1_ <- c_1
I0924 02:43:46.266333  2268 net.cpp:399] lstm1_ -> c_T
I0924 02:43:46.266369  2286 net.cpp:141] Setting up lstm2_cont_slice
I0924 02:43:46.266397  2286 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:46.266413  2286 net.cpp:156] Memory required for data: 14012
I0924 02:43:46.266423  2274 net.cpp:141] Setting up lstm1_gate_input_1
I0924 02:43:46.266427  2286 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0924 02:43:46.266440  2274 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:46.266446  2274 net.cpp:156] Memory required for data: 78016
I0924 02:43:46.266450  2286 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0924 02:43:46.266454  2274 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0924 02:43:46.266458  2268 net.cpp:141] Setting up lstm1_
I0924 02:43:46.266490  2274 net.cpp:91] Creating Layer lstm1_unit_1
I0924 02:43:46.266501  2274 net.cpp:425] lstm1_unit_1 <- c_0
I0924 02:43:46.266502  2292 net.cpp:141] Setting up lstm2_gate_input_1
I0924 02:43:46.266476  2286 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0924 02:43:46.266516  2292 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:46.266516  2268 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.266512  2274 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0924 02:43:46.266527  2292 net.cpp:156] Memory required for data: 82020
I0924 02:43:46.266530  2268 net.cpp:156] Memory required for data: 90016
I0924 02:43:46.266535  2274 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0924 02:43:46.266541  2268 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0924 02:43:46.266536  2292 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0924 02:43:46.266546  2286 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0924 02:43:46.266556  2274 net.cpp:399] lstm1_unit_1 -> c_1
I0924 02:43:46.266558  2268 net.cpp:91] Creating Layer lstm1_h_concat
I0924 02:43:46.266559  2292 net.cpp:91] Creating Layer lstm2_unit_1
I0924 02:43:46.266576  2268 net.cpp:425] lstm1_h_concat <- h_1
I0924 02:43:46.266577  2286 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0924 02:43:46.266579  2274 net.cpp:399] lstm1_unit_1 -> h_1
I0924 02:43:46.266590  2268 net.cpp:399] lstm1_h_concat -> h
I0924 02:43:46.266580  2292 net.cpp:425] lstm2_unit_1 <- c_0
I0924 02:43:46.266647  2292 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0924 02:43:46.266665  2292 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0924 02:43:46.266682  2292 net.cpp:399] lstm2_unit_1 -> c_1
I0924 02:43:46.266695  2292 net.cpp:399] lstm2_unit_1 -> h_1
I0924 02:43:46.266718  2268 net.cpp:141] Setting up lstm1_h_concat
I0924 02:43:46.266731  2268 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.266736  2268 net.cpp:156] Memory required for data: 94016
I0924 02:43:46.266741  2268 layer_factory.hpp:77] Creating layer h_pseudoloss
I0924 02:43:46.266753  2268 net.cpp:91] Creating Layer h_pseudoloss
I0924 02:43:46.266758  2268 net.cpp:425] h_pseudoloss <- h
I0924 02:43:46.266768  2268 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0924 02:43:46.266787  2292 net.cpp:141] Setting up lstm2_unit_1
I0924 02:43:46.266803  2292 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.266815  2292 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.266824  2292 net.cpp:156] Memory required for data: 90020
I0924 02:43:46.266831  2292 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:43:46.266840  2292 net.cpp:91] Creating Layer lstm2_
I0924 02:43:46.266845  2292 net.cpp:425] lstm2_ <- c_1
I0924 02:43:46.266854  2292 net.cpp:399] lstm2_ -> c_T
I0924 02:43:46.266962  2286 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0924 02:43:46.266988  2286 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:46.267006  2286 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:46.267017  2292 net.cpp:141] Setting up lstm2_
I0924 02:43:46.267020  2286 net.cpp:156] Memory required for data: 14020
I0924 02:43:46.267030  2292 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.267035  2292 net.cpp:156] Memory required for data: 94020
I0924 02:43:46.267040  2292 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0924 02:43:46.267036  2286 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0924 02:43:46.267050  2292 net.cpp:91] Creating Layer lstm2_h_concat
I0924 02:43:46.267055  2292 net.cpp:425] lstm2_h_concat <- h_1
I0924 02:43:46.267069  2292 net.cpp:399] lstm2_h_concat -> h
I0924 02:43:46.267077  2286 net.cpp:91] Creating Layer lstm2_x_transform
I0924 02:43:46.267096  2286 net.cpp:425] lstm2_x_transform <- x
I0924 02:43:46.267123  2286 net.cpp:399] lstm2_x_transform -> W_xc_x
I0924 02:43:46.267138  2268 net.cpp:141] Setting up h_pseudoloss
I0924 02:43:46.267150  2268 net.cpp:148] Top shape: (1)
I0924 02:43:46.267166  2292 net.cpp:141] Setting up lstm2_h_concat
I0924 02:43:46.267155  2268 net.cpp:151]     with loss weight 1
I0924 02:43:46.267177  2292 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.267177  2268 net.cpp:156] Memory required for data: 94020
I0924 02:43:46.267182  2292 net.cpp:156] Memory required for data: 98020
I0924 02:43:46.267184  2268 net.cpp:217] h_pseudoloss needs backward computation.
I0924 02:43:46.267187  2292 layer_factory.hpp:77] Creating layer h_pseudoloss
I0924 02:43:46.267190  2268 net.cpp:217] lstm1_h_concat needs backward computation.
I0924 02:43:46.267195  2268 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:43:46.267199  2292 net.cpp:91] Creating Layer h_pseudoloss
I0924 02:43:46.267202  2268 net.cpp:217] lstm1_unit_1 needs backward computation.
I0924 02:43:46.267204  2292 net.cpp:425] h_pseudoloss <- h
I0924 02:43:46.267210  2268 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0924 02:43:46.267212  2292 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0924 02:43:46.267225  2268 net.cpp:217] lstm1_transform_1 needs backward computation.
I0924 02:43:46.267237  2268 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0924 02:43:46.267249  2268 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0924 02:43:46.267256  2268 net.cpp:217] lstm1_x_transform needs backward computation.
I0924 02:43:46.267261  2268 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0924 02:43:46.267271  2268 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0924 02:43:46.267274  2274 net.cpp:141] Setting up lstm1_unit_1
I0924 02:43:46.267280  2268 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:43:46.267289  2268 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:43:46.267292  2274 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.267297  2268 net.cpp:261] This network produces output c_T
I0924 02:43:46.267299  2274 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.267309  2268 net.cpp:261] This network produces output h_pseudoloss
I0924 02:43:46.267310  2274 net.cpp:156] Memory required for data: 86016
I0924 02:43:46.267321  2274 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:43:46.267330  2274 net.cpp:91] Creating Layer lstm1_
I0924 02:43:46.267330  2268 net.cpp:274] Network initialization done.
I0924 02:43:46.267335  2274 net.cpp:425] lstm1_ <- c_1
I0924 02:43:46.267343  2274 net.cpp:399] lstm1_ -> c_T
I0924 02:43:46.267397  2268 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0924 02:43:46.267406  2268 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0924 02:43:46.267411  2268 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0924 02:43:46.281699  2274 net.cpp:141] Setting up lstm1_
I0924 02:43:46.281790  2274 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.281810  2274 net.cpp:156] Memory required for data: 90016
I0924 02:43:46.281831  2274 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0924 02:43:46.281735  2292 net.cpp:141] Setting up h_pseudoloss
I0924 02:43:46.281877  2292 net.cpp:148] Top shape: (1)
I0924 02:43:46.281893  2274 net.cpp:91] Creating Layer lstm1_h_concat
I0924 02:43:46.281900  2268 net.cpp:141] Setting up lstm1
I0924 02:43:46.281889  2292 net.cpp:151]     with loss weight 1
I0924 02:43:46.281915  2292 net.cpp:156] Memory required for data: 98024
I0924 02:43:46.281919  2268 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.281927  2292 net.cpp:217] h_pseudoloss needs backward computation.
I0924 02:43:46.281939  2292 net.cpp:217] lstm2_h_concat needs backward computation.
I0924 02:43:46.281947  2292 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:43:46.281951  2268 net.cpp:156] Memory required for data: 26408
I0924 02:43:46.281957  2292 net.cpp:217] lstm2_unit_1 needs backward computation.
I0924 02:43:46.281968  2292 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0924 02:43:46.281978  2292 net.cpp:217] lstm2_transform_1 needs backward computation.
I0924 02:43:46.281981  2268 layer_factory.hpp:77] Creating layer concat
I0924 02:43:46.281990  2292 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0924 02:43:46.281996  2268 net.cpp:91] Creating Layer concat
I0924 02:43:46.282001  2292 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0924 02:43:46.282006  2268 net.cpp:425] concat <- lstm1
I0924 02:43:46.282009  2292 net.cpp:217] lstm2_x_transform needs backward computation.
I0924 02:43:46.282019  2268 net.cpp:425] concat <- embedded_input_sentence
I0924 02:43:46.282066  2268 net.cpp:425] concat <- reshaped_stage_indicator
I0924 02:43:46.281915  2274 net.cpp:425] lstm1_h_concat <- h_1
I0924 02:43:46.282105  2268 net.cpp:399] concat -> lstm1_video_sequence
I0924 02:43:46.282018  2292 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0924 02:43:46.282132  2274 net.cpp:399] lstm1_h_concat -> h
I0924 02:43:46.282146  2292 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0924 02:43:46.282160  2292 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:43:46.282169  2292 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:43:46.282171  2268 net.cpp:141] Setting up concat
I0924 02:43:46.282176  2292 net.cpp:261] This network produces output c_T
I0924 02:43:46.282192  2268 net.cpp:148] Top shape: 1 1 1501 (1501)
I0924 02:43:46.282194  2292 net.cpp:261] This network produces output h_pseudoloss
I0924 02:43:46.282209  2268 net.cpp:156] Memory required for data: 32412
I0924 02:43:46.282218  2268 layer_factory.hpp:77] Creating layer lstm2
I0924 02:43:46.282239  2292 net.cpp:274] Network initialization done.
I0924 02:43:46.282253  2274 net.cpp:141] Setting up lstm1_h_concat
I0924 02:43:46.282240  2268 net.cpp:91] Creating Layer lstm2
I0924 02:43:46.282280  2274 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.282281  2268 net.cpp:425] lstm2 <- lstm1_video_sequence
I0924 02:43:46.282305  2274 net.cpp:156] Memory required for data: 94016
I0924 02:43:46.282310  2268 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0924 02:43:46.282330  2292 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0924 02:43:46.282332  2274 layer_factory.hpp:77] Creating layer h_pseudoloss
I0924 02:43:46.282340  2268 net.cpp:399] lstm2 -> lstm2
I0924 02:43:46.282366  2268 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0924 02:43:46.282369  2274 net.cpp:91] Creating Layer h_pseudoloss
I0924 02:43:46.282389  2274 net.cpp:425] h_pseudoloss <- h
I0924 02:43:46.282413  2274 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0924 02:43:46.282340  2292 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0924 02:43:46.282464  2292 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0924 02:43:46.282829  2268 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0924 02:43:46.282974  2268 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:43:46.282994  2268 net.cpp:91] Creating Layer lstm2_
I0924 02:43:46.283004  2268 net.cpp:399] lstm2_ -> x
I0924 02:43:46.283021  2268 net.cpp:399] lstm2_ -> cont
I0924 02:43:46.284626  2268 net.cpp:141] Setting up lstm2_
I0924 02:43:46.284678  2268 net.cpp:148] Top shape: 1 1 1501 (1501)
I0924 02:43:46.284693  2268 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:46.284700  2268 net.cpp:156] Memory required for data: 6008
I0924 02:43:46.284713  2268 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:43:46.284741  2268 net.cpp:91] Creating Layer lstm2_
I0924 02:43:46.284760  2268 net.cpp:399] lstm2_ -> c_0
I0924 02:43:46.284785  2268 net.cpp:399] lstm2_ -> h_0
I0924 02:43:46.286180  2292 net.cpp:141] Setting up lstm2
I0924 02:43:46.286216  2292 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.286223  2292 net.cpp:156] Memory required for data: 36412
I0924 02:43:46.286253  2292 layer_factory.hpp:77] Creating layer predict
I0924 02:43:46.286280  2292 net.cpp:91] Creating Layer predict
I0924 02:43:46.286281  2268 net.cpp:141] Setting up lstm2_
I0924 02:43:46.286290  2292 net.cpp:425] predict <- lstm2
I0924 02:43:46.286303  2268 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.286305  2292 net.cpp:399] predict -> predict
I0924 02:43:46.286315  2268 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.286322  2268 net.cpp:156] Memory required for data: 14008
I0924 02:43:46.286331  2268 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0924 02:43:46.286350  2268 net.cpp:91] Creating Layer lstm2_cont_slice
I0924 02:43:46.286360  2268 net.cpp:425] lstm2_cont_slice <- cont
I0924 02:43:46.286373  2268 net.cpp:399] lstm2_cont_slice -> cont_1
I0924 02:43:46.289685  2268 net.cpp:141] Setting up lstm2_cont_slice
I0924 02:43:46.289737  2268 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:46.289747  2268 net.cpp:156] Memory required for data: 14012
I0924 02:43:46.289772  2268 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0924 02:43:46.289799  2268 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0924 02:43:46.289811  2268 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0924 02:43:46.289829  2268 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0924 02:43:46.289854  2268 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0924 02:43:46.383908  2268 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0924 02:43:46.383976  2268 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:46.383991  2268 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:46.384001  2268 net.cpp:156] Memory required for data: 14020
I0924 02:43:46.384016  2268 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0924 02:43:46.384023  2274 net.cpp:141] Setting up h_pseudoloss
I0924 02:43:46.384048  2274 net.cpp:148] Top shape: (1)
I0924 02:43:46.384057  2268 net.cpp:91] Creating Layer lstm2_x_transform
I0924 02:43:46.384073  2268 net.cpp:425] lstm2_x_transform <- x
I0924 02:43:46.384057  2274 net.cpp:151]     with loss weight 1
I0924 02:43:46.384085  2274 net.cpp:156] Memory required for data: 94020
I0924 02:43:46.384093  2268 net.cpp:399] lstm2_x_transform -> W_xc_x
I0924 02:43:46.384096  2274 net.cpp:217] h_pseudoloss needs backward computation.
I0924 02:43:46.384106  2274 net.cpp:217] lstm1_h_concat needs backward computation.
I0924 02:43:46.384115  2274 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:43:46.384126  2274 net.cpp:217] lstm1_unit_1 needs backward computation.
I0924 02:43:46.384138  2274 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0924 02:43:46.384145  2274 net.cpp:217] lstm1_transform_1 needs backward computation.
I0924 02:43:46.384151  2274 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0924 02:43:46.384158  2274 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0924 02:43:46.384163  2274 net.cpp:217] lstm1_x_transform needs backward computation.
I0924 02:43:46.384168  2274 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0924 02:43:46.384177  2274 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0924 02:43:46.384187  2274 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:43:46.384196  2274 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:43:46.384202  2274 net.cpp:261] This network produces output c_T
I0924 02:43:46.384212  2274 net.cpp:261] This network produces output h_pseudoloss
I0924 02:43:46.384246  2274 net.cpp:274] Network initialization done.
I0924 02:43:46.384251  2286 net.cpp:141] Setting up lstm2_x_transform
I0924 02:43:46.384268  2286 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:46.384275  2286 net.cpp:156] Memory required for data: 30020
I0924 02:43:46.384294  2286 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0924 02:43:46.384315  2286 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0924 02:43:46.384325  2286 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0924 02:43:46.384325  2274 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0924 02:43:46.384346  2274 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0924 02:43:46.384346  2286 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0924 02:43:46.384361  2274 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0924 02:43:46.400180  2286 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0924 02:43:46.400243  2286 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:46.400254  2286 net.cpp:156] Memory required for data: 46020
I0924 02:43:46.400269  2286 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0924 02:43:46.400303  2286 net.cpp:91] Creating Layer lstm2_h_conted_0
I0924 02:43:46.400316  2286 net.cpp:425] lstm2_h_conted_0 <- h_0
I0924 02:43:46.400331  2286 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0924 02:43:46.400346  2286 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0924 02:43:46.400529  2286 net.cpp:141] Setting up lstm2_h_conted_0
I0924 02:43:46.400545  2286 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.400553  2286 net.cpp:156] Memory required for data: 50020
I0924 02:43:46.400562  2286 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0924 02:43:46.400585  2286 net.cpp:91] Creating Layer lstm2_transform_1
I0924 02:43:46.400593  2286 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0924 02:43:46.400607  2286 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0924 02:43:46.412318  2274 net.cpp:141] Setting up lstm1
I0924 02:43:46.412375  2274 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.412387  2274 net.cpp:156] Memory required for data: 26408
I0924 02:43:46.412417  2274 layer_factory.hpp:77] Creating layer concat
I0924 02:43:46.412442  2274 net.cpp:91] Creating Layer concat
I0924 02:43:46.412454  2274 net.cpp:425] concat <- lstm1
I0924 02:43:46.412467  2274 net.cpp:425] concat <- embedded_input_sentence
I0924 02:43:46.412477  2274 net.cpp:425] concat <- reshaped_stage_indicator
I0924 02:43:46.412490  2274 net.cpp:399] concat -> lstm1_video_sequence
I0924 02:43:46.416472  2274 net.cpp:141] Setting up concat
I0924 02:43:46.416527  2274 net.cpp:148] Top shape: 1 1 1501 (1501)
I0924 02:43:46.416538  2274 net.cpp:156] Memory required for data: 32412
I0924 02:43:46.416551  2274 layer_factory.hpp:77] Creating layer lstm2
I0924 02:43:46.416584  2274 net.cpp:91] Creating Layer lstm2
I0924 02:43:46.416597  2274 net.cpp:425] lstm2 <- lstm1_video_sequence
I0924 02:43:46.416612  2274 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0924 02:43:46.416630  2274 net.cpp:399] lstm2 -> lstm2
I0924 02:43:46.416656  2274 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0924 02:43:46.417090  2274 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0924 02:43:46.417228  2274 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:43:46.417248  2274 net.cpp:91] Creating Layer lstm2_
I0924 02:43:46.417259  2274 net.cpp:399] lstm2_ -> x
I0924 02:43:46.417276  2274 net.cpp:399] lstm2_ -> cont
I0924 02:43:46.418673  2274 net.cpp:141] Setting up lstm2_
I0924 02:43:46.418694  2274 net.cpp:148] Top shape: 1 1 1501 (1501)
I0924 02:43:46.418705  2274 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:46.418712  2274 net.cpp:156] Memory required for data: 6008
I0924 02:43:46.418720  2274 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:43:46.418736  2274 net.cpp:91] Creating Layer lstm2_
I0924 02:43:46.418747  2274 net.cpp:399] lstm2_ -> c_0
I0924 02:43:46.418771  2274 net.cpp:399] lstm2_ -> h_0
I0924 02:43:46.419788  2274 net.cpp:141] Setting up lstm2_
I0924 02:43:46.419806  2274 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.419817  2274 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.419824  2274 net.cpp:156] Memory required for data: 14008
I0924 02:43:46.419833  2274 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0924 02:43:46.419860  2274 net.cpp:91] Creating Layer lstm2_cont_slice
I0924 02:43:46.419870  2274 net.cpp:425] lstm2_cont_slice <- cont
I0924 02:43:46.419883  2274 net.cpp:399] lstm2_cont_slice -> cont_1
I0924 02:43:46.420867  2274 net.cpp:141] Setting up lstm2_cont_slice
I0924 02:43:46.420884  2274 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:46.420893  2274 net.cpp:156] Memory required for data: 14012
I0924 02:43:46.420902  2274 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0924 02:43:46.420914  2274 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0924 02:43:46.420923  2274 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0924 02:43:46.420941  2274 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0924 02:43:46.420958  2274 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0924 02:43:46.421113  2274 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0924 02:43:46.421129  2274 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:46.421140  2274 net.cpp:148] Top shape: 1 1 (1)
I0924 02:43:46.421149  2274 net.cpp:156] Memory required for data: 14020
I0924 02:43:46.421156  2274 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0924 02:43:46.421180  2274 net.cpp:91] Creating Layer lstm2_x_transform
I0924 02:43:46.421190  2274 net.cpp:425] lstm2_x_transform <- x
I0924 02:43:46.421203  2274 net.cpp:399] lstm2_x_transform -> W_xc_x
I0924 02:43:46.457229  2286 net.cpp:141] Setting up lstm2_transform_1
I0924 02:43:46.457278  2286 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:46.457283  2286 net.cpp:156] Memory required for data: 66020
I0924 02:43:46.457304  2286 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0924 02:43:46.457326  2286 net.cpp:91] Creating Layer lstm2_gate_input_1
I0924 02:43:46.457334  2286 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0924 02:43:46.457341  2286 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0924 02:43:46.457350  2286 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0924 02:43:46.457420  2268 net.cpp:141] Setting up lstm2_x_transform
I0924 02:43:46.457438  2268 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:46.457444  2268 net.cpp:156] Memory required for data: 30020
I0924 02:43:46.457453  2286 net.cpp:141] Setting up lstm2_gate_input_1
I0924 02:43:46.457464  2286 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:46.457464  2268 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0924 02:43:46.457469  2286 net.cpp:156] Memory required for data: 82020
I0924 02:43:46.457474  2286 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0924 02:43:46.457479  2268 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0924 02:43:46.457484  2286 net.cpp:91] Creating Layer lstm2_unit_1
I0924 02:43:46.457486  2268 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0924 02:43:46.457490  2286 net.cpp:425] lstm2_unit_1 <- c_0
I0924 02:43:46.457495  2268 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0924 02:43:46.457497  2286 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0924 02:43:46.457504  2286 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0924 02:43:46.457511  2286 net.cpp:399] lstm2_unit_1 -> c_1
I0924 02:43:46.457520  2286 net.cpp:399] lstm2_unit_1 -> h_1
I0924 02:43:46.457558  2268 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0924 02:43:46.457574  2268 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:46.457582  2268 net.cpp:156] Memory required for data: 46020
I0924 02:43:46.457589  2268 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0924 02:43:46.457599  2268 net.cpp:91] Creating Layer lstm2_h_conted_0
I0924 02:43:46.457605  2268 net.cpp:425] lstm2_h_conted_0 <- h_0
I0924 02:43:46.457612  2268 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0924 02:43:46.457619  2268 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0924 02:43:46.457641  2286 net.cpp:141] Setting up lstm2_unit_1
I0924 02:43:46.457653  2286 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.457659  2286 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.457662  2286 net.cpp:156] Memory required for data: 90020
I0924 02:43:46.457667  2286 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:43:46.457679  2286 net.cpp:91] Creating Layer lstm2_
I0924 02:43:46.457684  2286 net.cpp:425] lstm2_ <- c_1
I0924 02:43:46.457691  2286 net.cpp:399] lstm2_ -> c_T
I0924 02:43:46.457768  2268 net.cpp:141] Setting up lstm2_h_conted_0
I0924 02:43:46.457780  2268 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.457784  2268 net.cpp:156] Memory required for data: 50020
I0924 02:43:46.457790  2268 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0924 02:43:46.457792  2286 net.cpp:141] Setting up lstm2_
I0924 02:43:46.457803  2286 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.457804  2268 net.cpp:91] Creating Layer lstm2_transform_1
I0924 02:43:46.457806  2286 net.cpp:156] Memory required for data: 94020
I0924 02:43:46.457818  2268 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0924 02:43:46.457820  2286 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0924 02:43:46.457834  2268 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0924 02:43:46.457837  2286 net.cpp:91] Creating Layer lstm2_h_concat
I0924 02:43:46.457844  2286 net.cpp:425] lstm2_h_concat <- h_1
I0924 02:43:46.457854  2286 net.cpp:399] lstm2_h_concat -> h
I0924 02:43:46.466980  2286 net.cpp:141] Setting up lstm2_h_concat
I0924 02:43:46.467048  2286 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.467061  2286 net.cpp:156] Memory required for data: 98020
I0924 02:43:46.467075  2286 layer_factory.hpp:77] Creating layer h_pseudoloss
I0924 02:43:46.467103  2286 net.cpp:91] Creating Layer h_pseudoloss
I0924 02:43:46.467115  2286 net.cpp:425] h_pseudoloss <- h
I0924 02:43:46.467135  2286 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0924 02:43:46.467358  2286 net.cpp:141] Setting up h_pseudoloss
I0924 02:43:46.467377  2286 net.cpp:148] Top shape: (1)
I0924 02:43:46.467386  2286 net.cpp:151]     with loss weight 1
I0924 02:43:46.467416  2286 net.cpp:156] Memory required for data: 98024
I0924 02:43:46.467427  2286 net.cpp:217] h_pseudoloss needs backward computation.
I0924 02:43:46.467435  2286 net.cpp:217] lstm2_h_concat needs backward computation.
I0924 02:43:46.467445  2286 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:43:46.467455  2286 net.cpp:217] lstm2_unit_1 needs backward computation.
I0924 02:43:46.467466  2286 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0924 02:43:46.467478  2286 net.cpp:217] lstm2_transform_1 needs backward computation.
I0924 02:43:46.467489  2286 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0924 02:43:46.467500  2286 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0924 02:43:46.467511  2286 net.cpp:217] lstm2_x_transform needs backward computation.
I0924 02:43:46.467522  2286 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0924 02:43:46.467533  2286 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0924 02:43:46.467543  2286 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:43:46.467552  2286 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:43:46.467561  2286 net.cpp:261] This network produces output c_T
I0924 02:43:46.467571  2286 net.cpp:261] This network produces output h_pseudoloss
I0924 02:43:46.467602  2286 net.cpp:274] Network initialization done.
I0924 02:43:46.467689  2286 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0924 02:43:46.467702  2286 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0924 02:43:46.467711  2286 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0924 02:43:46.469076  2286 net.cpp:141] Setting up lstm2
I0924 02:43:46.469096  2286 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.469102  2286 net.cpp:156] Memory required for data: 36412
I0924 02:43:46.469118  2286 layer_factory.hpp:77] Creating layer predict
I0924 02:43:46.469135  2286 net.cpp:91] Creating Layer predict
I0924 02:43:46.469142  2286 net.cpp:425] predict <- lstm2
I0924 02:43:46.469151  2286 net.cpp:399] predict -> predict
I0924 02:43:46.579561  2268 net.cpp:141] Setting up lstm2_transform_1
I0924 02:43:46.579618  2268 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:46.579625  2268 net.cpp:156] Memory required for data: 66020
I0924 02:43:46.579648  2268 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0924 02:43:46.579666  2268 net.cpp:91] Creating Layer lstm2_gate_input_1
I0924 02:43:46.579674  2268 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0924 02:43:46.579681  2268 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0924 02:43:46.579689  2268 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0924 02:43:46.579859  2268 net.cpp:141] Setting up lstm2_gate_input_1
I0924 02:43:46.579869  2268 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:46.579874  2268 net.cpp:156] Memory required for data: 82020
I0924 02:43:46.579879  2268 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0924 02:43:46.579891  2268 net.cpp:91] Creating Layer lstm2_unit_1
I0924 02:43:46.579896  2268 net.cpp:425] lstm2_unit_1 <- c_0
I0924 02:43:46.579903  2268 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0924 02:43:46.579910  2268 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0924 02:43:46.579916  2268 net.cpp:399] lstm2_unit_1 -> c_1
I0924 02:43:46.579926  2268 net.cpp:399] lstm2_unit_1 -> h_1
I0924 02:43:46.580097  2274 net.cpp:141] Setting up lstm2_x_transform
I0924 02:43:46.580148  2268 net.cpp:141] Setting up lstm2_unit_1
I0924 02:43:46.580162  2268 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.580157  2274 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:46.580168  2268 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.580190  2268 net.cpp:156] Memory required for data: 90020
I0924 02:43:46.580188  2274 net.cpp:156] Memory required for data: 30020
I0924 02:43:46.580196  2268 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:43:46.580221  2268 net.cpp:91] Creating Layer lstm2_
I0924 02:43:46.580227  2268 net.cpp:425] lstm2_ <- c_1
I0924 02:43:46.580235  2268 net.cpp:399] lstm2_ -> c_T
I0924 02:43:46.580238  2274 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0924 02:43:46.580283  2274 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0924 02:43:46.580305  2274 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0924 02:43:46.580332  2274 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0924 02:43:46.580473  2274 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0924 02:43:46.580504  2274 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:46.580513  2268 net.cpp:141] Setting up lstm2_
I0924 02:43:46.580520  2274 net.cpp:156] Memory required for data: 46020
I0924 02:43:46.580525  2268 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.580546  2268 net.cpp:156] Memory required for data: 94020
I0924 02:43:46.580544  2274 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0924 02:43:46.580554  2268 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0924 02:43:46.580567  2268 net.cpp:91] Creating Layer lstm2_h_concat
I0924 02:43:46.580572  2268 net.cpp:425] lstm2_h_concat <- h_1
I0924 02:43:46.580579  2268 net.cpp:399] lstm2_h_concat -> h
I0924 02:43:46.580585  2274 net.cpp:91] Creating Layer lstm2_h_conted_0
I0924 02:43:46.580617  2274 net.cpp:425] lstm2_h_conted_0 <- h_0
I0924 02:43:46.580637  2274 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0924 02:43:46.580662  2274 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0924 02:43:46.580765  2268 net.cpp:141] Setting up lstm2_h_concat
I0924 02:43:46.580782  2268 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.580787  2268 net.cpp:156] Memory required for data: 98020
I0924 02:43:46.580793  2268 layer_factory.hpp:77] Creating layer h_pseudoloss
I0924 02:43:46.580802  2268 net.cpp:91] Creating Layer h_pseudoloss
I0924 02:43:46.580807  2268 net.cpp:425] h_pseudoloss <- h
I0924 02:43:46.580817  2268 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0924 02:43:46.586652  2268 net.cpp:141] Setting up h_pseudoloss
I0924 02:43:46.586704  2268 net.cpp:148] Top shape: (1)
I0924 02:43:46.586715  2268 net.cpp:151]     with loss weight 1
I0924 02:43:46.586747  2268 net.cpp:156] Memory required for data: 98024
I0924 02:43:46.586760  2268 net.cpp:217] h_pseudoloss needs backward computation.
I0924 02:43:46.586771  2268 net.cpp:217] lstm2_h_concat needs backward computation.
I0924 02:43:46.586782  2268 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:43:46.586792  2268 net.cpp:217] lstm2_unit_1 needs backward computation.
I0924 02:43:46.586799  2268 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0924 02:43:46.586810  2268 net.cpp:217] lstm2_transform_1 needs backward computation.
I0924 02:43:46.586820  2268 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0924 02:43:46.586833  2268 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0924 02:43:46.586838  2268 net.cpp:217] lstm2_x_transform needs backward computation.
I0924 02:43:46.586849  2268 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0924 02:43:46.586860  2268 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0924 02:43:46.586866  2268 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:43:46.586871  2268 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:43:46.586875  2268 net.cpp:261] This network produces output c_T
I0924 02:43:46.586880  2268 net.cpp:261] This network produces output h_pseudoloss
I0924 02:43:46.586900  2268 net.cpp:274] Network initialization done.
I0924 02:43:46.586953  2268 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0924 02:43:46.586961  2268 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0924 02:43:46.586966  2268 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0924 02:43:46.587086  2268 net.cpp:141] Setting up lstm2
I0924 02:43:46.587128  2268 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.587133  2268 net.cpp:156] Memory required for data: 36412
I0924 02:43:46.587148  2268 layer_factory.hpp:77] Creating layer predict
I0924 02:43:46.587162  2268 net.cpp:91] Creating Layer predict
I0924 02:43:46.587169  2268 net.cpp:425] predict <- lstm2
I0924 02:43:46.587177  2268 net.cpp:399] predict -> predict
I0924 02:43:46.667927  2274 net.cpp:141] Setting up lstm2_h_conted_0
I0924 02:43:46.667982  2274 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.667991  2274 net.cpp:156] Memory required for data: 50020
I0924 02:43:46.668004  2274 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0924 02:43:46.668038  2274 net.cpp:91] Creating Layer lstm2_transform_1
I0924 02:43:46.668036  2264 net.cpp:141] Setting up predict
I0924 02:43:46.668078  2274 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0924 02:43:46.668108  2264 net.cpp:148] Top shape: 1 1 46168 (46168)
I0924 02:43:46.668118  2264 net.cpp:156] Memory required for data: 221084
I0924 02:43:46.668118  2274 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0924 02:43:46.668140  2264 layer_factory.hpp:77] Creating layer probs
I0924 02:43:46.668162  2264 net.cpp:91] Creating Layer probs
I0924 02:43:46.668172  2264 net.cpp:425] probs <- predict
I0924 02:43:46.668184  2264 net.cpp:399] probs -> probs
I0924 02:43:46.687693  2264 net.cpp:141] Setting up probs
I0924 02:43:46.687738  2264 net.cpp:148] Top shape: 1 1 46168 (46168)
I0924 02:43:46.687746  2264 net.cpp:156] Memory required for data: 405756
I0924 02:43:46.687754  2264 net.cpp:219] probs does not need backward computation.
I0924 02:43:46.687762  2264 net.cpp:219] predict does not need backward computation.
I0924 02:43:46.687767  2264 net.cpp:219] lstm2 does not need backward computation.
I0924 02:43:46.687773  2264 net.cpp:219] concat does not need backward computation.
I0924 02:43:46.687780  2264 net.cpp:219] lstm1 does not need backward computation.
I0924 02:43:46.687786  2264 net.cpp:219] embedding does not need backward computation.
I0924 02:43:46.687791  2264 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0924 02:43:46.687798  2264 net.cpp:219] reshape_frames does not need backward computation.
I0924 02:43:46.687803  2264 net.cpp:219] embed_encoder does not need backward computation.
I0924 02:43:46.687808  2264 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0924 02:43:46.687813  2264 net.cpp:219] input does not need backward computation.
I0924 02:43:46.687818  2264 net.cpp:261] This network produces output probs
I0924 02:43:46.687834  2264 net.cpp:274] Network initialization done.
I0924 02:43:46.688854  2272 net.cpp:141] Setting up conv1
I0924 02:43:46.688879  2272 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0924 02:43:46.688887  2272 net.cpp:156] Memory required for data: 17799480
I0924 02:43:46.688915  2272 layer_factory.hpp:77] Creating layer relu1
I0924 02:43:46.688936  2272 net.cpp:91] Creating Layer relu1
I0924 02:43:46.688946  2272 net.cpp:425] relu1 <- conv1
I0924 02:43:46.688957  2272 net.cpp:386] relu1 -> conv1 (in-place)
I0924 02:43:46.689303  2272 net.cpp:141] Setting up relu1
I0924 02:43:46.689321  2272 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0924 02:43:46.689328  2272 net.cpp:156] Memory required for data: 29415480
I0924 02:43:46.689337  2272 layer_factory.hpp:77] Creating layer pool1
I0924 02:43:46.689354  2272 net.cpp:91] Creating Layer pool1
I0924 02:43:46.689363  2272 net.cpp:425] pool1 <- conv1
I0924 02:43:46.689374  2272 net.cpp:399] pool1 -> pool1
I0924 02:43:46.689479  2272 net.cpp:141] Setting up pool1
I0924 02:43:46.689497  2272 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0924 02:43:46.689504  2272 net.cpp:156] Memory required for data: 32214840
I0924 02:43:46.689512  2272 layer_factory.hpp:77] Creating layer norm1
I0924 02:43:46.689534  2272 net.cpp:91] Creating Layer norm1
I0924 02:43:46.689543  2272 net.cpp:425] norm1 <- pool1
I0924 02:43:46.689554  2272 net.cpp:399] norm1 -> norm1
I0924 02:43:46.690156  2272 net.cpp:141] Setting up norm1
I0924 02:43:46.690177  2272 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0924 02:43:46.690187  2272 net.cpp:156] Memory required for data: 35014200
I0924 02:43:46.690198  2272 layer_factory.hpp:77] Creating layer conv2
I0924 02:43:46.690222  2272 net.cpp:91] Creating Layer conv2
I0924 02:43:46.690232  2272 net.cpp:425] conv2 <- norm1
I0924 02:43:46.690245  2272 net.cpp:399] conv2 -> conv2
I0924 02:43:46.696920  2272 net.cpp:141] Setting up conv2
I0924 02:43:46.696992  2272 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0924 02:43:46.697002  2272 net.cpp:156] Memory required for data: 42479160
I0924 02:43:46.697032  2272 layer_factory.hpp:77] Creating layer relu2
I0924 02:43:46.697055  2272 net.cpp:91] Creating Layer relu2
I0924 02:43:46.697065  2272 net.cpp:425] relu2 <- conv2
I0924 02:43:46.697078  2272 net.cpp:386] relu2 -> conv2 (in-place)
I0924 02:43:46.697398  2272 net.cpp:141] Setting up relu2
I0924 02:43:46.697413  2272 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0924 02:43:46.697422  2272 net.cpp:156] Memory required for data: 49944120
I0924 02:43:46.697429  2272 layer_factory.hpp:77] Creating layer pool2
I0924 02:43:46.697445  2272 net.cpp:91] Creating Layer pool2
I0924 02:43:46.697453  2272 net.cpp:425] pool2 <- conv2
I0924 02:43:46.697466  2272 net.cpp:399] pool2 -> pool2
I0924 02:43:46.697547  2272 net.cpp:141] Setting up pool2
I0924 02:43:46.697561  2272 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0924 02:43:46.697568  2272 net.cpp:156] Memory required for data: 51674680
I0924 02:43:46.697577  2272 layer_factory.hpp:77] Creating layer norm2
I0924 02:43:46.697597  2272 net.cpp:91] Creating Layer norm2
I0924 02:43:46.697603  2272 net.cpp:425] norm2 <- pool2
I0924 02:43:46.697615  2272 net.cpp:399] norm2 -> norm2
I0924 02:43:46.698251  2272 net.cpp:141] Setting up norm2
I0924 02:43:46.698267  2272 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0924 02:43:46.698276  2272 net.cpp:156] Memory required for data: 53405240
I0924 02:43:46.698283  2272 layer_factory.hpp:77] Creating layer conv3
I0924 02:43:46.698302  2272 net.cpp:91] Creating Layer conv3
I0924 02:43:46.698310  2272 net.cpp:425] conv3 <- norm2
I0924 02:43:46.698321  2272 net.cpp:399] conv3 -> conv3
I0924 02:43:46.704315  2272 net.cpp:141] Setting up conv3
I0924 02:43:46.704367  2272 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0924 02:43:46.704377  2272 net.cpp:156] Memory required for data: 56001080
I0924 02:43:46.704406  2272 layer_factory.hpp:77] Creating layer relu3
I0924 02:43:46.704427  2272 net.cpp:91] Creating Layer relu3
I0924 02:43:46.704438  2272 net.cpp:425] relu3 <- conv3
I0924 02:43:46.704454  2272 net.cpp:386] relu3 -> conv3 (in-place)
I0924 02:43:46.705014  2272 net.cpp:141] Setting up relu3
I0924 02:43:46.705032  2272 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0924 02:43:46.705040  2272 net.cpp:156] Memory required for data: 58596920
I0924 02:43:46.705049  2272 layer_factory.hpp:77] Creating layer conv4
I0924 02:43:46.705070  2272 net.cpp:91] Creating Layer conv4
I0924 02:43:46.705078  2272 net.cpp:425] conv4 <- conv3
I0924 02:43:46.705092  2272 net.cpp:399] conv4 -> conv4
I0924 02:43:46.716375  2272 net.cpp:141] Setting up conv4
I0924 02:43:46.716431  2272 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0924 02:43:46.716441  2272 net.cpp:156] Memory required for data: 61192760
I0924 02:43:46.716464  2272 layer_factory.hpp:77] Creating layer relu4
I0924 02:43:46.716490  2272 net.cpp:91] Creating Layer relu4
I0924 02:43:46.716500  2272 net.cpp:425] relu4 <- conv4
I0924 02:43:46.716516  2272 net.cpp:386] relu4 -> conv4 (in-place)
I0924 02:43:46.718580  2272 net.cpp:141] Setting up relu4
I0924 02:43:46.718590  2274 net.cpp:141] Setting up lstm2_transform_1
I0924 02:43:46.718644  2274 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:46.718652  2274 net.cpp:156] Memory required for data: 66020
I0924 02:43:46.718670  2274 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0924 02:43:46.718690  2274 net.cpp:91] Creating Layer lstm2_gate_input_1
I0924 02:43:46.718701  2274 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0924 02:43:46.718710  2274 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0924 02:43:46.718719  2274 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0924 02:43:46.718775  2274 net.cpp:141] Setting up lstm2_gate_input_1
I0924 02:43:46.718786  2274 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:43:46.718791  2274 net.cpp:156] Memory required for data: 82020
I0924 02:43:46.718796  2274 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0924 02:43:46.718809  2274 net.cpp:91] Creating Layer lstm2_unit_1
I0924 02:43:46.718816  2274 net.cpp:425] lstm2_unit_1 <- c_0
I0924 02:43:46.718822  2274 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0924 02:43:46.718828  2274 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0924 02:43:46.718835  2274 net.cpp:399] lstm2_unit_1 -> c_1
I0924 02:43:46.718845  2274 net.cpp:399] lstm2_unit_1 -> h_1
I0924 02:43:46.718922  2274 net.cpp:141] Setting up lstm2_unit_1
I0924 02:43:46.718933  2274 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.718940  2274 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.718945  2274 net.cpp:156] Memory required for data: 90020
I0924 02:43:46.718950  2274 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:43:46.718958  2274 net.cpp:91] Creating Layer lstm2_
I0924 02:43:46.718963  2274 net.cpp:425] lstm2_ <- c_1
I0924 02:43:46.718974  2274 net.cpp:399] lstm2_ -> c_T
I0924 02:43:46.719010  2274 net.cpp:141] Setting up lstm2_
I0924 02:43:46.719020  2274 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.719025  2274 net.cpp:156] Memory required for data: 94020
I0924 02:43:46.719030  2274 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0924 02:43:46.719039  2274 net.cpp:91] Creating Layer lstm2_h_concat
I0924 02:43:46.719044  2274 net.cpp:425] lstm2_h_concat <- h_1
I0924 02:43:46.719053  2274 net.cpp:399] lstm2_h_concat -> h
I0924 02:43:46.718617  2272 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0924 02:43:46.719136  2272 net.cpp:156] Memory required for data: 63788600
I0924 02:43:46.719147  2272 layer_factory.hpp:77] Creating layer conv5
I0924 02:43:46.719548  2272 net.cpp:91] Creating Layer conv5
I0924 02:43:46.719581  2272 net.cpp:425] conv5 <- conv4
I0924 02:43:46.719548  2274 net.cpp:141] Setting up lstm2_h_concat
I0924 02:43:46.719599  2274 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.719602  2272 net.cpp:399] conv5 -> conv5
I0924 02:43:46.719607  2274 net.cpp:156] Memory required for data: 98020
I0924 02:43:46.719616  2274 layer_factory.hpp:77] Creating layer h_pseudoloss
I0924 02:43:46.719656  2274 net.cpp:91] Creating Layer h_pseudoloss
I0924 02:43:46.719667  2274 net.cpp:425] h_pseudoloss <- h
I0924 02:43:46.719681  2274 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0924 02:43:46.719931  2274 net.cpp:141] Setting up h_pseudoloss
I0924 02:43:46.719952  2274 net.cpp:148] Top shape: (1)
I0924 02:43:46.719961  2274 net.cpp:151]     with loss weight 1
I0924 02:43:46.719987  2274 net.cpp:156] Memory required for data: 98024
I0924 02:43:46.719998  2274 net.cpp:217] h_pseudoloss needs backward computation.
I0924 02:43:46.720007  2274 net.cpp:217] lstm2_h_concat needs backward computation.
I0924 02:43:46.720016  2274 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:43:46.720026  2274 net.cpp:217] lstm2_unit_1 needs backward computation.
I0924 02:43:46.720535  2274 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0924 02:43:46.720574  2274 net.cpp:217] lstm2_transform_1 needs backward computation.
I0924 02:43:46.720587  2274 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0924 02:43:46.720595  2274 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0924 02:43:46.720604  2274 net.cpp:217] lstm2_x_transform needs backward computation.
I0924 02:43:46.720615  2274 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0924 02:43:46.720625  2274 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0924 02:43:46.720636  2274 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:43:46.720645  2274 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:43:46.720654  2274 net.cpp:261] This network produces output c_T
I0924 02:43:46.720664  2274 net.cpp:261] This network produces output h_pseudoloss
I0924 02:43:46.720687  2274 net.cpp:274] Network initialization done.
I0924 02:43:46.720820  2274 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0924 02:43:46.720834  2274 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0924 02:43:46.720844  2274 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0924 02:43:46.722070  2274 net.cpp:141] Setting up lstm2
I0924 02:43:46.722090  2274 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:43:46.722100  2274 net.cpp:156] Memory required for data: 36412
I0924 02:43:46.722126  2274 layer_factory.hpp:77] Creating layer predict
I0924 02:43:46.722144  2274 net.cpp:91] Creating Layer predict
I0924 02:43:46.722156  2274 net.cpp:425] predict <- lstm2
I0924 02:43:46.722168  2274 net.cpp:399] predict -> predict
I0924 02:43:46.809294  2292 net.cpp:141] Setting up predict
I0924 02:43:46.809357  2292 net.cpp:148] Top shape: 1 1 46168 (46168)
I0924 02:43:46.809367  2292 net.cpp:156] Memory required for data: 221084
I0924 02:43:46.809389  2292 layer_factory.hpp:77] Creating layer probs
I0924 02:43:46.809412  2292 net.cpp:91] Creating Layer probs
I0924 02:43:46.809422  2292 net.cpp:425] probs <- predict
I0924 02:43:46.809438  2292 net.cpp:399] probs -> probs
I0924 02:43:46.811964  2292 net.cpp:141] Setting up probs
I0924 02:43:46.812017  2292 net.cpp:148] Top shape: 1 1 46168 (46168)
I0924 02:43:46.812027  2292 net.cpp:156] Memory required for data: 405756
I0924 02:43:46.812041  2292 net.cpp:219] probs does not need backward computation.
I0924 02:43:46.812052  2292 net.cpp:219] predict does not need backward computation.
I0924 02:43:46.812062  2292 net.cpp:219] lstm2 does not need backward computation.
I0924 02:43:46.812072  2292 net.cpp:219] concat does not need backward computation.
I0924 02:43:46.812083  2292 net.cpp:219] lstm1 does not need backward computation.
I0924 02:43:46.812093  2292 net.cpp:219] embedding does not need backward computation.
I0924 02:43:46.812101  2292 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0924 02:43:46.812109  2292 net.cpp:219] reshape_frames does not need backward computation.
I0924 02:43:46.812119  2292 net.cpp:219] embed_encoder does not need backward computation.
I0924 02:43:46.812129  2292 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0924 02:43:46.812139  2292 net.cpp:219] input does not need backward computation.
I0924 02:43:46.812145  2292 net.cpp:261] This network produces output probs
I0924 02:43:46.812172  2292 net.cpp:274] Network initialization done.
I0924 02:43:46.819504  2272 net.cpp:141] Setting up conv5
I0924 02:43:46.820169  2272 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0924 02:43:46.820475  2272 net.cpp:156] Memory required for data: 65519160
I0924 02:43:46.820741  2272 layer_factory.hpp:77] Creating layer relu5
I0924 02:43:46.820994  2272 net.cpp:91] Creating Layer relu5
I0924 02:43:46.821308  2272 net.cpp:425] relu5 <- conv5
I0924 02:43:46.821583  2272 net.cpp:386] relu5 -> conv5 (in-place)
I0924 02:43:46.823371  2272 net.cpp:141] Setting up relu5
I0924 02:43:46.824012  2272 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0924 02:43:46.824332  2272 net.cpp:156] Memory required for data: 67249720
I0924 02:43:46.824564  2272 layer_factory.hpp:77] Creating layer pool5
I0924 02:43:46.824625  2272 net.cpp:91] Creating Layer pool5
I0924 02:43:46.824648  2272 net.cpp:425] pool5 <- conv5
I0924 02:43:46.824677  2272 net.cpp:399] pool5 -> pool5
I0924 02:43:46.825014  2272 net.cpp:141] Setting up pool5
I0924 02:43:46.825057  2272 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0924 02:43:46.825073  2272 net.cpp:156] Memory required for data: 67618360
I0924 02:43:46.825090  2272 layer_factory.hpp:77] Creating layer fc6
I0924 02:43:46.825122  2272 net.cpp:91] Creating Layer fc6
I0924 02:43:46.825139  2272 net.cpp:425] fc6 <- pool5
I0924 02:43:46.825170  2272 net.cpp:399] fc6 -> fc6
I0924 02:43:46.946796  2272 net.cpp:141] Setting up fc6
I0924 02:43:46.946856  2272 net.cpp:148] Top shape: 10 4096 (40960)
I0924 02:43:46.946867  2272 net.cpp:156] Memory required for data: 67782200
I0924 02:43:46.946892  2272 layer_factory.hpp:77] Creating layer relu6
I0924 02:43:46.946914  2272 net.cpp:91] Creating Layer relu6
I0924 02:43:46.946928  2272 net.cpp:425] relu6 <- fc6
I0924 02:43:46.946944  2272 net.cpp:386] relu6 -> fc6 (in-place)
I0924 02:43:46.947791  2272 net.cpp:141] Setting up relu6
I0924 02:43:46.947827  2272 net.cpp:148] Top shape: 10 4096 (40960)
I0924 02:43:46.947839  2272 net.cpp:156] Memory required for data: 67946040
I0924 02:43:46.947854  2272 layer_factory.hpp:77] Creating layer drop6
I0924 02:43:46.947890  2272 net.cpp:91] Creating Layer drop6
I0924 02:43:46.947903  2272 net.cpp:425] drop6 <- fc6
I0924 02:43:46.947924  2272 net.cpp:386] drop6 -> fc6 (in-place)
I0924 02:43:46.948056  2272 net.cpp:141] Setting up drop6
I0924 02:43:46.948076  2272 net.cpp:148] Top shape: 10 4096 (40960)
I0924 02:43:46.948086  2272 net.cpp:156] Memory required for data: 68109880
I0924 02:43:46.948097  2272 layer_factory.hpp:77] Creating layer fc7
I0924 02:43:46.948124  2272 net.cpp:91] Creating Layer fc7
I0924 02:43:46.948134  2272 net.cpp:425] fc7 <- fc6
I0924 02:43:46.948148  2272 net.cpp:399] fc7 -> fc7
I0924 02:43:47.007974  2286 net.cpp:141] Setting up predict
I0924 02:43:47.008038  2286 net.cpp:148] Top shape: 1 1 46168 (46168)
I0924 02:43:47.008049  2286 net.cpp:156] Memory required for data: 221084
I0924 02:43:47.008072  2286 layer_factory.hpp:77] Creating layer probs
I0924 02:43:47.008100  2286 net.cpp:91] Creating Layer probs
I0924 02:43:47.008111  2286 net.cpp:425] probs <- predict
I0924 02:43:47.008127  2286 net.cpp:399] probs -> probs
I0924 02:43:47.009003  2286 net.cpp:141] Setting up probs
I0924 02:43:47.009021  2286 net.cpp:148] Top shape: 1 1 46168 (46168)
I0924 02:43:47.009030  2286 net.cpp:156] Memory required for data: 405756
I0924 02:43:47.009039  2286 net.cpp:219] probs does not need backward computation.
I0924 02:43:47.009048  2286 net.cpp:219] predict does not need backward computation.
I0924 02:43:47.009057  2286 net.cpp:219] lstm2 does not need backward computation.
I0924 02:43:47.009065  2286 net.cpp:219] concat does not need backward computation.
I0924 02:43:47.009079  2286 net.cpp:219] lstm1 does not need backward computation.
I0924 02:43:47.009090  2286 net.cpp:219] embedding does not need backward computation.
I0924 02:43:47.009099  2286 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0924 02:43:47.009106  2286 net.cpp:219] reshape_frames does not need backward computation.
I0924 02:43:47.009115  2286 net.cpp:219] embed_encoder does not need backward computation.
I0924 02:43:47.009124  2286 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0924 02:43:47.009133  2286 net.cpp:219] input does not need backward computation.
I0924 02:43:47.009140  2286 net.cpp:261] This network produces output probs
I0924 02:43:47.009165  2286 net.cpp:274] Network initialization done.
I0924 02:43:47.013384  2272 net.cpp:141] Setting up fc7
I0924 02:43:47.013433  2272 net.cpp:148] Top shape: 10 4096 (40960)
I0924 02:43:47.013443  2272 net.cpp:156] Memory required for data: 68273720
I0924 02:43:47.013464  2272 layer_factory.hpp:77] Creating layer relu7
I0924 02:43:47.013490  2272 net.cpp:91] Creating Layer relu7
I0924 02:43:47.013501  2272 net.cpp:425] relu7 <- fc7
I0924 02:43:47.013515  2272 net.cpp:386] relu7 -> fc7 (in-place)
I0924 02:43:47.014343  2272 net.cpp:141] Setting up relu7
I0924 02:43:47.014364  2272 net.cpp:148] Top shape: 10 4096 (40960)
I0924 02:43:47.014374  2272 net.cpp:156] Memory required for data: 68437560
I0924 02:43:47.014384  2272 layer_factory.hpp:77] Creating layer drop7
I0924 02:43:47.014423  2272 net.cpp:91] Creating Layer drop7
I0924 02:43:47.014438  2272 net.cpp:425] drop7 <- fc7
I0924 02:43:47.014456  2272 net.cpp:386] drop7 -> fc7 (in-place)
I0924 02:43:47.014533  2272 net.cpp:141] Setting up drop7
I0924 02:43:47.014549  2272 net.cpp:148] Top shape: 10 4096 (40960)
I0924 02:43:47.014559  2272 net.cpp:156] Memory required for data: 68601400
I0924 02:43:47.014569  2272 layer_factory.hpp:77] Creating layer fc8
I0924 02:43:47.014585  2272 net.cpp:91] Creating Layer fc8
I0924 02:43:47.014611  2272 net.cpp:425] fc8 <- fc7
I0924 02:43:47.015072  2272 net.cpp:399] fc8 -> fc8
I0924 02:43:47.029578  2272 net.cpp:141] Setting up fc8
I0924 02:43:47.029666  2272 net.cpp:148] Top shape: 10 1000 (10000)
I0924 02:43:47.029681  2272 net.cpp:156] Memory required for data: 68641400
I0924 02:43:47.029708  2272 layer_factory.hpp:77] Creating layer prob
I0924 02:43:47.029736  2272 net.cpp:91] Creating Layer prob
I0924 02:43:47.029750  2272 net.cpp:425] prob <- fc8
I0924 02:43:47.029768  2272 net.cpp:399] prob -> prob
I0924 02:43:47.034124  2272 net.cpp:141] Setting up prob
I0924 02:43:47.034173  2272 net.cpp:148] Top shape: 10 1000 (10000)
I0924 02:43:47.034185  2272 net.cpp:156] Memory required for data: 68681400
I0924 02:43:47.034200  2272 net.cpp:219] prob does not need backward computation.
I0924 02:43:47.034214  2272 net.cpp:219] fc8 does not need backward computation.
I0924 02:43:47.034224  2272 net.cpp:219] drop7 does not need backward computation.
I0924 02:43:47.034234  2272 net.cpp:219] relu7 does not need backward computation.
I0924 02:43:47.034242  2272 net.cpp:219] fc7 does not need backward computation.
I0924 02:43:47.034252  2272 net.cpp:219] drop6 does not need backward computation.
I0924 02:43:47.034261  2272 net.cpp:219] relu6 does not need backward computation.
I0924 02:43:47.034271  2272 net.cpp:219] fc6 does not need backward computation.
I0924 02:43:47.034281  2272 net.cpp:219] pool5 does not need backward computation.
I0924 02:43:47.034291  2272 net.cpp:219] relu5 does not need backward computation.
I0924 02:43:47.034301  2272 net.cpp:219] conv5 does not need backward computation.
I0924 02:43:47.034310  2272 net.cpp:219] relu4 does not need backward computation.
I0924 02:43:47.034319  2272 net.cpp:219] conv4 does not need backward computation.
I0924 02:43:47.034329  2272 net.cpp:219] relu3 does not need backward computation.
I0924 02:43:47.034338  2272 net.cpp:219] conv3 does not need backward computation.
I0924 02:43:47.034348  2272 net.cpp:219] norm2 does not need backward computation.
I0924 02:43:47.034355  2272 net.cpp:219] pool2 does not need backward computation.
I0924 02:43:47.034365  2272 net.cpp:219] relu2 does not need backward computation.
I0924 02:43:47.034373  2272 net.cpp:219] conv2 does not need backward computation.
I0924 02:43:47.034381  2272 net.cpp:219] norm1 does not need backward computation.
I0924 02:43:47.034395  2272 net.cpp:219] pool1 does not need backward computation.
I0924 02:43:47.034404  2272 net.cpp:219] relu1 does not need backward computation.
I0924 02:43:47.034411  2272 net.cpp:219] conv1 does not need backward computation.
I0924 02:43:47.034420  2272 net.cpp:219] data does not need backward computation.
I0924 02:43:47.034426  2272 net.cpp:261] This network produces output prob
I0924 02:43:47.034607  2272 net.cpp:274] Network initialization done.
I0924 02:43:47.077205  2268 net.cpp:141] Setting up predict
I0924 02:43:47.077258  2268 net.cpp:148] Top shape: 1 1 46168 (46168)
I0924 02:43:47.077265  2268 net.cpp:156] Memory required for data: 221084
I0924 02:43:47.077282  2268 layer_factory.hpp:77] Creating layer probs
I0924 02:43:47.077304  2268 net.cpp:91] Creating Layer probs
I0924 02:43:47.077314  2268 net.cpp:425] probs <- predict
I0924 02:43:47.077325  2268 net.cpp:399] probs -> probs
I0924 02:43:47.077841  2268 net.cpp:141] Setting up probs
I0924 02:43:47.077853  2268 net.cpp:148] Top shape: 1 1 46168 (46168)
I0924 02:43:47.077858  2268 net.cpp:156] Memory required for data: 405756
I0924 02:43:47.077865  2268 net.cpp:219] probs does not need backward computation.
I0924 02:43:47.077872  2268 net.cpp:219] predict does not need backward computation.
I0924 02:43:47.077877  2268 net.cpp:219] lstm2 does not need backward computation.
I0924 02:43:47.077883  2268 net.cpp:219] concat does not need backward computation.
I0924 02:43:47.077890  2268 net.cpp:219] lstm1 does not need backward computation.
I0924 02:43:47.077898  2268 net.cpp:219] embedding does not need backward computation.
I0924 02:43:47.077903  2268 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0924 02:43:47.077909  2268 net.cpp:219] reshape_frames does not need backward computation.
I0924 02:43:47.077914  2268 net.cpp:219] embed_encoder does not need backward computation.
I0924 02:43:47.077920  2268 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0924 02:43:47.077926  2268 net.cpp:219] input does not need backward computation.
I0924 02:43:47.077930  2268 net.cpp:261] This network produces output probs
I0924 02:43:47.077950  2268 net.cpp:274] Network initialization done.
I0924 02:43:47.166673  2264 net.cpp:752] Ignoring source layer data
I0924 02:43:47.166712  2264 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0924 02:43:47.166718  2264 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0924 02:43:47.203418  2274 net.cpp:141] Setting up predict
I0924 02:43:47.203482  2274 net.cpp:148] Top shape: 1 1 46168 (46168)
I0924 02:43:47.203490  2274 net.cpp:156] Memory required for data: 221084
I0924 02:43:47.203508  2274 layer_factory.hpp:77] Creating layer probs
I0924 02:43:47.203534  2274 net.cpp:91] Creating Layer probs
I0924 02:43:47.203543  2274 net.cpp:425] probs <- predict
I0924 02:43:47.203554  2274 net.cpp:399] probs -> probs
I0924 02:43:47.205561  2274 net.cpp:141] Setting up probs
I0924 02:43:47.205615  2274 net.cpp:148] Top shape: 1 1 46168 (46168)
I0924 02:43:47.205623  2274 net.cpp:156] Memory required for data: 405756
I0924 02:43:47.205634  2274 net.cpp:219] probs does not need backward computation.
I0924 02:43:47.205643  2274 net.cpp:219] predict does not need backward computation.
I0924 02:43:47.205649  2274 net.cpp:219] lstm2 does not need backward computation.
I0924 02:43:47.205657  2274 net.cpp:219] concat does not need backward computation.
I0924 02:43:47.205663  2274 net.cpp:219] lstm1 does not need backward computation.
I0924 02:43:47.205670  2274 net.cpp:219] embedding does not need backward computation.
I0924 02:43:47.205677  2274 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0924 02:43:47.205682  2274 net.cpp:219] reshape_frames does not need backward computation.
I0924 02:43:47.205688  2274 net.cpp:219] embed_encoder does not need backward computation.
I0924 02:43:47.205693  2274 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0924 02:43:47.205699  2274 net.cpp:219] input does not need backward computation.
I0924 02:43:47.205703  2274 net.cpp:261] This network produces output probs
I0924 02:43:47.205745  2274 net.cpp:274] Network initialization done.
I0924 02:43:47.251528  2264 net.cpp:752] Ignoring source layer cross_entropy_loss
I0924 02:43:47.288689  2292 net.cpp:752] Ignoring source layer data
I0924 02:43:47.288735  2292 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0924 02:43:47.288743  2292 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0924 02:43:47.300150  2272 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /home/peifeng/work/run/storm102/data/workers/e62c82ba-7b76-4d9e-811a-f49d4e4bae2d/tmp/cvld4290061136186027110/bvlc_reference_caffenet.caffemodel
I0924 02:43:47.300199  2272 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0924 02:43:47.300206  2272 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0924 02:43:47.300210  2272 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /home/peifeng/work/run/storm102/data/workers/e62c82ba-7b76-4d9e-811a-f49d4e4bae2d/tmp/cvld4290061136186027110/bvlc_reference_caffenet.caffemodel
I0924 02:43:47.385058  2292 net.cpp:752] Ignoring source layer cross_entropy_loss
I0924 02:43:47.413403  2286 net.cpp:752] Ignoring source layer data
I0924 02:43:47.413826  2286 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0924 02:43:47.413841  2286 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0924 02:43:47.439404  2268 net.cpp:752] Ignoring source layer data
I0924 02:43:47.439443  2268 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0924 02:43:47.439450  2268 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0924 02:43:47.500571  2286 net.cpp:752] Ignoring source layer cross_entropy_loss
I0924 02:43:47.529594  2268 net.cpp:752] Ignoring source layer cross_entropy_loss
I0924 02:43:47.570538  2274 net.cpp:752] Ignoring source layer data
I0924 02:43:47.570580  2274 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0924 02:43:47.570588  2274 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0924 02:43:47.645992  2274 net.cpp:752] Ignoring source layer cross_entropy_loss
I0924 02:43:47.693099  2272 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0924 02:43:47.741245  2272 net.cpp:752] Ignoring source layer loss
Loading the model + trained: 30071.5ms
Using cv::Size and some other stuff: 0.317ms
Loading the mean file: 33941.6ms
TIMERTIMER 654396381
TIMERTIMER 694010545
TIMERTIMER 822478885
TIMERTIMER 391557286
TIMERTIMER 241828128
TIMERTIMER 466635084
TIMERTIMER 669949511
TIMERTIMER 597919651
TIMERTIMER 420565011
TIMERTIMER 203310060
TIMERTIMER 503565360
TIMERTIMER 447843441
TIMERTIMER 481562890
TIMERTIMER 358428619
TIMERTIMER 235053264
TIMERTIMER 229121273
TIMERTIMER 239740788
TIMERTIMER 238563583
TIMERTIMER 233987471
TIMERTIMER 240064209
TIMERTIMER 234503630
TIMERTIMER 237130628
TIMERTIMER 232389738
TIMERTIMER 211631256
TIMERTIMER 222339679
TIMERTIMER 214083819
TIMERTIMER 221192303
TIMERTIMER 241632163
TIMERTIMER 231512977
TIMERTIMER 225186089
TIMERTIMER 233919592
TIMERTIMER 226893577
TIMERTIMER 240572186
TIMERTIMER 237989887
TIMERTIMER 227358948
TIMERTIMER 220535199
TIMERTIMER 237360973
TIMERTIMER 230891435
TIMERTIMER 215248831
TIMERTIMER 230521139
TIMERTIMER 214265627
TIMERTIMER 221653348
TIMERTIMER 214167717
TIMERTIMER 212203222
TIMERTIMER 220386807
TIMERTIMER 225094257
TIMERTIMER 229316490
TIMERTIMER 208333800
TIMERTIMER 222026002
TIMERTIMER 218129404
TIMERTIMER 203849476
TIMERTIMER 195171074
TIMERTIMER 223069168
TIMERTIMER 209129086
TIMERTIMER 209683027
TIMERTIMER 237591711
TIMERTIMER 214961315
TIMERTIMER 202773809
TIMERTIMER 215488335
TIMERTIMER 218103725
TIMERTIMER 208314121
TIMERTIMER 201358359
TIMERTIMER 215128703
TIMERTIMER 207894937
TIMERTIMER 201363043
TIMERTIMER 201555268
TIMERTIMER 223081025
TIMERTIMER 227141219
TIMERTIMER 219283920
TIMERTIMER 221542758
TIMERTIMER 239634780
TIMERTIMER 223626048
TIMERTIMER 232847068
TIMERTIMER 243884726
TIMERTIMER 235514597
TIMERTIMER 233040257
TIMERTIMER 246894258
TIMERTIMER 248653937
TIMERTIMER 249649761
TIMERTIMER 249262355
TIMERTIMER 242714423
TIMERTIMER 226378615
TIMERTIMER 230997070
TIMERTIMER 237875919
TIMERTIMER 259989375
TIMERTIMER 242475693
TIMERTIMER 244070678
TIMERTIMER 241673677
TIMERTIMER 240988106
TIMERTIMER 243037273
TIMERTIMER 224942628
TIMERTIMER 227490736
TIMERTIMER 258352401
TIMERTIMER 243093551
TIMERTIMER 253872067
TIMERTIMER 245791676
TIMERTIMER 243157031
TIMERTIMER 249265244
TIMERTIMER 243665974
TIMERTIMER 247453502
TIMERTIMER 240978750
