SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/peifeng/tools/storm102/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/peifeng/work/run/storm102/data/supervisor/stormdist/captioning-1-1474700043/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /home/peifeng/work/run/storm102/data/workers/e39af7d8-dc04-4e7a-9b0a-ddc00aed7604/tmp/cvld8340936158615263543/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0924 02:54:48.910641  8329 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/e39af7d8-dc04-4e7a-9b0a-ddc00aed7604/tmp/cvld8340936158615263543/s2vt.words_to_preds.prototxt
I0924 02:54:48.910641  8333 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/e39af7d8-dc04-4e7a-9b0a-ddc00aed7604/tmp/cvld8340936158615263543/s2vt.words_to_preds.prototxt
I0924 02:54:48.910786  8329 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
I0924 02:54:48.910789  8333 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0924 02:54:48.910797  8329 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
W0924 02:54:48.910804  8333 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0924 02:54:48.911126  8329 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0924 02:54:48.911227  8333 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0924 02:54:48.911269  8329 layer_factory.hpp:77] Creating layer input
I0924 02:54:48.911295  8329 net.cpp:91] Creating Layer input
I0924 02:54:48.911306  8329 net.cpp:399] input -> frames_fc7
I0924 02:54:48.911327  8333 layer_factory.hpp:77] Creating layer input
I0924 02:54:48.911341  8333 net.cpp:91] Creating Layer input
I0924 02:54:48.911344  8329 net.cpp:399] input -> cont_sentence
I0924 02:54:48.911351  8333 net.cpp:399] input -> frames_fc7
I0924 02:54:48.911360  8329 net.cpp:399] input -> input_sentence
I0924 02:54:48.911366  8333 net.cpp:399] input -> cont_sentence
I0924 02:54:48.911371  8329 net.cpp:399] input -> stage_indicator
I0924 02:54:48.911379  8333 net.cpp:399] input -> input_sentence
I0924 02:54:48.911391  8333 net.cpp:399] input -> stage_indicator
I0924 02:54:49.464747  8333 net.cpp:141] Setting up input
I0924 02:54:49.464738  8329 net.cpp:141] Setting up input
I0924 02:54:49.464820  8333 net.cpp:148] Top shape: 1 4096 (4096)
I0924 02:54:49.464820  8329 net.cpp:148] Top shape: 1 4096 (4096)
I0924 02:54:49.464834  8333 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:49.464839  8329 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:49.464843  8333 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:49.464848  8329 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:49.464849  8333 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:49.464854  8329 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:49.464860  8329 net.cpp:156] Memory required for data: 16396
I0924 02:54:49.464859  8333 net.cpp:156] Memory required for data: 16396
I0924 02:54:49.464886  8329 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0924 02:54:49.464886  8333 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0924 02:54:49.464918  8329 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0924 02:54:49.464920  8333 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0924 02:54:49.464931  8329 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0924 02:54:49.464931  8333 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0924 02:54:49.464959  8329 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0924 02:54:49.464961  8333 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0924 02:54:49.464982  8329 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0924 02:54:49.464982  8333 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0924 02:54:49.465044  8329 net.cpp:141] Setting up cont_sentence_input_1_split
I0924 02:54:49.465055  8329 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:49.465062  8329 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:49.465068  8329 net.cpp:156] Memory required for data: 16404
I0924 02:54:49.465075  8329 layer_factory.hpp:77] Creating layer embed_encoder
I0924 02:54:49.465091  8333 net.cpp:141] Setting up cont_sentence_input_1_split
I0924 02:54:49.465095  8329 net.cpp:91] Creating Layer embed_encoder
I0924 02:54:49.465108  8333 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:49.465109  8329 net.cpp:425] embed_encoder <- frames_fc7
I0924 02:54:49.465119  8333 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:49.465126  8333 net.cpp:156] Memory required for data: 16404
I0924 02:54:49.465126  8329 net.cpp:399] embed_encoder -> embedded_in_frames
I0924 02:54:49.465132  8333 layer_factory.hpp:77] Creating layer embed_encoder
I0924 02:54:49.465147  8333 net.cpp:91] Creating Layer embed_encoder
I0924 02:54:49.465153  8333 net.cpp:425] embed_encoder <- frames_fc7
I0924 02:54:49.465163  8333 net.cpp:399] embed_encoder -> embedded_in_frames
I0924 02:54:49.491798  8329 net.cpp:141] Setting up embed_encoder
I0924 02:54:49.491842  8329 net.cpp:148] Top shape: 1 500 (500)
I0924 02:54:49.491849  8329 net.cpp:156] Memory required for data: 18404
I0924 02:54:49.491881  8329 layer_factory.hpp:77] Creating layer reshape_frames
I0924 02:54:49.491909  8329 net.cpp:91] Creating Layer reshape_frames
I0924 02:54:49.491917  8329 net.cpp:425] reshape_frames <- embedded_in_frames
I0924 02:54:49.491928  8329 net.cpp:399] reshape_frames -> embedded_input_frames
I0924 02:54:49.492012  8329 net.cpp:141] Setting up reshape_frames
I0924 02:54:49.492024  8329 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:54:49.492029  8329 net.cpp:156] Memory required for data: 20404
I0924 02:54:49.492035  8329 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0924 02:54:49.492050  8329 net.cpp:91] Creating Layer reshape_stage_indicator
I0924 02:54:49.492056  8329 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0924 02:54:49.492065  8329 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0924 02:54:49.492070  8333 net.cpp:141] Setting up embed_encoder
I0924 02:54:49.492089  8333 net.cpp:148] Top shape: 1 500 (500)
I0924 02:54:49.492095  8333 net.cpp:156] Memory required for data: 18404
I0924 02:54:49.492111  8333 layer_factory.hpp:77] Creating layer reshape_frames
I0924 02:54:49.492111  8329 net.cpp:141] Setting up reshape_stage_indicator
I0924 02:54:49.492123  8329 net.cpp:148] Top shape: 1 1 1 (1)
I0924 02:54:49.492126  8333 net.cpp:91] Creating Layer reshape_frames
I0924 02:54:49.492130  8329 net.cpp:156] Memory required for data: 20408
I0924 02:54:49.492135  8333 net.cpp:425] reshape_frames <- embedded_in_frames
I0924 02:54:49.492136  8329 layer_factory.hpp:77] Creating layer embedding
I0924 02:54:49.492151  8333 net.cpp:399] reshape_frames -> embedded_input_frames
I0924 02:54:49.492161  8329 net.cpp:91] Creating Layer embedding
I0924 02:54:49.492167  8329 net.cpp:425] embedding <- input_sentence
I0924 02:54:49.492179  8329 net.cpp:399] embedding -> embedded_input_sentence
I0924 02:54:49.492192  8333 net.cpp:141] Setting up reshape_frames
I0924 02:54:49.492202  8333 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:54:49.492208  8333 net.cpp:156] Memory required for data: 20404
I0924 02:54:49.492213  8333 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0924 02:54:49.492223  8333 net.cpp:91] Creating Layer reshape_stage_indicator
I0924 02:54:49.492229  8333 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0924 02:54:49.492260  8333 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0924 02:54:49.538904  8333 net.cpp:141] Setting up reshape_stage_indicator
I0924 02:54:49.538949  8333 net.cpp:148] Top shape: 1 1 1 (1)
I0924 02:54:49.538955  8333 net.cpp:156] Memory required for data: 20408
I0924 02:54:49.538964  8333 layer_factory.hpp:77] Creating layer embedding
I0924 02:54:49.538983  8333 net.cpp:91] Creating Layer embedding
I0924 02:54:49.538991  8333 net.cpp:425] embedding <- input_sentence
I0924 02:54:49.539008  8333 net.cpp:399] embedding -> embedded_input_sentence
I0924 02:54:49.744019  8329 net.cpp:141] Setting up embedding
I0924 02:54:49.744065  8329 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:54:49.744071  8329 net.cpp:156] Memory required for data: 22408
I0924 02:54:49.744089  8329 layer_factory.hpp:77] Creating layer lstm1
I0924 02:54:49.744109  8329 net.cpp:91] Creating Layer lstm1
I0924 02:54:49.744118  8329 net.cpp:425] lstm1 <- embedded_input_frames
I0924 02:54:49.744127  8329 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0924 02:54:49.744138  8329 net.cpp:399] lstm1 -> lstm1
I0924 02:54:49.744174  8329 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0924 02:54:49.744571  8329 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0924 02:54:49.744679  8329 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:54:49.744694  8329 net.cpp:91] Creating Layer lstm1_
I0924 02:54:49.744701  8329 net.cpp:399] lstm1_ -> x
I0924 02:54:49.744715  8329 net.cpp:399] lstm1_ -> cont
I0924 02:54:49.744776  8329 net.cpp:141] Setting up lstm1_
I0924 02:54:49.744786  8329 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:54:49.744794  8329 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:49.744799  8329 net.cpp:156] Memory required for data: 2004
I0924 02:54:49.744806  8329 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:54:49.744818  8329 net.cpp:91] Creating Layer lstm1_
I0924 02:54:49.744825  8329 net.cpp:399] lstm1_ -> c_0
I0924 02:54:49.744837  8329 net.cpp:399] lstm1_ -> h_0
I0924 02:54:49.744889  8329 net.cpp:141] Setting up lstm1_
I0924 02:54:49.744900  8329 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:49.744907  8329 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:49.744912  8329 net.cpp:156] Memory required for data: 10004
I0924 02:54:49.744917  8329 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0924 02:54:49.744927  8329 net.cpp:91] Creating Layer lstm1_cont_slice
I0924 02:54:49.744932  8329 net.cpp:425] lstm1_cont_slice <- cont
I0924 02:54:49.744945  8329 net.cpp:399] lstm1_cont_slice -> cont_1
I0924 02:54:49.744982  8329 net.cpp:141] Setting up lstm1_cont_slice
I0924 02:54:49.744992  8329 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:49.745000  8329 net.cpp:156] Memory required for data: 10008
I0924 02:54:49.745009  8329 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0924 02:54:49.745024  8329 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0924 02:54:49.745034  8329 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0924 02:54:49.745048  8329 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0924 02:54:49.745059  8329 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0924 02:54:49.745115  8329 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0924 02:54:49.745126  8329 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:49.745132  8329 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:49.745137  8329 net.cpp:156] Memory required for data: 10016
I0924 02:54:49.745143  8329 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0924 02:54:49.745158  8329 net.cpp:91] Creating Layer lstm1_x_transform
I0924 02:54:49.745164  8329 net.cpp:425] lstm1_x_transform <- x
I0924 02:54:49.745173  8329 net.cpp:399] lstm1_x_transform -> W_xc_x
I0924 02:54:49.767069  8329 net.cpp:141] Setting up lstm1_x_transform
I0924 02:54:49.767087  8329 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:49.767093  8329 net.cpp:156] Memory required for data: 26016
I0924 02:54:49.767107  8329 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0924 02:54:49.767117  8329 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0924 02:54:49.767122  8329 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0924 02:54:49.767130  8329 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0924 02:54:49.767166  8329 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0924 02:54:49.767176  8329 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:49.767181  8329 net.cpp:156] Memory required for data: 42016
I0924 02:54:49.767187  8329 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0924 02:54:49.767208  8329 net.cpp:91] Creating Layer lstm1_h_conted_0
I0924 02:54:49.767215  8329 net.cpp:425] lstm1_h_conted_0 <- h_0
I0924 02:54:49.767221  8329 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0924 02:54:49.767230  8329 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0924 02:54:49.767319  8329 net.cpp:141] Setting up lstm1_h_conted_0
I0924 02:54:49.767330  8329 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:49.767336  8329 net.cpp:156] Memory required for data: 46016
I0924 02:54:49.767341  8329 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0924 02:54:49.767351  8329 net.cpp:91] Creating Layer lstm1_transform_1
I0924 02:54:49.767357  8329 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0924 02:54:49.767365  8329 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0924 02:54:49.807528  8333 net.cpp:141] Setting up embedding
I0924 02:54:49.807586  8333 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:54:49.807593  8333 net.cpp:156] Memory required for data: 22408
I0924 02:54:49.807615  8333 layer_factory.hpp:77] Creating layer lstm1
I0924 02:54:49.807641  8333 net.cpp:91] Creating Layer lstm1
I0924 02:54:49.807649  8333 net.cpp:425] lstm1 <- embedded_input_frames
I0924 02:54:49.807659  8333 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0924 02:54:49.807672  8333 net.cpp:399] lstm1 -> lstm1
I0924 02:54:49.807693  8333 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0924 02:54:49.808043  8333 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0924 02:54:49.808154  8333 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:54:49.808171  8333 net.cpp:91] Creating Layer lstm1_
I0924 02:54:49.808177  8333 net.cpp:399] lstm1_ -> x
I0924 02:54:49.808192  8333 net.cpp:399] lstm1_ -> cont
I0924 02:54:49.808255  8333 net.cpp:141] Setting up lstm1_
I0924 02:54:49.808266  8333 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:54:49.808274  8333 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:49.808279  8333 net.cpp:156] Memory required for data: 2004
I0924 02:54:49.808284  8333 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:54:49.808293  8333 net.cpp:91] Creating Layer lstm1_
I0924 02:54:49.808305  8333 net.cpp:399] lstm1_ -> c_0
I0924 02:54:49.808315  8333 net.cpp:399] lstm1_ -> h_0
I0924 02:54:49.808367  8333 net.cpp:141] Setting up lstm1_
I0924 02:54:49.808377  8333 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:49.808383  8333 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:49.808388  8333 net.cpp:156] Memory required for data: 10004
I0924 02:54:49.808393  8333 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0924 02:54:49.808403  8333 net.cpp:91] Creating Layer lstm1_cont_slice
I0924 02:54:49.808409  8333 net.cpp:425] lstm1_cont_slice <- cont
I0924 02:54:49.808420  8333 net.cpp:399] lstm1_cont_slice -> cont_1
I0924 02:54:49.808455  8333 net.cpp:141] Setting up lstm1_cont_slice
I0924 02:54:49.808465  8333 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:49.808470  8333 net.cpp:156] Memory required for data: 10008
I0924 02:54:49.808475  8333 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0924 02:54:49.808487  8333 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0924 02:54:49.808493  8333 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0924 02:54:49.808501  8333 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0924 02:54:49.808511  8333 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0924 02:54:49.808562  8333 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0924 02:54:49.808571  8333 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:49.808578  8333 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:49.808583  8333 net.cpp:156] Memory required for data: 10016
I0924 02:54:49.808588  8333 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0924 02:54:49.808599  8333 net.cpp:91] Creating Layer lstm1_x_transform
I0924 02:54:49.808605  8333 net.cpp:425] lstm1_x_transform <- x
I0924 02:54:49.808614  8333 net.cpp:399] lstm1_x_transform -> W_xc_x
I0924 02:54:49.813107  8329 net.cpp:141] Setting up lstm1_transform_1
I0924 02:54:49.813148  8329 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:49.813154  8329 net.cpp:156] Memory required for data: 62016
I0924 02:54:49.813174  8329 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0924 02:54:49.813196  8329 net.cpp:91] Creating Layer lstm1_gate_input_1
I0924 02:54:49.813205  8329 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0924 02:54:49.813213  8329 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0924 02:54:49.813222  8329 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0924 02:54:49.813283  8329 net.cpp:141] Setting up lstm1_gate_input_1
I0924 02:54:49.813294  8329 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:49.813300  8329 net.cpp:156] Memory required for data: 78016
I0924 02:54:49.813305  8329 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0924 02:54:49.813326  8329 net.cpp:91] Creating Layer lstm1_unit_1
I0924 02:54:49.813333  8329 net.cpp:425] lstm1_unit_1 <- c_0
I0924 02:54:49.813339  8329 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0924 02:54:49.813345  8329 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0924 02:54:49.813356  8329 net.cpp:399] lstm1_unit_1 -> c_1
I0924 02:54:49.813366  8329 net.cpp:399] lstm1_unit_1 -> h_1
I0924 02:54:49.813433  8329 net.cpp:141] Setting up lstm1_unit_1
I0924 02:54:49.813444  8329 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:49.813452  8329 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:49.813457  8329 net.cpp:156] Memory required for data: 86016
I0924 02:54:49.813462  8329 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:54:49.813475  8329 net.cpp:91] Creating Layer lstm1_
I0924 02:54:49.813482  8329 net.cpp:425] lstm1_ <- c_1
I0924 02:54:49.813489  8329 net.cpp:399] lstm1_ -> c_T
I0924 02:54:49.813519  8329 net.cpp:141] Setting up lstm1_
I0924 02:54:49.813529  8329 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:49.813534  8329 net.cpp:156] Memory required for data: 90016
I0924 02:54:49.813539  8329 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0924 02:54:49.813549  8329 net.cpp:91] Creating Layer lstm1_h_concat
I0924 02:54:49.813555  8329 net.cpp:425] lstm1_h_concat <- h_1
I0924 02:54:49.813567  8329 net.cpp:399] lstm1_h_concat -> h
I0924 02:54:49.813612  8329 net.cpp:141] Setting up lstm1_h_concat
I0924 02:54:49.813622  8329 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:49.813627  8329 net.cpp:156] Memory required for data: 94016
I0924 02:54:49.813633  8329 layer_factory.hpp:77] Creating layer h_pseudoloss
I0924 02:54:49.813648  8329 net.cpp:91] Creating Layer h_pseudoloss
I0924 02:54:49.813653  8329 net.cpp:425] h_pseudoloss <- h
I0924 02:54:49.813662  8329 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0924 02:54:49.813755  8329 net.cpp:141] Setting up h_pseudoloss
I0924 02:54:49.813767  8329 net.cpp:148] Top shape: (1)
I0924 02:54:49.813772  8329 net.cpp:151]     with loss weight 1
I0924 02:54:49.813812  8329 net.cpp:156] Memory required for data: 94020
I0924 02:54:49.813818  8329 net.cpp:217] h_pseudoloss needs backward computation.
I0924 02:54:49.813824  8329 net.cpp:217] lstm1_h_concat needs backward computation.
I0924 02:54:49.813829  8329 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:54:49.813835  8329 net.cpp:217] lstm1_unit_1 needs backward computation.
I0924 02:54:49.813843  8329 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0924 02:54:49.813849  8329 net.cpp:217] lstm1_transform_1 needs backward computation.
I0924 02:54:49.813855  8329 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0924 02:54:49.813865  8329 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0924 02:54:49.813871  8329 net.cpp:217] lstm1_x_transform needs backward computation.
I0924 02:54:49.813877  8329 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0924 02:54:49.813884  8329 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0924 02:54:49.813890  8329 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:54:49.813895  8329 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:54:49.813900  8329 net.cpp:261] This network produces output c_T
I0924 02:54:49.813905  8329 net.cpp:261] This network produces output h_pseudoloss
I0924 02:54:49.813925  8329 net.cpp:274] Network initialization done.
I0924 02:54:49.813987  8329 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0924 02:54:49.813994  8329 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0924 02:54:49.814000  8329 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0924 02:54:49.814129  8329 net.cpp:141] Setting up lstm1
I0924 02:54:49.814144  8329 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:49.814151  8329 net.cpp:156] Memory required for data: 26408
I0924 02:54:49.814167  8329 layer_factory.hpp:77] Creating layer concat
I0924 02:54:49.814177  8329 net.cpp:91] Creating Layer concat
I0924 02:54:49.814183  8329 net.cpp:425] concat <- lstm1
I0924 02:54:49.814191  8329 net.cpp:425] concat <- embedded_input_sentence
I0924 02:54:49.814198  8329 net.cpp:425] concat <- reshaped_stage_indicator
I0924 02:54:49.814205  8329 net.cpp:399] concat -> lstm1_video_sequence
I0924 02:54:49.814239  8329 net.cpp:141] Setting up concat
I0924 02:54:49.814249  8329 net.cpp:148] Top shape: 1 1 1501 (1501)
I0924 02:54:49.814254  8329 net.cpp:156] Memory required for data: 32412
I0924 02:54:49.814260  8329 layer_factory.hpp:77] Creating layer lstm2
I0924 02:54:49.814272  8329 net.cpp:91] Creating Layer lstm2
I0924 02:54:49.814280  8329 net.cpp:425] lstm2 <- lstm1_video_sequence
I0924 02:54:49.814286  8329 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0924 02:54:49.814294  8329 net.cpp:399] lstm2 -> lstm2
I0924 02:54:49.814306  8329 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0924 02:54:49.814576  8329 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0924 02:54:49.814687  8329 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:54:49.814702  8329 net.cpp:91] Creating Layer lstm2_
I0924 02:54:49.814709  8329 net.cpp:399] lstm2_ -> x
I0924 02:54:49.814723  8329 net.cpp:399] lstm2_ -> cont
I0924 02:54:49.814784  8329 net.cpp:141] Setting up lstm2_
I0924 02:54:49.814795  8329 net.cpp:148] Top shape: 1 1 1501 (1501)
I0924 02:54:49.814801  8329 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:49.814807  8329 net.cpp:156] Memory required for data: 6008
I0924 02:54:49.814812  8329 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:54:49.814822  8329 net.cpp:91] Creating Layer lstm2_
I0924 02:54:49.814834  8329 net.cpp:399] lstm2_ -> c_0
I0924 02:54:49.814846  8329 net.cpp:399] lstm2_ -> h_0
I0924 02:54:49.814898  8329 net.cpp:141] Setting up lstm2_
I0924 02:54:49.814909  8329 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:49.814915  8329 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:49.814920  8329 net.cpp:156] Memory required for data: 14008
I0924 02:54:49.814926  8329 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0924 02:54:49.814936  8329 net.cpp:91] Creating Layer lstm2_cont_slice
I0924 02:54:49.814941  8329 net.cpp:425] lstm2_cont_slice <- cont
I0924 02:54:49.814950  8329 net.cpp:399] lstm2_cont_slice -> cont_1
I0924 02:54:49.814991  8329 net.cpp:141] Setting up lstm2_cont_slice
I0924 02:54:49.815002  8329 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:49.815007  8329 net.cpp:156] Memory required for data: 14012
I0924 02:54:49.815013  8329 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0924 02:54:49.815023  8329 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0924 02:54:49.815029  8329 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0924 02:54:49.815037  8329 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0924 02:54:49.815047  8329 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0924 02:54:49.815104  8329 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0924 02:54:49.815120  8329 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:49.815134  8329 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:49.815143  8329 net.cpp:156] Memory required for data: 14020
I0924 02:54:49.815150  8329 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0924 02:54:49.815166  8329 net.cpp:91] Creating Layer lstm2_x_transform
I0924 02:54:49.815173  8329 net.cpp:425] lstm2_x_transform <- x
I0924 02:54:49.815182  8329 net.cpp:399] lstm2_x_transform -> W_xc_x
I0924 02:54:49.829771  8333 net.cpp:141] Setting up lstm1_x_transform
I0924 02:54:49.829792  8333 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:49.829798  8333 net.cpp:156] Memory required for data: 26016
I0924 02:54:49.829813  8333 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0924 02:54:49.829823  8333 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0924 02:54:49.829828  8333 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0924 02:54:49.829836  8333 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0924 02:54:49.829876  8333 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0924 02:54:49.829887  8333 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:49.829893  8333 net.cpp:156] Memory required for data: 42016
I0924 02:54:49.829898  8333 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0924 02:54:49.829908  8333 net.cpp:91] Creating Layer lstm1_h_conted_0
I0924 02:54:49.829915  8333 net.cpp:425] lstm1_h_conted_0 <- h_0
I0924 02:54:49.829921  8333 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0924 02:54:49.829928  8333 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0924 02:54:49.830021  8333 net.cpp:141] Setting up lstm1_h_conted_0
I0924 02:54:49.830032  8333 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:49.830037  8333 net.cpp:156] Memory required for data: 46016
I0924 02:54:49.830042  8333 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0924 02:54:49.830052  8333 net.cpp:91] Creating Layer lstm1_transform_1
I0924 02:54:49.830059  8333 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0924 02:54:49.830067  8333 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0924 02:54:49.872413  8333 net.cpp:141] Setting up lstm1_transform_1
I0924 02:54:49.872462  8333 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:49.872468  8333 net.cpp:156] Memory required for data: 62016
I0924 02:54:49.872491  8333 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0924 02:54:49.872519  8333 net.cpp:91] Creating Layer lstm1_gate_input_1
I0924 02:54:49.872529  8333 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0924 02:54:49.872539  8333 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0924 02:54:49.872547  8333 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0924 02:54:49.872601  8333 net.cpp:141] Setting up lstm1_gate_input_1
I0924 02:54:49.872611  8333 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:49.872615  8333 net.cpp:156] Memory required for data: 78016
I0924 02:54:49.872622  8333 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0924 02:54:49.872632  8333 net.cpp:91] Creating Layer lstm1_unit_1
I0924 02:54:49.872638  8333 net.cpp:425] lstm1_unit_1 <- c_0
I0924 02:54:49.872644  8333 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0924 02:54:49.872651  8333 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0924 02:54:49.872658  8333 net.cpp:399] lstm1_unit_1 -> c_1
I0924 02:54:49.872668  8333 net.cpp:399] lstm1_unit_1 -> h_1
I0924 02:54:49.872736  8333 net.cpp:141] Setting up lstm1_unit_1
I0924 02:54:49.872746  8333 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:49.872753  8333 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:49.872758  8333 net.cpp:156] Memory required for data: 86016
I0924 02:54:49.872763  8333 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:54:49.872776  8333 net.cpp:91] Creating Layer lstm1_
I0924 02:54:49.872782  8333 net.cpp:425] lstm1_ <- c_1
I0924 02:54:49.872791  8333 net.cpp:399] lstm1_ -> c_T
I0924 02:54:49.872823  8333 net.cpp:141] Setting up lstm1_
I0924 02:54:49.872833  8333 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:49.872838  8333 net.cpp:156] Memory required for data: 90016
I0924 02:54:49.872843  8333 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0924 02:54:49.872854  8333 net.cpp:91] Creating Layer lstm1_h_concat
I0924 02:54:49.872860  8333 net.cpp:425] lstm1_h_concat <- h_1
I0924 02:54:49.872871  8333 net.cpp:399] lstm1_h_concat -> h
I0924 02:54:49.872910  8333 net.cpp:141] Setting up lstm1_h_concat
I0924 02:54:49.872920  8333 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:49.872925  8333 net.cpp:156] Memory required for data: 94016
I0924 02:54:49.872931  8333 layer_factory.hpp:77] Creating layer h_pseudoloss
I0924 02:54:49.872941  8333 net.cpp:91] Creating Layer h_pseudoloss
I0924 02:54:49.872946  8333 net.cpp:425] h_pseudoloss <- h
I0924 02:54:49.872953  8333 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0924 02:54:49.873044  8333 net.cpp:141] Setting up h_pseudoloss
I0924 02:54:49.873054  8333 net.cpp:148] Top shape: (1)
I0924 02:54:49.873059  8333 net.cpp:151]     with loss weight 1
I0924 02:54:49.873080  8333 net.cpp:156] Memory required for data: 94020
I0924 02:54:49.873086  8333 net.cpp:217] h_pseudoloss needs backward computation.
I0924 02:54:49.873092  8333 net.cpp:217] lstm1_h_concat needs backward computation.
I0924 02:54:49.873097  8333 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:54:49.873103  8333 net.cpp:217] lstm1_unit_1 needs backward computation.
I0924 02:54:49.873111  8333 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0924 02:54:49.873116  8333 net.cpp:217] lstm1_transform_1 needs backward computation.
I0924 02:54:49.873122  8333 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0924 02:54:49.873132  8333 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0924 02:54:49.873138  8333 net.cpp:217] lstm1_x_transform needs backward computation.
I0924 02:54:49.873144  8333 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0924 02:54:49.873152  8333 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0924 02:54:49.873157  8333 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:54:49.873162  8333 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:54:49.873167  8333 net.cpp:261] This network produces output c_T
I0924 02:54:49.873172  8333 net.cpp:261] This network produces output h_pseudoloss
I0924 02:54:49.873189  8333 net.cpp:274] Network initialization done.
I0924 02:54:49.873248  8333 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0924 02:54:49.873256  8333 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0924 02:54:49.873261  8333 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0924 02:54:49.873368  8333 net.cpp:141] Setting up lstm1
I0924 02:54:49.873381  8333 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:49.873386  8333 net.cpp:156] Memory required for data: 26408
I0924 02:54:49.873402  8333 layer_factory.hpp:77] Creating layer concat
I0924 02:54:49.873412  8333 net.cpp:91] Creating Layer concat
I0924 02:54:49.873420  8333 net.cpp:425] concat <- lstm1
I0924 02:54:49.873428  8333 net.cpp:425] concat <- embedded_input_sentence
I0924 02:54:49.873435  8333 net.cpp:425] concat <- reshaped_stage_indicator
I0924 02:54:49.873442  8333 net.cpp:399] concat -> lstm1_video_sequence
I0924 02:54:49.873477  8333 net.cpp:141] Setting up concat
I0924 02:54:49.873486  8333 net.cpp:148] Top shape: 1 1 1501 (1501)
I0924 02:54:49.873492  8333 net.cpp:156] Memory required for data: 32412
I0924 02:54:49.873497  8333 layer_factory.hpp:77] Creating layer lstm2
I0924 02:54:49.873512  8333 net.cpp:91] Creating Layer lstm2
I0924 02:54:49.873518  8333 net.cpp:425] lstm2 <- lstm1_video_sequence
I0924 02:54:49.873525  8333 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0924 02:54:49.873533  8333 net.cpp:399] lstm2 -> lstm2
I0924 02:54:49.873546  8333 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0924 02:54:49.873838  8333 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0924 02:54:49.873939  8333 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:54:49.873952  8333 net.cpp:91] Creating Layer lstm2_
I0924 02:54:49.873960  8333 net.cpp:399] lstm2_ -> x
I0924 02:54:49.873971  8333 net.cpp:399] lstm2_ -> cont
I0924 02:54:49.874032  8333 net.cpp:141] Setting up lstm2_
I0924 02:54:49.874042  8333 net.cpp:148] Top shape: 1 1 1501 (1501)
I0924 02:54:49.874049  8333 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:49.874054  8333 net.cpp:156] Memory required for data: 6008
I0924 02:54:49.874059  8333 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:54:49.874069  8333 net.cpp:91] Creating Layer lstm2_
I0924 02:54:49.874081  8333 net.cpp:399] lstm2_ -> c_0
I0924 02:54:49.874092  8333 net.cpp:399] lstm2_ -> h_0
I0924 02:54:49.874143  8333 net.cpp:141] Setting up lstm2_
I0924 02:54:49.874153  8333 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:49.874161  8333 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:49.874166  8333 net.cpp:156] Memory required for data: 14008
I0924 02:54:49.874171  8333 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0924 02:54:49.874179  8333 net.cpp:91] Creating Layer lstm2_cont_slice
I0924 02:54:49.874186  8333 net.cpp:425] lstm2_cont_slice <- cont
I0924 02:54:49.874193  8333 net.cpp:399] lstm2_cont_slice -> cont_1
I0924 02:54:49.874229  8333 net.cpp:141] Setting up lstm2_cont_slice
I0924 02:54:49.874239  8333 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:49.874244  8333 net.cpp:156] Memory required for data: 14012
I0924 02:54:49.874250  8333 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0924 02:54:49.874260  8333 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0924 02:54:49.874266  8333 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0924 02:54:49.874274  8333 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0924 02:54:49.874285  8333 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0924 02:54:49.874333  8333 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0924 02:54:49.874342  8333 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:49.874349  8333 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:49.874354  8333 net.cpp:156] Memory required for data: 14020
I0924 02:54:49.874359  8333 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0924 02:54:49.874373  8333 net.cpp:91] Creating Layer lstm2_x_transform
I0924 02:54:49.874378  8333 net.cpp:425] lstm2_x_transform <- x
I0924 02:54:49.874387  8333 net.cpp:399] lstm2_x_transform -> W_xc_x
I0924 02:54:49.886641  8329 net.cpp:141] Setting up lstm2_x_transform
I0924 02:54:49.886689  8329 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:49.886696  8329 net.cpp:156] Memory required for data: 30020
I0924 02:54:49.886718  8329 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0924 02:54:49.886734  8329 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0924 02:54:49.886742  8329 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0924 02:54:49.886759  8329 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0924 02:54:49.886803  8329 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0924 02:54:49.886814  8329 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:49.886821  8329 net.cpp:156] Memory required for data: 46020
I0924 02:54:49.886826  8329 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0924 02:54:49.886837  8329 net.cpp:91] Creating Layer lstm2_h_conted_0
I0924 02:54:49.886843  8329 net.cpp:425] lstm2_h_conted_0 <- h_0
I0924 02:54:49.886850  8329 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0924 02:54:49.886863  8329 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0924 02:54:49.886960  8329 net.cpp:141] Setting up lstm2_h_conted_0
I0924 02:54:49.886971  8329 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:49.886977  8329 net.cpp:156] Memory required for data: 50020
I0924 02:54:49.886982  8329 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0924 02:54:49.886996  8329 net.cpp:91] Creating Layer lstm2_transform_1
I0924 02:54:49.887001  8329 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0924 02:54:49.887015  8329 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0924 02:54:49.930299  8329 net.cpp:141] Setting up lstm2_transform_1
I0924 02:54:49.930347  8329 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:49.930354  8329 net.cpp:156] Memory required for data: 66020
I0924 02:54:49.930373  8329 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0924 02:54:49.930397  8329 net.cpp:91] Creating Layer lstm2_gate_input_1
I0924 02:54:49.930405  8329 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0924 02:54:49.930413  8329 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0924 02:54:49.930423  8329 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0924 02:54:49.930474  8329 net.cpp:141] Setting up lstm2_gate_input_1
I0924 02:54:49.930485  8329 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:49.930490  8329 net.cpp:156] Memory required for data: 82020
I0924 02:54:49.930495  8329 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0924 02:54:49.930505  8329 net.cpp:91] Creating Layer lstm2_unit_1
I0924 02:54:49.930511  8329 net.cpp:425] lstm2_unit_1 <- c_0
I0924 02:54:49.930517  8329 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0924 02:54:49.930523  8329 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0924 02:54:49.930539  8329 net.cpp:399] lstm2_unit_1 -> c_1
I0924 02:54:49.930558  8329 net.cpp:399] lstm2_unit_1 -> h_1
I0924 02:54:49.930642  8329 net.cpp:141] Setting up lstm2_unit_1
I0924 02:54:49.930655  8329 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:49.930662  8329 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:49.930668  8329 net.cpp:156] Memory required for data: 90020
I0924 02:54:49.930673  8329 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:54:49.930683  8329 net.cpp:91] Creating Layer lstm2_
I0924 02:54:49.930691  8329 net.cpp:425] lstm2_ <- c_1
I0924 02:54:49.930698  8329 net.cpp:399] lstm2_ -> c_T
I0924 02:54:49.930737  8329 net.cpp:141] Setting up lstm2_
I0924 02:54:49.930747  8329 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:49.930752  8329 net.cpp:156] Memory required for data: 94020
I0924 02:54:49.930757  8329 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0924 02:54:49.930768  8329 net.cpp:91] Creating Layer lstm2_h_concat
I0924 02:54:49.930773  8329 net.cpp:425] lstm2_h_concat <- h_1
I0924 02:54:49.930781  8329 net.cpp:399] lstm2_h_concat -> h
I0924 02:54:49.930821  8329 net.cpp:141] Setting up lstm2_h_concat
I0924 02:54:49.930831  8329 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:49.930836  8329 net.cpp:156] Memory required for data: 98020
I0924 02:54:49.930841  8329 layer_factory.hpp:77] Creating layer h_pseudoloss
I0924 02:54:49.930852  8329 net.cpp:91] Creating Layer h_pseudoloss
I0924 02:54:49.930857  8329 net.cpp:425] h_pseudoloss <- h
I0924 02:54:49.930866  8329 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0924 02:54:49.930958  8329 net.cpp:141] Setting up h_pseudoloss
I0924 02:54:49.930968  8329 net.cpp:148] Top shape: (1)
I0924 02:54:49.930974  8329 net.cpp:151]     with loss weight 1
I0924 02:54:49.930997  8329 net.cpp:156] Memory required for data: 98024
I0924 02:54:49.931004  8329 net.cpp:217] h_pseudoloss needs backward computation.
I0924 02:54:49.931008  8329 net.cpp:217] lstm2_h_concat needs backward computation.
I0924 02:54:49.931015  8329 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:54:49.931020  8329 net.cpp:217] lstm2_unit_1 needs backward computation.
I0924 02:54:49.931026  8329 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0924 02:54:49.931032  8329 net.cpp:217] lstm2_transform_1 needs backward computation.
I0924 02:54:49.931038  8329 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0924 02:54:49.931046  8329 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0924 02:54:49.931051  8329 net.cpp:217] lstm2_x_transform needs backward computation.
I0924 02:54:49.931057  8329 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0924 02:54:49.931064  8329 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0924 02:54:49.931074  8329 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:54:49.931080  8329 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:54:49.931085  8329 net.cpp:261] This network produces output c_T
I0924 02:54:49.931090  8329 net.cpp:261] This network produces output h_pseudoloss
I0924 02:54:49.931107  8329 net.cpp:274] Network initialization done.
I0924 02:54:49.931159  8329 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0924 02:54:49.931165  8329 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0924 02:54:49.931171  8329 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0924 02:54:49.931274  8329 net.cpp:141] Setting up lstm2
I0924 02:54:49.931287  8329 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:49.931293  8329 net.cpp:156] Memory required for data: 36412
I0924 02:54:49.931308  8329 layer_factory.hpp:77] Creating layer predict
I0924 02:54:49.931323  8329 net.cpp:91] Creating Layer predict
I0924 02:54:49.931330  8329 net.cpp:425] predict <- lstm2
I0924 02:54:49.931339  8329 net.cpp:399] predict -> predict
I0924 02:54:50.022030  8333 net.cpp:141] Setting up lstm2_x_transform
I0924 02:54:50.022089  8333 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:50.022097  8333 net.cpp:156] Memory required for data: 30020
I0924 02:54:50.022125  8333 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0924 02:54:50.022146  8333 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0924 02:54:50.022155  8333 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0924 02:54:50.022171  8333 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0924 02:54:50.022222  8333 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0924 02:54:50.022233  8333 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:50.022240  8333 net.cpp:156] Memory required for data: 46020
I0924 02:54:50.022245  8333 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0924 02:54:50.022258  8333 net.cpp:91] Creating Layer lstm2_h_conted_0
I0924 02:54:50.022264  8333 net.cpp:425] lstm2_h_conted_0 <- h_0
I0924 02:54:50.022271  8333 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0924 02:54:50.022282  8333 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0924 02:54:50.022388  8333 net.cpp:141] Setting up lstm2_h_conted_0
I0924 02:54:50.022398  8333 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:50.022403  8333 net.cpp:156] Memory required for data: 50020
I0924 02:54:50.022409  8333 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0924 02:54:50.022424  8333 net.cpp:91] Creating Layer lstm2_transform_1
I0924 02:54:50.022430  8333 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0924 02:54:50.022441  8333 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0924 02:54:50.084398  8333 net.cpp:141] Setting up lstm2_transform_1
I0924 02:54:50.084455  8333 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:50.084465  8333 net.cpp:156] Memory required for data: 66020
I0924 02:54:50.084491  8333 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0924 02:54:50.084522  8333 net.cpp:91] Creating Layer lstm2_gate_input_1
I0924 02:54:50.084532  8333 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0924 02:54:50.084542  8333 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0924 02:54:50.084554  8333 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0924 02:54:50.084619  8333 net.cpp:141] Setting up lstm2_gate_input_1
I0924 02:54:50.084631  8333 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:50.084638  8333 net.cpp:156] Memory required for data: 82020
I0924 02:54:50.084645  8333 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0924 02:54:50.084657  8333 net.cpp:91] Creating Layer lstm2_unit_1
I0924 02:54:50.084666  8333 net.cpp:425] lstm2_unit_1 <- c_0
I0924 02:54:50.084674  8333 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0924 02:54:50.084681  8333 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0924 02:54:50.084694  8333 net.cpp:399] lstm2_unit_1 -> c_1
I0924 02:54:50.084707  8333 net.cpp:399] lstm2_unit_1 -> h_1
I0924 02:54:50.084787  8333 net.cpp:141] Setting up lstm2_unit_1
I0924 02:54:50.084800  8333 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:50.084808  8333 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:50.084815  8333 net.cpp:156] Memory required for data: 90020
I0924 02:54:50.084821  8333 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:54:50.084833  8333 net.cpp:91] Creating Layer lstm2_
I0924 02:54:50.084841  8333 net.cpp:425] lstm2_ <- c_1
I0924 02:54:50.084851  8333 net.cpp:399] lstm2_ -> c_T
I0924 02:54:50.084892  8333 net.cpp:141] Setting up lstm2_
I0924 02:54:50.084904  8333 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:50.084910  8333 net.cpp:156] Memory required for data: 94020
I0924 02:54:50.084918  8333 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0924 02:54:50.084931  8333 net.cpp:91] Creating Layer lstm2_h_concat
I0924 02:54:50.084939  8333 net.cpp:425] lstm2_h_concat <- h_1
I0924 02:54:50.084947  8333 net.cpp:399] lstm2_h_concat -> h
I0924 02:54:50.084995  8333 net.cpp:141] Setting up lstm2_h_concat
I0924 02:54:50.085006  8333 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:50.085013  8333 net.cpp:156] Memory required for data: 98020
I0924 02:54:50.085021  8333 layer_factory.hpp:77] Creating layer h_pseudoloss
I0924 02:54:50.085032  8333 net.cpp:91] Creating Layer h_pseudoloss
I0924 02:54:50.085039  8333 net.cpp:425] h_pseudoloss <- h
I0924 02:54:50.085048  8333 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0924 02:54:50.085163  8333 net.cpp:141] Setting up h_pseudoloss
I0924 02:54:50.085176  8333 net.cpp:148] Top shape: (1)
I0924 02:54:50.085183  8333 net.cpp:151]     with loss weight 1
I0924 02:54:50.085208  8333 net.cpp:156] Memory required for data: 98024
I0924 02:54:50.085216  8333 net.cpp:217] h_pseudoloss needs backward computation.
I0924 02:54:50.433362  8329 net.cpp:141] Setting up predict
I0924 02:54:53.948107  8329 net.cpp:148] Top shape: 1 1 46168 (46168)
I0924 02:54:53.948125  8329 net.cpp:156] Memory required for data: 221084
I0924 02:54:53.948182  8329 layer_factory.hpp:77] Creating layer probs
I0924 02:54:53.948211  8329 net.cpp:91] Creating Layer probs
I0924 02:54:53.948225  8329 net.cpp:425] probs <- predict
I0924 02:54:53.948237  8329 net.cpp:399] probs -> probs
I0924 02:54:53.948206  8333 net.cpp:217] lstm2_h_concat needs backward computation.
I0924 02:54:53.948272  8333 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:54:53.948302  8333 net.cpp:217] lstm2_unit_1 needs backward computation.
I0924 02:54:53.948423  8333 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0924 02:54:53.948473  8333 net.cpp:217] lstm2_transform_1 needs backward computation.
I0924 02:54:53.948612  8333 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0924 02:54:53.948698  8337 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0924 02:54:53.948642  8333 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0924 02:54:53.948756  8333 net.cpp:217] lstm2_x_transform needs backward computation.
I0924 02:54:53.948806  8333 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0924 02:54:53.948935  8337 layer_factory.hpp:77] Creating layer data
I0924 02:54:53.948848  8333 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0924 02:54:53.948971  8337 net.cpp:91] Creating Layer data
I0924 02:54:53.948993  8337 net.cpp:399] data -> data
I0924 02:54:53.949000  8333 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:54:53.949030  8333 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:54:53.949046  8333 net.cpp:261] This network produces output c_T
I0924 02:54:53.949074  8333 net.cpp:261] This network produces output h_pseudoloss
I0924 02:54:53.949143  8333 net.cpp:274] Network initialization done.
I0924 02:54:53.949542  8333 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0924 02:54:53.949549  8337 net.cpp:141] Setting up data
I0924 02:54:53.949565  8333 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0924 02:54:53.949574  8337 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0924 02:54:53.949582  8337 net.cpp:156] Memory required for data: 6183480
I0924 02:54:53.949584  8333 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0924 02:54:53.949589  8337 layer_factory.hpp:77] Creating layer conv1
I0924 02:54:53.949614  8337 net.cpp:91] Creating Layer conv1
I0924 02:54:53.949620  8337 net.cpp:425] conv1 <- data
I0924 02:54:53.949630  8337 net.cpp:399] conv1 -> conv1
I0924 02:54:53.949642  8351 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/e39af7d8-dc04-4e7a-9b0a-ddc00aed7604/tmp/cvld8340936158615263543/s2vt.words_to_preds.prototxt
I0924 02:54:53.949673  8351 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0924 02:54:53.949682  8351 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0924 02:54:53.949856  8333 net.cpp:141] Setting up lstm2
I0924 02:54:53.949893  8333 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:53.949899  8333 net.cpp:156] Memory required for data: 36412
I0924 02:54:53.949919  8333 layer_factory.hpp:77] Creating layer predict
I0924 02:54:53.949934  8333 net.cpp:91] Creating Layer predict
I0924 02:54:53.949954  8333 net.cpp:425] predict <- lstm2
I0924 02:54:53.949965  8333 net.cpp:399] predict -> predict
I0924 02:54:53.950057  8351 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0924 02:54:53.950971  8357 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/e39af7d8-dc04-4e7a-9b0a-ddc00aed7604/tmp/cvld8340936158615263543/s2vt.words_to_preds.prototxt
I0924 02:54:53.951479  8339 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/e39af7d8-dc04-4e7a-9b0a-ddc00aed7604/tmp/cvld8340936158615263543/s2vt.words_to_preds.prototxt
I0924 02:54:54.043658  8357 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0924 02:54:54.043679  8357 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0924 02:54:54.043675  8339 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0924 02:54:54.043687  8339 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0924 02:54:54.043735  8351 layer_factory.hpp:77] Creating layer input
I0924 02:54:54.043757  8351 net.cpp:91] Creating Layer input
I0924 02:54:54.043767  8351 net.cpp:399] input -> frames_fc7
I0924 02:54:54.043787  8351 net.cpp:399] input -> cont_sentence
I0924 02:54:54.043802  8351 net.cpp:399] input -> input_sentence
I0924 02:54:54.043815  8351 net.cpp:399] input -> stage_indicator
I0924 02:54:54.043956  8339 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0924 02:54:54.043956  8357 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0924 02:54:54.044055  8339 layer_factory.hpp:77] Creating layer input
I0924 02:54:54.052356  8351 net.cpp:141] Setting up input
I0924 02:54:54.070996  8339 net.cpp:91] Creating Layer input
I0924 02:54:54.071009  8351 net.cpp:148] Top shape: 1 4096 (4096)
I0924 02:54:54.071039  8339 net.cpp:399] input -> frames_fc7
I0924 02:54:54.071044  8351 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.071058  8351 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.071069  8351 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.071074  8339 net.cpp:399] input -> cont_sentence
I0924 02:54:54.071079  8351 net.cpp:156] Memory required for data: 16396
I0924 02:54:54.071091  8351 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0924 02:54:54.071096  8339 net.cpp:399] input -> input_sentence
I0924 02:54:54.071110  8351 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0924 02:54:54.071120  8339 net.cpp:399] input -> stage_indicator
I0924 02:54:54.071122  8351 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0924 02:54:54.071136  8357 layer_factory.hpp:77] Creating layer input
I0924 02:54:54.071144  8351 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0924 02:54:54.071172  8357 net.cpp:91] Creating Layer input
I0924 02:54:54.071180  8351 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0924 02:54:54.071187  8357 net.cpp:399] input -> frames_fc7
I0924 02:54:54.071208  8357 net.cpp:399] input -> cont_sentence
I0924 02:54:54.071228  8357 net.cpp:399] input -> input_sentence
I0924 02:54:54.071245  8357 net.cpp:399] input -> stage_indicator
I0924 02:54:54.072695  8351 net.cpp:141] Setting up cont_sentence_input_1_split
I0924 02:54:54.072741  8351 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.072756  8351 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.072764  8351 net.cpp:156] Memory required for data: 16404
I0924 02:54:54.072777  8351 layer_factory.hpp:77] Creating layer embed_encoder
I0924 02:54:54.072789  8339 net.cpp:141] Setting up input
I0924 02:54:54.072806  8351 net.cpp:91] Creating Layer embed_encoder
I0924 02:54:54.072808  8339 net.cpp:148] Top shape: 1 4096 (4096)
I0924 02:54:54.072825  8351 net.cpp:425] embed_encoder <- frames_fc7
I0924 02:54:54.072840  8339 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.072847  8351 net.cpp:399] embed_encoder -> embedded_in_frames
I0924 02:54:54.072854  8339 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.072865  8339 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.072873  8339 net.cpp:156] Memory required for data: 16396
I0924 02:54:54.072883  8339 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0924 02:54:54.072904  8339 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0924 02:54:54.072916  8339 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0924 02:54:54.072929  8339 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0924 02:54:54.072948  8339 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0924 02:54:54.079105  8357 net.cpp:141] Setting up input
I0924 02:54:54.079164  8357 net.cpp:148] Top shape: 1 4096 (4096)
I0924 02:54:54.079183  8357 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.079198  8357 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.079211  8357 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.079221  8357 net.cpp:156] Memory required for data: 16396
I0924 02:54:54.079237  8357 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0924 02:54:54.079269  8357 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0924 02:54:54.079285  8357 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0924 02:54:54.079305  8357 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0924 02:54:54.079337  8357 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0924 02:54:54.079458  8357 net.cpp:141] Setting up cont_sentence_input_1_split
I0924 02:54:54.079480  8357 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.079494  8357 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.079504  8357 net.cpp:156] Memory required for data: 16404
I0924 02:54:54.079516  8357 layer_factory.hpp:77] Creating layer embed_encoder
I0924 02:54:54.079545  8357 net.cpp:91] Creating Layer embed_encoder
I0924 02:54:54.079558  8357 net.cpp:425] embed_encoder <- frames_fc7
I0924 02:54:54.079577  8357 net.cpp:399] embed_encoder -> embedded_in_frames
I0924 02:54:54.086021  8339 net.cpp:141] Setting up cont_sentence_input_1_split
I0924 02:54:54.086072  8339 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.086086  8339 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.086093  8339 net.cpp:156] Memory required for data: 16404
I0924 02:54:54.086105  8339 layer_factory.hpp:77] Creating layer embed_encoder
I0924 02:54:54.086135  8339 net.cpp:91] Creating Layer embed_encoder
I0924 02:54:54.086148  8339 net.cpp:425] embed_encoder <- frames_fc7
I0924 02:54:54.086169  8339 net.cpp:399] embed_encoder -> embedded_in_frames
I0924 02:54:54.119308  8351 net.cpp:141] Setting up embed_encoder
I0924 02:54:54.119354  8351 net.cpp:148] Top shape: 1 500 (500)
I0924 02:54:54.119360  8351 net.cpp:156] Memory required for data: 18404
I0924 02:54:54.119384  8351 layer_factory.hpp:77] Creating layer reshape_frames
I0924 02:54:54.119407  8351 net.cpp:91] Creating Layer reshape_frames
I0924 02:54:54.119421  8351 net.cpp:425] reshape_frames <- embedded_in_frames
I0924 02:54:54.119441  8351 net.cpp:399] reshape_frames -> embedded_input_frames
I0924 02:54:54.119464  8339 net.cpp:141] Setting up embed_encoder
I0924 02:54:54.119483  8339 net.cpp:148] Top shape: 1 500 (500)
I0924 02:54:54.119490  8339 net.cpp:156] Memory required for data: 18404
I0924 02:54:54.119505  8339 layer_factory.hpp:77] Creating layer reshape_frames
I0924 02:54:54.119518  8339 net.cpp:91] Creating Layer reshape_frames
I0924 02:54:54.119524  8339 net.cpp:425] reshape_frames <- embedded_in_frames
I0924 02:54:54.119536  8339 net.cpp:399] reshape_frames -> embedded_input_frames
I0924 02:54:54.119599  8339 net.cpp:141] Setting up reshape_frames
I0924 02:54:54.119616  8339 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:54:54.119624  8339 net.cpp:156] Memory required for data: 20404
I0924 02:54:54.119633  8339 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0924 02:54:54.119642  8351 net.cpp:141] Setting up reshape_frames
I0924 02:54:54.119652  8339 net.cpp:91] Creating Layer reshape_stage_indicator
I0924 02:54:54.119657  8351 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:54:54.119662  8339 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0924 02:54:54.119666  8351 net.cpp:156] Memory required for data: 20404
I0924 02:54:54.119674  8351 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0924 02:54:54.119675  8339 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0924 02:54:54.119701  8351 net.cpp:91] Creating Layer reshape_stage_indicator
I0924 02:54:54.119714  8351 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0924 02:54:54.119729  8351 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0924 02:54:54.119762  8339 net.cpp:141] Setting up reshape_stage_indicator
I0924 02:54:54.119779  8339 net.cpp:148] Top shape: 1 1 1 (1)
I0924 02:54:54.119786  8339 net.cpp:156] Memory required for data: 20408
I0924 02:54:54.119792  8339 layer_factory.hpp:77] Creating layer embedding
I0924 02:54:54.119808  8339 net.cpp:91] Creating Layer embedding
I0924 02:54:54.119814  8339 net.cpp:425] embedding <- input_sentence
I0924 02:54:54.119829  8339 net.cpp:399] embedding -> embedded_input_sentence
I0924 02:54:54.119899  8357 net.cpp:141] Setting up embed_encoder
I0924 02:54:54.119927  8351 net.cpp:141] Setting up reshape_stage_indicator
I0924 02:54:54.119946  8357 net.cpp:148] Top shape: 1 500 (500)
I0924 02:54:54.119947  8351 net.cpp:148] Top shape: 1 1 1 (1)
I0924 02:54:54.119964  8357 net.cpp:156] Memory required for data: 18404
I0924 02:54:54.119983  8351 net.cpp:156] Memory required for data: 20408
I0924 02:54:54.119995  8351 layer_factory.hpp:77] Creating layer embedding
I0924 02:54:54.120012  8351 net.cpp:91] Creating Layer embedding
I0924 02:54:54.120012  8357 layer_factory.hpp:77] Creating layer reshape_frames
I0924 02:54:54.120029  8351 net.cpp:425] embedding <- input_sentence
I0924 02:54:54.120066  8351 net.cpp:399] embedding -> embedded_input_sentence
I0924 02:54:54.120074  8357 net.cpp:91] Creating Layer reshape_frames
I0924 02:54:54.120090  8357 net.cpp:425] reshape_frames <- embedded_in_frames
I0924 02:54:54.120106  8357 net.cpp:399] reshape_frames -> embedded_input_frames
I0924 02:54:54.164418  8357 net.cpp:141] Setting up reshape_frames
I0924 02:54:54.164482  8357 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:54:54.164494  8357 net.cpp:156] Memory required for data: 20404
I0924 02:54:54.164510  8357 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0924 02:54:54.164548  8357 net.cpp:91] Creating Layer reshape_stage_indicator
I0924 02:54:54.164562  8357 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0924 02:54:54.164619  8357 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0924 02:54:54.228942  8357 net.cpp:141] Setting up reshape_stage_indicator
I0924 02:54:54.228997  8357 net.cpp:148] Top shape: 1 1 1 (1)
I0924 02:54:54.229006  8357 net.cpp:156] Memory required for data: 20408
I0924 02:54:54.229017  8357 layer_factory.hpp:77] Creating layer embedding
I0924 02:54:54.229044  8357 net.cpp:91] Creating Layer embedding
I0924 02:54:54.229053  8357 net.cpp:425] embedding <- input_sentence
I0924 02:54:54.229096  8357 net.cpp:399] embedding -> embedded_input_sentence
I0924 02:54:54.385777  8339 net.cpp:141] Setting up embedding
I0924 02:54:54.385830  8339 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:54:54.385841  8339 net.cpp:156] Memory required for data: 22408
I0924 02:54:54.385866  8339 layer_factory.hpp:77] Creating layer lstm1
I0924 02:54:54.385898  8339 net.cpp:91] Creating Layer lstm1
I0924 02:54:54.385912  8339 net.cpp:425] lstm1 <- embedded_input_frames
I0924 02:54:54.385926  8339 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0924 02:54:54.385957  8339 net.cpp:399] lstm1 -> lstm1
I0924 02:54:54.385983  8339 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0924 02:54:54.386445  8339 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0924 02:54:54.386636  8339 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:54:54.386662  8339 net.cpp:91] Creating Layer lstm1_
I0924 02:54:54.386677  8339 net.cpp:399] lstm1_ -> x
I0924 02:54:54.386698  8339 net.cpp:399] lstm1_ -> cont
I0924 02:54:54.387737  8339 net.cpp:141] Setting up lstm1_
I0924 02:54:54.387760  8339 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:54:54.387776  8339 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.387786  8339 net.cpp:156] Memory required for data: 2004
I0924 02:54:54.387799  8339 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:54:54.387817  8339 net.cpp:91] Creating Layer lstm1_
I0924 02:54:54.387847  8339 net.cpp:399] lstm1_ -> c_0
I0924 02:54:54.387872  8339 net.cpp:399] lstm1_ -> h_0
I0924 02:54:54.388476  8339 net.cpp:141] Setting up lstm1_
I0924 02:54:54.388499  8339 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.388514  8339 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.388523  8339 net.cpp:156] Memory required for data: 10004
I0924 02:54:54.388535  8339 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0924 02:54:54.388552  8339 net.cpp:91] Creating Layer lstm1_cont_slice
I0924 02:54:54.388566  8339 net.cpp:425] lstm1_cont_slice <- cont
I0924 02:54:54.388581  8339 net.cpp:399] lstm1_cont_slice -> cont_1
I0924 02:54:54.393010  8339 net.cpp:141] Setting up lstm1_cont_slice
I0924 02:54:54.393076  8339 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.393090  8339 net.cpp:156] Memory required for data: 10008
I0924 02:54:54.393108  8339 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0924 02:54:54.393147  8339 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0924 02:54:54.393164  8339 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0924 02:54:54.393187  8339 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0924 02:54:54.393215  8339 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0924 02:54:54.393875  8339 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0924 02:54:54.393894  8339 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.393906  8339 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.393914  8339 net.cpp:156] Memory required for data: 10016
I0924 02:54:54.393924  8339 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0924 02:54:54.393952  8339 net.cpp:91] Creating Layer lstm1_x_transform
I0924 02:54:54.393962  8339 net.cpp:425] lstm1_x_transform <- x
I0924 02:54:54.393983  8339 net.cpp:399] lstm1_x_transform -> W_xc_x
I0924 02:54:54.439699  8339 net.cpp:141] Setting up lstm1_x_transform
I0924 02:54:54.440554  8339 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:54.440809  8339 net.cpp:156] Memory required for data: 26016
I0924 02:54:54.441010  8339 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0924 02:54:54.441267  8339 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0924 02:54:54.441439  8339 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0924 02:54:54.441645  8339 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0924 02:54:54.444602  8339 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0924 02:54:54.445026  8339 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:54.445282  8339 net.cpp:156] Memory required for data: 42016
I0924 02:54:54.445466  8339 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0924 02:54:54.445672  8339 net.cpp:91] Creating Layer lstm1_h_conted_0
I0924 02:54:54.445844  8339 net.cpp:425] lstm1_h_conted_0 <- h_0
I0924 02:54:54.446038  8339 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0924 02:54:54.446382  8339 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0924 02:54:54.448560  8339 net.cpp:141] Setting up lstm1_h_conted_0
I0924 02:54:54.448626  8339 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.448638  8339 net.cpp:156] Memory required for data: 46016
I0924 02:54:54.448652  8339 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0924 02:54:54.448684  8339 net.cpp:91] Creating Layer lstm1_transform_1
I0924 02:54:54.448699  8339 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0924 02:54:54.448725  8339 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0924 02:54:54.467905  8351 net.cpp:141] Setting up embedding
I0924 02:54:54.467969  8351 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:54:54.467980  8351 net.cpp:156] Memory required for data: 22408
I0924 02:54:54.468008  8351 layer_factory.hpp:77] Creating layer lstm1
I0924 02:54:54.468042  8351 net.cpp:91] Creating Layer lstm1
I0924 02:54:54.468056  8351 net.cpp:425] lstm1 <- embedded_input_frames
I0924 02:54:54.468070  8351 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0924 02:54:54.468087  8351 net.cpp:399] lstm1 -> lstm1
I0924 02:54:54.468116  8351 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0924 02:54:54.468616  8351 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0924 02:54:54.468771  8351 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:54:54.468792  8351 net.cpp:91] Creating Layer lstm1_
I0924 02:54:54.468803  8351 net.cpp:399] lstm1_ -> x
I0924 02:54:54.468823  8351 net.cpp:399] lstm1_ -> cont
I0924 02:54:54.469460  8351 net.cpp:141] Setting up lstm1_
I0924 02:54:54.469480  8351 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:54:54.469491  8351 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.469501  8351 net.cpp:156] Memory required for data: 2004
I0924 02:54:54.469509  8351 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:54:54.469528  8351 net.cpp:91] Creating Layer lstm1_
I0924 02:54:54.469542  8351 net.cpp:399] lstm1_ -> c_0
I0924 02:54:54.469563  8351 net.cpp:399] lstm1_ -> h_0
I0924 02:54:54.470645  8351 net.cpp:141] Setting up lstm1_
I0924 02:54:54.470669  8351 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.470682  8351 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.470692  8351 net.cpp:156] Memory required for data: 10004
I0924 02:54:54.470700  8351 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0924 02:54:54.470724  8351 net.cpp:91] Creating Layer lstm1_cont_slice
I0924 02:54:54.470736  8351 net.cpp:425] lstm1_cont_slice <- cont
I0924 02:54:54.470751  8351 net.cpp:399] lstm1_cont_slice -> cont_1
I0924 02:54:54.475391  8351 net.cpp:141] Setting up lstm1_cont_slice
I0924 02:54:54.475415  8351 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.475421  8351 net.cpp:156] Memory required for data: 10008
I0924 02:54:54.475428  8351 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0924 02:54:54.475441  8351 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0924 02:54:54.475447  8351 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0924 02:54:54.475463  8351 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0924 02:54:54.475474  8351 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0924 02:54:54.475590  8351 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0924 02:54:54.475605  8351 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.475613  8351 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.475618  8351 net.cpp:156] Memory required for data: 10016
I0924 02:54:54.475625  8351 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0924 02:54:54.475641  8351 net.cpp:91] Creating Layer lstm1_x_transform
I0924 02:54:54.475646  8351 net.cpp:425] lstm1_x_transform <- x
I0924 02:54:54.475657  8351 net.cpp:399] lstm1_x_transform -> W_xc_x
I0924 02:54:54.475700  8333 net.cpp:141] Setting up predict
I0924 02:54:54.475736  8333 net.cpp:148] Top shape: 1 1 46168 (46168)
I0924 02:54:54.475742  8333 net.cpp:156] Memory required for data: 221084
I0924 02:54:54.475756  8333 layer_factory.hpp:77] Creating layer probs
I0924 02:54:54.475771  8333 net.cpp:91] Creating Layer probs
I0924 02:54:54.475778  8333 net.cpp:425] probs <- predict
I0924 02:54:54.475787  8333 net.cpp:399] probs -> probs
I0924 02:54:54.506343  8351 net.cpp:141] Setting up lstm1_x_transform
I0924 02:54:54.506408  8351 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:54.506418  8351 net.cpp:156] Memory required for data: 26016
I0924 02:54:54.506444  8351 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0924 02:54:54.506465  8351 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0924 02:54:54.506475  8351 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0924 02:54:54.506489  8351 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0924 02:54:54.506553  8351 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0924 02:54:54.506568  8351 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:54.506574  8351 net.cpp:156] Memory required for data: 42016
I0924 02:54:54.506582  8351 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0924 02:54:54.506611  8351 net.cpp:91] Creating Layer lstm1_h_conted_0
I0924 02:54:54.506619  8351 net.cpp:425] lstm1_h_conted_0 <- h_0
I0924 02:54:54.506633  8351 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0924 02:54:54.506646  8351 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0924 02:54:54.506796  8351 net.cpp:141] Setting up lstm1_h_conted_0
I0924 02:54:54.506808  8351 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.506815  8351 net.cpp:156] Memory required for data: 46016
I0924 02:54:54.506821  8351 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0924 02:54:54.506836  8351 net.cpp:91] Creating Layer lstm1_transform_1
I0924 02:54:54.506842  8351 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0924 02:54:54.506852  8351 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0924 02:54:54.515449  8357 net.cpp:141] Setting up embedding
I0924 02:54:54.515509  8357 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:54:54.515517  8357 net.cpp:156] Memory required for data: 22408
I0924 02:54:54.515539  8357 layer_factory.hpp:77] Creating layer lstm1
I0924 02:54:54.515563  8357 net.cpp:91] Creating Layer lstm1
I0924 02:54:54.515561  8339 net.cpp:141] Setting up lstm1_transform_1
I0924 02:54:54.515574  8357 net.cpp:425] lstm1 <- embedded_input_frames
I0924 02:54:54.515597  8339 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:54.515599  8357 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0924 02:54:54.515609  8339 net.cpp:156] Memory required for data: 62016
I0924 02:54:54.515627  8339 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0924 02:54:54.515632  8357 net.cpp:399] lstm1 -> lstm1
I0924 02:54:54.515648  8339 net.cpp:91] Creating Layer lstm1_gate_input_1
I0924 02:54:54.515655  8357 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0924 02:54:54.515657  8339 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0924 02:54:54.515678  8339 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0924 02:54:54.515689  8339 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0924 02:54:54.515750  8339 net.cpp:141] Setting up lstm1_gate_input_1
I0924 02:54:54.515763  8339 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:54.515769  8339 net.cpp:156] Memory required for data: 78016
I0924 02:54:54.515774  8339 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0924 02:54:54.515784  8339 net.cpp:91] Creating Layer lstm1_unit_1
I0924 02:54:54.515790  8339 net.cpp:425] lstm1_unit_1 <- c_0
I0924 02:54:54.515813  8339 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0924 02:54:54.515820  8339 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0924 02:54:54.515831  8339 net.cpp:399] lstm1_unit_1 -> c_1
I0924 02:54:54.515842  8339 net.cpp:399] lstm1_unit_1 -> h_1
I0924 02:54:54.515928  8339 net.cpp:141] Setting up lstm1_unit_1
I0924 02:54:54.515939  8339 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.515946  8339 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.515952  8339 net.cpp:156] Memory required for data: 86016
I0924 02:54:54.515957  8339 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:54:54.515967  8339 net.cpp:91] Creating Layer lstm1_
I0924 02:54:54.515972  8339 net.cpp:425] lstm1_ <- c_1
I0924 02:54:54.515981  8339 net.cpp:399] lstm1_ -> c_T
I0924 02:54:54.516017  8357 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0924 02:54:54.516126  8357 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:54:54.516140  8357 net.cpp:91] Creating Layer lstm1_
I0924 02:54:54.516149  8357 net.cpp:399] lstm1_ -> x
I0924 02:54:54.516163  8357 net.cpp:399] lstm1_ -> cont
I0924 02:54:54.516243  8357 net.cpp:141] Setting up lstm1_
I0924 02:54:54.516257  8357 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:54:54.516263  8357 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.516268  8357 net.cpp:156] Memory required for data: 2004
I0924 02:54:54.516274  8357 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:54:54.516284  8357 net.cpp:91] Creating Layer lstm1_
I0924 02:54:54.516296  8357 net.cpp:399] lstm1_ -> c_0
I0924 02:54:54.516299  8339 net.cpp:141] Setting up lstm1_
I0924 02:54:54.516309  8357 net.cpp:399] lstm1_ -> h_0
I0924 02:54:54.516319  8339 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.516327  8339 net.cpp:156] Memory required for data: 90016
I0924 02:54:54.516336  8339 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0924 02:54:54.516353  8339 net.cpp:91] Creating Layer lstm1_h_concat
I0924 02:54:54.516369  8339 net.cpp:425] lstm1_h_concat <- h_1
I0924 02:54:54.516381  8339 net.cpp:399] lstm1_h_concat -> h
I0924 02:54:54.518709  8339 net.cpp:141] Setting up lstm1_h_concat
I0924 02:54:54.518771  8339 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.518780  8339 net.cpp:156] Memory required for data: 94016
I0924 02:54:54.518795  8339 layer_factory.hpp:77] Creating layer h_pseudoloss
I0924 02:54:54.518827  8339 net.cpp:91] Creating Layer h_pseudoloss
I0924 02:54:54.518839  8339 net.cpp:425] h_pseudoloss <- h
I0924 02:54:54.518857  8339 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0924 02:54:54.520143  8357 net.cpp:141] Setting up lstm1_
I0924 02:54:54.520210  8357 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.520228  8357 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.520239  8357 net.cpp:156] Memory required for data: 10004
I0924 02:54:54.520256  8357 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0924 02:54:54.520288  8357 net.cpp:91] Creating Layer lstm1_cont_slice
I0924 02:54:54.520303  8357 net.cpp:425] lstm1_cont_slice <- cont
I0924 02:54:54.521515  8357 net.cpp:399] lstm1_cont_slice -> cont_1
I0924 02:54:54.523099  8339 net.cpp:141] Setting up h_pseudoloss
I0924 02:54:54.523128  8339 net.cpp:148] Top shape: (1)
I0924 02:54:54.523134  8339 net.cpp:151]     with loss weight 1
I0924 02:54:54.523147  8357 net.cpp:141] Setting up lstm1_cont_slice
I0924 02:54:54.523155  8339 net.cpp:156] Memory required for data: 94020
I0924 02:54:54.523175  8357 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.523178  8339 net.cpp:217] h_pseudoloss needs backward computation.
I0924 02:54:54.523185  8357 net.cpp:156] Memory required for data: 10008
I0924 02:54:54.523191  8339 net.cpp:217] lstm1_h_concat needs backward computation.
I0924 02:54:54.523195  8357 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0924 02:54:54.523200  8339 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:54:54.523213  8339 net.cpp:217] lstm1_unit_1 needs backward computation.
I0924 02:54:54.523222  8339 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0924 02:54:54.523229  8339 net.cpp:217] lstm1_transform_1 needs backward computation.
I0924 02:54:54.523228  8357 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0924 02:54:54.523236  8339 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0924 02:54:54.523241  8357 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0924 02:54:54.523243  8339 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0924 02:54:54.523252  8339 net.cpp:217] lstm1_x_transform needs backward computation.
I0924 02:54:54.523257  8339 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0924 02:54:54.523257  8357 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0924 02:54:54.523272  8339 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0924 02:54:54.523278  8339 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:54:54.523283  8339 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:54:54.523289  8357 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0924 02:54:54.523294  8339 net.cpp:261] This network produces output c_T
I0924 02:54:54.523309  8339 net.cpp:261] This network produces output h_pseudoloss
I0924 02:54:54.523331  8339 net.cpp:274] Network initialization done.
I0924 02:54:54.523404  8339 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0924 02:54:54.523413  8339 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0924 02:54:54.523418  8339 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0924 02:54:54.523994  8357 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0924 02:54:54.524013  8357 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.524024  8357 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.524032  8357 net.cpp:156] Memory required for data: 10016
I0924 02:54:54.524042  8357 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0924 02:54:54.524068  8357 net.cpp:91] Creating Layer lstm1_x_transform
I0924 02:54:54.524078  8357 net.cpp:425] lstm1_x_transform <- x
I0924 02:54:54.524094  8357 net.cpp:399] lstm1_x_transform -> W_xc_x
I0924 02:54:54.532104  8339 net.cpp:141] Setting up lstm1
I0924 02:54:54.532160  8339 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.532173  8339 net.cpp:156] Memory required for data: 26408
I0924 02:54:54.532208  8339 layer_factory.hpp:77] Creating layer concat
I0924 02:54:54.532235  8339 net.cpp:91] Creating Layer concat
I0924 02:54:54.532248  8339 net.cpp:425] concat <- lstm1
I0924 02:54:54.532261  8339 net.cpp:425] concat <- embedded_input_sentence
I0924 02:54:54.532271  8339 net.cpp:425] concat <- reshaped_stage_indicator
I0924 02:54:54.532285  8339 net.cpp:399] concat -> lstm1_video_sequence
I0924 02:54:54.532460  8339 net.cpp:141] Setting up concat
I0924 02:54:54.532477  8339 net.cpp:148] Top shape: 1 1 1501 (1501)
I0924 02:54:54.532485  8339 net.cpp:156] Memory required for data: 32412
I0924 02:54:54.532495  8339 layer_factory.hpp:77] Creating layer lstm2
I0924 02:54:54.532518  8339 net.cpp:91] Creating Layer lstm2
I0924 02:54:54.532528  8339 net.cpp:425] lstm2 <- lstm1_video_sequence
I0924 02:54:54.532539  8339 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0924 02:54:54.532554  8339 net.cpp:399] lstm2 -> lstm2
I0924 02:54:54.532574  8339 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0924 02:54:54.533056  8339 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0924 02:54:54.533206  8339 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:54:54.533227  8339 net.cpp:91] Creating Layer lstm2_
I0924 02:54:54.533238  8339 net.cpp:399] lstm2_ -> x
I0924 02:54:54.533257  8339 net.cpp:399] lstm2_ -> cont
I0924 02:54:54.540774  8339 net.cpp:141] Setting up lstm2_
I0924 02:54:54.540827  8339 net.cpp:148] Top shape: 1 1 1501 (1501)
I0924 02:54:54.540841  8339 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.540849  8339 net.cpp:156] Memory required for data: 6008
I0924 02:54:54.540865  8339 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:54:54.540899  8339 net.cpp:91] Creating Layer lstm2_
I0924 02:54:54.540921  8339 net.cpp:399] lstm2_ -> c_0
I0924 02:54:54.540951  8339 net.cpp:399] lstm2_ -> h_0
I0924 02:54:54.541059  8339 net.cpp:141] Setting up lstm2_
I0924 02:54:54.541075  8339 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.541085  8339 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.541095  8339 net.cpp:156] Memory required for data: 14008
I0924 02:54:54.541103  8339 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0924 02:54:54.541126  8339 net.cpp:91] Creating Layer lstm2_cont_slice
I0924 02:54:54.541137  8339 net.cpp:425] lstm2_cont_slice <- cont
I0924 02:54:54.541152  8339 net.cpp:399] lstm2_cont_slice -> cont_1
I0924 02:54:54.543390  8339 net.cpp:141] Setting up lstm2_cont_slice
I0924 02:54:54.543411  8339 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.543421  8339 net.cpp:156] Memory required for data: 14012
I0924 02:54:54.543431  8339 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0924 02:54:54.543445  8339 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0924 02:54:54.543454  8339 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0924 02:54:54.543473  8339 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0924 02:54:54.543489  8339 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0924 02:54:54.546658  8339 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0924 02:54:54.546689  8339 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.546700  8339 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.546707  8339 net.cpp:156] Memory required for data: 14020
I0924 02:54:54.546717  8339 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0924 02:54:54.546748  8339 net.cpp:91] Creating Layer lstm2_x_transform
I0924 02:54:54.546758  8339 net.cpp:425] lstm2_x_transform <- x
I0924 02:54:54.546775  8339 net.cpp:399] lstm2_x_transform -> W_xc_x
I0924 02:54:54.578819  8351 net.cpp:141] Setting up lstm1_transform_1
I0924 02:54:54.578886  8351 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:54.578898  8351 net.cpp:156] Memory required for data: 62016
I0924 02:54:54.578928  8351 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0924 02:54:54.578958  8357 net.cpp:141] Setting up lstm1_x_transform
I0924 02:54:54.578961  8351 net.cpp:91] Creating Layer lstm1_gate_input_1
I0924 02:54:54.578984  8357 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:54.578990  8357 net.cpp:156] Memory required for data: 26016
I0924 02:54:54.578991  8351 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0924 02:54:54.579006  8357 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0924 02:54:54.579010  8351 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0924 02:54:54.579020  8357 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0924 02:54:54.579028  8357 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0924 02:54:54.579033  8351 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0924 02:54:54.579037  8357 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0924 02:54:54.579120  8351 net.cpp:141] Setting up lstm1_gate_input_1
I0924 02:54:54.579144  8351 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:54.579154  8351 net.cpp:156] Memory required for data: 78016
I0924 02:54:54.579162  8351 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0924 02:54:54.579179  8351 net.cpp:91] Creating Layer lstm1_unit_1
I0924 02:54:54.579187  8351 net.cpp:425] lstm1_unit_1 <- c_0
I0924 02:54:54.579187  8357 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0924 02:54:54.579197  8351 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0924 02:54:54.579201  8357 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:54.579207  8357 net.cpp:156] Memory required for data: 42016
I0924 02:54:54.579208  8351 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0924 02:54:54.579213  8357 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0924 02:54:54.579221  8351 net.cpp:399] lstm1_unit_1 -> c_1
I0924 02:54:54.579226  8357 net.cpp:91] Creating Layer lstm1_h_conted_0
I0924 02:54:54.579233  8357 net.cpp:425] lstm1_h_conted_0 <- h_0
I0924 02:54:54.579237  8351 net.cpp:399] lstm1_unit_1 -> h_1
I0924 02:54:54.579241  8357 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0924 02:54:54.579260  8357 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0924 02:54:54.586185  8351 net.cpp:141] Setting up lstm1_unit_1
I0924 02:54:54.586244  8351 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.586259  8351 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.586268  8351 net.cpp:156] Memory required for data: 86016
I0924 02:54:54.586283  8351 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:54:54.586311  8351 net.cpp:91] Creating Layer lstm1_
I0924 02:54:54.586315  8357 net.cpp:141] Setting up lstm1_h_conted_0
I0924 02:54:54.586324  8351 net.cpp:425] lstm1_ <- c_1
I0924 02:54:54.586349  8357 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.586359  8357 net.cpp:156] Memory required for data: 46016
I0924 02:54:54.586359  8351 net.cpp:399] lstm1_ -> c_T
I0924 02:54:54.586375  8357 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0924 02:54:54.586400  8357 net.cpp:91] Creating Layer lstm1_transform_1
I0924 02:54:54.586410  8357 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0924 02:54:54.586426  8357 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0924 02:54:54.587303  8351 net.cpp:141] Setting up lstm1_
I0924 02:54:54.587327  8351 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.587338  8351 net.cpp:156] Memory required for data: 90016
I0924 02:54:54.587349  8351 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0924 02:54:54.587378  8351 net.cpp:91] Creating Layer lstm1_h_concat
I0924 02:54:54.587390  8351 net.cpp:425] lstm1_h_concat <- h_1
I0924 02:54:54.587412  8351 net.cpp:399] lstm1_h_concat -> h
I0924 02:54:54.587496  8351 net.cpp:141] Setting up lstm1_h_concat
I0924 02:54:54.587515  8351 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.587525  8351 net.cpp:156] Memory required for data: 94016
I0924 02:54:54.587537  8351 layer_factory.hpp:77] Creating layer h_pseudoloss
I0924 02:54:54.587555  8351 net.cpp:91] Creating Layer h_pseudoloss
I0924 02:54:54.587568  8351 net.cpp:425] h_pseudoloss <- h
I0924 02:54:54.587594  8351 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0924 02:54:54.588277  8351 net.cpp:141] Setting up h_pseudoloss
I0924 02:54:54.588299  8351 net.cpp:148] Top shape: (1)
I0924 02:54:54.588310  8351 net.cpp:151]     with loss weight 1
I0924 02:54:54.588340  8351 net.cpp:156] Memory required for data: 94020
I0924 02:54:54.588354  8351 net.cpp:217] h_pseudoloss needs backward computation.
I0924 02:54:54.588364  8351 net.cpp:217] lstm1_h_concat needs backward computation.
I0924 02:54:54.588376  8351 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:54:54.588385  8351 net.cpp:217] lstm1_unit_1 needs backward computation.
I0924 02:54:54.588398  8351 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0924 02:54:54.588410  8351 net.cpp:217] lstm1_transform_1 needs backward computation.
I0924 02:54:54.588423  8351 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0924 02:54:54.588436  8351 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0924 02:54:54.588448  8351 net.cpp:217] lstm1_x_transform needs backward computation.
I0924 02:54:54.588459  8351 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0924 02:54:54.588471  8351 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0924 02:54:54.588485  8351 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:54:54.588495  8351 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:54:54.588503  8351 net.cpp:261] This network produces output c_T
I0924 02:54:54.588515  8351 net.cpp:261] This network produces output h_pseudoloss
I0924 02:54:54.588551  8351 net.cpp:274] Network initialization done.
I0924 02:54:54.588642  8351 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0924 02:54:54.588659  8351 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0924 02:54:54.588670  8351 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0924 02:54:54.597429  8351 net.cpp:141] Setting up lstm1
I0924 02:54:54.597493  8351 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.597503  8351 net.cpp:156] Memory required for data: 26408
I0924 02:54:54.597543  8351 layer_factory.hpp:77] Creating layer concat
I0924 02:54:54.597573  8351 net.cpp:91] Creating Layer concat
I0924 02:54:54.597587  8351 net.cpp:425] concat <- lstm1
I0924 02:54:54.597604  8351 net.cpp:425] concat <- embedded_input_sentence
I0924 02:54:54.597615  8351 net.cpp:425] concat <- reshaped_stage_indicator
I0924 02:54:54.597630  8351 net.cpp:399] concat -> lstm1_video_sequence
I0924 02:54:54.597694  8333 net.cpp:141] Setting up probs
I0924 02:54:54.597730  8333 net.cpp:148] Top shape: 1 1 46168 (46168)
I0924 02:54:54.597736  8333 net.cpp:156] Memory required for data: 405756
I0924 02:54:54.597745  8333 net.cpp:219] probs does not need backward computation.
I0924 02:54:54.597753  8333 net.cpp:219] predict does not need backward computation.
I0924 02:54:54.597759  8333 net.cpp:219] lstm2 does not need backward computation.
I0924 02:54:54.597764  8333 net.cpp:219] concat does not need backward computation.
I0924 02:54:54.597771  8333 net.cpp:219] lstm1 does not need backward computation.
I0924 02:54:54.597779  8333 net.cpp:219] embedding does not need backward computation.
I0924 02:54:54.597784  8333 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0924 02:54:54.597790  8333 net.cpp:219] reshape_frames does not need backward computation.
I0924 02:54:54.597795  8333 net.cpp:219] embed_encoder does not need backward computation.
I0924 02:54:54.597800  8333 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0924 02:54:54.597805  8333 net.cpp:219] input does not need backward computation.
I0924 02:54:54.597803  8351 net.cpp:141] Setting up concat
I0924 02:54:54.597811  8333 net.cpp:261] This network produces output probs
I0924 02:54:54.597829  8351 net.cpp:148] Top shape: 1 1 1501 (1501)
I0924 02:54:54.597839  8351 net.cpp:156] Memory required for data: 32412
I0924 02:54:54.597843  8333 net.cpp:274] Network initialization done.
I0924 02:54:54.597851  8351 layer_factory.hpp:77] Creating layer lstm2
I0924 02:54:54.597878  8351 net.cpp:91] Creating Layer lstm2
I0924 02:54:54.597892  8351 net.cpp:425] lstm2 <- lstm1_video_sequence
I0924 02:54:54.597904  8351 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0924 02:54:54.597920  8351 net.cpp:399] lstm2 -> lstm2
I0924 02:54:54.597944  8351 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0924 02:54:54.598026  8329 net.cpp:141] Setting up probs
I0924 02:54:54.598047  8329 net.cpp:148] Top shape: 1 1 46168 (46168)
I0924 02:54:54.598053  8329 net.cpp:156] Memory required for data: 405756
I0924 02:54:54.598060  8329 net.cpp:219] probs does not need backward computation.
I0924 02:54:54.598067  8329 net.cpp:219] predict does not need backward computation.
I0924 02:54:54.598072  8329 net.cpp:219] lstm2 does not need backward computation.
I0924 02:54:54.598078  8329 net.cpp:219] concat does not need backward computation.
I0924 02:54:54.598084  8329 net.cpp:219] lstm1 does not need backward computation.
I0924 02:54:54.598090  8329 net.cpp:219] embedding does not need backward computation.
I0924 02:54:54.598095  8329 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0924 02:54:54.598101  8329 net.cpp:219] reshape_frames does not need backward computation.
I0924 02:54:54.598106  8329 net.cpp:219] embed_encoder does not need backward computation.
I0924 02:54:54.598119  8329 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0924 02:54:54.598124  8329 net.cpp:219] input does not need backward computation.
I0924 02:54:54.598129  8329 net.cpp:261] This network produces output probs
I0924 02:54:54.598146  8329 net.cpp:274] Network initialization done.
I0924 02:54:54.600581  8351 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0924 02:54:54.600797  8337 net.cpp:141] Setting up conv1
I0924 02:54:54.600831  8337 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0924 02:54:54.600843  8337 net.cpp:156] Memory required for data: 17799480
I0924 02:54:54.600880  8337 layer_factory.hpp:77] Creating layer relu1
I0924 02:54:54.600910  8337 net.cpp:91] Creating Layer relu1
I0924 02:54:54.600926  8337 net.cpp:425] relu1 <- conv1
I0924 02:54:54.600960  8337 net.cpp:386] relu1 -> conv1 (in-place)
I0924 02:54:54.601840  8337 net.cpp:141] Setting up relu1
I0924 02:54:54.601866  8337 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0924 02:54:54.601877  8337 net.cpp:156] Memory required for data: 29415480
I0924 02:54:54.601889  8337 layer_factory.hpp:77] Creating layer pool1
I0924 02:54:54.601924  8337 net.cpp:91] Creating Layer pool1
I0924 02:54:54.601938  8337 net.cpp:425] pool1 <- conv1
I0924 02:54:54.601987  8337 net.cpp:399] pool1 -> pool1
I0924 02:54:54.602164  8337 net.cpp:141] Setting up pool1
I0924 02:54:54.602186  8337 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0924 02:54:54.602197  8337 net.cpp:156] Memory required for data: 32214840
I0924 02:54:54.602208  8337 layer_factory.hpp:77] Creating layer norm1
I0924 02:54:54.602278  8337 net.cpp:91] Creating Layer norm1
I0924 02:54:54.602295  8337 net.cpp:425] norm1 <- pool1
I0924 02:54:54.602311  8337 net.cpp:399] norm1 -> norm1
I0924 02:54:54.603312  8337 net.cpp:141] Setting up norm1
I0924 02:54:54.603335  8337 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0924 02:54:54.603346  8337 net.cpp:156] Memory required for data: 35014200
I0924 02:54:54.603358  8337 layer_factory.hpp:77] Creating layer conv2
I0924 02:54:54.603397  8337 net.cpp:91] Creating Layer conv2
I0924 02:54:54.603412  8337 net.cpp:425] conv2 <- norm1
I0924 02:54:54.603428  8337 net.cpp:399] conv2 -> conv2
I0924 02:54:54.603646  8351 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:54:54.603667  8351 net.cpp:91] Creating Layer lstm2_
I0924 02:54:54.603675  8351 net.cpp:399] lstm2_ -> x
I0924 02:54:54.603693  8351 net.cpp:399] lstm2_ -> cont
I0924 02:54:54.603822  8351 net.cpp:141] Setting up lstm2_
I0924 02:54:54.603835  8351 net.cpp:148] Top shape: 1 1 1501 (1501)
I0924 02:54:54.603843  8351 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.603848  8351 net.cpp:156] Memory required for data: 6008
I0924 02:54:54.603854  8351 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:54:54.603865  8351 net.cpp:91] Creating Layer lstm2_
I0924 02:54:54.603873  8351 net.cpp:399] lstm2_ -> c_0
I0924 02:54:54.603889  8351 net.cpp:399] lstm2_ -> h_0
I0924 02:54:54.605242  8351 net.cpp:141] Setting up lstm2_
I0924 02:54:54.605257  8351 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.605262  8351 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.605268  8351 net.cpp:156] Memory required for data: 14008
I0924 02:54:54.605273  8351 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0924 02:54:54.605284  8351 net.cpp:91] Creating Layer lstm2_cont_slice
I0924 02:54:54.605290  8351 net.cpp:425] lstm2_cont_slice <- cont
I0924 02:54:54.605305  8351 net.cpp:399] lstm2_cont_slice -> cont_1
I0924 02:54:54.605352  8351 net.cpp:141] Setting up lstm2_cont_slice
I0924 02:54:54.605362  8351 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.605367  8351 net.cpp:156] Memory required for data: 14012
I0924 02:54:54.605373  8351 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0924 02:54:54.605382  8351 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0924 02:54:54.605388  8351 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0924 02:54:54.605401  8351 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0924 02:54:54.605410  8351 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0924 02:54:54.605518  8351 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0924 02:54:54.605530  8351 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.605537  8351 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.605542  8351 net.cpp:156] Memory required for data: 14020
I0924 02:54:54.605547  8351 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0924 02:54:54.605563  8351 net.cpp:91] Creating Layer lstm2_x_transform
I0924 02:54:54.605569  8351 net.cpp:425] lstm2_x_transform <- x
I0924 02:54:54.605579  8351 net.cpp:399] lstm2_x_transform -> W_xc_x
I0924 02:54:54.627377  8339 net.cpp:141] Setting up lstm2_x_transform
I0924 02:54:54.627442  8339 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:54.627454  8339 net.cpp:156] Memory required for data: 30020
I0924 02:54:54.627486  8339 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0924 02:54:54.627511  8339 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0924 02:54:54.627522  8339 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0924 02:54:54.627538  8339 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0924 02:54:54.627944  8339 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0924 02:54:54.627964  8339 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:54.627972  8339 net.cpp:156] Memory required for data: 46020
I0924 02:54:54.627981  8339 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0924 02:54:54.628003  8339 net.cpp:91] Creating Layer lstm2_h_conted_0
I0924 02:54:54.628013  8339 net.cpp:425] lstm2_h_conted_0 <- h_0
I0924 02:54:54.628023  8339 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0924 02:54:54.628036  8339 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0924 02:54:54.631430  8339 net.cpp:141] Setting up lstm2_h_conted_0
I0924 02:54:54.631479  8339 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.631489  8339 net.cpp:156] Memory required for data: 50020
I0924 02:54:54.631501  8339 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0924 02:54:54.631531  8339 net.cpp:91] Creating Layer lstm2_transform_1
I0924 02:54:54.631542  8339 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0924 02:54:54.631559  8339 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0924 02:54:54.643883  8357 net.cpp:141] Setting up lstm1_transform_1
I0924 02:54:54.643947  8357 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:54.643959  8357 net.cpp:156] Memory required for data: 62016
I0924 02:54:54.643985  8357 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0924 02:54:54.644011  8357 net.cpp:91] Creating Layer lstm1_gate_input_1
I0924 02:54:54.644023  8357 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0924 02:54:54.644035  8357 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0924 02:54:54.644049  8357 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0924 02:54:54.644989  8357 net.cpp:141] Setting up lstm1_gate_input_1
I0924 02:54:54.645038  8357 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:54.645050  8357 net.cpp:156] Memory required for data: 78016
I0924 02:54:54.645062  8357 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0924 02:54:54.645586  8357 net.cpp:91] Creating Layer lstm1_unit_1
I0924 02:54:54.645611  8357 net.cpp:425] lstm1_unit_1 <- c_0
I0924 02:54:54.645628  8357 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0924 02:54:54.645639  8357 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0924 02:54:54.645654  8357 net.cpp:399] lstm1_unit_1 -> c_1
I0924 02:54:54.645674  8357 net.cpp:399] lstm1_unit_1 -> h_1
I0924 02:54:54.648551  8357 net.cpp:141] Setting up lstm1_unit_1
I0924 02:54:54.648607  8357 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.648624  8357 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.648633  8357 net.cpp:156] Memory required for data: 86016
I0924 02:54:54.648648  8357 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:54:54.648671  8357 net.cpp:91] Creating Layer lstm1_
I0924 02:54:54.648684  8357 net.cpp:425] lstm1_ <- c_1
I0924 02:54:54.648704  8357 net.cpp:399] lstm1_ -> c_T
I0924 02:54:54.651356  8357 net.cpp:141] Setting up lstm1_
I0924 02:54:54.651399  8357 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.651409  8357 net.cpp:156] Memory required for data: 90016
I0924 02:54:54.651420  8357 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0924 02:54:54.651903  8357 net.cpp:91] Creating Layer lstm1_h_concat
I0924 02:54:54.651918  8357 net.cpp:425] lstm1_h_concat <- h_1
I0924 02:54:54.651937  8357 net.cpp:399] lstm1_h_concat -> h
I0924 02:54:54.652040  8357 net.cpp:141] Setting up lstm1_h_concat
I0924 02:54:54.652056  8357 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.652065  8357 net.cpp:156] Memory required for data: 94016
I0924 02:54:54.652073  8357 layer_factory.hpp:77] Creating layer h_pseudoloss
I0924 02:54:54.652089  8357 net.cpp:91] Creating Layer h_pseudoloss
I0924 02:54:54.652098  8357 net.cpp:425] h_pseudoloss <- h
I0924 02:54:54.652544  8357 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0924 02:54:54.652832  8357 net.cpp:141] Setting up h_pseudoloss
I0924 02:54:54.652851  8357 net.cpp:148] Top shape: (1)
I0924 02:54:54.652860  8357 net.cpp:151]     with loss weight 1
I0924 02:54:54.652887  8357 net.cpp:156] Memory required for data: 94020
I0924 02:54:54.652897  8357 net.cpp:217] h_pseudoloss needs backward computation.
I0924 02:54:54.652906  8357 net.cpp:217] lstm1_h_concat needs backward computation.
I0924 02:54:54.652915  8357 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:54:54.652925  8357 net.cpp:217] lstm1_unit_1 needs backward computation.
I0924 02:54:54.652935  8357 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0924 02:54:54.652946  8357 net.cpp:217] lstm1_transform_1 needs backward computation.
I0924 02:54:54.652956  8357 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0924 02:54:54.652966  8357 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0924 02:54:54.652977  8357 net.cpp:217] lstm1_x_transform needs backward computation.
I0924 02:54:54.652987  8357 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0924 02:54:54.652998  8357 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0924 02:54:54.653007  8357 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:54:54.653017  8357 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:54:54.653024  8357 net.cpp:261] This network produces output c_T
I0924 02:54:54.653033  8357 net.cpp:261] This network produces output h_pseudoloss
I0924 02:54:54.653062  8357 net.cpp:274] Network initialization done.
I0924 02:54:54.653143  8357 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0924 02:54:54.653154  8357 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0924 02:54:54.653163  8357 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0924 02:54:54.653338  8357 net.cpp:141] Setting up lstm1
I0924 02:54:54.653357  8357 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.653367  8357 net.cpp:156] Memory required for data: 26408
I0924 02:54:54.653391  8357 layer_factory.hpp:77] Creating layer concat
I0924 02:54:54.653408  8357 net.cpp:91] Creating Layer concat
I0924 02:54:54.653419  8357 net.cpp:425] concat <- lstm1
I0924 02:54:54.653429  8357 net.cpp:425] concat <- embedded_input_sentence
I0924 02:54:54.653439  8357 net.cpp:425] concat <- reshaped_stage_indicator
I0924 02:54:54.653452  8357 net.cpp:399] concat -> lstm1_video_sequence
I0924 02:54:54.653508  8357 net.cpp:141] Setting up concat
I0924 02:54:54.653524  8357 net.cpp:148] Top shape: 1 1 1501 (1501)
I0924 02:54:54.653532  8357 net.cpp:156] Memory required for data: 32412
I0924 02:54:54.653542  8357 layer_factory.hpp:77] Creating layer lstm2
I0924 02:54:54.653564  8357 net.cpp:91] Creating Layer lstm2
I0924 02:54:54.653573  8357 net.cpp:425] lstm2 <- lstm1_video_sequence
I0924 02:54:54.653584  8357 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0924 02:54:54.653596  8357 net.cpp:399] lstm2 -> lstm2
I0924 02:54:54.653614  8357 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0924 02:54:54.654052  8357 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0924 02:54:54.654199  8357 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:54:54.654220  8357 net.cpp:91] Creating Layer lstm2_
I0924 02:54:54.654232  8357 net.cpp:399] lstm2_ -> x
I0924 02:54:54.654249  8357 net.cpp:399] lstm2_ -> cont
I0924 02:54:54.654342  8357 net.cpp:141] Setting up lstm2_
I0924 02:54:54.654361  8357 net.cpp:148] Top shape: 1 1 1501 (1501)
I0924 02:54:54.654372  8357 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.654382  8357 net.cpp:156] Memory required for data: 6008
I0924 02:54:54.654392  8357 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:54:54.654407  8357 net.cpp:91] Creating Layer lstm2_
I0924 02:54:54.654418  8357 net.cpp:399] lstm2_ -> c_0
I0924 02:54:54.654434  8357 net.cpp:399] lstm2_ -> h_0
I0924 02:54:54.654528  8357 net.cpp:141] Setting up lstm2_
I0924 02:54:54.654546  8357 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.654556  8357 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.654563  8357 net.cpp:156] Memory required for data: 14008
I0924 02:54:54.654572  8357 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0924 02:54:54.654587  8357 net.cpp:91] Creating Layer lstm2_cont_slice
I0924 02:54:54.654824  8357 net.cpp:425] lstm2_cont_slice <- cont
I0924 02:54:54.655320  8357 net.cpp:399] lstm2_cont_slice -> cont_1
I0924 02:54:54.655390  8357 net.cpp:141] Setting up lstm2_cont_slice
I0924 02:54:54.655406  8357 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.655414  8357 net.cpp:156] Memory required for data: 14012
I0924 02:54:54.655423  8357 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0924 02:54:54.655437  8357 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0924 02:54:54.655447  8357 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0924 02:54:54.655457  8357 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0924 02:54:54.655472  8357 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0924 02:54:54.655555  8337 net.cpp:141] Setting up conv2
I0924 02:54:54.655575  8337 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0924 02:54:54.655585  8337 net.cpp:156] Memory required for data: 42479160
I0924 02:54:54.655606  8337 layer_factory.hpp:77] Creating layer relu2
I0924 02:54:54.655622  8337 net.cpp:91] Creating Layer relu2
I0924 02:54:54.655632  8337 net.cpp:425] relu2 <- conv2
I0924 02:54:54.655647  8337 net.cpp:386] relu2 -> conv2 (in-place)
I0924 02:54:54.655710  8357 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0924 02:54:54.655725  8357 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.655735  8357 net.cpp:148] Top shape: 1 1 (1)
I0924 02:54:54.655743  8357 net.cpp:156] Memory required for data: 14020
I0924 02:54:54.655751  8357 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0924 02:54:54.655772  8357 net.cpp:91] Creating Layer lstm2_x_transform
I0924 02:54:54.655781  8357 net.cpp:425] lstm2_x_transform <- x
I0924 02:54:54.655794  8357 net.cpp:399] lstm2_x_transform -> W_xc_x
I0924 02:54:54.672705  8351 net.cpp:141] Setting up lstm2_x_transform
I0924 02:54:54.672762  8351 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:54.672775  8351 net.cpp:156] Memory required for data: 30020
I0924 02:54:54.672802  8337 net.cpp:141] Setting up relu2
I0924 02:54:54.672809  8351 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0924 02:54:54.672821  8337 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0924 02:54:54.672830  8337 net.cpp:156] Memory required for data: 49944120
I0924 02:54:54.672835  8351 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0924 02:54:54.672840  8337 layer_factory.hpp:77] Creating layer pool2
I0924 02:54:54.672847  8351 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0924 02:54:54.672863  8337 net.cpp:91] Creating Layer pool2
I0924 02:54:54.672873  8351 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0924 02:54:54.672874  8337 net.cpp:425] pool2 <- conv2
I0924 02:54:54.672899  8337 net.cpp:399] pool2 -> pool2
I0924 02:54:54.672957  8351 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0924 02:54:54.672977  8351 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:54.672987  8351 net.cpp:156] Memory required for data: 46020
I0924 02:54:54.672996  8351 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0924 02:54:54.673015  8351 net.cpp:91] Creating Layer lstm2_h_conted_0
I0924 02:54:54.673027  8351 net.cpp:425] lstm2_h_conted_0 <- h_0
I0924 02:54:54.673039  8351 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0924 02:54:54.673039  8337 net.cpp:141] Setting up pool2
I0924 02:54:54.673055  8337 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0924 02:54:54.673058  8351 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0924 02:54:54.673065  8337 net.cpp:156] Memory required for data: 51674680
I0924 02:54:54.673075  8337 layer_factory.hpp:77] Creating layer norm2
I0924 02:54:54.673105  8337 net.cpp:91] Creating Layer norm2
I0924 02:54:54.673116  8337 net.cpp:425] norm2 <- pool2
I0924 02:54:54.673131  8337 net.cpp:399] norm2 -> norm2
I0924 02:54:54.673476  8351 net.cpp:141] Setting up lstm2_h_conted_0
I0924 02:54:54.673496  8351 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.673506  8351 net.cpp:156] Memory required for data: 50020
I0924 02:54:54.673516  8351 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0924 02:54:54.673543  8351 net.cpp:91] Creating Layer lstm2_transform_1
I0924 02:54:54.673555  8351 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0924 02:54:54.673571  8351 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0924 02:54:54.683117  8339 net.cpp:141] Setting up lstm2_transform_1
I0924 02:54:54.683177  8339 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:54.683184  8339 net.cpp:156] Memory required for data: 66020
I0924 02:54:54.683181  8337 net.cpp:141] Setting up norm2
I0924 02:54:54.683207  8337 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0924 02:54:54.683212  8339 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0924 02:54:54.683214  8337 net.cpp:156] Memory required for data: 53405240
I0924 02:54:54.683230  8337 layer_factory.hpp:77] Creating layer conv3
I0924 02:54:54.683248  8339 net.cpp:91] Creating Layer lstm2_gate_input_1
I0924 02:54:54.683253  8337 net.cpp:91] Creating Layer conv3
I0924 02:54:54.683256  8339 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0924 02:54:54.683260  8337 net.cpp:425] conv3 <- norm2
I0924 02:54:54.683267  8339 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0924 02:54:54.683276  8339 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0924 02:54:54.683297  8337 net.cpp:399] conv3 -> conv3
I0924 02:54:54.683341  8339 net.cpp:141] Setting up lstm2_gate_input_1
I0924 02:54:54.683354  8339 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:54.683359  8339 net.cpp:156] Memory required for data: 82020
I0924 02:54:54.683364  8339 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0924 02:54:54.683375  8339 net.cpp:91] Creating Layer lstm2_unit_1
I0924 02:54:54.683382  8339 net.cpp:425] lstm2_unit_1 <- c_0
I0924 02:54:54.683387  8339 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0924 02:54:54.683393  8339 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0924 02:54:54.683401  8339 net.cpp:399] lstm2_unit_1 -> c_1
I0924 02:54:54.683411  8339 net.cpp:399] lstm2_unit_1 -> h_1
I0924 02:54:54.683671  8339 net.cpp:141] Setting up lstm2_unit_1
I0924 02:54:54.683684  8339 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.683691  8339 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.683696  8339 net.cpp:156] Memory required for data: 90020
I0924 02:54:54.683702  8339 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:54:54.683717  8339 net.cpp:91] Creating Layer lstm2_
I0924 02:54:54.683722  8339 net.cpp:425] lstm2_ <- c_1
I0924 02:54:54.683732  8339 net.cpp:399] lstm2_ -> c_T
I0924 02:54:54.683780  8339 net.cpp:141] Setting up lstm2_
I0924 02:54:54.683791  8339 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.683796  8339 net.cpp:156] Memory required for data: 94020
I0924 02:54:54.683802  8339 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0924 02:54:54.683814  8339 net.cpp:91] Creating Layer lstm2_h_concat
I0924 02:54:54.683818  8339 net.cpp:425] lstm2_h_concat <- h_1
I0924 02:54:54.683830  8339 net.cpp:399] lstm2_h_concat -> h
I0924 02:54:54.686415  8339 net.cpp:141] Setting up lstm2_h_concat
I0924 02:54:54.686473  8339 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.686485  8339 net.cpp:156] Memory required for data: 98020
I0924 02:54:54.686499  8339 layer_factory.hpp:77] Creating layer h_pseudoloss
I0924 02:54:54.686527  8339 net.cpp:91] Creating Layer h_pseudoloss
I0924 02:54:54.686540  8339 net.cpp:425] h_pseudoloss <- h
I0924 02:54:54.686558  8339 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0924 02:54:54.686770  8339 net.cpp:141] Setting up h_pseudoloss
I0924 02:54:54.686790  8339 net.cpp:148] Top shape: (1)
I0924 02:54:54.686800  8339 net.cpp:151]     with loss weight 1
I0924 02:54:54.686825  8339 net.cpp:156] Memory required for data: 98024
I0924 02:54:54.686835  8339 net.cpp:217] h_pseudoloss needs backward computation.
I0924 02:54:54.686844  8339 net.cpp:217] lstm2_h_concat needs backward computation.
I0924 02:54:54.686853  8339 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:54:54.686862  8339 net.cpp:217] lstm2_unit_1 needs backward computation.
I0924 02:54:54.686873  8339 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0924 02:54:54.686883  8339 net.cpp:217] lstm2_transform_1 needs backward computation.
I0924 02:54:54.686893  8339 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0924 02:54:54.686905  8339 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0924 02:54:54.686919  8339 net.cpp:217] lstm2_x_transform needs backward computation.
I0924 02:54:54.686930  8339 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0924 02:54:54.686940  8339 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0924 02:54:54.686950  8339 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:54:54.686959  8339 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:54:54.686966  8339 net.cpp:261] This network produces output c_T
I0924 02:54:54.686975  8339 net.cpp:261] This network produces output h_pseudoloss
I0924 02:54:54.687002  8339 net.cpp:274] Network initialization done.
I0924 02:54:54.687093  8339 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0924 02:54:54.687104  8339 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0924 02:54:54.687113  8339 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0924 02:54:54.687818  8339 net.cpp:141] Setting up lstm2
I0924 02:54:54.687839  8339 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.687846  8339 net.cpp:156] Memory required for data: 36412
I0924 02:54:54.687875  8339 layer_factory.hpp:77] Creating layer predict
I0924 02:54:54.687898  8339 net.cpp:91] Creating Layer predict
I0924 02:54:54.687911  8339 net.cpp:425] predict <- lstm2
I0924 02:54:54.687924  8339 net.cpp:399] predict -> predict
I0924 02:54:54.778687  8351 net.cpp:141] Setting up lstm2_transform_1
I0924 02:54:54.778749  8351 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:54.778756  8351 net.cpp:156] Memory required for data: 66020
I0924 02:54:54.778781  8351 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0924 02:54:54.779217  8351 net.cpp:91] Creating Layer lstm2_gate_input_1
I0924 02:54:54.779229  8351 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0924 02:54:54.779239  8351 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0924 02:54:54.779252  8351 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0924 02:54:54.779404  8351 net.cpp:141] Setting up lstm2_gate_input_1
I0924 02:54:54.779419  8351 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:54.779425  8351 net.cpp:156] Memory required for data: 82020
I0924 02:54:54.779431  8351 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0924 02:54:54.779446  8351 net.cpp:91] Creating Layer lstm2_unit_1
I0924 02:54:54.779453  8351 net.cpp:425] lstm2_unit_1 <- c_0
I0924 02:54:54.779460  8351 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0924 02:54:54.779466  8351 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0924 02:54:54.779474  8351 net.cpp:399] lstm2_unit_1 -> c_1
I0924 02:54:54.779484  8351 net.cpp:399] lstm2_unit_1 -> h_1
I0924 02:54:54.779541  8357 net.cpp:141] Setting up lstm2_x_transform
I0924 02:54:54.779566  8357 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:54.779572  8357 net.cpp:156] Memory required for data: 30020
I0924 02:54:54.779595  8357 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0924 02:54:54.779618  8357 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0924 02:54:54.779628  8357 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0924 02:54:54.779642  8351 net.cpp:141] Setting up lstm2_unit_1
I0924 02:54:54.779644  8357 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0924 02:54:54.779655  8351 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.779662  8351 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.779669  8351 net.cpp:156] Memory required for data: 90020
I0924 02:54:54.779673  8351 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:54:54.779683  8351 net.cpp:91] Creating Layer lstm2_
I0924 02:54:54.779690  8351 net.cpp:425] lstm2_ <- c_1
I0924 02:54:54.779697  8351 net.cpp:399] lstm2_ -> c_T
I0924 02:54:54.779757  8357 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0924 02:54:54.779778  8357 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:54.779788  8357 net.cpp:156] Memory required for data: 46020
I0924 02:54:54.779794  8357 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0924 02:54:54.779808  8357 net.cpp:91] Creating Layer lstm2_h_conted_0
I0924 02:54:54.779815  8357 net.cpp:425] lstm2_h_conted_0 <- h_0
I0924 02:54:54.779827  8357 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0924 02:54:54.779829  8351 net.cpp:141] Setting up lstm2_
I0924 02:54:54.779851  8351 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.779860  8351 net.cpp:156] Memory required for data: 94020
I0924 02:54:54.779866  8351 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0924 02:54:54.779880  8351 net.cpp:91] Creating Layer lstm2_h_concat
I0924 02:54:54.779886  8351 net.cpp:425] lstm2_h_concat <- h_1
I0924 02:54:54.779894  8351 net.cpp:399] lstm2_h_concat -> h
I0924 02:54:54.780289  8357 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0924 02:54:54.780424  8351 net.cpp:141] Setting up lstm2_h_concat
I0924 02:54:54.780447  8351 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.780455  8351 net.cpp:156] Memory required for data: 98020
I0924 02:54:54.780464  8351 layer_factory.hpp:77] Creating layer h_pseudoloss
I0924 02:54:54.780483  8351 net.cpp:91] Creating Layer h_pseudoloss
I0924 02:54:54.780498  8351 net.cpp:425] h_pseudoloss <- h
I0924 02:54:54.780520  8351 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0924 02:54:54.782316  8357 net.cpp:141] Setting up lstm2_h_conted_0
I0924 02:54:54.782371  8357 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.782382  8357 net.cpp:156] Memory required for data: 50020
I0924 02:54:54.782397  8357 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0924 02:54:54.782433  8357 net.cpp:91] Creating Layer lstm2_transform_1
I0924 02:54:54.782444  8357 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0924 02:54:54.782465  8351 net.cpp:141] Setting up h_pseudoloss
I0924 02:54:54.782465  8357 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0924 02:54:54.782506  8351 net.cpp:148] Top shape: (1)
I0924 02:54:54.782518  8351 net.cpp:151]     with loss weight 1
I0924 02:54:54.782546  8351 net.cpp:156] Memory required for data: 98024
I0924 02:54:54.782559  8351 net.cpp:217] h_pseudoloss needs backward computation.
I0924 02:54:54.782570  8351 net.cpp:217] lstm2_h_concat needs backward computation.
I0924 02:54:54.782582  8351 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:54:54.782593  8351 net.cpp:217] lstm2_unit_1 needs backward computation.
I0924 02:54:54.782624  8351 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0924 02:54:54.782636  8351 net.cpp:217] lstm2_transform_1 needs backward computation.
I0924 02:54:54.782652  8351 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0924 02:54:54.782665  8351 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0924 02:54:54.782675  8351 net.cpp:217] lstm2_x_transform needs backward computation.
I0924 02:54:54.782686  8351 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0924 02:54:54.782698  8351 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0924 02:54:54.782708  8351 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:54:54.782714  8351 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:54:54.782719  8351 net.cpp:261] This network produces output c_T
I0924 02:54:54.782729  8351 net.cpp:261] This network produces output h_pseudoloss
I0924 02:54:54.782759  8351 net.cpp:274] Network initialization done.
I0924 02:54:54.782855  8351 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0924 02:54:54.782871  8351 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0924 02:54:54.782881  8351 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0924 02:54:54.792055  8351 net.cpp:141] Setting up lstm2
I0924 02:54:54.792121  8351 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.792131  8351 net.cpp:156] Memory required for data: 36412
I0924 02:54:54.792166  8351 layer_factory.hpp:77] Creating layer predict
I0924 02:54:54.792197  8351 net.cpp:91] Creating Layer predict
I0924 02:54:54.792209  8351 net.cpp:425] predict <- lstm2
I0924 02:54:54.792227  8351 net.cpp:399] predict -> predict
I0924 02:54:54.912226  8357 net.cpp:141] Setting up lstm2_transform_1
I0924 02:54:54.912292  8357 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:54.912300  8357 net.cpp:156] Memory required for data: 66020
I0924 02:54:54.912328  8357 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0924 02:54:54.912551  8357 net.cpp:91] Creating Layer lstm2_gate_input_1
I0924 02:54:54.912570  8357 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0924 02:54:54.912580  8357 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0924 02:54:54.913053  8357 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0924 02:54:54.913054  8337 net.cpp:141] Setting up conv3
I0924 02:54:54.913107  8337 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0924 02:54:54.913115  8337 net.cpp:156] Memory required for data: 56001080
I0924 02:54:54.913138  8337 layer_factory.hpp:77] Creating layer relu3
I0924 02:54:54.913157  8337 net.cpp:91] Creating Layer relu3
I0924 02:54:54.913166  8337 net.cpp:425] relu3 <- conv3
I0924 02:54:54.913180  8337 net.cpp:386] relu3 -> conv3 (in-place)
I0924 02:54:54.913187  8357 net.cpp:141] Setting up lstm2_gate_input_1
I0924 02:54:54.913199  8357 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:54:54.913204  8357 net.cpp:156] Memory required for data: 82020
I0924 02:54:54.913210  8357 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0924 02:54:54.913224  8357 net.cpp:91] Creating Layer lstm2_unit_1
I0924 02:54:54.913230  8357 net.cpp:425] lstm2_unit_1 <- c_0
I0924 02:54:54.913236  8357 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0924 02:54:54.913242  8357 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0924 02:54:54.913249  8357 net.cpp:399] lstm2_unit_1 -> c_1
I0924 02:54:54.913259  8357 net.cpp:399] lstm2_unit_1 -> h_1
I0924 02:54:54.913985  8357 net.cpp:141] Setting up lstm2_unit_1
I0924 02:54:54.913997  8357 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.914005  8357 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.914008  8357 net.cpp:156] Memory required for data: 90020
I0924 02:54:54.914013  8357 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:54:54.914023  8357 net.cpp:91] Creating Layer lstm2_
I0924 02:54:54.914028  8357 net.cpp:425] lstm2_ <- c_1
I0924 02:54:54.914039  8357 net.cpp:399] lstm2_ -> c_T
I0924 02:54:54.914103  8337 net.cpp:141] Setting up relu3
I0924 02:54:54.914124  8357 net.cpp:141] Setting up lstm2_
I0924 02:54:54.914126  8337 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0924 02:54:54.914135  8357 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.914137  8337 net.cpp:156] Memory required for data: 58596920
I0924 02:54:54.914141  8357 net.cpp:156] Memory required for data: 94020
I0924 02:54:54.914146  8337 layer_factory.hpp:77] Creating layer conv4
I0924 02:54:54.914149  8357 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0924 02:54:54.914160  8357 net.cpp:91] Creating Layer lstm2_h_concat
I0924 02:54:54.914165  8357 net.cpp:425] lstm2_h_concat <- h_1
I0924 02:54:54.914172  8337 net.cpp:91] Creating Layer conv4
I0924 02:54:54.914175  8357 net.cpp:399] lstm2_h_concat -> h
I0924 02:54:54.914180  8337 net.cpp:425] conv4 <- conv3
I0924 02:54:54.914191  8337 net.cpp:399] conv4 -> conv4
I0924 02:54:54.914239  8357 net.cpp:141] Setting up lstm2_h_concat
I0924 02:54:54.914252  8357 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.914255  8357 net.cpp:156] Memory required for data: 98020
I0924 02:54:54.914260  8357 layer_factory.hpp:77] Creating layer h_pseudoloss
I0924 02:54:54.914270  8357 net.cpp:91] Creating Layer h_pseudoloss
I0924 02:54:54.914276  8357 net.cpp:425] h_pseudoloss <- h
I0924 02:54:54.914283  8357 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0924 02:54:54.914449  8357 net.cpp:141] Setting up h_pseudoloss
I0924 02:54:54.914466  8357 net.cpp:148] Top shape: (1)
I0924 02:54:54.914474  8357 net.cpp:151]     with loss weight 1
I0924 02:54:54.914489  8357 net.cpp:156] Memory required for data: 98024
I0924 02:54:54.914499  8357 net.cpp:217] h_pseudoloss needs backward computation.
I0924 02:54:54.914506  8357 net.cpp:217] lstm2_h_concat needs backward computation.
I0924 02:54:54.914515  8357 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:54:54.914521  8357 net.cpp:217] lstm2_unit_1 needs backward computation.
I0924 02:54:54.914531  8357 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0924 02:54:54.914541  8357 net.cpp:217] lstm2_transform_1 needs backward computation.
I0924 02:54:54.914554  8357 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0924 02:54:54.914566  8357 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0924 02:54:54.914575  8357 net.cpp:217] lstm2_x_transform needs backward computation.
I0924 02:54:54.914584  8357 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0924 02:54:54.914607  8357 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0924 02:54:54.914618  8357 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:54:54.914626  8357 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:54:54.914633  8357 net.cpp:261] This network produces output c_T
I0924 02:54:54.914641  8357 net.cpp:261] This network produces output h_pseudoloss
I0924 02:54:54.914666  8357 net.cpp:274] Network initialization done.
I0924 02:54:54.914747  8357 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0924 02:54:54.914758  8357 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0924 02:54:54.914765  8357 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0924 02:54:54.917387  8357 net.cpp:141] Setting up lstm2
I0924 02:54:54.917430  8357 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:54:54.917439  8357 net.cpp:156] Memory required for data: 36412
I0924 02:54:54.917469  8357 layer_factory.hpp:77] Creating layer predict
I0924 02:54:54.917495  8357 net.cpp:91] Creating Layer predict
I0924 02:54:54.917505  8357 net.cpp:425] predict <- lstm2
I0924 02:54:54.917521  8357 net.cpp:399] predict -> predict
I0924 02:54:55.018874  8337 net.cpp:141] Setting up conv4
I0924 02:54:55.018937  8337 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0924 02:54:55.018945  8337 net.cpp:156] Memory required for data: 61192760
I0924 02:54:55.018964  8337 layer_factory.hpp:77] Creating layer relu4
I0924 02:54:55.018987  8337 net.cpp:91] Creating Layer relu4
I0924 02:54:55.018996  8337 net.cpp:425] relu4 <- conv4
I0924 02:54:55.019011  8337 net.cpp:386] relu4 -> conv4 (in-place)
I0924 02:54:55.019599  8337 net.cpp:141] Setting up relu4
I0924 02:54:55.019621  8337 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0924 02:54:55.019630  8337 net.cpp:156] Memory required for data: 63788600
I0924 02:54:55.019637  8337 layer_factory.hpp:77] Creating layer conv5
I0924 02:54:55.019661  8337 net.cpp:91] Creating Layer conv5
I0924 02:54:55.019668  8337 net.cpp:425] conv5 <- conv4
I0924 02:54:55.019678  8337 net.cpp:399] conv5 -> conv5
I0924 02:54:55.026772  8337 net.cpp:141] Setting up conv5
I0924 02:54:55.026810  8337 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0924 02:54:55.026818  8337 net.cpp:156] Memory required for data: 65519160
I0924 02:54:55.026839  8337 layer_factory.hpp:77] Creating layer relu5
I0924 02:54:55.026855  8337 net.cpp:91] Creating Layer relu5
I0924 02:54:55.026862  8337 net.cpp:425] relu5 <- conv5
I0924 02:54:55.027400  8337 net.cpp:386] relu5 -> conv5 (in-place)
I0924 02:54:55.028388  8337 net.cpp:141] Setting up relu5
I0924 02:54:55.028406  8337 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0924 02:54:55.028414  8337 net.cpp:156] Memory required for data: 67249720
I0924 02:54:55.028419  8337 layer_factory.hpp:77] Creating layer pool5
I0924 02:54:55.028434  8337 net.cpp:91] Creating Layer pool5
I0924 02:54:55.028439  8337 net.cpp:425] pool5 <- conv5
I0924 02:54:55.028457  8337 net.cpp:399] pool5 -> pool5
I0924 02:54:55.028550  8337 net.cpp:141] Setting up pool5
I0924 02:54:55.028563  8337 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0924 02:54:55.028568  8337 net.cpp:156] Memory required for data: 67618360
I0924 02:54:55.028574  8337 layer_factory.hpp:77] Creating layer fc6
I0924 02:54:55.028611  8337 net.cpp:91] Creating Layer fc6
I0924 02:54:55.028619  8337 net.cpp:425] fc6 <- pool5
I0924 02:54:55.028630  8337 net.cpp:399] fc6 -> fc6
I0924 02:54:55.147056  8337 net.cpp:141] Setting up fc6
I0924 02:54:55.147126  8337 net.cpp:148] Top shape: 10 4096 (40960)
I0924 02:54:55.147137  8337 net.cpp:156] Memory required for data: 67782200
I0924 02:54:55.147164  8337 layer_factory.hpp:77] Creating layer relu6
I0924 02:54:55.147197  8337 net.cpp:91] Creating Layer relu6
I0924 02:54:55.147209  8337 net.cpp:425] relu6 <- fc6
I0924 02:54:55.147258  8337 net.cpp:386] relu6 -> fc6 (in-place)
I0924 02:54:55.148128  8337 net.cpp:141] Setting up relu6
I0924 02:54:55.148156  8337 net.cpp:148] Top shape: 10 4096 (40960)
I0924 02:54:55.148169  8337 net.cpp:156] Memory required for data: 67946040
I0924 02:54:55.148180  8337 layer_factory.hpp:77] Creating layer drop6
I0924 02:54:55.148200  8337 net.cpp:91] Creating Layer drop6
I0924 02:54:55.148211  8337 net.cpp:425] drop6 <- fc6
I0924 02:54:55.148226  8337 net.cpp:386] drop6 -> fc6 (in-place)
I0924 02:54:55.148360  8337 net.cpp:141] Setting up drop6
I0924 02:54:55.148380  8337 net.cpp:148] Top shape: 10 4096 (40960)
I0924 02:54:55.148391  8337 net.cpp:156] Memory required for data: 68109880
I0924 02:54:55.148401  8337 layer_factory.hpp:77] Creating layer fc7
I0924 02:54:55.148422  8337 net.cpp:91] Creating Layer fc7
I0924 02:54:55.148440  8337 net.cpp:425] fc7 <- fc6
I0924 02:54:55.148457  8337 net.cpp:399] fc7 -> fc7
I0924 02:54:55.196648  8339 net.cpp:141] Setting up predict
I0924 02:54:55.196714  8339 net.cpp:148] Top shape: 1 1 46168 (46168)
I0924 02:54:55.196724  8339 net.cpp:156] Memory required for data: 221084
I0924 02:54:55.196745  8339 layer_factory.hpp:77] Creating layer probs
I0924 02:54:55.196771  8339 net.cpp:91] Creating Layer probs
I0924 02:54:55.196784  8339 net.cpp:425] probs <- predict
I0924 02:54:55.196800  8339 net.cpp:399] probs -> probs
I0924 02:54:55.197942  8339 net.cpp:141] Setting up probs
I0924 02:54:55.197986  8339 net.cpp:148] Top shape: 1 1 46168 (46168)
I0924 02:54:55.197998  8339 net.cpp:156] Memory required for data: 405756
I0924 02:54:55.198010  8339 net.cpp:219] probs does not need backward computation.
I0924 02:54:55.198022  8339 net.cpp:219] predict does not need backward computation.
I0924 02:54:55.198034  8339 net.cpp:219] lstm2 does not need backward computation.
I0924 02:54:55.198045  8339 net.cpp:219] concat does not need backward computation.
I0924 02:54:55.198055  8339 net.cpp:219] lstm1 does not need backward computation.
I0924 02:54:55.198065  8339 net.cpp:219] embedding does not need backward computation.
I0924 02:54:55.198076  8339 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0924 02:54:55.198086  8339 net.cpp:219] reshape_frames does not need backward computation.
I0924 02:54:55.198096  8339 net.cpp:219] embed_encoder does not need backward computation.
I0924 02:54:55.198106  8339 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0924 02:54:55.198117  8339 net.cpp:219] input does not need backward computation.
I0924 02:54:55.198125  8339 net.cpp:261] This network produces output probs
I0924 02:54:55.198158  8339 net.cpp:274] Network initialization done.
I0924 02:54:55.201568  8337 net.cpp:141] Setting up fc7
I0924 02:54:55.201637  8337 net.cpp:148] Top shape: 10 4096 (40960)
I0924 02:54:55.201648  8337 net.cpp:156] Memory required for data: 68273720
I0924 02:54:55.201673  8337 layer_factory.hpp:77] Creating layer relu7
I0924 02:54:55.201704  8337 net.cpp:91] Creating Layer relu7
I0924 02:54:55.201716  8337 net.cpp:425] relu7 <- fc7
I0924 02:54:55.201748  8337 net.cpp:386] relu7 -> fc7 (in-place)
I0924 02:54:55.202323  8337 net.cpp:141] Setting up relu7
I0924 02:54:55.202344  8337 net.cpp:148] Top shape: 10 4096 (40960)
I0924 02:54:55.202355  8337 net.cpp:156] Memory required for data: 68437560
I0924 02:54:55.202368  8337 layer_factory.hpp:77] Creating layer drop7
I0924 02:54:55.202396  8337 net.cpp:91] Creating Layer drop7
I0924 02:54:55.202410  8337 net.cpp:425] drop7 <- fc7
I0924 02:54:55.202425  8337 net.cpp:386] drop7 -> fc7 (in-place)
I0924 02:54:55.202533  8337 net.cpp:141] Setting up drop7
I0924 02:54:55.202553  8337 net.cpp:148] Top shape: 10 4096 (40960)
I0924 02:54:55.202564  8337 net.cpp:156] Memory required for data: 68601400
I0924 02:54:55.202575  8337 layer_factory.hpp:77] Creating layer fc8
I0924 02:54:55.202615  8337 net.cpp:91] Creating Layer fc8
I0924 02:54:55.202628  8337 net.cpp:425] fc8 <- fc7
I0924 02:54:55.202652  8337 net.cpp:399] fc8 -> fc8
I0924 02:54:55.213346  8329 net.cpp:752] Ignoring source layer data
I0924 02:54:55.213402  8329 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0924 02:54:55.213409  8329 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0924 02:54:55.217022  8337 net.cpp:141] Setting up fc8
I0924 02:54:55.217092  8337 net.cpp:148] Top shape: 10 1000 (10000)
I0924 02:54:55.217103  8337 net.cpp:156] Memory required for data: 68641400
I0924 02:54:55.217121  8337 layer_factory.hpp:77] Creating layer prob
I0924 02:54:55.217145  8337 net.cpp:91] Creating Layer prob
I0924 02:54:55.217154  8337 net.cpp:425] prob <- fc8
I0924 02:54:55.217173  8337 net.cpp:399] prob -> prob
I0924 02:54:55.218207  8337 net.cpp:141] Setting up prob
I0924 02:54:55.218227  8337 net.cpp:148] Top shape: 10 1000 (10000)
I0924 02:54:55.218233  8337 net.cpp:156] Memory required for data: 68681400
I0924 02:54:55.218240  8337 net.cpp:219] prob does not need backward computation.
I0924 02:54:55.218246  8337 net.cpp:219] fc8 does not need backward computation.
I0924 02:54:55.218252  8337 net.cpp:219] drop7 does not need backward computation.
I0924 02:54:55.218257  8337 net.cpp:219] relu7 does not need backward computation.
I0924 02:54:55.218262  8337 net.cpp:219] fc7 does not need backward computation.
I0924 02:54:55.218268  8337 net.cpp:219] drop6 does not need backward computation.
I0924 02:54:55.218273  8337 net.cpp:219] relu6 does not need backward computation.
I0924 02:54:55.218278  8337 net.cpp:219] fc6 does not need backward computation.
I0924 02:54:55.218283  8337 net.cpp:219] pool5 does not need backward computation.
I0924 02:54:55.218289  8337 net.cpp:219] relu5 does not need backward computation.
I0924 02:54:55.218294  8337 net.cpp:219] conv5 does not need backward computation.
I0924 02:54:55.218300  8337 net.cpp:219] relu4 does not need backward computation.
I0924 02:54:55.218305  8337 net.cpp:219] conv4 does not need backward computation.
I0924 02:54:55.218312  8337 net.cpp:219] relu3 does not need backward computation.
I0924 02:54:55.218317  8337 net.cpp:219] conv3 does not need backward computation.
I0924 02:54:55.218322  8337 net.cpp:219] norm2 does not need backward computation.
I0924 02:54:55.218328  8337 net.cpp:219] pool2 does not need backward computation.
I0924 02:54:55.218333  8337 net.cpp:219] relu2 does not need backward computation.
I0924 02:54:55.218339  8337 net.cpp:219] conv2 does not need backward computation.
I0924 02:54:55.218344  8337 net.cpp:219] norm1 does not need backward computation.
I0924 02:54:55.218350  8337 net.cpp:219] pool1 does not need backward computation.
I0924 02:54:55.218356  8337 net.cpp:219] relu1 does not need backward computation.
I0924 02:54:55.218361  8337 net.cpp:219] conv1 does not need backward computation.
I0924 02:54:55.218367  8337 net.cpp:219] data does not need backward computation.
I0924 02:54:55.218371  8337 net.cpp:261] This network produces output prob
I0924 02:54:55.218395  8337 net.cpp:274] Network initialization done.
I0924 02:54:55.264323  8333 net.cpp:752] Ignoring source layer data
I0924 02:54:55.264375  8333 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0924 02:54:55.264381  8333 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0924 02:54:55.288931  8329 net.cpp:752] Ignoring source layer cross_entropy_loss
I0924 02:54:55.335526  8351 net.cpp:141] Setting up predict
I0924 02:54:55.335583  8351 net.cpp:148] Top shape: 1 1 46168 (46168)
I0924 02:54:55.335592  8351 net.cpp:156] Memory required for data: 221084
I0924 02:54:55.335608  8351 layer_factory.hpp:77] Creating layer probs
I0924 02:54:55.335628  8351 net.cpp:91] Creating Layer probs
I0924 02:54:55.335636  8351 net.cpp:425] probs <- predict
I0924 02:54:55.335649  8351 net.cpp:399] probs -> probs
I0924 02:54:55.336158  8351 net.cpp:141] Setting up probs
I0924 02:54:55.336172  8351 net.cpp:148] Top shape: 1 1 46168 (46168)
I0924 02:54:55.336176  8351 net.cpp:156] Memory required for data: 405756
I0924 02:54:55.336182  8351 net.cpp:219] probs does not need backward computation.
I0924 02:54:55.336189  8351 net.cpp:219] predict does not need backward computation.
I0924 02:54:55.336194  8351 net.cpp:219] lstm2 does not need backward computation.
I0924 02:54:55.336201  8351 net.cpp:219] concat does not need backward computation.
I0924 02:54:55.336208  8351 net.cpp:219] lstm1 does not need backward computation.
I0924 02:54:55.336215  8351 net.cpp:219] embedding does not need backward computation.
I0924 02:54:55.336220  8351 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0924 02:54:55.336225  8351 net.cpp:219] reshape_frames does not need backward computation.
I0924 02:54:55.336231  8351 net.cpp:219] embed_encoder does not need backward computation.
I0924 02:54:55.336237  8351 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0924 02:54:55.336242  8351 net.cpp:219] input does not need backward computation.
I0924 02:54:55.336247  8351 net.cpp:261] This network produces output probs
I0924 02:54:55.336262  8351 net.cpp:274] Network initialization done.
I0924 02:54:55.350761  8333 net.cpp:752] Ignoring source layer cross_entropy_loss
I0924 02:54:55.371537  8357 net.cpp:141] Setting up predict
I0924 02:54:55.371589  8357 net.cpp:148] Top shape: 1 1 46168 (46168)
I0924 02:54:55.371599  8357 net.cpp:156] Memory required for data: 221084
I0924 02:54:55.371620  8357 layer_factory.hpp:77] Creating layer probs
I0924 02:54:55.371645  8357 net.cpp:91] Creating Layer probs
I0924 02:54:55.371656  8357 net.cpp:425] probs <- predict
I0924 02:54:55.371672  8357 net.cpp:399] probs -> probs
I0924 02:54:55.373677  8357 net.cpp:141] Setting up probs
I0924 02:54:55.373702  8357 net.cpp:148] Top shape: 1 1 46168 (46168)
I0924 02:54:55.373711  8357 net.cpp:156] Memory required for data: 405756
I0924 02:54:55.373720  8357 net.cpp:219] probs does not need backward computation.
I0924 02:54:55.373729  8357 net.cpp:219] predict does not need backward computation.
I0924 02:54:55.373738  8357 net.cpp:219] lstm2 does not need backward computation.
I0924 02:54:55.373749  8357 net.cpp:219] concat does not need backward computation.
I0924 02:54:55.373759  8357 net.cpp:219] lstm1 does not need backward computation.
I0924 02:54:55.373769  8357 net.cpp:219] embedding does not need backward computation.
I0924 02:54:55.373780  8357 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0924 02:54:55.373790  8357 net.cpp:219] reshape_frames does not need backward computation.
I0924 02:54:55.373798  8357 net.cpp:219] embed_encoder does not need backward computation.
I0924 02:54:55.373809  8357 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0924 02:54:55.373819  8357 net.cpp:219] input does not need backward computation.
I0924 02:54:55.373827  8357 net.cpp:261] This network produces output probs
I0924 02:54:55.373857  8357 net.cpp:274] Network initialization done.
I0924 02:54:55.492257  8337 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /home/peifeng/work/run/storm102/data/workers/e39af7d8-dc04-4e7a-9b0a-ddc00aed7604/tmp/cvld8340936158615263543/bvlc_reference_caffenet.caffemodel
I0924 02:54:55.492316  8337 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0924 02:54:55.493193  8337 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0924 02:54:55.493214  8337 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /home/peifeng/work/run/storm102/data/workers/e39af7d8-dc04-4e7a-9b0a-ddc00aed7604/tmp/cvld8340936158615263543/bvlc_reference_caffenet.caffemodel
I0924 02:54:55.585517  8339 net.cpp:752] Ignoring source layer data
I0924 02:54:55.585564  8339 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0924 02:54:55.585569  8339 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0924 02:54:55.664448  8339 net.cpp:752] Ignoring source layer cross_entropy_loss
I0924 02:54:55.698417  8351 net.cpp:752] Ignoring source layer data
I0924 02:54:55.698467  8351 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0924 02:54:55.698472  8351 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0924 02:54:55.708293  8357 net.cpp:752] Ignoring source layer data
I0924 02:54:55.708331  8357 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0924 02:54:55.708338  8357 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0924 02:54:55.784149  8351 net.cpp:752] Ignoring source layer cross_entropy_loss
I0924 02:54:55.785387  8357 net.cpp:752] Ignoring source layer cross_entropy_loss
I0924 02:54:55.900401  8337 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0924 02:54:55.957020  8337 net.cpp:752] Ignoring source layer loss
Loading the model + trained: 23934.4ms
Using cv::Size and some other stuff: 0.245ms
Loading the mean file: 36461.6ms
TIMERTIMER 531987572
TIMERTIMER 553396492
TIMERTIMER 455978850
TIMERTIMER 468035649
TIMERTIMER 257558280
#
# A fatal error has been detected by the Java Runtime Environment:
#
#  SIGSEGV (0xb) at pc=0x00007f3d9481d0a0, pid=8259, tid=0x00007f3d35ee4700
#
# JRE version: Java(TM) SE Runtime Environment (8.0_101-b13) (build 1.8.0_101-b13)
# Java VM: Java HotSpot(TM) 64-Bit Server VM (25.101-b13 mixed mode linux-amd64 compressed oops)
# Problematic frame:
# C  [libc.so.6+0x980a0]
#
# Failed to write core dump. Core dumps have been disabled. To enable core dumping, try "ulimit -c unlimited" before starting Java again
#
# An error report file with more information is saved as:
# /home/peifeng/work/run/storm102/data/workers/e39af7d8-dc04-4e7a-9b0a-ddc00aed7604/hs_err_pid8259.log
#
# If you would like to submit a bug report, please visit:
#   http://bugreport.java.com/bugreport/crash.jsp
#
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/peifeng/tools/storm102/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/peifeng/work/run/storm102/data/supervisor/stormdist/captioning-1-1474700043/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /home/peifeng/work/run/storm102/data/workers/c5f829ea-c9d5-475d-9929-7e6ac9a747d8/tmp/cvld1412008837354535561/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0924 02:55:31.043087  8589 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/c5f829ea-c9d5-475d-9929-7e6ac9a747d8/tmp/cvld1412008837354535561/s2vt.words_to_preds.prototxt
I0924 02:55:31.043200  8611 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/c5f829ea-c9d5-475d-9929-7e6ac9a747d8/tmp/cvld1412008837354535561/s2vt.words_to_preds.prototxt
I0924 02:55:31.043213  8589 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
I0924 02:55:31.043218  8617 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/c5f829ea-c9d5-475d-9929-7e6ac9a747d8/tmp/cvld1412008837354535561/s2vt.words_to_preds.prototxt
I0924 02:55:31.043225  8611 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
I0924 02:55:31.043218  8599 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/c5f829ea-c9d5-475d-9929-7e6ac9a747d8/tmp/cvld1412008837354535561/s2vt.words_to_preds.prototxt
W0924 02:55:31.043227  8589 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0924 02:55:31.043268  8599 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0924 02:55:31.043251  8611 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
W0924 02:55:31.043282  8599 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0924 02:55:31.043249  8617 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
I0924 02:55:31.043277  8593 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/c5f829ea-c9d5-475d-9929-7e6ac9a747d8/tmp/cvld1412008837354535561/s2vt.words_to_preds.prototxt
W0924 02:55:31.043298  8617 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0924 02:55:31.043329  8593 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0924 02:55:31.043339  8593 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0924 02:55:31.043431  8597 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0924 02:55:31.043568  8597 layer_factory.hpp:77] Creating layer data
I0924 02:55:31.043596  8597 net.cpp:91] Creating Layer data
I0924 02:55:31.043607  8597 net.cpp:399] data -> data
I0924 02:55:31.043615  8589 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0924 02:55:31.043627  8611 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0924 02:55:31.043628  8617 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0924 02:55:31.043628  8599 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0924 02:55:31.043705  8593 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0924 02:55:31.043774  8611 layer_factory.hpp:77] Creating layer input
I0924 02:55:31.043776  8589 layer_factory.hpp:77] Creating layer input
I0924 02:55:31.043776  8617 layer_factory.hpp:77] Creating layer input
I0924 02:55:31.043799  8611 net.cpp:91] Creating Layer input
I0924 02:55:31.043805  8617 net.cpp:91] Creating Layer input
I0924 02:55:31.043800  8589 net.cpp:91] Creating Layer input
I0924 02:55:31.043818  8611 net.cpp:399] input -> frames_fc7
I0924 02:55:31.043826  8589 net.cpp:399] input -> frames_fc7
I0924 02:55:31.043838  8611 net.cpp:399] input -> cont_sentence
I0924 02:55:31.043848  8589 net.cpp:399] input -> cont_sentence
I0924 02:55:31.043858  8611 net.cpp:399] input -> input_sentence
I0924 02:55:31.043867  8589 net.cpp:399] input -> input_sentence
I0924 02:55:31.043874  8611 net.cpp:399] input -> stage_indicator
I0924 02:55:31.043887  8589 net.cpp:399] input -> stage_indicator
I0924 02:55:31.043902  8617 net.cpp:399] input -> frames_fc7
I0924 02:55:31.043907  8599 layer_factory.hpp:77] Creating layer input
I0924 02:55:31.043925  8599 net.cpp:91] Creating Layer input
I0924 02:55:31.043926  8617 net.cpp:399] input -> cont_sentence
I0924 02:55:31.043942  8599 net.cpp:399] input -> frames_fc7
I0924 02:55:31.043953  8617 net.cpp:399] input -> input_sentence
I0924 02:55:31.043959  8599 net.cpp:399] input -> cont_sentence
I0924 02:55:31.043979  8593 layer_factory.hpp:77] Creating layer input
I0924 02:55:31.043984  8599 net.cpp:399] input -> input_sentence
I0924 02:55:31.043984  8617 net.cpp:399] input -> stage_indicator
I0924 02:55:31.044003  8593 net.cpp:91] Creating Layer input
I0924 02:55:31.044009  8599 net.cpp:399] input -> stage_indicator
I0924 02:55:31.044018  8593 net.cpp:399] input -> frames_fc7
I0924 02:55:31.044042  8593 net.cpp:399] input -> cont_sentence
I0924 02:55:31.044060  8593 net.cpp:399] input -> input_sentence
I0924 02:55:31.044078  8593 net.cpp:399] input -> stage_indicator
I0924 02:55:31.821051  8597 net.cpp:141] Setting up data
I0924 02:55:31.821173  8597 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0924 02:55:31.821182  8597 net.cpp:156] Memory required for data: 6183480
I0924 02:55:31.821210  8597 layer_factory.hpp:77] Creating layer conv1
I0924 02:55:31.821251  8597 net.cpp:91] Creating Layer conv1
I0924 02:55:31.821260  8597 net.cpp:425] conv1 <- data
I0924 02:55:31.821275  8597 net.cpp:399] conv1 -> conv1
I0924 02:55:31.821408  8599 net.cpp:141] Setting up input
I0924 02:55:31.821429  8599 net.cpp:148] Top shape: 1 4096 (4096)
I0924 02:55:31.821436  8599 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:31.821442  8599 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:31.821449  8599 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:31.821452  8599 net.cpp:156] Memory required for data: 16396
I0924 02:55:31.821465  8599 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0924 02:55:31.821477  8589 net.cpp:141] Setting up input
I0924 02:55:31.821488  8599 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0924 02:55:31.821496  8599 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0924 02:55:31.821496  8589 net.cpp:148] Top shape: 1 4096 (4096)
I0924 02:55:31.821504  8589 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:31.821511  8589 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:31.821516  8589 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:31.821519  8599 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0924 02:55:31.821521  8589 net.cpp:156] Memory required for data: 16396
I0924 02:55:31.821528  8589 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0924 02:55:31.821532  8599 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0924 02:55:31.821539  8589 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0924 02:55:31.821545  8589 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0924 02:55:31.821555  8589 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0924 02:55:31.821566  8589 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0924 02:55:31.821575  8593 net.cpp:141] Setting up input
I0924 02:55:31.821614  8593 net.cpp:148] Top shape: 1 4096 (4096)
I0924 02:55:31.821624  8593 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:31.821630  8593 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:31.821641  8593 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:31.821648  8593 net.cpp:156] Memory required for data: 16396
I0924 02:55:31.821657  8593 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0924 02:55:31.821677  8593 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0924 02:55:31.821683  8593 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0924 02:55:31.821698  8593 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0924 02:55:31.821717  8593 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0924 02:55:31.821739  8617 net.cpp:141] Setting up input
I0924 02:55:31.821756  8617 net.cpp:148] Top shape: 1 4096 (4096)
I0924 02:55:31.821764  8617 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:31.821769  8617 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:31.821775  8617 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:31.821779  8617 net.cpp:156] Memory required for data: 16396
I0924 02:55:31.821787  8617 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0924 02:55:31.821796  8593 net.cpp:141] Setting up cont_sentence_input_1_split
I0924 02:55:31.821802  8617 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0924 02:55:31.821810  8593 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:31.821813  8617 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0924 02:55:31.821825  8593 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:31.821828  8617 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0924 02:55:31.821831  8593 net.cpp:156] Memory required for data: 16404
I0924 02:55:31.821852  8593 layer_factory.hpp:77] Creating layer embed_encoder
I0924 02:55:31.821856  8617 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0924 02:55:31.821874  8589 net.cpp:141] Setting up cont_sentence_input_1_split
I0924 02:55:31.821887  8589 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:31.821893  8589 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:31.821897  8589 net.cpp:156] Memory required for data: 16404
I0924 02:55:31.821902  8589 layer_factory.hpp:77] Creating layer embed_encoder
I0924 02:55:31.821960  8599 net.cpp:141] Setting up cont_sentence_input_1_split
I0924 02:55:31.821959  8611 net.cpp:141] Setting up input
I0924 02:55:31.821975  8589 net.cpp:91] Creating Layer embed_encoder
I0924 02:55:31.821982  8599 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:31.821988  8611 net.cpp:148] Top shape: 1 4096 (4096)
I0924 02:55:31.821975  8593 net.cpp:91] Creating Layer embed_encoder
I0924 02:55:31.821990  8589 net.cpp:425] embed_encoder <- frames_fc7
I0924 02:55:31.822003  8611 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:31.822003  8593 net.cpp:425] embed_encoder <- frames_fc7
I0924 02:55:31.822012  8589 net.cpp:399] embed_encoder -> embedded_in_frames
I0924 02:55:31.822015  8611 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:31.821995  8599 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:31.822022  8593 net.cpp:399] embed_encoder -> embedded_in_frames
I0924 02:55:31.822026  8611 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:31.822027  8599 net.cpp:156] Memory required for data: 16404
I0924 02:55:31.822039  8611 net.cpp:156] Memory required for data: 16396
I0924 02:55:31.822042  8599 layer_factory.hpp:77] Creating layer embed_encoder
I0924 02:55:31.822049  8611 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0924 02:55:31.822063  8599 net.cpp:91] Creating Layer embed_encoder
I0924 02:55:31.822067  8611 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0924 02:55:31.822070  8599 net.cpp:425] embed_encoder <- frames_fc7
I0924 02:55:31.822074  8611 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0924 02:55:31.822079  8599 net.cpp:399] embed_encoder -> embedded_in_frames
I0924 02:55:31.822083  8611 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0924 02:55:31.822096  8611 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0924 02:55:31.822162  8617 net.cpp:141] Setting up cont_sentence_input_1_split
I0924 02:55:31.822175  8617 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:31.822182  8617 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:31.822186  8617 net.cpp:156] Memory required for data: 16404
I0924 02:55:31.822191  8617 layer_factory.hpp:77] Creating layer embed_encoder
I0924 02:55:31.822206  8617 net.cpp:91] Creating Layer embed_encoder
I0924 02:55:31.822211  8617 net.cpp:425] embed_encoder <- frames_fc7
I0924 02:55:31.822219  8617 net.cpp:399] embed_encoder -> embedded_in_frames
I0924 02:55:31.840080  8611 net.cpp:141] Setting up cont_sentence_input_1_split
I0924 02:55:31.840143  8611 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:31.840157  8611 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:31.840164  8611 net.cpp:156] Memory required for data: 16404
I0924 02:55:31.840175  8611 layer_factory.hpp:77] Creating layer embed_encoder
I0924 02:55:31.840207  8611 net.cpp:91] Creating Layer embed_encoder
I0924 02:55:31.840220  8611 net.cpp:425] embed_encoder <- frames_fc7
I0924 02:55:31.840242  8611 net.cpp:399] embed_encoder -> embedded_in_frames
I0924 02:55:31.845865  8589 net.cpp:141] Setting up embed_encoder
I0924 02:55:31.845921  8589 net.cpp:148] Top shape: 1 500 (500)
I0924 02:55:31.845928  8589 net.cpp:156] Memory required for data: 18404
I0924 02:55:31.845968  8589 layer_factory.hpp:77] Creating layer reshape_frames
I0924 02:55:31.846006  8589 net.cpp:91] Creating Layer reshape_frames
I0924 02:55:31.846016  8589 net.cpp:425] reshape_frames <- embedded_in_frames
I0924 02:55:31.846029  8589 net.cpp:399] reshape_frames -> embedded_input_frames
I0924 02:55:31.846086  8589 net.cpp:141] Setting up reshape_frames
I0924 02:55:31.846097  8589 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:55:31.846102  8589 net.cpp:156] Memory required for data: 20404
I0924 02:55:31.846108  8589 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0924 02:55:31.846120  8589 net.cpp:91] Creating Layer reshape_stage_indicator
I0924 02:55:31.846127  8589 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0924 02:55:31.846138  8589 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0924 02:55:31.846177  8589 net.cpp:141] Setting up reshape_stage_indicator
I0924 02:55:31.846187  8589 net.cpp:148] Top shape: 1 1 1 (1)
I0924 02:55:31.846194  8589 net.cpp:156] Memory required for data: 20408
I0924 02:55:31.846199  8589 layer_factory.hpp:77] Creating layer embedding
I0924 02:55:31.846217  8589 net.cpp:91] Creating Layer embedding
I0924 02:55:31.846222  8589 net.cpp:425] embedding <- input_sentence
I0924 02:55:31.846233  8589 net.cpp:399] embedding -> embedded_input_sentence
I0924 02:55:31.891196  8617 net.cpp:141] Setting up embed_encoder
I0924 02:55:31.891258  8617 net.cpp:148] Top shape: 1 500 (500)
I0924 02:55:31.891268  8617 net.cpp:156] Memory required for data: 18404
I0924 02:55:31.891301  8617 layer_factory.hpp:77] Creating layer reshape_frames
I0924 02:55:31.891336  8617 net.cpp:91] Creating Layer reshape_frames
I0924 02:55:31.891327  8611 net.cpp:141] Setting up embed_encoder
I0924 02:55:31.891351  8617 net.cpp:425] reshape_frames <- embedded_in_frames
I0924 02:55:31.891366  8611 net.cpp:148] Top shape: 1 500 (500)
I0924 02:55:31.891372  8611 net.cpp:156] Memory required for data: 18404
I0924 02:55:31.891371  8617 net.cpp:399] reshape_frames -> embedded_input_frames
I0924 02:55:31.891393  8611 layer_factory.hpp:77] Creating layer reshape_frames
I0924 02:55:31.891414  8611 net.cpp:91] Creating Layer reshape_frames
I0924 02:55:31.891423  8611 net.cpp:425] reshape_frames <- embedded_in_frames
I0924 02:55:31.891434  8611 net.cpp:399] reshape_frames -> embedded_input_frames
I0924 02:55:31.891459  8617 net.cpp:141] Setting up reshape_frames
I0924 02:55:31.891475  8617 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:55:31.891482  8617 net.cpp:156] Memory required for data: 20404
I0924 02:55:31.891490  8617 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0924 02:55:31.891496  8611 net.cpp:141] Setting up reshape_frames
I0924 02:55:31.891507  8611 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:55:31.891507  8617 net.cpp:91] Creating Layer reshape_stage_indicator
I0924 02:55:31.891511  8611 net.cpp:156] Memory required for data: 20404
I0924 02:55:31.891517  8611 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0924 02:55:31.891518  8617 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0924 02:55:31.891533  8611 net.cpp:91] Creating Layer reshape_stage_indicator
I0924 02:55:31.891536  8617 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0924 02:55:31.891541  8611 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0924 02:55:31.891551  8611 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0924 02:55:31.891614  8617 net.cpp:141] Setting up reshape_stage_indicator
I0924 02:55:31.891633  8617 net.cpp:148] Top shape: 1 1 1 (1)
I0924 02:55:31.891640  8617 net.cpp:156] Memory required for data: 20408
I0924 02:55:31.891650  8617 layer_factory.hpp:77] Creating layer embedding
I0924 02:55:31.891670  8617 net.cpp:91] Creating Layer embedding
I0924 02:55:31.891674  8593 net.cpp:141] Setting up embed_encoder
I0924 02:55:31.891680  8617 net.cpp:425] embedding <- input_sentence
I0924 02:55:31.891715  8593 net.cpp:148] Top shape: 1 500 (500)
I0924 02:55:31.891723  8593 net.cpp:156] Memory required for data: 18404
I0924 02:55:31.891727  8617 net.cpp:399] embedding -> embedded_input_sentence
I0924 02:55:31.891752  8593 layer_factory.hpp:77] Creating layer reshape_frames
I0924 02:55:31.891768  8593 net.cpp:91] Creating Layer reshape_frames
I0924 02:55:31.891782  8593 net.cpp:425] reshape_frames <- embedded_in_frames
I0924 02:55:31.891796  8593 net.cpp:399] reshape_frames -> embedded_input_frames
I0924 02:55:31.895220  8611 net.cpp:141] Setting up reshape_stage_indicator
I0924 02:55:31.895274  8611 net.cpp:148] Top shape: 1 1 1 (1)
I0924 02:55:31.895284  8611 net.cpp:156] Memory required for data: 20408
I0924 02:55:31.895298  8611 layer_factory.hpp:77] Creating layer embedding
I0924 02:55:31.895337  8611 net.cpp:91] Creating Layer embedding
I0924 02:55:31.895351  8611 net.cpp:425] embedding <- input_sentence
I0924 02:55:31.895370  8611 net.cpp:399] embedding -> embedded_input_sentence
I0924 02:55:31.936697  8593 net.cpp:141] Setting up reshape_frames
I0924 02:55:31.936754  8593 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:55:31.936763  8593 net.cpp:156] Memory required for data: 20404
I0924 02:55:31.936774  8593 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0924 02:55:31.936808  8593 net.cpp:91] Creating Layer reshape_stage_indicator
I0924 02:55:31.936820  8593 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0924 02:55:31.936836  8593 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0924 02:55:31.936909  8593 net.cpp:141] Setting up reshape_stage_indicator
I0924 02:55:31.936923  8593 net.cpp:148] Top shape: 1 1 1 (1)
I0924 02:55:31.936929  8593 net.cpp:156] Memory required for data: 20408
I0924 02:55:31.936936  8593 layer_factory.hpp:77] Creating layer embedding
I0924 02:55:31.936956  8593 net.cpp:91] Creating Layer embedding
I0924 02:55:31.936964  8593 net.cpp:425] embedding <- input_sentence
I0924 02:55:31.936976  8593 net.cpp:399] embedding -> embedded_input_sentence
I0924 02:55:32.043067  8599 net.cpp:141] Setting up embed_encoder
I0924 02:55:32.043133  8599 net.cpp:148] Top shape: 1 500 (500)
I0924 02:55:32.043143  8599 net.cpp:156] Memory required for data: 18404
I0924 02:55:32.043175  8599 layer_factory.hpp:77] Creating layer reshape_frames
I0924 02:55:32.043202  8599 net.cpp:91] Creating Layer reshape_frames
I0924 02:55:32.043213  8599 net.cpp:425] reshape_frames <- embedded_in_frames
I0924 02:55:32.043247  8599 net.cpp:399] reshape_frames -> embedded_input_frames
I0924 02:55:32.043349  8599 net.cpp:141] Setting up reshape_frames
I0924 02:55:32.043365  8599 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:55:32.043371  8599 net.cpp:156] Memory required for data: 20404
I0924 02:55:32.043380  8599 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0924 02:55:32.043397  8599 net.cpp:91] Creating Layer reshape_stage_indicator
I0924 02:55:32.043406  8599 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0924 02:55:32.043426  8599 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0924 02:55:32.043479  8599 net.cpp:141] Setting up reshape_stage_indicator
I0924 02:55:32.043493  8599 net.cpp:148] Top shape: 1 1 1 (1)
I0924 02:55:32.043501  8599 net.cpp:156] Memory required for data: 20408
I0924 02:55:32.043511  8599 layer_factory.hpp:77] Creating layer embedding
I0924 02:55:32.043529  8599 net.cpp:91] Creating Layer embedding
I0924 02:55:32.043537  8599 net.cpp:425] embedding <- input_sentence
I0924 02:55:32.043550  8599 net.cpp:399] embedding -> embedded_input_sentence
I0924 02:55:32.128927  8589 net.cpp:141] Setting up embedding
I0924 02:55:32.128983  8589 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:55:32.128990  8589 net.cpp:156] Memory required for data: 22408
I0924 02:55:32.129016  8589 layer_factory.hpp:77] Creating layer lstm1
I0924 02:55:32.129070  8589 net.cpp:91] Creating Layer lstm1
I0924 02:55:32.129082  8589 net.cpp:425] lstm1 <- embedded_input_frames
I0924 02:55:32.129092  8589 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0924 02:55:32.129102  8589 net.cpp:399] lstm1 -> lstm1
I0924 02:55:32.129148  8589 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0924 02:55:32.129567  8589 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0924 02:55:32.129669  8589 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:55:32.129683  8589 net.cpp:91] Creating Layer lstm1_
I0924 02:55:32.129689  8589 net.cpp:399] lstm1_ -> x
I0924 02:55:32.129701  8589 net.cpp:399] lstm1_ -> cont
I0924 02:55:32.131759  8589 net.cpp:141] Setting up lstm1_
I0924 02:55:32.131783  8589 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:55:32.131791  8589 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.131795  8589 net.cpp:156] Memory required for data: 2004
I0924 02:55:32.131803  8589 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:55:32.131816  8589 net.cpp:91] Creating Layer lstm1_
I0924 02:55:32.131826  8589 net.cpp:399] lstm1_ -> c_0
I0924 02:55:32.131841  8589 net.cpp:399] lstm1_ -> h_0
I0924 02:55:32.133579  8589 net.cpp:141] Setting up lstm1_
I0924 02:55:32.133602  8589 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.133610  8589 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.133613  8589 net.cpp:156] Memory required for data: 10004
I0924 02:55:32.133620  8589 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0924 02:55:32.133632  8589 net.cpp:91] Creating Layer lstm1_cont_slice
I0924 02:55:32.133637  8589 net.cpp:425] lstm1_cont_slice <- cont
I0924 02:55:32.133646  8589 net.cpp:399] lstm1_cont_slice -> cont_1
I0924 02:55:32.141492  8589 net.cpp:141] Setting up lstm1_cont_slice
I0924 02:55:32.141535  8589 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.141541  8589 net.cpp:156] Memory required for data: 10008
I0924 02:55:32.141548  8589 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0924 02:55:32.141563  8589 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0924 02:55:32.141572  8589 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0924 02:55:32.141582  8589 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0924 02:55:32.141595  8589 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0924 02:55:32.141669  8589 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0924 02:55:32.141680  8589 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.141686  8589 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.141690  8589 net.cpp:156] Memory required for data: 10016
I0924 02:55:32.141695  8589 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0924 02:55:32.141711  8589 net.cpp:91] Creating Layer lstm1_x_transform
I0924 02:55:32.141717  8589 net.cpp:425] lstm1_x_transform <- x
I0924 02:55:32.141731  8589 net.cpp:399] lstm1_x_transform -> W_xc_x
I0924 02:55:32.145769  8617 net.cpp:141] Setting up embedding
I0924 02:55:32.145808  8617 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:55:32.145814  8617 net.cpp:156] Memory required for data: 22408
I0924 02:55:32.145833  8617 layer_factory.hpp:77] Creating layer lstm1
I0924 02:55:32.145853  8617 net.cpp:91] Creating Layer lstm1
I0924 02:55:32.145860  8617 net.cpp:425] lstm1 <- embedded_input_frames
I0924 02:55:32.145869  8617 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0924 02:55:32.145879  8617 net.cpp:399] lstm1 -> lstm1
I0924 02:55:32.145895  8617 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0924 02:55:32.146185  8617 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0924 02:55:32.146309  8617 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:55:32.146325  8617 net.cpp:91] Creating Layer lstm1_
I0924 02:55:32.146332  8617 net.cpp:399] lstm1_ -> x
I0924 02:55:32.146345  8617 net.cpp:399] lstm1_ -> cont
I0924 02:55:32.148427  8617 net.cpp:141] Setting up lstm1_
I0924 02:55:32.148452  8617 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:55:32.148458  8617 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.148463  8617 net.cpp:156] Memory required for data: 2004
I0924 02:55:32.148469  8617 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:55:32.148483  8617 net.cpp:91] Creating Layer lstm1_
I0924 02:55:32.148496  8617 net.cpp:399] lstm1_ -> c_0
I0924 02:55:32.148509  8617 net.cpp:399] lstm1_ -> h_0
I0924 02:55:32.149430  8617 net.cpp:141] Setting up lstm1_
I0924 02:55:32.149444  8617 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.149451  8617 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.149454  8617 net.cpp:156] Memory required for data: 10004
I0924 02:55:32.149459  8617 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0924 02:55:32.149471  8617 net.cpp:91] Creating Layer lstm1_cont_slice
I0924 02:55:32.149476  8617 net.cpp:425] lstm1_cont_slice <- cont
I0924 02:55:32.149487  8617 net.cpp:399] lstm1_cont_slice -> cont_1
I0924 02:55:32.149602  8617 net.cpp:141] Setting up lstm1_cont_slice
I0924 02:55:32.149613  8617 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.149617  8617 net.cpp:156] Memory required for data: 10008
I0924 02:55:32.149622  8617 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0924 02:55:32.149633  8617 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0924 02:55:32.149639  8617 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0924 02:55:32.149646  8617 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0924 02:55:32.149655  8617 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0924 02:55:32.150472  8617 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0924 02:55:32.150488  8617 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.150499  8617 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.150506  8617 net.cpp:156] Memory required for data: 10016
I0924 02:55:32.150514  8617 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0924 02:55:32.150533  8617 net.cpp:91] Creating Layer lstm1_x_transform
I0924 02:55:32.150542  8617 net.cpp:425] lstm1_x_transform <- x
I0924 02:55:32.150555  8617 net.cpp:399] lstm1_x_transform -> W_xc_x
I0924 02:55:32.163599  8589 net.cpp:141] Setting up lstm1_x_transform
I0924 02:55:32.163657  8589 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.163673  8589 net.cpp:156] Memory required for data: 26016
I0924 02:55:32.163749  8589 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0924 02:55:32.163782  8589 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0924 02:55:32.163796  8589 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0924 02:55:32.163813  8589 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0924 02:55:32.164682  8589 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0924 02:55:32.164718  8589 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.164733  8589 net.cpp:156] Memory required for data: 42016
I0924 02:55:32.164747  8589 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0924 02:55:32.164849  8589 net.cpp:91] Creating Layer lstm1_h_conted_0
I0924 02:55:32.164865  8589 net.cpp:425] lstm1_h_conted_0 <- h_0
I0924 02:55:32.164886  8589 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0924 02:55:32.164902  8589 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0924 02:55:32.186966  8589 net.cpp:141] Setting up lstm1_h_conted_0
I0924 02:55:32.187052  8589 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.187055  8611 net.cpp:141] Setting up embedding
I0924 02:55:32.187062  8589 net.cpp:156] Memory required for data: 46016
I0924 02:55:32.187085  8611 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:55:32.187088  8589 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0924 02:55:32.187094  8611 net.cpp:156] Memory required for data: 22408
I0924 02:55:32.187117  8611 layer_factory.hpp:77] Creating layer lstm1
I0924 02:55:32.187119  8589 net.cpp:91] Creating Layer lstm1_transform_1
I0924 02:55:32.187131  8589 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0924 02:55:32.187140  8611 net.cpp:91] Creating Layer lstm1
I0924 02:55:32.187150  8589 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0924 02:55:32.187250  8617 net.cpp:141] Setting up lstm1_x_transform
I0924 02:55:32.187274  8617 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.187283  8617 net.cpp:156] Memory required for data: 26016
I0924 02:55:32.187301  8617 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0924 02:55:32.187317  8617 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0924 02:55:32.187326  8617 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0924 02:55:32.187340  8617 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0924 02:55:32.187151  8611 net.cpp:425] lstm1 <- embedded_input_frames
I0924 02:55:32.192487  8611 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0924 02:55:32.192536  8611 net.cpp:399] lstm1 -> lstm1
I0924 02:55:32.192566  8611 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0924 02:55:32.192993  8611 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0924 02:55:32.193135  8611 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:55:32.193156  8611 net.cpp:91] Creating Layer lstm1_
I0924 02:55:32.193167  8611 net.cpp:399] lstm1_ -> x
I0924 02:55:32.193186  8611 net.cpp:399] lstm1_ -> cont
I0924 02:55:32.197319  8617 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0924 02:55:32.197357  8617 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.197366  8617 net.cpp:156] Memory required for data: 42016
I0924 02:55:32.197378  8617 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0924 02:55:32.197399  8617 net.cpp:91] Creating Layer lstm1_h_conted_0
I0924 02:55:32.197410  8617 net.cpp:425] lstm1_h_conted_0 <- h_0
I0924 02:55:32.197413  8611 net.cpp:141] Setting up lstm1_
I0924 02:55:32.197422  8617 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0924 02:55:32.197432  8611 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:55:32.197435  8617 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0924 02:55:32.197439  8611 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.197444  8611 net.cpp:156] Memory required for data: 2004
I0924 02:55:32.197450  8611 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:55:32.197464  8611 net.cpp:91] Creating Layer lstm1_
I0924 02:55:32.197474  8611 net.cpp:399] lstm1_ -> c_0
I0924 02:55:32.197489  8611 net.cpp:399] lstm1_ -> h_0
I0924 02:55:32.197609  8611 net.cpp:141] Setting up lstm1_
I0924 02:55:32.197623  8611 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.197628  8611 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.197633  8611 net.cpp:156] Memory required for data: 10004
I0924 02:55:32.197638  8611 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0924 02:55:32.197649  8611 net.cpp:91] Creating Layer lstm1_cont_slice
I0924 02:55:32.197654  8611 net.cpp:425] lstm1_cont_slice <- cont
I0924 02:55:32.197661  8611 net.cpp:399] lstm1_cont_slice -> cont_1
I0924 02:55:32.197659  8617 net.cpp:141] Setting up lstm1_h_conted_0
I0924 02:55:32.197676  8617 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.197684  8617 net.cpp:156] Memory required for data: 46016
I0924 02:55:32.197691  8617 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0924 02:55:32.197705  8611 net.cpp:141] Setting up lstm1_cont_slice
I0924 02:55:32.197710  8617 net.cpp:91] Creating Layer lstm1_transform_1
I0924 02:55:32.197715  8611 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.197718  8611 net.cpp:156] Memory required for data: 10008
I0924 02:55:32.197718  8617 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0924 02:55:32.197723  8611 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0924 02:55:32.197734  8611 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0924 02:55:32.197732  8617 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0924 02:55:32.197754  8611 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0924 02:55:32.197772  8611 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0924 02:55:32.197780  8611 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0924 02:55:32.198137  8611 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0924 02:55:32.198148  8611 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.198155  8611 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.198160  8611 net.cpp:156] Memory required for data: 10016
I0924 02:55:32.198165  8611 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0924 02:55:32.198177  8611 net.cpp:91] Creating Layer lstm1_x_transform
I0924 02:55:32.198182  8611 net.cpp:425] lstm1_x_transform <- x
I0924 02:55:32.198194  8611 net.cpp:399] lstm1_x_transform -> W_xc_x
I0924 02:55:32.219427  8593 net.cpp:141] Setting up embedding
I0924 02:55:32.219470  8593 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:55:32.219476  8593 net.cpp:156] Memory required for data: 22408
I0924 02:55:32.219493  8593 layer_factory.hpp:77] Creating layer lstm1
I0924 02:55:32.219516  8593 net.cpp:91] Creating Layer lstm1
I0924 02:55:32.219523  8593 net.cpp:425] lstm1 <- embedded_input_frames
I0924 02:55:32.219532  8593 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0924 02:55:32.219543  8593 net.cpp:399] lstm1 -> lstm1
I0924 02:55:32.219560  8593 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0924 02:55:32.219838  8593 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0924 02:55:32.219931  8593 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:55:32.219944  8593 net.cpp:91] Creating Layer lstm1_
I0924 02:55:32.219951  8593 net.cpp:399] lstm1_ -> x
I0924 02:55:32.219964  8593 net.cpp:399] lstm1_ -> cont
I0924 02:55:32.220026  8593 net.cpp:141] Setting up lstm1_
I0924 02:55:32.220036  8593 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:55:32.220041  8593 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.220046  8593 net.cpp:156] Memory required for data: 2004
I0924 02:55:32.220052  8593 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:55:32.220063  8593 net.cpp:91] Creating Layer lstm1_
I0924 02:55:32.220072  8593 net.cpp:399] lstm1_ -> c_0
I0924 02:55:32.220082  8593 net.cpp:399] lstm1_ -> h_0
I0924 02:55:32.220129  8593 net.cpp:141] Setting up lstm1_
I0924 02:55:32.220140  8593 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.220147  8593 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.220151  8593 net.cpp:156] Memory required for data: 10004
I0924 02:55:32.220156  8593 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0924 02:55:32.220165  8593 net.cpp:91] Creating Layer lstm1_cont_slice
I0924 02:55:32.220170  8593 net.cpp:425] lstm1_cont_slice <- cont
I0924 02:55:32.220177  8593 net.cpp:399] lstm1_cont_slice -> cont_1
I0924 02:55:32.220216  8593 net.cpp:141] Setting up lstm1_cont_slice
I0924 02:55:32.220224  8593 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.220228  8593 net.cpp:156] Memory required for data: 10008
I0924 02:55:32.220233  8593 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0924 02:55:32.220242  8593 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0924 02:55:32.220247  8593 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0924 02:55:32.220257  8593 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0924 02:55:32.220265  8593 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0924 02:55:32.220311  8593 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0924 02:55:32.220320  8593 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.220326  8593 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.220331  8593 net.cpp:156] Memory required for data: 10016
I0924 02:55:32.220336  8593 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0924 02:55:32.220346  8593 net.cpp:91] Creating Layer lstm1_x_transform
I0924 02:55:32.220351  8593 net.cpp:425] lstm1_x_transform <- x
I0924 02:55:32.220361  8593 net.cpp:399] lstm1_x_transform -> W_xc_x
I0924 02:55:32.236637  8589 net.cpp:141] Setting up lstm1_transform_1
I0924 02:55:32.236688  8589 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.236699  8589 net.cpp:156] Memory required for data: 62016
I0924 02:55:32.236726  8589 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0924 02:55:32.236754  8589 net.cpp:91] Creating Layer lstm1_gate_input_1
I0924 02:55:32.236765  8589 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0924 02:55:32.236776  8589 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0924 02:55:32.236793  8589 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0924 02:55:32.237807  8589 net.cpp:141] Setting up lstm1_gate_input_1
I0924 02:55:32.237830  8589 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.237838  8589 net.cpp:156] Memory required for data: 78016
I0924 02:55:32.237846  8589 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0924 02:55:32.237867  8589 net.cpp:91] Creating Layer lstm1_unit_1
I0924 02:55:32.237875  8589 net.cpp:425] lstm1_unit_1 <- c_0
I0924 02:55:32.237887  8589 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0924 02:55:32.237896  8589 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0924 02:55:32.237895  8611 net.cpp:141] Setting up lstm1_x_transform
I0924 02:55:32.237908  8589 net.cpp:399] lstm1_unit_1 -> c_1
I0924 02:55:32.237916  8611 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.237924  8589 net.cpp:399] lstm1_unit_1 -> h_1
I0924 02:55:32.237926  8611 net.cpp:156] Memory required for data: 26016
I0924 02:55:32.237957  8611 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0924 02:55:32.237973  8611 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0924 02:55:32.237983  8611 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0924 02:55:32.237999  8611 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0924 02:55:32.241539  8611 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0924 02:55:32.241572  8611 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.241581  8611 net.cpp:156] Memory required for data: 42016
I0924 02:55:32.241592  8611 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0924 02:55:32.241613  8611 net.cpp:91] Creating Layer lstm1_h_conted_0
I0924 02:55:32.241622  8611 net.cpp:425] lstm1_h_conted_0 <- h_0
I0924 02:55:32.241634  8611 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0924 02:55:32.241647  8611 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0924 02:55:32.241776  8589 net.cpp:141] Setting up lstm1_unit_1
I0924 02:55:32.241796  8589 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.241808  8589 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.241816  8589 net.cpp:156] Memory required for data: 86016
I0924 02:55:32.241824  8589 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:55:32.241838  8589 net.cpp:91] Creating Layer lstm1_
I0924 02:55:32.241847  8589 net.cpp:425] lstm1_ <- c_1
I0924 02:55:32.241864  8589 net.cpp:399] lstm1_ -> c_T
I0924 02:55:32.241946  8593 net.cpp:141] Setting up lstm1_x_transform
I0924 02:55:32.241984  8593 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.241991  8593 net.cpp:156] Memory required for data: 26016
I0924 02:55:32.241991  8589 net.cpp:141] Setting up lstm1_
I0924 02:55:32.242007  8589 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.242012  8593 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0924 02:55:32.242017  8589 net.cpp:156] Memory required for data: 90016
I0924 02:55:32.242025  8589 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0924 02:55:32.242027  8593 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0924 02:55:32.242051  8589 net.cpp:91] Creating Layer lstm1_h_concat
I0924 02:55:32.242053  8593 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0924 02:55:32.242068  8589 net.cpp:425] lstm1_h_concat <- h_1
I0924 02:55:32.242079  8593 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0924 02:55:32.242080  8589 net.cpp:399] lstm1_h_concat -> h
I0924 02:55:32.242087  8611 net.cpp:141] Setting up lstm1_h_conted_0
I0924 02:55:32.242105  8611 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.242113  8611 net.cpp:156] Memory required for data: 46016
I0924 02:55:32.242121  8611 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0924 02:55:32.242139  8611 net.cpp:91] Creating Layer lstm1_transform_1
I0924 02:55:32.242141  8593 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0924 02:55:32.242147  8611 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0924 02:55:32.242153  8593 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.242158  8593 net.cpp:156] Memory required for data: 42016
I0924 02:55:32.242163  8593 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0924 02:55:32.242167  8611 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0924 02:55:32.242174  8593 net.cpp:91] Creating Layer lstm1_h_conted_0
I0924 02:55:32.242180  8593 net.cpp:425] lstm1_h_conted_0 <- h_0
I0924 02:55:32.242187  8593 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0924 02:55:32.242194  8593 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0924 02:55:32.242199  8589 net.cpp:141] Setting up lstm1_h_concat
I0924 02:55:32.242215  8589 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.242223  8589 net.cpp:156] Memory required for data: 94016
I0924 02:55:32.242231  8589 layer_factory.hpp:77] Creating layer h_pseudoloss
I0924 02:55:32.242254  8589 net.cpp:91] Creating Layer h_pseudoloss
I0924 02:55:32.242262  8589 net.cpp:425] h_pseudoloss <- h
I0924 02:55:32.242274  8589 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0924 02:55:32.252507  8589 net.cpp:141] Setting up h_pseudoloss
I0924 02:55:32.252493  8593 net.cpp:141] Setting up lstm1_h_conted_0
I0924 02:55:32.252547  8593 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.252547  8589 net.cpp:148] Top shape: (1)
I0924 02:55:32.252560  8593 net.cpp:156] Memory required for data: 46016
I0924 02:55:32.252573  8593 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0924 02:55:32.252602  8593 net.cpp:91] Creating Layer lstm1_transform_1
I0924 02:55:32.252593  8617 net.cpp:141] Setting up lstm1_transform_1
I0924 02:55:32.252564  8589 net.cpp:151]     with loss weight 1
I0924 02:55:32.252614  8593 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0924 02:55:32.252643  8589 net.cpp:156] Memory required for data: 94020
I0924 02:55:32.252645  8617 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.252655  8589 net.cpp:217] h_pseudoloss needs backward computation.
I0924 02:55:32.252657  8617 net.cpp:156] Memory required for data: 62016
I0924 02:55:32.252665  8593 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0924 02:55:32.252682  8589 net.cpp:217] lstm1_h_concat needs backward computation.
I0924 02:55:32.252686  8617 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0924 02:55:32.252714  8589 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:55:32.252724  8589 net.cpp:217] lstm1_unit_1 needs backward computation.
I0924 02:55:32.252740  8589 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0924 02:55:32.252744  8617 net.cpp:91] Creating Layer lstm1_gate_input_1
I0924 02:55:32.252748  8589 net.cpp:217] lstm1_transform_1 needs backward computation.
I0924 02:55:32.252763  8617 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0924 02:55:32.252771  8589 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0924 02:55:32.252777  8617 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0924 02:55:32.252785  8589 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0924 02:55:32.252794  8617 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0924 02:55:32.252817  8589 net.cpp:217] lstm1_x_transform needs backward computation.
I0924 02:55:32.252841  8589 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0924 02:55:32.252849  8589 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0924 02:55:32.252856  8589 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:55:32.252861  8589 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:55:32.252866  8589 net.cpp:261] This network produces output c_T
I0924 02:55:32.252871  8589 net.cpp:261] This network produces output h_pseudoloss
I0924 02:55:32.252892  8589 net.cpp:274] Network initialization done.
I0924 02:55:32.252964  8589 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0924 02:55:32.252970  8589 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0924 02:55:32.252975  8589 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0924 02:55:32.260926  8617 net.cpp:141] Setting up lstm1_gate_input_1
I0924 02:55:32.260980  8617 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.260987  8617 net.cpp:156] Memory required for data: 78016
I0924 02:55:32.260998  8617 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0924 02:55:32.261015  8617 net.cpp:91] Creating Layer lstm1_unit_1
I0924 02:55:32.261023  8617 net.cpp:425] lstm1_unit_1 <- c_0
I0924 02:55:32.261034  8617 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0924 02:55:32.261040  8617 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0924 02:55:32.261049  8617 net.cpp:399] lstm1_unit_1 -> c_1
I0924 02:55:32.261062  8617 net.cpp:399] lstm1_unit_1 -> h_1
I0924 02:55:32.261167  8617 net.cpp:141] Setting up lstm1_unit_1
I0924 02:55:32.261176  8617 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.261183  8617 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.261188  8617 net.cpp:156] Memory required for data: 86016
I0924 02:55:32.261193  8617 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:55:32.261204  8617 net.cpp:91] Creating Layer lstm1_
I0924 02:55:32.261209  8617 net.cpp:425] lstm1_ <- c_1
I0924 02:55:32.261216  8617 net.cpp:399] lstm1_ -> c_T
I0924 02:55:32.261262  8617 net.cpp:141] Setting up lstm1_
I0924 02:55:32.261277  8617 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.261282  8617 net.cpp:156] Memory required for data: 90016
I0924 02:55:32.261287  8617 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0924 02:55:32.261297  8617 net.cpp:91] Creating Layer lstm1_h_concat
I0924 02:55:32.261303  8617 net.cpp:425] lstm1_h_concat <- h_1
I0924 02:55:32.261313  8617 net.cpp:399] lstm1_h_concat -> h
I0924 02:55:32.261247  8589 net.cpp:141] Setting up lstm1
I0924 02:55:32.262043  8589 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.262055  8589 net.cpp:156] Memory required for data: 26408
I0924 02:55:32.262112  8589 layer_factory.hpp:77] Creating layer concat
I0924 02:55:32.262176  8589 net.cpp:91] Creating Layer concat
I0924 02:55:32.262192  8589 net.cpp:425] concat <- lstm1
I0924 02:55:32.262228  8589 net.cpp:425] concat <- embedded_input_sentence
I0924 02:55:32.262241  8589 net.cpp:425] concat <- reshaped_stage_indicator
I0924 02:55:32.262256  8589 net.cpp:399] concat -> lstm1_video_sequence
I0924 02:55:32.274902  8617 net.cpp:141] Setting up lstm1_h_concat
I0924 02:55:32.274929  8589 net.cpp:141] Setting up concat
I0924 02:55:32.274966  8617 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.274968  8589 net.cpp:148] Top shape: 1 1 1501 (1501)
I0924 02:55:32.274977  8617 net.cpp:156] Memory required for data: 94016
I0924 02:55:32.274978  8589 net.cpp:156] Memory required for data: 32412
I0924 02:55:32.274996  8617 layer_factory.hpp:77] Creating layer h_pseudoloss
I0924 02:55:32.274999  8589 layer_factory.hpp:77] Creating layer lstm2
I0924 02:55:32.275022  8617 net.cpp:91] Creating Layer h_pseudoloss
I0924 02:55:32.275033  8617 net.cpp:425] h_pseudoloss <- h
I0924 02:55:32.275051  8617 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0924 02:55:32.275086  8589 net.cpp:91] Creating Layer lstm2
I0924 02:55:32.275120  8589 net.cpp:425] lstm2 <- lstm1_video_sequence
I0924 02:55:32.275132  8589 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0924 02:55:32.275151  8589 net.cpp:399] lstm2 -> lstm2
I0924 02:55:32.275172  8589 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0924 02:55:32.275475  8589 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0924 02:55:32.275570  8589 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:55:32.275583  8589 net.cpp:91] Creating Layer lstm2_
I0924 02:55:32.275590  8589 net.cpp:399] lstm2_ -> x
I0924 02:55:32.275602  8589 net.cpp:399] lstm2_ -> cont
I0924 02:55:32.281419  8589 net.cpp:141] Setting up lstm2_
I0924 02:55:32.281457  8589 net.cpp:148] Top shape: 1 1 1501 (1501)
I0924 02:55:32.281472  8589 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.281481  8589 net.cpp:156] Memory required for data: 6008
I0924 02:55:32.281493  8589 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:55:32.281524  8589 net.cpp:91] Creating Layer lstm2_
I0924 02:55:32.281538  8589 net.cpp:399] lstm2_ -> c_0
I0924 02:55:32.281560  8617 net.cpp:141] Setting up h_pseudoloss
I0924 02:55:32.281561  8589 net.cpp:399] lstm2_ -> h_0
I0924 02:55:32.281622  8617 net.cpp:148] Top shape: (1)
I0924 02:55:32.281635  8617 net.cpp:151]     with loss weight 1
I0924 02:55:32.281659  8617 net.cpp:156] Memory required for data: 94020
I0924 02:55:32.281672  8617 net.cpp:217] h_pseudoloss needs backward computation.
I0924 02:55:32.281683  8617 net.cpp:217] lstm1_h_concat needs backward computation.
I0924 02:55:32.281694  8617 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:55:32.281704  8617 net.cpp:217] lstm1_unit_1 needs backward computation.
I0924 02:55:32.281718  8617 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0924 02:55:32.281730  8617 net.cpp:217] lstm1_transform_1 needs backward computation.
I0924 02:55:32.281743  8617 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0924 02:55:32.281761  8617 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0924 02:55:32.281772  8617 net.cpp:217] lstm1_x_transform needs backward computation.
I0924 02:55:32.281785  8617 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0924 02:55:32.281796  8617 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0924 02:55:32.281808  8617 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:55:32.281817  8617 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:55:32.281826  8617 net.cpp:261] This network produces output c_T
I0924 02:55:32.281836  8617 net.cpp:261] This network produces output h_pseudoloss
I0924 02:55:32.281864  8617 net.cpp:274] Network initialization done.
I0924 02:55:32.281967  8617 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0924 02:55:32.281981  8617 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0924 02:55:32.281992  8617 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0924 02:55:32.285768  8589 net.cpp:141] Setting up lstm2_
I0924 02:55:32.285787  8589 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.285794  8589 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.285799  8589 net.cpp:156] Memory required for data: 14008
I0924 02:55:32.285804  8589 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0924 02:55:32.285817  8589 net.cpp:91] Creating Layer lstm2_cont_slice
I0924 02:55:32.285823  8589 net.cpp:425] lstm2_cont_slice <- cont
I0924 02:55:32.285832  8589 net.cpp:399] lstm2_cont_slice -> cont_1
I0924 02:55:32.285934  8589 net.cpp:141] Setting up lstm2_cont_slice
I0924 02:55:32.285948  8589 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.285953  8589 net.cpp:156] Memory required for data: 14012
I0924 02:55:32.285959  8589 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0924 02:55:32.285967  8589 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0924 02:55:32.285974  8589 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0924 02:55:32.285984  8589 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0924 02:55:32.285980  8611 net.cpp:141] Setting up lstm1_transform_1
I0924 02:55:32.285993  8589 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0924 02:55:32.286000  8611 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.286005  8611 net.cpp:156] Memory required for data: 62016
I0924 02:55:32.286031  8611 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0924 02:55:32.286056  8611 net.cpp:91] Creating Layer lstm1_gate_input_1
I0924 02:55:32.286056  8617 net.cpp:141] Setting up lstm1
I0924 02:55:32.286062  8611 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0924 02:55:32.286085  8617 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.286088  8611 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0924 02:55:32.286103  8617 net.cpp:156] Memory required for data: 26408
I0924 02:55:32.286114  8611 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0924 02:55:32.286118  8589 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0924 02:55:32.286131  8589 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.286139  8589 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.286136  8617 layer_factory.hpp:77] Creating layer concat
I0924 02:55:32.286144  8589 net.cpp:156] Memory required for data: 14020
I0924 02:55:32.286160  8589 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0924 02:55:32.286169  8611 net.cpp:141] Setting up lstm1_gate_input_1
I0924 02:55:32.286170  8617 net.cpp:91] Creating Layer concat
I0924 02:55:32.286178  8611 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.286178  8589 net.cpp:91] Creating Layer lstm2_x_transform
I0924 02:55:32.286192  8589 net.cpp:425] lstm2_x_transform <- x
I0924 02:55:32.286187  8617 net.cpp:425] concat <- lstm1
I0924 02:55:32.286187  8611 net.cpp:156] Memory required for data: 78016
I0924 02:55:32.286203  8589 net.cpp:399] lstm2_x_transform -> W_xc_x
I0924 02:55:32.286206  8611 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0924 02:55:32.286209  8617 net.cpp:425] concat <- embedded_input_sentence
I0924 02:55:32.286216  8611 net.cpp:91] Creating Layer lstm1_unit_1
I0924 02:55:32.286221  8611 net.cpp:425] lstm1_unit_1 <- c_0
I0924 02:55:32.286223  8617 net.cpp:425] concat <- reshaped_stage_indicator
I0924 02:55:32.286228  8611 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0924 02:55:32.286236  8611 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0924 02:55:32.286242  8617 net.cpp:399] concat -> lstm1_video_sequence
I0924 02:55:32.286245  8611 net.cpp:399] lstm1_unit_1 -> c_1
I0924 02:55:32.286268  8611 net.cpp:399] lstm1_unit_1 -> h_1
I0924 02:55:32.301882  8611 net.cpp:141] Setting up lstm1_unit_1
I0924 02:55:32.301944  8611 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.301959  8611 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.301967  8611 net.cpp:156] Memory required for data: 86016
I0924 02:55:32.301983  8611 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:55:32.301987  8617 net.cpp:141] Setting up concat
I0924 02:55:32.302012  8611 net.cpp:91] Creating Layer lstm1_
I0924 02:55:32.302026  8611 net.cpp:425] lstm1_ <- c_1
I0924 02:55:32.302034  8617 net.cpp:148] Top shape: 1 1 1501 (1501)
I0924 02:55:32.302047  8617 net.cpp:156] Memory required for data: 32412
I0924 02:55:32.302048  8611 net.cpp:399] lstm1_ -> c_T
I0924 02:55:32.302062  8617 layer_factory.hpp:77] Creating layer lstm2
I0924 02:55:32.302098  8617 net.cpp:91] Creating Layer lstm2
I0924 02:55:32.302109  8617 net.cpp:425] lstm2 <- lstm1_video_sequence
I0924 02:55:32.302124  8617 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0924 02:55:32.302125  8611 net.cpp:141] Setting up lstm1_
I0924 02:55:32.302141  8617 net.cpp:399] lstm2 -> lstm2
I0924 02:55:32.302145  8611 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.302155  8611 net.cpp:156] Memory required for data: 90016
I0924 02:55:32.302163  8611 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0924 02:55:32.302170  8617 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0924 02:55:32.302180  8611 net.cpp:91] Creating Layer lstm1_h_concat
I0924 02:55:32.302191  8611 net.cpp:425] lstm1_h_concat <- h_1
I0924 02:55:32.302211  8611 net.cpp:399] lstm1_h_concat -> h
I0924 02:55:32.302659  8617 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0924 02:55:32.302824  8617 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:55:32.302848  8617 net.cpp:91] Creating Layer lstm2_
I0924 02:55:32.302863  8617 net.cpp:399] lstm2_ -> x
I0924 02:55:32.302886  8617 net.cpp:399] lstm2_ -> cont
I0924 02:55:32.303809  8599 net.cpp:141] Setting up embedding
I0924 02:55:32.303835  8599 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:55:32.303844  8599 net.cpp:156] Memory required for data: 22408
I0924 02:55:32.303865  8599 layer_factory.hpp:77] Creating layer lstm1
I0924 02:55:32.303884  8599 net.cpp:91] Creating Layer lstm1
I0924 02:55:32.303894  8599 net.cpp:425] lstm1 <- embedded_input_frames
I0924 02:55:32.303905  8599 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0924 02:55:32.303951  8599 net.cpp:399] lstm1 -> lstm1
I0924 02:55:32.303971  8599 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0924 02:55:32.306727  8599 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0924 02:55:32.307008  8599 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:55:32.307034  8599 net.cpp:91] Creating Layer lstm1_
I0924 02:55:32.307046  8599 net.cpp:399] lstm1_ -> x
I0924 02:55:32.307070  8599 net.cpp:399] lstm1_ -> cont
I0924 02:55:32.332883  8611 net.cpp:141] Setting up lstm1_h_concat
I0924 02:55:32.332913  8593 net.cpp:141] Setting up lstm1_transform_1
I0924 02:55:32.332939  8611 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.332940  8593 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.332949  8611 net.cpp:156] Memory required for data: 94016
I0924 02:55:32.332953  8593 net.cpp:156] Memory required for data: 62016
I0924 02:55:32.332959  8611 layer_factory.hpp:77] Creating layer h_pseudoloss
I0924 02:55:32.332975  8593 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0924 02:55:32.332985  8611 net.cpp:91] Creating Layer h_pseudoloss
I0924 02:55:32.332993  8593 net.cpp:91] Creating Layer lstm1_gate_input_1
I0924 02:55:32.332993  8611 net.cpp:425] h_pseudoloss <- h
I0924 02:55:32.333005  8593 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0924 02:55:32.333011  8611 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0924 02:55:32.333012  8593 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0924 02:55:32.333031  8593 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0924 02:55:32.333052  8599 net.cpp:141] Setting up lstm1_
I0924 02:55:32.333091  8617 net.cpp:141] Setting up lstm2_
I0924 02:55:32.333093  8599 net.cpp:148] Top shape: 1 1 500 (500)
I0924 02:55:32.333123  8617 net.cpp:148] Top shape: 1 1 1501 (1501)
I0924 02:55:32.333150  8599 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.333153  8617 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.333163  8599 net.cpp:156] Memory required for data: 2004
I0924 02:55:32.333165  8617 net.cpp:156] Memory required for data: 6008
I0924 02:55:32.333180  8599 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:55:32.333180  8617 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:55:32.333190  8593 net.cpp:141] Setting up lstm1_gate_input_1
I0924 02:55:32.333220  8593 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.333227  8593 net.cpp:156] Memory required for data: 78016
I0924 02:55:32.333216  8599 net.cpp:91] Creating Layer lstm1_
I0924 02:55:32.333216  8617 net.cpp:91] Creating Layer lstm2_
I0924 02:55:32.333240  8593 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0924 02:55:32.333256  8599 net.cpp:399] lstm1_ -> c_0
I0924 02:55:32.333261  8617 net.cpp:399] lstm2_ -> c_0
I0924 02:55:32.333266  8593 net.cpp:91] Creating Layer lstm1_unit_1
I0924 02:55:32.333274  8593 net.cpp:425] lstm1_unit_1 <- c_0
I0924 02:55:32.333281  8611 net.cpp:141] Setting up h_pseudoloss
I0924 02:55:32.333283  8593 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0924 02:55:32.333297  8611 net.cpp:148] Top shape: (1)
I0924 02:55:32.333300  8593 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0924 02:55:32.333286  8617 net.cpp:399] lstm2_ -> h_0
I0924 02:55:32.333286  8599 net.cpp:399] lstm1_ -> h_0
I0924 02:55:32.333307  8611 net.cpp:151]     with loss weight 1
I0924 02:55:32.333326  8611 net.cpp:156] Memory required for data: 94020
I0924 02:55:32.333325  8593 net.cpp:399] lstm1_unit_1 -> c_1
I0924 02:55:32.333336  8611 net.cpp:217] h_pseudoloss needs backward computation.
I0924 02:55:32.333343  8611 net.cpp:217] lstm1_h_concat needs backward computation.
I0924 02:55:32.333348  8611 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:55:32.333350  8593 net.cpp:399] lstm1_unit_1 -> h_1
I0924 02:55:32.333353  8611 net.cpp:217] lstm1_unit_1 needs backward computation.
I0924 02:55:32.333360  8611 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0924 02:55:32.333365  8611 net.cpp:217] lstm1_transform_1 needs backward computation.
I0924 02:55:32.333370  8611 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0924 02:55:32.333377  8611 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0924 02:55:32.333382  8611 net.cpp:217] lstm1_x_transform needs backward computation.
I0924 02:55:32.333387  8611 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0924 02:55:32.333392  8611 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0924 02:55:32.333398  8611 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:55:32.333402  8611 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:55:32.333406  8611 net.cpp:261] This network produces output c_T
I0924 02:55:32.333411  8611 net.cpp:261] This network produces output h_pseudoloss
I0924 02:55:32.333416  8599 net.cpp:141] Setting up lstm1_
I0924 02:55:32.333430  8599 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.333431  8611 net.cpp:274] Network initialization done.
I0924 02:55:32.333437  8599 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.333442  8599 net.cpp:156] Memory required for data: 10004
I0924 02:55:32.333447  8599 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0924 02:55:32.333464  8599 net.cpp:91] Creating Layer lstm1_cont_slice
I0924 02:55:32.333470  8599 net.cpp:425] lstm1_cont_slice <- cont
I0924 02:55:32.333479  8599 net.cpp:399] lstm1_cont_slice -> cont_1
I0924 02:55:32.333482  8611 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0924 02:55:32.333489  8611 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0924 02:55:32.333494  8611 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0924 02:55:32.333544  8599 net.cpp:141] Setting up lstm1_cont_slice
I0924 02:55:32.333555  8599 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.333559  8599 net.cpp:156] Memory required for data: 10008
I0924 02:55:32.333564  8599 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0924 02:55:32.333573  8599 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0924 02:55:32.333578  8599 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0924 02:55:32.333590  8599 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0924 02:55:32.333600  8593 net.cpp:141] Setting up lstm1_unit_1
I0924 02:55:32.333606  8599 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0924 02:55:32.333617  8593 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.333628  8593 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.333634  8593 net.cpp:156] Memory required for data: 86016
I0924 02:55:32.333642  8593 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:55:32.333654  8593 net.cpp:91] Creating Layer lstm1_
I0924 02:55:32.333662  8593 net.cpp:425] lstm1_ <- c_1
I0924 02:55:32.333673  8593 net.cpp:399] lstm1_ -> c_T
I0924 02:55:32.333673  8617 net.cpp:141] Setting up lstm2_
I0924 02:55:32.333693  8617 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.333703  8617 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.333706  8617 net.cpp:156] Memory required for data: 14008
I0924 02:55:32.333711  8617 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0924 02:55:32.333721  8617 net.cpp:91] Creating Layer lstm2_cont_slice
I0924 02:55:32.333727  8617 net.cpp:425] lstm2_cont_slice <- cont
I0924 02:55:32.333735  8617 net.cpp:399] lstm2_cont_slice -> cont_1
I0924 02:55:32.333796  8593 net.cpp:141] Setting up lstm1_
I0924 02:55:32.333811  8593 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.333817  8593 net.cpp:156] Memory required for data: 90016
I0924 02:55:32.333824  8593 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0924 02:55:32.333838  8593 net.cpp:91] Creating Layer lstm1_h_concat
I0924 02:55:32.333845  8593 net.cpp:425] lstm1_h_concat <- h_1
I0924 02:55:32.333859  8593 net.cpp:399] lstm1_h_concat -> h
I0924 02:55:32.333873  8599 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0924 02:55:32.333885  8599 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.333891  8599 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.333896  8599 net.cpp:156] Memory required for data: 10016
I0924 02:55:32.333901  8599 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0924 02:55:32.333914  8611 net.cpp:141] Setting up lstm1
I0924 02:55:32.333915  8599 net.cpp:91] Creating Layer lstm1_x_transform
I0924 02:55:32.333931  8611 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.333943  8599 net.cpp:425] lstm1_x_transform <- x
I0924 02:55:32.333947  8611 net.cpp:156] Memory required for data: 26408
I0924 02:55:32.333963  8611 layer_factory.hpp:77] Creating layer concat
I0924 02:55:32.333962  8599 net.cpp:399] lstm1_x_transform -> W_xc_x
I0924 02:55:32.333981  8617 net.cpp:141] Setting up lstm2_cont_slice
I0924 02:55:32.333978  8611 net.cpp:91] Creating Layer concat
I0924 02:55:32.333994  8611 net.cpp:425] concat <- lstm1
I0924 02:55:32.333995  8617 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.334002  8611 net.cpp:425] concat <- embedded_input_sentence
I0924 02:55:32.334005  8617 net.cpp:156] Memory required for data: 14012
I0924 02:55:32.334010  8611 net.cpp:425] concat <- reshaped_stage_indicator
I0924 02:55:32.334015  8617 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0924 02:55:32.334018  8611 net.cpp:399] concat -> lstm1_video_sequence
I0924 02:55:32.334024  8593 net.cpp:141] Setting up lstm1_h_concat
I0924 02:55:32.334029  8617 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0924 02:55:32.334039  8617 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0924 02:55:32.334040  8593 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.334058  8617 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0924 02:55:32.334062  8593 net.cpp:156] Memory required for data: 94016
I0924 02:55:32.334072  8593 layer_factory.hpp:77] Creating layer h_pseudoloss
I0924 02:55:32.334074  8617 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0924 02:55:32.334089  8593 net.cpp:91] Creating Layer h_pseudoloss
I0924 02:55:32.334097  8593 net.cpp:425] h_pseudoloss <- h
I0924 02:55:32.334107  8593 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0924 02:55:32.334121  8611 net.cpp:141] Setting up concat
I0924 02:55:32.334132  8611 net.cpp:148] Top shape: 1 1 1501 (1501)
I0924 02:55:32.334137  8611 net.cpp:156] Memory required for data: 32412
I0924 02:55:32.334142  8611 layer_factory.hpp:77] Creating layer lstm2
I0924 02:55:32.334156  8611 net.cpp:91] Creating Layer lstm2
I0924 02:55:32.334161  8611 net.cpp:425] lstm2 <- lstm1_video_sequence
I0924 02:55:32.334167  8611 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0924 02:55:32.334174  8611 net.cpp:399] lstm2 -> lstm2
I0924 02:55:32.334187  8611 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0924 02:55:32.334239  8593 net.cpp:141] Setting up h_pseudoloss
I0924 02:55:32.334254  8593 net.cpp:148] Top shape: (1)
I0924 02:55:32.334260  8593 net.cpp:151]     with loss weight 1
I0924 02:55:32.334272  8593 net.cpp:156] Memory required for data: 94020
I0924 02:55:32.334280  8593 net.cpp:217] h_pseudoloss needs backward computation.
I0924 02:55:32.334286  8593 net.cpp:217] lstm1_h_concat needs backward computation.
I0924 02:55:32.334292  8593 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:55:32.334300  8593 net.cpp:217] lstm1_unit_1 needs backward computation.
I0924 02:55:32.334308  8593 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0924 02:55:32.334316  8593 net.cpp:217] lstm1_transform_1 needs backward computation.
I0924 02:55:32.334324  8593 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0924 02:55:32.334333  8593 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0924 02:55:32.334342  8593 net.cpp:217] lstm1_x_transform needs backward computation.
I0924 02:55:32.334349  8593 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0924 02:55:32.334357  8593 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0924 02:55:32.334367  8593 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:55:32.334372  8593 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:55:32.334378  8593 net.cpp:261] This network produces output c_T
I0924 02:55:32.334389  8593 net.cpp:261] This network produces output h_pseudoloss
I0924 02:55:32.334417  8593 net.cpp:274] Network initialization done.
I0924 02:55:32.334442  8611 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0924 02:55:32.334480  8593 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0924 02:55:32.334488  8593 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0924 02:55:32.334494  8593 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0924 02:55:32.334533  8611 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:55:32.334545  8611 net.cpp:91] Creating Layer lstm2_
I0924 02:55:32.334552  8611 net.cpp:399] lstm2_ -> x
I0924 02:55:32.334563  8611 net.cpp:399] lstm2_ -> cont
I0924 02:55:32.338572  8617 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0924 02:55:32.338647  8617 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.338676  8617 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.338691  8617 net.cpp:156] Memory required for data: 14020
I0924 02:55:32.338709  8617 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0924 02:55:32.338757  8617 net.cpp:91] Creating Layer lstm2_x_transform
I0924 02:55:32.338776  8617 net.cpp:425] lstm2_x_transform <- x
I0924 02:55:32.338804  8617 net.cpp:399] lstm2_x_transform -> W_xc_x
I0924 02:55:32.338820  8593 net.cpp:141] Setting up lstm1
I0924 02:55:32.338840  8593 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.338845  8593 net.cpp:156] Memory required for data: 26408
I0924 02:55:32.338862  8593 layer_factory.hpp:77] Creating layer concat
I0924 02:55:32.338874  8593 net.cpp:91] Creating Layer concat
I0924 02:55:32.338881  8593 net.cpp:425] concat <- lstm1
I0924 02:55:32.338888  8593 net.cpp:425] concat <- embedded_input_sentence
I0924 02:55:32.338894  8593 net.cpp:425] concat <- reshaped_stage_indicator
I0924 02:55:32.338901  8593 net.cpp:399] concat -> lstm1_video_sequence
I0924 02:55:32.354552  8611 net.cpp:141] Setting up lstm2_
I0924 02:55:32.354609  8611 net.cpp:148] Top shape: 1 1 1501 (1501)
I0924 02:55:32.354619  8611 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.354624  8611 net.cpp:156] Memory required for data: 6008
I0924 02:55:32.354638  8611 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:55:32.354666  8611 net.cpp:91] Creating Layer lstm2_
I0924 02:55:32.354665  8593 net.cpp:141] Setting up concat
I0924 02:55:32.354693  8611 net.cpp:399] lstm2_ -> c_0
I0924 02:55:32.354709  8593 net.cpp:148] Top shape: 1 1 1501 (1501)
I0924 02:55:32.354717  8611 net.cpp:399] lstm2_ -> h_0
I0924 02:55:32.354718  8593 net.cpp:156] Memory required for data: 32412
I0924 02:55:32.354728  8593 layer_factory.hpp:77] Creating layer lstm2
I0924 02:55:32.354753  8593 net.cpp:91] Creating Layer lstm2
I0924 02:55:32.354765  8593 net.cpp:425] lstm2 <- lstm1_video_sequence
I0924 02:55:32.354776  8593 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0924 02:55:32.354787  8593 net.cpp:399] lstm2 -> lstm2
I0924 02:55:32.354796  8611 net.cpp:141] Setting up lstm2_
I0924 02:55:32.354809  8611 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.354809  8593 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0924 02:55:32.354816  8611 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.354821  8611 net.cpp:156] Memory required for data: 14008
I0924 02:55:32.354826  8611 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0924 02:55:32.354842  8611 net.cpp:91] Creating Layer lstm2_cont_slice
I0924 02:55:32.354848  8611 net.cpp:425] lstm2_cont_slice <- cont
I0924 02:55:32.354856  8611 net.cpp:399] lstm2_cont_slice -> cont_1
I0924 02:55:32.354913  8589 net.cpp:141] Setting up lstm2_x_transform
I0924 02:55:32.354933  8589 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.354938  8589 net.cpp:156] Memory required for data: 30020
I0924 02:55:32.354954  8589 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0924 02:55:32.354964  8589 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0924 02:55:32.354969  8589 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0924 02:55:32.354977  8589 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0924 02:55:32.355147  8593 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0924 02:55:32.355263  8593 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:55:32.355278  8593 net.cpp:91] Creating Layer lstm2_
I0924 02:55:32.355288  8593 net.cpp:399] lstm2_ -> x
I0924 02:55:32.355305  8593 net.cpp:399] lstm2_ -> cont
I0924 02:55:32.361487  8611 net.cpp:141] Setting up lstm2_cont_slice
I0924 02:55:32.361508  8611 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.361513  8611 net.cpp:156] Memory required for data: 14012
I0924 02:55:32.361520  8611 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0924 02:55:32.361529  8611 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0924 02:55:32.361536  8611 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0924 02:55:32.361548  8611 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0924 02:55:32.361559  8611 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0924 02:55:32.361701  8593 net.cpp:141] Setting up lstm2_
I0924 02:55:32.361734  8593 net.cpp:148] Top shape: 1 1 1501 (1501)
I0924 02:55:32.361747  8593 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.361754  8593 net.cpp:156] Memory required for data: 6008
I0924 02:55:32.361763  8593 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:55:32.361763  8611 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0924 02:55:32.361775  8611 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.361783  8611 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.361783  8593 net.cpp:91] Creating Layer lstm2_
I0924 02:55:32.361788  8611 net.cpp:156] Memory required for data: 14020
I0924 02:55:32.361794  8611 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0924 02:55:32.361800  8593 net.cpp:399] lstm2_ -> c_0
I0924 02:55:32.361812  8611 net.cpp:91] Creating Layer lstm2_x_transform
I0924 02:55:32.361810  8589 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0924 02:55:32.361819  8611 net.cpp:425] lstm2_x_transform <- x
I0924 02:55:32.361832  8589 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.361838  8589 net.cpp:156] Memory required for data: 46020
I0924 02:55:32.361824  8593 net.cpp:399] lstm2_ -> h_0
I0924 02:55:32.361845  8589 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0924 02:55:32.361851  8611 net.cpp:399] lstm2_x_transform -> W_xc_x
I0924 02:55:32.361857  8589 net.cpp:91] Creating Layer lstm2_h_conted_0
I0924 02:55:32.361863  8589 net.cpp:425] lstm2_h_conted_0 <- h_0
I0924 02:55:32.361871  8589 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0924 02:55:32.361878  8589 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0924 02:55:32.361974  8599 net.cpp:141] Setting up lstm1_x_transform
I0924 02:55:32.361994  8599 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.362002  8599 net.cpp:156] Memory required for data: 26016
I0924 02:55:32.362027  8599 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0924 02:55:32.362043  8599 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0924 02:55:32.362052  8599 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0924 02:55:32.362061  8593 net.cpp:141] Setting up lstm2_
I0924 02:55:32.362064  8599 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0924 02:55:32.362079  8593 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.362087  8593 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.362090  8593 net.cpp:156] Memory required for data: 14008
I0924 02:55:32.362097  8593 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0924 02:55:32.362118  8593 net.cpp:91] Creating Layer lstm2_cont_slice
I0924 02:55:32.362125  8593 net.cpp:425] lstm2_cont_slice <- cont
I0924 02:55:32.362135  8593 net.cpp:399] lstm2_cont_slice -> cont_1
I0924 02:55:32.362203  8589 net.cpp:141] Setting up lstm2_h_conted_0
I0924 02:55:32.362216  8589 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.362221  8589 net.cpp:156] Memory required for data: 50020
I0924 02:55:32.362226  8589 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0924 02:55:32.362237  8589 net.cpp:91] Creating Layer lstm2_transform_1
I0924 02:55:32.362242  8589 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0924 02:55:32.362251  8589 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0924 02:55:32.380108  8593 net.cpp:141] Setting up lstm2_cont_slice
I0924 02:55:32.380156  8593 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.380157  8599 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0924 02:55:32.380164  8593 net.cpp:156] Memory required for data: 14012
I0924 02:55:32.380195  8599 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.380198  8593 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0924 02:55:32.380204  8599 net.cpp:156] Memory required for data: 42016
I0924 02:55:32.380213  8599 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0924 02:55:32.380218  8593 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0924 02:55:32.380229  8593 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0924 02:55:32.380244  8599 net.cpp:91] Creating Layer lstm1_h_conted_0
I0924 02:55:32.380251  8593 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0924 02:55:32.380254  8599 net.cpp:425] lstm1_h_conted_0 <- h_0
I0924 02:55:32.380264  8599 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0924 02:55:32.380266  8593 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0924 02:55:32.380276  8599 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0924 02:55:32.389655  8593 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0924 02:55:32.389683  8593 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.389689  8593 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.389694  8593 net.cpp:156] Memory required for data: 14020
I0924 02:55:32.389700  8593 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0924 02:55:32.389729  8593 net.cpp:91] Creating Layer lstm2_x_transform
I0924 02:55:32.389737  8593 net.cpp:425] lstm2_x_transform <- x
I0924 02:55:32.389747  8593 net.cpp:399] lstm2_x_transform -> W_xc_x
I0924 02:55:32.389816  8599 net.cpp:141] Setting up lstm1_h_conted_0
I0924 02:55:32.389832  8599 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.389840  8599 net.cpp:156] Memory required for data: 46016
I0924 02:55:32.389848  8599 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0924 02:55:32.389863  8599 net.cpp:91] Creating Layer lstm1_transform_1
I0924 02:55:32.389871  8599 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0924 02:55:32.389883  8599 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0924 02:55:32.429970  8617 net.cpp:141] Setting up lstm2_x_transform
I0924 02:55:32.430017  8617 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.430023  8617 net.cpp:156] Memory required for data: 30020
I0924 02:55:32.430045  8617 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0924 02:55:32.430063  8617 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0924 02:55:32.430070  8617 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0924 02:55:32.430083  8617 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0924 02:55:32.438014  8617 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0924 02:55:32.438058  8617 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.438066  8617 net.cpp:156] Memory required for data: 46020
I0924 02:55:32.438073  8617 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0924 02:55:32.438097  8617 net.cpp:91] Creating Layer lstm2_h_conted_0
I0924 02:55:32.438109  8617 net.cpp:425] lstm2_h_conted_0 <- h_0
I0924 02:55:32.438122  8617 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0924 02:55:32.438138  8617 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0924 02:55:32.438150  8589 net.cpp:141] Setting up lstm2_transform_1
I0924 02:55:32.438194  8589 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.438202  8589 net.cpp:156] Memory required for data: 66020
I0924 02:55:32.438225  8589 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0924 02:55:32.438251  8589 net.cpp:91] Creating Layer lstm2_gate_input_1
I0924 02:55:32.438261  8589 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0924 02:55:32.438272  8589 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0924 02:55:32.438288  8589 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0924 02:55:32.438339  8617 net.cpp:141] Setting up lstm2_h_conted_0
I0924 02:55:32.438354  8617 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.438359  8617 net.cpp:156] Memory required for data: 50020
I0924 02:55:32.438364  8617 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0924 02:55:32.438377  8617 net.cpp:91] Creating Layer lstm2_transform_1
I0924 02:55:32.438382  8617 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0924 02:55:32.438400  8617 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0924 02:55:32.438433  8589 net.cpp:141] Setting up lstm2_gate_input_1
I0924 02:55:32.438453  8589 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.438462  8589 net.cpp:156] Memory required for data: 82020
I0924 02:55:32.438468  8589 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0924 02:55:32.438482  8589 net.cpp:91] Creating Layer lstm2_unit_1
I0924 02:55:32.438490  8589 net.cpp:425] lstm2_unit_1 <- c_0
I0924 02:55:32.438500  8589 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0924 02:55:32.438511  8589 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0924 02:55:32.438524  8589 net.cpp:399] lstm2_unit_1 -> c_1
I0924 02:55:32.438539  8589 net.cpp:399] lstm2_unit_1 -> h_1
I0924 02:55:32.438606  8611 net.cpp:141] Setting up lstm2_x_transform
I0924 02:55:32.438632  8611 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.438643  8611 net.cpp:156] Memory required for data: 30020
I0924 02:55:32.438664  8611 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0924 02:55:32.438676  8611 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0924 02:55:32.438684  8611 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0924 02:55:32.438694  8611 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0924 02:55:32.447438  8611 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0924 02:55:32.447497  8611 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.447502  8589 net.cpp:141] Setting up lstm2_unit_1
I0924 02:55:32.447507  8611 net.cpp:156] Memory required for data: 46020
I0924 02:55:32.447528  8589 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.447532  8611 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0924 02:55:32.447540  8589 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.447548  8589 net.cpp:156] Memory required for data: 90020
I0924 02:55:32.447556  8589 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:55:32.447566  8611 net.cpp:91] Creating Layer lstm2_h_conted_0
I0924 02:55:32.447571  8589 net.cpp:91] Creating Layer lstm2_
I0924 02:55:32.447578  8611 net.cpp:425] lstm2_h_conted_0 <- h_0
I0924 02:55:32.447579  8589 net.cpp:425] lstm2_ <- c_1
I0924 02:55:32.447607  8611 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0924 02:55:32.447613  8589 net.cpp:399] lstm2_ -> c_T
I0924 02:55:32.447621  8611 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0924 02:55:32.447700  8589 net.cpp:141] Setting up lstm2_
I0924 02:55:32.447715  8589 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.447724  8589 net.cpp:156] Memory required for data: 94020
I0924 02:55:32.447731  8589 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0924 02:55:32.447751  8589 net.cpp:91] Creating Layer lstm2_h_concat
I0924 02:55:32.447759  8589 net.cpp:425] lstm2_h_concat <- h_1
I0924 02:55:32.447772  8589 net.cpp:399] lstm2_h_concat -> h
I0924 02:55:32.447855  8611 net.cpp:141] Setting up lstm2_h_conted_0
I0924 02:55:32.447871  8611 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.447878  8611 net.cpp:156] Memory required for data: 50020
I0924 02:55:32.447886  8611 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0924 02:55:32.447890  8589 net.cpp:141] Setting up lstm2_h_concat
I0924 02:55:32.447903  8589 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.447906  8611 net.cpp:91] Creating Layer lstm2_transform_1
I0924 02:55:32.447911  8589 net.cpp:156] Memory required for data: 98020
I0924 02:55:32.447916  8611 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0924 02:55:32.447919  8589 layer_factory.hpp:77] Creating layer h_pseudoloss
I0924 02:55:32.447929  8611 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0924 02:55:32.447934  8589 net.cpp:91] Creating Layer h_pseudoloss
I0924 02:55:32.447942  8589 net.cpp:425] h_pseudoloss <- h
I0924 02:55:32.447957  8589 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0924 02:55:32.456892  8589 net.cpp:141] Setting up h_pseudoloss
I0924 02:55:32.456944  8589 net.cpp:148] Top shape: (1)
I0924 02:55:32.456950  8589 net.cpp:151]     with loss weight 1
I0924 02:55:32.456970  8589 net.cpp:156] Memory required for data: 98024
I0924 02:55:32.456979  8589 net.cpp:217] h_pseudoloss needs backward computation.
I0924 02:55:32.456986  8589 net.cpp:217] lstm2_h_concat needs backward computation.
I0924 02:55:32.456991  8589 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:55:32.456997  8589 net.cpp:217] lstm2_unit_1 needs backward computation.
I0924 02:55:32.457005  8589 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0924 02:55:32.457010  8589 net.cpp:217] lstm2_transform_1 needs backward computation.
I0924 02:55:32.457016  8589 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0924 02:55:32.457022  8589 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0924 02:55:32.457028  8589 net.cpp:217] lstm2_x_transform needs backward computation.
I0924 02:55:32.457033  8589 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0924 02:55:32.457039  8589 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0924 02:55:32.457046  8589 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:55:32.457049  8589 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:55:32.457053  8589 net.cpp:261] This network produces output c_T
I0924 02:55:32.457061  8589 net.cpp:261] This network produces output h_pseudoloss
I0924 02:55:32.457080  8589 net.cpp:274] Network initialization done.
I0924 02:55:32.457141  8589 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0924 02:55:32.457149  8589 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0924 02:55:32.457154  8589 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0924 02:55:32.472020  8599 net.cpp:141] Setting up lstm1_transform_1
I0924 02:55:32.472076  8599 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.472082  8599 net.cpp:156] Memory required for data: 62016
I0924 02:55:32.472108  8599 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0924 02:55:32.472133  8599 net.cpp:91] Creating Layer lstm1_gate_input_1
I0924 02:55:32.472141  8599 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0924 02:55:32.472149  8599 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0924 02:55:32.472158  8599 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0924 02:55:32.472286  8593 net.cpp:141] Setting up lstm2_x_transform
I0924 02:55:32.472322  8593 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.472328  8593 net.cpp:156] Memory required for data: 30020
I0924 02:55:32.472332  8599 net.cpp:141] Setting up lstm1_gate_input_1
I0924 02:55:32.472344  8599 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.472348  8599 net.cpp:156] Memory required for data: 78016
I0924 02:55:32.472349  8593 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0924 02:55:32.472354  8599 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0924 02:55:32.472365  8599 net.cpp:91] Creating Layer lstm1_unit_1
I0924 02:55:32.472370  8593 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0924 02:55:32.472370  8599 net.cpp:425] lstm1_unit_1 <- c_0
I0924 02:55:32.472379  8589 net.cpp:141] Setting up lstm2
I0924 02:55:32.472398  8599 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0924 02:55:32.472384  8593 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0924 02:55:32.472411  8599 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0924 02:55:32.472412  8589 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.472419  8593 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0924 02:55:32.472424  8589 net.cpp:156] Memory required for data: 36412
I0924 02:55:32.472424  8599 net.cpp:399] lstm1_unit_1 -> c_1
I0924 02:55:32.472455  8589 layer_factory.hpp:77] Creating layer predict
I0924 02:55:32.472455  8599 net.cpp:399] lstm1_unit_1 -> h_1
I0924 02:55:32.472476  8589 net.cpp:91] Creating Layer predict
I0924 02:55:32.472484  8589 net.cpp:425] predict <- lstm2
I0924 02:55:32.472492  8589 net.cpp:399] predict -> predict
I0924 02:55:32.475329  8593 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0924 02:55:32.475366  8593 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.475378  8593 net.cpp:156] Memory required for data: 46020
I0924 02:55:32.475391  8593 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0924 02:55:32.475421  8593 net.cpp:91] Creating Layer lstm2_h_conted_0
I0924 02:55:32.475433  8593 net.cpp:425] lstm2_h_conted_0 <- h_0
I0924 02:55:32.475446  8593 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0924 02:55:32.475461  8593 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0924 02:55:32.568483  8599 net.cpp:141] Setting up lstm1_unit_1
I0924 02:55:32.568544  8599 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.568559  8599 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.568567  8599 net.cpp:156] Memory required for data: 86016
I0924 02:55:32.568581  8599 layer_factory.hpp:77] Creating layer lstm1_
I0924 02:55:32.568594  8617 net.cpp:141] Setting up lstm2_transform_1
I0924 02:55:32.568629  8617 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.568631  8599 net.cpp:91] Creating Layer lstm1_
I0924 02:55:32.568635  8617 net.cpp:156] Memory required for data: 66020
I0924 02:55:32.568653  8599 net.cpp:425] lstm1_ <- c_1
I0924 02:55:32.568672  8617 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0924 02:55:32.568675  8599 net.cpp:399] lstm1_ -> c_T
I0924 02:55:32.568697  8617 net.cpp:91] Creating Layer lstm2_gate_input_1
I0924 02:55:32.568696  8611 net.cpp:141] Setting up lstm2_transform_1
I0924 02:55:32.568706  8617 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0924 02:55:32.568722  8611 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.568727  8617 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0924 02:55:32.568732  8611 net.cpp:156] Memory required for data: 66020
I0924 02:55:32.568738  8617 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0924 02:55:32.568747  8599 net.cpp:141] Setting up lstm1_
I0924 02:55:32.568753  8611 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0924 02:55:32.568763  8599 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.568769  8599 net.cpp:156] Memory required for data: 90016
I0924 02:55:32.568776  8611 net.cpp:91] Creating Layer lstm2_gate_input_1
I0924 02:55:32.568796  8611 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0924 02:55:32.568804  8617 net.cpp:141] Setting up lstm2_gate_input_1
I0924 02:55:32.568807  8611 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0924 02:55:32.568814  8617 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.568820  8617 net.cpp:156] Memory required for data: 82020
I0924 02:55:32.568822  8611 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0924 02:55:32.568826  8617 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0924 02:55:32.568837  8617 net.cpp:91] Creating Layer lstm2_unit_1
I0924 02:55:32.568842  8617 net.cpp:425] lstm2_unit_1 <- c_0
I0924 02:55:32.568848  8617 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0924 02:55:32.568855  8617 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0924 02:55:32.568866  8617 net.cpp:399] lstm2_unit_1 -> c_1
I0924 02:55:32.568876  8617 net.cpp:399] lstm2_unit_1 -> h_1
I0924 02:55:32.568912  8611 net.cpp:141] Setting up lstm2_gate_input_1
I0924 02:55:32.568927  8611 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.568933  8611 net.cpp:156] Memory required for data: 82020
I0924 02:55:32.568943  8611 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0924 02:55:32.568955  8611 net.cpp:91] Creating Layer lstm2_unit_1
I0924 02:55:32.568964  8611 net.cpp:425] lstm2_unit_1 <- c_0
I0924 02:55:32.568974  8611 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0924 02:55:32.568982  8611 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0924 02:55:32.568994  8611 net.cpp:399] lstm2_unit_1 -> c_1
I0924 02:55:32.569007  8611 net.cpp:399] lstm2_unit_1 -> h_1
I0924 02:55:32.569142  8611 net.cpp:141] Setting up lstm2_unit_1
I0924 02:55:32.569157  8611 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.569166  8611 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.569175  8611 net.cpp:156] Memory required for data: 90020
I0924 02:55:32.569182  8611 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:55:32.569198  8611 net.cpp:91] Creating Layer lstm2_
I0924 02:55:32.569206  8611 net.cpp:425] lstm2_ <- c_1
I0924 02:55:32.569218  8611 net.cpp:399] lstm2_ -> c_T
I0924 02:55:32.569239  8593 net.cpp:141] Setting up lstm2_h_conted_0
I0924 02:55:32.569259  8593 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.569257  8617 net.cpp:141] Setting up lstm2_unit_1
I0924 02:55:32.569269  8593 net.cpp:156] Memory required for data: 50020
I0924 02:55:32.569278  8593 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0924 02:55:32.569278  8617 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.569291  8617 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.569296  8617 net.cpp:156] Memory required for data: 90020
I0924 02:55:32.569299  8593 net.cpp:91] Creating Layer lstm2_transform_1
I0924 02:55:32.569303  8617 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:55:32.569309  8593 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0924 02:55:32.569310  8611 net.cpp:141] Setting up lstm2_
I0924 02:55:32.569320  8593 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0924 02:55:32.569314  8617 net.cpp:91] Creating Layer lstm2_
I0924 02:55:32.569331  8611 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.569335  8617 net.cpp:425] lstm2_ <- c_1
I0924 02:55:32.569340  8611 net.cpp:156] Memory required for data: 94020
I0924 02:55:32.569346  8617 net.cpp:399] lstm2_ -> c_T
I0924 02:55:32.569350  8611 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0924 02:55:32.569365  8611 net.cpp:91] Creating Layer lstm2_h_concat
I0924 02:55:32.569372  8611 net.cpp:425] lstm2_h_concat <- h_1
I0924 02:55:32.569389  8611 net.cpp:399] lstm2_h_concat -> h
I0924 02:55:32.569428  8617 net.cpp:141] Setting up lstm2_
I0924 02:55:32.569440  8617 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.569444  8617 net.cpp:156] Memory required for data: 94020
I0924 02:55:32.569450  8617 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0924 02:55:32.569460  8617 net.cpp:91] Creating Layer lstm2_h_concat
I0924 02:55:32.569466  8617 net.cpp:425] lstm2_h_concat <- h_1
I0924 02:55:32.569474  8617 net.cpp:399] lstm2_h_concat -> h
I0924 02:55:32.576992  8611 net.cpp:141] Setting up lstm2_h_concat
I0924 02:55:32.577057  8611 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.577066  8611 net.cpp:156] Memory required for data: 98020
I0924 02:55:32.577078  8611 layer_factory.hpp:77] Creating layer h_pseudoloss
I0924 02:55:32.577102  8611 net.cpp:91] Creating Layer h_pseudoloss
I0924 02:55:32.577114  8611 net.cpp:425] h_pseudoloss <- h
I0924 02:55:32.577132  8611 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0924 02:55:32.577297  8611 net.cpp:141] Setting up h_pseudoloss
I0924 02:55:32.577313  8611 net.cpp:148] Top shape: (1)
I0924 02:55:32.577322  8611 net.cpp:151]     with loss weight 1
I0924 02:55:32.577345  8611 net.cpp:156] Memory required for data: 98024
I0924 02:55:32.577354  8611 net.cpp:217] h_pseudoloss needs backward computation.
I0924 02:55:32.577363  8611 net.cpp:217] lstm2_h_concat needs backward computation.
I0924 02:55:32.577369  8611 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:55:32.577378  8611 net.cpp:217] lstm2_unit_1 needs backward computation.
I0924 02:55:32.577389  8611 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0924 02:55:32.577397  8611 net.cpp:217] lstm2_transform_1 needs backward computation.
I0924 02:55:32.577405  8611 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0924 02:55:32.577415  8611 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0924 02:55:32.577424  8611 net.cpp:217] lstm2_x_transform needs backward computation.
I0924 02:55:32.577432  8611 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0924 02:55:32.577446  8611 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0924 02:55:32.577458  8611 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:55:32.577467  8611 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:55:32.577476  8611 net.cpp:261] This network produces output c_T
I0924 02:55:32.577483  8611 net.cpp:261] This network produces output h_pseudoloss
I0924 02:55:32.577509  8611 net.cpp:274] Network initialization done.
I0924 02:55:32.577595  8611 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0924 02:55:32.577605  8611 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0924 02:55:32.577615  8611 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0924 02:55:32.577792  8611 net.cpp:141] Setting up lstm2
I0924 02:55:32.577812  8611 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.577824  8611 net.cpp:156] Memory required for data: 36412
I0924 02:55:32.577855  8611 layer_factory.hpp:77] Creating layer predict
I0924 02:55:32.577878  8611 net.cpp:91] Creating Layer predict
I0924 02:55:32.577888  8611 net.cpp:425] predict <- lstm2
I0924 02:55:32.577903  8611 net.cpp:399] predict -> predict
I0924 02:55:32.568778  8599 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0924 02:55:32.578588  8599 net.cpp:91] Creating Layer lstm1_h_concat
I0924 02:55:32.578620  8599 net.cpp:425] lstm1_h_concat <- h_1
I0924 02:55:32.668951  8599 net.cpp:399] lstm1_h_concat -> h
I0924 02:55:32.678897  8617 net.cpp:141] Setting up lstm2_h_concat
I0924 02:55:32.678936  8617 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.678942  8617 net.cpp:156] Memory required for data: 98020
I0924 02:55:32.678951  8617 layer_factory.hpp:77] Creating layer h_pseudoloss
I0924 02:55:32.678973  8617 net.cpp:91] Creating Layer h_pseudoloss
I0924 02:55:32.678980  8617 net.cpp:425] h_pseudoloss <- h
I0924 02:55:32.678992  8617 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0924 02:55:32.678995  8599 net.cpp:141] Setting up lstm1_h_concat
I0924 02:55:32.679013  8599 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.679018  8599 net.cpp:156] Memory required for data: 94016
I0924 02:55:32.679025  8599 layer_factory.hpp:77] Creating layer h_pseudoloss
I0924 02:55:32.679038  8599 net.cpp:91] Creating Layer h_pseudoloss
I0924 02:55:32.679044  8599 net.cpp:425] h_pseudoloss <- h
I0924 02:55:32.679052  8599 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0924 02:55:32.681602  8617 net.cpp:141] Setting up h_pseudoloss
I0924 02:55:32.681658  8617 net.cpp:148] Top shape: (1)
I0924 02:55:32.681663  8617 net.cpp:151]     with loss weight 1
I0924 02:55:32.681687  8617 net.cpp:156] Memory required for data: 98024
I0924 02:55:32.681699  8617 net.cpp:217] h_pseudoloss needs backward computation.
I0924 02:55:32.681705  8617 net.cpp:217] lstm2_h_concat needs backward computation.
I0924 02:55:32.681711  8617 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:55:32.681717  8617 net.cpp:217] lstm2_unit_1 needs backward computation.
I0924 02:55:32.681725  8617 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0924 02:55:32.681732  8617 net.cpp:217] lstm2_transform_1 needs backward computation.
I0924 02:55:32.681737  8617 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0924 02:55:32.681746  8617 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0924 02:55:32.681753  8617 net.cpp:217] lstm2_x_transform needs backward computation.
I0924 02:55:32.681759  8617 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0924 02:55:32.681769  8617 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0924 02:55:32.681777  8617 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:55:32.681782  8617 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:55:32.681788  8617 net.cpp:261] This network produces output c_T
I0924 02:55:32.681795  8617 net.cpp:261] This network produces output h_pseudoloss
I0924 02:55:32.681815  8617 net.cpp:274] Network initialization done.
I0924 02:55:32.681890  8617 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0924 02:55:32.681898  8617 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0924 02:55:32.681905  8617 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0924 02:55:32.684772  8599 net.cpp:141] Setting up h_pseudoloss
I0924 02:55:32.684828  8599 net.cpp:148] Top shape: (1)
I0924 02:55:32.684834  8599 net.cpp:151]     with loss weight 1
I0924 02:55:32.684854  8599 net.cpp:156] Memory required for data: 94020
I0924 02:55:32.684862  8599 net.cpp:217] h_pseudoloss needs backward computation.
I0924 02:55:32.684871  8599 net.cpp:217] lstm1_h_concat needs backward computation.
I0924 02:55:32.684876  8599 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:55:32.684882  8599 net.cpp:217] lstm1_unit_1 needs backward computation.
I0924 02:55:32.684891  8599 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0924 02:55:32.684897  8599 net.cpp:217] lstm1_transform_1 needs backward computation.
I0924 02:55:32.684902  8599 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0924 02:55:32.684923  8599 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0924 02:55:32.684931  8599 net.cpp:217] lstm1_x_transform needs backward computation.
I0924 02:55:32.684937  8599 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0924 02:55:32.684945  8599 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0924 02:55:32.684952  8599 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:55:32.684955  8599 net.cpp:219] lstm1_ does not need backward computation.
I0924 02:55:32.684960  8599 net.cpp:261] This network produces output c_T
I0924 02:55:32.684967  8599 net.cpp:261] This network produces output h_pseudoloss
I0924 02:55:32.684984  8599 net.cpp:274] Network initialization done.
I0924 02:55:32.685072  8599 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0924 02:55:32.685083  8599 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0924 02:55:32.685101  8599 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0924 02:55:32.690007  8617 net.cpp:141] Setting up lstm2
I0924 02:55:32.690062  8617 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.690068  8617 net.cpp:156] Memory required for data: 36412
I0924 02:55:32.690095  8617 layer_factory.hpp:77] Creating layer predict
I0924 02:55:32.690117  8617 net.cpp:91] Creating Layer predict
I0924 02:55:32.690124  8617 net.cpp:425] predict <- lstm2
I0924 02:55:32.690136  8617 net.cpp:399] predict -> predict
I0924 02:55:32.694217  8599 net.cpp:141] Setting up lstm1
I0924 02:55:32.694280  8599 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.694288  8599 net.cpp:156] Memory required for data: 26408
I0924 02:55:32.694314  8599 layer_factory.hpp:77] Creating layer concat
I0924 02:55:32.694373  8599 net.cpp:91] Creating Layer concat
I0924 02:55:32.694383  8599 net.cpp:425] concat <- lstm1
I0924 02:55:32.694393  8599 net.cpp:425] concat <- embedded_input_sentence
I0924 02:55:32.694399  8599 net.cpp:425] concat <- reshaped_stage_indicator
I0924 02:55:32.694407  8599 net.cpp:399] concat -> lstm1_video_sequence
I0924 02:55:32.780737  8599 net.cpp:141] Setting up concat
I0924 02:55:32.780797  8599 net.cpp:148] Top shape: 1 1 1501 (1501)
I0924 02:55:32.780807  8599 net.cpp:156] Memory required for data: 32412
I0924 02:55:32.780820  8599 layer_factory.hpp:77] Creating layer lstm2
I0924 02:55:32.780834  8593 net.cpp:141] Setting up lstm2_transform_1
I0924 02:55:32.780855  8599 net.cpp:91] Creating Layer lstm2
I0924 02:55:32.780871  8599 net.cpp:425] lstm2 <- lstm1_video_sequence
I0924 02:55:32.780874  8593 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.780880  8593 net.cpp:156] Memory required for data: 66020
I0924 02:55:32.780886  8599 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0924 02:55:32.780901  8593 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0924 02:55:32.780902  8599 net.cpp:399] lstm2 -> lstm2
I0924 02:55:32.780923  8593 net.cpp:91] Creating Layer lstm2_gate_input_1
I0924 02:55:32.780932  8593 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0924 02:55:32.780930  8599 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0924 02:55:32.780941  8593 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0924 02:55:32.780951  8593 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0924 02:55:32.781385  8599 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0924 02:55:32.781527  8599 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:55:32.781545  8599 net.cpp:91] Creating Layer lstm2_
I0924 02:55:32.781555  8599 net.cpp:399] lstm2_ -> x
I0924 02:55:32.781574  8599 net.cpp:399] lstm2_ -> cont
I0924 02:55:32.791919  8593 net.cpp:141] Setting up lstm2_gate_input_1
I0924 02:55:32.791944  8593 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.791949  8593 net.cpp:156] Memory required for data: 82020
I0924 02:55:32.791955  8593 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0924 02:55:32.791968  8593 net.cpp:91] Creating Layer lstm2_unit_1
I0924 02:55:32.791975  8593 net.cpp:425] lstm2_unit_1 <- c_0
I0924 02:55:32.791982  8593 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0924 02:55:32.791988  8593 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0924 02:55:32.791996  8593 net.cpp:399] lstm2_unit_1 -> c_1
I0924 02:55:32.792006  8593 net.cpp:399] lstm2_unit_1 -> h_1
I0924 02:55:32.792098  8599 net.cpp:141] Setting up lstm2_
I0924 02:55:32.792140  8599 net.cpp:148] Top shape: 1 1 1501 (1501)
I0924 02:55:32.792152  8599 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.792160  8599 net.cpp:156] Memory required for data: 6008
I0924 02:55:32.792171  8593 net.cpp:141] Setting up lstm2_unit_1
I0924 02:55:32.792171  8599 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:55:32.792191  8593 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.792212  8593 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.792217  8593 net.cpp:156] Memory required for data: 90020
I0924 02:55:32.792222  8593 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:55:32.792227  8599 net.cpp:91] Creating Layer lstm2_
I0924 02:55:32.792234  8593 net.cpp:91] Creating Layer lstm2_
I0924 02:55:32.792240  8593 net.cpp:425] lstm2_ <- c_1
I0924 02:55:32.792245  8599 net.cpp:399] lstm2_ -> c_0
I0924 02:55:32.792248  8593 net.cpp:399] lstm2_ -> c_T
I0924 02:55:32.792275  8599 net.cpp:399] lstm2_ -> h_0
I0924 02:55:32.792299  8593 net.cpp:141] Setting up lstm2_
I0924 02:55:32.792310  8593 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.792315  8593 net.cpp:156] Memory required for data: 94020
I0924 02:55:32.792320  8593 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0924 02:55:32.792330  8593 net.cpp:91] Creating Layer lstm2_h_concat
I0924 02:55:32.792335  8593 net.cpp:425] lstm2_h_concat <- h_1
I0924 02:55:32.792346  8593 net.cpp:399] lstm2_h_concat -> h
I0924 02:55:32.792402  8593 net.cpp:141] Setting up lstm2_h_concat
I0924 02:55:32.792412  8593 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.792417  8593 net.cpp:156] Memory required for data: 98020
I0924 02:55:32.792420  8593 layer_factory.hpp:77] Creating layer h_pseudoloss
I0924 02:55:32.792436  8593 net.cpp:91] Creating Layer h_pseudoloss
I0924 02:55:32.792441  8593 net.cpp:425] h_pseudoloss <- h
I0924 02:55:32.792449  8593 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0924 02:55:32.792470  8599 net.cpp:141] Setting up lstm2_
I0924 02:55:32.792487  8599 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.792497  8599 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.792503  8599 net.cpp:156] Memory required for data: 14008
I0924 02:55:32.792512  8599 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0924 02:55:32.792528  8599 net.cpp:91] Creating Layer lstm2_cont_slice
I0924 02:55:32.792536  8599 net.cpp:425] lstm2_cont_slice <- cont
I0924 02:55:32.792549  8599 net.cpp:399] lstm2_cont_slice -> cont_1
I0924 02:55:32.792579  8593 net.cpp:141] Setting up h_pseudoloss
I0924 02:55:32.792590  8593 net.cpp:148] Top shape: (1)
I0924 02:55:32.792595  8593 net.cpp:151]     with loss weight 1
I0924 02:55:32.792611  8593 net.cpp:156] Memory required for data: 98024
I0924 02:55:32.792616  8593 net.cpp:217] h_pseudoloss needs backward computation.
I0924 02:55:32.792621  8593 net.cpp:217] lstm2_h_concat needs backward computation.
I0924 02:55:32.792626  8593 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:55:32.792630  8593 net.cpp:217] lstm2_unit_1 needs backward computation.
I0924 02:55:32.792639  8593 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0924 02:55:32.792639  8599 net.cpp:141] Setting up lstm2_cont_slice
I0924 02:55:32.792659  8593 net.cpp:217] lstm2_transform_1 needs backward computation.
I0924 02:55:32.792670  8593 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0924 02:55:32.792671  8599 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.792687  8593 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0924 02:55:32.792701  8599 net.cpp:156] Memory required for data: 14012
I0924 02:55:32.792706  8593 net.cpp:217] lstm2_x_transform needs backward computation.
I0924 02:55:32.792711  8599 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0924 02:55:32.792714  8593 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0924 02:55:32.792732  8593 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0924 02:55:32.792732  8599 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0924 02:55:32.792737  8593 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:55:32.792742  8599 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0924 02:55:32.792747  8593 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:55:32.792752  8593 net.cpp:261] This network produces output c_T
I0924 02:55:32.792757  8593 net.cpp:261] This network produces output h_pseudoloss
I0924 02:55:32.792757  8599 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0924 02:55:32.792773  8599 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0924 02:55:32.792774  8593 net.cpp:274] Network initialization done.
I0924 02:55:32.792839  8593 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0924 02:55:32.792845  8593 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0924 02:55:32.792850  8593 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0924 02:55:32.803234  8599 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0924 02:55:32.803283  8599 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.803297  8599 net.cpp:148] Top shape: 1 1 (1)
I0924 02:55:32.803303  8599 net.cpp:156] Memory required for data: 14020
I0924 02:55:32.803315  8599 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0924 02:55:32.803345  8599 net.cpp:91] Creating Layer lstm2_x_transform
I0924 02:55:32.803354  8599 net.cpp:425] lstm2_x_transform <- x
I0924 02:55:32.803378  8599 net.cpp:399] lstm2_x_transform -> W_xc_x
I0924 02:55:32.803433  8593 net.cpp:141] Setting up lstm2
I0924 02:55:32.803453  8593 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.803458  8593 net.cpp:156] Memory required for data: 36412
I0924 02:55:32.803475  8593 layer_factory.hpp:77] Creating layer predict
I0924 02:55:32.803488  8593 net.cpp:91] Creating Layer predict
I0924 02:55:32.803494  8593 net.cpp:425] predict <- lstm2
I0924 02:55:32.803503  8593 net.cpp:399] predict -> predict
I0924 02:55:32.905736  8599 net.cpp:141] Setting up lstm2_x_transform
I0924 02:55:32.906229  8599 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.906405  8599 net.cpp:156] Memory required for data: 30020
I0924 02:55:32.906579  8599 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0924 02:55:32.906744  8599 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0924 02:55:32.906867  8599 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0924 02:55:32.906998  8599 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0924 02:55:32.907263  8599 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0924 02:55:32.907428  8599 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.907629  8599 net.cpp:156] Memory required for data: 46020
I0924 02:55:32.907855  8599 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0924 02:55:32.908047  8599 net.cpp:91] Creating Layer lstm2_h_conted_0
I0924 02:55:32.908277  8599 net.cpp:425] lstm2_h_conted_0 <- h_0
I0924 02:55:32.908476  8599 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0924 02:55:32.908623  8599 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0924 02:55:32.909000  8599 net.cpp:141] Setting up lstm2_h_conted_0
I0924 02:55:32.909267  8599 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.909489  8599 net.cpp:156] Memory required for data: 50020
I0924 02:55:32.909680  8599 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0924 02:55:32.909832  8599 net.cpp:91] Creating Layer lstm2_transform_1
I0924 02:55:32.909966  8599 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0924 02:55:32.910141  8599 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0924 02:55:32.961519  8599 net.cpp:141] Setting up lstm2_transform_1
I0924 02:55:32.961573  8599 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.961583  8599 net.cpp:156] Memory required for data: 66020
I0924 02:55:32.961609  8599 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0924 02:55:32.961640  8599 net.cpp:91] Creating Layer lstm2_gate_input_1
I0924 02:55:32.961652  8599 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0924 02:55:32.961663  8599 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0924 02:55:32.961675  8599 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0924 02:55:32.961848  8599 net.cpp:141] Setting up lstm2_gate_input_1
I0924 02:55:32.961863  8599 net.cpp:148] Top shape: 1 1 4000 (4000)
I0924 02:55:32.961871  8599 net.cpp:156] Memory required for data: 82020
I0924 02:55:32.961879  8599 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0924 02:55:32.961894  8599 net.cpp:91] Creating Layer lstm2_unit_1
I0924 02:55:32.961901  8599 net.cpp:425] lstm2_unit_1 <- c_0
I0924 02:55:32.961911  8599 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0924 02:55:32.961920  8599 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0924 02:55:32.961936  8599 net.cpp:399] lstm2_unit_1 -> c_1
I0924 02:55:32.961952  8599 net.cpp:399] lstm2_unit_1 -> h_1
I0924 02:55:32.962458  8599 net.cpp:141] Setting up lstm2_unit_1
I0924 02:55:32.962476  8599 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.962486  8599 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.962492  8599 net.cpp:156] Memory required for data: 90020
I0924 02:55:32.962501  8599 layer_factory.hpp:77] Creating layer lstm2_
I0924 02:55:32.962513  8599 net.cpp:91] Creating Layer lstm2_
I0924 02:55:32.962522  8599 net.cpp:425] lstm2_ <- c_1
I0924 02:55:32.962532  8599 net.cpp:399] lstm2_ -> c_T
I0924 02:55:32.965919  8599 net.cpp:141] Setting up lstm2_
I0924 02:55:32.966141  8599 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.966310  8599 net.cpp:156] Memory required for data: 94020
I0924 02:55:32.966434  8599 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0924 02:55:32.966560  8599 net.cpp:91] Creating Layer lstm2_h_concat
I0924 02:55:32.966709  8599 net.cpp:425] lstm2_h_concat <- h_1
I0924 02:55:32.966835  8599 net.cpp:399] lstm2_h_concat -> h
I0924 02:55:32.977006  8599 net.cpp:141] Setting up lstm2_h_concat
I0924 02:55:32.977054  8599 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.977064  8599 net.cpp:156] Memory required for data: 98020
I0924 02:55:32.977078  8599 layer_factory.hpp:77] Creating layer h_pseudoloss
I0924 02:55:32.977108  8599 net.cpp:91] Creating Layer h_pseudoloss
I0924 02:55:32.977119  8599 net.cpp:425] h_pseudoloss <- h
I0924 02:55:32.977134  8599 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0924 02:55:32.977293  8599 net.cpp:141] Setting up h_pseudoloss
I0924 02:55:32.977308  8599 net.cpp:148] Top shape: (1)
I0924 02:55:32.977315  8599 net.cpp:151]     with loss weight 1
I0924 02:55:32.977337  8599 net.cpp:156] Memory required for data: 98024
I0924 02:55:32.977345  8599 net.cpp:217] h_pseudoloss needs backward computation.
I0924 02:55:32.977354  8599 net.cpp:217] lstm2_h_concat needs backward computation.
I0924 02:55:32.977361  8599 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:55:32.977356  8589 net.cpp:141] Setting up predict
I0924 02:55:32.977375  8599 net.cpp:217] lstm2_unit_1 needs backward computation.
I0924 02:55:32.977396  8589 net.cpp:148] Top shape: 1 1 46168 (46168)
I0924 02:55:32.977398  8599 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0924 02:55:32.977411  8589 net.cpp:156] Memory required for data: 221084
I0924 02:55:32.977417  8599 net.cpp:217] lstm2_transform_1 needs backward computation.
I0924 02:55:32.977427  8599 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0924 02:55:32.977430  8589 layer_factory.hpp:77] Creating layer probs
I0924 02:55:32.977437  8599 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0924 02:55:32.977447  8599 net.cpp:217] lstm2_x_transform needs backward computation.
I0924 02:55:32.977449  8589 net.cpp:91] Creating Layer probs
I0924 02:55:32.977455  8599 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0924 02:55:32.977459  8589 net.cpp:425] probs <- predict
I0924 02:55:32.977465  8599 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0924 02:55:32.977473  8589 net.cpp:399] probs -> probs
I0924 02:55:32.977474  8599 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:55:32.977494  8599 net.cpp:219] lstm2_ does not need backward computation.
I0924 02:55:32.977500  8599 net.cpp:261] This network produces output c_T
I0924 02:55:32.977509  8599 net.cpp:261] This network produces output h_pseudoloss
I0924 02:55:32.977540  8599 net.cpp:274] Network initialization done.
I0924 02:55:32.977615  8599 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0924 02:55:32.977627  8599 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0924 02:55:32.977633  8599 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0924 02:55:32.977830  8599 net.cpp:141] Setting up lstm2
I0924 02:55:32.977847  8599 net.cpp:148] Top shape: 1 1 1000 (1000)
I0924 02:55:32.977855  8599 net.cpp:156] Memory required for data: 36412
I0924 02:55:32.977879  8599 layer_factory.hpp:77] Creating layer predict
I0924 02:55:32.977896  8599 net.cpp:91] Creating Layer predict
I0924 02:55:32.977906  8599 net.cpp:425] predict <- lstm2
I0924 02:55:32.977918  8599 net.cpp:399] predict -> predict
I0924 02:55:33.078577  8611 net.cpp:141] Setting up predict
I0924 02:55:33.079159  8611 net.cpp:148] Top shape: 1 1 46168 (46168)
I0924 02:55:33.079342  8611 net.cpp:156] Memory required for data: 221084
I0924 02:55:33.079489  8611 layer_factory.hpp:77] Creating layer probs
I0924 02:55:33.079629  8611 net.cpp:91] Creating Layer probs
I0924 02:55:33.079782  8611 net.cpp:425] probs <- predict
I0924 02:55:33.079919  8611 net.cpp:399] probs -> probs
I0924 02:55:33.128949  8589 net.cpp:141] Setting up probs
I0924 02:55:33.128969  8611 net.cpp:141] Setting up probs
I0924 02:55:33.129010  8611 net.cpp:148] Top shape: 1 1 46168 (46168)
I0924 02:55:33.129010  8589 net.cpp:148] Top shape: 1 1 46168 (46168)
I0924 02:55:33.129020  8611 net.cpp:156] Memory required for data: 405756
I0924 02:55:33.129024  8589 net.cpp:156] Memory required for data: 405756
I0924 02:55:33.129034  8611 net.cpp:219] probs does not need backward computation.
I0924 02:55:33.129035  8589 net.cpp:219] probs does not need backward computation.
I0924 02:55:33.129052  8611 net.cpp:219] predict does not need backward computation.
I0924 02:55:33.129055  8589 net.cpp:219] predict does not need backward computation.
I0924 02:55:33.129065  8611 net.cpp:219] lstm2 does not need backward computation.
I0924 02:55:33.129066  8589 net.cpp:219] lstm2 does not need backward computation.
I0924 02:55:33.129075  8611 net.cpp:219] concat does not need backward computation.
I0924 02:55:33.129077  8589 net.cpp:219] concat does not need backward computation.
I0924 02:55:33.129086  8611 net.cpp:219] lstm1 does not need backward computation.
I0924 02:55:33.129089  8589 net.cpp:219] lstm1 does not need backward computation.
I0924 02:55:33.129098  8611 net.cpp:219] embedding does not need backward computation.
I0924 02:55:33.129099  8589 net.cpp:219] embedding does not need backward computation.
I0924 02:55:33.129113  8611 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0924 02:55:33.129119  8589 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0924 02:55:33.129122  8611 net.cpp:219] reshape_frames does not need backward computation.
I0924 02:55:33.129130  8589 net.cpp:219] reshape_frames does not need backward computation.
I0924 02:55:33.129132  8611 net.cpp:219] embed_encoder does not need backward computation.
I0924 02:55:33.129140  8589 net.cpp:219] embed_encoder does not need backward computation.
I0924 02:55:33.129143  8611 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0924 02:55:33.129150  8589 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0924 02:55:33.129155  8611 net.cpp:219] input does not need backward computation.
I0924 02:55:33.129161  8589 net.cpp:219] input does not need backward computation.
I0924 02:55:33.129163  8611 net.cpp:261] This network produces output probs
I0924 02:55:33.129169  8589 net.cpp:261] This network produces output probs
I0924 02:55:33.129194  8611 net.cpp:274] Network initialization done.
I0924 02:55:33.129195  8589 net.cpp:274] Network initialization done.
I0924 02:55:33.130422  8597 net.cpp:141] Setting up conv1
I0924 02:55:33.130452  8597 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0924 02:55:33.130462  8597 net.cpp:156] Memory required for data: 17799480
I0924 02:55:33.130491  8597 layer_factory.hpp:77] Creating layer relu1
I0924 02:55:33.130514  8597 net.cpp:91] Creating Layer relu1
I0924 02:55:33.130525  8597 net.cpp:425] relu1 <- conv1
I0924 02:55:33.130539  8597 net.cpp:386] relu1 -> conv1 (in-place)
I0924 02:55:33.131120  8597 net.cpp:141] Setting up relu1
I0924 02:55:33.131144  8597 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0924 02:55:33.131152  8597 net.cpp:156] Memory required for data: 29415480
I0924 02:55:33.131161  8597 layer_factory.hpp:77] Creating layer pool1
I0924 02:55:33.131182  8597 net.cpp:91] Creating Layer pool1
I0924 02:55:33.131192  8597 net.cpp:425] pool1 <- conv1
I0924 02:55:33.131206  8597 net.cpp:399] pool1 -> pool1
I0924 02:55:33.131333  8597 net.cpp:141] Setting up pool1
I0924 02:55:33.131350  8597 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0924 02:55:33.131359  8597 net.cpp:156] Memory required for data: 32214840
I0924 02:55:33.131368  8597 layer_factory.hpp:77] Creating layer norm1
I0924 02:55:33.131394  8597 net.cpp:91] Creating Layer norm1
I0924 02:55:33.131403  8597 net.cpp:425] norm1 <- pool1
I0924 02:55:33.131417  8597 net.cpp:399] norm1 -> norm1
I0924 02:55:33.132077  8597 net.cpp:141] Setting up norm1
I0924 02:55:33.132102  8597 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0924 02:55:33.132112  8597 net.cpp:156] Memory required for data: 35014200
I0924 02:55:33.132120  8597 layer_factory.hpp:77] Creating layer conv2
I0924 02:55:33.132145  8597 net.cpp:91] Creating Layer conv2
I0924 02:55:33.132154  8597 net.cpp:425] conv2 <- norm1
I0924 02:55:33.132170  8597 net.cpp:399] conv2 -> conv2
I0924 02:55:33.138083  8597 net.cpp:141] Setting up conv2
I0924 02:55:33.138146  8597 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0924 02:55:33.138160  8597 net.cpp:156] Memory required for data: 42479160
I0924 02:55:33.138198  8597 layer_factory.hpp:77] Creating layer relu2
I0924 02:55:33.138226  8597 net.cpp:91] Creating Layer relu2
I0924 02:55:33.138240  8597 net.cpp:425] relu2 <- conv2
I0924 02:55:33.138257  8597 net.cpp:386] relu2 -> conv2 (in-place)
I0924 02:55:33.139075  8597 net.cpp:141] Setting up relu2
I0924 02:55:33.139109  8597 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0924 02:55:33.139120  8597 net.cpp:156] Memory required for data: 49944120
I0924 02:55:33.139132  8597 layer_factory.hpp:77] Creating layer pool2
I0924 02:55:33.139155  8597 net.cpp:91] Creating Layer pool2
I0924 02:55:33.139166  8597 net.cpp:425] pool2 <- conv2
I0924 02:55:33.139183  8597 net.cpp:399] pool2 -> pool2
I0924 02:55:33.139333  8597 net.cpp:141] Setting up pool2
I0924 02:55:33.139353  8597 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0924 02:55:33.139364  8597 net.cpp:156] Memory required for data: 51674680
I0924 02:55:33.139380  8597 layer_factory.hpp:77] Creating layer norm2
I0924 02:55:33.139407  8597 net.cpp:91] Creating Layer norm2
I0924 02:55:33.139418  8597 net.cpp:425] norm2 <- pool2
I0924 02:55:33.139433  8597 net.cpp:399] norm2 -> norm2
I0924 02:55:33.139945  8597 net.cpp:141] Setting up norm2
I0924 02:55:33.139969  8597 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0924 02:55:33.139981  8597 net.cpp:156] Memory required for data: 53405240
I0924 02:55:33.139991  8597 layer_factory.hpp:77] Creating layer conv3
I0924 02:55:33.140014  8597 net.cpp:91] Creating Layer conv3
I0924 02:55:33.140025  8597 net.cpp:425] conv3 <- norm2
I0924 02:55:33.140040  8597 net.cpp:399] conv3 -> conv3
I0924 02:55:33.157742  8597 net.cpp:141] Setting up conv3
I0924 02:55:33.157814  8597 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0924 02:55:33.157827  8597 net.cpp:156] Memory required for data: 56001080
I0924 02:55:33.157877  8597 layer_factory.hpp:77] Creating layer relu3
I0924 02:55:33.158269  8597 net.cpp:91] Creating Layer relu3
I0924 02:55:33.158284  8597 net.cpp:425] relu3 <- conv3
I0924 02:55:33.158299  8597 net.cpp:386] relu3 -> conv3 (in-place)
I0924 02:55:33.161527  8597 net.cpp:141] Setting up relu3
I0924 02:55:33.161594  8597 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0924 02:55:33.161607  8597 net.cpp:156] Memory required for data: 58596920
I0924 02:55:33.161623  8597 layer_factory.hpp:77] Creating layer conv4
I0924 02:55:33.161662  8597 net.cpp:91] Creating Layer conv4
I0924 02:55:33.161675  8597 net.cpp:425] conv4 <- conv3
I0924 02:55:33.167099  8597 net.cpp:399] conv4 -> conv4
I0924 02:55:33.189347  8617 net.cpp:141] Setting up predict
I0924 02:55:33.189476  8617 net.cpp:148] Top shape: 1 1 46168 (46168)
I0924 02:55:33.189496  8617 net.cpp:156] Memory required for data: 221084
I0924 02:55:33.189535  8617 layer_factory.hpp:77] Creating layer probs
I0924 02:55:33.189571  8617 net.cpp:91] Creating Layer probs
I0924 02:55:33.189613  8617 net.cpp:425] probs <- predict
I0924 02:55:33.189672  8617 net.cpp:399] probs -> probs
I0924 02:55:33.190912  8597 net.cpp:141] Setting up conv4
I0924 02:55:33.190958  8597 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0924 02:55:33.190965  8597 net.cpp:156] Memory required for data: 61192760
I0924 02:55:33.190981  8597 layer_factory.hpp:77] Creating layer relu4
I0924 02:55:33.191098  8597 net.cpp:91] Creating Layer relu4
I0924 02:55:33.191123  8597 net.cpp:425] relu4 <- conv4
I0924 02:55:33.191140  8597 net.cpp:386] relu4 -> conv4 (in-place)
I0924 02:55:33.191593  8617 net.cpp:141] Setting up probs
I0924 02:55:33.191623  8617 net.cpp:148] Top shape: 1 1 46168 (46168)
I0924 02:55:33.191632  8617 net.cpp:156] Memory required for data: 405756
I0924 02:55:33.191643  8617 net.cpp:219] probs does not need backward computation.
I0924 02:55:33.191653  8617 net.cpp:219] predict does not need backward computation.
I0924 02:55:33.191663  8617 net.cpp:219] lstm2 does not need backward computation.
I0924 02:55:33.191673  8617 net.cpp:219] concat does not need backward computation.
I0924 02:55:33.191684  8617 net.cpp:219] lstm1 does not need backward computation.
I0924 02:55:33.191684  8597 net.cpp:141] Setting up relu4
I0924 02:55:33.191694  8617 net.cpp:219] embedding does not need backward computation.
I0924 02:55:33.191702  8617 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0924 02:55:33.191704  8597 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0924 02:55:33.191720  8617 net.cpp:219] reshape_frames does not need backward computation.
I0924 02:55:33.191723  8597 net.cpp:156] Memory required for data: 63788600
I0924 02:55:33.191730  8617 net.cpp:219] embed_encoder does not need backward computation.
I0924 02:55:33.191732  8597 layer_factory.hpp:77] Creating layer conv5
I0924 02:55:33.191740  8617 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0924 02:55:33.191750  8617 net.cpp:219] input does not need backward computation.
I0924 02:55:33.191756  8617 net.cpp:261] This network produces output probs
I0924 02:55:33.191761  8597 net.cpp:91] Creating Layer conv5
I0924 02:55:33.191769  8597 net.cpp:425] conv5 <- conv4
I0924 02:55:33.191782  8597 net.cpp:399] conv5 -> conv5
I0924 02:55:33.191787  8617 net.cpp:274] Network initialization done.
I0924 02:55:33.199327  8597 net.cpp:141] Setting up conv5
I0924 02:55:33.199386  8597 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0924 02:55:33.199395  8597 net.cpp:156] Memory required for data: 65519160
I0924 02:55:33.199429  8597 layer_factory.hpp:77] Creating layer relu5
I0924 02:55:33.199462  8597 net.cpp:91] Creating Layer relu5
I0924 02:55:33.199472  8597 net.cpp:425] relu5 <- conv5
I0924 02:55:33.199486  8597 net.cpp:386] relu5 -> conv5 (in-place)
I0924 02:55:33.199947  8597 net.cpp:141] Setting up relu5
I0924 02:55:33.199972  8597 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0924 02:55:33.199980  8597 net.cpp:156] Memory required for data: 67249720
I0924 02:55:33.199990  8597 layer_factory.hpp:77] Creating layer pool5
I0924 02:55:33.200007  8597 net.cpp:91] Creating Layer pool5
I0924 02:55:33.200016  8597 net.cpp:425] pool5 <- conv5
I0924 02:55:33.200032  8597 net.cpp:399] pool5 -> pool5
I0924 02:55:33.200170  8597 net.cpp:141] Setting up pool5
I0924 02:55:33.200186  8597 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0924 02:55:33.200193  8597 net.cpp:156] Memory required for data: 67618360
I0924 02:55:33.200201  8597 layer_factory.hpp:77] Creating layer fc6
I0924 02:55:33.200229  8597 net.cpp:91] Creating Layer fc6
I0924 02:55:33.200238  8597 net.cpp:425] fc6 <- pool5
I0924 02:55:33.200253  8597 net.cpp:399] fc6 -> fc6
I0924 02:55:33.324026  8597 net.cpp:141] Setting up fc6
I0924 02:55:33.324084  8597 net.cpp:148] Top shape: 10 4096 (40960)
I0924 02:55:33.324091  8597 net.cpp:156] Memory required for data: 67782200
I0924 02:55:33.324112  8597 layer_factory.hpp:77] Creating layer relu6
I0924 02:55:33.324136  8597 net.cpp:91] Creating Layer relu6
I0924 02:55:33.324144  8597 net.cpp:425] relu6 <- fc6
I0924 02:55:33.324158  8597 net.cpp:386] relu6 -> fc6 (in-place)
I0924 02:55:33.324988  8597 net.cpp:141] Setting up relu6
I0924 02:55:33.325028  8597 net.cpp:148] Top shape: 10 4096 (40960)
I0924 02:55:33.325034  8597 net.cpp:156] Memory required for data: 67946040
I0924 02:55:33.325042  8597 layer_factory.hpp:77] Creating layer drop6
I0924 02:55:33.325074  8597 net.cpp:91] Creating Layer drop6
I0924 02:55:33.325081  8597 net.cpp:425] drop6 <- fc6
I0924 02:55:33.325095  8597 net.cpp:386] drop6 -> fc6 (in-place)
I0924 02:55:33.325191  8597 net.cpp:141] Setting up drop6
I0924 02:55:33.325201  8597 net.cpp:148] Top shape: 10 4096 (40960)
I0924 02:55:33.325206  8597 net.cpp:156] Memory required for data: 68109880
I0924 02:55:33.325212  8597 layer_factory.hpp:77] Creating layer fc7
I0924 02:55:33.325224  8597 net.cpp:91] Creating Layer fc7
I0924 02:55:33.325229  8597 net.cpp:425] fc7 <- fc6
I0924 02:55:33.325242  8597 net.cpp:399] fc7 -> fc7
I0924 02:55:33.357167  8593 net.cpp:141] Setting up predict
I0924 02:55:33.357245  8593 net.cpp:148] Top shape: 1 1 46168 (46168)
I0924 02:55:33.357259  8593 net.cpp:156] Memory required for data: 221084
I0924 02:55:33.357285  8593 layer_factory.hpp:77] Creating layer probs
I0924 02:55:33.357313  8593 net.cpp:91] Creating Layer probs
I0924 02:55:33.357331  8593 net.cpp:425] probs <- predict
I0924 02:55:33.357352  8593 net.cpp:399] probs -> probs
I0924 02:55:33.358245  8593 net.cpp:141] Setting up probs
I0924 02:55:33.358268  8593 net.cpp:148] Top shape: 1 1 46168 (46168)
I0924 02:55:33.358278  8593 net.cpp:156] Memory required for data: 405756
I0924 02:55:33.358289  8593 net.cpp:219] probs does not need backward computation.
I0924 02:55:33.358300  8593 net.cpp:219] predict does not need backward computation.
I0924 02:55:33.358315  8593 net.cpp:219] lstm2 does not need backward computation.
I0924 02:55:33.358328  8593 net.cpp:219] concat does not need backward computation.
I0924 02:55:33.358340  8593 net.cpp:219] lstm1 does not need backward computation.
I0924 02:55:33.358353  8593 net.cpp:219] embedding does not need backward computation.
I0924 02:55:33.358363  8593 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0924 02:55:33.358373  8593 net.cpp:219] reshape_frames does not need backward computation.
I0924 02:55:33.358383  8593 net.cpp:219] embed_encoder does not need backward computation.
I0924 02:55:33.358417  8593 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0924 02:55:33.358429  8593 net.cpp:219] input does not need backward computation.
I0924 02:55:33.358438  8593 net.cpp:261] This network produces output probs
I0924 02:55:33.358475  8593 net.cpp:274] Network initialization done.
I0924 02:55:33.379542  8597 net.cpp:141] Setting up fc7
I0924 02:55:33.379606  8597 net.cpp:148] Top shape: 10 4096 (40960)
I0924 02:55:33.379616  8597 net.cpp:156] Memory required for data: 68273720
I0924 02:55:33.379669  8597 layer_factory.hpp:77] Creating layer relu7
I0924 02:55:33.379701  8597 net.cpp:91] Creating Layer relu7
I0924 02:55:33.379714  8597 net.cpp:425] relu7 <- fc7
I0924 02:55:33.379730  8597 net.cpp:386] relu7 -> fc7 (in-place)
I0924 02:55:33.380570  8597 net.cpp:141] Setting up relu7
I0924 02:55:33.380604  8597 net.cpp:148] Top shape: 10 4096 (40960)
I0924 02:55:33.380612  8597 net.cpp:156] Memory required for data: 68437560
I0924 02:55:33.380625  8597 layer_factory.hpp:77] Creating layer drop7
I0924 02:55:33.380648  8597 net.cpp:91] Creating Layer drop7
I0924 02:55:33.380658  8597 net.cpp:425] drop7 <- fc7
I0924 02:55:33.380674  8597 net.cpp:386] drop7 -> fc7 (in-place)
I0924 02:55:33.380756  8597 net.cpp:141] Setting up drop7
I0924 02:55:33.380771  8597 net.cpp:148] Top shape: 10 4096 (40960)
I0924 02:55:33.380779  8597 net.cpp:156] Memory required for data: 68601400
I0924 02:55:33.380786  8597 layer_factory.hpp:77] Creating layer fc8
I0924 02:55:33.381312  8597 net.cpp:91] Creating Layer fc8
I0924 02:55:33.381327  8597 net.cpp:425] fc8 <- fc7
I0924 02:55:33.381341  8597 net.cpp:399] fc8 -> fc8
I0924 02:55:33.397961  8597 net.cpp:141] Setting up fc8
I0924 02:55:33.398035  8597 net.cpp:148] Top shape: 10 1000 (10000)
I0924 02:55:33.398041  8597 net.cpp:156] Memory required for data: 68641400
I0924 02:55:33.398058  8597 layer_factory.hpp:77] Creating layer prob
I0924 02:55:33.398080  8597 net.cpp:91] Creating Layer prob
I0924 02:55:33.398088  8597 net.cpp:425] prob <- fc8
I0924 02:55:33.398098  8597 net.cpp:399] prob -> prob
I0924 02:55:33.400372  8597 net.cpp:141] Setting up prob
I0924 02:55:33.400418  8597 net.cpp:148] Top shape: 10 1000 (10000)
I0924 02:55:33.400425  8597 net.cpp:156] Memory required for data: 68681400
I0924 02:55:33.400434  8597 net.cpp:219] prob does not need backward computation.
I0924 02:55:33.400442  8597 net.cpp:219] fc8 does not need backward computation.
I0924 02:55:33.400449  8597 net.cpp:219] drop7 does not need backward computation.
I0924 02:55:33.400452  8597 net.cpp:219] relu7 does not need backward computation.
I0924 02:55:33.400457  8597 net.cpp:219] fc7 does not need backward computation.
I0924 02:55:33.400462  8597 net.cpp:219] drop6 does not need backward computation.
I0924 02:55:33.400466  8597 net.cpp:219] relu6 does not need backward computation.
I0924 02:55:33.400470  8597 net.cpp:219] fc6 does not need backward computation.
I0924 02:55:33.400475  8597 net.cpp:219] pool5 does not need backward computation.
I0924 02:55:33.400480  8597 net.cpp:219] relu5 does not need backward computation.
I0924 02:55:33.400490  8597 net.cpp:219] conv5 does not need backward computation.
I0924 02:55:33.400495  8597 net.cpp:219] relu4 does not need backward computation.
I0924 02:55:33.400499  8597 net.cpp:219] conv4 does not need backward computation.
I0924 02:55:33.400504  8597 net.cpp:219] relu3 does not need backward computation.
I0924 02:55:33.400508  8597 net.cpp:219] conv3 does not need backward computation.
I0924 02:55:33.400514  8597 net.cpp:219] norm2 does not need backward computation.
I0924 02:55:33.400519  8597 net.cpp:219] pool2 does not need backward computation.
I0924 02:55:33.400524  8597 net.cpp:219] relu2 does not need backward computation.
I0924 02:55:33.400528  8597 net.cpp:219] conv2 does not need backward computation.
I0924 02:55:33.400533  8597 net.cpp:219] norm1 does not need backward computation.
I0924 02:55:33.400538  8597 net.cpp:219] pool1 does not need backward computation.
I0924 02:55:33.400543  8597 net.cpp:219] relu1 does not need backward computation.
I0924 02:55:33.400547  8597 net.cpp:219] conv1 does not need backward computation.
I0924 02:55:33.400553  8597 net.cpp:219] data does not need backward computation.
I0924 02:55:33.400557  8597 net.cpp:261] This network produces output prob
I0924 02:55:33.400943  8597 net.cpp:274] Network initialization done.
I0924 02:55:33.471959  8599 net.cpp:141] Setting up predict
I0924 02:55:33.472028  8599 net.cpp:148] Top shape: 1 1 46168 (46168)
I0924 02:55:33.472035  8599 net.cpp:156] Memory required for data: 221084
I0924 02:55:33.472054  8599 layer_factory.hpp:77] Creating layer probs
I0924 02:55:33.472074  8599 net.cpp:91] Creating Layer probs
I0924 02:55:33.472084  8599 net.cpp:425] probs <- predict
I0924 02:55:33.472095  8599 net.cpp:399] probs -> probs
I0924 02:55:33.474633  8599 net.cpp:141] Setting up probs
I0924 02:55:33.474714  8599 net.cpp:148] Top shape: 1 1 46168 (46168)
I0924 02:55:33.474725  8599 net.cpp:156] Memory required for data: 405756
I0924 02:55:33.474740  8599 net.cpp:219] probs does not need backward computation.
I0924 02:55:33.474756  8599 net.cpp:219] predict does not need backward computation.
I0924 02:55:33.474766  8599 net.cpp:219] lstm2 does not need backward computation.
I0924 02:55:33.474777  8599 net.cpp:219] concat does not need backward computation.
I0924 02:55:33.474789  8599 net.cpp:219] lstm1 does not need backward computation.
I0924 02:55:33.474800  8599 net.cpp:219] embedding does not need backward computation.
I0924 02:55:33.474809  8599 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0924 02:55:33.474818  8599 net.cpp:219] reshape_frames does not need backward computation.
I0924 02:55:33.474828  8599 net.cpp:219] embed_encoder does not need backward computation.
I0924 02:55:33.474838  8599 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0924 02:55:33.474851  8599 net.cpp:219] input does not need backward computation.
I0924 02:55:33.474859  8599 net.cpp:261] This network produces output probs
I0924 02:55:33.475428  8599 net.cpp:274] Network initialization done.
I0924 02:55:33.586839  8589 net.cpp:752] Ignoring source layer data
I0924 02:55:33.586889  8589 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0924 02:55:33.586896  8589 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0924 02:55:33.594282  8611 net.cpp:752] Ignoring source layer data
I0924 02:55:33.594323  8611 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0924 02:55:33.594328  8611 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0924 02:55:33.683868  8589 net.cpp:752] Ignoring source layer cross_entropy_loss
I0924 02:55:33.692126  8611 net.cpp:752] Ignoring source layer cross_entropy_loss
I0924 02:55:33.696876  8617 net.cpp:752] Ignoring source layer data
I0924 02:55:33.696918  8617 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0924 02:55:33.696925  8617 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0924 02:55:33.720580  8597 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /home/peifeng/work/run/storm102/data/workers/c5f829ea-c9d5-475d-9929-7e6ac9a747d8/tmp/cvld1412008837354535561/bvlc_reference_caffenet.caffemodel
I0924 02:55:33.720636  8597 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0924 02:55:33.720645  8597 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0924 02:55:33.720649  8597 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /home/peifeng/work/run/storm102/data/workers/c5f829ea-c9d5-475d-9929-7e6ac9a747d8/tmp/cvld1412008837354535561/bvlc_reference_caffenet.caffemodel
I0924 02:55:33.754588  8593 net.cpp:752] Ignoring source layer data
I0924 02:55:33.754639  8593 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0924 02:55:33.754645  8593 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0924 02:55:33.777542  8617 net.cpp:752] Ignoring source layer cross_entropy_loss
I0924 02:55:33.846585  8593 net.cpp:752] Ignoring source layer cross_entropy_loss
I0924 02:55:33.875157  8599 net.cpp:752] Ignoring source layer data
I0924 02:55:33.875190  8599 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0924 02:55:33.875195  8599 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0924 02:55:33.954537  8599 net.cpp:752] Ignoring source layer cross_entropy_loss
I0924 02:55:34.144645  8597 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0924 02:55:34.198225  8597 net.cpp:752] Ignoring source layer loss
Loading the model + trained: 34083.5ms
Using cv::Size and some other stuff: 0.339ms
Loading the mean file: 35228.3ms
TIMERTIMER 373263324
TIMERTIMER 569339957
TIMERTIMER 579834741
TIMERTIMER 650446814
TIMERTIMER 336906523
TIMERTIMER 235175601
TIMERTIMER 335464227
TIMERTIMER 562512078
TIMERTIMER 510928578
TIMERTIMER 486590662
TIMERTIMER 243340431
TIMERTIMER 453547193
TIMERTIMER 416568782
TIMERTIMER 460054999
TIMERTIMER 431029248
TIMERTIMER 214865382
TIMERTIMER 236650815
TIMERTIMER 233834357
TIMERTIMER 234910441
TIMERTIMER 221076134
TIMERTIMER 228945895
TIMERTIMER 219548287
TIMERTIMER 221740000
TIMERTIMER 232843872
TIMERTIMER 250458573
TIMERTIMER 199389369
TIMERTIMER 214975107
TIMERTIMER 222451347
TIMERTIMER 244820125
TIMERTIMER 215614165
TIMERTIMER 225439410
TIMERTIMER 229288985
TIMERTIMER 221865453
TIMERTIMER 213627130
TIMERTIMER 234930721
TIMERTIMER 241071262
TIMERTIMER 230684431
TIMERTIMER 233124824
TIMERTIMER 231439978
TIMERTIMER 219750702
TIMERTIMER 231255604
TIMERTIMER 239053875
TIMERTIMER 254521686
TIMERTIMER 250248346
TIMERTIMER 248462873
TIMERTIMER 246130080
TIMERTIMER 243208301
TIMERTIMER 236821484
TIMERTIMER 251213389
TIMERTIMER 238391711
TIMERTIMER 242885083
TIMERTIMER 255894010
TIMERTIMER 250061757
TIMERTIMER 250014650
TIMERTIMER 246988247
TIMERTIMER 240231066
TIMERTIMER 243685909
TIMERTIMER 251915323
TIMERTIMER 241731730
TIMERTIMER 253277430
TIMERTIMER 251207296
TIMERTIMER 246505124
TIMERTIMER 244317566
TIMERTIMER 249051516
TIMERTIMER 243570577
