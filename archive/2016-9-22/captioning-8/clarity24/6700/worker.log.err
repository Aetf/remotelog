SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/peifeng/tools/storm102/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/peifeng/work/run/storm102/data/supervisor/stormdist/captioning-1-1474596747/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /home/peifeng/work/run/storm102/data/workers/39ad9222-82e3-44ee-9695-5bda60947c31/tmp/cvld6612025725665523881/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0922 22:13:05.134948 20588 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/39ad9222-82e3-44ee-9695-5bda60947c31/tmp/cvld6612025725665523881/s2vt.words_to_preds.prototxt
I0922 22:13:05.134951 20592 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/39ad9222-82e3-44ee-9695-5bda60947c31/tmp/cvld6612025725665523881/s2vt.words_to_preds.prototxt
I0922 22:13:05.135078 20592 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
I0922 22:13:05.135078 20588 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0922 22:13:05.135092 20592 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
W0922 22:13:05.135103 20588 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0922 22:13:05.135365 20588 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0922 22:13:05.135370 20598 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0922 22:13:05.135372 20592 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0922 22:13:05.135512 20588 layer_factory.hpp:77] Creating layer input
I0922 22:13:05.135519 20598 layer_factory.hpp:77] Creating layer data
I0922 22:13:05.135514 20592 layer_factory.hpp:77] Creating layer input
I0922 22:13:05.135547 20598 net.cpp:91] Creating Layer data
I0922 22:13:05.135550 20592 net.cpp:91] Creating Layer input
I0922 22:13:05.135548 20588 net.cpp:91] Creating Layer input
I0922 22:13:05.135563 20598 net.cpp:399] data -> data
I0922 22:13:05.135570 20588 net.cpp:399] input -> frames_fc7
I0922 22:13:05.135563 20592 net.cpp:399] input -> frames_fc7
I0922 22:13:05.135606 20588 net.cpp:399] input -> cont_sentence
I0922 22:13:05.135608 20592 net.cpp:399] input -> cont_sentence
I0922 22:13:05.135620 20588 net.cpp:399] input -> input_sentence
I0922 22:13:05.135624 20592 net.cpp:399] input -> input_sentence
I0922 22:13:05.135632 20588 net.cpp:399] input -> stage_indicator
I0922 22:13:05.135637 20592 net.cpp:399] input -> stage_indicator
I0922 22:13:05.697574 20598 net.cpp:141] Setting up data
I0922 22:13:05.697643 20598 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0922 22:13:05.697651 20598 net.cpp:156] Memory required for data: 6183480
I0922 22:13:05.697674 20598 layer_factory.hpp:77] Creating layer conv1
I0922 22:13:05.697715 20598 net.cpp:91] Creating Layer conv1
I0922 22:13:05.697726 20598 net.cpp:425] conv1 <- data
I0922 22:13:05.697742 20598 net.cpp:399] conv1 -> conv1
I0922 22:13:05.697919 20592 net.cpp:141] Setting up input
I0922 22:13:05.697945 20588 net.cpp:141] Setting up input
I0922 22:13:05.697965 20588 net.cpp:148] Top shape: 1 4096 (4096)
I0922 22:13:05.697968 20592 net.cpp:148] Top shape: 1 4096 (4096)
I0922 22:13:05.697974 20588 net.cpp:148] Top shape: 1 1 (1)
I0922 22:13:05.697978 20592 net.cpp:148] Top shape: 1 1 (1)
I0922 22:13:05.697981 20588 net.cpp:148] Top shape: 1 1 (1)
I0922 22:13:05.697988 20592 net.cpp:148] Top shape: 1 1 (1)
I0922 22:13:05.697989 20588 net.cpp:148] Top shape: 1 1 (1)
I0922 22:13:05.697994 20592 net.cpp:148] Top shape: 1 1 (1)
I0922 22:13:05.697995 20588 net.cpp:156] Memory required for data: 16396
I0922 22:13:05.698005 20592 net.cpp:156] Memory required for data: 16396
I0922 22:13:05.698017 20588 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0922 22:13:05.698026 20592 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0922 22:13:05.698036 20588 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0922 22:13:05.698043 20588 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0922 22:13:05.698048 20592 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0922 22:13:05.698057 20592 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0922 22:13:05.698063 20588 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0922 22:13:05.698071 20592 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0922 22:13:05.698076 20588 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0922 22:13:05.698086 20592 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0922 22:13:05.698932 20588 net.cpp:141] Setting up cont_sentence_input_1_split
I0922 22:13:05.698961 20588 net.cpp:148] Top shape: 1 1 (1)
I0922 22:13:05.698961 20592 net.cpp:141] Setting up cont_sentence_input_1_split
I0922 22:13:05.698967 20588 net.cpp:148] Top shape: 1 1 (1)
I0922 22:13:05.698985 20588 net.cpp:156] Memory required for data: 16404
I0922 22:13:05.698989 20592 net.cpp:148] Top shape: 1 1 (1)
I0922 22:13:05.698993 20588 layer_factory.hpp:77] Creating layer embed_encoder
I0922 22:13:05.699004 20592 net.cpp:148] Top shape: 1 1 (1)
I0922 22:13:05.699012 20592 net.cpp:156] Memory required for data: 16404
I0922 22:13:05.699033 20592 layer_factory.hpp:77] Creating layer embed_encoder
I0922 22:13:05.699041 20588 net.cpp:91] Creating Layer embed_encoder
I0922 22:13:05.699054 20588 net.cpp:425] embed_encoder <- frames_fc7
I0922 22:13:05.699056 20592 net.cpp:91] Creating Layer embed_encoder
I0922 22:13:05.699067 20592 net.cpp:425] embed_encoder <- frames_fc7
I0922 22:13:05.699071 20588 net.cpp:399] embed_encoder -> embedded_in_frames
I0922 22:13:05.699082 20592 net.cpp:399] embed_encoder -> embedded_in_frames
I0922 22:13:05.725122 20588 net.cpp:141] Setting up embed_encoder
I0922 22:13:05.725162 20588 net.cpp:148] Top shape: 1 500 (500)
I0922 22:13:05.725169 20588 net.cpp:156] Memory required for data: 18404
I0922 22:13:05.725195 20588 layer_factory.hpp:77] Creating layer reshape_frames
I0922 22:13:05.725229 20588 net.cpp:91] Creating Layer reshape_frames
I0922 22:13:05.725236 20588 net.cpp:425] reshape_frames <- embedded_in_frames
I0922 22:13:05.725247 20588 net.cpp:399] reshape_frames -> embedded_input_frames
I0922 22:13:05.725311 20588 net.cpp:141] Setting up reshape_frames
I0922 22:13:05.725322 20588 net.cpp:148] Top shape: 1 1 500 (500)
I0922 22:13:05.725325 20588 net.cpp:156] Memory required for data: 20404
I0922 22:13:05.725330 20588 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0922 22:13:05.725342 20588 net.cpp:91] Creating Layer reshape_stage_indicator
I0922 22:13:05.725347 20588 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0922 22:13:05.725355 20588 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0922 22:13:05.725404 20588 net.cpp:141] Setting up reshape_stage_indicator
I0922 22:13:05.725414 20588 net.cpp:148] Top shape: 1 1 1 (1)
I0922 22:13:05.725419 20588 net.cpp:156] Memory required for data: 20408
I0922 22:13:05.725424 20588 layer_factory.hpp:77] Creating layer embedding
I0922 22:13:05.725436 20588 net.cpp:91] Creating Layer embedding
I0922 22:13:05.725441 20588 net.cpp:425] embedding <- input_sentence
I0922 22:13:05.725450 20588 net.cpp:399] embedding -> embedded_input_sentence
I0922 22:13:05.771255 20592 net.cpp:141] Setting up embed_encoder
I0922 22:13:05.771304 20592 net.cpp:148] Top shape: 1 500 (500)
I0922 22:13:05.771311 20592 net.cpp:156] Memory required for data: 18404
I0922 22:13:05.771335 20592 layer_factory.hpp:77] Creating layer reshape_frames
I0922 22:13:05.771358 20592 net.cpp:91] Creating Layer reshape_frames
I0922 22:13:05.771368 20592 net.cpp:425] reshape_frames <- embedded_in_frames
I0922 22:13:05.771379 20592 net.cpp:399] reshape_frames -> embedded_input_frames
I0922 22:13:05.774770 20592 net.cpp:141] Setting up reshape_frames
I0922 22:13:05.774808 20592 net.cpp:148] Top shape: 1 1 500 (500)
I0922 22:13:05.774818 20592 net.cpp:156] Memory required for data: 20404
I0922 22:13:05.774828 20592 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0922 22:13:05.774864 20592 net.cpp:91] Creating Layer reshape_stage_indicator
I0922 22:13:05.774873 20592 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0922 22:13:05.774886 20592 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0922 22:13:05.776722 20592 net.cpp:141] Setting up reshape_stage_indicator
I0922 22:13:05.776762 20592 net.cpp:148] Top shape: 1 1 1 (1)
I0922 22:13:05.776772 20592 net.cpp:156] Memory required for data: 20408
I0922 22:13:05.776782 20592 layer_factory.hpp:77] Creating layer embedding
I0922 22:13:05.776809 20592 net.cpp:91] Creating Layer embedding
I0922 22:13:05.776820 20592 net.cpp:425] embedding <- input_sentence
I0922 22:13:05.776844 20592 net.cpp:399] embedding -> embedded_input_sentence
I0922 22:13:05.949170 20588 net.cpp:141] Setting up embedding
I0922 22:13:05.949215 20588 net.cpp:148] Top shape: 1 1 500 (500)
I0922 22:13:05.949223 20588 net.cpp:156] Memory required for data: 22408
I0922 22:13:05.949242 20588 layer_factory.hpp:77] Creating layer lstm1
I0922 22:13:05.949264 20588 net.cpp:91] Creating Layer lstm1
I0922 22:13:05.949270 20588 net.cpp:425] lstm1 <- embedded_input_frames
I0922 22:13:05.949280 20588 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0922 22:13:05.949290 20588 net.cpp:399] lstm1 -> lstm1
I0922 22:13:05.949332 20588 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0922 22:13:05.949705 20588 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0922 22:13:05.949805 20588 layer_factory.hpp:77] Creating layer lstm1_
I0922 22:13:05.949817 20588 net.cpp:91] Creating Layer lstm1_
I0922 22:13:05.949823 20588 net.cpp:399] lstm1_ -> x
I0922 22:13:05.949836 20588 net.cpp:399] lstm1_ -> cont
I0922 22:13:05.954339 20588 net.cpp:141] Setting up lstm1_
I0922 22:13:05.954362 20588 net.cpp:148] Top shape: 1 1 500 (500)
I0922 22:13:05.954375 20588 net.cpp:148] Top shape: 1 1 (1)
I0922 22:13:05.954382 20588 net.cpp:156] Memory required for data: 2004
I0922 22:13:05.954391 20588 layer_factory.hpp:77] Creating layer lstm1_
I0922 22:13:05.954408 20588 net.cpp:91] Creating Layer lstm1_
I0922 22:13:05.954423 20588 net.cpp:399] lstm1_ -> c_0
I0922 22:13:05.954444 20588 net.cpp:399] lstm1_ -> h_0
I0922 22:13:05.954553 20588 net.cpp:141] Setting up lstm1_
I0922 22:13:05.954571 20588 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:13:05.954582 20588 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:13:05.954591 20588 net.cpp:156] Memory required for data: 10004
I0922 22:13:05.954598 20588 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0922 22:13:05.954614 20588 net.cpp:91] Creating Layer lstm1_cont_slice
I0922 22:13:05.954623 20588 net.cpp:425] lstm1_cont_slice <- cont
I0922 22:13:05.954637 20588 net.cpp:399] lstm1_cont_slice -> cont_1
I0922 22:13:05.954704 20588 net.cpp:141] Setting up lstm1_cont_slice
I0922 22:13:05.954722 20588 net.cpp:148] Top shape: 1 1 (1)
I0922 22:13:05.954730 20588 net.cpp:156] Memory required for data: 10008
I0922 22:13:05.954738 20588 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0922 22:13:05.954756 20588 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0922 22:13:05.954766 20588 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0922 22:13:05.954777 20588 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0922 22:13:05.954794 20588 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0922 22:13:05.959429 20588 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0922 22:13:05.959458 20588 net.cpp:148] Top shape: 1 1 (1)
I0922 22:13:05.959470 20588 net.cpp:148] Top shape: 1 1 (1)
I0922 22:13:05.959478 20588 net.cpp:156] Memory required for data: 10016
I0922 22:13:05.959487 20588 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0922 22:13:05.959527 20588 net.cpp:91] Creating Layer lstm1_x_transform
I0922 22:13:05.959539 20588 net.cpp:425] lstm1_x_transform <- x
I0922 22:13:05.959556 20588 net.cpp:399] lstm1_x_transform -> W_xc_x
I0922 22:13:05.982280 20588 net.cpp:141] Setting up lstm1_x_transform
I0922 22:13:05.982326 20588 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 22:13:05.982331 20588 net.cpp:156] Memory required for data: 26016
I0922 22:13:05.982357 20588 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0922 22:13:05.982379 20588 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0922 22:13:05.982386 20588 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0922 22:13:05.982396 20588 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0922 22:13:05.982728 20588 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0922 22:13:05.982739 20588 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 22:13:05.982744 20588 net.cpp:156] Memory required for data: 42016
I0922 22:13:05.982749 20588 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0922 22:13:05.982774 20588 net.cpp:91] Creating Layer lstm1_h_conted_0
I0922 22:13:05.982780 20588 net.cpp:425] lstm1_h_conted_0 <- h_0
I0922 22:13:05.982786 20588 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0922 22:13:05.982795 20588 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0922 22:13:05.986439 20588 net.cpp:141] Setting up lstm1_h_conted_0
I0922 22:13:05.986460 20588 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:13:05.986466 20588 net.cpp:156] Memory required for data: 46016
I0922 22:13:05.986471 20588 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0922 22:13:05.986490 20588 net.cpp:91] Creating Layer lstm1_transform_1
I0922 22:13:05.986495 20588 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0922 22:13:05.986503 20588 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0922 22:13:05.994987 20598 net.cpp:141] Setting up conv1
I0922 22:13:05.995052 20598 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0922 22:13:05.995061 20598 net.cpp:156] Memory required for data: 17799480
I0922 22:13:05.995085 20598 layer_factory.hpp:77] Creating layer relu1
I0922 22:13:05.995107 20598 net.cpp:91] Creating Layer relu1
I0922 22:13:05.995115 20598 net.cpp:425] relu1 <- conv1
I0922 22:13:05.995122 20598 net.cpp:386] relu1 -> conv1 (in-place)
I0922 22:13:05.995518 20598 net.cpp:141] Setting up relu1
I0922 22:13:05.995532 20598 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0922 22:13:05.995537 20598 net.cpp:156] Memory required for data: 29415480
I0922 22:13:05.995543 20598 layer_factory.hpp:77] Creating layer pool1
I0922 22:13:05.995556 20598 net.cpp:91] Creating Layer pool1
I0922 22:13:05.995561 20598 net.cpp:425] pool1 <- conv1
I0922 22:13:05.995570 20598 net.cpp:399] pool1 -> pool1
I0922 22:13:05.995667 20598 net.cpp:141] Setting up pool1
I0922 22:13:05.995679 20598 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0922 22:13:05.995683 20598 net.cpp:156] Memory required for data: 32214840
I0922 22:13:05.995689 20598 layer_factory.hpp:77] Creating layer norm1
I0922 22:13:05.995708 20598 net.cpp:91] Creating Layer norm1
I0922 22:13:05.995713 20598 net.cpp:425] norm1 <- pool1
I0922 22:13:05.995720 20598 net.cpp:399] norm1 -> norm1
I0922 22:13:05.995975 20598 net.cpp:141] Setting up norm1
I0922 22:13:05.995986 20598 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0922 22:13:05.995991 20598 net.cpp:156] Memory required for data: 35014200
I0922 22:13:05.995997 20598 layer_factory.hpp:77] Creating layer conv2
I0922 22:13:05.996013 20598 net.cpp:91] Creating Layer conv2
I0922 22:13:05.996018 20598 net.cpp:425] conv2 <- norm1
I0922 22:13:05.996026 20598 net.cpp:399] conv2 -> conv2
I0922 22:13:05.999001 20598 net.cpp:141] Setting up conv2
I0922 22:13:05.999028 20598 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0922 22:13:05.999038 20598 net.cpp:156] Memory required for data: 42479160
I0922 22:13:05.999056 20598 layer_factory.hpp:77] Creating layer relu2
I0922 22:13:05.999068 20598 net.cpp:91] Creating Layer relu2
I0922 22:13:05.999073 20598 net.cpp:425] relu2 <- conv2
I0922 22:13:05.999080 20598 net.cpp:386] relu2 -> conv2 (in-place)
I0922 22:13:05.999454 20598 net.cpp:141] Setting up relu2
I0922 22:13:05.999466 20598 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0922 22:13:05.999471 20598 net.cpp:156] Memory required for data: 49944120
I0922 22:13:05.999476 20598 layer_factory.hpp:77] Creating layer pool2
I0922 22:13:05.999486 20598 net.cpp:91] Creating Layer pool2
I0922 22:13:05.999492 20598 net.cpp:425] pool2 <- conv2
I0922 22:13:05.999500 20598 net.cpp:399] pool2 -> pool2
I0922 22:13:05.999552 20598 net.cpp:141] Setting up pool2
I0922 22:13:05.999562 20598 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0922 22:13:05.999567 20598 net.cpp:156] Memory required for data: 51674680
I0922 22:13:05.999572 20598 layer_factory.hpp:77] Creating layer norm2
I0922 22:13:05.999583 20598 net.cpp:91] Creating Layer norm2
I0922 22:13:05.999588 20598 net.cpp:425] norm2 <- pool2
I0922 22:13:05.999594 20598 net.cpp:399] norm2 -> norm2
I0922 22:13:05.999836 20598 net.cpp:141] Setting up norm2
I0922 22:13:05.999848 20598 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0922 22:13:05.999852 20598 net.cpp:156] Memory required for data: 53405240
I0922 22:13:05.999857 20598 layer_factory.hpp:77] Creating layer conv3
I0922 22:13:05.999869 20598 net.cpp:91] Creating Layer conv3
I0922 22:13:05.999874 20598 net.cpp:425] conv3 <- norm2
I0922 22:13:05.999882 20598 net.cpp:399] conv3 -> conv3
I0922 22:13:06.003331 20598 net.cpp:141] Setting up conv3
I0922 22:13:06.003350 20598 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0922 22:13:06.003356 20598 net.cpp:156] Memory required for data: 56001080
I0922 22:13:06.003370 20598 layer_factory.hpp:77] Creating layer relu3
I0922 22:13:06.003379 20598 net.cpp:91] Creating Layer relu3
I0922 22:13:06.003384 20598 net.cpp:425] relu3 <- conv3
I0922 22:13:06.003394 20598 net.cpp:386] relu3 -> conv3 (in-place)
I0922 22:13:06.003615 20598 net.cpp:141] Setting up relu3
I0922 22:13:06.003626 20598 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0922 22:13:06.003631 20598 net.cpp:156] Memory required for data: 58596920
I0922 22:13:06.003636 20598 layer_factory.hpp:77] Creating layer conv4
I0922 22:13:06.003649 20598 net.cpp:91] Creating Layer conv4
I0922 22:13:06.003654 20598 net.cpp:425] conv4 <- conv3
I0922 22:13:06.003664 20598 net.cpp:399] conv4 -> conv4
I0922 22:13:06.007560 20598 net.cpp:141] Setting up conv4
I0922 22:13:06.007581 20598 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0922 22:13:06.007586 20598 net.cpp:156] Memory required for data: 61192760
I0922 22:13:06.007596 20598 layer_factory.hpp:77] Creating layer relu4
I0922 22:13:06.007611 20598 net.cpp:91] Creating Layer relu4
I0922 22:13:06.007617 20598 net.cpp:425] relu4 <- conv4
I0922 22:13:06.007624 20598 net.cpp:386] relu4 -> conv4 (in-place)
I0922 22:13:06.008003 20598 net.cpp:141] Setting up relu4
I0922 22:13:06.008016 20598 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0922 22:13:06.008020 20598 net.cpp:156] Memory required for data: 63788600
I0922 22:13:06.008026 20598 layer_factory.hpp:77] Creating layer conv5
I0922 22:13:06.008041 20598 net.cpp:91] Creating Layer conv5
I0922 22:13:06.008046 20598 net.cpp:425] conv5 <- conv4
I0922 22:13:06.008056 20598 net.cpp:399] conv5 -> conv5
I0922 22:13:06.011484 20598 net.cpp:141] Setting up conv5
I0922 22:13:06.011507 20598 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0922 22:13:06.011512 20598 net.cpp:156] Memory required for data: 65519160
I0922 22:13:06.011526 20598 layer_factory.hpp:77] Creating layer relu5
I0922 22:13:06.011535 20598 net.cpp:91] Creating Layer relu5
I0922 22:13:06.011541 20598 net.cpp:425] relu5 <- conv5
I0922 22:13:06.011549 20598 net.cpp:386] relu5 -> conv5 (in-place)
I0922 22:13:06.011924 20598 net.cpp:141] Setting up relu5
I0922 22:13:06.011936 20598 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0922 22:13:06.011941 20598 net.cpp:156] Memory required for data: 67249720
I0922 22:13:06.011946 20598 layer_factory.hpp:77] Creating layer pool5
I0922 22:13:06.011960 20598 net.cpp:91] Creating Layer pool5
I0922 22:13:06.011965 20598 net.cpp:425] pool5 <- conv5
I0922 22:13:06.011972 20598 net.cpp:399] pool5 -> pool5
I0922 22:13:06.012033 20598 net.cpp:141] Setting up pool5
I0922 22:13:06.012042 20598 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0922 22:13:06.012048 20598 net.cpp:156] Memory required for data: 67618360
I0922 22:13:06.012051 20598 layer_factory.hpp:77] Creating layer fc6
I0922 22:13:06.012064 20598 net.cpp:91] Creating Layer fc6
I0922 22:13:06.012069 20598 net.cpp:425] fc6 <- pool5
I0922 22:13:06.012080 20598 net.cpp:399] fc6 -> fc6
I0922 22:13:06.076449 20588 net.cpp:141] Setting up lstm1_transform_1
I0922 22:13:06.076498 20588 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 22:13:06.076504 20588 net.cpp:156] Memory required for data: 62016
I0922 22:13:06.076529 20588 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0922 22:13:06.076555 20588 net.cpp:91] Creating Layer lstm1_gate_input_1
I0922 22:13:06.076562 20588 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0922 22:13:06.076571 20588 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0922 22:13:06.076580 20588 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0922 22:13:06.076572 20592 net.cpp:141] Setting up embedding
I0922 22:13:06.076614 20592 net.cpp:148] Top shape: 1 1 500 (500)
I0922 22:13:06.076622 20592 net.cpp:156] Memory required for data: 22408
I0922 22:13:06.076642 20592 layer_factory.hpp:77] Creating layer lstm1
I0922 22:13:06.076660 20588 net.cpp:141] Setting up lstm1_gate_input_1
I0922 22:13:06.076665 20592 net.cpp:91] Creating Layer lstm1
I0922 22:13:06.076671 20588 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 22:13:06.076676 20592 net.cpp:425] lstm1 <- embedded_input_frames
I0922 22:13:06.076676 20588 net.cpp:156] Memory required for data: 78016
I0922 22:13:06.076694 20592 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0922 22:13:06.076695 20588 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0922 22:13:06.076707 20592 net.cpp:399] lstm1 -> lstm1
I0922 22:13:06.076712 20588 net.cpp:91] Creating Layer lstm1_unit_1
I0922 22:13:06.076717 20588 net.cpp:425] lstm1_unit_1 <- c_0
I0922 22:13:06.076724 20588 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0922 22:13:06.076730 20588 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0922 22:13:06.076728 20592 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0922 22:13:06.076743 20588 net.cpp:399] lstm1_unit_1 -> c_1
I0922 22:13:06.076753 20588 net.cpp:399] lstm1_unit_1 -> h_1
I0922 22:13:06.076823 20588 net.cpp:141] Setting up lstm1_unit_1
I0922 22:13:06.076833 20588 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:13:06.076838 20588 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:13:06.076843 20588 net.cpp:156] Memory required for data: 86016
I0922 22:13:06.076848 20588 layer_factory.hpp:77] Creating layer lstm1_
I0922 22:13:06.076858 20588 net.cpp:91] Creating Layer lstm1_
I0922 22:13:06.076863 20588 net.cpp:425] lstm1_ <- c_1
I0922 22:13:06.076871 20588 net.cpp:399] lstm1_ -> c_T
I0922 22:13:06.076903 20588 net.cpp:141] Setting up lstm1_
I0922 22:13:06.076912 20588 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:13:06.076916 20588 net.cpp:156] Memory required for data: 90016
I0922 22:13:06.076921 20588 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0922 22:13:06.076931 20588 net.cpp:91] Creating Layer lstm1_h_concat
I0922 22:13:06.076936 20588 net.cpp:425] lstm1_h_concat <- h_1
I0922 22:13:06.076946 20588 net.cpp:399] lstm1_h_concat -> h
I0922 22:13:06.076992 20588 net.cpp:141] Setting up lstm1_h_concat
I0922 22:13:06.077002 20588 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:13:06.077005 20588 net.cpp:156] Memory required for data: 94016
I0922 22:13:06.077010 20588 layer_factory.hpp:77] Creating layer h_pseudoloss
I0922 22:13:06.077026 20588 net.cpp:91] Creating Layer h_pseudoloss
I0922 22:13:06.077031 20588 net.cpp:425] h_pseudoloss <- h
I0922 22:13:06.077039 20588 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0922 22:13:06.077069 20592 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0922 22:13:06.077124 20588 net.cpp:141] Setting up h_pseudoloss
I0922 22:13:06.077136 20588 net.cpp:148] Top shape: (1)
I0922 22:13:06.077141 20588 net.cpp:151]     with loss weight 1
I0922 22:13:06.077173 20588 net.cpp:156] Memory required for data: 94020
I0922 22:13:06.077173 20592 layer_factory.hpp:77] Creating layer lstm1_
I0922 22:13:06.077179 20588 net.cpp:217] h_pseudoloss needs backward computation.
I0922 22:13:06.077184 20588 net.cpp:217] lstm1_h_concat needs backward computation.
I0922 22:13:06.077188 20592 net.cpp:91] Creating Layer lstm1_
I0922 22:13:06.077189 20588 net.cpp:219] lstm1_ does not need backward computation.
I0922 22:13:06.077201 20592 net.cpp:399] lstm1_ -> x
I0922 22:13:06.077208 20588 net.cpp:217] lstm1_unit_1 needs backward computation.
I0922 22:13:06.077216 20592 net.cpp:399] lstm1_ -> cont
I0922 22:13:06.077219 20588 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0922 22:13:06.077226 20588 net.cpp:217] lstm1_transform_1 needs backward computation.
I0922 22:13:06.077231 20588 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0922 22:13:06.077237 20588 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0922 22:13:06.077242 20588 net.cpp:217] lstm1_x_transform needs backward computation.
I0922 22:13:06.077247 20588 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0922 22:13:06.077252 20588 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0922 22:13:06.077257 20588 net.cpp:219] lstm1_ does not need backward computation.
I0922 22:13:06.077262 20588 net.cpp:219] lstm1_ does not need backward computation.
I0922 22:13:06.077265 20588 net.cpp:261] This network produces output c_T
I0922 22:13:06.077270 20588 net.cpp:261] This network produces output h_pseudoloss
I0922 22:13:06.077292 20588 net.cpp:274] Network initialization done.
I0922 22:13:06.077311 20592 net.cpp:141] Setting up lstm1_
I0922 22:13:06.077323 20592 net.cpp:148] Top shape: 1 1 500 (500)
I0922 22:13:06.077332 20592 net.cpp:148] Top shape: 1 1 (1)
I0922 22:13:06.077337 20592 net.cpp:156] Memory required for data: 2004
I0922 22:13:06.077342 20592 layer_factory.hpp:77] Creating layer lstm1_
I0922 22:13:06.077353 20592 net.cpp:91] Creating Layer lstm1_
I0922 22:13:06.077353 20588 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0922 22:13:06.077368 20592 net.cpp:399] lstm1_ -> c_0
I0922 22:13:06.077369 20588 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0922 22:13:06.077384 20592 net.cpp:399] lstm1_ -> h_0
I0922 22:13:06.077385 20588 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0922 22:13:06.077458 20592 net.cpp:141] Setting up lstm1_
I0922 22:13:06.077469 20592 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:13:06.077476 20592 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:13:06.077481 20592 net.cpp:156] Memory required for data: 10004
I0922 22:13:06.077486 20592 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0922 22:13:06.077497 20592 net.cpp:91] Creating Layer lstm1_cont_slice
I0922 22:13:06.077502 20592 net.cpp:425] lstm1_cont_slice <- cont
I0922 22:13:06.077512 20592 net.cpp:399] lstm1_cont_slice -> cont_1
I0922 22:13:06.077564 20592 net.cpp:141] Setting up lstm1_cont_slice
I0922 22:13:06.077575 20592 net.cpp:148] Top shape: 1 1 (1)
I0922 22:13:06.077579 20592 net.cpp:156] Memory required for data: 10008
I0922 22:13:06.077585 20592 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0922 22:13:06.077599 20592 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0922 22:13:06.077605 20592 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0922 22:13:06.077607 20588 net.cpp:141] Setting up lstm1
I0922 22:13:06.077612 20592 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0922 22:13:06.077625 20588 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:13:06.077639 20592 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0922 22:13:06.077639 20588 net.cpp:156] Memory required for data: 26408
I0922 22:13:06.077663 20588 layer_factory.hpp:77] Creating layer concat
I0922 22:13:06.077672 20588 net.cpp:91] Creating Layer concat
I0922 22:13:06.077679 20588 net.cpp:425] concat <- lstm1
I0922 22:13:06.077685 20588 net.cpp:425] concat <- embedded_input_sentence
I0922 22:13:06.077692 20588 net.cpp:425] concat <- reshaped_stage_indicator
I0922 22:13:06.077698 20588 net.cpp:399] concat -> lstm1_video_sequence
I0922 22:13:06.077720 20592 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0922 22:13:06.077733 20592 net.cpp:148] Top shape: 1 1 (1)
I0922 22:13:06.077739 20592 net.cpp:148] Top shape: 1 1 (1)
I0922 22:13:06.077744 20592 net.cpp:156] Memory required for data: 10016
I0922 22:13:06.077749 20592 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0922 22:13:06.077759 20588 net.cpp:141] Setting up concat
I0922 22:13:06.077760 20592 net.cpp:91] Creating Layer lstm1_x_transform
I0922 22:13:06.077772 20588 net.cpp:148] Top shape: 1 1 1501 (1501)
I0922 22:13:06.077776 20592 net.cpp:425] lstm1_x_transform <- x
I0922 22:13:06.077778 20588 net.cpp:156] Memory required for data: 32412
I0922 22:13:06.077790 20592 net.cpp:399] lstm1_x_transform -> W_xc_x
I0922 22:13:06.077791 20588 layer_factory.hpp:77] Creating layer lstm2
I0922 22:13:06.077813 20588 net.cpp:91] Creating Layer lstm2
I0922 22:13:06.077818 20588 net.cpp:425] lstm2 <- lstm1_video_sequence
I0922 22:13:06.077826 20588 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0922 22:13:06.077832 20588 net.cpp:399] lstm2 -> lstm2
I0922 22:13:06.077843 20588 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0922 22:13:06.081265 20588 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0922 22:13:06.081480 20588 layer_factory.hpp:77] Creating layer lstm2_
I0922 22:13:06.081502 20588 net.cpp:91] Creating Layer lstm2_
I0922 22:13:06.081514 20588 net.cpp:399] lstm2_ -> x
I0922 22:13:06.081538 20588 net.cpp:399] lstm2_ -> cont
I0922 22:13:06.081940 20588 net.cpp:141] Setting up lstm2_
I0922 22:13:06.081961 20588 net.cpp:148] Top shape: 1 1 1501 (1501)
I0922 22:13:06.081975 20588 net.cpp:148] Top shape: 1 1 (1)
I0922 22:13:06.081984 20588 net.cpp:156] Memory required for data: 6008
I0922 22:13:06.081993 20588 layer_factory.hpp:77] Creating layer lstm2_
I0922 22:13:06.082015 20588 net.cpp:91] Creating Layer lstm2_
I0922 22:13:06.082027 20588 net.cpp:399] lstm2_ -> c_0
I0922 22:13:06.082048 20588 net.cpp:399] lstm2_ -> h_0
I0922 22:13:06.082139 20588 net.cpp:141] Setting up lstm2_
I0922 22:13:06.082154 20588 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:13:06.082165 20588 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:13:06.082172 20588 net.cpp:156] Memory required for data: 14008
I0922 22:13:06.082180 20588 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0922 22:13:06.082195 20588 net.cpp:91] Creating Layer lstm2_cont_slice
I0922 22:13:06.082204 20588 net.cpp:425] lstm2_cont_slice <- cont
I0922 22:13:06.082219 20588 net.cpp:399] lstm2_cont_slice -> cont_1
I0922 22:13:06.082285 20588 net.cpp:141] Setting up lstm2_cont_slice
I0922 22:13:06.082300 20588 net.cpp:148] Top shape: 1 1 (1)
I0922 22:13:06.082309 20588 net.cpp:156] Memory required for data: 14012
I0922 22:13:06.082315 20588 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0922 22:13:06.082329 20588 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0922 22:13:06.082336 20588 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0922 22:13:06.082355 20588 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0922 22:13:06.082371 20588 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0922 22:13:06.082449 20588 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0922 22:13:06.082465 20588 net.cpp:148] Top shape: 1 1 (1)
I0922 22:13:06.082475 20588 net.cpp:148] Top shape: 1 1 (1)
I0922 22:13:06.082482 20588 net.cpp:156] Memory required for data: 14020
I0922 22:13:06.082490 20588 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0922 22:13:06.082511 20588 net.cpp:91] Creating Layer lstm2_x_transform
I0922 22:13:06.082521 20588 net.cpp:425] lstm2_x_transform <- x
I0922 22:13:06.082540 20588 net.cpp:399] lstm2_x_transform -> W_xc_x
I0922 22:13:06.098598 20592 net.cpp:141] Setting up lstm1_x_transform
I0922 22:13:06.098630 20592 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 22:13:06.098636 20592 net.cpp:156] Memory required for data: 26016
I0922 22:13:06.098655 20592 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0922 22:13:06.098669 20592 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0922 22:13:06.098675 20592 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0922 22:13:06.098683 20592 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0922 22:13:06.098726 20592 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0922 22:13:06.098737 20592 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 22:13:06.098742 20592 net.cpp:156] Memory required for data: 42016
I0922 22:13:06.098747 20592 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0922 22:13:06.098762 20592 net.cpp:91] Creating Layer lstm1_h_conted_0
I0922 22:13:06.098767 20592 net.cpp:425] lstm1_h_conted_0 <- h_0
I0922 22:13:06.098774 20592 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0922 22:13:06.098781 20592 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0922 22:13:06.098891 20592 net.cpp:141] Setting up lstm1_h_conted_0
I0922 22:13:06.098902 20592 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:13:06.098906 20592 net.cpp:156] Memory required for data: 46016
I0922 22:13:06.098912 20592 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0922 22:13:06.098923 20592 net.cpp:91] Creating Layer lstm1_transform_1
I0922 22:13:06.098929 20592 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0922 22:13:06.098937 20592 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0922 22:13:06.116199 20598 net.cpp:141] Setting up fc6
I0922 22:13:06.116237 20598 net.cpp:148] Top shape: 10 4096 (40960)
I0922 22:13:06.116243 20598 net.cpp:156] Memory required for data: 67782200
I0922 22:13:06.116258 20598 layer_factory.hpp:77] Creating layer relu6
I0922 22:13:06.116278 20598 net.cpp:91] Creating Layer relu6
I0922 22:13:06.116286 20598 net.cpp:425] relu6 <- fc6
I0922 22:13:06.116295 20598 net.cpp:386] relu6 -> fc6 (in-place)
I0922 22:13:06.116621 20598 net.cpp:141] Setting up relu6
I0922 22:13:06.116632 20598 net.cpp:148] Top shape: 10 4096 (40960)
I0922 22:13:06.116637 20598 net.cpp:156] Memory required for data: 67946040
I0922 22:13:06.116642 20598 layer_factory.hpp:77] Creating layer drop6
I0922 22:13:06.116655 20598 net.cpp:91] Creating Layer drop6
I0922 22:13:06.116662 20598 net.cpp:425] drop6 <- fc6
I0922 22:13:06.116669 20598 net.cpp:386] drop6 -> fc6 (in-place)
I0922 22:13:06.116717 20598 net.cpp:141] Setting up drop6
I0922 22:13:06.116726 20598 net.cpp:148] Top shape: 10 4096 (40960)
I0922 22:13:06.116730 20598 net.cpp:156] Memory required for data: 68109880
I0922 22:13:06.116735 20598 layer_factory.hpp:77] Creating layer fc7
I0922 22:13:06.116746 20598 net.cpp:91] Creating Layer fc7
I0922 22:13:06.116751 20598 net.cpp:425] fc7 <- fc6
I0922 22:13:06.116761 20598 net.cpp:399] fc7 -> fc7
I0922 22:13:06.145853 20592 net.cpp:141] Setting up lstm1_transform_1
I0922 22:13:06.145912 20592 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 22:13:06.145920 20592 net.cpp:156] Memory required for data: 62016
I0922 22:13:06.145941 20592 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0922 22:13:06.145967 20592 net.cpp:91] Creating Layer lstm1_gate_input_1
I0922 22:13:06.145975 20592 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0922 22:13:06.145984 20592 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0922 22:13:06.145993 20592 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0922 22:13:06.146046 20588 net.cpp:141] Setting up lstm2_x_transform
I0922 22:13:06.146080 20592 net.cpp:141] Setting up lstm1_gate_input_1
I0922 22:13:06.146086 20588 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 22:13:06.146092 20592 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 22:13:06.146093 20588 net.cpp:156] Memory required for data: 30020
I0922 22:13:06.146100 20592 net.cpp:156] Memory required for data: 78016
I0922 22:13:06.146106 20592 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0922 22:13:06.146116 20588 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0922 22:13:06.146116 20592 net.cpp:91] Creating Layer lstm1_unit_1
I0922 22:13:06.146132 20592 net.cpp:425] lstm1_unit_1 <- c_0
I0922 22:13:06.146136 20588 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0922 22:13:06.146139 20592 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0922 22:13:06.146143 20588 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0922 22:13:06.146147 20592 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0922 22:13:06.146154 20588 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0922 22:13:06.146155 20592 net.cpp:399] lstm1_unit_1 -> c_1
I0922 22:13:06.146174 20592 net.cpp:399] lstm1_unit_1 -> h_1
I0922 22:13:06.146229 20588 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0922 22:13:06.146240 20588 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 22:13:06.146245 20588 net.cpp:156] Memory required for data: 46020
I0922 22:13:06.146250 20588 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0922 22:13:06.146262 20588 net.cpp:91] Creating Layer lstm2_h_conted_0
I0922 22:13:06.146267 20588 net.cpp:425] lstm2_h_conted_0 <- h_0
I0922 22:13:06.146273 20588 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0922 22:13:06.146281 20588 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0922 22:13:06.146314 20592 net.cpp:141] Setting up lstm1_unit_1
I0922 22:13:06.146327 20592 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:13:06.146333 20592 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:13:06.146338 20592 net.cpp:156] Memory required for data: 86016
I0922 22:13:06.146344 20592 layer_factory.hpp:77] Creating layer lstm1_
I0922 22:13:06.146358 20592 net.cpp:91] Creating Layer lstm1_
I0922 22:13:06.146363 20592 net.cpp:425] lstm1_ <- c_1
I0922 22:13:06.146371 20592 net.cpp:399] lstm1_ -> c_T
I0922 22:13:06.146426 20588 net.cpp:141] Setting up lstm2_h_conted_0
I0922 22:13:06.146438 20588 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:13:06.146442 20588 net.cpp:156] Memory required for data: 50020
I0922 22:13:06.146447 20588 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0922 22:13:06.146462 20588 net.cpp:91] Creating Layer lstm2_transform_1
I0922 22:13:06.146468 20588 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0922 22:13:06.146468 20592 net.cpp:141] Setting up lstm1_
I0922 22:13:06.146477 20588 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0922 22:13:06.146482 20592 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:13:06.146488 20592 net.cpp:156] Memory required for data: 90016
I0922 22:13:06.146493 20592 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0922 22:13:06.146505 20592 net.cpp:91] Creating Layer lstm1_h_concat
I0922 22:13:06.146510 20592 net.cpp:425] lstm1_h_concat <- h_1
I0922 22:13:06.146522 20592 net.cpp:399] lstm1_h_concat -> h
I0922 22:13:06.154240 20592 net.cpp:141] Setting up lstm1_h_concat
I0922 22:13:06.154263 20592 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:13:06.154269 20592 net.cpp:156] Memory required for data: 94016
I0922 22:13:06.154275 20592 layer_factory.hpp:77] Creating layer h_pseudoloss
I0922 22:13:06.154289 20592 net.cpp:91] Creating Layer h_pseudoloss
I0922 22:13:06.154294 20592 net.cpp:425] h_pseudoloss <- h
I0922 22:13:06.154304 20592 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0922 22:13:06.154428 20592 net.cpp:141] Setting up h_pseudoloss
I0922 22:13:06.154439 20592 net.cpp:148] Top shape: (1)
I0922 22:13:06.154444 20592 net.cpp:151]     with loss weight 1
I0922 22:13:06.154465 20592 net.cpp:156] Memory required for data: 94020
I0922 22:13:06.154471 20592 net.cpp:217] h_pseudoloss needs backward computation.
I0922 22:13:06.154476 20592 net.cpp:217] lstm1_h_concat needs backward computation.
I0922 22:13:06.154481 20592 net.cpp:219] lstm1_ does not need backward computation.
I0922 22:13:06.154486 20592 net.cpp:217] lstm1_unit_1 needs backward computation.
I0922 22:13:06.154494 20592 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0922 22:13:06.154500 20592 net.cpp:217] lstm1_transform_1 needs backward computation.
I0922 22:13:06.154505 20592 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0922 22:13:06.154510 20592 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0922 22:13:06.154516 20592 net.cpp:217] lstm1_x_transform needs backward computation.
I0922 22:13:06.154521 20592 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0922 22:13:06.154527 20592 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0922 22:13:06.154532 20592 net.cpp:219] lstm1_ does not need backward computation.
I0922 22:13:06.154541 20592 net.cpp:219] lstm1_ does not need backward computation.
I0922 22:13:06.154546 20592 net.cpp:261] This network produces output c_T
I0922 22:13:06.154551 20592 net.cpp:261] This network produces output h_pseudoloss
I0922 22:13:06.154570 20592 net.cpp:274] Network initialization done.
I0922 22:13:06.154625 20592 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0922 22:13:06.154633 20592 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0922 22:13:06.154638 20592 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0922 22:13:06.154757 20592 net.cpp:141] Setting up lstm1
I0922 22:13:06.154768 20592 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:13:06.154773 20592 net.cpp:156] Memory required for data: 26408
I0922 22:13:06.154791 20592 layer_factory.hpp:77] Creating layer concat
I0922 22:13:06.154803 20592 net.cpp:91] Creating Layer concat
I0922 22:13:06.154810 20592 net.cpp:425] concat <- lstm1
I0922 22:13:06.154819 20592 net.cpp:425] concat <- embedded_input_sentence
I0922 22:13:06.154825 20592 net.cpp:425] concat <- reshaped_stage_indicator
I0922 22:13:06.154832 20592 net.cpp:399] concat -> lstm1_video_sequence
I0922 22:13:06.154870 20592 net.cpp:141] Setting up concat
I0922 22:13:06.154881 20592 net.cpp:148] Top shape: 1 1 1501 (1501)
I0922 22:13:06.154886 20592 net.cpp:156] Memory required for data: 32412
I0922 22:13:06.154891 20592 layer_factory.hpp:77] Creating layer lstm2
I0922 22:13:06.154906 20592 net.cpp:91] Creating Layer lstm2
I0922 22:13:06.154912 20592 net.cpp:425] lstm2 <- lstm1_video_sequence
I0922 22:13:06.154918 20592 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0922 22:13:06.154927 20592 net.cpp:399] lstm2 -> lstm2
I0922 22:13:06.154940 20592 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0922 22:13:06.155243 20592 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0922 22:13:06.155339 20592 layer_factory.hpp:77] Creating layer lstm2_
I0922 22:13:06.155354 20592 net.cpp:91] Creating Layer lstm2_
I0922 22:13:06.155360 20592 net.cpp:399] lstm2_ -> x
I0922 22:13:06.155372 20592 net.cpp:399] lstm2_ -> cont
I0922 22:13:06.155439 20592 net.cpp:141] Setting up lstm2_
I0922 22:13:06.155450 20592 net.cpp:148] Top shape: 1 1 1501 (1501)
I0922 22:13:06.155458 20592 net.cpp:148] Top shape: 1 1 (1)
I0922 22:13:06.155462 20592 net.cpp:156] Memory required for data: 6008
I0922 22:13:06.155468 20592 layer_factory.hpp:77] Creating layer lstm2_
I0922 22:13:06.155478 20592 net.cpp:91] Creating Layer lstm2_
I0922 22:13:06.155488 20592 net.cpp:399] lstm2_ -> c_0
I0922 22:13:06.155498 20592 net.cpp:399] lstm2_ -> h_0
I0922 22:13:06.155555 20592 net.cpp:141] Setting up lstm2_
I0922 22:13:06.155565 20592 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:13:06.155572 20592 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:13:06.155576 20592 net.cpp:156] Memory required for data: 14008
I0922 22:13:06.155581 20592 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0922 22:13:06.155591 20592 net.cpp:91] Creating Layer lstm2_cont_slice
I0922 22:13:06.155596 20592 net.cpp:425] lstm2_cont_slice <- cont
I0922 22:13:06.155604 20592 net.cpp:399] lstm2_cont_slice -> cont_1
I0922 22:13:06.155643 20592 net.cpp:141] Setting up lstm2_cont_slice
I0922 22:13:06.155654 20592 net.cpp:148] Top shape: 1 1 (1)
I0922 22:13:06.155659 20592 net.cpp:156] Memory required for data: 14012
I0922 22:13:06.155664 20592 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0922 22:13:06.155674 20592 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0922 22:13:06.155679 20592 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0922 22:13:06.155686 20592 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0922 22:13:06.155695 20592 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0922 22:13:06.155750 20592 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0922 22:13:06.155761 20592 net.cpp:148] Top shape: 1 1 (1)
I0922 22:13:06.155766 20592 net.cpp:148] Top shape: 1 1 (1)
I0922 22:13:06.155771 20592 net.cpp:156] Memory required for data: 14020
I0922 22:13:06.155776 20592 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0922 22:13:06.155787 20592 net.cpp:91] Creating Layer lstm2_x_transform
I0922 22:13:06.155792 20592 net.cpp:425] lstm2_x_transform <- x
I0922 22:13:06.155803 20592 net.cpp:399] lstm2_x_transform -> W_xc_x
I0922 22:13:06.167798 20598 net.cpp:141] Setting up fc7
I0922 22:13:06.167841 20598 net.cpp:148] Top shape: 10 4096 (40960)
I0922 22:13:06.167847 20598 net.cpp:156] Memory required for data: 68273720
I0922 22:13:06.167863 20598 layer_factory.hpp:77] Creating layer relu7
I0922 22:13:06.167881 20598 net.cpp:91] Creating Layer relu7
I0922 22:13:06.167889 20598 net.cpp:425] relu7 <- fc7
I0922 22:13:06.167898 20598 net.cpp:386] relu7 -> fc7 (in-place)
I0922 22:13:06.168501 20598 net.cpp:141] Setting up relu7
I0922 22:13:06.168514 20598 net.cpp:148] Top shape: 10 4096 (40960)
I0922 22:13:06.168519 20598 net.cpp:156] Memory required for data: 68437560
I0922 22:13:06.168524 20598 layer_factory.hpp:77] Creating layer drop7
I0922 22:13:06.168536 20598 net.cpp:91] Creating Layer drop7
I0922 22:13:06.168541 20598 net.cpp:425] drop7 <- fc7
I0922 22:13:06.168548 20598 net.cpp:386] drop7 -> fc7 (in-place)
I0922 22:13:06.168591 20598 net.cpp:141] Setting up drop7
I0922 22:13:06.168601 20598 net.cpp:148] Top shape: 10 4096 (40960)
I0922 22:13:06.168604 20598 net.cpp:156] Memory required for data: 68601400
I0922 22:13:06.168609 20598 layer_factory.hpp:77] Creating layer fc8
I0922 22:13:06.168623 20598 net.cpp:91] Creating Layer fc8
I0922 22:13:06.168628 20598 net.cpp:425] fc8 <- fc7
I0922 22:13:06.168635 20598 net.cpp:399] fc8 -> fc8
I0922 22:13:06.180538 20598 net.cpp:141] Setting up fc8
I0922 22:13:06.180589 20598 net.cpp:148] Top shape: 10 1000 (10000)
I0922 22:13:06.180598 20598 net.cpp:156] Memory required for data: 68641400
I0922 22:13:06.180620 20598 layer_factory.hpp:77] Creating layer prob
I0922 22:13:06.180644 20598 net.cpp:91] Creating Layer prob
I0922 22:13:06.180655 20598 net.cpp:425] prob <- fc8
I0922 22:13:06.180675 20598 net.cpp:399] prob -> prob
I0922 22:13:06.181305 20598 net.cpp:141] Setting up prob
I0922 22:13:06.181326 20598 net.cpp:148] Top shape: 10 1000 (10000)
I0922 22:13:06.181336 20598 net.cpp:156] Memory required for data: 68681400
I0922 22:13:06.181347 20598 net.cpp:219] prob does not need backward computation.
I0922 22:13:06.181358 20598 net.cpp:219] fc8 does not need backward computation.
I0922 22:13:06.181368 20598 net.cpp:219] drop7 does not need backward computation.
I0922 22:13:06.181377 20598 net.cpp:219] relu7 does not need backward computation.
I0922 22:13:06.181385 20598 net.cpp:219] fc7 does not need backward computation.
I0922 22:13:06.181394 20598 net.cpp:219] drop6 does not need backward computation.
I0922 22:13:06.181403 20598 net.cpp:219] relu6 does not need backward computation.
I0922 22:13:06.181412 20598 net.cpp:219] fc6 does not need backward computation.
I0922 22:13:06.181421 20598 net.cpp:219] pool5 does not need backward computation.
I0922 22:13:06.181432 20598 net.cpp:219] relu5 does not need backward computation.
I0922 22:13:06.181440 20598 net.cpp:219] conv5 does not need backward computation.
I0922 22:13:06.181448 20598 net.cpp:219] relu4 does not need backward computation.
I0922 22:13:06.181458 20598 net.cpp:219] conv4 does not need backward computation.
I0922 22:13:06.181468 20598 net.cpp:219] relu3 does not need backward computation.
I0922 22:13:06.181478 20598 net.cpp:219] conv3 does not need backward computation.
I0922 22:13:06.181488 20598 net.cpp:219] norm2 does not need backward computation.
I0922 22:13:06.181498 20598 net.cpp:219] pool2 does not need backward computation.
I0922 22:13:06.181507 20598 net.cpp:219] relu2 does not need backward computation.
I0922 22:13:06.181516 20598 net.cpp:219] conv2 does not need backward computation.
I0922 22:13:06.181525 20598 net.cpp:219] norm1 does not need backward computation.
I0922 22:13:06.181536 20598 net.cpp:219] pool1 does not need backward computation.
I0922 22:13:06.181545 20598 net.cpp:219] relu1 does not need backward computation.
I0922 22:13:06.181555 20598 net.cpp:219] conv1 does not need backward computation.
I0922 22:13:06.181565 20598 net.cpp:219] data does not need backward computation.
I0922 22:13:06.181573 20598 net.cpp:261] This network produces output prob
I0922 22:13:06.181609 20598 net.cpp:274] Network initialization done.
I0922 22:13:06.188050 20588 net.cpp:141] Setting up lstm2_transform_1
I0922 22:13:06.188091 20588 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 22:13:06.188096 20588 net.cpp:156] Memory required for data: 66020
I0922 22:13:06.188117 20588 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0922 22:13:06.188139 20588 net.cpp:91] Creating Layer lstm2_gate_input_1
I0922 22:13:06.188148 20588 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0922 22:13:06.188154 20588 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0922 22:13:06.188163 20588 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0922 22:13:06.188223 20588 net.cpp:141] Setting up lstm2_gate_input_1
I0922 22:13:06.188235 20588 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 22:13:06.188238 20588 net.cpp:156] Memory required for data: 82020
I0922 22:13:06.188243 20588 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0922 22:13:06.188251 20588 net.cpp:91] Creating Layer lstm2_unit_1
I0922 22:13:06.188256 20588 net.cpp:425] lstm2_unit_1 <- c_0
I0922 22:13:06.188262 20588 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0922 22:13:06.188267 20588 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0922 22:13:06.188277 20588 net.cpp:399] lstm2_unit_1 -> c_1
I0922 22:13:06.188285 20588 net.cpp:399] lstm2_unit_1 -> h_1
I0922 22:13:06.188355 20588 net.cpp:141] Setting up lstm2_unit_1
I0922 22:13:06.188365 20588 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:13:06.188371 20588 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:13:06.188375 20588 net.cpp:156] Memory required for data: 90020
I0922 22:13:06.188380 20588 layer_factory.hpp:77] Creating layer lstm2_
I0922 22:13:06.188403 20588 net.cpp:91] Creating Layer lstm2_
I0922 22:13:06.188410 20588 net.cpp:425] lstm2_ <- c_1
I0922 22:13:06.188417 20588 net.cpp:399] lstm2_ -> c_T
I0922 22:13:06.188452 20588 net.cpp:141] Setting up lstm2_
I0922 22:13:06.188459 20588 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:13:06.188464 20588 net.cpp:156] Memory required for data: 94020
I0922 22:13:06.188468 20588 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0922 22:13:06.188478 20588 net.cpp:91] Creating Layer lstm2_h_concat
I0922 22:13:06.188483 20588 net.cpp:425] lstm2_h_concat <- h_1
I0922 22:13:06.188503 20588 net.cpp:399] lstm2_h_concat -> h
I0922 22:13:06.188545 20588 net.cpp:141] Setting up lstm2_h_concat
I0922 22:13:06.188555 20588 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:13:06.188558 20588 net.cpp:156] Memory required for data: 98020
I0922 22:13:06.188563 20588 layer_factory.hpp:77] Creating layer h_pseudoloss
I0922 22:13:06.188572 20588 net.cpp:91] Creating Layer h_pseudoloss
I0922 22:13:06.188576 20588 net.cpp:425] h_pseudoloss <- h
I0922 22:13:06.188583 20588 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0922 22:13:06.188678 20588 net.cpp:141] Setting up h_pseudoloss
I0922 22:13:06.188688 20588 net.cpp:148] Top shape: (1)
I0922 22:13:06.188693 20588 net.cpp:151]     with loss weight 1
I0922 22:13:06.188709 20588 net.cpp:156] Memory required for data: 98024
I0922 22:13:06.188714 20588 net.cpp:217] h_pseudoloss needs backward computation.
I0922 22:13:06.188719 20588 net.cpp:217] lstm2_h_concat needs backward computation.
I0922 22:13:06.188724 20588 net.cpp:219] lstm2_ does not need backward computation.
I0922 22:13:06.188729 20588 net.cpp:217] lstm2_unit_1 needs backward computation.
I0922 22:13:06.188735 20588 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0922 22:13:06.188740 20588 net.cpp:217] lstm2_transform_1 needs backward computation.
I0922 22:13:06.188745 20588 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0922 22:13:06.188750 20588 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0922 22:13:06.188755 20588 net.cpp:217] lstm2_x_transform needs backward computation.
I0922 22:13:06.188760 20588 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0922 22:13:06.188765 20588 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0922 22:13:06.188772 20588 net.cpp:219] lstm2_ does not need backward computation.
I0922 22:13:06.188776 20588 net.cpp:219] lstm2_ does not need backward computation.
I0922 22:13:06.188781 20588 net.cpp:261] This network produces output c_T
I0922 22:13:06.188784 20588 net.cpp:261] This network produces output h_pseudoloss
I0922 22:13:06.188802 20588 net.cpp:274] Network initialization done.
I0922 22:13:06.188851 20588 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0922 22:13:06.188858 20588 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0922 22:13:06.188863 20588 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0922 22:13:06.188964 20588 net.cpp:141] Setting up lstm2
I0922 22:13:06.188977 20588 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:13:06.188982 20588 net.cpp:156] Memory required for data: 36412
I0922 22:13:06.188997 20588 layer_factory.hpp:77] Creating layer predict
I0922 22:13:06.189008 20588 net.cpp:91] Creating Layer predict
I0922 22:13:06.189014 20588 net.cpp:425] predict <- lstm2
I0922 22:13:06.189021 20588 net.cpp:399] predict -> predict
I0922 22:13:06.268168 20592 net.cpp:141] Setting up lstm2_x_transform
I0922 22:13:06.268257 20592 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 22:13:06.268272 20592 net.cpp:156] Memory required for data: 30020
I0922 22:13:06.268312 20592 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0922 22:13:06.268343 20592 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0922 22:13:06.268357 20592 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0922 22:13:06.268378 20592 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0922 22:13:06.268481 20592 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0922 22:13:06.268502 20592 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 22:13:06.268513 20592 net.cpp:156] Memory required for data: 46020
I0922 22:13:06.268524 20592 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0922 22:13:06.268544 20592 net.cpp:91] Creating Layer lstm2_h_conted_0
I0922 22:13:06.268556 20592 net.cpp:425] lstm2_h_conted_0 <- h_0
I0922 22:13:06.268571 20592 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0922 22:13:06.268589 20592 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0922 22:13:06.268816 20592 net.cpp:141] Setting up lstm2_h_conted_0
I0922 22:13:06.268836 20592 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:13:06.268846 20592 net.cpp:156] Memory required for data: 50020
I0922 22:13:06.268856 20592 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0922 22:13:06.268880 20592 net.cpp:91] Creating Layer lstm2_transform_1
I0922 22:13:06.268892 20592 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0922 22:13:06.268913 20592 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0922 22:13:06.314393 20592 net.cpp:141] Setting up lstm2_transform_1
I0922 22:13:06.314447 20592 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 22:13:06.314455 20592 net.cpp:156] Memory required for data: 66020
I0922 22:13:06.314476 20592 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0922 22:13:06.314496 20592 net.cpp:91] Creating Layer lstm2_gate_input_1
I0922 22:13:06.314504 20592 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0922 22:13:06.314512 20592 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0922 22:13:06.314524 20592 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0922 22:13:06.314584 20592 net.cpp:141] Setting up lstm2_gate_input_1
I0922 22:13:06.314594 20592 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 22:13:06.314599 20592 net.cpp:156] Memory required for data: 82020
I0922 22:13:06.314604 20592 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0922 22:13:06.314615 20592 net.cpp:91] Creating Layer lstm2_unit_1
I0922 22:13:06.314620 20592 net.cpp:425] lstm2_unit_1 <- c_0
I0922 22:13:06.314626 20592 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0922 22:13:06.314632 20592 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0922 22:13:06.314640 20592 net.cpp:399] lstm2_unit_1 -> c_1
I0922 22:13:06.314652 20592 net.cpp:399] lstm2_unit_1 -> h_1
I0922 22:13:06.314725 20592 net.cpp:141] Setting up lstm2_unit_1
I0922 22:13:06.314736 20592 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:13:06.314743 20592 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:13:06.314748 20592 net.cpp:156] Memory required for data: 90020
I0922 22:13:06.314754 20592 layer_factory.hpp:77] Creating layer lstm2_
I0922 22:13:06.314764 20592 net.cpp:91] Creating Layer lstm2_
I0922 22:13:06.314769 20592 net.cpp:425] lstm2_ <- c_1
I0922 22:13:06.314777 20592 net.cpp:399] lstm2_ -> c_T
I0922 22:13:06.314811 20592 net.cpp:141] Setting up lstm2_
I0922 22:13:06.314821 20592 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:13:06.314826 20592 net.cpp:156] Memory required for data: 94020
I0922 22:13:06.314832 20592 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0922 22:13:06.314846 20592 net.cpp:91] Creating Layer lstm2_h_concat
I0922 22:13:06.314851 20592 net.cpp:425] lstm2_h_concat <- h_1
I0922 22:13:06.314862 20592 net.cpp:399] lstm2_h_concat -> h
I0922 22:13:06.314900 20592 net.cpp:141] Setting up lstm2_h_concat
I0922 22:13:06.314909 20592 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:13:06.314914 20592 net.cpp:156] Memory required for data: 98020
I0922 22:13:06.314919 20592 layer_factory.hpp:77] Creating layer h_pseudoloss
I0922 22:13:06.314934 20592 net.cpp:91] Creating Layer h_pseudoloss
I0922 22:13:06.314939 20592 net.cpp:425] h_pseudoloss <- h
I0922 22:13:06.314946 20592 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0922 22:13:06.315059 20592 net.cpp:141] Setting up h_pseudoloss
I0922 22:13:06.315073 20592 net.cpp:148] Top shape: (1)
I0922 22:13:06.315078 20592 net.cpp:151]     with loss weight 1
I0922 22:13:06.315101 20592 net.cpp:156] Memory required for data: 98024
I0922 22:13:06.315107 20592 net.cpp:217] h_pseudoloss needs backward computation.
I0922 22:13:06.315112 20592 net.cpp:217] lstm2_h_concat needs backward computation.
I0922 22:13:06.315117 20592 net.cpp:219] lstm2_ does not need backward computation.
I0922 22:13:06.315124 20592 net.cpp:217] lstm2_unit_1 needs backward computation.
I0922 22:13:06.315129 20592 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0922 22:13:06.315135 20592 net.cpp:217] lstm2_transform_1 needs backward computation.
I0922 22:13:06.315140 20592 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0922 22:13:06.315147 20592 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0922 22:13:06.315152 20592 net.cpp:217] lstm2_x_transform needs backward computation.
I0922 22:13:06.315158 20592 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0922 22:13:06.315165 20592 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0922 22:13:06.315171 20592 net.cpp:219] lstm2_ does not need backward computation.
I0922 22:13:06.315174 20592 net.cpp:219] lstm2_ does not need backward computation.
I0922 22:13:06.315178 20592 net.cpp:261] This network produces output c_T
I0922 22:13:06.315184 20592 net.cpp:261] This network produces output h_pseudoloss
I0922 22:13:06.315207 20592 net.cpp:274] Network initialization done.
I0922 22:13:06.315263 20592 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0922 22:13:06.315270 20592 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0922 22:13:06.315275 20592 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0922 22:13:06.315393 20592 net.cpp:141] Setting up lstm2
I0922 22:13:06.315407 20592 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:13:06.315412 20592 net.cpp:156] Memory required for data: 36412
I0922 22:13:06.315430 20592 layer_factory.hpp:77] Creating layer predict
I0922 22:13:06.315444 20592 net.cpp:91] Creating Layer predict
I0922 22:13:06.315452 20592 net.cpp:425] predict <- lstm2
I0922 22:13:06.315460 20592 net.cpp:399] predict -> predict
I0922 22:13:06.480373 20598 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /home/peifeng/work/run/storm102/data/workers/39ad9222-82e3-44ee-9695-5bda60947c31/tmp/cvld6612025725665523881/bvlc_reference_caffenet.caffemodel
I0922 22:13:06.480413 20598 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0922 22:13:06.480418 20598 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0922 22:13:06.480423 20598 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /home/peifeng/work/run/storm102/data/workers/39ad9222-82e3-44ee-9695-5bda60947c31/tmp/cvld6612025725665523881/bvlc_reference_caffenet.caffemodel
I0922 22:13:06.631726 20588 net.cpp:141] Setting up predict
I0922 22:13:06.631772 20588 net.cpp:148] Top shape: 1 1 46168 (46168)
I0922 22:13:06.631779 20588 net.cpp:156] Memory required for data: 221084
I0922 22:13:06.631795 20588 layer_factory.hpp:77] Creating layer probs
I0922 22:13:06.631814 20588 net.cpp:91] Creating Layer probs
I0922 22:13:06.631821 20588 net.cpp:425] probs <- predict
I0922 22:13:06.631832 20588 net.cpp:399] probs -> probs
I0922 22:13:06.632597 20588 net.cpp:141] Setting up probs
I0922 22:13:06.632611 20588 net.cpp:148] Top shape: 1 1 46168 (46168)
I0922 22:13:06.632616 20588 net.cpp:156] Memory required for data: 405756
I0922 22:13:06.632622 20588 net.cpp:219] probs does not need backward computation.
I0922 22:13:06.632627 20588 net.cpp:219] predict does not need backward computation.
I0922 22:13:06.632633 20588 net.cpp:219] lstm2 does not need backward computation.
I0922 22:13:06.632638 20588 net.cpp:219] concat does not need backward computation.
I0922 22:13:06.632644 20588 net.cpp:219] lstm1 does not need backward computation.
I0922 22:13:06.632652 20588 net.cpp:219] embedding does not need backward computation.
I0922 22:13:06.632655 20588 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0922 22:13:06.632661 20588 net.cpp:219] reshape_frames does not need backward computation.
I0922 22:13:06.632665 20588 net.cpp:219] embed_encoder does not need backward computation.
I0922 22:13:06.632670 20588 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0922 22:13:06.632675 20588 net.cpp:219] input does not need backward computation.
I0922 22:13:06.632679 20588 net.cpp:261] This network produces output probs
I0922 22:13:06.632700 20588 net.cpp:274] Network initialization done.
I0922 22:13:06.831842 20592 net.cpp:141] Setting up predict
I0922 22:13:06.831912 20592 net.cpp:148] Top shape: 1 1 46168 (46168)
I0922 22:13:06.831923 20592 net.cpp:156] Memory required for data: 221084
I0922 22:13:06.831943 20592 layer_factory.hpp:77] Creating layer probs
I0922 22:13:06.831967 20592 net.cpp:91] Creating Layer probs
I0922 22:13:06.831979 20592 net.cpp:425] probs <- predict
I0922 22:13:06.831992 20592 net.cpp:399] probs -> probs
I0922 22:13:06.832648 20592 net.cpp:141] Setting up probs
I0922 22:13:06.832667 20592 net.cpp:148] Top shape: 1 1 46168 (46168)
I0922 22:13:06.832676 20592 net.cpp:156] Memory required for data: 405756
I0922 22:13:06.832686 20592 net.cpp:219] probs does not need backward computation.
I0922 22:13:06.832695 20592 net.cpp:219] predict does not need backward computation.
I0922 22:13:06.832700 20592 net.cpp:219] lstm2 does not need backward computation.
I0922 22:13:06.832708 20592 net.cpp:219] concat does not need backward computation.
I0922 22:13:06.832715 20592 net.cpp:219] lstm1 does not need backward computation.
I0922 22:13:06.832723 20592 net.cpp:219] embedding does not need backward computation.
I0922 22:13:06.832729 20592 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0922 22:13:06.832734 20592 net.cpp:219] reshape_frames does not need backward computation.
I0922 22:13:06.832741 20592 net.cpp:219] embed_encoder does not need backward computation.
I0922 22:13:06.832751 20592 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0922 22:13:06.832757 20592 net.cpp:219] input does not need backward computation.
I0922 22:13:06.832762 20592 net.cpp:261] This network produces output probs
I0922 22:13:06.832782 20592 net.cpp:274] Network initialization done.
I0922 22:13:06.894867 20598 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0922 22:13:06.956480 20598 net.cpp:752] Ignoring source layer loss
Loading the model + trained: 10732.7ms
Using cv::Size and some other stuff: 0.167ms
I0922 22:13:06.978981 20588 net.cpp:752] Ignoring source layer data
I0922 22:13:06.979035 20588 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0922 22:13:06.979043 20588 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0922 22:13:07.069144 20588 net.cpp:752] Ignoring source layer cross_entropy_loss
I0922 22:13:07.181339 20592 net.cpp:752] Ignoring source layer data
I0922 22:13:07.181380 20592 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0922 22:13:07.181385 20592 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0922 22:13:07.257361 20592 net.cpp:752] Ignoring source layer cross_entropy_loss
Loading the mean file: 12423.7ms
TIMERTIMER 292798234
TIMERTIMER 266140009
TIMERTIMER 256999953
TIMERTIMER 230858836
TIMERTIMER 236951971
TIMERTIMER 239673037
TIMERTIMER 224557891
TIMERTIMER 244971216
TIMERTIMER 239166602
TIMERTIMER 243298959
TIMERTIMER 246843462
TIMERTIMER 250155348
TIMERTIMER 237180900
TIMERTIMER 237787747
TIMERTIMER 230322050
TIMERTIMER 242569465
TIMERTIMER 230079560
TIMERTIMER 250176731
TIMERTIMER 227260830
TIMERTIMER 233741515
TIMERTIMER 238717038
TIMERTIMER 244123390
TIMERTIMER 232162446
TIMERTIMER 230031288
TIMERTIMER 239681876
TIMERTIMER 238606133
TIMERTIMER 243898715
TIMERTIMER 214201942
TIMERTIMER 236739229
TIMERTIMER 207011182
TIMERTIMER 218950268
TIMERTIMER 217724425
TIMERTIMER 220442888
TIMERTIMER 208890489
TIMERTIMER 214809387
TIMERTIMER 224377502
TIMERTIMER 224919948
TIMERTIMER 214344173
TIMERTIMER 227794321
TIMERTIMER 240200773
TIMERTIMER 218555237
TIMERTIMER 207654824
TIMERTIMER 211252526
TIMERTIMER 218258537
TIMERTIMER 218376699
TIMERTIMER 213635991
TIMERTIMER 206988973
TIMERTIMER 225047339
TIMERTIMER 215898507
TIMERTIMER 212728560
TIMERTIMER 213322980
TIMERTIMER 217712015
TIMERTIMER 229123141
TIMERTIMER 222977674
TIMERTIMER 221017410
TIMERTIMER 212553290
TIMERTIMER 226757440
TIMERTIMER 222265390
TIMERTIMER 230800584
TIMERTIMER 213446864
TIMERTIMER 206517687
TIMERTIMER 212145231
TIMERTIMER 223013007
TIMERTIMER 208508140
TIMERTIMER 225502660
TIMERTIMER 180634251
