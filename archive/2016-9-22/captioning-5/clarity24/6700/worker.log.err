SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/peifeng/tools/storm102/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/peifeng/work/run/storm102/data/supervisor/stormdist/captioning-1-1474595748/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /home/peifeng/work/run/storm102/data/workers/0c8b08ae-716e-4500-94cf-b5dd5f0a3cb3/tmp/cvld8515381897920903124/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0922 21:56:31.954497 14687 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/0c8b08ae-716e-4500-94cf-b5dd5f0a3cb3/tmp/cvld8515381897920903124/s2vt.words_to_preds.prototxt
I0922 21:56:31.954629 14687 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0922 21:56:31.954638 14687 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0922 21:56:31.954864 14693 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0922 21:56:31.954907 14687 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0922 21:56:31.955000 14693 layer_factory.hpp:77] Creating layer data
I0922 21:56:31.955041 14693 net.cpp:91] Creating Layer data
I0922 21:56:31.955042 14687 layer_factory.hpp:77] Creating layer input
I0922 21:56:31.955055 14693 net.cpp:399] data -> data
I0922 21:56:31.955060 14687 net.cpp:91] Creating Layer input
I0922 21:56:31.955068 14687 net.cpp:399] input -> frames_fc7
I0922 21:56:31.955101 14687 net.cpp:399] input -> cont_sentence
I0922 21:56:31.955118 14687 net.cpp:399] input -> input_sentence
I0922 21:56:31.955130 14687 net.cpp:399] input -> stage_indicator
I0922 21:56:32.563604 14693 net.cpp:141] Setting up data
I0922 21:56:32.563717 14693 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0922 21:56:32.563726 14693 net.cpp:156] Memory required for data: 6183480
I0922 21:56:32.563748 14693 layer_factory.hpp:77] Creating layer conv1
I0922 21:56:32.563783 14693 net.cpp:91] Creating Layer conv1
I0922 21:56:32.563793 14693 net.cpp:425] conv1 <- data
I0922 21:56:32.563791 14687 net.cpp:141] Setting up input
I0922 21:56:32.563807 14693 net.cpp:399] conv1 -> conv1
I0922 21:56:32.563813 14687 net.cpp:148] Top shape: 1 4096 (4096)
I0922 21:56:32.563822 14687 net.cpp:148] Top shape: 1 1 (1)
I0922 21:56:32.563828 14687 net.cpp:148] Top shape: 1 1 (1)
I0922 21:56:32.563834 14687 net.cpp:148] Top shape: 1 1 (1)
I0922 21:56:32.563839 14687 net.cpp:156] Memory required for data: 16396
I0922 21:56:32.563846 14687 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0922 21:56:32.563868 14687 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0922 21:56:32.563874 14687 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0922 21:56:32.563902 14687 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0922 21:56:32.563916 14687 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0922 21:56:32.564083 14687 net.cpp:141] Setting up cont_sentence_input_1_split
I0922 21:56:32.564096 14687 net.cpp:148] Top shape: 1 1 (1)
I0922 21:56:32.564103 14687 net.cpp:148] Top shape: 1 1 (1)
I0922 21:56:32.564108 14687 net.cpp:156] Memory required for data: 16404
I0922 21:56:32.564115 14687 layer_factory.hpp:77] Creating layer embed_encoder
I0922 21:56:32.564139 14687 net.cpp:91] Creating Layer embed_encoder
I0922 21:56:32.564146 14687 net.cpp:425] embed_encoder <- frames_fc7
I0922 21:56:32.564155 14687 net.cpp:399] embed_encoder -> embedded_in_frames
I0922 21:56:32.594105 14687 net.cpp:141] Setting up embed_encoder
I0922 21:56:32.594162 14687 net.cpp:148] Top shape: 1 500 (500)
I0922 21:56:32.594171 14687 net.cpp:156] Memory required for data: 18404
I0922 21:56:32.594203 14687 layer_factory.hpp:77] Creating layer reshape_frames
I0922 21:56:32.594235 14687 net.cpp:91] Creating Layer reshape_frames
I0922 21:56:32.594244 14687 net.cpp:425] reshape_frames <- embedded_in_frames
I0922 21:56:32.594257 14687 net.cpp:399] reshape_frames -> embedded_input_frames
I0922 21:56:32.594315 14687 net.cpp:141] Setting up reshape_frames
I0922 21:56:32.594326 14687 net.cpp:148] Top shape: 1 1 500 (500)
I0922 21:56:32.594331 14687 net.cpp:156] Memory required for data: 20404
I0922 21:56:32.594336 14687 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0922 21:56:32.594353 14687 net.cpp:91] Creating Layer reshape_stage_indicator
I0922 21:56:32.594360 14687 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0922 21:56:32.594369 14687 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0922 21:56:32.594411 14687 net.cpp:141] Setting up reshape_stage_indicator
I0922 21:56:32.594422 14687 net.cpp:148] Top shape: 1 1 1 (1)
I0922 21:56:32.594427 14687 net.cpp:156] Memory required for data: 20408
I0922 21:56:32.594434 14687 layer_factory.hpp:77] Creating layer embedding
I0922 21:56:32.594445 14687 net.cpp:91] Creating Layer embedding
I0922 21:56:32.594451 14687 net.cpp:425] embedding <- input_sentence
I0922 21:56:32.594465 14687 net.cpp:399] embedding -> embedded_input_sentence
I0922 21:56:32.823807 14693 net.cpp:141] Setting up conv1
I0922 21:56:32.823868 14693 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0922 21:56:32.823876 14693 net.cpp:156] Memory required for data: 17799480
I0922 21:56:32.823900 14693 layer_factory.hpp:77] Creating layer relu1
I0922 21:56:32.823925 14693 net.cpp:91] Creating Layer relu1
I0922 21:56:32.823933 14693 net.cpp:425] relu1 <- conv1
I0922 21:56:32.823941 14693 net.cpp:386] relu1 -> conv1 (in-place)
I0922 21:56:32.824409 14693 net.cpp:141] Setting up relu1
I0922 21:56:32.824425 14693 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0922 21:56:32.824431 14693 net.cpp:156] Memory required for data: 29415480
I0922 21:56:32.824437 14693 layer_factory.hpp:77] Creating layer pool1
I0922 21:56:32.824455 14693 net.cpp:91] Creating Layer pool1
I0922 21:56:32.824461 14693 net.cpp:425] pool1 <- conv1
I0922 21:56:32.824470 14693 net.cpp:399] pool1 -> pool1
I0922 21:56:32.824578 14693 net.cpp:141] Setting up pool1
I0922 21:56:32.824590 14693 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0922 21:56:32.824596 14693 net.cpp:156] Memory required for data: 32214840
I0922 21:56:32.824601 14693 layer_factory.hpp:77] Creating layer norm1
I0922 21:56:32.824622 14693 net.cpp:91] Creating Layer norm1
I0922 21:56:32.824628 14693 net.cpp:425] norm1 <- pool1
I0922 21:56:32.824636 14693 net.cpp:399] norm1 -> norm1
I0922 21:56:32.824940 14693 net.cpp:141] Setting up norm1
I0922 21:56:32.824960 14693 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0922 21:56:32.824966 14693 net.cpp:156] Memory required for data: 35014200
I0922 21:56:32.824972 14693 layer_factory.hpp:77] Creating layer conv2
I0922 21:56:32.824990 14693 net.cpp:91] Creating Layer conv2
I0922 21:56:32.824996 14693 net.cpp:425] conv2 <- norm1
I0922 21:56:32.825004 14693 net.cpp:399] conv2 -> conv2
I0922 21:56:32.828526 14693 net.cpp:141] Setting up conv2
I0922 21:56:32.828548 14693 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0922 21:56:32.828554 14693 net.cpp:156] Memory required for data: 42479160
I0922 21:56:32.828568 14693 layer_factory.hpp:77] Creating layer relu2
I0922 21:56:32.828583 14693 net.cpp:91] Creating Layer relu2
I0922 21:56:32.828588 14693 net.cpp:425] relu2 <- conv2
I0922 21:56:32.828596 14693 net.cpp:386] relu2 -> conv2 (in-place)
I0922 21:56:32.829030 14693 net.cpp:141] Setting up relu2
I0922 21:56:32.829046 14693 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0922 21:56:32.829051 14693 net.cpp:156] Memory required for data: 49944120
I0922 21:56:32.829057 14693 layer_factory.hpp:77] Creating layer pool2
I0922 21:56:32.829071 14693 net.cpp:91] Creating Layer pool2
I0922 21:56:32.829077 14693 net.cpp:425] pool2 <- conv2
I0922 21:56:32.829084 14693 net.cpp:399] pool2 -> pool2
I0922 21:56:32.829149 14693 net.cpp:141] Setting up pool2
I0922 21:56:32.829159 14693 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0922 21:56:32.829164 14693 net.cpp:156] Memory required for data: 51674680
I0922 21:56:32.829170 14693 layer_factory.hpp:77] Creating layer norm2
I0922 21:56:32.829185 14693 net.cpp:91] Creating Layer norm2
I0922 21:56:32.829190 14693 net.cpp:425] norm2 <- pool2
I0922 21:56:32.829198 14693 net.cpp:399] norm2 -> norm2
I0922 21:56:32.829485 14693 net.cpp:141] Setting up norm2
I0922 21:56:32.829499 14693 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0922 21:56:32.829504 14693 net.cpp:156] Memory required for data: 53405240
I0922 21:56:32.829510 14693 layer_factory.hpp:77] Creating layer conv3
I0922 21:56:32.829522 14693 net.cpp:91] Creating Layer conv3
I0922 21:56:32.829527 14693 net.cpp:425] conv3 <- norm2
I0922 21:56:32.829540 14693 net.cpp:399] conv3 -> conv3
I0922 21:56:32.833637 14693 net.cpp:141] Setting up conv3
I0922 21:56:32.833685 14693 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0922 21:56:32.833693 14693 net.cpp:156] Memory required for data: 56001080
I0922 21:56:32.833715 14693 layer_factory.hpp:77] Creating layer relu3
I0922 21:56:32.833734 14693 net.cpp:91] Creating Layer relu3
I0922 21:56:32.833741 14693 net.cpp:425] relu3 <- conv3
I0922 21:56:32.833755 14693 net.cpp:386] relu3 -> conv3 (in-place)
I0922 21:56:32.834024 14693 net.cpp:141] Setting up relu3
I0922 21:56:32.834040 14693 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0922 21:56:32.834046 14693 net.cpp:156] Memory required for data: 58596920
I0922 21:56:32.834051 14693 layer_factory.hpp:77] Creating layer conv4
I0922 21:56:32.834069 14693 net.cpp:91] Creating Layer conv4
I0922 21:56:32.834074 14693 net.cpp:425] conv4 <- conv3
I0922 21:56:32.834095 14693 net.cpp:399] conv4 -> conv4
I0922 21:56:32.839217 14693 net.cpp:141] Setting up conv4
I0922 21:56:32.839260 14693 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0922 21:56:32.839267 14693 net.cpp:156] Memory required for data: 61192760
I0922 21:56:32.839283 14693 layer_factory.hpp:77] Creating layer relu4
I0922 21:56:32.839308 14693 net.cpp:91] Creating Layer relu4
I0922 21:56:32.839315 14693 net.cpp:425] relu4 <- conv4
I0922 21:56:32.839324 14693 net.cpp:386] relu4 -> conv4 (in-place)
I0922 21:56:32.839758 14693 net.cpp:141] Setting up relu4
I0922 21:56:32.839773 14693 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0922 21:56:32.839779 14693 net.cpp:156] Memory required for data: 63788600
I0922 21:56:32.839785 14693 layer_factory.hpp:77] Creating layer conv5
I0922 21:56:32.839808 14693 net.cpp:91] Creating Layer conv5
I0922 21:56:32.839814 14693 net.cpp:425] conv5 <- conv4
I0922 21:56:32.839823 14693 net.cpp:399] conv5 -> conv5
I0922 21:56:32.843801 14687 net.cpp:141] Setting up embedding
I0922 21:56:32.843844 14687 net.cpp:148] Top shape: 1 1 500 (500)
I0922 21:56:32.843852 14687 net.cpp:156] Memory required for data: 22408
I0922 21:56:32.843868 14687 layer_factory.hpp:77] Creating layer lstm1
I0922 21:56:32.843888 14687 net.cpp:91] Creating Layer lstm1
I0922 21:56:32.843897 14687 net.cpp:425] lstm1 <- embedded_input_frames
I0922 21:56:32.843907 14687 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0922 21:56:32.843921 14687 net.cpp:399] lstm1 -> lstm1
I0922 21:56:32.843960 14687 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0922 21:56:32.843955 14693 net.cpp:141] Setting up conv5
I0922 21:56:32.843981 14693 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0922 21:56:32.843986 14693 net.cpp:156] Memory required for data: 65519160
I0922 21:56:32.844007 14693 layer_factory.hpp:77] Creating layer relu5
I0922 21:56:32.844020 14693 net.cpp:91] Creating Layer relu5
I0922 21:56:32.844027 14693 net.cpp:425] relu5 <- conv5
I0922 21:56:32.844034 14693 net.cpp:386] relu5 -> conv5 (in-place)
I0922 21:56:32.844363 14687 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0922 21:56:32.844468 14687 layer_factory.hpp:77] Creating layer lstm1_
I0922 21:56:32.844482 14687 net.cpp:91] Creating Layer lstm1_
I0922 21:56:32.844490 14687 net.cpp:399] lstm1_ -> x
I0922 21:56:32.844502 14687 net.cpp:399] lstm1_ -> cont
I0922 21:56:32.844571 14693 net.cpp:141] Setting up relu5
I0922 21:56:32.844589 14693 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0922 21:56:32.844595 14693 net.cpp:156] Memory required for data: 67249720
I0922 21:56:32.844601 14693 layer_factory.hpp:77] Creating layer pool5
I0922 21:56:32.844614 14693 net.cpp:91] Creating Layer pool5
I0922 21:56:32.844619 14693 net.cpp:425] pool5 <- conv5
I0922 21:56:32.844627 14693 net.cpp:399] pool5 -> pool5
I0922 21:56:32.844637 14687 net.cpp:141] Setting up lstm1_
I0922 21:56:32.844650 14687 net.cpp:148] Top shape: 1 1 500 (500)
I0922 21:56:32.844658 14687 net.cpp:148] Top shape: 1 1 (1)
I0922 21:56:32.844663 14687 net.cpp:156] Memory required for data: 2004
I0922 21:56:32.844669 14687 layer_factory.hpp:77] Creating layer lstm1_
I0922 21:56:32.844679 14687 net.cpp:91] Creating Layer lstm1_
I0922 21:56:32.844691 14687 net.cpp:399] lstm1_ -> c_0
I0922 21:56:32.844702 14687 net.cpp:399] lstm1_ -> h_0
I0922 21:56:32.844713 14693 net.cpp:141] Setting up pool5
I0922 21:56:32.844725 14693 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0922 21:56:32.844730 14693 net.cpp:156] Memory required for data: 67618360
I0922 21:56:32.844738 14693 layer_factory.hpp:77] Creating layer fc6
I0922 21:56:32.844755 14693 net.cpp:91] Creating Layer fc6
I0922 21:56:32.844761 14693 net.cpp:425] fc6 <- pool5
I0922 21:56:32.844769 14693 net.cpp:399] fc6 -> fc6
I0922 21:56:32.844780 14687 net.cpp:141] Setting up lstm1_
I0922 21:56:32.844792 14687 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:56:32.844799 14687 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:56:32.844804 14687 net.cpp:156] Memory required for data: 10004
I0922 21:56:32.844808 14687 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0922 21:56:32.844818 14687 net.cpp:91] Creating Layer lstm1_cont_slice
I0922 21:56:32.844825 14687 net.cpp:425] lstm1_cont_slice <- cont
I0922 21:56:32.844835 14687 net.cpp:399] lstm1_cont_slice -> cont_1
I0922 21:56:32.916779 14687 net.cpp:141] Setting up lstm1_cont_slice
I0922 21:56:32.916812 14687 net.cpp:148] Top shape: 1 1 (1)
I0922 21:56:32.916818 14687 net.cpp:156] Memory required for data: 10008
I0922 21:56:32.916826 14687 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0922 21:56:32.916844 14687 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0922 21:56:32.916851 14687 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0922 21:56:32.916859 14687 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0922 21:56:32.916870 14687 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0922 21:56:32.916935 14687 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0922 21:56:32.916945 14687 net.cpp:148] Top shape: 1 1 (1)
I0922 21:56:32.916952 14687 net.cpp:148] Top shape: 1 1 (1)
I0922 21:56:32.916957 14687 net.cpp:156] Memory required for data: 10016
I0922 21:56:32.916962 14687 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0922 21:56:32.916976 14687 net.cpp:91] Creating Layer lstm1_x_transform
I0922 21:56:32.916981 14687 net.cpp:425] lstm1_x_transform <- x
I0922 21:56:32.916990 14687 net.cpp:399] lstm1_x_transform -> W_xc_x
I0922 21:56:32.949661 14687 net.cpp:141] Setting up lstm1_x_transform
I0922 21:56:32.949712 14687 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:56:32.949720 14687 net.cpp:156] Memory required for data: 26016
I0922 21:56:32.949749 14687 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0922 21:56:32.949769 14687 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0922 21:56:32.949779 14687 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0922 21:56:32.949792 14687 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0922 21:56:32.949856 14687 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0922 21:56:32.949872 14687 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:56:32.949879 14687 net.cpp:156] Memory required for data: 42016
I0922 21:56:32.949888 14687 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0922 21:56:32.949908 14687 net.cpp:91] Creating Layer lstm1_h_conted_0
I0922 21:56:32.949918 14687 net.cpp:425] lstm1_h_conted_0 <- h_0
I0922 21:56:32.949928 14687 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0922 21:56:32.949939 14687 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0922 21:56:32.950080 14687 net.cpp:141] Setting up lstm1_h_conted_0
I0922 21:56:32.950096 14687 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:56:32.950104 14687 net.cpp:156] Memory required for data: 46016
I0922 21:56:32.950111 14687 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0922 21:56:32.950131 14687 net.cpp:91] Creating Layer lstm1_transform_1
I0922 21:56:32.950140 14687 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0922 21:56:32.950152 14687 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0922 21:56:32.960937 14693 net.cpp:141] Setting up fc6
I0922 21:56:32.960984 14693 net.cpp:148] Top shape: 10 4096 (40960)
I0922 21:56:32.960991 14693 net.cpp:156] Memory required for data: 67782200
I0922 21:56:32.961009 14693 layer_factory.hpp:77] Creating layer relu6
I0922 21:56:32.961030 14693 net.cpp:91] Creating Layer relu6
I0922 21:56:32.961038 14693 net.cpp:425] relu6 <- fc6
I0922 21:56:32.961050 14693 net.cpp:386] relu6 -> fc6 (in-place)
I0922 21:56:32.961441 14693 net.cpp:141] Setting up relu6
I0922 21:56:32.961454 14693 net.cpp:148] Top shape: 10 4096 (40960)
I0922 21:56:32.961460 14693 net.cpp:156] Memory required for data: 67946040
I0922 21:56:32.961467 14693 layer_factory.hpp:77] Creating layer drop6
I0922 21:56:32.961478 14693 net.cpp:91] Creating Layer drop6
I0922 21:56:32.961486 14693 net.cpp:425] drop6 <- fc6
I0922 21:56:32.961493 14693 net.cpp:386] drop6 -> fc6 (in-place)
I0922 21:56:32.961549 14693 net.cpp:141] Setting up drop6
I0922 21:56:32.961560 14693 net.cpp:148] Top shape: 10 4096 (40960)
I0922 21:56:32.961565 14693 net.cpp:156] Memory required for data: 68109880
I0922 21:56:32.961570 14693 layer_factory.hpp:77] Creating layer fc7
I0922 21:56:32.961586 14693 net.cpp:91] Creating Layer fc7
I0922 21:56:32.961591 14693 net.cpp:425] fc7 <- fc6
I0922 21:56:32.961601 14693 net.cpp:399] fc7 -> fc7
I0922 21:56:33.003604 14687 net.cpp:141] Setting up lstm1_transform_1
I0922 21:56:33.003665 14687 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:56:33.003674 14687 net.cpp:156] Memory required for data: 62016
I0922 21:56:33.003695 14687 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0922 21:56:33.003716 14687 net.cpp:91] Creating Layer lstm1_gate_input_1
I0922 21:56:33.003728 14687 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0922 21:56:33.003738 14687 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0922 21:56:33.003747 14687 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0922 21:56:33.003811 14687 net.cpp:141] Setting up lstm1_gate_input_1
I0922 21:56:33.003823 14687 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:56:33.003829 14687 net.cpp:156] Memory required for data: 78016
I0922 21:56:33.003834 14687 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0922 21:56:33.003849 14687 net.cpp:91] Creating Layer lstm1_unit_1
I0922 21:56:33.003855 14687 net.cpp:425] lstm1_unit_1 <- c_0
I0922 21:56:33.003862 14687 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0922 21:56:33.003870 14687 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0922 21:56:33.003878 14687 net.cpp:399] lstm1_unit_1 -> c_1
I0922 21:56:33.003890 14687 net.cpp:399] lstm1_unit_1 -> h_1
I0922 21:56:33.003964 14687 net.cpp:141] Setting up lstm1_unit_1
I0922 21:56:33.003976 14687 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:56:33.003983 14687 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:56:33.003989 14687 net.cpp:156] Memory required for data: 86016
I0922 21:56:33.003995 14687 layer_factory.hpp:77] Creating layer lstm1_
I0922 21:56:33.004005 14687 net.cpp:91] Creating Layer lstm1_
I0922 21:56:33.004010 14687 net.cpp:425] lstm1_ <- c_1
I0922 21:56:33.004022 14687 net.cpp:399] lstm1_ -> c_T
I0922 21:56:33.004057 14687 net.cpp:141] Setting up lstm1_
I0922 21:56:33.004068 14687 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:56:33.004075 14687 net.cpp:156] Memory required for data: 90016
I0922 21:56:33.004081 14687 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0922 21:56:33.004092 14687 net.cpp:91] Creating Layer lstm1_h_concat
I0922 21:56:33.004097 14687 net.cpp:425] lstm1_h_concat <- h_1
I0922 21:56:33.004106 14687 net.cpp:399] lstm1_h_concat -> h
I0922 21:56:33.004163 14687 net.cpp:141] Setting up lstm1_h_concat
I0922 21:56:33.004174 14687 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:56:33.004179 14687 net.cpp:156] Memory required for data: 94016
I0922 21:56:33.004185 14687 layer_factory.hpp:77] Creating layer h_pseudoloss
I0922 21:56:33.004202 14687 net.cpp:91] Creating Layer h_pseudoloss
I0922 21:56:33.004209 14687 net.cpp:425] h_pseudoloss <- h
I0922 21:56:33.004217 14687 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0922 21:56:33.004328 14687 net.cpp:141] Setting up h_pseudoloss
I0922 21:56:33.004341 14687 net.cpp:148] Top shape: (1)
I0922 21:56:33.004348 14687 net.cpp:151]     with loss weight 1
I0922 21:56:33.004398 14687 net.cpp:156] Memory required for data: 94020
I0922 21:56:33.004406 14687 net.cpp:217] h_pseudoloss needs backward computation.
I0922 21:56:33.004412 14687 net.cpp:217] lstm1_h_concat needs backward computation.
I0922 21:56:33.004417 14687 net.cpp:219] lstm1_ does not need backward computation.
I0922 21:56:33.004423 14687 net.cpp:217] lstm1_unit_1 needs backward computation.
I0922 21:56:33.004431 14687 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0922 21:56:33.004436 14687 net.cpp:217] lstm1_transform_1 needs backward computation.
I0922 21:56:33.004442 14687 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0922 21:56:33.004449 14687 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0922 21:56:33.004456 14687 net.cpp:217] lstm1_x_transform needs backward computation.
I0922 21:56:33.004462 14687 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0922 21:56:33.004468 14687 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0922 21:56:33.004474 14687 net.cpp:219] lstm1_ does not need backward computation.
I0922 21:56:33.004480 14687 net.cpp:219] lstm1_ does not need backward computation.
I0922 21:56:33.004484 14687 net.cpp:261] This network produces output c_T
I0922 21:56:33.004490 14687 net.cpp:261] This network produces output h_pseudoloss
I0922 21:56:33.004510 14687 net.cpp:274] Network initialization done.
I0922 21:56:33.004576 14687 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0922 21:56:33.004585 14687 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0922 21:56:33.004590 14687 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0922 21:56:33.004724 14687 net.cpp:141] Setting up lstm1
I0922 21:56:33.004739 14687 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:56:33.004745 14687 net.cpp:156] Memory required for data: 26408
I0922 21:56:33.004763 14687 layer_factory.hpp:77] Creating layer concat
I0922 21:56:33.004776 14687 net.cpp:91] Creating Layer concat
I0922 21:56:33.004783 14687 net.cpp:425] concat <- lstm1
I0922 21:56:33.004792 14687 net.cpp:425] concat <- embedded_input_sentence
I0922 21:56:33.004799 14687 net.cpp:425] concat <- reshaped_stage_indicator
I0922 21:56:33.004807 14687 net.cpp:399] concat -> lstm1_video_sequence
I0922 21:56:33.004848 14687 net.cpp:141] Setting up concat
I0922 21:56:33.004859 14687 net.cpp:148] Top shape: 1 1 1501 (1501)
I0922 21:56:33.004865 14687 net.cpp:156] Memory required for data: 32412
I0922 21:56:33.004870 14687 layer_factory.hpp:77] Creating layer lstm2
I0922 21:56:33.004884 14687 net.cpp:91] Creating Layer lstm2
I0922 21:56:33.004891 14687 net.cpp:425] lstm2 <- lstm1_video_sequence
I0922 21:56:33.004899 14687 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0922 21:56:33.004907 14687 net.cpp:399] lstm2 -> lstm2
I0922 21:56:33.004920 14687 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0922 21:56:33.005239 14687 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0922 21:56:33.005343 14687 layer_factory.hpp:77] Creating layer lstm2_
I0922 21:56:33.005357 14687 net.cpp:91] Creating Layer lstm2_
I0922 21:56:33.005365 14687 net.cpp:399] lstm2_ -> x
I0922 21:56:33.005378 14687 net.cpp:399] lstm2_ -> cont
I0922 21:56:33.005444 14687 net.cpp:141] Setting up lstm2_
I0922 21:56:33.005455 14687 net.cpp:148] Top shape: 1 1 1501 (1501)
I0922 21:56:33.005463 14687 net.cpp:148] Top shape: 1 1 (1)
I0922 21:56:33.005468 14687 net.cpp:156] Memory required for data: 6008
I0922 21:56:33.005475 14687 layer_factory.hpp:77] Creating layer lstm2_
I0922 21:56:33.005489 14687 net.cpp:91] Creating Layer lstm2_
I0922 21:56:33.005497 14687 net.cpp:399] lstm2_ -> c_0
I0922 21:56:33.005509 14687 net.cpp:399] lstm2_ -> h_0
I0922 21:56:33.005568 14687 net.cpp:141] Setting up lstm2_
I0922 21:56:33.005579 14687 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:56:33.005586 14687 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:56:33.005591 14687 net.cpp:156] Memory required for data: 14008
I0922 21:56:33.005597 14687 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0922 21:56:33.005606 14687 net.cpp:91] Creating Layer lstm2_cont_slice
I0922 21:56:33.005612 14687 net.cpp:425] lstm2_cont_slice <- cont
I0922 21:56:33.005621 14687 net.cpp:399] lstm2_cont_slice -> cont_1
I0922 21:56:33.005662 14687 net.cpp:141] Setting up lstm2_cont_slice
I0922 21:56:33.005673 14687 net.cpp:148] Top shape: 1 1 (1)
I0922 21:56:33.005679 14687 net.cpp:156] Memory required for data: 14012
I0922 21:56:33.005686 14687 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0922 21:56:33.005693 14687 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0922 21:56:33.005699 14687 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0922 21:56:33.005710 14687 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0922 21:56:33.005720 14687 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0922 21:56:33.005775 14687 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0922 21:56:33.005789 14687 net.cpp:148] Top shape: 1 1 (1)
I0922 21:56:33.005796 14687 net.cpp:148] Top shape: 1 1 (1)
I0922 21:56:33.005801 14687 net.cpp:156] Memory required for data: 14020
I0922 21:56:33.005807 14687 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0922 21:56:33.005820 14687 net.cpp:91] Creating Layer lstm2_x_transform
I0922 21:56:33.005825 14687 net.cpp:425] lstm2_x_transform <- x
I0922 21:56:33.005837 14687 net.cpp:399] lstm2_x_transform -> W_xc_x
I0922 21:56:33.018636 14693 net.cpp:141] Setting up fc7
I0922 21:56:33.018683 14693 net.cpp:148] Top shape: 10 4096 (40960)
I0922 21:56:33.018690 14693 net.cpp:156] Memory required for data: 68273720
I0922 21:56:33.018708 14693 layer_factory.hpp:77] Creating layer relu7
I0922 21:56:33.018730 14693 net.cpp:91] Creating Layer relu7
I0922 21:56:33.018738 14693 net.cpp:425] relu7 <- fc7
I0922 21:56:33.018748 14693 net.cpp:386] relu7 -> fc7 (in-place)
I0922 21:56:33.019470 14693 net.cpp:141] Setting up relu7
I0922 21:56:33.019486 14693 net.cpp:148] Top shape: 10 4096 (40960)
I0922 21:56:33.019492 14693 net.cpp:156] Memory required for data: 68437560
I0922 21:56:33.019498 14693 layer_factory.hpp:77] Creating layer drop7
I0922 21:56:33.019511 14693 net.cpp:91] Creating Layer drop7
I0922 21:56:33.019517 14693 net.cpp:425] drop7 <- fc7
I0922 21:56:33.019528 14693 net.cpp:386] drop7 -> fc7 (in-place)
I0922 21:56:33.019572 14693 net.cpp:141] Setting up drop7
I0922 21:56:33.019582 14693 net.cpp:148] Top shape: 10 4096 (40960)
I0922 21:56:33.019587 14693 net.cpp:156] Memory required for data: 68601400
I0922 21:56:33.019593 14693 layer_factory.hpp:77] Creating layer fc8
I0922 21:56:33.019608 14693 net.cpp:91] Creating Layer fc8
I0922 21:56:33.019613 14693 net.cpp:425] fc8 <- fc7
I0922 21:56:33.019621 14693 net.cpp:399] fc8 -> fc8
I0922 21:56:33.032373 14693 net.cpp:141] Setting up fc8
I0922 21:56:33.032424 14693 net.cpp:148] Top shape: 10 1000 (10000)
I0922 21:56:33.032431 14693 net.cpp:156] Memory required for data: 68641400
I0922 21:56:33.032447 14693 layer_factory.hpp:77] Creating layer prob
I0922 21:56:33.032467 14693 net.cpp:91] Creating Layer prob
I0922 21:56:33.032476 14693 net.cpp:425] prob <- fc8
I0922 21:56:33.032490 14693 net.cpp:399] prob -> prob
I0922 21:56:33.032968 14693 net.cpp:141] Setting up prob
I0922 21:56:33.032981 14693 net.cpp:148] Top shape: 10 1000 (10000)
I0922 21:56:33.032987 14693 net.cpp:156] Memory required for data: 68681400
I0922 21:56:33.032994 14693 net.cpp:219] prob does not need backward computation.
I0922 21:56:33.032999 14693 net.cpp:219] fc8 does not need backward computation.
I0922 21:56:33.033005 14693 net.cpp:219] drop7 does not need backward computation.
I0922 21:56:33.033010 14693 net.cpp:219] relu7 does not need backward computation.
I0922 21:56:33.033015 14693 net.cpp:219] fc7 does not need backward computation.
I0922 21:56:33.033020 14693 net.cpp:219] drop6 does not need backward computation.
I0922 21:56:33.033025 14693 net.cpp:219] relu6 does not need backward computation.
I0922 21:56:33.033030 14693 net.cpp:219] fc6 does not need backward computation.
I0922 21:56:33.033035 14693 net.cpp:219] pool5 does not need backward computation.
I0922 21:56:33.033041 14693 net.cpp:219] relu5 does not need backward computation.
I0922 21:56:33.033046 14693 net.cpp:219] conv5 does not need backward computation.
I0922 21:56:33.033051 14693 net.cpp:219] relu4 does not need backward computation.
I0922 21:56:33.033054 14693 net.cpp:219] conv4 does not need backward computation.
I0922 21:56:33.033059 14693 net.cpp:219] relu3 does not need backward computation.
I0922 21:56:33.033064 14693 net.cpp:219] conv3 does not need backward computation.
I0922 21:56:33.033071 14693 net.cpp:219] norm2 does not need backward computation.
I0922 21:56:33.033076 14693 net.cpp:219] pool2 does not need backward computation.
I0922 21:56:33.033080 14693 net.cpp:219] relu2 does not need backward computation.
I0922 21:56:33.033085 14693 net.cpp:219] conv2 does not need backward computation.
I0922 21:56:33.033090 14693 net.cpp:219] norm1 does not need backward computation.
I0922 21:56:33.033097 14693 net.cpp:219] pool1 does not need backward computation.
I0922 21:56:33.033102 14693 net.cpp:219] relu1 does not need backward computation.
I0922 21:56:33.033107 14693 net.cpp:219] conv1 does not need backward computation.
I0922 21:56:33.033112 14693 net.cpp:219] data does not need backward computation.
I0922 21:56:33.033116 14693 net.cpp:261] This network produces output prob
I0922 21:56:33.033138 14693 net.cpp:274] Network initialization done.
I0922 21:56:33.070444 14687 net.cpp:141] Setting up lstm2_x_transform
I0922 21:56:33.070502 14687 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:56:33.070509 14687 net.cpp:156] Memory required for data: 30020
I0922 21:56:33.070533 14687 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0922 21:56:33.070549 14687 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0922 21:56:33.070555 14687 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0922 21:56:33.070565 14687 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0922 21:56:33.070622 14687 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0922 21:56:33.070636 14687 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:56:33.070641 14687 net.cpp:156] Memory required for data: 46020
I0922 21:56:33.070646 14687 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0922 21:56:33.070657 14687 net.cpp:91] Creating Layer lstm2_h_conted_0
I0922 21:56:33.070662 14687 net.cpp:425] lstm2_h_conted_0 <- h_0
I0922 21:56:33.070669 14687 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0922 21:56:33.070677 14687 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0922 21:56:33.070778 14687 net.cpp:141] Setting up lstm2_h_conted_0
I0922 21:56:33.070790 14687 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:56:33.070794 14687 net.cpp:156] Memory required for data: 50020
I0922 21:56:33.070799 14687 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0922 21:56:33.070812 14687 net.cpp:91] Creating Layer lstm2_transform_1
I0922 21:56:33.070818 14687 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0922 21:56:33.070827 14687 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0922 21:56:33.113034 14687 net.cpp:141] Setting up lstm2_transform_1
I0922 21:56:33.113092 14687 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:56:33.113098 14687 net.cpp:156] Memory required for data: 66020
I0922 21:56:33.113119 14687 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0922 21:56:33.113142 14687 net.cpp:91] Creating Layer lstm2_gate_input_1
I0922 21:56:33.113150 14687 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0922 21:56:33.113159 14687 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0922 21:56:33.113168 14687 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0922 21:56:33.113224 14687 net.cpp:141] Setting up lstm2_gate_input_1
I0922 21:56:33.113234 14687 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:56:33.113240 14687 net.cpp:156] Memory required for data: 82020
I0922 21:56:33.113245 14687 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0922 21:56:33.113255 14687 net.cpp:91] Creating Layer lstm2_unit_1
I0922 21:56:33.113260 14687 net.cpp:425] lstm2_unit_1 <- c_0
I0922 21:56:33.113265 14687 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0922 21:56:33.113271 14687 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0922 21:56:33.113281 14687 net.cpp:399] lstm2_unit_1 -> c_1
I0922 21:56:33.113291 14687 net.cpp:399] lstm2_unit_1 -> h_1
I0922 21:56:33.113358 14687 net.cpp:141] Setting up lstm2_unit_1
I0922 21:56:33.113368 14687 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:56:33.113374 14687 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:56:33.113379 14687 net.cpp:156] Memory required for data: 90020
I0922 21:56:33.113384 14687 layer_factory.hpp:77] Creating layer lstm2_
I0922 21:56:33.113395 14687 net.cpp:91] Creating Layer lstm2_
I0922 21:56:33.113400 14687 net.cpp:425] lstm2_ <- c_1
I0922 21:56:33.113409 14687 net.cpp:399] lstm2_ -> c_T
I0922 21:56:33.113440 14687 net.cpp:141] Setting up lstm2_
I0922 21:56:33.113451 14687 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:56:33.113456 14687 net.cpp:156] Memory required for data: 94020
I0922 21:56:33.113461 14687 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0922 21:56:33.113471 14687 net.cpp:91] Creating Layer lstm2_h_concat
I0922 21:56:33.113476 14687 net.cpp:425] lstm2_h_concat <- h_1
I0922 21:56:33.113486 14687 net.cpp:399] lstm2_h_concat -> h
I0922 21:56:33.113523 14687 net.cpp:141] Setting up lstm2_h_concat
I0922 21:56:33.113535 14687 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:56:33.113540 14687 net.cpp:156] Memory required for data: 98020
I0922 21:56:33.113546 14687 layer_factory.hpp:77] Creating layer h_pseudoloss
I0922 21:56:33.113556 14687 net.cpp:91] Creating Layer h_pseudoloss
I0922 21:56:33.113561 14687 net.cpp:425] h_pseudoloss <- h
I0922 21:56:33.113569 14687 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0922 21:56:33.113662 14687 net.cpp:141] Setting up h_pseudoloss
I0922 21:56:33.113673 14687 net.cpp:148] Top shape: (1)
I0922 21:56:33.113678 14687 net.cpp:151]     with loss weight 1
I0922 21:56:33.113703 14687 net.cpp:156] Memory required for data: 98024
I0922 21:56:33.113709 14687 net.cpp:217] h_pseudoloss needs backward computation.
I0922 21:56:33.113714 14687 net.cpp:217] lstm2_h_concat needs backward computation.
I0922 21:56:33.113719 14687 net.cpp:219] lstm2_ does not need backward computation.
I0922 21:56:33.113724 14687 net.cpp:217] lstm2_unit_1 needs backward computation.
I0922 21:56:33.113731 14687 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0922 21:56:33.113736 14687 net.cpp:217] lstm2_transform_1 needs backward computation.
I0922 21:56:33.113741 14687 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0922 21:56:33.113749 14687 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0922 21:56:33.113754 14687 net.cpp:217] lstm2_x_transform needs backward computation.
I0922 21:56:33.113759 14687 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0922 21:56:33.113765 14687 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0922 21:56:33.113771 14687 net.cpp:219] lstm2_ does not need backward computation.
I0922 21:56:33.113780 14687 net.cpp:219] lstm2_ does not need backward computation.
I0922 21:56:33.113783 14687 net.cpp:261] This network produces output c_T
I0922 21:56:33.113788 14687 net.cpp:261] This network produces output h_pseudoloss
I0922 21:56:33.113804 14687 net.cpp:274] Network initialization done.
I0922 21:56:33.113860 14687 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0922 21:56:33.113867 14687 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0922 21:56:33.113873 14687 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0922 21:56:33.113984 14687 net.cpp:141] Setting up lstm2
I0922 21:56:33.113997 14687 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:56:33.114002 14687 net.cpp:156] Memory required for data: 36412
I0922 21:56:33.114019 14687 layer_factory.hpp:77] Creating layer predict
I0922 21:56:33.114034 14687 net.cpp:91] Creating Layer predict
I0922 21:56:33.114042 14687 net.cpp:425] predict <- lstm2
I0922 21:56:33.114049 14687 net.cpp:399] predict -> predict
I0922 21:56:33.276729 14693 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /home/peifeng/work/run/storm102/data/workers/0c8b08ae-716e-4500-94cf-b5dd5f0a3cb3/tmp/cvld8515381897920903124/bvlc_reference_caffenet.caffemodel
I0922 21:56:33.276774 14693 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0922 21:56:33.276780 14693 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0922 21:56:33.276785 14693 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /home/peifeng/work/run/storm102/data/workers/0c8b08ae-716e-4500-94cf-b5dd5f0a3cb3/tmp/cvld8515381897920903124/bvlc_reference_caffenet.caffemodel
I0922 21:56:33.609015 14687 net.cpp:141] Setting up predict
I0922 21:56:33.609077 14687 net.cpp:148] Top shape: 1 1 46168 (46168)
I0922 21:56:33.609086 14687 net.cpp:156] Memory required for data: 221084
I0922 21:56:33.609102 14687 layer_factory.hpp:77] Creating layer probs
I0922 21:56:33.609119 14687 net.cpp:91] Creating Layer probs
I0922 21:56:33.609127 14687 net.cpp:425] probs <- predict
I0922 21:56:33.609138 14687 net.cpp:399] probs -> probs
I0922 21:56:33.610033 14687 net.cpp:141] Setting up probs
I0922 21:56:33.610049 14687 net.cpp:148] Top shape: 1 1 46168 (46168)
I0922 21:56:33.610054 14687 net.cpp:156] Memory required for data: 405756
I0922 21:56:33.610061 14687 net.cpp:219] probs does not need backward computation.
I0922 21:56:33.610067 14687 net.cpp:219] predict does not need backward computation.
I0922 21:56:33.610072 14687 net.cpp:219] lstm2 does not need backward computation.
I0922 21:56:33.610080 14687 net.cpp:219] concat does not need backward computation.
I0922 21:56:33.610086 14687 net.cpp:219] lstm1 does not need backward computation.
I0922 21:56:33.610093 14687 net.cpp:219] embedding does not need backward computation.
I0922 21:56:33.610100 14687 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0922 21:56:33.610105 14687 net.cpp:219] reshape_frames does not need backward computation.
I0922 21:56:33.610110 14687 net.cpp:219] embed_encoder does not need backward computation.
I0922 21:56:33.610116 14687 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0922 21:56:33.610122 14687 net.cpp:219] input does not need backward computation.
I0922 21:56:33.610126 14687 net.cpp:261] This network produces output probs
I0922 21:56:33.610149 14687 net.cpp:274] Network initialization done.
I0922 21:56:33.703830 14693 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0922 21:56:33.771381 14693 net.cpp:752] Ignoring source layer loss
Loading the model + trained: 6831.04ms
Using cv::Size and some other stuff: 0.18ms
I0922 21:56:34.005743 14687 net.cpp:752] Ignoring source layer data
I0922 21:56:34.005789 14687 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0922 21:56:34.005800 14687 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0922 21:56:34.090538 14687 net.cpp:752] Ignoring source layer cross_entropy_loss
Loading the mean file: 11585.8ms
TIMERTIMER 294215189
TIMERTIMER 242814389
TIMERTIMER 235086950
TIMERTIMER 220740086
TIMERTIMER 226495027
TIMERTIMER 247464178
TIMERTIMER 237187429
TIMERTIMER 240763624
TIMERTIMER 194705803
TIMERTIMER 188900067
TIMERTIMER 200533086
TIMERTIMER 189047559
TIMERTIMER 195377106
TIMERTIMER 194695333
TIMERTIMER 187353847
TIMERTIMER 194729702
TIMERTIMER 187728365
TIMERTIMER 194286113
TIMERTIMER 195216429
TIMERTIMER 195937218
TIMERTIMER 188495692
TIMERTIMER 194269861
TIMERTIMER 187286881
TIMERTIMER 200197666
TIMERTIMER 193011120
TIMERTIMER 194536814
TIMERTIMER 194637864
TIMERTIMER 196112907
TIMERTIMER 194149815
TIMERTIMER 190486711
TIMERTIMER 192745336
TIMERTIMER 193539490
TIMERTIMER 193169568
TIMERTIMER 198462573
TIMERTIMER 200036668
TIMERTIMER 200684895
TIMERTIMER 195545239
TIMERTIMER 195095232
