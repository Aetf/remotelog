SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/peifeng/tools/storm102/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/peifeng/work/run/storm102/data/supervisor/stormdist/captioning-1-1474594554/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /home/peifeng/work/run/storm102/data/workers/2b399948-63d0-42ab-ad37-47ec0d535de2/tmp/cvld7797931058510006484/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0922 21:36:39.985801  6821 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/2b399948-63d0-42ab-ad37-47ec0d535de2/tmp/cvld7797931058510006484/s2vt.words_to_preds.prototxt
I0922 21:36:39.985934  6821 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0922 21:36:39.985942  6821 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0922 21:36:39.986196  6821 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0922 21:36:39.986202  6827 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0922 21:36:39.986340  6821 layer_factory.hpp:77] Creating layer input
I0922 21:36:39.986344  6827 layer_factory.hpp:77] Creating layer data
I0922 21:36:39.986369  6821 net.cpp:91] Creating Layer input
I0922 21:36:39.986371  6827 net.cpp:91] Creating Layer data
I0922 21:36:39.986382  6827 net.cpp:399] data -> data
I0922 21:36:39.986382  6821 net.cpp:399] input -> frames_fc7
I0922 21:36:39.986431  6821 net.cpp:399] input -> cont_sentence
I0922 21:36:39.986448  6821 net.cpp:399] input -> input_sentence
I0922 21:36:39.986459  6821 net.cpp:399] input -> stage_indicator
I0922 21:36:40.531927  6827 net.cpp:141] Setting up data
I0922 21:36:40.531998  6827 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0922 21:36:40.532007  6827 net.cpp:156] Memory required for data: 6183480
I0922 21:36:40.532030  6827 layer_factory.hpp:77] Creating layer conv1
I0922 21:36:40.532032  6821 net.cpp:141] Setting up input
I0922 21:36:40.532054  6821 net.cpp:148] Top shape: 1 4096 (4096)
I0922 21:36:40.532063  6821 net.cpp:148] Top shape: 1 1 (1)
I0922 21:36:40.532069  6827 net.cpp:91] Creating Layer conv1
I0922 21:36:40.532070  6821 net.cpp:148] Top shape: 1 1 (1)
I0922 21:36:40.532085  6827 net.cpp:425] conv1 <- data
I0922 21:36:40.532086  6821 net.cpp:148] Top shape: 1 1 (1)
I0922 21:36:40.532097  6821 net.cpp:156] Memory required for data: 16396
I0922 21:36:40.532105  6821 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0922 21:36:40.532105  6827 net.cpp:399] conv1 -> conv1
I0922 21:36:40.532135  6821 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0922 21:36:40.532145  6821 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0922 21:36:40.532169  6821 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0922 21:36:40.532184  6821 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0922 21:36:40.532410  6821 net.cpp:141] Setting up cont_sentence_input_1_split
I0922 21:36:40.532433  6821 net.cpp:148] Top shape: 1 1 (1)
I0922 21:36:40.532441  6821 net.cpp:148] Top shape: 1 1 (1)
I0922 21:36:40.532446  6821 net.cpp:156] Memory required for data: 16404
I0922 21:36:40.532452  6821 layer_factory.hpp:77] Creating layer embed_encoder
I0922 21:36:40.532480  6821 net.cpp:91] Creating Layer embed_encoder
I0922 21:36:40.532487  6821 net.cpp:425] embed_encoder <- frames_fc7
I0922 21:36:40.532500  6821 net.cpp:399] embed_encoder -> embedded_in_frames
I0922 21:36:40.558665  6821 net.cpp:141] Setting up embed_encoder
I0922 21:36:40.558712  6821 net.cpp:148] Top shape: 1 500 (500)
I0922 21:36:40.558719  6821 net.cpp:156] Memory required for data: 18404
I0922 21:36:40.558750  6821 layer_factory.hpp:77] Creating layer reshape_frames
I0922 21:36:40.558780  6821 net.cpp:91] Creating Layer reshape_frames
I0922 21:36:40.558790  6821 net.cpp:425] reshape_frames <- embedded_in_frames
I0922 21:36:40.558802  6821 net.cpp:399] reshape_frames -> embedded_input_frames
I0922 21:36:40.563222  6821 net.cpp:141] Setting up reshape_frames
I0922 21:36:40.563252  6821 net.cpp:148] Top shape: 1 1 500 (500)
I0922 21:36:40.563259  6821 net.cpp:156] Memory required for data: 20404
I0922 21:36:40.563266  6821 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0922 21:36:40.563282  6821 net.cpp:91] Creating Layer reshape_stage_indicator
I0922 21:36:40.563288  6821 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0922 21:36:40.563300  6821 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0922 21:36:40.573704  6821 net.cpp:141] Setting up reshape_stage_indicator
I0922 21:36:40.573729  6821 net.cpp:148] Top shape: 1 1 1 (1)
I0922 21:36:40.573735  6821 net.cpp:156] Memory required for data: 20408
I0922 21:36:40.573741  6821 layer_factory.hpp:77] Creating layer embedding
I0922 21:36:40.573757  6821 net.cpp:91] Creating Layer embedding
I0922 21:36:40.573765  6821 net.cpp:425] embedding <- input_sentence
I0922 21:36:40.573774  6821 net.cpp:399] embedding -> embedded_input_sentence
I0922 21:36:40.780284  6827 net.cpp:141] Setting up conv1
I0922 21:36:40.780344  6827 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0922 21:36:40.780360  6827 net.cpp:156] Memory required for data: 17799480
I0922 21:36:40.780385  6827 layer_factory.hpp:77] Creating layer relu1
I0922 21:36:40.780405  6827 net.cpp:91] Creating Layer relu1
I0922 21:36:40.780413  6827 net.cpp:425] relu1 <- conv1
I0922 21:36:40.780422  6827 net.cpp:386] relu1 -> conv1 (in-place)
I0922 21:36:40.780836  6827 net.cpp:141] Setting up relu1
I0922 21:36:40.780851  6827 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0922 21:36:40.780858  6827 net.cpp:156] Memory required for data: 29415480
I0922 21:36:40.780864  6827 layer_factory.hpp:77] Creating layer pool1
I0922 21:36:40.780879  6827 net.cpp:91] Creating Layer pool1
I0922 21:36:40.780884  6827 net.cpp:425] pool1 <- conv1
I0922 21:36:40.780894  6827 net.cpp:399] pool1 -> pool1
I0922 21:36:40.780971  6827 net.cpp:141] Setting up pool1
I0922 21:36:40.780982  6827 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0922 21:36:40.780988  6827 net.cpp:156] Memory required for data: 32214840
I0922 21:36:40.780994  6827 layer_factory.hpp:77] Creating layer norm1
I0922 21:36:40.781013  6827 net.cpp:91] Creating Layer norm1
I0922 21:36:40.781018  6827 net.cpp:425] norm1 <- pool1
I0922 21:36:40.781026  6827 net.cpp:399] norm1 -> norm1
I0922 21:36:40.781309  6827 net.cpp:141] Setting up norm1
I0922 21:36:40.781324  6827 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0922 21:36:40.781329  6827 net.cpp:156] Memory required for data: 35014200
I0922 21:36:40.781335  6827 layer_factory.hpp:77] Creating layer conv2
I0922 21:36:40.781352  6827 net.cpp:91] Creating Layer conv2
I0922 21:36:40.781358  6827 net.cpp:425] conv2 <- norm1
I0922 21:36:40.781366  6827 net.cpp:399] conv2 -> conv2
I0922 21:36:40.784596  6827 net.cpp:141] Setting up conv2
I0922 21:36:40.784620  6827 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0922 21:36:40.784626  6827 net.cpp:156] Memory required for data: 42479160
I0922 21:36:40.784639  6827 layer_factory.hpp:77] Creating layer relu2
I0922 21:36:40.784651  6827 net.cpp:91] Creating Layer relu2
I0922 21:36:40.784657  6827 net.cpp:425] relu2 <- conv2
I0922 21:36:40.784665  6827 net.cpp:386] relu2 -> conv2 (in-place)
I0922 21:36:40.785073  6827 net.cpp:141] Setting up relu2
I0922 21:36:40.785089  6827 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0922 21:36:40.785099  6827 net.cpp:156] Memory required for data: 49944120
I0922 21:36:40.785109  6827 layer_factory.hpp:77] Creating layer pool2
I0922 21:36:40.785123  6827 net.cpp:91] Creating Layer pool2
I0922 21:36:40.785130  6827 net.cpp:425] pool2 <- conv2
I0922 21:36:40.785137  6827 net.cpp:399] pool2 -> pool2
I0922 21:36:40.785195  6827 net.cpp:141] Setting up pool2
I0922 21:36:40.785207  6827 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0922 21:36:40.785212  6827 net.cpp:156] Memory required for data: 51674680
I0922 21:36:40.785218  6827 layer_factory.hpp:77] Creating layer norm2
I0922 21:36:40.785229  6827 net.cpp:91] Creating Layer norm2
I0922 21:36:40.785234  6827 net.cpp:425] norm2 <- pool2
I0922 21:36:40.785243  6827 net.cpp:399] norm2 -> norm2
I0922 21:36:40.785508  6827 net.cpp:141] Setting up norm2
I0922 21:36:40.785522  6827 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0922 21:36:40.785527  6827 net.cpp:156] Memory required for data: 53405240
I0922 21:36:40.785533  6827 layer_factory.hpp:77] Creating layer conv3
I0922 21:36:40.785545  6827 net.cpp:91] Creating Layer conv3
I0922 21:36:40.785552  6827 net.cpp:425] conv3 <- norm2
I0922 21:36:40.785559  6827 net.cpp:399] conv3 -> conv3
I0922 21:36:40.789330  6827 net.cpp:141] Setting up conv3
I0922 21:36:40.789352  6827 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0922 21:36:40.789360  6827 net.cpp:156] Memory required for data: 56001080
I0922 21:36:40.789374  6827 layer_factory.hpp:77] Creating layer relu3
I0922 21:36:40.789384  6827 net.cpp:91] Creating Layer relu3
I0922 21:36:40.789391  6827 net.cpp:425] relu3 <- conv3
I0922 21:36:40.789399  6827 net.cpp:386] relu3 -> conv3 (in-place)
I0922 21:36:40.789634  6827 net.cpp:141] Setting up relu3
I0922 21:36:40.789647  6827 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0922 21:36:40.789654  6827 net.cpp:156] Memory required for data: 58596920
I0922 21:36:40.789659  6827 layer_factory.hpp:77] Creating layer conv4
I0922 21:36:40.789672  6827 net.cpp:91] Creating Layer conv4
I0922 21:36:40.789679  6827 net.cpp:425] conv4 <- conv3
I0922 21:36:40.789686  6827 net.cpp:399] conv4 -> conv4
I0922 21:36:40.794085  6827 net.cpp:141] Setting up conv4
I0922 21:36:40.794109  6827 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0922 21:36:40.794116  6827 net.cpp:156] Memory required for data: 61192760
I0922 21:36:40.794126  6827 layer_factory.hpp:77] Creating layer relu4
I0922 21:36:40.794137  6827 net.cpp:91] Creating Layer relu4
I0922 21:36:40.794143  6827 net.cpp:425] relu4 <- conv4
I0922 21:36:40.794154  6827 net.cpp:386] relu4 -> conv4 (in-place)
I0922 21:36:40.794600  6827 net.cpp:141] Setting up relu4
I0922 21:36:40.794615  6827 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0922 21:36:40.794620  6827 net.cpp:156] Memory required for data: 63788600
I0922 21:36:40.794626  6827 layer_factory.hpp:77] Creating layer conv5
I0922 21:36:40.794641  6827 net.cpp:91] Creating Layer conv5
I0922 21:36:40.794647  6827 net.cpp:425] conv5 <- conv4
I0922 21:36:40.794656  6827 net.cpp:399] conv5 -> conv5
I0922 21:36:40.798583  6827 net.cpp:141] Setting up conv5
I0922 21:36:40.798604  6827 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0922 21:36:40.798610  6827 net.cpp:156] Memory required for data: 65519160
I0922 21:36:40.798629  6827 layer_factory.hpp:77] Creating layer relu5
I0922 21:36:40.798640  6827 net.cpp:91] Creating Layer relu5
I0922 21:36:40.798645  6827 net.cpp:425] relu5 <- conv5
I0922 21:36:40.798653  6827 net.cpp:386] relu5 -> conv5 (in-place)
I0922 21:36:40.799095  6827 net.cpp:141] Setting up relu5
I0922 21:36:40.799113  6827 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0922 21:36:40.799119  6827 net.cpp:156] Memory required for data: 67249720
I0922 21:36:40.799125  6827 layer_factory.hpp:77] Creating layer pool5
I0922 21:36:40.799137  6827 net.cpp:91] Creating Layer pool5
I0922 21:36:40.799144  6827 net.cpp:425] pool5 <- conv5
I0922 21:36:40.799151  6827 net.cpp:399] pool5 -> pool5
I0922 21:36:40.799221  6827 net.cpp:141] Setting up pool5
I0922 21:36:40.799232  6827 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0922 21:36:40.799237  6827 net.cpp:156] Memory required for data: 67618360
I0922 21:36:40.799249  6827 layer_factory.hpp:77] Creating layer fc6
I0922 21:36:40.799268  6827 net.cpp:91] Creating Layer fc6
I0922 21:36:40.799274  6827 net.cpp:425] fc6 <- pool5
I0922 21:36:40.799283  6827 net.cpp:399] fc6 -> fc6
I0922 21:36:40.870158  6821 net.cpp:141] Setting up embedding
I0922 21:36:40.870218  6821 net.cpp:148] Top shape: 1 1 500 (500)
I0922 21:36:40.870226  6821 net.cpp:156] Memory required for data: 22408
I0922 21:36:40.870250  6821 layer_factory.hpp:77] Creating layer lstm1
I0922 21:36:40.870288  6821 net.cpp:91] Creating Layer lstm1
I0922 21:36:40.870298  6821 net.cpp:425] lstm1 <- embedded_input_frames
I0922 21:36:40.870309  6821 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0922 21:36:40.870321  6821 net.cpp:399] lstm1 -> lstm1
I0922 21:36:40.870354  6821 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0922 21:36:40.870769  6821 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0922 21:36:40.870877  6821 layer_factory.hpp:77] Creating layer lstm1_
I0922 21:36:40.870892  6821 net.cpp:91] Creating Layer lstm1_
I0922 21:36:40.870898  6821 net.cpp:399] lstm1_ -> x
I0922 21:36:40.870913  6821 net.cpp:399] lstm1_ -> cont
I0922 21:36:40.870992  6821 net.cpp:141] Setting up lstm1_
I0922 21:36:40.871013  6821 net.cpp:148] Top shape: 1 1 500 (500)
I0922 21:36:40.871035  6821 net.cpp:148] Top shape: 1 1 (1)
I0922 21:36:40.871042  6821 net.cpp:156] Memory required for data: 2004
I0922 21:36:40.871047  6821 layer_factory.hpp:77] Creating layer lstm1_
I0922 21:36:40.871062  6821 net.cpp:91] Creating Layer lstm1_
I0922 21:36:40.871073  6821 net.cpp:399] lstm1_ -> c_0
I0922 21:36:40.871085  6821 net.cpp:399] lstm1_ -> h_0
I0922 21:36:40.871145  6821 net.cpp:141] Setting up lstm1_
I0922 21:36:40.871160  6821 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:36:40.871166  6821 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:36:40.871171  6821 net.cpp:156] Memory required for data: 10004
I0922 21:36:40.871177  6821 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0922 21:36:40.871186  6821 net.cpp:91] Creating Layer lstm1_cont_slice
I0922 21:36:40.871192  6821 net.cpp:425] lstm1_cont_slice <- cont
I0922 21:36:40.871201  6821 net.cpp:399] lstm1_cont_slice -> cont_1
I0922 21:36:40.871243  6821 net.cpp:141] Setting up lstm1_cont_slice
I0922 21:36:40.871253  6821 net.cpp:148] Top shape: 1 1 (1)
I0922 21:36:40.871258  6821 net.cpp:156] Memory required for data: 10008
I0922 21:36:40.871264  6821 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0922 21:36:40.871273  6821 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0922 21:36:40.871279  6821 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0922 21:36:40.871289  6821 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0922 21:36:40.871299  6821 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0922 21:36:40.871351  6821 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0922 21:36:40.871363  6821 net.cpp:148] Top shape: 1 1 (1)
I0922 21:36:40.871371  6821 net.cpp:148] Top shape: 1 1 (1)
I0922 21:36:40.871376  6821 net.cpp:156] Memory required for data: 10016
I0922 21:36:40.871381  6821 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0922 21:36:40.871394  6821 net.cpp:91] Creating Layer lstm1_x_transform
I0922 21:36:40.871399  6821 net.cpp:425] lstm1_x_transform <- x
I0922 21:36:40.871412  6821 net.cpp:399] lstm1_x_transform -> W_xc_x
I0922 21:36:40.893837  6821 net.cpp:141] Setting up lstm1_x_transform
I0922 21:36:40.893893  6821 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:36:40.893899  6821 net.cpp:156] Memory required for data: 26016
I0922 21:36:40.893925  6821 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0922 21:36:40.893944  6821 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0922 21:36:40.893951  6821 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0922 21:36:40.893962  6821 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0922 21:36:40.894016  6821 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0922 21:36:40.894028  6821 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:36:40.894033  6821 net.cpp:156] Memory required for data: 42016
I0922 21:36:40.894039  6821 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0922 21:36:40.894050  6821 net.cpp:91] Creating Layer lstm1_h_conted_0
I0922 21:36:40.894057  6821 net.cpp:425] lstm1_h_conted_0 <- h_0
I0922 21:36:40.894063  6821 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0922 21:36:40.894073  6821 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0922 21:36:40.894170  6821 net.cpp:141] Setting up lstm1_h_conted_0
I0922 21:36:40.894182  6821 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:36:40.894187  6821 net.cpp:156] Memory required for data: 46016
I0922 21:36:40.894192  6821 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0922 21:36:40.894207  6821 net.cpp:91] Creating Layer lstm1_transform_1
I0922 21:36:40.894212  6821 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0922 21:36:40.894222  6821 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0922 21:36:40.913252  6827 net.cpp:141] Setting up fc6
I0922 21:36:40.913302  6827 net.cpp:148] Top shape: 10 4096 (40960)
I0922 21:36:40.913310  6827 net.cpp:156] Memory required for data: 67782200
I0922 21:36:40.913326  6827 layer_factory.hpp:77] Creating layer relu6
I0922 21:36:40.913343  6827 net.cpp:91] Creating Layer relu6
I0922 21:36:40.913350  6827 net.cpp:425] relu6 <- fc6
I0922 21:36:40.913362  6827 net.cpp:386] relu6 -> fc6 (in-place)
I0922 21:36:40.913715  6827 net.cpp:141] Setting up relu6
I0922 21:36:40.913728  6827 net.cpp:148] Top shape: 10 4096 (40960)
I0922 21:36:40.913734  6827 net.cpp:156] Memory required for data: 67946040
I0922 21:36:40.913739  6827 layer_factory.hpp:77] Creating layer drop6
I0922 21:36:40.913760  6827 net.cpp:91] Creating Layer drop6
I0922 21:36:40.913769  6827 net.cpp:425] drop6 <- fc6
I0922 21:36:40.913776  6827 net.cpp:386] drop6 -> fc6 (in-place)
I0922 21:36:40.913830  6827 net.cpp:141] Setting up drop6
I0922 21:36:40.913841  6827 net.cpp:148] Top shape: 10 4096 (40960)
I0922 21:36:40.913846  6827 net.cpp:156] Memory required for data: 68109880
I0922 21:36:40.913851  6827 layer_factory.hpp:77] Creating layer fc7
I0922 21:36:40.913867  6827 net.cpp:91] Creating Layer fc7
I0922 21:36:40.913873  6827 net.cpp:425] fc7 <- fc6
I0922 21:36:40.913884  6827 net.cpp:399] fc7 -> fc7
I0922 21:36:40.946174  6821 net.cpp:141] Setting up lstm1_transform_1
I0922 21:36:40.946229  6821 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:36:40.946238  6821 net.cpp:156] Memory required for data: 62016
I0922 21:36:40.946261  6821 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0922 21:36:40.946288  6821 net.cpp:91] Creating Layer lstm1_gate_input_1
I0922 21:36:40.946297  6821 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0922 21:36:40.946306  6821 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0922 21:36:40.946316  6821 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0922 21:36:40.946401  6821 net.cpp:141] Setting up lstm1_gate_input_1
I0922 21:36:40.946413  6821 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:36:40.946419  6821 net.cpp:156] Memory required for data: 78016
I0922 21:36:40.946424  6821 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0922 21:36:40.946437  6821 net.cpp:91] Creating Layer lstm1_unit_1
I0922 21:36:40.946442  6821 net.cpp:425] lstm1_unit_1 <- c_0
I0922 21:36:40.946449  6821 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0922 21:36:40.946456  6821 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0922 21:36:40.946463  6821 net.cpp:399] lstm1_unit_1 -> c_1
I0922 21:36:40.946475  6821 net.cpp:399] lstm1_unit_1 -> h_1
I0922 21:36:40.946545  6821 net.cpp:141] Setting up lstm1_unit_1
I0922 21:36:40.946557  6821 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:36:40.946563  6821 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:36:40.946568  6821 net.cpp:156] Memory required for data: 86016
I0922 21:36:40.946573  6821 layer_factory.hpp:77] Creating layer lstm1_
I0922 21:36:40.946586  6821 net.cpp:91] Creating Layer lstm1_
I0922 21:36:40.946591  6821 net.cpp:425] lstm1_ <- c_1
I0922 21:36:40.946600  6821 net.cpp:399] lstm1_ -> c_T
I0922 21:36:40.946641  6821 net.cpp:141] Setting up lstm1_
I0922 21:36:40.946651  6821 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:36:40.946657  6821 net.cpp:156] Memory required for data: 90016
I0922 21:36:40.946662  6821 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0922 21:36:40.946677  6821 net.cpp:91] Creating Layer lstm1_h_concat
I0922 21:36:40.946683  6821 net.cpp:425] lstm1_h_concat <- h_1
I0922 21:36:40.946691  6821 net.cpp:399] lstm1_h_concat -> h
I0922 21:36:40.946734  6821 net.cpp:141] Setting up lstm1_h_concat
I0922 21:36:40.946744  6821 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:36:40.946749  6821 net.cpp:156] Memory required for data: 94016
I0922 21:36:40.946755  6821 layer_factory.hpp:77] Creating layer h_pseudoloss
I0922 21:36:40.946773  6821 net.cpp:91] Creating Layer h_pseudoloss
I0922 21:36:40.946777  6821 net.cpp:425] h_pseudoloss <- h
I0922 21:36:40.946789  6821 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0922 21:36:40.946893  6821 net.cpp:141] Setting up h_pseudoloss
I0922 21:36:40.946905  6821 net.cpp:148] Top shape: (1)
I0922 21:36:40.946913  6821 net.cpp:151]     with loss weight 1
I0922 21:36:40.946950  6821 net.cpp:156] Memory required for data: 94020
I0922 21:36:40.946957  6821 net.cpp:217] h_pseudoloss needs backward computation.
I0922 21:36:40.946962  6821 net.cpp:217] lstm1_h_concat needs backward computation.
I0922 21:36:40.946969  6821 net.cpp:219] lstm1_ does not need backward computation.
I0922 21:36:40.946974  6821 net.cpp:217] lstm1_unit_1 needs backward computation.
I0922 21:36:40.946980  6821 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0922 21:36:40.946986  6821 net.cpp:217] lstm1_transform_1 needs backward computation.
I0922 21:36:40.946992  6821 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0922 21:36:40.947000  6821 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0922 21:36:40.947005  6821 net.cpp:217] lstm1_x_transform needs backward computation.
I0922 21:36:40.947010  6821 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0922 21:36:40.947029  6821 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0922 21:36:40.947037  6821 net.cpp:219] lstm1_ does not need backward computation.
I0922 21:36:40.947043  6821 net.cpp:219] lstm1_ does not need backward computation.
I0922 21:36:40.947047  6821 net.cpp:261] This network produces output c_T
I0922 21:36:40.947053  6821 net.cpp:261] This network produces output h_pseudoloss
I0922 21:36:40.947079  6821 net.cpp:274] Network initialization done.
I0922 21:36:40.947152  6821 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0922 21:36:40.947160  6821 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0922 21:36:40.947166  6821 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0922 21:36:40.947291  6821 net.cpp:141] Setting up lstm1
I0922 21:36:40.947305  6821 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:36:40.947311  6821 net.cpp:156] Memory required for data: 26408
I0922 21:36:40.947326  6821 layer_factory.hpp:77] Creating layer concat
I0922 21:36:40.947337  6821 net.cpp:91] Creating Layer concat
I0922 21:36:40.947345  6821 net.cpp:425] concat <- lstm1
I0922 21:36:40.947351  6821 net.cpp:425] concat <- embedded_input_sentence
I0922 21:36:40.947358  6821 net.cpp:425] concat <- reshaped_stage_indicator
I0922 21:36:40.947366  6821 net.cpp:399] concat -> lstm1_video_sequence
I0922 21:36:40.947404  6821 net.cpp:141] Setting up concat
I0922 21:36:40.947415  6821 net.cpp:148] Top shape: 1 1 1501 (1501)
I0922 21:36:40.947420  6821 net.cpp:156] Memory required for data: 32412
I0922 21:36:40.947425  6821 layer_factory.hpp:77] Creating layer lstm2
I0922 21:36:40.947440  6821 net.cpp:91] Creating Layer lstm2
I0922 21:36:40.947446  6821 net.cpp:425] lstm2 <- lstm1_video_sequence
I0922 21:36:40.947453  6821 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0922 21:36:40.947463  6821 net.cpp:399] lstm2 -> lstm2
I0922 21:36:40.947475  6821 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0922 21:36:40.947756  6821 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0922 21:36:40.947857  6821 layer_factory.hpp:77] Creating layer lstm2_
I0922 21:36:40.947875  6821 net.cpp:91] Creating Layer lstm2_
I0922 21:36:40.947882  6821 net.cpp:399] lstm2_ -> x
I0922 21:36:40.947895  6821 net.cpp:399] lstm2_ -> cont
I0922 21:36:40.947957  6821 net.cpp:141] Setting up lstm2_
I0922 21:36:40.947968  6821 net.cpp:148] Top shape: 1 1 1501 (1501)
I0922 21:36:40.947974  6821 net.cpp:148] Top shape: 1 1 (1)
I0922 21:36:40.947979  6821 net.cpp:156] Memory required for data: 6008
I0922 21:36:40.947985  6821 layer_factory.hpp:77] Creating layer lstm2_
I0922 21:36:40.947994  6821 net.cpp:91] Creating Layer lstm2_
I0922 21:36:40.948001  6821 net.cpp:399] lstm2_ -> c_0
I0922 21:36:40.948012  6821 net.cpp:399] lstm2_ -> h_0
I0922 21:36:40.948070  6821 net.cpp:141] Setting up lstm2_
I0922 21:36:40.948081  6821 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:36:40.948087  6821 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:36:40.948091  6821 net.cpp:156] Memory required for data: 14008
I0922 21:36:40.948096  6821 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0922 21:36:40.948106  6821 net.cpp:91] Creating Layer lstm2_cont_slice
I0922 21:36:40.948112  6821 net.cpp:425] lstm2_cont_slice <- cont
I0922 21:36:40.948138  6821 net.cpp:399] lstm2_cont_slice -> cont_1
I0922 21:36:40.948179  6821 net.cpp:141] Setting up lstm2_cont_slice
I0922 21:36:40.948189  6821 net.cpp:148] Top shape: 1 1 (1)
I0922 21:36:40.948194  6821 net.cpp:156] Memory required for data: 14012
I0922 21:36:40.948199  6821 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0922 21:36:40.948207  6821 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0922 21:36:40.948212  6821 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0922 21:36:40.948220  6821 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0922 21:36:40.948230  6821 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0922 21:36:40.948282  6821 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0922 21:36:40.948293  6821 net.cpp:148] Top shape: 1 1 (1)
I0922 21:36:40.948300  6821 net.cpp:148] Top shape: 1 1 (1)
I0922 21:36:40.948304  6821 net.cpp:156] Memory required for data: 14020
I0922 21:36:40.948309  6821 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0922 21:36:40.948323  6821 net.cpp:91] Creating Layer lstm2_x_transform
I0922 21:36:40.948329  6821 net.cpp:425] lstm2_x_transform <- x
I0922 21:36:40.948338  6821 net.cpp:399] lstm2_x_transform -> W_xc_x
I0922 21:36:40.965157  6827 net.cpp:141] Setting up fc7
I0922 21:36:40.965198  6827 net.cpp:148] Top shape: 10 4096 (40960)
I0922 21:36:40.965205  6827 net.cpp:156] Memory required for data: 68273720
I0922 21:36:40.965221  6827 layer_factory.hpp:77] Creating layer relu7
I0922 21:36:40.965239  6827 net.cpp:91] Creating Layer relu7
I0922 21:36:40.965245  6827 net.cpp:425] relu7 <- fc7
I0922 21:36:40.965256  6827 net.cpp:386] relu7 -> fc7 (in-place)
I0922 21:36:40.965886  6827 net.cpp:141] Setting up relu7
I0922 21:36:40.965901  6827 net.cpp:148] Top shape: 10 4096 (40960)
I0922 21:36:40.965906  6827 net.cpp:156] Memory required for data: 68437560
I0922 21:36:40.965912  6827 layer_factory.hpp:77] Creating layer drop7
I0922 21:36:40.965924  6827 net.cpp:91] Creating Layer drop7
I0922 21:36:40.965930  6827 net.cpp:425] drop7 <- fc7
I0922 21:36:40.965942  6827 net.cpp:386] drop7 -> fc7 (in-place)
I0922 21:36:40.965986  6827 net.cpp:141] Setting up drop7
I0922 21:36:40.965996  6827 net.cpp:148] Top shape: 10 4096 (40960)
I0922 21:36:40.966001  6827 net.cpp:156] Memory required for data: 68601400
I0922 21:36:40.966006  6827 layer_factory.hpp:77] Creating layer fc8
I0922 21:36:40.966020  6827 net.cpp:91] Creating Layer fc8
I0922 21:36:40.966027  6827 net.cpp:425] fc8 <- fc7
I0922 21:36:40.966034  6827 net.cpp:399] fc8 -> fc8
I0922 21:36:40.978716  6827 net.cpp:141] Setting up fc8
I0922 21:36:40.978765  6827 net.cpp:148] Top shape: 10 1000 (10000)
I0922 21:36:40.978773  6827 net.cpp:156] Memory required for data: 68641400
I0922 21:36:40.978790  6827 layer_factory.hpp:77] Creating layer prob
I0922 21:36:40.978807  6827 net.cpp:91] Creating Layer prob
I0922 21:36:40.978816  6827 net.cpp:425] prob <- fc8
I0922 21:36:40.978829  6827 net.cpp:399] prob -> prob
I0922 21:36:40.979297  6827 net.cpp:141] Setting up prob
I0922 21:36:40.979311  6827 net.cpp:148] Top shape: 10 1000 (10000)
I0922 21:36:40.979317  6827 net.cpp:156] Memory required for data: 68681400
I0922 21:36:40.979324  6827 net.cpp:219] prob does not need backward computation.
I0922 21:36:40.979329  6827 net.cpp:219] fc8 does not need backward computation.
I0922 21:36:40.979336  6827 net.cpp:219] drop7 does not need backward computation.
I0922 21:36:40.979341  6827 net.cpp:219] relu7 does not need backward computation.
I0922 21:36:40.979346  6827 net.cpp:219] fc7 does not need backward computation.
I0922 21:36:40.979351  6827 net.cpp:219] drop6 does not need backward computation.
I0922 21:36:40.979357  6827 net.cpp:219] relu6 does not need backward computation.
I0922 21:36:40.979360  6827 net.cpp:219] fc6 does not need backward computation.
I0922 21:36:40.979367  6827 net.cpp:219] pool5 does not need backward computation.
I0922 21:36:40.979372  6827 net.cpp:219] relu5 does not need backward computation.
I0922 21:36:40.979377  6827 net.cpp:219] conv5 does not need backward computation.
I0922 21:36:40.979382  6827 net.cpp:219] relu4 does not need backward computation.
I0922 21:36:40.979387  6827 net.cpp:219] conv4 does not need backward computation.
I0922 21:36:40.979393  6827 net.cpp:219] relu3 does not need backward computation.
I0922 21:36:40.979398  6827 net.cpp:219] conv3 does not need backward computation.
I0922 21:36:40.979403  6827 net.cpp:219] norm2 does not need backward computation.
I0922 21:36:40.979408  6827 net.cpp:219] pool2 does not need backward computation.
I0922 21:36:40.979413  6827 net.cpp:219] relu2 does not need backward computation.
I0922 21:36:40.979418  6827 net.cpp:219] conv2 does not need backward computation.
I0922 21:36:40.979423  6827 net.cpp:219] norm1 does not need backward computation.
I0922 21:36:40.979429  6827 net.cpp:219] pool1 does not need backward computation.
I0922 21:36:40.979434  6827 net.cpp:219] relu1 does not need backward computation.
I0922 21:36:40.979439  6827 net.cpp:219] conv1 does not need backward computation.
I0922 21:36:40.979444  6827 net.cpp:219] data does not need backward computation.
I0922 21:36:40.979449  6827 net.cpp:261] This network produces output prob
I0922 21:36:40.979471  6827 net.cpp:274] Network initialization done.
I0922 21:36:41.013288  6821 net.cpp:141] Setting up lstm2_x_transform
I0922 21:36:41.013339  6821 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:36:41.013345  6821 net.cpp:156] Memory required for data: 30020
I0922 21:36:41.013367  6821 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0922 21:36:41.013386  6821 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0922 21:36:41.013393  6821 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0922 21:36:41.013403  6821 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0922 21:36:41.013459  6821 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0922 21:36:41.013473  6821 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:36:41.013478  6821 net.cpp:156] Memory required for data: 46020
I0922 21:36:41.013483  6821 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0922 21:36:41.013494  6821 net.cpp:91] Creating Layer lstm2_h_conted_0
I0922 21:36:41.013500  6821 net.cpp:425] lstm2_h_conted_0 <- h_0
I0922 21:36:41.013507  6821 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0922 21:36:41.013515  6821 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0922 21:36:41.013618  6821 net.cpp:141] Setting up lstm2_h_conted_0
I0922 21:36:41.013630  6821 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:36:41.013634  6821 net.cpp:156] Memory required for data: 50020
I0922 21:36:41.013640  6821 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0922 21:36:41.013654  6821 net.cpp:91] Creating Layer lstm2_transform_1
I0922 21:36:41.013659  6821 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0922 21:36:41.013671  6821 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0922 21:36:41.054591  6821 net.cpp:141] Setting up lstm2_transform_1
I0922 21:36:41.054651  6821 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:36:41.054657  6821 net.cpp:156] Memory required for data: 66020
I0922 21:36:41.054678  6821 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0922 21:36:41.054700  6821 net.cpp:91] Creating Layer lstm2_gate_input_1
I0922 21:36:41.054709  6821 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0922 21:36:41.054718  6821 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0922 21:36:41.054725  6821 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0922 21:36:41.054778  6821 net.cpp:141] Setting up lstm2_gate_input_1
I0922 21:36:41.054788  6821 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:36:41.054793  6821 net.cpp:156] Memory required for data: 82020
I0922 21:36:41.054798  6821 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0922 21:36:41.054811  6821 net.cpp:91] Creating Layer lstm2_unit_1
I0922 21:36:41.054816  6821 net.cpp:425] lstm2_unit_1 <- c_0
I0922 21:36:41.054821  6821 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0922 21:36:41.054826  6821 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0922 21:36:41.054833  6821 net.cpp:399] lstm2_unit_1 -> c_1
I0922 21:36:41.054842  6821 net.cpp:399] lstm2_unit_1 -> h_1
I0922 21:36:41.054908  6821 net.cpp:141] Setting up lstm2_unit_1
I0922 21:36:41.054916  6821 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:36:41.054922  6821 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:36:41.054927  6821 net.cpp:156] Memory required for data: 90020
I0922 21:36:41.054932  6821 layer_factory.hpp:77] Creating layer lstm2_
I0922 21:36:41.054940  6821 net.cpp:91] Creating Layer lstm2_
I0922 21:36:41.054945  6821 net.cpp:425] lstm2_ <- c_1
I0922 21:36:41.054954  6821 net.cpp:399] lstm2_ -> c_T
I0922 21:36:41.054985  6821 net.cpp:141] Setting up lstm2_
I0922 21:36:41.054993  6821 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:36:41.054997  6821 net.cpp:156] Memory required for data: 94020
I0922 21:36:41.055002  6821 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0922 21:36:41.055016  6821 net.cpp:91] Creating Layer lstm2_h_concat
I0922 21:36:41.055027  6821 net.cpp:425] lstm2_h_concat <- h_1
I0922 21:36:41.055035  6821 net.cpp:399] lstm2_h_concat -> h
I0922 21:36:41.055075  6821 net.cpp:141] Setting up lstm2_h_concat
I0922 21:36:41.055084  6821 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:36:41.055088  6821 net.cpp:156] Memory required for data: 98020
I0922 21:36:41.055094  6821 layer_factory.hpp:77] Creating layer h_pseudoloss
I0922 21:36:41.055104  6821 net.cpp:91] Creating Layer h_pseudoloss
I0922 21:36:41.055109  6821 net.cpp:425] h_pseudoloss <- h
I0922 21:36:41.055120  6821 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0922 21:36:41.055214  6821 net.cpp:141] Setting up h_pseudoloss
I0922 21:36:41.055225  6821 net.cpp:148] Top shape: (1)
I0922 21:36:41.055229  6821 net.cpp:151]     with loss weight 1
I0922 21:36:41.055253  6821 net.cpp:156] Memory required for data: 98024
I0922 21:36:41.055258  6821 net.cpp:217] h_pseudoloss needs backward computation.
I0922 21:36:41.055263  6821 net.cpp:217] lstm2_h_concat needs backward computation.
I0922 21:36:41.055269  6821 net.cpp:219] lstm2_ does not need backward computation.
I0922 21:36:41.055274  6821 net.cpp:217] lstm2_unit_1 needs backward computation.
I0922 21:36:41.055279  6821 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0922 21:36:41.055284  6821 net.cpp:217] lstm2_transform_1 needs backward computation.
I0922 21:36:41.055289  6821 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0922 21:36:41.055294  6821 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0922 21:36:41.055300  6821 net.cpp:217] lstm2_x_transform needs backward computation.
I0922 21:36:41.055305  6821 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0922 21:36:41.055311  6821 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0922 21:36:41.055316  6821 net.cpp:219] lstm2_ does not need backward computation.
I0922 21:36:41.055320  6821 net.cpp:219] lstm2_ does not need backward computation.
I0922 21:36:41.055325  6821 net.cpp:261] This network produces output c_T
I0922 21:36:41.055330  6821 net.cpp:261] This network produces output h_pseudoloss
I0922 21:36:41.055346  6821 net.cpp:274] Network initialization done.
I0922 21:36:41.055398  6821 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0922 21:36:41.055404  6821 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0922 21:36:41.055409  6821 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0922 21:36:41.055512  6821 net.cpp:141] Setting up lstm2
I0922 21:36:41.055524  6821 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:36:41.055528  6821 net.cpp:156] Memory required for data: 36412
I0922 21:36:41.055542  6821 layer_factory.hpp:77] Creating layer predict
I0922 21:36:41.055555  6821 net.cpp:91] Creating Layer predict
I0922 21:36:41.055562  6821 net.cpp:425] predict <- lstm2
I0922 21:36:41.055572  6821 net.cpp:399] predict -> predict
I0922 21:36:41.221529  6827 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /home/peifeng/work/run/storm102/data/workers/2b399948-63d0-42ab-ad37-47ec0d535de2/tmp/cvld7797931058510006484/bvlc_reference_caffenet.caffemodel
I0922 21:36:41.221570  6827 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0922 21:36:41.221577  6827 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0922 21:36:41.221582  6827 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /home/peifeng/work/run/storm102/data/workers/2b399948-63d0-42ab-ad37-47ec0d535de2/tmp/cvld7797931058510006484/bvlc_reference_caffenet.caffemodel
I0922 21:36:41.542913  6821 net.cpp:141] Setting up predict
I0922 21:36:41.542973  6821 net.cpp:148] Top shape: 1 1 46168 (46168)
I0922 21:36:41.542981  6821 net.cpp:156] Memory required for data: 221084
I0922 21:36:41.543009  6821 layer_factory.hpp:77] Creating layer probs
I0922 21:36:41.543045  6821 net.cpp:91] Creating Layer probs
I0922 21:36:41.543056  6821 net.cpp:425] probs <- predict
I0922 21:36:41.543069  6821 net.cpp:399] probs -> probs
I0922 21:36:41.543925  6821 net.cpp:141] Setting up probs
I0922 21:36:41.543941  6821 net.cpp:148] Top shape: 1 1 46168 (46168)
I0922 21:36:41.543947  6821 net.cpp:156] Memory required for data: 405756
I0922 21:36:41.543953  6821 net.cpp:219] probs does not need backward computation.
I0922 21:36:41.543959  6821 net.cpp:219] predict does not need backward computation.
I0922 21:36:41.543965  6821 net.cpp:219] lstm2 does not need backward computation.
I0922 21:36:41.543972  6821 net.cpp:219] concat does not need backward computation.
I0922 21:36:41.543979  6821 net.cpp:219] lstm1 does not need backward computation.
I0922 21:36:41.543987  6821 net.cpp:219] embedding does not need backward computation.
I0922 21:36:41.543992  6821 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0922 21:36:41.543998  6821 net.cpp:219] reshape_frames does not need backward computation.
I0922 21:36:41.544004  6821 net.cpp:219] embed_encoder does not need backward computation.
I0922 21:36:41.544010  6821 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0922 21:36:41.544018  6821 net.cpp:219] input does not need backward computation.
I0922 21:36:41.544023  6821 net.cpp:261] This network produces output probs
I0922 21:36:41.544042  6821 net.cpp:274] Network initialization done.
I0922 21:36:41.618043  6827 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0922 21:36:41.671614  6827 net.cpp:752] Ignoring source layer loss
Loading the model + trained: 5903.67ms
Using cv::Size and some other stuff: 0.103ms
I0922 21:36:41.885545  6821 net.cpp:752] Ignoring source layer data
I0922 21:36:41.885591  6821 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0922 21:36:41.885597  6821 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0922 21:36:41.970016  6821 net.cpp:752] Ignoring source layer cross_entropy_loss
Loading the mean file: 12261.4ms
TIMERTIMER 313756570
TIMERTIMER 260899078
TIMERTIMER 273067836
TIMERTIMER 236047763
TIMERTIMER 238259466
TIMERTIMER 226089017
TIMERTIMER 221541504
TIMERTIMER 234704053
TIMERTIMER 235563154
TIMERTIMER 194857414
TIMERTIMER 197466958
TIMERTIMER 188995301
TIMERTIMER 194443505
TIMERTIMER 195386489
TIMERTIMER 189136376
TIMERTIMER 195428685
TIMERTIMER 193041748
TIMERTIMER 196196492
TIMERTIMER 195781438
TIMERTIMER 195061392
TIMERTIMER 195768948
TIMERTIMER 194209951
TIMERTIMER 191104003
TIMERTIMER 193713170
TIMERTIMER 189373055
TIMERTIMER 193004178
TIMERTIMER 197168713
TIMERTIMER 189176709
TIMERTIMER 200716096
TIMERTIMER 187926121
TIMERTIMER 194185888
TIMERTIMER 188450313
TIMERTIMER 195050142
TIMERTIMER 193447377
TIMERTIMER 197344767
TIMERTIMER 204203846
