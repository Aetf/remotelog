SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/peifeng/tools/storm102/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/peifeng/work/run/storm102/data/supervisor/stormdist/captioning-1-1474594782/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /home/peifeng/work/run/storm102/data/workers/0d7fa908-c1fe-469c-b54f-352b198b5b10/tmp/cvld5136087999396867864/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0922 21:40:31.607501  8760 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/0d7fa908-c1fe-469c-b54f-352b198b5b10/tmp/cvld5136087999396867864/s2vt.words_to_preds.prototxt
I0922 21:40:31.607765  8760 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0922 21:40:31.607789  8760 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0922 21:40:31.608511  8760 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0922 21:40:31.608589  8766 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0922 21:40:31.608811  8760 layer_factory.hpp:77] Creating layer input
I0922 21:40:31.608842  8766 layer_factory.hpp:77] Creating layer data
I0922 21:40:31.608867  8760 net.cpp:91] Creating Layer input
I0922 21:40:31.608877  8766 net.cpp:91] Creating Layer data
I0922 21:40:31.608889  8760 net.cpp:399] input -> frames_fc7
I0922 21:40:31.608894  8766 net.cpp:399] data -> data
I0922 21:40:31.608968  8760 net.cpp:399] input -> cont_sentence
I0922 21:40:31.608999  8760 net.cpp:399] input -> input_sentence
I0922 21:40:31.609017  8760 net.cpp:399] input -> stage_indicator
I0922 21:40:32.199859  8766 net.cpp:141] Setting up data
I0922 21:40:32.199937  8766 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0922 21:40:32.199946  8766 net.cpp:156] Memory required for data: 6183480
I0922 21:40:32.199939  8760 net.cpp:141] Setting up input
I0922 21:40:32.199975  8766 layer_factory.hpp:77] Creating layer conv1
I0922 21:40:32.199990  8760 net.cpp:148] Top shape: 1 4096 (4096)
I0922 21:40:32.200000  8760 net.cpp:148] Top shape: 1 1 (1)
I0922 21:40:32.200006  8760 net.cpp:148] Top shape: 1 1 (1)
I0922 21:40:32.200012  8760 net.cpp:148] Top shape: 1 1 (1)
I0922 21:40:32.200017  8760 net.cpp:156] Memory required for data: 16396
I0922 21:40:32.200036  8760 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0922 21:40:32.200017  8766 net.cpp:91] Creating Layer conv1
I0922 21:40:32.200063  8760 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0922 21:40:32.200078  8760 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0922 21:40:32.200083  8766 net.cpp:425] conv1 <- data
I0922 21:40:32.200106  8766 net.cpp:399] conv1 -> conv1
I0922 21:40:32.200109  8760 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0922 21:40:32.200124  8760 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0922 21:40:32.200181  8760 net.cpp:141] Setting up cont_sentence_input_1_split
I0922 21:40:32.200192  8760 net.cpp:148] Top shape: 1 1 (1)
I0922 21:40:32.200201  8760 net.cpp:148] Top shape: 1 1 (1)
I0922 21:40:32.200206  8760 net.cpp:156] Memory required for data: 16404
I0922 21:40:32.200212  8760 layer_factory.hpp:77] Creating layer embed_encoder
I0922 21:40:32.200232  8760 net.cpp:91] Creating Layer embed_encoder
I0922 21:40:32.200238  8760 net.cpp:425] embed_encoder <- frames_fc7
I0922 21:40:32.200250  8760 net.cpp:399] embed_encoder -> embedded_in_frames
I0922 21:40:32.227288  8760 net.cpp:141] Setting up embed_encoder
I0922 21:40:32.227339  8760 net.cpp:148] Top shape: 1 500 (500)
I0922 21:40:32.227345  8760 net.cpp:156] Memory required for data: 18404
I0922 21:40:32.227372  8760 layer_factory.hpp:77] Creating layer reshape_frames
I0922 21:40:32.227403  8760 net.cpp:91] Creating Layer reshape_frames
I0922 21:40:32.227413  8760 net.cpp:425] reshape_frames <- embedded_in_frames
I0922 21:40:32.227426  8760 net.cpp:399] reshape_frames -> embedded_input_frames
I0922 21:40:32.232859  8760 net.cpp:141] Setting up reshape_frames
I0922 21:40:32.232882  8760 net.cpp:148] Top shape: 1 1 500 (500)
I0922 21:40:32.232888  8760 net.cpp:156] Memory required for data: 20404
I0922 21:40:32.232894  8760 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0922 21:40:32.232909  8760 net.cpp:91] Creating Layer reshape_stage_indicator
I0922 21:40:32.232915  8760 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0922 21:40:32.232926  8760 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0922 21:40:32.236183  8760 net.cpp:141] Setting up reshape_stage_indicator
I0922 21:40:32.236207  8760 net.cpp:148] Top shape: 1 1 1 (1)
I0922 21:40:32.236212  8760 net.cpp:156] Memory required for data: 20408
I0922 21:40:32.236219  8760 layer_factory.hpp:77] Creating layer embedding
I0922 21:40:32.236238  8760 net.cpp:91] Creating Layer embedding
I0922 21:40:32.236243  8760 net.cpp:425] embedding <- input_sentence
I0922 21:40:32.236254  8760 net.cpp:399] embedding -> embedded_input_sentence
I0922 21:40:32.445996  8766 net.cpp:141] Setting up conv1
I0922 21:40:32.446053  8766 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0922 21:40:32.446061  8766 net.cpp:156] Memory required for data: 17799480
I0922 21:40:32.446084  8766 layer_factory.hpp:77] Creating layer relu1
I0922 21:40:32.446102  8766 net.cpp:91] Creating Layer relu1
I0922 21:40:32.446110  8766 net.cpp:425] relu1 <- conv1
I0922 21:40:32.446120  8766 net.cpp:386] relu1 -> conv1 (in-place)
I0922 21:40:32.446543  8766 net.cpp:141] Setting up relu1
I0922 21:40:32.446559  8766 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0922 21:40:32.446565  8766 net.cpp:156] Memory required for data: 29415480
I0922 21:40:32.446571  8766 layer_factory.hpp:77] Creating layer pool1
I0922 21:40:32.446584  8766 net.cpp:91] Creating Layer pool1
I0922 21:40:32.446590  8766 net.cpp:425] pool1 <- conv1
I0922 21:40:32.446599  8766 net.cpp:399] pool1 -> pool1
I0922 21:40:32.446676  8766 net.cpp:141] Setting up pool1
I0922 21:40:32.446687  8766 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0922 21:40:32.446692  8766 net.cpp:156] Memory required for data: 32214840
I0922 21:40:32.446698  8766 layer_factory.hpp:77] Creating layer norm1
I0922 21:40:32.446715  8766 net.cpp:91] Creating Layer norm1
I0922 21:40:32.446722  8766 net.cpp:425] norm1 <- pool1
I0922 21:40:32.446729  8766 net.cpp:399] norm1 -> norm1
I0922 21:40:32.447008  8766 net.cpp:141] Setting up norm1
I0922 21:40:32.447031  8766 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0922 21:40:32.447036  8766 net.cpp:156] Memory required for data: 35014200
I0922 21:40:32.447043  8766 layer_factory.hpp:77] Creating layer conv2
I0922 21:40:32.447059  8766 net.cpp:91] Creating Layer conv2
I0922 21:40:32.447065  8766 net.cpp:425] conv2 <- norm1
I0922 21:40:32.447073  8766 net.cpp:399] conv2 -> conv2
I0922 21:40:32.450350  8766 net.cpp:141] Setting up conv2
I0922 21:40:32.450371  8766 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0922 21:40:32.450377  8766 net.cpp:156] Memory required for data: 42479160
I0922 21:40:32.450390  8766 layer_factory.hpp:77] Creating layer relu2
I0922 21:40:32.450402  8766 net.cpp:91] Creating Layer relu2
I0922 21:40:32.450407  8766 net.cpp:425] relu2 <- conv2
I0922 21:40:32.450415  8766 net.cpp:386] relu2 -> conv2 (in-place)
I0922 21:40:32.450822  8766 net.cpp:141] Setting up relu2
I0922 21:40:32.450837  8766 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0922 21:40:32.450842  8766 net.cpp:156] Memory required for data: 49944120
I0922 21:40:32.450848  8766 layer_factory.hpp:77] Creating layer pool2
I0922 21:40:32.450860  8766 net.cpp:91] Creating Layer pool2
I0922 21:40:32.450865  8766 net.cpp:425] pool2 <- conv2
I0922 21:40:32.450873  8766 net.cpp:399] pool2 -> pool2
I0922 21:40:32.450929  8766 net.cpp:141] Setting up pool2
I0922 21:40:32.450939  8766 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0922 21:40:32.450944  8766 net.cpp:156] Memory required for data: 51674680
I0922 21:40:32.450950  8766 layer_factory.hpp:77] Creating layer norm2
I0922 21:40:32.450961  8766 net.cpp:91] Creating Layer norm2
I0922 21:40:32.450966  8766 net.cpp:425] norm2 <- pool2
I0922 21:40:32.450974  8766 net.cpp:399] norm2 -> norm2
I0922 21:40:32.451251  8766 net.cpp:141] Setting up norm2
I0922 21:40:32.451266  8766 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0922 21:40:32.451270  8766 net.cpp:156] Memory required for data: 53405240
I0922 21:40:32.451277  8766 layer_factory.hpp:77] Creating layer conv3
I0922 21:40:32.451289  8766 net.cpp:91] Creating Layer conv3
I0922 21:40:32.451295  8766 net.cpp:425] conv3 <- norm2
I0922 21:40:32.451303  8766 net.cpp:399] conv3 -> conv3
I0922 21:40:32.455057  8766 net.cpp:141] Setting up conv3
I0922 21:40:32.455078  8766 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0922 21:40:32.455085  8766 net.cpp:156] Memory required for data: 56001080
I0922 21:40:32.455099  8766 layer_factory.hpp:77] Creating layer relu3
I0922 21:40:32.455111  8766 net.cpp:91] Creating Layer relu3
I0922 21:40:32.455116  8766 net.cpp:425] relu3 <- conv3
I0922 21:40:32.455124  8766 net.cpp:386] relu3 -> conv3 (in-place)
I0922 21:40:32.455366  8766 net.cpp:141] Setting up relu3
I0922 21:40:32.455379  8766 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0922 21:40:32.455385  8766 net.cpp:156] Memory required for data: 58596920
I0922 21:40:32.455391  8766 layer_factory.hpp:77] Creating layer conv4
I0922 21:40:32.455404  8766 net.cpp:91] Creating Layer conv4
I0922 21:40:32.455410  8766 net.cpp:425] conv4 <- conv3
I0922 21:40:32.455418  8766 net.cpp:399] conv4 -> conv4
I0922 21:40:32.459789  8766 net.cpp:141] Setting up conv4
I0922 21:40:32.459810  8766 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0922 21:40:32.459816  8766 net.cpp:156] Memory required for data: 61192760
I0922 21:40:32.459826  8766 layer_factory.hpp:77] Creating layer relu4
I0922 21:40:32.459841  8766 net.cpp:91] Creating Layer relu4
I0922 21:40:32.459848  8766 net.cpp:425] relu4 <- conv4
I0922 21:40:32.459856  8766 net.cpp:386] relu4 -> conv4 (in-place)
I0922 21:40:32.460288  8766 net.cpp:141] Setting up relu4
I0922 21:40:32.460301  8766 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0922 21:40:32.460307  8766 net.cpp:156] Memory required for data: 63788600
I0922 21:40:32.460314  8766 layer_factory.hpp:77] Creating layer conv5
I0922 21:40:32.460327  8766 net.cpp:91] Creating Layer conv5
I0922 21:40:32.460333  8766 net.cpp:425] conv5 <- conv4
I0922 21:40:32.460341  8766 net.cpp:399] conv5 -> conv5
I0922 21:40:32.464239  8766 net.cpp:141] Setting up conv5
I0922 21:40:32.464258  8766 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0922 21:40:32.464267  8766 net.cpp:156] Memory required for data: 65519160
I0922 21:40:32.464282  8766 layer_factory.hpp:77] Creating layer relu5
I0922 21:40:32.464293  8766 net.cpp:91] Creating Layer relu5
I0922 21:40:32.464299  8766 net.cpp:425] relu5 <- conv5
I0922 21:40:32.464306  8766 net.cpp:386] relu5 -> conv5 (in-place)
I0922 21:40:32.464737  8766 net.cpp:141] Setting up relu5
I0922 21:40:32.464754  8766 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0922 21:40:32.464761  8766 net.cpp:156] Memory required for data: 67249720
I0922 21:40:32.464766  8766 layer_factory.hpp:77] Creating layer pool5
I0922 21:40:32.464777  8766 net.cpp:91] Creating Layer pool5
I0922 21:40:32.464783  8766 net.cpp:425] pool5 <- conv5
I0922 21:40:32.464792  8766 net.cpp:399] pool5 -> pool5
I0922 21:40:32.464860  8766 net.cpp:141] Setting up pool5
I0922 21:40:32.464871  8766 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0922 21:40:32.464876  8766 net.cpp:156] Memory required for data: 67618360
I0922 21:40:32.464881  8766 layer_factory.hpp:77] Creating layer fc6
I0922 21:40:32.464898  8766 net.cpp:91] Creating Layer fc6
I0922 21:40:32.464905  8766 net.cpp:425] fc6 <- pool5
I0922 21:40:32.464912  8766 net.cpp:399] fc6 -> fc6
I0922 21:40:32.536085  8760 net.cpp:141] Setting up embedding
I0922 21:40:32.536150  8760 net.cpp:148] Top shape: 1 1 500 (500)
I0922 21:40:32.536159  8760 net.cpp:156] Memory required for data: 22408
I0922 21:40:32.536180  8760 layer_factory.hpp:77] Creating layer lstm1
I0922 21:40:32.536214  8760 net.cpp:91] Creating Layer lstm1
I0922 21:40:32.536224  8760 net.cpp:425] lstm1 <- embedded_input_frames
I0922 21:40:32.536236  8760 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0922 21:40:32.536245  8760 net.cpp:399] lstm1 -> lstm1
I0922 21:40:32.536278  8760 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0922 21:40:32.536700  8760 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0922 21:40:32.536798  8760 layer_factory.hpp:77] Creating layer lstm1_
I0922 21:40:32.536813  8760 net.cpp:91] Creating Layer lstm1_
I0922 21:40:32.536820  8760 net.cpp:399] lstm1_ -> x
I0922 21:40:32.536834  8760 net.cpp:399] lstm1_ -> cont
I0922 21:40:32.536912  8760 net.cpp:141] Setting up lstm1_
I0922 21:40:32.536924  8760 net.cpp:148] Top shape: 1 1 500 (500)
I0922 21:40:32.536931  8760 net.cpp:148] Top shape: 1 1 (1)
I0922 21:40:32.536936  8760 net.cpp:156] Memory required for data: 2004
I0922 21:40:32.536942  8760 layer_factory.hpp:77] Creating layer lstm1_
I0922 21:40:32.536952  8760 net.cpp:91] Creating Layer lstm1_
I0922 21:40:32.536959  8760 net.cpp:399] lstm1_ -> c_0
I0922 21:40:32.536969  8760 net.cpp:399] lstm1_ -> h_0
I0922 21:40:32.537029  8760 net.cpp:141] Setting up lstm1_
I0922 21:40:32.537040  8760 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:40:32.537047  8760 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:40:32.537052  8760 net.cpp:156] Memory required for data: 10004
I0922 21:40:32.537057  8760 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0922 21:40:32.537067  8760 net.cpp:91] Creating Layer lstm1_cont_slice
I0922 21:40:32.537072  8760 net.cpp:425] lstm1_cont_slice <- cont
I0922 21:40:32.537084  8760 net.cpp:399] lstm1_cont_slice -> cont_1
I0922 21:40:32.537125  8760 net.cpp:141] Setting up lstm1_cont_slice
I0922 21:40:32.537137  8760 net.cpp:148] Top shape: 1 1 (1)
I0922 21:40:32.537142  8760 net.cpp:156] Memory required for data: 10008
I0922 21:40:32.537147  8760 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0922 21:40:32.537154  8760 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0922 21:40:32.537160  8760 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0922 21:40:32.537168  8760 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0922 21:40:32.537176  8760 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0922 21:40:32.537233  8760 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0922 21:40:32.537243  8760 net.cpp:148] Top shape: 1 1 (1)
I0922 21:40:32.537250  8760 net.cpp:148] Top shape: 1 1 (1)
I0922 21:40:32.537255  8760 net.cpp:156] Memory required for data: 10016
I0922 21:40:32.537259  8760 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0922 21:40:32.537274  8760 net.cpp:91] Creating Layer lstm1_x_transform
I0922 21:40:32.537281  8760 net.cpp:425] lstm1_x_transform <- x
I0922 21:40:32.537297  8760 net.cpp:399] lstm1_x_transform -> W_xc_x
I0922 21:40:32.559589  8760 net.cpp:141] Setting up lstm1_x_transform
I0922 21:40:32.559649  8760 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:40:32.559655  8760 net.cpp:156] Memory required for data: 26016
I0922 21:40:32.559679  8760 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0922 21:40:32.559695  8760 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0922 21:40:32.559702  8760 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0922 21:40:32.559717  8760 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0922 21:40:32.559767  8760 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0922 21:40:32.559777  8760 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:40:32.559782  8760 net.cpp:156] Memory required for data: 42016
I0922 21:40:32.559787  8760 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0922 21:40:32.559798  8760 net.cpp:91] Creating Layer lstm1_h_conted_0
I0922 21:40:32.559803  8760 net.cpp:425] lstm1_h_conted_0 <- h_0
I0922 21:40:32.559809  8760 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0922 21:40:32.559823  8760 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0922 21:40:32.559921  8760 net.cpp:141] Setting up lstm1_h_conted_0
I0922 21:40:32.559932  8760 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:40:32.559937  8760 net.cpp:156] Memory required for data: 46016
I0922 21:40:32.559942  8760 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0922 21:40:32.559955  8760 net.cpp:91] Creating Layer lstm1_transform_1
I0922 21:40:32.559960  8760 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0922 21:40:32.559975  8760 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0922 21:40:32.576676  8766 net.cpp:141] Setting up fc6
I0922 21:40:32.576735  8766 net.cpp:148] Top shape: 10 4096 (40960)
I0922 21:40:32.576742  8766 net.cpp:156] Memory required for data: 67782200
I0922 21:40:32.576757  8766 layer_factory.hpp:77] Creating layer relu6
I0922 21:40:32.576774  8766 net.cpp:91] Creating Layer relu6
I0922 21:40:32.576781  8766 net.cpp:425] relu6 <- fc6
I0922 21:40:32.576797  8766 net.cpp:386] relu6 -> fc6 (in-place)
I0922 21:40:32.577178  8766 net.cpp:141] Setting up relu6
I0922 21:40:32.577193  8766 net.cpp:148] Top shape: 10 4096 (40960)
I0922 21:40:32.577198  8766 net.cpp:156] Memory required for data: 67946040
I0922 21:40:32.577203  8766 layer_factory.hpp:77] Creating layer drop6
I0922 21:40:32.577230  8766 net.cpp:91] Creating Layer drop6
I0922 21:40:32.577236  8766 net.cpp:425] drop6 <- fc6
I0922 21:40:32.577244  8766 net.cpp:386] drop6 -> fc6 (in-place)
I0922 21:40:32.577306  8766 net.cpp:141] Setting up drop6
I0922 21:40:32.577316  8766 net.cpp:148] Top shape: 10 4096 (40960)
I0922 21:40:32.577322  8766 net.cpp:156] Memory required for data: 68109880
I0922 21:40:32.577327  8766 layer_factory.hpp:77] Creating layer fc7
I0922 21:40:32.577337  8766 net.cpp:91] Creating Layer fc7
I0922 21:40:32.577343  8766 net.cpp:425] fc7 <- fc6
I0922 21:40:32.577353  8766 net.cpp:399] fc7 -> fc7
I0922 21:40:32.609650  8760 net.cpp:141] Setting up lstm1_transform_1
I0922 21:40:32.609710  8760 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:40:32.609717  8760 net.cpp:156] Memory required for data: 62016
I0922 21:40:32.609738  8760 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0922 21:40:32.609760  8760 net.cpp:91] Creating Layer lstm1_gate_input_1
I0922 21:40:32.609767  8760 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0922 21:40:32.609776  8760 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0922 21:40:32.609791  8760 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0922 21:40:32.609858  8760 net.cpp:141] Setting up lstm1_gate_input_1
I0922 21:40:32.609868  8760 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:40:32.609872  8760 net.cpp:156] Memory required for data: 78016
I0922 21:40:32.609879  8760 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0922 21:40:32.609887  8760 net.cpp:91] Creating Layer lstm1_unit_1
I0922 21:40:32.609894  8760 net.cpp:425] lstm1_unit_1 <- c_0
I0922 21:40:32.609899  8760 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0922 21:40:32.609905  8760 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0922 21:40:32.609917  8760 net.cpp:399] lstm1_unit_1 -> c_1
I0922 21:40:32.609928  8760 net.cpp:399] lstm1_unit_1 -> h_1
I0922 21:40:32.609998  8760 net.cpp:141] Setting up lstm1_unit_1
I0922 21:40:32.610008  8760 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:40:32.610014  8760 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:40:32.610019  8760 net.cpp:156] Memory required for data: 86016
I0922 21:40:32.610024  8760 layer_factory.hpp:77] Creating layer lstm1_
I0922 21:40:32.610034  8760 net.cpp:91] Creating Layer lstm1_
I0922 21:40:32.610039  8760 net.cpp:425] lstm1_ <- c_1
I0922 21:40:32.610046  8760 net.cpp:399] lstm1_ -> c_T
I0922 21:40:32.610085  8760 net.cpp:141] Setting up lstm1_
I0922 21:40:32.610095  8760 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:40:32.610100  8760 net.cpp:156] Memory required for data: 90016
I0922 21:40:32.610105  8760 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0922 21:40:32.610116  8760 net.cpp:91] Creating Layer lstm1_h_concat
I0922 21:40:32.610121  8760 net.cpp:425] lstm1_h_concat <- h_1
I0922 21:40:32.610128  8760 net.cpp:399] lstm1_h_concat -> h
I0922 21:40:32.610165  8760 net.cpp:141] Setting up lstm1_h_concat
I0922 21:40:32.610174  8760 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:40:32.610179  8760 net.cpp:156] Memory required for data: 94016
I0922 21:40:32.610185  8760 layer_factory.hpp:77] Creating layer h_pseudoloss
I0922 21:40:32.610209  8760 net.cpp:91] Creating Layer h_pseudoloss
I0922 21:40:32.610216  8760 net.cpp:425] h_pseudoloss <- h
I0922 21:40:32.610224  8760 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0922 21:40:32.610322  8760 net.cpp:141] Setting up h_pseudoloss
I0922 21:40:32.610333  8760 net.cpp:148] Top shape: (1)
I0922 21:40:32.610338  8760 net.cpp:151]     with loss weight 1
I0922 21:40:32.610381  8760 net.cpp:156] Memory required for data: 94020
I0922 21:40:32.610388  8760 net.cpp:217] h_pseudoloss needs backward computation.
I0922 21:40:32.610394  8760 net.cpp:217] lstm1_h_concat needs backward computation.
I0922 21:40:32.610399  8760 net.cpp:219] lstm1_ does not need backward computation.
I0922 21:40:32.610404  8760 net.cpp:217] lstm1_unit_1 needs backward computation.
I0922 21:40:32.610411  8760 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0922 21:40:32.610416  8760 net.cpp:217] lstm1_transform_1 needs backward computation.
I0922 21:40:32.610422  8760 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0922 21:40:32.610430  8760 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0922 21:40:32.610435  8760 net.cpp:217] lstm1_x_transform needs backward computation.
I0922 21:40:32.610440  8760 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0922 21:40:32.610446  8760 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0922 21:40:32.610452  8760 net.cpp:219] lstm1_ does not need backward computation.
I0922 21:40:32.610457  8760 net.cpp:219] lstm1_ does not need backward computation.
I0922 21:40:32.610461  8760 net.cpp:261] This network produces output c_T
I0922 21:40:32.610466  8760 net.cpp:261] This network produces output h_pseudoloss
I0922 21:40:32.610489  8760 net.cpp:274] Network initialization done.
I0922 21:40:32.610551  8760 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0922 21:40:32.610558  8760 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0922 21:40:32.610563  8760 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0922 21:40:32.610682  8760 net.cpp:141] Setting up lstm1
I0922 21:40:32.610695  8760 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:40:32.610700  8760 net.cpp:156] Memory required for data: 26408
I0922 21:40:32.610714  8760 layer_factory.hpp:77] Creating layer concat
I0922 21:40:32.610724  8760 net.cpp:91] Creating Layer concat
I0922 21:40:32.610730  8760 net.cpp:425] concat <- lstm1
I0922 21:40:32.610738  8760 net.cpp:425] concat <- embedded_input_sentence
I0922 21:40:32.610744  8760 net.cpp:425] concat <- reshaped_stage_indicator
I0922 21:40:32.610751  8760 net.cpp:399] concat -> lstm1_video_sequence
I0922 21:40:32.610788  8760 net.cpp:141] Setting up concat
I0922 21:40:32.610798  8760 net.cpp:148] Top shape: 1 1 1501 (1501)
I0922 21:40:32.610803  8760 net.cpp:156] Memory required for data: 32412
I0922 21:40:32.610808  8760 layer_factory.hpp:77] Creating layer lstm2
I0922 21:40:32.610821  8760 net.cpp:91] Creating Layer lstm2
I0922 21:40:32.610827  8760 net.cpp:425] lstm2 <- lstm1_video_sequence
I0922 21:40:32.610833  8760 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0922 21:40:32.610841  8760 net.cpp:399] lstm2 -> lstm2
I0922 21:40:32.610853  8760 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0922 21:40:32.611151  8760 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0922 21:40:32.611249  8760 layer_factory.hpp:77] Creating layer lstm2_
I0922 21:40:32.611263  8760 net.cpp:91] Creating Layer lstm2_
I0922 21:40:32.611270  8760 net.cpp:399] lstm2_ -> x
I0922 21:40:32.611282  8760 net.cpp:399] lstm2_ -> cont
I0922 21:40:32.611341  8760 net.cpp:141] Setting up lstm2_
I0922 21:40:32.611352  8760 net.cpp:148] Top shape: 1 1 1501 (1501)
I0922 21:40:32.611359  8760 net.cpp:148] Top shape: 1 1 (1)
I0922 21:40:32.611363  8760 net.cpp:156] Memory required for data: 6008
I0922 21:40:32.611369  8760 layer_factory.hpp:77] Creating layer lstm2_
I0922 21:40:32.611378  8760 net.cpp:91] Creating Layer lstm2_
I0922 21:40:32.611389  8760 net.cpp:399] lstm2_ -> c_0
I0922 21:40:32.611402  8760 net.cpp:399] lstm2_ -> h_0
I0922 21:40:32.611452  8760 net.cpp:141] Setting up lstm2_
I0922 21:40:32.611462  8760 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:40:32.611469  8760 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:40:32.611474  8760 net.cpp:156] Memory required for data: 14008
I0922 21:40:32.611479  8760 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0922 21:40:32.611495  8760 net.cpp:91] Creating Layer lstm2_cont_slice
I0922 21:40:32.611500  8760 net.cpp:425] lstm2_cont_slice <- cont
I0922 21:40:32.611508  8760 net.cpp:399] lstm2_cont_slice -> cont_1
I0922 21:40:32.611543  8760 net.cpp:141] Setting up lstm2_cont_slice
I0922 21:40:32.611553  8760 net.cpp:148] Top shape: 1 1 (1)
I0922 21:40:32.611558  8760 net.cpp:156] Memory required for data: 14012
I0922 21:40:32.611563  8760 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0922 21:40:32.611570  8760 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0922 21:40:32.611575  8760 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0922 21:40:32.611588  8760 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0922 21:40:32.611598  8760 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0922 21:40:32.611649  8760 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0922 21:40:32.611659  8760 net.cpp:148] Top shape: 1 1 (1)
I0922 21:40:32.611665  8760 net.cpp:148] Top shape: 1 1 (1)
I0922 21:40:32.611670  8760 net.cpp:156] Memory required for data: 14020
I0922 21:40:32.611675  8760 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0922 21:40:32.611690  8760 net.cpp:91] Creating Layer lstm2_x_transform
I0922 21:40:32.611696  8760 net.cpp:425] lstm2_x_transform <- x
I0922 21:40:32.611704  8760 net.cpp:399] lstm2_x_transform -> W_xc_x
I0922 21:40:32.628484  8766 net.cpp:141] Setting up fc7
I0922 21:40:32.628531  8766 net.cpp:148] Top shape: 10 4096 (40960)
I0922 21:40:32.628537  8766 net.cpp:156] Memory required for data: 68273720
I0922 21:40:32.628551  8766 layer_factory.hpp:77] Creating layer relu7
I0922 21:40:32.628567  8766 net.cpp:91] Creating Layer relu7
I0922 21:40:32.628576  8766 net.cpp:425] relu7 <- fc7
I0922 21:40:32.628593  8766 net.cpp:386] relu7 -> fc7 (in-place)
I0922 21:40:32.629281  8766 net.cpp:141] Setting up relu7
I0922 21:40:32.629294  8766 net.cpp:148] Top shape: 10 4096 (40960)
I0922 21:40:32.629300  8766 net.cpp:156] Memory required for data: 68437560
I0922 21:40:32.629307  8766 layer_factory.hpp:77] Creating layer drop7
I0922 21:40:32.629318  8766 net.cpp:91] Creating Layer drop7
I0922 21:40:32.629324  8766 net.cpp:425] drop7 <- fc7
I0922 21:40:32.629335  8766 net.cpp:386] drop7 -> fc7 (in-place)
I0922 21:40:32.629379  8766 net.cpp:141] Setting up drop7
I0922 21:40:32.629390  8766 net.cpp:148] Top shape: 10 4096 (40960)
I0922 21:40:32.629396  8766 net.cpp:156] Memory required for data: 68601400
I0922 21:40:32.629401  8766 layer_factory.hpp:77] Creating layer fc8
I0922 21:40:32.629412  8766 net.cpp:91] Creating Layer fc8
I0922 21:40:32.629417  8766 net.cpp:425] fc8 <- fc7
I0922 21:40:32.629426  8766 net.cpp:399] fc8 -> fc8
I0922 21:40:32.643221  8766 net.cpp:141] Setting up fc8
I0922 21:40:32.643285  8766 net.cpp:148] Top shape: 10 1000 (10000)
I0922 21:40:32.643293  8766 net.cpp:156] Memory required for data: 68641400
I0922 21:40:32.643313  8766 layer_factory.hpp:77] Creating layer prob
I0922 21:40:32.643338  8766 net.cpp:91] Creating Layer prob
I0922 21:40:32.643348  8766 net.cpp:425] prob <- fc8
I0922 21:40:32.643362  8766 net.cpp:399] prob -> prob
I0922 21:40:32.643955  8766 net.cpp:141] Setting up prob
I0922 21:40:32.643973  8766 net.cpp:148] Top shape: 10 1000 (10000)
I0922 21:40:32.643981  8766 net.cpp:156] Memory required for data: 68681400
I0922 21:40:32.643990  8766 net.cpp:219] prob does not need backward computation.
I0922 21:40:32.643998  8766 net.cpp:219] fc8 does not need backward computation.
I0922 21:40:32.644006  8766 net.cpp:219] drop7 does not need backward computation.
I0922 21:40:32.644013  8766 net.cpp:219] relu7 does not need backward computation.
I0922 21:40:32.644021  8766 net.cpp:219] fc7 does not need backward computation.
I0922 21:40:32.644029  8766 net.cpp:219] drop6 does not need backward computation.
I0922 21:40:32.644037  8766 net.cpp:219] relu6 does not need backward computation.
I0922 21:40:32.644045  8766 net.cpp:219] fc6 does not need backward computation.
I0922 21:40:32.644053  8766 net.cpp:219] pool5 does not need backward computation.
I0922 21:40:32.644062  8766 net.cpp:219] relu5 does not need backward computation.
I0922 21:40:32.644069  8766 net.cpp:219] conv5 does not need backward computation.
I0922 21:40:32.644078  8766 net.cpp:219] relu4 does not need backward computation.
I0922 21:40:32.644085  8766 net.cpp:219] conv4 does not need backward computation.
I0922 21:40:32.644094  8766 net.cpp:219] relu3 does not need backward computation.
I0922 21:40:32.644103  8766 net.cpp:219] conv3 does not need backward computation.
I0922 21:40:32.644110  8766 net.cpp:219] norm2 does not need backward computation.
I0922 21:40:32.644119  8766 net.cpp:219] pool2 does not need backward computation.
I0922 21:40:32.644126  8766 net.cpp:219] relu2 does not need backward computation.
I0922 21:40:32.644134  8766 net.cpp:219] conv2 does not need backward computation.
I0922 21:40:32.644141  8766 net.cpp:219] norm1 does not need backward computation.
I0922 21:40:32.644150  8766 net.cpp:219] pool1 does not need backward computation.
I0922 21:40:32.644157  8766 net.cpp:219] relu1 does not need backward computation.
I0922 21:40:32.644165  8766 net.cpp:219] conv1 does not need backward computation.
I0922 21:40:32.644173  8766 net.cpp:219] data does not need backward computation.
I0922 21:40:32.644179  8766 net.cpp:261] This network produces output prob
I0922 21:40:32.644209  8766 net.cpp:274] Network initialization done.
I0922 21:40:32.681205  8760 net.cpp:141] Setting up lstm2_x_transform
I0922 21:40:32.681262  8760 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:40:32.681268  8760 net.cpp:156] Memory required for data: 30020
I0922 21:40:32.681288  8760 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0922 21:40:32.681305  8760 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0922 21:40:32.681311  8760 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0922 21:40:32.681326  8760 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0922 21:40:32.681375  8760 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0922 21:40:32.681386  8760 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:40:32.681391  8760 net.cpp:156] Memory required for data: 46020
I0922 21:40:32.681396  8760 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0922 21:40:32.681406  8760 net.cpp:91] Creating Layer lstm2_h_conted_0
I0922 21:40:32.681412  8760 net.cpp:425] lstm2_h_conted_0 <- h_0
I0922 21:40:32.681418  8760 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0922 21:40:32.681432  8760 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0922 21:40:32.681535  8760 net.cpp:141] Setting up lstm2_h_conted_0
I0922 21:40:32.681546  8760 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:40:32.681550  8760 net.cpp:156] Memory required for data: 50020
I0922 21:40:32.681556  8760 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0922 21:40:32.681572  8760 net.cpp:91] Creating Layer lstm2_transform_1
I0922 21:40:32.681578  8760 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0922 21:40:32.681587  8760 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0922 21:40:32.725538  8760 net.cpp:141] Setting up lstm2_transform_1
I0922 21:40:32.725601  8760 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:40:32.725608  8760 net.cpp:156] Memory required for data: 66020
I0922 21:40:32.725630  8760 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0922 21:40:32.725654  8760 net.cpp:91] Creating Layer lstm2_gate_input_1
I0922 21:40:32.725662  8760 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0922 21:40:32.725672  8760 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0922 21:40:32.725680  8760 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0922 21:40:32.725744  8760 net.cpp:141] Setting up lstm2_gate_input_1
I0922 21:40:32.725755  8760 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:40:32.725759  8760 net.cpp:156] Memory required for data: 82020
I0922 21:40:32.725765  8760 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0922 21:40:32.725775  8760 net.cpp:91] Creating Layer lstm2_unit_1
I0922 21:40:32.725780  8760 net.cpp:425] lstm2_unit_1 <- c_0
I0922 21:40:32.725786  8760 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0922 21:40:32.725792  8760 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0922 21:40:32.725805  8760 net.cpp:399] lstm2_unit_1 -> c_1
I0922 21:40:32.725816  8760 net.cpp:399] lstm2_unit_1 -> h_1
I0922 21:40:32.725888  8760 net.cpp:141] Setting up lstm2_unit_1
I0922 21:40:32.725899  8760 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:40:32.725906  8760 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:40:32.725910  8760 net.cpp:156] Memory required for data: 90020
I0922 21:40:32.725916  8760 layer_factory.hpp:77] Creating layer lstm2_
I0922 21:40:32.725925  8760 net.cpp:91] Creating Layer lstm2_
I0922 21:40:32.725930  8760 net.cpp:425] lstm2_ <- c_1
I0922 21:40:32.725939  8760 net.cpp:399] lstm2_ -> c_T
I0922 21:40:32.725976  8760 net.cpp:141] Setting up lstm2_
I0922 21:40:32.725986  8760 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:40:32.725991  8760 net.cpp:156] Memory required for data: 94020
I0922 21:40:32.725996  8760 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0922 21:40:32.726007  8760 net.cpp:91] Creating Layer lstm2_h_concat
I0922 21:40:32.726012  8760 net.cpp:425] lstm2_h_concat <- h_1
I0922 21:40:32.726021  8760 net.cpp:399] lstm2_h_concat -> h
I0922 21:40:32.726058  8760 net.cpp:141] Setting up lstm2_h_concat
I0922 21:40:32.726066  8760 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:40:32.726071  8760 net.cpp:156] Memory required for data: 98020
I0922 21:40:32.726076  8760 layer_factory.hpp:77] Creating layer h_pseudoloss
I0922 21:40:32.726518  8760 net.cpp:91] Creating Layer h_pseudoloss
I0922 21:40:32.726536  8760 net.cpp:425] h_pseudoloss <- h
I0922 21:40:32.726548  8760 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0922 21:40:32.726665  8760 net.cpp:141] Setting up h_pseudoloss
I0922 21:40:32.726677  8760 net.cpp:148] Top shape: (1)
I0922 21:40:32.726682  8760 net.cpp:151]     with loss weight 1
I0922 21:40:32.726706  8760 net.cpp:156] Memory required for data: 98024
I0922 21:40:32.726712  8760 net.cpp:217] h_pseudoloss needs backward computation.
I0922 21:40:32.726717  8760 net.cpp:217] lstm2_h_concat needs backward computation.
I0922 21:40:32.726722  8760 net.cpp:219] lstm2_ does not need backward computation.
I0922 21:40:32.726728  8760 net.cpp:217] lstm2_unit_1 needs backward computation.
I0922 21:40:32.726734  8760 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0922 21:40:32.726740  8760 net.cpp:217] lstm2_transform_1 needs backward computation.
I0922 21:40:32.726747  8760 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0922 21:40:32.726752  8760 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0922 21:40:32.726758  8760 net.cpp:217] lstm2_x_transform needs backward computation.
I0922 21:40:32.726763  8760 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0922 21:40:32.726768  8760 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0922 21:40:32.726774  8760 net.cpp:219] lstm2_ does not need backward computation.
I0922 21:40:32.726779  8760 net.cpp:219] lstm2_ does not need backward computation.
I0922 21:40:32.726783  8760 net.cpp:261] This network produces output c_T
I0922 21:40:32.726788  8760 net.cpp:261] This network produces output h_pseudoloss
I0922 21:40:32.726809  8760 net.cpp:274] Network initialization done.
I0922 21:40:32.726861  8760 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0922 21:40:32.726867  8760 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0922 21:40:32.726872  8760 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0922 21:40:32.726986  8760 net.cpp:141] Setting up lstm2
I0922 21:40:32.726999  8760 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:40:32.727005  8760 net.cpp:156] Memory required for data: 36412
I0922 21:40:32.727031  8760 layer_factory.hpp:77] Creating layer predict
I0922 21:40:32.727046  8760 net.cpp:91] Creating Layer predict
I0922 21:40:32.727053  8760 net.cpp:425] predict <- lstm2
I0922 21:40:32.727062  8760 net.cpp:399] predict -> predict
I0922 21:40:32.895952  8766 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /home/peifeng/work/run/storm102/data/workers/0d7fa908-c1fe-469c-b54f-352b198b5b10/tmp/cvld5136087999396867864/bvlc_reference_caffenet.caffemodel
I0922 21:40:32.896003  8766 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0922 21:40:32.896009  8766 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0922 21:40:32.896014  8766 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /home/peifeng/work/run/storm102/data/workers/0d7fa908-c1fe-469c-b54f-352b198b5b10/tmp/cvld5136087999396867864/bvlc_reference_caffenet.caffemodel
I0922 21:40:33.218760  8760 net.cpp:141] Setting up predict
I0922 21:40:33.218837  8760 net.cpp:148] Top shape: 1 1 46168 (46168)
I0922 21:40:33.218845  8760 net.cpp:156] Memory required for data: 221084
I0922 21:40:33.218858  8760 layer_factory.hpp:77] Creating layer probs
I0922 21:40:33.218874  8760 net.cpp:91] Creating Layer probs
I0922 21:40:33.218881  8760 net.cpp:425] probs <- predict
I0922 21:40:33.218891  8760 net.cpp:399] probs -> probs
I0922 21:40:33.219723  8760 net.cpp:141] Setting up probs
I0922 21:40:33.219739  8760 net.cpp:148] Top shape: 1 1 46168 (46168)
I0922 21:40:33.219744  8760 net.cpp:156] Memory required for data: 405756
I0922 21:40:33.219750  8760 net.cpp:219] probs does not need backward computation.
I0922 21:40:33.219755  8760 net.cpp:219] predict does not need backward computation.
I0922 21:40:33.219760  8760 net.cpp:219] lstm2 does not need backward computation.
I0922 21:40:33.219766  8760 net.cpp:219] concat does not need backward computation.
I0922 21:40:33.219774  8760 net.cpp:219] lstm1 does not need backward computation.
I0922 21:40:33.219779  8760 net.cpp:219] embedding does not need backward computation.
I0922 21:40:33.219784  8760 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0922 21:40:33.219789  8760 net.cpp:219] reshape_frames does not need backward computation.
I0922 21:40:33.219794  8760 net.cpp:219] embed_encoder does not need backward computation.
I0922 21:40:33.219799  8760 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0922 21:40:33.219805  8760 net.cpp:219] input does not need backward computation.
I0922 21:40:33.219808  8760 net.cpp:261] This network produces output probs
I0922 21:40:33.219823  8760 net.cpp:274] Network initialization done.
I0922 21:40:33.284108  8766 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0922 21:40:33.330521  8766 net.cpp:752] Ignoring source layer loss
Loading the model + trained: 6704.17ms
Using cv::Size and some other stuff: 0.085ms
I0922 21:40:33.532053  8760 net.cpp:752] Ignoring source layer data
I0922 21:40:33.532091  8760 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0922 21:40:33.532097  8760 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0922 21:40:33.598578  8760 net.cpp:752] Ignoring source layer cross_entropy_loss
Loading the mean file: 11585.5ms
TIMERTIMER 298109274
TIMERTIMER 263398720
TIMERTIMER 271117068
TIMERTIMER 224411835
TIMERTIMER 230563239
TIMERTIMER 237818012
TIMERTIMER 227308346
TIMERTIMER 230663396
TIMERTIMER 193508291
TIMERTIMER 194717520
TIMERTIMER 197591490
TIMERTIMER 189784136
TIMERTIMER 195342728
TIMERTIMER 187835830
TIMERTIMER 187432018
TIMERTIMER 194386581
TIMERTIMER 193755937
TIMERTIMER 200002316
TIMERTIMER 193387030
TIMERTIMER 195150647
TIMERTIMER 194724994
TIMERTIMER 193683415
TIMERTIMER 188987988
TIMERTIMER 199817117
TIMERTIMER 190853480
TIMERTIMER 193976585
TIMERTIMER 194905440
TIMERTIMER 189745822
TIMERTIMER 200532418
TIMERTIMER 187556708
TIMERTIMER 193142583
