SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/peifeng/tools/storm102/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/peifeng/work/run/storm102/data/supervisor/stormdist/captioning-1-1474596521/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /home/peifeng/work/run/storm102/data/workers/5531f05f-53e3-467a-b9fa-a782857106e9/tmp/cvld364400699545464231/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0922 22:09:26.533438 18648 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/5531f05f-53e3-467a-b9fa-a782857106e9/tmp/cvld364400699545464231/s2vt.words_to_preds.prototxt
I0922 22:09:26.533563 18648 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0922 22:09:26.533572 18648 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0922 22:09:26.533572 18652 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/5531f05f-53e3-467a-b9fa-a782857106e9/tmp/cvld364400699545464231/s2vt.words_to_preds.prototxt
I0922 22:09:26.533601 18652 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0922 22:09:26.533610 18652 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0922 22:09:26.533906 18648 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0922 22:09:26.533978 18652 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0922 22:09:26.534042 18648 layer_factory.hpp:77] Creating layer input
I0922 22:09:26.534080 18658 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0922 22:09:26.534106 18648 net.cpp:91] Creating Layer input
I0922 22:09:26.534112 18652 layer_factory.hpp:77] Creating layer input
I0922 22:09:26.534119 18648 net.cpp:399] input -> frames_fc7
I0922 22:09:26.534132 18652 net.cpp:91] Creating Layer input
I0922 22:09:26.534143 18652 net.cpp:399] input -> frames_fc7
I0922 22:09:26.534158 18648 net.cpp:399] input -> cont_sentence
I0922 22:09:26.534163 18652 net.cpp:399] input -> cont_sentence
I0922 22:09:26.534171 18648 net.cpp:399] input -> input_sentence
I0922 22:09:26.534183 18648 net.cpp:399] input -> stage_indicator
I0922 22:09:26.534183 18652 net.cpp:399] input -> input_sentence
I0922 22:09:26.534200 18652 net.cpp:399] input -> stage_indicator
I0922 22:09:26.534240 18658 layer_factory.hpp:77] Creating layer data
I0922 22:09:26.534256 18658 net.cpp:91] Creating Layer data
I0922 22:09:26.534262 18658 net.cpp:399] data -> data
I0922 22:09:27.045053 18648 net.cpp:141] Setting up input
I0922 22:09:27.045084 18658 net.cpp:141] Setting up data
I0922 22:09:27.045119 18648 net.cpp:148] Top shape: 1 4096 (4096)
I0922 22:09:27.045120 18658 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0922 22:09:27.045127 18648 net.cpp:148] Top shape: 1 1 (1)
I0922 22:09:27.045133 18648 net.cpp:148] Top shape: 1 1 (1)
I0922 22:09:27.045140 18648 net.cpp:148] Top shape: 1 1 (1)
I0922 22:09:27.045131 18658 net.cpp:156] Memory required for data: 6183480
I0922 22:09:27.045143 18648 net.cpp:156] Memory required for data: 16396
I0922 22:09:27.045161 18648 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0922 22:09:27.045162 18658 layer_factory.hpp:77] Creating layer conv1
I0922 22:09:27.045181 18652 net.cpp:141] Setting up input
I0922 22:09:27.045192 18648 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0922 22:09:27.045197 18652 net.cpp:148] Top shape: 1 4096 (4096)
I0922 22:09:27.045200 18658 net.cpp:91] Creating Layer conv1
I0922 22:09:27.045203 18648 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0922 22:09:27.045209 18658 net.cpp:425] conv1 <- data
I0922 22:09:27.045209 18652 net.cpp:148] Top shape: 1 1 (1)
I0922 22:09:27.045227 18648 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0922 22:09:27.045228 18652 net.cpp:148] Top shape: 1 1 (1)
I0922 22:09:27.045231 18658 net.cpp:399] conv1 -> conv1
I0922 22:09:27.045243 18648 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0922 22:09:27.045245 18652 net.cpp:148] Top shape: 1 1 (1)
I0922 22:09:27.045254 18652 net.cpp:156] Memory required for data: 16396
I0922 22:09:27.045264 18652 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0922 22:09:27.045277 18652 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0922 22:09:27.045287 18652 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0922 22:09:27.045294 18648 net.cpp:141] Setting up cont_sentence_input_1_split
I0922 22:09:27.045303 18648 net.cpp:148] Top shape: 1 1 (1)
I0922 22:09:27.045305 18652 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0922 22:09:27.045310 18648 net.cpp:148] Top shape: 1 1 (1)
I0922 22:09:27.045323 18648 net.cpp:156] Memory required for data: 16404
I0922 22:09:27.045328 18648 layer_factory.hpp:77] Creating layer embed_encoder
I0922 22:09:27.045330 18652 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0922 22:09:27.045352 18648 net.cpp:91] Creating Layer embed_encoder
I0922 22:09:27.045358 18648 net.cpp:425] embed_encoder <- frames_fc7
I0922 22:09:27.045367 18648 net.cpp:399] embed_encoder -> embedded_in_frames
I0922 22:09:27.045426 18652 net.cpp:141] Setting up cont_sentence_input_1_split
I0922 22:09:27.045439 18652 net.cpp:148] Top shape: 1 1 (1)
I0922 22:09:27.045446 18652 net.cpp:148] Top shape: 1 1 (1)
I0922 22:09:27.045454 18652 net.cpp:156] Memory required for data: 16404
I0922 22:09:27.045464 18652 layer_factory.hpp:77] Creating layer embed_encoder
I0922 22:09:27.045480 18652 net.cpp:91] Creating Layer embed_encoder
I0922 22:09:27.045490 18652 net.cpp:425] embed_encoder <- frames_fc7
I0922 22:09:27.045516 18652 net.cpp:399] embed_encoder -> embedded_in_frames
I0922 22:09:27.073724 18648 net.cpp:141] Setting up embed_encoder
I0922 22:09:27.073766 18648 net.cpp:148] Top shape: 1 500 (500)
I0922 22:09:27.073773 18648 net.cpp:156] Memory required for data: 18404
I0922 22:09:27.073803 18648 layer_factory.hpp:77] Creating layer reshape_frames
I0922 22:09:27.073837 18648 net.cpp:91] Creating Layer reshape_frames
I0922 22:09:27.073846 18648 net.cpp:425] reshape_frames <- embedded_in_frames
I0922 22:09:27.073858 18648 net.cpp:399] reshape_frames -> embedded_input_frames
I0922 22:09:27.077679 18648 net.cpp:141] Setting up reshape_frames
I0922 22:09:27.077700 18648 net.cpp:148] Top shape: 1 1 500 (500)
I0922 22:09:27.077707 18648 net.cpp:156] Memory required for data: 20404
I0922 22:09:27.077713 18648 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0922 22:09:27.077725 18648 net.cpp:91] Creating Layer reshape_stage_indicator
I0922 22:09:27.077733 18648 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0922 22:09:27.077741 18648 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0922 22:09:27.077785 18648 net.cpp:141] Setting up reshape_stage_indicator
I0922 22:09:27.077795 18648 net.cpp:148] Top shape: 1 1 1 (1)
I0922 22:09:27.077798 18648 net.cpp:156] Memory required for data: 20408
I0922 22:09:27.077803 18648 layer_factory.hpp:77] Creating layer embedding
I0922 22:09:27.077816 18648 net.cpp:91] Creating Layer embedding
I0922 22:09:27.077821 18648 net.cpp:425] embedding <- input_sentence
I0922 22:09:27.077829 18648 net.cpp:399] embedding -> embedded_input_sentence
I0922 22:09:27.077869 18652 net.cpp:141] Setting up embed_encoder
I0922 22:09:27.077889 18652 net.cpp:148] Top shape: 1 500 (500)
I0922 22:09:27.077898 18652 net.cpp:156] Memory required for data: 18404
I0922 22:09:27.077916 18652 layer_factory.hpp:77] Creating layer reshape_frames
I0922 22:09:27.077929 18652 net.cpp:91] Creating Layer reshape_frames
I0922 22:09:27.077934 18652 net.cpp:425] reshape_frames <- embedded_in_frames
I0922 22:09:27.077946 18652 net.cpp:399] reshape_frames -> embedded_input_frames
I0922 22:09:27.117416 18652 net.cpp:141] Setting up reshape_frames
I0922 22:09:27.117472 18652 net.cpp:148] Top shape: 1 1 500 (500)
I0922 22:09:27.117482 18652 net.cpp:156] Memory required for data: 20404
I0922 22:09:27.117496 18652 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0922 22:09:27.117528 18652 net.cpp:91] Creating Layer reshape_stage_indicator
I0922 22:09:27.117540 18652 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0922 22:09:27.117559 18652 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0922 22:09:27.119747 18652 net.cpp:141] Setting up reshape_stage_indicator
I0922 22:09:27.119798 18652 net.cpp:148] Top shape: 1 1 1 (1)
I0922 22:09:27.119809 18652 net.cpp:156] Memory required for data: 20408
I0922 22:09:27.119824 18652 layer_factory.hpp:77] Creating layer embedding
I0922 22:09:27.119853 18652 net.cpp:91] Creating Layer embedding
I0922 22:09:27.119865 18652 net.cpp:425] embedding <- input_sentence
I0922 22:09:27.119884 18652 net.cpp:399] embedding -> embedded_input_sentence
I0922 22:09:27.303861 18648 net.cpp:141] Setting up embedding
I0922 22:09:27.303920 18648 net.cpp:148] Top shape: 1 1 500 (500)
I0922 22:09:27.303928 18648 net.cpp:156] Memory required for data: 22408
I0922 22:09:27.303951 18648 layer_factory.hpp:77] Creating layer lstm1
I0922 22:09:27.303987 18648 net.cpp:91] Creating Layer lstm1
I0922 22:09:27.303998 18648 net.cpp:425] lstm1 <- embedded_input_frames
I0922 22:09:27.304008 18648 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0922 22:09:27.304020 18648 net.cpp:399] lstm1 -> lstm1
I0922 22:09:27.304049 18648 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0922 22:09:27.304442 18648 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0922 22:09:27.304543 18648 layer_factory.hpp:77] Creating layer lstm1_
I0922 22:09:27.304558 18648 net.cpp:91] Creating Layer lstm1_
I0922 22:09:27.304565 18648 net.cpp:399] lstm1_ -> x
I0922 22:09:27.304579 18648 net.cpp:399] lstm1_ -> cont
I0922 22:09:27.306377 18648 net.cpp:141] Setting up lstm1_
I0922 22:09:27.306396 18648 net.cpp:148] Top shape: 1 1 500 (500)
I0922 22:09:27.306404 18648 net.cpp:148] Top shape: 1 1 (1)
I0922 22:09:27.306409 18648 net.cpp:156] Memory required for data: 2004
I0922 22:09:27.306416 18648 layer_factory.hpp:77] Creating layer lstm1_
I0922 22:09:27.306448 18648 net.cpp:91] Creating Layer lstm1_
I0922 22:09:27.306459 18648 net.cpp:399] lstm1_ -> c_0
I0922 22:09:27.306473 18648 net.cpp:399] lstm1_ -> h_0
I0922 22:09:27.309428 18648 net.cpp:141] Setting up lstm1_
I0922 22:09:27.309449 18648 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:09:27.309456 18648 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:09:27.309461 18648 net.cpp:156] Memory required for data: 10004
I0922 22:09:27.309468 18648 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0922 22:09:27.309479 18648 net.cpp:91] Creating Layer lstm1_cont_slice
I0922 22:09:27.309489 18648 net.cpp:425] lstm1_cont_slice <- cont
I0922 22:09:27.309497 18648 net.cpp:399] lstm1_cont_slice -> cont_1
I0922 22:09:27.310915 18648 net.cpp:141] Setting up lstm1_cont_slice
I0922 22:09:27.310935 18648 net.cpp:148] Top shape: 1 1 (1)
I0922 22:09:27.310940 18648 net.cpp:156] Memory required for data: 10008
I0922 22:09:27.310946 18648 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0922 22:09:27.310969 18648 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0922 22:09:27.310976 18648 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0922 22:09:27.310986 18648 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0922 22:09:27.310999 18648 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0922 22:09:27.315292 18648 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0922 22:09:27.315312 18648 net.cpp:148] Top shape: 1 1 (1)
I0922 22:09:27.315320 18648 net.cpp:148] Top shape: 1 1 (1)
I0922 22:09:27.315325 18648 net.cpp:156] Memory required for data: 10016
I0922 22:09:27.315331 18648 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0922 22:09:27.315348 18648 net.cpp:91] Creating Layer lstm1_x_transform
I0922 22:09:27.315354 18648 net.cpp:425] lstm1_x_transform <- x
I0922 22:09:27.315369 18648 net.cpp:399] lstm1_x_transform -> W_xc_x
I0922 22:09:27.338277 18648 net.cpp:141] Setting up lstm1_x_transform
I0922 22:09:27.338330 18648 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 22:09:27.338338 18648 net.cpp:156] Memory required for data: 26016
I0922 22:09:27.338363 18648 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0922 22:09:27.338382 18648 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0922 22:09:27.338389 18648 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0922 22:09:27.338404 18648 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0922 22:09:27.338587 18648 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0922 22:09:27.338600 18648 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 22:09:27.338605 18648 net.cpp:156] Memory required for data: 42016
I0922 22:09:27.338611 18648 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0922 22:09:27.338635 18648 net.cpp:91] Creating Layer lstm1_h_conted_0
I0922 22:09:27.338641 18648 net.cpp:425] lstm1_h_conted_0 <- h_0
I0922 22:09:27.338649 18648 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0922 22:09:27.338657 18648 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0922 22:09:27.342579 18648 net.cpp:141] Setting up lstm1_h_conted_0
I0922 22:09:27.342602 18648 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:09:27.342608 18648 net.cpp:156] Memory required for data: 46016
I0922 22:09:27.342615 18648 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0922 22:09:27.342630 18648 net.cpp:91] Creating Layer lstm1_transform_1
I0922 22:09:27.342638 18648 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0922 22:09:27.342663 18648 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0922 22:09:27.356281 18652 net.cpp:141] Setting up embedding
I0922 22:09:27.356331 18652 net.cpp:148] Top shape: 1 1 500 (500)
I0922 22:09:27.356338 18652 net.cpp:156] Memory required for data: 22408
I0922 22:09:27.356359 18652 layer_factory.hpp:77] Creating layer lstm1
I0922 22:09:27.356382 18652 net.cpp:91] Creating Layer lstm1
I0922 22:09:27.356390 18652 net.cpp:425] lstm1 <- embedded_input_frames
I0922 22:09:27.356400 18652 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0922 22:09:27.356410 18652 net.cpp:399] lstm1 -> lstm1
I0922 22:09:27.356429 18652 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0922 22:09:27.356729 18652 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0922 22:09:27.356825 18652 layer_factory.hpp:77] Creating layer lstm1_
I0922 22:09:27.356840 18652 net.cpp:91] Creating Layer lstm1_
I0922 22:09:27.356847 18652 net.cpp:399] lstm1_ -> x
I0922 22:09:27.356858 18652 net.cpp:399] lstm1_ -> cont
I0922 22:09:27.359670 18652 net.cpp:141] Setting up lstm1_
I0922 22:09:27.359699 18652 net.cpp:148] Top shape: 1 1 500 (500)
I0922 22:09:27.359706 18652 net.cpp:148] Top shape: 1 1 (1)
I0922 22:09:27.359710 18652 net.cpp:156] Memory required for data: 2004
I0922 22:09:27.359719 18652 layer_factory.hpp:77] Creating layer lstm1_
I0922 22:09:27.359738 18652 net.cpp:91] Creating Layer lstm1_
I0922 22:09:27.359751 18652 net.cpp:399] lstm1_ -> c_0
I0922 22:09:27.359769 18652 net.cpp:399] lstm1_ -> h_0
I0922 22:09:27.362067 18652 net.cpp:141] Setting up lstm1_
I0922 22:09:27.362085 18652 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:09:27.362092 18652 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:09:27.362097 18652 net.cpp:156] Memory required for data: 10004
I0922 22:09:27.362102 18652 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0922 22:09:27.362117 18652 net.cpp:91] Creating Layer lstm1_cont_slice
I0922 22:09:27.362123 18652 net.cpp:425] lstm1_cont_slice <- cont
I0922 22:09:27.362131 18652 net.cpp:399] lstm1_cont_slice -> cont_1
I0922 22:09:27.363101 18652 net.cpp:141] Setting up lstm1_cont_slice
I0922 22:09:27.363118 18652 net.cpp:148] Top shape: 1 1 (1)
I0922 22:09:27.363123 18652 net.cpp:156] Memory required for data: 10008
I0922 22:09:27.363129 18652 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0922 22:09:27.363138 18652 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0922 22:09:27.363144 18652 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0922 22:09:27.363154 18652 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0922 22:09:27.363164 18652 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0922 22:09:27.363314 18652 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0922 22:09:27.363325 18652 net.cpp:148] Top shape: 1 1 (1)
I0922 22:09:27.363330 18652 net.cpp:148] Top shape: 1 1 (1)
I0922 22:09:27.363335 18652 net.cpp:156] Memory required for data: 10016
I0922 22:09:27.363340 18652 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0922 22:09:27.363358 18652 net.cpp:91] Creating Layer lstm1_x_transform
I0922 22:09:27.363363 18652 net.cpp:425] lstm1_x_transform <- x
I0922 22:09:27.363371 18652 net.cpp:399] lstm1_x_transform -> W_xc_x
I0922 22:09:27.381531 18658 net.cpp:141] Setting up conv1
I0922 22:09:27.381577 18658 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0922 22:09:27.381582 18658 net.cpp:156] Memory required for data: 17799480
I0922 22:09:27.381606 18658 layer_factory.hpp:77] Creating layer relu1
I0922 22:09:27.381629 18658 net.cpp:91] Creating Layer relu1
I0922 22:09:27.381638 18658 net.cpp:425] relu1 <- conv1
I0922 22:09:27.381645 18658 net.cpp:386] relu1 -> conv1 (in-place)
I0922 22:09:27.382021 18658 net.cpp:141] Setting up relu1
I0922 22:09:27.382035 18658 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0922 22:09:27.382040 18658 net.cpp:156] Memory required for data: 29415480
I0922 22:09:27.382046 18658 layer_factory.hpp:77] Creating layer pool1
I0922 22:09:27.382061 18658 net.cpp:91] Creating Layer pool1
I0922 22:09:27.382066 18658 net.cpp:425] pool1 <- conv1
I0922 22:09:27.382074 18658 net.cpp:399] pool1 -> pool1
I0922 22:09:27.382220 18658 net.cpp:141] Setting up pool1
I0922 22:09:27.382231 18658 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0922 22:09:27.382236 18658 net.cpp:156] Memory required for data: 32214840
I0922 22:09:27.382241 18658 layer_factory.hpp:77] Creating layer norm1
I0922 22:09:27.382261 18658 net.cpp:91] Creating Layer norm1
I0922 22:09:27.382266 18658 net.cpp:425] norm1 <- pool1
I0922 22:09:27.382274 18658 net.cpp:399] norm1 -> norm1
I0922 22:09:27.382278 18652 net.cpp:141] Setting up lstm1_x_transform
I0922 22:09:27.382299 18652 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 22:09:27.382305 18652 net.cpp:156] Memory required for data: 26016
I0922 22:09:27.382318 18652 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0922 22:09:27.382333 18652 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0922 22:09:27.382339 18652 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0922 22:09:27.382347 18652 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0922 22:09:27.382465 18652 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0922 22:09:27.382477 18652 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 22:09:27.382482 18652 net.cpp:156] Memory required for data: 42016
I0922 22:09:27.382486 18652 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0922 22:09:27.382500 18652 net.cpp:91] Creating Layer lstm1_h_conted_0
I0922 22:09:27.382506 18652 net.cpp:425] lstm1_h_conted_0 <- h_0
I0922 22:09:27.382513 18652 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0922 22:09:27.382519 18652 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0922 22:09:27.382617 18652 net.cpp:141] Setting up lstm1_h_conted_0
I0922 22:09:27.382627 18652 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:09:27.382632 18652 net.cpp:156] Memory required for data: 46016
I0922 22:09:27.382637 18652 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0922 22:09:27.382652 18652 net.cpp:91] Creating Layer lstm1_transform_1
I0922 22:09:27.382658 18652 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0922 22:09:27.382663 18658 net.cpp:141] Setting up norm1
I0922 22:09:27.382666 18652 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0922 22:09:27.382679 18658 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0922 22:09:27.382684 18658 net.cpp:156] Memory required for data: 35014200
I0922 22:09:27.382689 18658 layer_factory.hpp:77] Creating layer conv2
I0922 22:09:27.382706 18658 net.cpp:91] Creating Layer conv2
I0922 22:09:27.382711 18658 net.cpp:425] conv2 <- norm1
I0922 22:09:27.382719 18658 net.cpp:399] conv2 -> conv2
I0922 22:09:27.390966 18648 net.cpp:141] Setting up lstm1_transform_1
I0922 22:09:27.391032 18648 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 22:09:27.391041 18648 net.cpp:156] Memory required for data: 62016
I0922 22:09:27.391062 18648 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0922 22:09:27.391100 18648 net.cpp:91] Creating Layer lstm1_gate_input_1
I0922 22:09:27.391109 18648 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0922 22:09:27.391119 18648 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0922 22:09:27.391127 18648 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0922 22:09:27.391330 18648 net.cpp:141] Setting up lstm1_gate_input_1
I0922 22:09:27.391342 18648 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 22:09:27.391348 18648 net.cpp:156] Memory required for data: 78016
I0922 22:09:27.391358 18648 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0922 22:09:27.391374 18648 net.cpp:91] Creating Layer lstm1_unit_1
I0922 22:09:27.391383 18648 net.cpp:425] lstm1_unit_1 <- c_0
I0922 22:09:27.391391 18648 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0922 22:09:27.391397 18648 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0922 22:09:27.391408 18648 net.cpp:399] lstm1_unit_1 -> c_1
I0922 22:09:27.391424 18648 net.cpp:399] lstm1_unit_1 -> h_1
I0922 22:09:27.391556 18648 net.cpp:141] Setting up lstm1_unit_1
I0922 22:09:27.391568 18648 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:09:27.391576 18648 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:09:27.391580 18648 net.cpp:156] Memory required for data: 86016
I0922 22:09:27.391587 18648 layer_factory.hpp:77] Creating layer lstm1_
I0922 22:09:27.391597 18648 net.cpp:91] Creating Layer lstm1_
I0922 22:09:27.391602 18648 net.cpp:425] lstm1_ <- c_1
I0922 22:09:27.391610 18648 net.cpp:399] lstm1_ -> c_T
I0922 22:09:27.391697 18648 net.cpp:141] Setting up lstm1_
I0922 22:09:27.391710 18648 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:09:27.391715 18648 net.cpp:156] Memory required for data: 90016
I0922 22:09:27.391721 18648 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0922 22:09:27.391731 18648 net.cpp:91] Creating Layer lstm1_h_concat
I0922 22:09:27.391736 18648 net.cpp:425] lstm1_h_concat <- h_1
I0922 22:09:27.391746 18648 net.cpp:399] lstm1_h_concat -> h
I0922 22:09:27.392071 18648 net.cpp:141] Setting up lstm1_h_concat
I0922 22:09:27.392083 18648 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:09:27.392088 18648 net.cpp:156] Memory required for data: 94016
I0922 22:09:27.392093 18648 layer_factory.hpp:77] Creating layer h_pseudoloss
I0922 22:09:27.392114 18648 net.cpp:91] Creating Layer h_pseudoloss
I0922 22:09:27.392120 18648 net.cpp:425] h_pseudoloss <- h
I0922 22:09:27.392128 18648 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0922 22:09:27.392416 18648 net.cpp:141] Setting up h_pseudoloss
I0922 22:09:27.392428 18648 net.cpp:148] Top shape: (1)
I0922 22:09:27.392433 18648 net.cpp:151]     with loss weight 1
I0922 22:09:27.392473 18648 net.cpp:156] Memory required for data: 94020
I0922 22:09:27.392480 18648 net.cpp:217] h_pseudoloss needs backward computation.
I0922 22:09:27.392485 18648 net.cpp:217] lstm1_h_concat needs backward computation.
I0922 22:09:27.392490 18648 net.cpp:219] lstm1_ does not need backward computation.
I0922 22:09:27.392496 18648 net.cpp:217] lstm1_unit_1 needs backward computation.
I0922 22:09:27.392503 18648 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0922 22:09:27.392508 18648 net.cpp:217] lstm1_transform_1 needs backward computation.
I0922 22:09:27.392514 18648 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0922 22:09:27.392520 18648 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0922 22:09:27.392526 18648 net.cpp:217] lstm1_x_transform needs backward computation.
I0922 22:09:27.392531 18648 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0922 22:09:27.392539 18648 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0922 22:09:27.392544 18648 net.cpp:219] lstm1_ does not need backward computation.
I0922 22:09:27.392549 18648 net.cpp:219] lstm1_ does not need backward computation.
I0922 22:09:27.392554 18648 net.cpp:261] This network produces output c_T
I0922 22:09:27.392559 18648 net.cpp:261] This network produces output h_pseudoloss
I0922 22:09:27.392581 18648 net.cpp:274] Network initialization done.
I0922 22:09:27.392648 18648 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0922 22:09:27.392655 18648 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0922 22:09:27.392662 18648 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0922 22:09:27.392962 18648 net.cpp:141] Setting up lstm1
I0922 22:09:27.392976 18648 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:09:27.392982 18648 net.cpp:156] Memory required for data: 26408
I0922 22:09:27.392997 18648 layer_factory.hpp:77] Creating layer concat
I0922 22:09:27.393007 18648 net.cpp:91] Creating Layer concat
I0922 22:09:27.393015 18648 net.cpp:425] concat <- lstm1
I0922 22:09:27.393023 18648 net.cpp:425] concat <- embedded_input_sentence
I0922 22:09:27.393029 18648 net.cpp:425] concat <- reshaped_stage_indicator
I0922 22:09:27.393038 18648 net.cpp:399] concat -> lstm1_video_sequence
I0922 22:09:27.393085 18648 net.cpp:141] Setting up concat
I0922 22:09:27.393095 18648 net.cpp:148] Top shape: 1 1 1501 (1501)
I0922 22:09:27.393100 18648 net.cpp:156] Memory required for data: 32412
I0922 22:09:27.393105 18648 layer_factory.hpp:77] Creating layer lstm2
I0922 22:09:27.393120 18648 net.cpp:91] Creating Layer lstm2
I0922 22:09:27.393126 18648 net.cpp:425] lstm2 <- lstm1_video_sequence
I0922 22:09:27.393132 18648 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0922 22:09:27.393141 18648 net.cpp:399] lstm2 -> lstm2
I0922 22:09:27.393153 18648 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0922 22:09:27.393432 18648 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0922 22:09:27.393529 18648 layer_factory.hpp:77] Creating layer lstm2_
I0922 22:09:27.393543 18648 net.cpp:91] Creating Layer lstm2_
I0922 22:09:27.393551 18648 net.cpp:399] lstm2_ -> x
I0922 22:09:27.393563 18648 net.cpp:399] lstm2_ -> cont
I0922 22:09:27.393637 18648 net.cpp:141] Setting up lstm2_
I0922 22:09:27.393648 18648 net.cpp:148] Top shape: 1 1 1501 (1501)
I0922 22:09:27.393656 18648 net.cpp:148] Top shape: 1 1 (1)
I0922 22:09:27.393661 18648 net.cpp:156] Memory required for data: 6008
I0922 22:09:27.393666 18648 layer_factory.hpp:77] Creating layer lstm2_
I0922 22:09:27.393676 18648 net.cpp:91] Creating Layer lstm2_
I0922 22:09:27.393688 18648 net.cpp:399] lstm2_ -> c_0
I0922 22:09:27.393700 18648 net.cpp:399] lstm2_ -> h_0
I0922 22:09:27.393868 18658 net.cpp:141] Setting up conv2
I0922 22:09:27.393888 18648 net.cpp:141] Setting up lstm2_
I0922 22:09:27.393903 18648 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:09:27.393906 18658 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0922 22:09:27.393910 18648 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:09:27.393913 18658 net.cpp:156] Memory required for data: 42479160
I0922 22:09:27.393916 18648 net.cpp:156] Memory required for data: 14008
I0922 22:09:27.393923 18648 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0922 22:09:27.393934 18658 layer_factory.hpp:77] Creating layer relu2
I0922 22:09:27.393937 18648 net.cpp:91] Creating Layer lstm2_cont_slice
I0922 22:09:27.393944 18648 net.cpp:425] lstm2_cont_slice <- cont
I0922 22:09:27.393949 18658 net.cpp:91] Creating Layer relu2
I0922 22:09:27.393954 18648 net.cpp:399] lstm2_cont_slice -> cont_1
I0922 22:09:27.393957 18658 net.cpp:425] relu2 <- conv2
I0922 22:09:27.393966 18658 net.cpp:386] relu2 -> conv2 (in-place)
I0922 22:09:27.393995 18648 net.cpp:141] Setting up lstm2_cont_slice
I0922 22:09:27.394006 18648 net.cpp:148] Top shape: 1 1 (1)
I0922 22:09:27.394011 18648 net.cpp:156] Memory required for data: 14012
I0922 22:09:27.394016 18648 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0922 22:09:27.394024 18648 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0922 22:09:27.394031 18648 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0922 22:09:27.394042 18648 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0922 22:09:27.394052 18648 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0922 22:09:27.394361 18648 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0922 22:09:27.394373 18648 net.cpp:148] Top shape: 1 1 (1)
I0922 22:09:27.394381 18648 net.cpp:148] Top shape: 1 1 (1)
I0922 22:09:27.394385 18648 net.cpp:156] Memory required for data: 14020
I0922 22:09:27.394390 18648 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0922 22:09:27.394407 18648 net.cpp:91] Creating Layer lstm2_x_transform
I0922 22:09:27.394412 18648 net.cpp:425] lstm2_x_transform <- x
I0922 22:09:27.394423 18648 net.cpp:399] lstm2_x_transform -> W_xc_x
I0922 22:09:27.394460 18658 net.cpp:141] Setting up relu2
I0922 22:09:27.394474 18658 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0922 22:09:27.394480 18658 net.cpp:156] Memory required for data: 49944120
I0922 22:09:27.394485 18658 layer_factory.hpp:77] Creating layer pool2
I0922 22:09:27.394498 18658 net.cpp:91] Creating Layer pool2
I0922 22:09:27.394503 18658 net.cpp:425] pool2 <- conv2
I0922 22:09:27.394512 18658 net.cpp:399] pool2 -> pool2
I0922 22:09:27.406301 18658 net.cpp:141] Setting up pool2
I0922 22:09:27.406338 18658 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0922 22:09:27.406344 18658 net.cpp:156] Memory required for data: 51674680
I0922 22:09:27.406353 18658 layer_factory.hpp:77] Creating layer norm2
I0922 22:09:27.406379 18658 net.cpp:91] Creating Layer norm2
I0922 22:09:27.406388 18658 net.cpp:425] norm2 <- pool2
I0922 22:09:27.406399 18658 net.cpp:399] norm2 -> norm2
I0922 22:09:27.406738 18658 net.cpp:141] Setting up norm2
I0922 22:09:27.406749 18658 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0922 22:09:27.406754 18658 net.cpp:156] Memory required for data: 53405240
I0922 22:09:27.406759 18658 layer_factory.hpp:77] Creating layer conv3
I0922 22:09:27.406776 18658 net.cpp:91] Creating Layer conv3
I0922 22:09:27.406782 18658 net.cpp:425] conv3 <- norm2
I0922 22:09:27.406790 18658 net.cpp:399] conv3 -> conv3
I0922 22:09:27.410214 18658 net.cpp:141] Setting up conv3
I0922 22:09:27.410230 18658 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0922 22:09:27.410236 18658 net.cpp:156] Memory required for data: 56001080
I0922 22:09:27.410254 18658 layer_factory.hpp:77] Creating layer relu3
I0922 22:09:27.410265 18658 net.cpp:91] Creating Layer relu3
I0922 22:09:27.410270 18658 net.cpp:425] relu3 <- conv3
I0922 22:09:27.410279 18658 net.cpp:386] relu3 -> conv3 (in-place)
I0922 22:09:27.410485 18658 net.cpp:141] Setting up relu3
I0922 22:09:27.410496 18658 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0922 22:09:27.410501 18658 net.cpp:156] Memory required for data: 58596920
I0922 22:09:27.410506 18658 layer_factory.hpp:77] Creating layer conv4
I0922 22:09:27.410518 18658 net.cpp:91] Creating Layer conv4
I0922 22:09:27.410524 18658 net.cpp:425] conv4 <- conv3
I0922 22:09:27.410532 18658 net.cpp:399] conv4 -> conv4
I0922 22:09:27.414293 18658 net.cpp:141] Setting up conv4
I0922 22:09:27.414312 18658 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0922 22:09:27.414319 18658 net.cpp:156] Memory required for data: 61192760
I0922 22:09:27.414327 18658 layer_factory.hpp:77] Creating layer relu4
I0922 22:09:27.414337 18658 net.cpp:91] Creating Layer relu4
I0922 22:09:27.414342 18658 net.cpp:425] relu4 <- conv4
I0922 22:09:27.414350 18658 net.cpp:386] relu4 -> conv4 (in-place)
I0922 22:09:27.414726 18658 net.cpp:141] Setting up relu4
I0922 22:09:27.414742 18658 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0922 22:09:27.414747 18658 net.cpp:156] Memory required for data: 63788600
I0922 22:09:27.414752 18658 layer_factory.hpp:77] Creating layer conv5
I0922 22:09:27.414763 18658 net.cpp:91] Creating Layer conv5
I0922 22:09:27.414769 18658 net.cpp:425] conv5 <- conv4
I0922 22:09:27.414779 18658 net.cpp:399] conv5 -> conv5
I0922 22:09:27.418220 18658 net.cpp:141] Setting up conv5
I0922 22:09:27.418236 18658 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0922 22:09:27.418241 18658 net.cpp:156] Memory required for data: 65519160
I0922 22:09:27.418256 18658 layer_factory.hpp:77] Creating layer relu5
I0922 22:09:27.418264 18658 net.cpp:91] Creating Layer relu5
I0922 22:09:27.418269 18658 net.cpp:425] relu5 <- conv5
I0922 22:09:27.418280 18658 net.cpp:386] relu5 -> conv5 (in-place)
I0922 22:09:27.418653 18658 net.cpp:141] Setting up relu5
I0922 22:09:27.418666 18658 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0922 22:09:27.418673 18658 net.cpp:156] Memory required for data: 67249720
I0922 22:09:27.418678 18658 layer_factory.hpp:77] Creating layer pool5
I0922 22:09:27.418689 18658 net.cpp:91] Creating Layer pool5
I0922 22:09:27.418694 18658 net.cpp:425] pool5 <- conv5
I0922 22:09:27.418704 18658 net.cpp:399] pool5 -> pool5
I0922 22:09:27.418768 18658 net.cpp:141] Setting up pool5
I0922 22:09:27.418778 18658 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0922 22:09:27.418783 18658 net.cpp:156] Memory required for data: 67618360
I0922 22:09:27.418788 18658 layer_factory.hpp:77] Creating layer fc6
I0922 22:09:27.418802 18658 net.cpp:91] Creating Layer fc6
I0922 22:09:27.418807 18658 net.cpp:425] fc6 <- pool5
I0922 22:09:27.418815 18658 net.cpp:399] fc6 -> fc6
I0922 22:09:27.485419 18652 net.cpp:141] Setting up lstm1_transform_1
I0922 22:09:27.485483 18652 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 22:09:27.485491 18652 net.cpp:156] Memory required for data: 62016
I0922 22:09:27.485520 18652 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0922 22:09:27.485550 18652 net.cpp:91] Creating Layer lstm1_gate_input_1
I0922 22:09:27.485560 18652 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0922 22:09:27.485571 18652 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0922 22:09:27.485584 18652 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0922 22:09:27.485631 18648 net.cpp:141] Setting up lstm2_x_transform
I0922 22:09:27.485672 18648 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 22:09:27.485689 18648 net.cpp:156] Memory required for data: 30020
I0922 22:09:27.485712 18648 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0922 22:09:27.485733 18648 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0922 22:09:27.485743 18648 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0922 22:09:27.485754 18648 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0922 22:09:27.485815 18648 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0922 22:09:27.485826 18648 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 22:09:27.485831 18648 net.cpp:156] Memory required for data: 46020
I0922 22:09:27.485837 18648 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0922 22:09:27.485854 18648 net.cpp:91] Creating Layer lstm2_h_conted_0
I0922 22:09:27.485862 18648 net.cpp:425] lstm2_h_conted_0 <- h_0
I0922 22:09:27.485869 18648 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0922 22:09:27.485878 18648 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0922 22:09:27.485980 18648 net.cpp:141] Setting up lstm2_h_conted_0
I0922 22:09:27.485991 18648 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:09:27.485997 18648 net.cpp:156] Memory required for data: 50020
I0922 22:09:27.486003 18648 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0922 22:09:27.486021 18648 net.cpp:91] Creating Layer lstm2_transform_1
I0922 22:09:27.486027 18648 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0922 22:09:27.486037 18648 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0922 22:09:27.485671 18652 net.cpp:141] Setting up lstm1_gate_input_1
I0922 22:09:27.488133 18652 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 22:09:27.488155 18652 net.cpp:156] Memory required for data: 78016
I0922 22:09:27.488169 18652 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0922 22:09:27.488193 18652 net.cpp:91] Creating Layer lstm1_unit_1
I0922 22:09:27.488206 18652 net.cpp:425] lstm1_unit_1 <- c_0
I0922 22:09:27.488224 18652 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0922 22:09:27.488237 18652 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0922 22:09:27.488255 18652 net.cpp:399] lstm1_unit_1 -> c_1
I0922 22:09:27.488278 18652 net.cpp:399] lstm1_unit_1 -> h_1
I0922 22:09:27.494246 18652 net.cpp:141] Setting up lstm1_unit_1
I0922 22:09:27.494294 18652 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:09:27.494307 18652 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:09:27.494314 18652 net.cpp:156] Memory required for data: 86016
I0922 22:09:27.494328 18652 layer_factory.hpp:77] Creating layer lstm1_
I0922 22:09:27.494357 18652 net.cpp:91] Creating Layer lstm1_
I0922 22:09:27.494370 18652 net.cpp:425] lstm1_ <- c_1
I0922 22:09:27.494390 18652 net.cpp:399] lstm1_ -> c_T
I0922 22:09:27.494451 18652 net.cpp:141] Setting up lstm1_
I0922 22:09:27.494465 18652 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:09:27.494472 18652 net.cpp:156] Memory required for data: 90016
I0922 22:09:27.494480 18652 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0922 22:09:27.494495 18652 net.cpp:91] Creating Layer lstm1_h_concat
I0922 22:09:27.494505 18652 net.cpp:425] lstm1_h_concat <- h_1
I0922 22:09:27.494521 18652 net.cpp:399] lstm1_h_concat -> h
I0922 22:09:27.494580 18652 net.cpp:141] Setting up lstm1_h_concat
I0922 22:09:27.494596 18652 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:09:27.494603 18652 net.cpp:156] Memory required for data: 94016
I0922 22:09:27.494611 18652 layer_factory.hpp:77] Creating layer h_pseudoloss
I0922 22:09:27.494626 18652 net.cpp:91] Creating Layer h_pseudoloss
I0922 22:09:27.494633 18652 net.cpp:425] h_pseudoloss <- h
I0922 22:09:27.494645 18652 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0922 22:09:27.494796 18652 net.cpp:141] Setting up h_pseudoloss
I0922 22:09:27.494814 18652 net.cpp:148] Top shape: (1)
I0922 22:09:27.494822 18652 net.cpp:151]     with loss weight 1
I0922 22:09:27.494842 18652 net.cpp:156] Memory required for data: 94020
I0922 22:09:27.494850 18652 net.cpp:217] h_pseudoloss needs backward computation.
I0922 22:09:27.494860 18652 net.cpp:217] lstm1_h_concat needs backward computation.
I0922 22:09:27.494868 18652 net.cpp:219] lstm1_ does not need backward computation.
I0922 22:09:27.494877 18652 net.cpp:217] lstm1_unit_1 needs backward computation.
I0922 22:09:27.494889 18652 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0922 22:09:27.494900 18652 net.cpp:217] lstm1_transform_1 needs backward computation.
I0922 22:09:27.494910 18652 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0922 22:09:27.494921 18652 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0922 22:09:27.494931 18652 net.cpp:217] lstm1_x_transform needs backward computation.
I0922 22:09:27.494943 18652 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0922 22:09:27.494954 18652 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0922 22:09:27.494964 18652 net.cpp:219] lstm1_ does not need backward computation.
I0922 22:09:27.494974 18652 net.cpp:219] lstm1_ does not need backward computation.
I0922 22:09:27.494982 18652 net.cpp:261] This network produces output c_T
I0922 22:09:27.494992 18652 net.cpp:261] This network produces output h_pseudoloss
I0922 22:09:27.495036 18652 net.cpp:274] Network initialization done.
I0922 22:09:27.495124 18652 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0922 22:09:27.495141 18652 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0922 22:09:27.495151 18652 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0922 22:09:27.495332 18652 net.cpp:141] Setting up lstm1
I0922 22:09:27.495352 18652 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:09:27.495362 18652 net.cpp:156] Memory required for data: 26408
I0922 22:09:27.495389 18652 layer_factory.hpp:77] Creating layer concat
I0922 22:09:27.495406 18652 net.cpp:91] Creating Layer concat
I0922 22:09:27.495419 18652 net.cpp:425] concat <- lstm1
I0922 22:09:27.495432 18652 net.cpp:425] concat <- embedded_input_sentence
I0922 22:09:27.495445 18652 net.cpp:425] concat <- reshaped_stage_indicator
I0922 22:09:27.495460 18652 net.cpp:399] concat -> lstm1_video_sequence
I0922 22:09:27.495517 18652 net.cpp:141] Setting up concat
I0922 22:09:27.495534 18652 net.cpp:148] Top shape: 1 1 1501 (1501)
I0922 22:09:27.495544 18652 net.cpp:156] Memory required for data: 32412
I0922 22:09:27.495553 18652 layer_factory.hpp:77] Creating layer lstm2
I0922 22:09:27.495576 18652 net.cpp:91] Creating Layer lstm2
I0922 22:09:27.495589 18652 net.cpp:425] lstm2 <- lstm1_video_sequence
I0922 22:09:27.495601 18652 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0922 22:09:27.495616 18652 net.cpp:399] lstm2 -> lstm2
I0922 22:09:27.495637 18652 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0922 22:09:27.496069 18652 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0922 22:09:27.496227 18652 layer_factory.hpp:77] Creating layer lstm2_
I0922 22:09:27.496250 18652 net.cpp:91] Creating Layer lstm2_
I0922 22:09:27.496265 18652 net.cpp:399] lstm2_ -> x
I0922 22:09:27.496285 18652 net.cpp:399] lstm2_ -> cont
I0922 22:09:27.496383 18652 net.cpp:141] Setting up lstm2_
I0922 22:09:27.496402 18652 net.cpp:148] Top shape: 1 1 1501 (1501)
I0922 22:09:27.496415 18652 net.cpp:148] Top shape: 1 1 (1)
I0922 22:09:27.496424 18652 net.cpp:156] Memory required for data: 6008
I0922 22:09:27.496434 18652 layer_factory.hpp:77] Creating layer lstm2_
I0922 22:09:27.496456 18652 net.cpp:91] Creating Layer lstm2_
I0922 22:09:27.496471 18652 net.cpp:399] lstm2_ -> c_0
I0922 22:09:27.496492 18652 net.cpp:399] lstm2_ -> h_0
I0922 22:09:27.496592 18652 net.cpp:141] Setting up lstm2_
I0922 22:09:27.496611 18652 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:09:27.496624 18652 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:09:27.496632 18652 net.cpp:156] Memory required for data: 14008
I0922 22:09:27.496641 18652 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0922 22:09:27.496657 18652 net.cpp:91] Creating Layer lstm2_cont_slice
I0922 22:09:27.496670 18652 net.cpp:425] lstm2_cont_slice <- cont
I0922 22:09:27.496683 18652 net.cpp:399] lstm2_cont_slice -> cont_1
I0922 22:09:27.496748 18652 net.cpp:141] Setting up lstm2_cont_slice
I0922 22:09:27.496765 18652 net.cpp:148] Top shape: 1 1 (1)
I0922 22:09:27.496774 18652 net.cpp:156] Memory required for data: 14012
I0922 22:09:27.496783 18652 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0922 22:09:27.496798 18652 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0922 22:09:27.496814 18652 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0922 22:09:27.496827 18652 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0922 22:09:27.496845 18652 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0922 22:09:27.496937 18652 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0922 22:09:27.496955 18652 net.cpp:148] Top shape: 1 1 (1)
I0922 22:09:27.496968 18652 net.cpp:148] Top shape: 1 1 (1)
I0922 22:09:27.496976 18652 net.cpp:156] Memory required for data: 14020
I0922 22:09:27.496985 18652 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0922 22:09:27.497004 18652 net.cpp:91] Creating Layer lstm2_x_transform
I0922 22:09:27.497015 18652 net.cpp:425] lstm2_x_transform <- x
I0922 22:09:27.497038 18652 net.cpp:399] lstm2_x_transform -> W_xc_x
I0922 22:09:27.521253 18658 net.cpp:141] Setting up fc6
I0922 22:09:27.521294 18658 net.cpp:148] Top shape: 10 4096 (40960)
I0922 22:09:27.521301 18658 net.cpp:156] Memory required for data: 67782200
I0922 22:09:27.521316 18658 layer_factory.hpp:77] Creating layer relu6
I0922 22:09:27.521339 18658 net.cpp:91] Creating Layer relu6
I0922 22:09:27.521347 18658 net.cpp:425] relu6 <- fc6
I0922 22:09:27.521358 18658 net.cpp:386] relu6 -> fc6 (in-place)
I0922 22:09:27.521687 18658 net.cpp:141] Setting up relu6
I0922 22:09:27.521698 18658 net.cpp:148] Top shape: 10 4096 (40960)
I0922 22:09:27.521703 18658 net.cpp:156] Memory required for data: 67946040
I0922 22:09:27.521708 18658 layer_factory.hpp:77] Creating layer drop6
I0922 22:09:27.521730 18658 net.cpp:91] Creating Layer drop6
I0922 22:09:27.521735 18658 net.cpp:425] drop6 <- fc6
I0922 22:09:27.521742 18658 net.cpp:386] drop6 -> fc6 (in-place)
I0922 22:09:27.521811 18658 net.cpp:141] Setting up drop6
I0922 22:09:27.521821 18658 net.cpp:148] Top shape: 10 4096 (40960)
I0922 22:09:27.521826 18658 net.cpp:156] Memory required for data: 68109880
I0922 22:09:27.521831 18658 layer_factory.hpp:77] Creating layer fc7
I0922 22:09:27.521844 18658 net.cpp:91] Creating Layer fc7
I0922 22:09:27.521849 18658 net.cpp:425] fc7 <- fc6
I0922 22:09:27.521857 18658 net.cpp:399] fc7 -> fc7
I0922 22:09:27.551080 18648 net.cpp:141] Setting up lstm2_transform_1
I0922 22:09:27.551136 18648 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 22:09:27.551143 18648 net.cpp:156] Memory required for data: 66020
I0922 22:09:27.551167 18648 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0922 22:09:27.551192 18648 net.cpp:91] Creating Layer lstm2_gate_input_1
I0922 22:09:27.551201 18648 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0922 22:09:27.551211 18648 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0922 22:09:27.551221 18648 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0922 22:09:27.551292 18648 net.cpp:141] Setting up lstm2_gate_input_1
I0922 22:09:27.551303 18648 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 22:09:27.551308 18648 net.cpp:156] Memory required for data: 82020
I0922 22:09:27.551313 18648 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0922 22:09:27.551331 18648 net.cpp:91] Creating Layer lstm2_unit_1
I0922 22:09:27.551337 18648 net.cpp:425] lstm2_unit_1 <- c_0
I0922 22:09:27.551344 18648 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0922 22:09:27.551350 18648 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0922 22:09:27.551358 18648 net.cpp:399] lstm2_unit_1 -> c_1
I0922 22:09:27.551368 18648 net.cpp:399] lstm2_unit_1 -> h_1
I0922 22:09:27.551441 18648 net.cpp:141] Setting up lstm2_unit_1
I0922 22:09:27.551452 18648 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:09:27.551460 18648 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:09:27.551463 18648 net.cpp:156] Memory required for data: 90020
I0922 22:09:27.551470 18648 layer_factory.hpp:77] Creating layer lstm2_
I0922 22:09:27.551479 18648 net.cpp:91] Creating Layer lstm2_
I0922 22:09:27.551484 18648 net.cpp:425] lstm2_ <- c_1
I0922 22:09:27.551492 18648 net.cpp:399] lstm2_ -> c_T
I0922 22:09:27.551532 18648 net.cpp:141] Setting up lstm2_
I0922 22:09:27.551542 18648 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:09:27.551547 18648 net.cpp:156] Memory required for data: 94020
I0922 22:09:27.551553 18648 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0922 22:09:27.551563 18648 net.cpp:91] Creating Layer lstm2_h_concat
I0922 22:09:27.551568 18648 net.cpp:425] lstm2_h_concat <- h_1
I0922 22:09:27.551576 18648 net.cpp:399] lstm2_h_concat -> h
I0922 22:09:27.551618 18648 net.cpp:141] Setting up lstm2_h_concat
I0922 22:09:27.551628 18648 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:09:27.551633 18648 net.cpp:156] Memory required for data: 98020
I0922 22:09:27.551640 18648 layer_factory.hpp:77] Creating layer h_pseudoloss
I0922 22:09:27.551650 18648 net.cpp:91] Creating Layer h_pseudoloss
I0922 22:09:27.551656 18648 net.cpp:425] h_pseudoloss <- h
I0922 22:09:27.551663 18648 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0922 22:09:27.551769 18648 net.cpp:141] Setting up h_pseudoloss
I0922 22:09:27.551781 18648 net.cpp:148] Top shape: (1)
I0922 22:09:27.551786 18648 net.cpp:151]     with loss weight 1
I0922 22:09:27.551810 18648 net.cpp:156] Memory required for data: 98024
I0922 22:09:27.551815 18648 net.cpp:217] h_pseudoloss needs backward computation.
I0922 22:09:27.551821 18648 net.cpp:217] lstm2_h_concat needs backward computation.
I0922 22:09:27.551826 18648 net.cpp:219] lstm2_ does not need backward computation.
I0922 22:09:27.551832 18648 net.cpp:217] lstm2_unit_1 needs backward computation.
I0922 22:09:27.551838 18648 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0922 22:09:27.551844 18648 net.cpp:217] lstm2_transform_1 needs backward computation.
I0922 22:09:27.551851 18648 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0922 22:09:27.551861 18648 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0922 22:09:27.551867 18648 net.cpp:217] lstm2_x_transform needs backward computation.
I0922 22:09:27.551873 18648 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0922 22:09:27.551879 18648 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0922 22:09:27.551885 18648 net.cpp:219] lstm2_ does not need backward computation.
I0922 22:09:27.551890 18648 net.cpp:219] lstm2_ does not need backward computation.
I0922 22:09:27.551895 18648 net.cpp:261] This network produces output c_T
I0922 22:09:27.551900 18648 net.cpp:261] This network produces output h_pseudoloss
I0922 22:09:27.551916 18648 net.cpp:274] Network initialization done.
I0922 22:09:27.551975 18648 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0922 22:09:27.551982 18648 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0922 22:09:27.551987 18648 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0922 22:09:27.552111 18648 net.cpp:141] Setting up lstm2
I0922 22:09:27.552125 18648 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:09:27.552130 18648 net.cpp:156] Memory required for data: 36412
I0922 22:09:27.552147 18648 layer_factory.hpp:77] Creating layer predict
I0922 22:09:27.552163 18648 net.cpp:91] Creating Layer predict
I0922 22:09:27.552170 18648 net.cpp:425] predict <- lstm2
I0922 22:09:27.552178 18648 net.cpp:399] predict -> predict
I0922 22:09:27.639238 18652 net.cpp:141] Setting up lstm2_x_transform
I0922 22:09:27.639279 18658 net.cpp:141] Setting up fc7
I0922 22:09:27.639286 18652 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 22:09:27.639300 18658 net.cpp:148] Top shape: 10 4096 (40960)
I0922 22:09:27.639303 18652 net.cpp:156] Memory required for data: 30020
I0922 22:09:27.639307 18658 net.cpp:156] Memory required for data: 68273720
I0922 22:09:27.639320 18658 layer_factory.hpp:77] Creating layer relu7
I0922 22:09:27.639328 18652 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0922 22:09:27.639339 18658 net.cpp:91] Creating Layer relu7
I0922 22:09:27.639341 18652 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0922 22:09:27.639346 18658 net.cpp:425] relu7 <- fc7
I0922 22:09:27.639349 18652 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0922 22:09:27.639358 18652 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0922 22:09:27.639359 18658 net.cpp:386] relu7 -> fc7 (in-place)
I0922 22:09:27.639420 18652 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0922 22:09:27.639430 18652 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 22:09:27.639434 18652 net.cpp:156] Memory required for data: 46020
I0922 22:09:27.639439 18652 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0922 22:09:27.639451 18652 net.cpp:91] Creating Layer lstm2_h_conted_0
I0922 22:09:27.639456 18652 net.cpp:425] lstm2_h_conted_0 <- h_0
I0922 22:09:27.639462 18652 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0922 22:09:27.639469 18652 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0922 22:09:27.639932 18652 net.cpp:141] Setting up lstm2_h_conted_0
I0922 22:09:27.639945 18652 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:09:27.639948 18652 net.cpp:156] Memory required for data: 50020
I0922 22:09:27.639953 18652 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0922 22:09:27.639967 18652 net.cpp:91] Creating Layer lstm2_transform_1
I0922 22:09:27.639972 18652 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0922 22:09:27.639981 18652 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0922 22:09:27.647660 18658 net.cpp:141] Setting up relu7
I0922 22:09:27.647706 18658 net.cpp:148] Top shape: 10 4096 (40960)
I0922 22:09:27.647712 18658 net.cpp:156] Memory required for data: 68437560
I0922 22:09:27.647722 18658 layer_factory.hpp:77] Creating layer drop7
I0922 22:09:27.647742 18658 net.cpp:91] Creating Layer drop7
I0922 22:09:27.647750 18658 net.cpp:425] drop7 <- fc7
I0922 22:09:27.647766 18658 net.cpp:386] drop7 -> fc7 (in-place)
I0922 22:09:27.647853 18658 net.cpp:141] Setting up drop7
I0922 22:09:27.647862 18658 net.cpp:148] Top shape: 10 4096 (40960)
I0922 22:09:27.647866 18658 net.cpp:156] Memory required for data: 68601400
I0922 22:09:27.647871 18658 layer_factory.hpp:77] Creating layer fc8
I0922 22:09:27.647888 18658 net.cpp:91] Creating Layer fc8
I0922 22:09:27.647893 18658 net.cpp:425] fc8 <- fc7
I0922 22:09:27.647902 18658 net.cpp:399] fc8 -> fc8
I0922 22:09:27.660150 18658 net.cpp:141] Setting up fc8
I0922 22:09:27.660195 18658 net.cpp:148] Top shape: 10 1000 (10000)
I0922 22:09:27.660202 18658 net.cpp:156] Memory required for data: 68641400
I0922 22:09:27.660217 18658 layer_factory.hpp:77] Creating layer prob
I0922 22:09:27.660235 18658 net.cpp:91] Creating Layer prob
I0922 22:09:27.660243 18658 net.cpp:425] prob <- fc8
I0922 22:09:27.660259 18658 net.cpp:399] prob -> prob
I0922 22:09:27.660677 18658 net.cpp:141] Setting up prob
I0922 22:09:27.660689 18658 net.cpp:148] Top shape: 10 1000 (10000)
I0922 22:09:27.660694 18658 net.cpp:156] Memory required for data: 68681400
I0922 22:09:27.660701 18658 net.cpp:219] prob does not need backward computation.
I0922 22:09:27.660706 18658 net.cpp:219] fc8 does not need backward computation.
I0922 22:09:27.660711 18658 net.cpp:219] drop7 does not need backward computation.
I0922 22:09:27.660714 18658 net.cpp:219] relu7 does not need backward computation.
I0922 22:09:27.660718 18658 net.cpp:219] fc7 does not need backward computation.
I0922 22:09:27.660723 18658 net.cpp:219] drop6 does not need backward computation.
I0922 22:09:27.660728 18658 net.cpp:219] relu6 does not need backward computation.
I0922 22:09:27.660732 18658 net.cpp:219] fc6 does not need backward computation.
I0922 22:09:27.660737 18658 net.cpp:219] pool5 does not need backward computation.
I0922 22:09:27.660742 18658 net.cpp:219] relu5 does not need backward computation.
I0922 22:09:27.660748 18658 net.cpp:219] conv5 does not need backward computation.
I0922 22:09:27.660753 18658 net.cpp:219] relu4 does not need backward computation.
I0922 22:09:27.660756 18658 net.cpp:219] conv4 does not need backward computation.
I0922 22:09:27.660761 18658 net.cpp:219] relu3 does not need backward computation.
I0922 22:09:27.660766 18658 net.cpp:219] conv3 does not need backward computation.
I0922 22:09:27.660771 18658 net.cpp:219] norm2 does not need backward computation.
I0922 22:09:27.660776 18658 net.cpp:219] pool2 does not need backward computation.
I0922 22:09:27.660781 18658 net.cpp:219] relu2 does not need backward computation.
I0922 22:09:27.660785 18658 net.cpp:219] conv2 does not need backward computation.
I0922 22:09:27.660790 18658 net.cpp:219] norm1 does not need backward computation.
I0922 22:09:27.660795 18658 net.cpp:219] pool1 does not need backward computation.
I0922 22:09:27.660800 18658 net.cpp:219] relu1 does not need backward computation.
I0922 22:09:27.660804 18658 net.cpp:219] conv1 does not need backward computation.
I0922 22:09:27.660809 18658 net.cpp:219] data does not need backward computation.
I0922 22:09:27.660814 18658 net.cpp:261] This network produces output prob
I0922 22:09:27.660832 18658 net.cpp:274] Network initialization done.
I0922 22:09:27.681870 18652 net.cpp:141] Setting up lstm2_transform_1
I0922 22:09:27.681916 18652 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 22:09:27.681923 18652 net.cpp:156] Memory required for data: 66020
I0922 22:09:27.681944 18652 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0922 22:09:27.681967 18652 net.cpp:91] Creating Layer lstm2_gate_input_1
I0922 22:09:27.681974 18652 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0922 22:09:27.681982 18652 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0922 22:09:27.681993 18652 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0922 22:09:27.682046 18652 net.cpp:141] Setting up lstm2_gate_input_1
I0922 22:09:27.682059 18652 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 22:09:27.682063 18652 net.cpp:156] Memory required for data: 82020
I0922 22:09:27.682067 18652 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0922 22:09:27.682077 18652 net.cpp:91] Creating Layer lstm2_unit_1
I0922 22:09:27.682081 18652 net.cpp:425] lstm2_unit_1 <- c_0
I0922 22:09:27.682087 18652 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0922 22:09:27.682093 18652 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0922 22:09:27.682101 18652 net.cpp:399] lstm2_unit_1 -> c_1
I0922 22:09:27.682109 18652 net.cpp:399] lstm2_unit_1 -> h_1
I0922 22:09:27.682174 18652 net.cpp:141] Setting up lstm2_unit_1
I0922 22:09:27.682183 18652 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:09:27.682189 18652 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:09:27.682194 18652 net.cpp:156] Memory required for data: 90020
I0922 22:09:27.682199 18652 layer_factory.hpp:77] Creating layer lstm2_
I0922 22:09:27.682207 18652 net.cpp:91] Creating Layer lstm2_
I0922 22:09:27.682212 18652 net.cpp:425] lstm2_ <- c_1
I0922 22:09:27.682220 18652 net.cpp:399] lstm2_ -> c_T
I0922 22:09:27.682250 18652 net.cpp:141] Setting up lstm2_
I0922 22:09:27.682260 18652 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:09:27.682263 18652 net.cpp:156] Memory required for data: 94020
I0922 22:09:27.682268 18652 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0922 22:09:27.682281 18652 net.cpp:91] Creating Layer lstm2_h_concat
I0922 22:09:27.682286 18652 net.cpp:425] lstm2_h_concat <- h_1
I0922 22:09:27.682296 18652 net.cpp:399] lstm2_h_concat -> h
I0922 22:09:27.682332 18652 net.cpp:141] Setting up lstm2_h_concat
I0922 22:09:27.682340 18652 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:09:27.682344 18652 net.cpp:156] Memory required for data: 98020
I0922 22:09:27.682349 18652 layer_factory.hpp:77] Creating layer h_pseudoloss
I0922 22:09:27.682358 18652 net.cpp:91] Creating Layer h_pseudoloss
I0922 22:09:27.682363 18652 net.cpp:425] h_pseudoloss <- h
I0922 22:09:27.682373 18652 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0922 22:09:27.682466 18652 net.cpp:141] Setting up h_pseudoloss
I0922 22:09:27.682476 18652 net.cpp:148] Top shape: (1)
I0922 22:09:27.682481 18652 net.cpp:151]     with loss weight 1
I0922 22:09:27.682498 18652 net.cpp:156] Memory required for data: 98024
I0922 22:09:27.682503 18652 net.cpp:217] h_pseudoloss needs backward computation.
I0922 22:09:27.682508 18652 net.cpp:217] lstm2_h_concat needs backward computation.
I0922 22:09:27.682513 18652 net.cpp:219] lstm2_ does not need backward computation.
I0922 22:09:27.682518 18652 net.cpp:217] lstm2_unit_1 needs backward computation.
I0922 22:09:27.682524 18652 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0922 22:09:27.682529 18652 net.cpp:217] lstm2_transform_1 needs backward computation.
I0922 22:09:27.682534 18652 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0922 22:09:27.682540 18652 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0922 22:09:27.682545 18652 net.cpp:217] lstm2_x_transform needs backward computation.
I0922 22:09:27.682550 18652 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0922 22:09:27.682555 18652 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0922 22:09:27.682561 18652 net.cpp:219] lstm2_ does not need backward computation.
I0922 22:09:27.682565 18652 net.cpp:219] lstm2_ does not need backward computation.
I0922 22:09:27.682569 18652 net.cpp:261] This network produces output c_T
I0922 22:09:27.682574 18652 net.cpp:261] This network produces output h_pseudoloss
I0922 22:09:27.682591 18652 net.cpp:274] Network initialization done.
I0922 22:09:27.682643 18652 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0922 22:09:27.682649 18652 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0922 22:09:27.682654 18652 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0922 22:09:27.682760 18652 net.cpp:141] Setting up lstm2
I0922 22:09:27.682772 18652 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 22:09:27.682777 18652 net.cpp:156] Memory required for data: 36412
I0922 22:09:27.682790 18652 layer_factory.hpp:77] Creating layer predict
I0922 22:09:27.682804 18652 net.cpp:91] Creating Layer predict
I0922 22:09:27.682811 18652 net.cpp:425] predict <- lstm2
I0922 22:09:27.682818 18652 net.cpp:399] predict -> predict
I0922 22:09:27.895612 18658 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /home/peifeng/work/run/storm102/data/workers/5531f05f-53e3-467a-b9fa-a782857106e9/tmp/cvld364400699545464231/bvlc_reference_caffenet.caffemodel
I0922 22:09:27.895653 18658 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0922 22:09:27.895658 18658 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0922 22:09:27.895663 18658 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /home/peifeng/work/run/storm102/data/workers/5531f05f-53e3-467a-b9fa-a782857106e9/tmp/cvld364400699545464231/bvlc_reference_caffenet.caffemodel
I0922 22:09:28.009654 18648 net.cpp:141] Setting up predict
I0922 22:09:28.009701 18648 net.cpp:148] Top shape: 1 1 46168 (46168)
I0922 22:09:28.009707 18648 net.cpp:156] Memory required for data: 221084
I0922 22:09:28.009723 18648 layer_factory.hpp:77] Creating layer probs
I0922 22:09:28.009742 18648 net.cpp:91] Creating Layer probs
I0922 22:09:28.009752 18648 net.cpp:425] probs <- predict
I0922 22:09:28.009762 18648 net.cpp:399] probs -> probs
I0922 22:09:28.010840 18648 net.cpp:141] Setting up probs
I0922 22:09:28.010859 18648 net.cpp:148] Top shape: 1 1 46168 (46168)
I0922 22:09:28.010864 18648 net.cpp:156] Memory required for data: 405756
I0922 22:09:28.010870 18648 net.cpp:219] probs does not need backward computation.
I0922 22:09:28.010876 18648 net.cpp:219] predict does not need backward computation.
I0922 22:09:28.010882 18648 net.cpp:219] lstm2 does not need backward computation.
I0922 22:09:28.010887 18648 net.cpp:219] concat does not need backward computation.
I0922 22:09:28.010895 18648 net.cpp:219] lstm1 does not need backward computation.
I0922 22:09:28.010900 18648 net.cpp:219] embedding does not need backward computation.
I0922 22:09:28.010905 18648 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0922 22:09:28.010911 18648 net.cpp:219] reshape_frames does not need backward computation.
I0922 22:09:28.010916 18648 net.cpp:219] embed_encoder does not need backward computation.
I0922 22:09:28.010921 18648 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0922 22:09:28.010927 18648 net.cpp:219] input does not need backward computation.
I0922 22:09:28.010931 18648 net.cpp:261] This network produces output probs
I0922 22:09:28.010948 18648 net.cpp:274] Network initialization done.
I0922 22:09:28.135599 18652 net.cpp:141] Setting up predict
I0922 22:09:28.135658 18652 net.cpp:148] Top shape: 1 1 46168 (46168)
I0922 22:09:28.135665 18652 net.cpp:156] Memory required for data: 221084
I0922 22:09:28.135681 18652 layer_factory.hpp:77] Creating layer probs
I0922 22:09:28.135700 18652 net.cpp:91] Creating Layer probs
I0922 22:09:28.135710 18652 net.cpp:425] probs <- predict
I0922 22:09:28.135721 18652 net.cpp:399] probs -> probs
I0922 22:09:28.136270 18652 net.cpp:141] Setting up probs
I0922 22:09:28.136284 18652 net.cpp:148] Top shape: 1 1 46168 (46168)
I0922 22:09:28.136289 18652 net.cpp:156] Memory required for data: 405756
I0922 22:09:28.136296 18652 net.cpp:219] probs does not need backward computation.
I0922 22:09:28.136301 18652 net.cpp:219] predict does not need backward computation.
I0922 22:09:28.136307 18652 net.cpp:219] lstm2 does not need backward computation.
I0922 22:09:28.136314 18652 net.cpp:219] concat does not need backward computation.
I0922 22:09:28.136322 18652 net.cpp:219] lstm1 does not need backward computation.
I0922 22:09:28.136328 18652 net.cpp:219] embedding does not need backward computation.
I0922 22:09:28.136334 18652 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0922 22:09:28.136342 18652 net.cpp:219] reshape_frames does not need backward computation.
I0922 22:09:28.136346 18652 net.cpp:219] embed_encoder does not need backward computation.
I0922 22:09:28.136353 18652 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0922 22:09:28.136359 18652 net.cpp:219] input does not need backward computation.
I0922 22:09:28.136363 18652 net.cpp:261] This network produces output probs
I0922 22:09:28.136384 18652 net.cpp:274] Network initialization done.
I0922 22:09:28.262871 18658 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0922 22:09:28.314626 18658 net.cpp:752] Ignoring source layer loss
Loading the model + trained: 10185.3ms
Using cv::Size and some other stuff: 0.297ms
I0922 22:09:28.330940 18648 net.cpp:752] Ignoring source layer data
I0922 22:09:28.330974 18648 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0922 22:09:28.330979 18648 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0922 22:09:28.404405 18648 net.cpp:752] Ignoring source layer cross_entropy_loss
I0922 22:09:28.485420 18652 net.cpp:752] Ignoring source layer data
I0922 22:09:28.485461 18652 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0922 22:09:28.485468 18652 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0922 22:09:28.574146 18652 net.cpp:752] Ignoring source layer cross_entropy_loss
Loading the mean file: 20009.1ms
TIMERTIMER 304183563
TIMERTIMER 247251637
TIMERTIMER 256983576
TIMERTIMER 240847518
TIMERTIMER 236454100
TIMERTIMER 237568236
TIMERTIMER 238025612
TIMERTIMER 237069161
TIMERTIMER 240022248
TIMERTIMER 242654930
TIMERTIMER 236669666
TIMERTIMER 230040759
TIMERTIMER 218832332
TIMERTIMER 227158975
TIMERTIMER 231554917
TIMERTIMER 230330626
TIMERTIMER 212120952
TIMERTIMER 244847102
TIMERTIMER 232908002
TIMERTIMER 245437107
TIMERTIMER 244003916
TIMERTIMER 240569131
TIMERTIMER 245459413
TIMERTIMER 231329962
TIMERTIMER 214793006
TIMERTIMER 220950187
TIMERTIMER 224572927
TIMERTIMER 239135625
TIMERTIMER 230562504
TIMERTIMER 246498401
TIMERTIMER 212140548
TIMERTIMER 219889513
TIMERTIMER 219451345
TIMERTIMER 224983182
TIMERTIMER 224224030
TIMERTIMER 223774643
TIMERTIMER 222874034
TIMERTIMER 216742124
TIMERTIMER 207255059
TIMERTIMER 228830528
TIMERTIMER 218308592
TIMERTIMER 216513406
TIMERTIMER 216979040
TIMERTIMER 206838768
TIMERTIMER 223547269
TIMERTIMER 214186698
TIMERTIMER 222912190
TIMERTIMER 223927218
TIMERTIMER 207527604
TIMERTIMER 233090764
TIMERTIMER 211531630
TIMERTIMER 233791706
TIMERTIMER 236657103
TIMERTIMER 210384066
TIMERTIMER 209398081
TIMERTIMER 217924757
TIMERTIMER 230487145
TIMERTIMER 218230143
TIMERTIMER 211204035
TIMERTIMER 223810049
TIMERTIMER 218000103
TIMERTIMER 223339671
TIMERTIMER 224538483
TIMERTIMER 219026401
TIMERTIMER 210600253
TIMERTIMER 214053819
TIMERTIMER 228879367
