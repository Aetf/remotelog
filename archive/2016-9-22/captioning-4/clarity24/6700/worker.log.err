SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/peifeng/tools/storm102/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/peifeng/work/run/storm102/data/supervisor/stormdist/captioning-1-1474580967/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /home/peifeng/work/run/storm102/data/workers/5ce2ba85-335f-45ef-bf9c-1cd4226a2fa5/tmp/cvld6203887133916814714/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0922 17:50:10.992280 17687 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/5ce2ba85-335f-45ef-bf9c-1cd4226a2fa5/tmp/cvld6203887133916814714/s2vt.words_to_preds.prototxt
I0922 17:50:10.992422 17687 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0922 17:50:10.992437 17687 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0922 17:50:10.992936 17687 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0922 17:50:10.993106 17687 layer_factory.hpp:77] Creating layer input
I0922 17:50:10.993137 17687 net.cpp:91] Creating Layer input
I0922 17:50:10.993149 17687 net.cpp:399] input -> frames_fc7
I0922 17:50:10.993194 17687 net.cpp:399] input -> cont_sentence
I0922 17:50:10.993208 17687 net.cpp:399] input -> input_sentence
I0922 17:50:10.993219 17687 net.cpp:399] input -> stage_indicator
I0922 17:50:11.559778 17687 net.cpp:141] Setting up input
I0922 17:50:11.559895 17687 net.cpp:148] Top shape: 1 4096 (4096)
I0922 17:50:11.559905 17687 net.cpp:148] Top shape: 1 1 (1)
I0922 17:50:11.559911 17687 net.cpp:148] Top shape: 1 1 (1)
I0922 17:50:11.559918 17687 net.cpp:148] Top shape: 1 1 (1)
I0922 17:50:11.559923 17687 net.cpp:156] Memory required for data: 16396
I0922 17:50:11.559949 17687 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0922 17:50:11.559983 17687 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0922 17:50:11.559994 17687 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0922 17:50:11.560019 17687 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0922 17:50:11.560037 17687 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0922 17:50:11.560091 17687 net.cpp:141] Setting up cont_sentence_input_1_split
I0922 17:50:11.560101 17687 net.cpp:148] Top shape: 1 1 (1)
I0922 17:50:11.560107 17687 net.cpp:148] Top shape: 1 1 (1)
I0922 17:50:11.560112 17687 net.cpp:156] Memory required for data: 16404
I0922 17:50:11.560118 17687 layer_factory.hpp:77] Creating layer embed_encoder
I0922 17:50:11.560138 17687 net.cpp:91] Creating Layer embed_encoder
I0922 17:50:11.560143 17687 net.cpp:425] embed_encoder <- frames_fc7
I0922 17:50:11.560153 17687 net.cpp:399] embed_encoder -> embedded_in_frames
I0922 17:50:11.582753 17687 net.cpp:141] Setting up embed_encoder
I0922 17:50:11.582778 17687 net.cpp:148] Top shape: 1 500 (500)
I0922 17:50:11.582784 17687 net.cpp:156] Memory required for data: 18404
I0922 17:50:11.582808 17687 layer_factory.hpp:77] Creating layer reshape_frames
I0922 17:50:11.582833 17687 net.cpp:91] Creating Layer reshape_frames
I0922 17:50:11.582839 17687 net.cpp:425] reshape_frames <- embedded_in_frames
I0922 17:50:11.582854 17687 net.cpp:399] reshape_frames -> embedded_input_frames
I0922 17:50:11.582902 17687 net.cpp:141] Setting up reshape_frames
I0922 17:50:11.582914 17687 net.cpp:148] Top shape: 1 1 500 (500)
I0922 17:50:11.582919 17687 net.cpp:156] Memory required for data: 20404
I0922 17:50:11.582924 17687 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0922 17:50:11.582936 17687 net.cpp:91] Creating Layer reshape_stage_indicator
I0922 17:50:11.582942 17687 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0922 17:50:11.582948 17687 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0922 17:50:11.582983 17687 net.cpp:141] Setting up reshape_stage_indicator
I0922 17:50:11.582993 17687 net.cpp:148] Top shape: 1 1 1 (1)
I0922 17:50:11.582998 17687 net.cpp:156] Memory required for data: 20408
I0922 17:50:11.583003 17687 layer_factory.hpp:77] Creating layer embedding
I0922 17:50:11.583024 17687 net.cpp:91] Creating Layer embedding
I0922 17:50:11.583031 17687 net.cpp:425] embedding <- input_sentence
I0922 17:50:11.583040 17687 net.cpp:399] embedding -> embedded_input_sentence
I0922 17:50:11.813518 17691 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/5ce2ba85-335f-45ef-bf9c-1cd4226a2fa5/tmp/cvld6203887133916814714/s2vt.words_to_preds.prototxt
I0922 17:50:11.813573 17691 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0922 17:50:11.813583 17691 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0922 17:50:11.814013 17691 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0922 17:50:11.814048 17697 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0922 17:50:11.814188 17691 layer_factory.hpp:77] Creating layer input
I0922 17:50:11.814198 17697 layer_factory.hpp:77] Creating layer data
I0922 17:50:11.814214 17697 net.cpp:91] Creating Layer data
I0922 17:50:11.814214 17691 net.cpp:91] Creating Layer input
I0922 17:50:11.814235 17697 net.cpp:399] data -> data
I0922 17:50:11.814242 17691 net.cpp:399] input -> frames_fc7
I0922 17:50:11.814265 17691 net.cpp:399] input -> cont_sentence
I0922 17:50:11.814282 17691 net.cpp:399] input -> input_sentence
I0922 17:50:11.814301 17691 net.cpp:399] input -> stage_indicator
I0922 17:50:11.814359 17697 net.cpp:141] Setting up data
I0922 17:50:11.814380 17697 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0922 17:50:11.814389 17697 net.cpp:156] Memory required for data: 6183480
I0922 17:50:11.814400 17697 layer_factory.hpp:77] Creating layer conv1
I0922 17:50:11.814432 17697 net.cpp:91] Creating Layer conv1
I0922 17:50:11.814443 17697 net.cpp:425] conv1 <- data
I0922 17:50:11.814461 17697 net.cpp:399] conv1 -> conv1
I0922 17:50:11.814471 17691 net.cpp:141] Setting up input
I0922 17:50:11.814486 17691 net.cpp:148] Top shape: 1 4096 (4096)
I0922 17:50:11.814502 17691 net.cpp:148] Top shape: 1 1 (1)
I0922 17:50:11.814514 17691 net.cpp:148] Top shape: 1 1 (1)
I0922 17:50:11.814527 17691 net.cpp:148] Top shape: 1 1 (1)
I0922 17:50:11.814535 17691 net.cpp:156] Memory required for data: 16396
I0922 17:50:11.814546 17691 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0922 17:50:11.814563 17691 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0922 17:50:11.814573 17691 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0922 17:50:11.814586 17691 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0922 17:50:11.814606 17691 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0922 17:50:11.814728 17691 net.cpp:141] Setting up cont_sentence_input_1_split
I0922 17:50:11.814748 17691 net.cpp:148] Top shape: 1 1 (1)
I0922 17:50:11.814759 17691 net.cpp:148] Top shape: 1 1 (1)
I0922 17:50:11.814769 17691 net.cpp:156] Memory required for data: 16404
I0922 17:50:11.814777 17691 layer_factory.hpp:77] Creating layer embed_encoder
I0922 17:50:11.814800 17691 net.cpp:91] Creating Layer embed_encoder
I0922 17:50:11.814812 17691 net.cpp:425] embed_encoder <- frames_fc7
I0922 17:50:11.814831 17691 net.cpp:399] embed_encoder -> embedded_in_frames
I0922 17:50:11.830186 17687 net.cpp:141] Setting up embedding
I0922 17:50:11.830227 17687 net.cpp:148] Top shape: 1 1 500 (500)
I0922 17:50:11.830234 17687 net.cpp:156] Memory required for data: 22408
I0922 17:50:11.830252 17687 layer_factory.hpp:77] Creating layer lstm1
I0922 17:50:11.830284 17687 net.cpp:91] Creating Layer lstm1
I0922 17:50:11.830293 17687 net.cpp:425] lstm1 <- embedded_input_frames
I0922 17:50:11.830302 17687 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0922 17:50:11.830312 17687 net.cpp:399] lstm1 -> lstm1
I0922 17:50:11.830338 17687 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0922 17:50:11.830755 17687 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0922 17:50:11.830864 17687 layer_factory.hpp:77] Creating layer lstm1_
I0922 17:50:11.830878 17687 net.cpp:91] Creating Layer lstm1_
I0922 17:50:11.830885 17687 net.cpp:399] lstm1_ -> x
I0922 17:50:11.830899 17687 net.cpp:399] lstm1_ -> cont
I0922 17:50:11.834558 17687 net.cpp:141] Setting up lstm1_
I0922 17:50:11.834573 17687 net.cpp:148] Top shape: 1 1 500 (500)
I0922 17:50:11.834580 17687 net.cpp:148] Top shape: 1 1 (1)
I0922 17:50:11.834585 17687 net.cpp:156] Memory required for data: 2004
I0922 17:50:11.834590 17687 layer_factory.hpp:77] Creating layer lstm1_
I0922 17:50:11.834600 17687 net.cpp:91] Creating Layer lstm1_
I0922 17:50:11.834606 17687 net.cpp:399] lstm1_ -> c_0
I0922 17:50:11.834625 17687 net.cpp:399] lstm1_ -> h_0
I0922 17:50:11.837296 17687 net.cpp:141] Setting up lstm1_
I0922 17:50:11.837316 17687 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 17:50:11.837322 17687 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 17:50:11.837327 17687 net.cpp:156] Memory required for data: 10004
I0922 17:50:11.837332 17687 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0922 17:50:11.837344 17687 net.cpp:91] Creating Layer lstm1_cont_slice
I0922 17:50:11.837349 17687 net.cpp:425] lstm1_cont_slice <- cont
I0922 17:50:11.837366 17687 net.cpp:399] lstm1_cont_slice -> cont_1
I0922 17:50:11.840247 17687 net.cpp:141] Setting up lstm1_cont_slice
I0922 17:50:11.840267 17687 net.cpp:148] Top shape: 1 1 (1)
I0922 17:50:11.840272 17687 net.cpp:156] Memory required for data: 10008
I0922 17:50:11.840278 17687 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0922 17:50:11.840288 17687 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0922 17:50:11.840293 17687 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0922 17:50:11.840313 17687 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0922 17:50:11.840328 17687 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0922 17:50:11.843768 17687 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0922 17:50:11.843788 17687 net.cpp:148] Top shape: 1 1 (1)
I0922 17:50:11.843796 17687 net.cpp:148] Top shape: 1 1 (1)
I0922 17:50:11.843801 17687 net.cpp:156] Memory required for data: 10016
I0922 17:50:11.843806 17687 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0922 17:50:11.843827 17687 net.cpp:91] Creating Layer lstm1_x_transform
I0922 17:50:11.843833 17687 net.cpp:425] lstm1_x_transform <- x
I0922 17:50:11.843843 17687 net.cpp:399] lstm1_x_transform -> W_xc_x
I0922 17:50:11.855289 17691 net.cpp:141] Setting up embed_encoder
I0922 17:50:11.855346 17691 net.cpp:148] Top shape: 1 500 (500)
I0922 17:50:11.855358 17691 net.cpp:156] Memory required for data: 18404
I0922 17:50:11.855396 17691 layer_factory.hpp:77] Creating layer reshape_frames
I0922 17:50:11.855428 17691 net.cpp:91] Creating Layer reshape_frames
I0922 17:50:11.855443 17691 net.cpp:425] reshape_frames <- embedded_in_frames
I0922 17:50:11.855463 17691 net.cpp:399] reshape_frames -> embedded_input_frames
I0922 17:50:11.855546 17691 net.cpp:141] Setting up reshape_frames
I0922 17:50:11.855564 17691 net.cpp:148] Top shape: 1 1 500 (500)
I0922 17:50:11.855573 17691 net.cpp:156] Memory required for data: 20404
I0922 17:50:11.855583 17691 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0922 17:50:11.855602 17691 net.cpp:91] Creating Layer reshape_stage_indicator
I0922 17:50:11.855612 17691 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0922 17:50:11.855628 17691 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0922 17:50:11.855845 17691 net.cpp:141] Setting up reshape_stage_indicator
I0922 17:50:11.855865 17691 net.cpp:148] Top shape: 1 1 1 (1)
I0922 17:50:11.855875 17691 net.cpp:156] Memory required for data: 20408
I0922 17:50:11.855885 17691 layer_factory.hpp:77] Creating layer embedding
I0922 17:50:11.855906 17691 net.cpp:91] Creating Layer embedding
I0922 17:50:11.855916 17691 net.cpp:425] embedding <- input_sentence
I0922 17:50:11.855932 17691 net.cpp:399] embedding -> embedded_input_sentence
I0922 17:50:11.907047 17687 net.cpp:141] Setting up lstm1_x_transform
I0922 17:50:11.907094 17687 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 17:50:11.907099 17687 net.cpp:156] Memory required for data: 26016
I0922 17:50:11.907124 17687 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0922 17:50:11.907143 17687 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0922 17:50:11.907150 17687 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0922 17:50:11.907160 17687 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0922 17:50:11.910581 17687 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0922 17:50:11.910629 17687 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 17:50:11.910635 17687 net.cpp:156] Memory required for data: 42016
I0922 17:50:11.910645 17687 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0922 17:50:11.910676 17687 net.cpp:91] Creating Layer lstm1_h_conted_0
I0922 17:50:11.910683 17687 net.cpp:425] lstm1_h_conted_0 <- h_0
I0922 17:50:11.910693 17687 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0922 17:50:11.910702 17687 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0922 17:50:11.913130 17687 net.cpp:141] Setting up lstm1_h_conted_0
I0922 17:50:11.913184 17687 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 17:50:11.913192 17687 net.cpp:156] Memory required for data: 46016
I0922 17:50:11.913202 17687 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0922 17:50:11.913226 17687 net.cpp:91] Creating Layer lstm1_transform_1
I0922 17:50:11.913234 17687 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0922 17:50:11.913247 17687 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0922 17:50:11.968741 17687 net.cpp:141] Setting up lstm1_transform_1
I0922 17:50:11.968794 17687 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 17:50:11.968801 17687 net.cpp:156] Memory required for data: 62016
I0922 17:50:11.968823 17687 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0922 17:50:11.968847 17687 net.cpp:91] Creating Layer lstm1_gate_input_1
I0922 17:50:11.968853 17687 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0922 17:50:11.968861 17687 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0922 17:50:11.968870 17687 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0922 17:50:11.973431 17687 net.cpp:141] Setting up lstm1_gate_input_1
I0922 17:50:11.973461 17687 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 17:50:11.973467 17687 net.cpp:156] Memory required for data: 78016
I0922 17:50:11.973474 17687 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0922 17:50:11.973493 17687 net.cpp:91] Creating Layer lstm1_unit_1
I0922 17:50:11.973500 17687 net.cpp:425] lstm1_unit_1 <- c_0
I0922 17:50:11.973506 17687 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0922 17:50:11.973512 17687 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0922 17:50:11.973520 17687 net.cpp:399] lstm1_unit_1 -> c_1
I0922 17:50:11.973529 17687 net.cpp:399] lstm1_unit_1 -> h_1
I0922 17:50:11.973778 17687 net.cpp:141] Setting up lstm1_unit_1
I0922 17:50:11.973794 17687 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 17:50:11.973801 17687 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 17:50:11.973806 17687 net.cpp:156] Memory required for data: 86016
I0922 17:50:11.973811 17687 layer_factory.hpp:77] Creating layer lstm1_
I0922 17:50:11.973820 17687 net.cpp:91] Creating Layer lstm1_
I0922 17:50:11.973825 17687 net.cpp:425] lstm1_ <- c_1
I0922 17:50:11.973832 17687 net.cpp:399] lstm1_ -> c_T
I0922 17:50:11.974092 17687 net.cpp:141] Setting up lstm1_
I0922 17:50:11.974102 17687 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 17:50:11.974107 17687 net.cpp:156] Memory required for data: 90016
I0922 17:50:11.974112 17687 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0922 17:50:11.974130 17687 net.cpp:91] Creating Layer lstm1_h_concat
I0922 17:50:11.974135 17687 net.cpp:425] lstm1_h_concat <- h_1
I0922 17:50:11.974143 17687 net.cpp:399] lstm1_h_concat -> h
I0922 17:50:11.976516 17687 net.cpp:141] Setting up lstm1_h_concat
I0922 17:50:11.976537 17687 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 17:50:11.976543 17687 net.cpp:156] Memory required for data: 94016
I0922 17:50:11.976549 17687 layer_factory.hpp:77] Creating layer h_pseudoloss
I0922 17:50:11.976570 17687 net.cpp:91] Creating Layer h_pseudoloss
I0922 17:50:11.976580 17687 net.cpp:425] h_pseudoloss <- h
I0922 17:50:11.976603 17687 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0922 17:50:11.981431 17687 net.cpp:141] Setting up h_pseudoloss
I0922 17:50:11.981457 17687 net.cpp:148] Top shape: (1)
I0922 17:50:11.981463 17687 net.cpp:151]     with loss weight 1
I0922 17:50:11.981498 17687 net.cpp:156] Memory required for data: 94020
I0922 17:50:11.981504 17687 net.cpp:217] h_pseudoloss needs backward computation.
I0922 17:50:11.981510 17687 net.cpp:217] lstm1_h_concat needs backward computation.
I0922 17:50:11.981515 17687 net.cpp:219] lstm1_ does not need backward computation.
I0922 17:50:11.981520 17687 net.cpp:217] lstm1_unit_1 needs backward computation.
I0922 17:50:11.981526 17687 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0922 17:50:11.981533 17687 net.cpp:217] lstm1_transform_1 needs backward computation.
I0922 17:50:11.981537 17687 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0922 17:50:11.981544 17687 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0922 17:50:11.981549 17687 net.cpp:217] lstm1_x_transform needs backward computation.
I0922 17:50:11.981554 17687 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0922 17:50:11.981559 17687 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0922 17:50:11.981565 17687 net.cpp:219] lstm1_ does not need backward computation.
I0922 17:50:11.981570 17687 net.cpp:219] lstm1_ does not need backward computation.
I0922 17:50:11.981573 17687 net.cpp:261] This network produces output c_T
I0922 17:50:11.981580 17687 net.cpp:261] This network produces output h_pseudoloss
I0922 17:50:11.981602 17687 net.cpp:274] Network initialization done.
I0922 17:50:11.981676 17687 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0922 17:50:11.981683 17687 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0922 17:50:11.981688 17687 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0922 17:50:11.984741 17687 net.cpp:141] Setting up lstm1
I0922 17:50:11.984763 17687 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 17:50:11.984769 17687 net.cpp:156] Memory required for data: 26408
I0922 17:50:11.984786 17687 layer_factory.hpp:77] Creating layer concat
I0922 17:50:11.984800 17687 net.cpp:91] Creating Layer concat
I0922 17:50:11.984807 17687 net.cpp:425] concat <- lstm1
I0922 17:50:11.984814 17687 net.cpp:425] concat <- embedded_input_sentence
I0922 17:50:11.984820 17687 net.cpp:425] concat <- reshaped_stage_indicator
I0922 17:50:11.984827 17687 net.cpp:399] concat -> lstm1_video_sequence
I0922 17:50:11.987306 17687 net.cpp:141] Setting up concat
I0922 17:50:11.987329 17687 net.cpp:148] Top shape: 1 1 1501 (1501)
I0922 17:50:11.987334 17687 net.cpp:156] Memory required for data: 32412
I0922 17:50:11.987339 17687 layer_factory.hpp:77] Creating layer lstm2
I0922 17:50:11.987356 17687 net.cpp:91] Creating Layer lstm2
I0922 17:50:11.987362 17687 net.cpp:425] lstm2 <- lstm1_video_sequence
I0922 17:50:11.987370 17687 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0922 17:50:11.987378 17687 net.cpp:399] lstm2 -> lstm2
I0922 17:50:11.987391 17687 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0922 17:50:11.987699 17687 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0922 17:50:11.987809 17687 layer_factory.hpp:77] Creating layer lstm2_
I0922 17:50:11.987823 17687 net.cpp:91] Creating Layer lstm2_
I0922 17:50:11.987830 17687 net.cpp:399] lstm2_ -> x
I0922 17:50:11.987841 17687 net.cpp:399] lstm2_ -> cont
I0922 17:50:11.991402 17687 net.cpp:141] Setting up lstm2_
I0922 17:50:11.991422 17687 net.cpp:148] Top shape: 1 1 1501 (1501)
I0922 17:50:11.991430 17687 net.cpp:148] Top shape: 1 1 (1)
I0922 17:50:11.991435 17687 net.cpp:156] Memory required for data: 6008
I0922 17:50:11.991439 17687 layer_factory.hpp:77] Creating layer lstm2_
I0922 17:50:11.991451 17687 net.cpp:91] Creating Layer lstm2_
I0922 17:50:11.991458 17687 net.cpp:399] lstm2_ -> c_0
I0922 17:50:11.991471 17687 net.cpp:399] lstm2_ -> h_0
I0922 17:50:11.991564 17687 net.cpp:141] Setting up lstm2_
I0922 17:50:11.991583 17687 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 17:50:11.991590 17687 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 17:50:11.991595 17687 net.cpp:156] Memory required for data: 14008
I0922 17:50:11.991600 17687 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0922 17:50:11.991610 17687 net.cpp:91] Creating Layer lstm2_cont_slice
I0922 17:50:11.991616 17687 net.cpp:425] lstm2_cont_slice <- cont
I0922 17:50:11.991627 17687 net.cpp:399] lstm2_cont_slice -> cont_1
I0922 17:50:11.992410 17687 net.cpp:141] Setting up lstm2_cont_slice
I0922 17:50:11.992430 17687 net.cpp:148] Top shape: 1 1 (1)
I0922 17:50:11.992435 17687 net.cpp:156] Memory required for data: 14012
I0922 17:50:11.992441 17687 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0922 17:50:11.992450 17687 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0922 17:50:11.992456 17687 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0922 17:50:11.992465 17687 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0922 17:50:11.992475 17687 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0922 17:50:11.996656 17687 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0922 17:50:11.996708 17687 net.cpp:148] Top shape: 1 1 (1)
I0922 17:50:11.996721 17687 net.cpp:148] Top shape: 1 1 (1)
I0922 17:50:11.996729 17687 net.cpp:156] Memory required for data: 14020
I0922 17:50:11.996743 17687 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0922 17:50:11.996788 17687 net.cpp:91] Creating Layer lstm2_x_transform
I0922 17:50:11.996800 17687 net.cpp:425] lstm2_x_transform <- x
I0922 17:50:11.996820 17687 net.cpp:399] lstm2_x_transform -> W_xc_x
I0922 17:50:12.080030 17687 net.cpp:141] Setting up lstm2_x_transform
I0922 17:50:12.080081 17687 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 17:50:12.080088 17687 net.cpp:156] Memory required for data: 30020
I0922 17:50:12.080114 17687 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0922 17:50:12.080133 17687 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0922 17:50:12.080140 17687 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0922 17:50:12.080155 17687 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0922 17:50:12.086567 17687 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0922 17:50:12.086606 17687 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 17:50:12.086611 17687 net.cpp:156] Memory required for data: 46020
I0922 17:50:12.086621 17687 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0922 17:50:12.086640 17687 net.cpp:91] Creating Layer lstm2_h_conted_0
I0922 17:50:12.086647 17687 net.cpp:425] lstm2_h_conted_0 <- h_0
I0922 17:50:12.086658 17687 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0922 17:50:12.086678 17687 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0922 17:50:12.091475 17687 net.cpp:141] Setting up lstm2_h_conted_0
I0922 17:50:12.091498 17687 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 17:50:12.091505 17687 net.cpp:156] Memory required for data: 50020
I0922 17:50:12.091511 17687 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0922 17:50:12.091533 17687 net.cpp:91] Creating Layer lstm2_transform_1
I0922 17:50:12.091542 17687 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0922 17:50:12.091554 17687 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0922 17:50:12.114285 17691 net.cpp:141] Setting up embedding
I0922 17:50:12.114337 17691 net.cpp:148] Top shape: 1 1 500 (500)
I0922 17:50:12.114344 17691 net.cpp:156] Memory required for data: 22408
I0922 17:50:12.114364 17691 layer_factory.hpp:77] Creating layer lstm1
I0922 17:50:12.114392 17691 net.cpp:91] Creating Layer lstm1
I0922 17:50:12.114399 17691 net.cpp:425] lstm1 <- embedded_input_frames
I0922 17:50:12.114408 17691 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0922 17:50:12.114418 17691 net.cpp:399] lstm1 -> lstm1
I0922 17:50:12.114439 17691 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0922 17:50:12.114760 17691 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0922 17:50:12.114866 17691 layer_factory.hpp:77] Creating layer lstm1_
I0922 17:50:12.114881 17691 net.cpp:91] Creating Layer lstm1_
I0922 17:50:12.114886 17691 net.cpp:399] lstm1_ -> x
I0922 17:50:12.114899 17691 net.cpp:399] lstm1_ -> cont
I0922 17:50:12.118036 17691 net.cpp:141] Setting up lstm1_
I0922 17:50:12.118075 17691 net.cpp:148] Top shape: 1 1 500 (500)
I0922 17:50:12.118083 17691 net.cpp:148] Top shape: 1 1 (1)
I0922 17:50:12.118088 17691 net.cpp:156] Memory required for data: 2004
I0922 17:50:12.118098 17691 layer_factory.hpp:77] Creating layer lstm1_
I0922 17:50:12.118129 17691 net.cpp:91] Creating Layer lstm1_
I0922 17:50:12.118139 17691 net.cpp:399] lstm1_ -> c_0
I0922 17:50:12.118160 17691 net.cpp:399] lstm1_ -> h_0
I0922 17:50:12.126170 17691 net.cpp:141] Setting up lstm1_
I0922 17:50:12.126202 17691 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 17:50:12.126210 17691 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 17:50:12.126214 17691 net.cpp:156] Memory required for data: 10004
I0922 17:50:12.126221 17691 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0922 17:50:12.126246 17691 net.cpp:91] Creating Layer lstm1_cont_slice
I0922 17:50:12.126252 17691 net.cpp:425] lstm1_cont_slice <- cont
I0922 17:50:12.126266 17691 net.cpp:399] lstm1_cont_slice -> cont_1
I0922 17:50:12.126317 17691 net.cpp:141] Setting up lstm1_cont_slice
I0922 17:50:12.126327 17691 net.cpp:148] Top shape: 1 1 (1)
I0922 17:50:12.126332 17691 net.cpp:156] Memory required for data: 10008
I0922 17:50:12.126338 17691 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0922 17:50:12.126345 17691 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0922 17:50:12.126350 17691 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0922 17:50:12.126358 17691 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0922 17:50:12.126369 17691 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0922 17:50:12.126433 17691 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0922 17:50:12.126443 17691 net.cpp:148] Top shape: 1 1 (1)
I0922 17:50:12.126449 17691 net.cpp:148] Top shape: 1 1 (1)
I0922 17:50:12.126454 17691 net.cpp:156] Memory required for data: 10016
I0922 17:50:12.126459 17691 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0922 17:50:12.126479 17691 net.cpp:91] Creating Layer lstm1_x_transform
I0922 17:50:12.126484 17691 net.cpp:425] lstm1_x_transform <- x
I0922 17:50:12.126493 17691 net.cpp:399] lstm1_x_transform -> W_xc_x
I0922 17:50:12.136164 17687 net.cpp:141] Setting up lstm2_transform_1
I0922 17:50:12.136206 17687 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 17:50:12.136212 17687 net.cpp:156] Memory required for data: 66020
I0922 17:50:12.136235 17687 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0922 17:50:12.136262 17687 net.cpp:91] Creating Layer lstm2_gate_input_1
I0922 17:50:12.136270 17687 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0922 17:50:12.136278 17687 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0922 17:50:12.136287 17687 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0922 17:50:12.136359 17687 net.cpp:141] Setting up lstm2_gate_input_1
I0922 17:50:12.136371 17687 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 17:50:12.136376 17687 net.cpp:156] Memory required for data: 82020
I0922 17:50:12.136381 17687 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0922 17:50:12.136395 17687 net.cpp:91] Creating Layer lstm2_unit_1
I0922 17:50:12.136401 17687 net.cpp:425] lstm2_unit_1 <- c_0
I0922 17:50:12.136407 17687 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0922 17:50:12.136414 17687 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0922 17:50:12.136420 17687 net.cpp:399] lstm2_unit_1 -> c_1
I0922 17:50:12.136430 17687 net.cpp:399] lstm2_unit_1 -> h_1
I0922 17:50:12.139503 17687 net.cpp:141] Setting up lstm2_unit_1
I0922 17:50:12.139521 17687 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 17:50:12.139528 17687 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 17:50:12.139533 17687 net.cpp:156] Memory required for data: 90020
I0922 17:50:12.139539 17687 layer_factory.hpp:77] Creating layer lstm2_
I0922 17:50:12.139549 17687 net.cpp:91] Creating Layer lstm2_
I0922 17:50:12.139554 17687 net.cpp:425] lstm2_ <- c_1
I0922 17:50:12.139562 17687 net.cpp:399] lstm2_ -> c_T
I0922 17:50:12.143482 17687 net.cpp:141] Setting up lstm2_
I0922 17:50:12.143506 17687 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 17:50:12.143512 17687 net.cpp:156] Memory required for data: 94020
I0922 17:50:12.143517 17687 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0922 17:50:12.143528 17687 net.cpp:91] Creating Layer lstm2_h_concat
I0922 17:50:12.143537 17687 net.cpp:425] lstm2_h_concat <- h_1
I0922 17:50:12.143553 17687 net.cpp:399] lstm2_h_concat -> h
I0922 17:50:12.147191 17687 net.cpp:141] Setting up lstm2_h_concat
I0922 17:50:12.147215 17687 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 17:50:12.147220 17687 net.cpp:156] Memory required for data: 98020
I0922 17:50:12.147227 17687 layer_factory.hpp:77] Creating layer h_pseudoloss
I0922 17:50:12.147239 17687 net.cpp:91] Creating Layer h_pseudoloss
I0922 17:50:12.147245 17687 net.cpp:425] h_pseudoloss <- h
I0922 17:50:12.147253 17687 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0922 17:50:12.148284 17687 net.cpp:141] Setting up h_pseudoloss
I0922 17:50:12.148305 17687 net.cpp:148] Top shape: (1)
I0922 17:50:12.148314 17687 net.cpp:151]     with loss weight 1
I0922 17:50:12.148330 17687 net.cpp:156] Memory required for data: 98024
I0922 17:50:12.148336 17687 net.cpp:217] h_pseudoloss needs backward computation.
I0922 17:50:12.148342 17687 net.cpp:217] lstm2_h_concat needs backward computation.
I0922 17:50:12.148346 17687 net.cpp:219] lstm2_ does not need backward computation.
I0922 17:50:12.148355 17687 net.cpp:217] lstm2_unit_1 needs backward computation.
I0922 17:50:12.148355 17691 net.cpp:141] Setting up lstm1_x_transform
I0922 17:50:12.148367 17687 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0922 17:50:12.148373 17691 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 17:50:12.148375 17687 net.cpp:217] lstm2_transform_1 needs backward computation.
I0922 17:50:12.148380 17691 net.cpp:156] Memory required for data: 26016
I0922 17:50:12.148382 17687 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0922 17:50:12.148393 17687 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0922 17:50:12.148396 17691 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0922 17:50:12.148399 17687 net.cpp:217] lstm2_x_transform needs backward computation.
I0922 17:50:12.148406 17687 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0922 17:50:12.148411 17691 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0922 17:50:12.148413 17687 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0922 17:50:12.148418 17691 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0922 17:50:12.148427 17687 net.cpp:219] lstm2_ does not need backward computation.
I0922 17:50:12.148427 17691 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0922 17:50:12.148437 17687 net.cpp:219] lstm2_ does not need backward computation.
I0922 17:50:12.148447 17687 net.cpp:261] This network produces output c_T
I0922 17:50:12.148453 17687 net.cpp:261] This network produces output h_pseudoloss
I0922 17:50:12.148473 17687 net.cpp:274] Network initialization done.
I0922 17:50:12.148537 17687 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0922 17:50:12.148550 17687 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0922 17:50:12.148555 17687 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0922 17:50:12.148737 17691 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0922 17:50:12.148749 17691 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 17:50:12.148753 17691 net.cpp:156] Memory required for data: 42016
I0922 17:50:12.148758 17691 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0922 17:50:12.148771 17691 net.cpp:91] Creating Layer lstm1_h_conted_0
I0922 17:50:12.148775 17691 net.cpp:425] lstm1_h_conted_0 <- h_0
I0922 17:50:12.148782 17691 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0922 17:50:12.148792 17691 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0922 17:50:12.148816 17687 net.cpp:141] Setting up lstm2
I0922 17:50:12.148835 17687 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 17:50:12.148843 17687 net.cpp:156] Memory required for data: 36412
I0922 17:50:12.148859 17687 layer_factory.hpp:77] Creating layer predict
I0922 17:50:12.148872 17687 net.cpp:91] Creating Layer predict
I0922 17:50:12.148879 17687 net.cpp:425] predict <- lstm2
I0922 17:50:12.148893 17687 net.cpp:399] predict -> predict
I0922 17:50:12.148957 17691 net.cpp:141] Setting up lstm1_h_conted_0
I0922 17:50:12.148969 17691 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 17:50:12.148974 17691 net.cpp:156] Memory required for data: 46016
I0922 17:50:12.148979 17691 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0922 17:50:12.148993 17691 net.cpp:91] Creating Layer lstm1_transform_1
I0922 17:50:12.148999 17691 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0922 17:50:12.149008 17691 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0922 17:50:12.253641 17697 net.cpp:141] Setting up conv1
I0922 17:50:12.253705 17697 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0922 17:50:12.253711 17697 net.cpp:156] Memory required for data: 17799480
I0922 17:50:12.253738 17697 layer_factory.hpp:77] Creating layer relu1
I0922 17:50:12.253763 17697 net.cpp:91] Creating Layer relu1
I0922 17:50:12.253772 17697 net.cpp:425] relu1 <- conv1
I0922 17:50:12.253780 17697 net.cpp:386] relu1 -> conv1 (in-place)
I0922 17:50:12.254297 17697 net.cpp:141] Setting up relu1
I0922 17:50:12.254324 17697 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0922 17:50:12.254330 17697 net.cpp:156] Memory required for data: 29415480
I0922 17:50:12.254336 17697 layer_factory.hpp:77] Creating layer pool1
I0922 17:50:12.254353 17697 net.cpp:91] Creating Layer pool1
I0922 17:50:12.254359 17697 net.cpp:425] pool1 <- conv1
I0922 17:50:12.254369 17697 net.cpp:399] pool1 -> pool1
I0922 17:50:12.254482 17697 net.cpp:141] Setting up pool1
I0922 17:50:12.254493 17697 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0922 17:50:12.254508 17697 net.cpp:156] Memory required for data: 32214840
I0922 17:50:12.254513 17697 layer_factory.hpp:77] Creating layer norm1
I0922 17:50:12.254535 17697 net.cpp:91] Creating Layer norm1
I0922 17:50:12.254541 17697 net.cpp:425] norm1 <- pool1
I0922 17:50:12.254549 17697 net.cpp:399] norm1 -> norm1
I0922 17:50:12.254861 17697 net.cpp:141] Setting up norm1
I0922 17:50:12.254875 17697 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0922 17:50:12.254880 17697 net.cpp:156] Memory required for data: 35014200
I0922 17:50:12.254886 17697 layer_factory.hpp:77] Creating layer conv2
I0922 17:50:12.254904 17697 net.cpp:91] Creating Layer conv2
I0922 17:50:12.254909 17697 net.cpp:425] conv2 <- norm1
I0922 17:50:12.254919 17697 net.cpp:399] conv2 -> conv2
I0922 17:50:12.259774 17697 net.cpp:141] Setting up conv2
I0922 17:50:12.259837 17697 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0922 17:50:12.259845 17697 net.cpp:156] Memory required for data: 42479160
I0922 17:50:12.259871 17697 layer_factory.hpp:77] Creating layer relu2
I0922 17:50:12.259894 17697 net.cpp:91] Creating Layer relu2
I0922 17:50:12.259903 17697 net.cpp:425] relu2 <- conv2
I0922 17:50:12.259912 17697 net.cpp:386] relu2 -> conv2 (in-place)
I0922 17:50:12.260409 17697 net.cpp:141] Setting up relu2
I0922 17:50:12.260424 17697 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0922 17:50:12.260429 17697 net.cpp:156] Memory required for data: 49944120
I0922 17:50:12.260435 17697 layer_factory.hpp:77] Creating layer pool2
I0922 17:50:12.260452 17697 net.cpp:91] Creating Layer pool2
I0922 17:50:12.260457 17697 net.cpp:425] pool2 <- conv2
I0922 17:50:12.260468 17697 net.cpp:399] pool2 -> pool2
I0922 17:50:12.260557 17697 net.cpp:141] Setting up pool2
I0922 17:50:12.260571 17697 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0922 17:50:12.260574 17697 net.cpp:156] Memory required for data: 51674680
I0922 17:50:12.260581 17697 layer_factory.hpp:77] Creating layer norm2
I0922 17:50:12.260597 17697 net.cpp:91] Creating Layer norm2
I0922 17:50:12.260603 17697 net.cpp:425] norm2 <- pool2
I0922 17:50:12.260610 17697 net.cpp:399] norm2 -> norm2
I0922 17:50:12.260988 17697 net.cpp:141] Setting up norm2
I0922 17:50:12.261003 17697 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0922 17:50:12.261008 17697 net.cpp:156] Memory required for data: 53405240
I0922 17:50:12.261014 17697 layer_factory.hpp:77] Creating layer conv3
I0922 17:50:12.261032 17697 net.cpp:91] Creating Layer conv3
I0922 17:50:12.261039 17697 net.cpp:425] conv3 <- norm2
I0922 17:50:12.261046 17697 net.cpp:399] conv3 -> conv3
I0922 17:50:12.266043 17697 net.cpp:141] Setting up conv3
I0922 17:50:12.266104 17697 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0922 17:50:12.266116 17697 net.cpp:156] Memory required for data: 56001080
I0922 17:50:12.266144 17697 layer_factory.hpp:77] Creating layer relu3
I0922 17:50:12.266165 17697 net.cpp:91] Creating Layer relu3
I0922 17:50:12.266172 17697 net.cpp:425] relu3 <- conv3
I0922 17:50:12.266182 17697 net.cpp:386] relu3 -> conv3 (in-place)
I0922 17:50:12.266455 17697 net.cpp:141] Setting up relu3
I0922 17:50:12.266468 17697 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0922 17:50:12.266472 17697 net.cpp:156] Memory required for data: 58596920
I0922 17:50:12.266479 17697 layer_factory.hpp:77] Creating layer conv4
I0922 17:50:12.266500 17697 net.cpp:91] Creating Layer conv4
I0922 17:50:12.266506 17697 net.cpp:425] conv4 <- conv3
I0922 17:50:12.266515 17697 net.cpp:399] conv4 -> conv4
I0922 17:50:12.271685 17697 net.cpp:141] Setting up conv4
I0922 17:50:12.271733 17697 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0922 17:50:12.271739 17697 net.cpp:156] Memory required for data: 61192760
I0922 17:50:12.271754 17697 layer_factory.hpp:77] Creating layer relu4
I0922 17:50:12.271773 17697 net.cpp:91] Creating Layer relu4
I0922 17:50:12.271780 17697 net.cpp:425] relu4 <- conv4
I0922 17:50:12.271791 17697 net.cpp:386] relu4 -> conv4 (in-place)
I0922 17:50:12.272229 17697 net.cpp:141] Setting up relu4
I0922 17:50:12.272244 17697 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0922 17:50:12.272249 17697 net.cpp:156] Memory required for data: 63788600
I0922 17:50:12.272255 17697 layer_factory.hpp:77] Creating layer conv5
I0922 17:50:12.272275 17697 net.cpp:91] Creating Layer conv5
I0922 17:50:12.272281 17697 net.cpp:425] conv5 <- conv4
I0922 17:50:12.272290 17697 net.cpp:399] conv5 -> conv5
I0922 17:50:12.276366 17697 net.cpp:141] Setting up conv5
I0922 17:50:12.276389 17697 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0922 17:50:12.276396 17697 net.cpp:156] Memory required for data: 65519160
I0922 17:50:12.276413 17697 layer_factory.hpp:77] Creating layer relu5
I0922 17:50:12.276429 17697 net.cpp:91] Creating Layer relu5
I0922 17:50:12.276435 17697 net.cpp:425] relu5 <- conv5
I0922 17:50:12.276443 17697 net.cpp:386] relu5 -> conv5 (in-place)
I0922 17:50:12.276891 17697 net.cpp:141] Setting up relu5
I0922 17:50:12.276906 17697 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0922 17:50:12.276911 17697 net.cpp:156] Memory required for data: 67249720
I0922 17:50:12.276917 17697 layer_factory.hpp:77] Creating layer pool5
I0922 17:50:12.276933 17697 net.cpp:91] Creating Layer pool5
I0922 17:50:12.276938 17697 net.cpp:425] pool5 <- conv5
I0922 17:50:12.276947 17697 net.cpp:399] pool5 -> pool5
I0922 17:50:12.277027 17697 net.cpp:141] Setting up pool5
I0922 17:50:12.277039 17697 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0922 17:50:12.277042 17697 net.cpp:156] Memory required for data: 67618360
I0922 17:50:12.277047 17697 layer_factory.hpp:77] Creating layer fc6
I0922 17:50:12.277065 17697 net.cpp:91] Creating Layer fc6
I0922 17:50:12.277070 17697 net.cpp:425] fc6 <- pool5
I0922 17:50:12.277077 17697 net.cpp:399] fc6 -> fc6
I0922 17:50:12.353235 17691 net.cpp:141] Setting up lstm1_transform_1
I0922 17:50:12.353284 17691 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 17:50:12.353291 17691 net.cpp:156] Memory required for data: 62016
I0922 17:50:12.353318 17691 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0922 17:50:12.353345 17691 net.cpp:91] Creating Layer lstm1_gate_input_1
I0922 17:50:12.353354 17691 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0922 17:50:12.353363 17691 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0922 17:50:12.353374 17691 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0922 17:50:12.353441 17691 net.cpp:141] Setting up lstm1_gate_input_1
I0922 17:50:12.353451 17691 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 17:50:12.353456 17691 net.cpp:156] Memory required for data: 78016
I0922 17:50:12.353461 17691 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0922 17:50:12.353473 17691 net.cpp:91] Creating Layer lstm1_unit_1
I0922 17:50:12.353478 17691 net.cpp:425] lstm1_unit_1 <- c_0
I0922 17:50:12.353484 17691 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0922 17:50:12.353489 17691 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0922 17:50:12.353497 17691 net.cpp:399] lstm1_unit_1 -> c_1
I0922 17:50:12.353507 17691 net.cpp:399] lstm1_unit_1 -> h_1
I0922 17:50:12.353582 17691 net.cpp:141] Setting up lstm1_unit_1
I0922 17:50:12.353591 17691 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 17:50:12.353598 17691 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 17:50:12.353602 17691 net.cpp:156] Memory required for data: 86016
I0922 17:50:12.353607 17691 layer_factory.hpp:77] Creating layer lstm1_
I0922 17:50:12.353616 17691 net.cpp:91] Creating Layer lstm1_
I0922 17:50:12.353621 17691 net.cpp:425] lstm1_ <- c_1
I0922 17:50:12.353631 17691 net.cpp:399] lstm1_ -> c_T
I0922 17:50:12.353665 17691 net.cpp:141] Setting up lstm1_
I0922 17:50:12.353674 17691 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 17:50:12.353678 17691 net.cpp:156] Memory required for data: 90016
I0922 17:50:12.353683 17691 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0922 17:50:12.353693 17691 net.cpp:91] Creating Layer lstm1_h_concat
I0922 17:50:12.353698 17691 net.cpp:425] lstm1_h_concat <- h_1
I0922 17:50:12.353705 17691 net.cpp:399] lstm1_h_concat -> h
I0922 17:50:12.353747 17691 net.cpp:141] Setting up lstm1_h_concat
I0922 17:50:12.353756 17691 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 17:50:12.353760 17691 net.cpp:156] Memory required for data: 94016
I0922 17:50:12.353765 17691 layer_factory.hpp:77] Creating layer h_pseudoloss
I0922 17:50:12.353776 17691 net.cpp:91] Creating Layer h_pseudoloss
I0922 17:50:12.353781 17691 net.cpp:425] h_pseudoloss <- h
I0922 17:50:12.353788 17691 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0922 17:50:12.353875 17691 net.cpp:141] Setting up h_pseudoloss
I0922 17:50:12.353885 17691 net.cpp:148] Top shape: (1)
I0922 17:50:12.353889 17691 net.cpp:151]     with loss weight 1
I0922 17:50:12.353905 17691 net.cpp:156] Memory required for data: 94020
I0922 17:50:12.353911 17691 net.cpp:217] h_pseudoloss needs backward computation.
I0922 17:50:12.353916 17691 net.cpp:217] lstm1_h_concat needs backward computation.
I0922 17:50:12.353920 17691 net.cpp:219] lstm1_ does not need backward computation.
I0922 17:50:12.353925 17691 net.cpp:217] lstm1_unit_1 needs backward computation.
I0922 17:50:12.353931 17691 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0922 17:50:12.353937 17691 net.cpp:217] lstm1_transform_1 needs backward computation.
I0922 17:50:12.353942 17691 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0922 17:50:12.353956 17691 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0922 17:50:12.353963 17691 net.cpp:217] lstm1_x_transform needs backward computation.
I0922 17:50:12.353968 17691 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0922 17:50:12.353974 17691 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0922 17:50:12.353979 17691 net.cpp:219] lstm1_ does not need backward computation.
I0922 17:50:12.353984 17691 net.cpp:219] lstm1_ does not need backward computation.
I0922 17:50:12.353988 17691 net.cpp:261] This network produces output c_T
I0922 17:50:12.353992 17691 net.cpp:261] This network produces output h_pseudoloss
I0922 17:50:12.354008 17691 net.cpp:274] Network initialization done.
I0922 17:50:12.354063 17691 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0922 17:50:12.354069 17691 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0922 17:50:12.354074 17691 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0922 17:50:12.354202 17691 net.cpp:141] Setting up lstm1
I0922 17:50:12.354214 17691 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 17:50:12.354219 17691 net.cpp:156] Memory required for data: 26408
I0922 17:50:12.354233 17691 layer_factory.hpp:77] Creating layer concat
I0922 17:50:12.354243 17691 net.cpp:91] Creating Layer concat
I0922 17:50:12.354249 17691 net.cpp:425] concat <- lstm1
I0922 17:50:12.354255 17691 net.cpp:425] concat <- embedded_input_sentence
I0922 17:50:12.354261 17691 net.cpp:425] concat <- reshaped_stage_indicator
I0922 17:50:12.354269 17691 net.cpp:399] concat -> lstm1_video_sequence
I0922 17:50:12.354305 17691 net.cpp:141] Setting up concat
I0922 17:50:12.354315 17691 net.cpp:148] Top shape: 1 1 1501 (1501)
I0922 17:50:12.354320 17691 net.cpp:156] Memory required for data: 32412
I0922 17:50:12.354324 17691 layer_factory.hpp:77] Creating layer lstm2
I0922 17:50:12.354339 17691 net.cpp:91] Creating Layer lstm2
I0922 17:50:12.354344 17691 net.cpp:425] lstm2 <- lstm1_video_sequence
I0922 17:50:12.354351 17691 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0922 17:50:12.354358 17691 net.cpp:399] lstm2 -> lstm2
I0922 17:50:12.354370 17691 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0922 17:50:12.354655 17691 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0922 17:50:12.354754 17691 layer_factory.hpp:77] Creating layer lstm2_
I0922 17:50:12.354768 17691 net.cpp:91] Creating Layer lstm2_
I0922 17:50:12.354774 17691 net.cpp:399] lstm2_ -> x
I0922 17:50:12.354785 17691 net.cpp:399] lstm2_ -> cont
I0922 17:50:12.354847 17691 net.cpp:141] Setting up lstm2_
I0922 17:50:12.354857 17691 net.cpp:148] Top shape: 1 1 1501 (1501)
I0922 17:50:12.354864 17691 net.cpp:148] Top shape: 1 1 (1)
I0922 17:50:12.354868 17691 net.cpp:156] Memory required for data: 6008
I0922 17:50:12.354874 17691 layer_factory.hpp:77] Creating layer lstm2_
I0922 17:50:12.354883 17691 net.cpp:91] Creating Layer lstm2_
I0922 17:50:12.354892 17691 net.cpp:399] lstm2_ -> c_0
I0922 17:50:12.354903 17691 net.cpp:399] lstm2_ -> h_0
I0922 17:50:12.354961 17691 net.cpp:141] Setting up lstm2_
I0922 17:50:12.354971 17691 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 17:50:12.354977 17691 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 17:50:12.354981 17691 net.cpp:156] Memory required for data: 14008
I0922 17:50:12.354986 17691 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0922 17:50:12.354995 17691 net.cpp:91] Creating Layer lstm2_cont_slice
I0922 17:50:12.355000 17691 net.cpp:425] lstm2_cont_slice <- cont
I0922 17:50:12.355007 17691 net.cpp:399] lstm2_cont_slice -> cont_1
I0922 17:50:12.355073 17691 net.cpp:141] Setting up lstm2_cont_slice
I0922 17:50:12.355087 17691 net.cpp:148] Top shape: 1 1 (1)
I0922 17:50:12.355099 17691 net.cpp:156] Memory required for data: 14012
I0922 17:50:12.355104 17691 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0922 17:50:12.355115 17691 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0922 17:50:12.355120 17691 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0922 17:50:12.355129 17691 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0922 17:50:12.355136 17691 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0922 17:50:12.355203 17691 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0922 17:50:12.355212 17691 net.cpp:148] Top shape: 1 1 (1)
I0922 17:50:12.355218 17691 net.cpp:148] Top shape: 1 1 (1)
I0922 17:50:12.355222 17691 net.cpp:156] Memory required for data: 14020
I0922 17:50:12.355227 17691 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0922 17:50:12.355240 17691 net.cpp:91] Creating Layer lstm2_x_transform
I0922 17:50:12.355247 17691 net.cpp:425] lstm2_x_transform <- x
I0922 17:50:12.355253 17691 net.cpp:399] lstm2_x_transform -> W_xc_x
I0922 17:50:12.397347 17697 net.cpp:141] Setting up fc6
I0922 17:50:12.397397 17697 net.cpp:148] Top shape: 10 4096 (40960)
I0922 17:50:12.397403 17697 net.cpp:156] Memory required for data: 67782200
I0922 17:50:12.397420 17697 layer_factory.hpp:77] Creating layer relu6
I0922 17:50:12.397444 17697 net.cpp:91] Creating Layer relu6
I0922 17:50:12.397451 17697 net.cpp:425] relu6 <- fc6
I0922 17:50:12.397460 17697 net.cpp:386] relu6 -> fc6 (in-place)
I0922 17:50:12.397822 17697 net.cpp:141] Setting up relu6
I0922 17:50:12.397835 17697 net.cpp:148] Top shape: 10 4096 (40960)
I0922 17:50:12.397840 17697 net.cpp:156] Memory required for data: 67946040
I0922 17:50:12.397845 17697 layer_factory.hpp:77] Creating layer drop6
I0922 17:50:12.397866 17697 net.cpp:91] Creating Layer drop6
I0922 17:50:12.397872 17697 net.cpp:425] drop6 <- fc6
I0922 17:50:12.397883 17697 net.cpp:386] drop6 -> fc6 (in-place)
I0922 17:50:12.397940 17697 net.cpp:141] Setting up drop6
I0922 17:50:12.397953 17697 net.cpp:148] Top shape: 10 4096 (40960)
I0922 17:50:12.397958 17697 net.cpp:156] Memory required for data: 68109880
I0922 17:50:12.397964 17697 layer_factory.hpp:77] Creating layer fc7
I0922 17:50:12.397974 17697 net.cpp:91] Creating Layer fc7
I0922 17:50:12.397979 17697 net.cpp:425] fc7 <- fc6
I0922 17:50:12.397985 17697 net.cpp:399] fc7 -> fc7
I0922 17:50:12.430145 17691 net.cpp:141] Setting up lstm2_x_transform
I0922 17:50:12.430196 17691 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 17:50:12.430202 17691 net.cpp:156] Memory required for data: 30020
I0922 17:50:12.430227 17691 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0922 17:50:12.430253 17691 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0922 17:50:12.430261 17691 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0922 17:50:12.430271 17691 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0922 17:50:12.430323 17691 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0922 17:50:12.430335 17691 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 17:50:12.430340 17691 net.cpp:156] Memory required for data: 46020
I0922 17:50:12.430344 17691 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0922 17:50:12.430358 17691 net.cpp:91] Creating Layer lstm2_h_conted_0
I0922 17:50:12.430363 17691 net.cpp:425] lstm2_h_conted_0 <- h_0
I0922 17:50:12.430371 17691 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0922 17:50:12.430377 17691 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0922 17:50:12.430483 17691 net.cpp:141] Setting up lstm2_h_conted_0
I0922 17:50:12.430493 17691 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 17:50:12.430498 17691 net.cpp:156] Memory required for data: 50020
I0922 17:50:12.430503 17691 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0922 17:50:12.430519 17691 net.cpp:91] Creating Layer lstm2_transform_1
I0922 17:50:12.430524 17691 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0922 17:50:12.430532 17691 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0922 17:50:12.448631 17697 net.cpp:141] Setting up fc7
I0922 17:50:12.448678 17697 net.cpp:148] Top shape: 10 4096 (40960)
I0922 17:50:12.448684 17697 net.cpp:156] Memory required for data: 68273720
I0922 17:50:12.448699 17697 layer_factory.hpp:77] Creating layer relu7
I0922 17:50:12.448717 17697 net.cpp:91] Creating Layer relu7
I0922 17:50:12.448724 17697 net.cpp:425] relu7 <- fc7
I0922 17:50:12.448736 17697 net.cpp:386] relu7 -> fc7 (in-place)
I0922 17:50:12.449374 17697 net.cpp:141] Setting up relu7
I0922 17:50:12.449388 17697 net.cpp:148] Top shape: 10 4096 (40960)
I0922 17:50:12.449393 17697 net.cpp:156] Memory required for data: 68437560
I0922 17:50:12.449399 17697 layer_factory.hpp:77] Creating layer drop7
I0922 17:50:12.449410 17697 net.cpp:91] Creating Layer drop7
I0922 17:50:12.449420 17697 net.cpp:425] drop7 <- fc7
I0922 17:50:12.449427 17697 net.cpp:386] drop7 -> fc7 (in-place)
I0922 17:50:12.449471 17697 net.cpp:141] Setting up drop7
I0922 17:50:12.449481 17697 net.cpp:148] Top shape: 10 4096 (40960)
I0922 17:50:12.449484 17697 net.cpp:156] Memory required for data: 68601400
I0922 17:50:12.449489 17697 layer_factory.hpp:77] Creating layer fc8
I0922 17:50:12.449506 17697 net.cpp:91] Creating Layer fc8
I0922 17:50:12.449512 17697 net.cpp:425] fc8 <- fc7
I0922 17:50:12.449520 17697 net.cpp:399] fc8 -> fc8
I0922 17:50:12.462275 17697 net.cpp:141] Setting up fc8
I0922 17:50:12.462321 17697 net.cpp:148] Top shape: 10 1000 (10000)
I0922 17:50:12.462327 17697 net.cpp:156] Memory required for data: 68641400
I0922 17:50:12.462342 17697 layer_factory.hpp:77] Creating layer prob
I0922 17:50:12.462362 17697 net.cpp:91] Creating Layer prob
I0922 17:50:12.462368 17697 net.cpp:425] prob <- fc8
I0922 17:50:12.462389 17697 net.cpp:399] prob -> prob
I0922 17:50:12.463085 17697 net.cpp:141] Setting up prob
I0922 17:50:12.463109 17697 net.cpp:148] Top shape: 10 1000 (10000)
I0922 17:50:12.463119 17697 net.cpp:156] Memory required for data: 68681400
I0922 17:50:12.463131 17697 net.cpp:219] prob does not need backward computation.
I0922 17:50:12.463141 17697 net.cpp:219] fc8 does not need backward computation.
I0922 17:50:12.463150 17697 net.cpp:219] drop7 does not need backward computation.
I0922 17:50:12.463160 17697 net.cpp:219] relu7 does not need backward computation.
I0922 17:50:12.463170 17697 net.cpp:219] fc7 does not need backward computation.
I0922 17:50:12.463178 17697 net.cpp:219] drop6 does not need backward computation.
I0922 17:50:12.463186 17697 net.cpp:219] relu6 does not need backward computation.
I0922 17:50:12.463193 17697 net.cpp:219] fc6 does not need backward computation.
I0922 17:50:12.463202 17697 net.cpp:219] pool5 does not need backward computation.
I0922 17:50:12.463210 17697 net.cpp:219] relu5 does not need backward computation.
I0922 17:50:12.463219 17697 net.cpp:219] conv5 does not need backward computation.
I0922 17:50:12.463229 17697 net.cpp:219] relu4 does not need backward computation.
I0922 17:50:12.463238 17697 net.cpp:219] conv4 does not need backward computation.
I0922 17:50:12.463249 17697 net.cpp:219] relu3 does not need backward computation.
I0922 17:50:12.463258 17697 net.cpp:219] conv3 does not need backward computation.
I0922 17:50:12.463269 17697 net.cpp:219] norm2 does not need backward computation.
I0922 17:50:12.463280 17697 net.cpp:219] pool2 does not need backward computation.
I0922 17:50:12.463289 17697 net.cpp:219] relu2 does not need backward computation.
I0922 17:50:12.463297 17697 net.cpp:219] conv2 does not need backward computation.
I0922 17:50:12.463307 17697 net.cpp:219] norm1 does not need backward computation.
I0922 17:50:12.463318 17697 net.cpp:219] pool1 does not need backward computation.
I0922 17:50:12.463328 17697 net.cpp:219] relu1 does not need backward computation.
I0922 17:50:12.463337 17697 net.cpp:219] conv1 does not need backward computation.
I0922 17:50:12.463348 17697 net.cpp:219] data does not need backward computation.
I0922 17:50:12.463356 17697 net.cpp:261] This network produces output prob
I0922 17:50:12.463392 17697 net.cpp:274] Network initialization done.
I0922 17:50:12.474030 17691 net.cpp:141] Setting up lstm2_transform_1
I0922 17:50:12.474073 17691 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 17:50:12.474081 17691 net.cpp:156] Memory required for data: 66020
I0922 17:50:12.474102 17691 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0922 17:50:12.474126 17691 net.cpp:91] Creating Layer lstm2_gate_input_1
I0922 17:50:12.474134 17691 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0922 17:50:12.474143 17691 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0922 17:50:12.474153 17691 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0922 17:50:12.474208 17691 net.cpp:141] Setting up lstm2_gate_input_1
I0922 17:50:12.474218 17691 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 17:50:12.474222 17691 net.cpp:156] Memory required for data: 82020
I0922 17:50:12.474227 17691 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0922 17:50:12.474241 17691 net.cpp:91] Creating Layer lstm2_unit_1
I0922 17:50:12.474246 17691 net.cpp:425] lstm2_unit_1 <- c_0
I0922 17:50:12.474253 17691 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0922 17:50:12.474258 17691 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0922 17:50:12.474266 17691 net.cpp:399] lstm2_unit_1 -> c_1
I0922 17:50:12.474275 17691 net.cpp:399] lstm2_unit_1 -> h_1
I0922 17:50:12.474349 17691 net.cpp:141] Setting up lstm2_unit_1
I0922 17:50:12.474359 17691 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 17:50:12.474365 17691 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 17:50:12.474370 17691 net.cpp:156] Memory required for data: 90020
I0922 17:50:12.474375 17691 layer_factory.hpp:77] Creating layer lstm2_
I0922 17:50:12.474383 17691 net.cpp:91] Creating Layer lstm2_
I0922 17:50:12.474388 17691 net.cpp:425] lstm2_ <- c_1
I0922 17:50:12.474398 17691 net.cpp:399] lstm2_ -> c_T
I0922 17:50:12.474432 17691 net.cpp:141] Setting up lstm2_
I0922 17:50:12.474441 17691 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 17:50:12.474445 17691 net.cpp:156] Memory required for data: 94020
I0922 17:50:12.474450 17691 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0922 17:50:12.474459 17691 net.cpp:91] Creating Layer lstm2_h_concat
I0922 17:50:12.474465 17691 net.cpp:425] lstm2_h_concat <- h_1
I0922 17:50:12.474472 17691 net.cpp:399] lstm2_h_concat -> h
I0922 17:50:12.474512 17691 net.cpp:141] Setting up lstm2_h_concat
I0922 17:50:12.474521 17691 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 17:50:12.474526 17691 net.cpp:156] Memory required for data: 98020
I0922 17:50:12.474531 17691 layer_factory.hpp:77] Creating layer h_pseudoloss
I0922 17:50:12.474540 17691 net.cpp:91] Creating Layer h_pseudoloss
I0922 17:50:12.474545 17691 net.cpp:425] h_pseudoloss <- h
I0922 17:50:12.474551 17691 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0922 17:50:12.474648 17691 net.cpp:141] Setting up h_pseudoloss
I0922 17:50:12.474659 17691 net.cpp:148] Top shape: (1)
I0922 17:50:12.474664 17691 net.cpp:151]     with loss weight 1
I0922 17:50:12.474681 17691 net.cpp:156] Memory required for data: 98024
I0922 17:50:12.474687 17691 net.cpp:217] h_pseudoloss needs backward computation.
I0922 17:50:12.474692 17691 net.cpp:217] lstm2_h_concat needs backward computation.
I0922 17:50:12.474696 17691 net.cpp:219] lstm2_ does not need backward computation.
I0922 17:50:12.474701 17691 net.cpp:217] lstm2_unit_1 needs backward computation.
I0922 17:50:12.474710 17691 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0922 17:50:12.474715 17691 net.cpp:217] lstm2_transform_1 needs backward computation.
I0922 17:50:12.474720 17691 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0922 17:50:12.474727 17691 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0922 17:50:12.474732 17691 net.cpp:217] lstm2_x_transform needs backward computation.
I0922 17:50:12.474737 17691 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0922 17:50:12.474743 17691 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0922 17:50:12.474748 17691 net.cpp:219] lstm2_ does not need backward computation.
I0922 17:50:12.474753 17691 net.cpp:219] lstm2_ does not need backward computation.
I0922 17:50:12.474756 17691 net.cpp:261] This network produces output c_T
I0922 17:50:12.474761 17691 net.cpp:261] This network produces output h_pseudoloss
I0922 17:50:12.474778 17691 net.cpp:274] Network initialization done.
I0922 17:50:12.474833 17691 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0922 17:50:12.474838 17691 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0922 17:50:12.474843 17691 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0922 17:50:12.474959 17691 net.cpp:141] Setting up lstm2
I0922 17:50:12.474972 17691 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 17:50:12.474977 17691 net.cpp:156] Memory required for data: 36412
I0922 17:50:12.474992 17691 layer_factory.hpp:77] Creating layer predict
I0922 17:50:12.475005 17691 net.cpp:91] Creating Layer predict
I0922 17:50:12.475011 17691 net.cpp:425] predict <- lstm2
I0922 17:50:12.475028 17691 net.cpp:399] predict -> predict
I0922 17:50:12.652206 17687 net.cpp:141] Setting up predict
I0922 17:50:12.652256 17687 net.cpp:148] Top shape: 1 1 46168 (46168)
I0922 17:50:12.652262 17687 net.cpp:156] Memory required for data: 221084
I0922 17:50:12.652277 17687 layer_factory.hpp:77] Creating layer probs
I0922 17:50:12.652297 17687 net.cpp:91] Creating Layer probs
I0922 17:50:12.652304 17687 net.cpp:425] probs <- predict
I0922 17:50:12.652317 17687 net.cpp:399] probs -> probs
I0922 17:50:12.653127 17687 net.cpp:141] Setting up probs
I0922 17:50:12.653142 17687 net.cpp:148] Top shape: 1 1 46168 (46168)
I0922 17:50:12.653147 17687 net.cpp:156] Memory required for data: 405756
I0922 17:50:12.653153 17687 net.cpp:219] probs does not need backward computation.
I0922 17:50:12.653159 17687 net.cpp:219] predict does not need backward computation.
I0922 17:50:12.653164 17687 net.cpp:219] lstm2 does not need backward computation.
I0922 17:50:12.653170 17687 net.cpp:219] concat does not need backward computation.
I0922 17:50:12.653177 17687 net.cpp:219] lstm1 does not need backward computation.
I0922 17:50:12.653182 17687 net.cpp:219] embedding does not need backward computation.
I0922 17:50:12.653187 17687 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0922 17:50:12.653192 17687 net.cpp:219] reshape_frames does not need backward computation.
I0922 17:50:12.653198 17687 net.cpp:219] embed_encoder does not need backward computation.
I0922 17:50:12.653203 17687 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0922 17:50:12.653208 17687 net.cpp:219] input does not need backward computation.
I0922 17:50:12.653213 17687 net.cpp:261] This network produces output probs
I0922 17:50:12.653234 17687 net.cpp:274] Network initialization done.
I0922 17:50:12.792562 17697 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /home/peifeng/work/run/storm102/data/workers/5ce2ba85-335f-45ef-bf9c-1cd4226a2fa5/tmp/cvld6203887133916814714/bvlc_reference_caffenet.caffemodel
I0922 17:50:12.792605 17697 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0922 17:50:12.792611 17697 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0922 17:50:12.792616 17697 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /home/peifeng/work/run/storm102/data/workers/5ce2ba85-335f-45ef-bf9c-1cd4226a2fa5/tmp/cvld6203887133916814714/bvlc_reference_caffenet.caffemodel
I0922 17:50:12.964550 17691 net.cpp:141] Setting up predict
I0922 17:50:12.964612 17691 net.cpp:148] Top shape: 1 1 46168 (46168)
I0922 17:50:12.964623 17691 net.cpp:156] Memory required for data: 221084
I0922 17:50:12.964646 17691 layer_factory.hpp:77] Creating layer probs
I0922 17:50:12.964674 17691 net.cpp:91] Creating Layer probs
I0922 17:50:12.964685 17691 net.cpp:425] probs <- predict
I0922 17:50:12.964702 17691 net.cpp:399] probs -> probs
I0922 17:50:12.965456 17691 net.cpp:141] Setting up probs
I0922 17:50:12.965487 17691 net.cpp:148] Top shape: 1 1 46168 (46168)
I0922 17:50:12.965495 17691 net.cpp:156] Memory required for data: 405756
I0922 17:50:12.965507 17691 net.cpp:219] probs does not need backward computation.
I0922 17:50:12.965517 17691 net.cpp:219] predict does not need backward computation.
I0922 17:50:12.965524 17691 net.cpp:219] lstm2 does not need backward computation.
I0922 17:50:12.965534 17691 net.cpp:219] concat does not need backward computation.
I0922 17:50:12.965543 17691 net.cpp:219] lstm1 does not need backward computation.
I0922 17:50:12.965553 17691 net.cpp:219] embedding does not need backward computation.
I0922 17:50:12.965562 17691 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0922 17:50:12.965570 17691 net.cpp:219] reshape_frames does not need backward computation.
I0922 17:50:12.965579 17691 net.cpp:219] embed_encoder does not need backward computation.
I0922 17:50:12.965589 17691 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0922 17:50:12.965600 17691 net.cpp:219] input does not need backward computation.
I0922 17:50:12.965606 17691 net.cpp:261] This network produces output probs
I0922 17:50:12.965632 17691 net.cpp:274] Network initialization done.
I0922 17:50:13.003109 17687 net.cpp:752] Ignoring source layer data
I0922 17:50:13.003149 17687 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0922 17:50:13.003155 17687 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0922 17:50:13.081717 17687 net.cpp:752] Ignoring source layer cross_entropy_loss
I0922 17:50:13.206199 17697 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0922 17:50:13.261276 17697 net.cpp:752] Ignoring source layer loss
Loading the model + trained: 7736.24ms
Using cv::Size and some other stuff: 0.09ms
I0922 17:50:13.318541 17691 net.cpp:752] Ignoring source layer data
I0922 17:50:13.318580 17691 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0922 17:50:13.318589 17691 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0922 17:50:13.392691 17691 net.cpp:752] Ignoring source layer cross_entropy_loss
Loading the mean file: 11880.6ms
TIMERTIMER 376866655
TIMERTIMER 302438035
TIMERTIMER 316234168
TIMERTIMER 290116962
TIMERTIMER 287263771
TIMERTIMER 304946251
TIMERTIMER 315753870
TIMERTIMER 286593377
TIMERTIMER 271155662
TIMERTIMER 272893926
TIMERTIMER 274421837
TIMERTIMER 279826166
TIMERTIMER 300981731
TIMERTIMER 271717466
TIMERTIMER 295501261
TIMERTIMER 286727406
TIMERTIMER 227689783
TIMERTIMER 178530012
TIMERTIMER 233790655
TIMERTIMER 248336062
TIMERTIMER 237433289
TIMERTIMER 217608496
TIMERTIMER 305397215
TIMERTIMER 277894061
TIMERTIMER 241554204
TIMERTIMER 243086093
TIMERTIMER 239803821
TIMERTIMER 234963679
TIMERTIMER 190489901
TIMERTIMER 188401922
TIMERTIMER 191070929
TIMERTIMER 194896104
TIMERTIMER 187431313
TIMERTIMER 193786840
TIMERTIMER 193946530
TIMERTIMER 189188697
TIMERTIMER 189036159
TIMERTIMER 187156306
TIMERTIMER 192943449
TIMERTIMER 199786660
TIMERTIMER 193117267
TIMERTIMER 187439823
TIMERTIMER 187664634
TIMERTIMER 187465640
TIMERTIMER 194262047
TIMERTIMER 183471742
TIMERTIMER 193265177
TIMERTIMER 192680433
TIMERTIMER 188036990
