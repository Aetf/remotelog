SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/peifeng/tools/storm102/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/peifeng/work/run/storm102/data/supervisor/stormdist/captioning-1-1474595528/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /home/peifeng/work/run/storm102/data/workers/c5710ece-4852-4f0b-a332-5e9832c56081/tmp/cvld4391536668528237162/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0922 21:52:50.941787 12751 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/c5710ece-4852-4f0b-a332-5e9832c56081/tmp/cvld4391536668528237162/s2vt.words_to_preds.prototxt
I0922 21:52:50.941905 12751 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0922 21:52:50.941913 12751 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0922 21:52:50.942176 12751 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0922 21:52:50.942198 12757 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0922 21:52:50.942320 12751 layer_factory.hpp:77] Creating layer input
I0922 21:52:50.942325 12757 layer_factory.hpp:77] Creating layer data
I0922 21:52:50.942350 12751 net.cpp:91] Creating Layer input
I0922 21:52:50.942350 12757 net.cpp:91] Creating Layer data
I0922 21:52:50.942368 12757 net.cpp:399] data -> data
I0922 21:52:50.942368 12751 net.cpp:399] input -> frames_fc7
I0922 21:52:50.942420 12751 net.cpp:399] input -> cont_sentence
I0922 21:52:50.942435 12751 net.cpp:399] input -> input_sentence
I0922 21:52:50.942446 12751 net.cpp:399] input -> stage_indicator
I0922 21:52:51.498540 12757 net.cpp:141] Setting up data
I0922 21:52:51.498627 12757 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0922 21:52:51.498636 12757 net.cpp:156] Memory required for data: 6183480
I0922 21:52:51.498646 12751 net.cpp:141] Setting up input
I0922 21:52:51.498659 12757 layer_factory.hpp:77] Creating layer conv1
I0922 21:52:51.498668 12751 net.cpp:148] Top shape: 1 4096 (4096)
I0922 21:52:51.498677 12751 net.cpp:148] Top shape: 1 1 (1)
I0922 21:52:51.498682 12751 net.cpp:148] Top shape: 1 1 (1)
I0922 21:52:51.498688 12751 net.cpp:148] Top shape: 1 1 (1)
I0922 21:52:51.498693 12751 net.cpp:156] Memory required for data: 16396
I0922 21:52:51.498697 12757 net.cpp:91] Creating Layer conv1
I0922 21:52:51.498699 12751 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0922 21:52:51.498708 12757 net.cpp:425] conv1 <- data
I0922 21:52:51.498723 12757 net.cpp:399] conv1 -> conv1
I0922 21:52:51.498726 12751 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0922 21:52:51.498733 12751 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0922 21:52:51.498756 12751 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0922 21:52:51.498769 12751 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0922 21:52:51.498839 12751 net.cpp:141] Setting up cont_sentence_input_1_split
I0922 21:52:51.498852 12751 net.cpp:148] Top shape: 1 1 (1)
I0922 21:52:51.498857 12751 net.cpp:148] Top shape: 1 1 (1)
I0922 21:52:51.498862 12751 net.cpp:156] Memory required for data: 16404
I0922 21:52:51.498867 12751 layer_factory.hpp:77] Creating layer embed_encoder
I0922 21:52:51.498893 12751 net.cpp:91] Creating Layer embed_encoder
I0922 21:52:51.498899 12751 net.cpp:425] embed_encoder <- frames_fc7
I0922 21:52:51.498908 12751 net.cpp:399] embed_encoder -> embedded_in_frames
I0922 21:52:51.524513 12751 net.cpp:141] Setting up embed_encoder
I0922 21:52:51.524562 12751 net.cpp:148] Top shape: 1 500 (500)
I0922 21:52:51.524570 12751 net.cpp:156] Memory required for data: 18404
I0922 21:52:51.524601 12751 layer_factory.hpp:77] Creating layer reshape_frames
I0922 21:52:51.524633 12751 net.cpp:91] Creating Layer reshape_frames
I0922 21:52:51.524643 12751 net.cpp:425] reshape_frames <- embedded_in_frames
I0922 21:52:51.524654 12751 net.cpp:399] reshape_frames -> embedded_input_frames
I0922 21:52:51.524772 12751 net.cpp:141] Setting up reshape_frames
I0922 21:52:51.524785 12751 net.cpp:148] Top shape: 1 1 500 (500)
I0922 21:52:51.524790 12751 net.cpp:156] Memory required for data: 20404
I0922 21:52:51.524796 12751 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0922 21:52:51.524807 12751 net.cpp:91] Creating Layer reshape_stage_indicator
I0922 21:52:51.524813 12751 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0922 21:52:51.524822 12751 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0922 21:52:51.534742 12751 net.cpp:141] Setting up reshape_stage_indicator
I0922 21:52:51.534764 12751 net.cpp:148] Top shape: 1 1 1 (1)
I0922 21:52:51.534770 12751 net.cpp:156] Memory required for data: 20408
I0922 21:52:51.534775 12751 layer_factory.hpp:77] Creating layer embedding
I0922 21:52:51.534790 12751 net.cpp:91] Creating Layer embedding
I0922 21:52:51.534796 12751 net.cpp:425] embedding <- input_sentence
I0922 21:52:51.534806 12751 net.cpp:399] embedding -> embedded_input_sentence
I0922 21:52:51.739914 12757 net.cpp:141] Setting up conv1
I0922 21:52:51.739961 12757 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0922 21:52:51.739969 12757 net.cpp:156] Memory required for data: 17799480
I0922 21:52:51.739994 12757 layer_factory.hpp:77] Creating layer relu1
I0922 21:52:51.740015 12757 net.cpp:91] Creating Layer relu1
I0922 21:52:51.740022 12757 net.cpp:425] relu1 <- conv1
I0922 21:52:51.740031 12757 net.cpp:386] relu1 -> conv1 (in-place)
I0922 21:52:51.740443 12757 net.cpp:141] Setting up relu1
I0922 21:52:51.740458 12757 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0922 21:52:51.740464 12757 net.cpp:156] Memory required for data: 29415480
I0922 21:52:51.740469 12757 layer_factory.hpp:77] Creating layer pool1
I0922 21:52:51.740484 12757 net.cpp:91] Creating Layer pool1
I0922 21:52:51.740489 12757 net.cpp:425] pool1 <- conv1
I0922 21:52:51.740499 12757 net.cpp:399] pool1 -> pool1
I0922 21:52:51.740574 12757 net.cpp:141] Setting up pool1
I0922 21:52:51.740586 12757 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0922 21:52:51.740592 12757 net.cpp:156] Memory required for data: 32214840
I0922 21:52:51.740597 12757 layer_factory.hpp:77] Creating layer norm1
I0922 21:52:51.740617 12757 net.cpp:91] Creating Layer norm1
I0922 21:52:51.740622 12757 net.cpp:425] norm1 <- pool1
I0922 21:52:51.740629 12757 net.cpp:399] norm1 -> norm1
I0922 21:52:51.740907 12757 net.cpp:141] Setting up norm1
I0922 21:52:51.740921 12757 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0922 21:52:51.740926 12757 net.cpp:156] Memory required for data: 35014200
I0922 21:52:51.740932 12757 layer_factory.hpp:77] Creating layer conv2
I0922 21:52:51.740948 12757 net.cpp:91] Creating Layer conv2
I0922 21:52:51.740954 12757 net.cpp:425] conv2 <- norm1
I0922 21:52:51.740962 12757 net.cpp:399] conv2 -> conv2
I0922 21:52:51.744184 12757 net.cpp:141] Setting up conv2
I0922 21:52:51.744201 12757 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0922 21:52:51.744206 12757 net.cpp:156] Memory required for data: 42479160
I0922 21:52:51.744220 12757 layer_factory.hpp:77] Creating layer relu2
I0922 21:52:51.744230 12757 net.cpp:91] Creating Layer relu2
I0922 21:52:51.744236 12757 net.cpp:425] relu2 <- conv2
I0922 21:52:51.744243 12757 net.cpp:386] relu2 -> conv2 (in-place)
I0922 21:52:51.744644 12757 net.cpp:141] Setting up relu2
I0922 21:52:51.744659 12757 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0922 21:52:51.744664 12757 net.cpp:156] Memory required for data: 49944120
I0922 21:52:51.744669 12757 layer_factory.hpp:77] Creating layer pool2
I0922 21:52:51.744679 12757 net.cpp:91] Creating Layer pool2
I0922 21:52:51.744684 12757 net.cpp:425] pool2 <- conv2
I0922 21:52:51.744693 12757 net.cpp:399] pool2 -> pool2
I0922 21:52:51.744745 12757 net.cpp:141] Setting up pool2
I0922 21:52:51.744755 12757 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0922 21:52:51.744760 12757 net.cpp:156] Memory required for data: 51674680
I0922 21:52:51.744765 12757 layer_factory.hpp:77] Creating layer norm2
I0922 21:52:51.744776 12757 net.cpp:91] Creating Layer norm2
I0922 21:52:51.744781 12757 net.cpp:425] norm2 <- pool2
I0922 21:52:51.744788 12757 net.cpp:399] norm2 -> norm2
I0922 21:52:51.745048 12757 net.cpp:141] Setting up norm2
I0922 21:52:51.745061 12757 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0922 21:52:51.745066 12757 net.cpp:156] Memory required for data: 53405240
I0922 21:52:51.745071 12757 layer_factory.hpp:77] Creating layer conv3
I0922 21:52:51.745082 12757 net.cpp:91] Creating Layer conv3
I0922 21:52:51.745088 12757 net.cpp:425] conv3 <- norm2
I0922 21:52:51.745095 12757 net.cpp:399] conv3 -> conv3
I0922 21:52:51.748809 12757 net.cpp:141] Setting up conv3
I0922 21:52:51.748827 12757 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0922 21:52:51.748833 12757 net.cpp:156] Memory required for data: 56001080
I0922 21:52:51.748849 12757 layer_factory.hpp:77] Creating layer relu3
I0922 21:52:51.748859 12757 net.cpp:91] Creating Layer relu3
I0922 21:52:51.748864 12757 net.cpp:425] relu3 <- conv3
I0922 21:52:51.748872 12757 net.cpp:386] relu3 -> conv3 (in-place)
I0922 21:52:51.749125 12757 net.cpp:141] Setting up relu3
I0922 21:52:51.749138 12757 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0922 21:52:51.749143 12757 net.cpp:156] Memory required for data: 58596920
I0922 21:52:51.749148 12757 layer_factory.hpp:77] Creating layer conv4
I0922 21:52:51.749164 12757 net.cpp:91] Creating Layer conv4
I0922 21:52:51.749171 12757 net.cpp:425] conv4 <- conv3
I0922 21:52:51.749178 12757 net.cpp:399] conv4 -> conv4
I0922 21:52:51.753484 12757 net.cpp:141] Setting up conv4
I0922 21:52:51.753504 12757 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0922 21:52:51.753509 12757 net.cpp:156] Memory required for data: 61192760
I0922 21:52:51.753518 12757 layer_factory.hpp:77] Creating layer relu4
I0922 21:52:51.753528 12757 net.cpp:91] Creating Layer relu4
I0922 21:52:51.753533 12757 net.cpp:425] relu4 <- conv4
I0922 21:52:51.753540 12757 net.cpp:386] relu4 -> conv4 (in-place)
I0922 21:52:51.753958 12757 net.cpp:141] Setting up relu4
I0922 21:52:51.753973 12757 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0922 21:52:51.753978 12757 net.cpp:156] Memory required for data: 63788600
I0922 21:52:51.753983 12757 layer_factory.hpp:77] Creating layer conv5
I0922 21:52:51.753998 12757 net.cpp:91] Creating Layer conv5
I0922 21:52:51.754004 12757 net.cpp:425] conv5 <- conv4
I0922 21:52:51.754012 12757 net.cpp:399] conv5 -> conv5
I0922 21:52:51.757845 12757 net.cpp:141] Setting up conv5
I0922 21:52:51.757863 12757 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0922 21:52:51.757869 12757 net.cpp:156] Memory required for data: 65519160
I0922 21:52:51.757882 12757 layer_factory.hpp:77] Creating layer relu5
I0922 21:52:51.757896 12757 net.cpp:91] Creating Layer relu5
I0922 21:52:51.757902 12757 net.cpp:425] relu5 <- conv5
I0922 21:52:51.757910 12757 net.cpp:386] relu5 -> conv5 (in-place)
I0922 21:52:51.758329 12757 net.cpp:141] Setting up relu5
I0922 21:52:51.758343 12757 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0922 21:52:51.758352 12757 net.cpp:156] Memory required for data: 67249720
I0922 21:52:51.758358 12757 layer_factory.hpp:77] Creating layer pool5
I0922 21:52:51.758373 12757 net.cpp:91] Creating Layer pool5
I0922 21:52:51.758378 12757 net.cpp:425] pool5 <- conv5
I0922 21:52:51.758386 12757 net.cpp:399] pool5 -> pool5
I0922 21:52:51.758453 12757 net.cpp:141] Setting up pool5
I0922 21:52:51.758463 12757 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0922 21:52:51.758468 12757 net.cpp:156] Memory required for data: 67618360
I0922 21:52:51.758473 12757 layer_factory.hpp:77] Creating layer fc6
I0922 21:52:51.758489 12757 net.cpp:91] Creating Layer fc6
I0922 21:52:51.758496 12757 net.cpp:425] fc6 <- pool5
I0922 21:52:51.758502 12757 net.cpp:399] fc6 -> fc6
I0922 21:52:51.829239 12751 net.cpp:141] Setting up embedding
I0922 21:52:51.829288 12751 net.cpp:148] Top shape: 1 1 500 (500)
I0922 21:52:51.829295 12751 net.cpp:156] Memory required for data: 22408
I0922 21:52:51.829319 12751 layer_factory.hpp:77] Creating layer lstm1
I0922 21:52:51.829355 12751 net.cpp:91] Creating Layer lstm1
I0922 21:52:51.829365 12751 net.cpp:425] lstm1 <- embedded_input_frames
I0922 21:52:51.829375 12751 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0922 21:52:51.829385 12751 net.cpp:399] lstm1 -> lstm1
I0922 21:52:51.829418 12751 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0922 21:52:51.829838 12751 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0922 21:52:51.829943 12751 layer_factory.hpp:77] Creating layer lstm1_
I0922 21:52:51.829959 12751 net.cpp:91] Creating Layer lstm1_
I0922 21:52:51.829967 12751 net.cpp:399] lstm1_ -> x
I0922 21:52:51.829979 12751 net.cpp:399] lstm1_ -> cont
I0922 21:52:51.830055 12751 net.cpp:141] Setting up lstm1_
I0922 21:52:51.830070 12751 net.cpp:148] Top shape: 1 1 500 (500)
I0922 21:52:51.830077 12751 net.cpp:148] Top shape: 1 1 (1)
I0922 21:52:51.830081 12751 net.cpp:156] Memory required for data: 2004
I0922 21:52:51.830088 12751 layer_factory.hpp:77] Creating layer lstm1_
I0922 21:52:51.830097 12751 net.cpp:91] Creating Layer lstm1_
I0922 21:52:51.830107 12751 net.cpp:399] lstm1_ -> c_0
I0922 21:52:51.830117 12751 net.cpp:399] lstm1_ -> h_0
I0922 21:52:51.830173 12751 net.cpp:141] Setting up lstm1_
I0922 21:52:51.830183 12751 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:52:51.830188 12751 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:52:51.830193 12751 net.cpp:156] Memory required for data: 10004
I0922 21:52:51.830198 12751 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0922 21:52:51.830207 12751 net.cpp:91] Creating Layer lstm1_cont_slice
I0922 21:52:51.830212 12751 net.cpp:425] lstm1_cont_slice <- cont
I0922 21:52:51.830222 12751 net.cpp:399] lstm1_cont_slice -> cont_1
I0922 21:52:51.830260 12751 net.cpp:141] Setting up lstm1_cont_slice
I0922 21:52:51.830270 12751 net.cpp:148] Top shape: 1 1 (1)
I0922 21:52:51.830273 12751 net.cpp:156] Memory required for data: 10008
I0922 21:52:51.830278 12751 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0922 21:52:51.830291 12751 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0922 21:52:51.830296 12751 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0922 21:52:51.830302 12751 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0922 21:52:51.830312 12751 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0922 21:52:51.830363 12751 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0922 21:52:51.830373 12751 net.cpp:148] Top shape: 1 1 (1)
I0922 21:52:51.830379 12751 net.cpp:148] Top shape: 1 1 (1)
I0922 21:52:51.830382 12751 net.cpp:156] Memory required for data: 10016
I0922 21:52:51.830387 12751 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0922 21:52:51.830400 12751 net.cpp:91] Creating Layer lstm1_x_transform
I0922 21:52:51.830406 12751 net.cpp:425] lstm1_x_transform <- x
I0922 21:52:51.830413 12751 net.cpp:399] lstm1_x_transform -> W_xc_x
I0922 21:52:51.852568 12751 net.cpp:141] Setting up lstm1_x_transform
I0922 21:52:51.852619 12751 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:52:51.852624 12751 net.cpp:156] Memory required for data: 26016
I0922 21:52:51.852651 12751 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0922 21:52:51.852669 12751 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0922 21:52:51.852677 12751 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0922 21:52:51.852687 12751 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0922 21:52:51.852735 12751 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0922 21:52:51.852746 12751 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:52:51.852751 12751 net.cpp:156] Memory required for data: 42016
I0922 21:52:51.852756 12751 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0922 21:52:51.852769 12751 net.cpp:91] Creating Layer lstm1_h_conted_0
I0922 21:52:51.852776 12751 net.cpp:425] lstm1_h_conted_0 <- h_0
I0922 21:52:51.852782 12751 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0922 21:52:51.852789 12751 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0922 21:52:51.852885 12751 net.cpp:141] Setting up lstm1_h_conted_0
I0922 21:52:51.852895 12751 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:52:51.852900 12751 net.cpp:156] Memory required for data: 46016
I0922 21:52:51.852905 12751 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0922 21:52:51.852922 12751 net.cpp:91] Creating Layer lstm1_transform_1
I0922 21:52:51.852927 12751 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0922 21:52:51.852936 12751 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0922 21:52:51.870872 12757 net.cpp:141] Setting up fc6
I0922 21:52:51.870921 12757 net.cpp:148] Top shape: 10 4096 (40960)
I0922 21:52:51.870928 12757 net.cpp:156] Memory required for data: 67782200
I0922 21:52:51.870944 12757 layer_factory.hpp:77] Creating layer relu6
I0922 21:52:51.870965 12757 net.cpp:91] Creating Layer relu6
I0922 21:52:51.870975 12757 net.cpp:425] relu6 <- fc6
I0922 21:52:51.870985 12757 net.cpp:386] relu6 -> fc6 (in-place)
I0922 21:52:51.871351 12757 net.cpp:141] Setting up relu6
I0922 21:52:51.871363 12757 net.cpp:148] Top shape: 10 4096 (40960)
I0922 21:52:51.871369 12757 net.cpp:156] Memory required for data: 67946040
I0922 21:52:51.871374 12757 layer_factory.hpp:77] Creating layer drop6
I0922 21:52:51.871397 12757 net.cpp:91] Creating Layer drop6
I0922 21:52:51.871402 12757 net.cpp:425] drop6 <- fc6
I0922 21:52:51.871412 12757 net.cpp:386] drop6 -> fc6 (in-place)
I0922 21:52:51.871466 12757 net.cpp:141] Setting up drop6
I0922 21:52:51.871479 12757 net.cpp:148] Top shape: 10 4096 (40960)
I0922 21:52:51.871484 12757 net.cpp:156] Memory required for data: 68109880
I0922 21:52:51.871490 12757 layer_factory.hpp:77] Creating layer fc7
I0922 21:52:51.871500 12757 net.cpp:91] Creating Layer fc7
I0922 21:52:51.871505 12757 net.cpp:425] fc7 <- fc6
I0922 21:52:51.871512 12757 net.cpp:399] fc7 -> fc7
I0922 21:52:51.903513 12751 net.cpp:141] Setting up lstm1_transform_1
I0922 21:52:51.903561 12751 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:52:51.903566 12751 net.cpp:156] Memory required for data: 62016
I0922 21:52:51.903590 12751 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0922 21:52:51.903625 12751 net.cpp:91] Creating Layer lstm1_gate_input_1
I0922 21:52:51.903635 12751 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0922 21:52:51.903642 12751 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0922 21:52:51.903655 12751 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0922 21:52:51.903718 12751 net.cpp:141] Setting up lstm1_gate_input_1
I0922 21:52:51.903729 12751 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:52:51.903733 12751 net.cpp:156] Memory required for data: 78016
I0922 21:52:51.903738 12751 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0922 21:52:51.903751 12751 net.cpp:91] Creating Layer lstm1_unit_1
I0922 21:52:51.903756 12751 net.cpp:425] lstm1_unit_1 <- c_0
I0922 21:52:51.903764 12751 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0922 21:52:51.903769 12751 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0922 21:52:51.903779 12751 net.cpp:399] lstm1_unit_1 -> c_1
I0922 21:52:51.903795 12751 net.cpp:399] lstm1_unit_1 -> h_1
I0922 21:52:51.903878 12751 net.cpp:141] Setting up lstm1_unit_1
I0922 21:52:51.903889 12751 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:52:51.903895 12751 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:52:51.903900 12751 net.cpp:156] Memory required for data: 86016
I0922 21:52:51.903905 12751 layer_factory.hpp:77] Creating layer lstm1_
I0922 21:52:51.903914 12751 net.cpp:91] Creating Layer lstm1_
I0922 21:52:51.903919 12751 net.cpp:425] lstm1_ <- c_1
I0922 21:52:51.903929 12751 net.cpp:399] lstm1_ -> c_T
I0922 21:52:51.903962 12751 net.cpp:141] Setting up lstm1_
I0922 21:52:51.903971 12751 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:52:51.903975 12751 net.cpp:156] Memory required for data: 90016
I0922 21:52:51.903980 12751 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0922 21:52:51.903990 12751 net.cpp:91] Creating Layer lstm1_h_concat
I0922 21:52:51.903995 12751 net.cpp:425] lstm1_h_concat <- h_1
I0922 21:52:51.904002 12751 net.cpp:399] lstm1_h_concat -> h
I0922 21:52:51.904042 12751 net.cpp:141] Setting up lstm1_h_concat
I0922 21:52:51.904052 12751 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:52:51.904057 12751 net.cpp:156] Memory required for data: 94016
I0922 21:52:51.904062 12751 layer_factory.hpp:77] Creating layer h_pseudoloss
I0922 21:52:51.904079 12751 net.cpp:91] Creating Layer h_pseudoloss
I0922 21:52:51.904084 12751 net.cpp:425] h_pseudoloss <- h
I0922 21:52:51.904093 12751 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0922 21:52:51.904189 12751 net.cpp:141] Setting up h_pseudoloss
I0922 21:52:51.904203 12751 net.cpp:148] Top shape: (1)
I0922 21:52:51.904208 12751 net.cpp:151]     with loss weight 1
I0922 21:52:51.904245 12751 net.cpp:156] Memory required for data: 94020
I0922 21:52:51.904253 12751 net.cpp:217] h_pseudoloss needs backward computation.
I0922 21:52:51.904258 12751 net.cpp:217] lstm1_h_concat needs backward computation.
I0922 21:52:51.904263 12751 net.cpp:219] lstm1_ does not need backward computation.
I0922 21:52:51.904268 12751 net.cpp:217] lstm1_unit_1 needs backward computation.
I0922 21:52:51.904274 12751 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0922 21:52:51.904279 12751 net.cpp:217] lstm1_transform_1 needs backward computation.
I0922 21:52:51.904285 12751 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0922 21:52:51.904291 12751 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0922 21:52:51.904296 12751 net.cpp:217] lstm1_x_transform needs backward computation.
I0922 21:52:51.904301 12751 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0922 21:52:51.904306 12751 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0922 21:52:51.904312 12751 net.cpp:219] lstm1_ does not need backward computation.
I0922 21:52:51.904316 12751 net.cpp:219] lstm1_ does not need backward computation.
I0922 21:52:51.904320 12751 net.cpp:261] This network produces output c_T
I0922 21:52:51.904325 12751 net.cpp:261] This network produces output h_pseudoloss
I0922 21:52:51.904343 12751 net.cpp:274] Network initialization done.
I0922 21:52:51.904409 12751 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0922 21:52:51.904417 12751 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0922 21:52:51.904422 12751 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0922 21:52:51.904541 12751 net.cpp:141] Setting up lstm1
I0922 21:52:51.904553 12751 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:52:51.904558 12751 net.cpp:156] Memory required for data: 26408
I0922 21:52:51.904572 12751 layer_factory.hpp:77] Creating layer concat
I0922 21:52:51.904582 12751 net.cpp:91] Creating Layer concat
I0922 21:52:51.904588 12751 net.cpp:425] concat <- lstm1
I0922 21:52:51.904595 12751 net.cpp:425] concat <- embedded_input_sentence
I0922 21:52:51.904602 12751 net.cpp:425] concat <- reshaped_stage_indicator
I0922 21:52:51.904608 12751 net.cpp:399] concat -> lstm1_video_sequence
I0922 21:52:51.904644 12751 net.cpp:141] Setting up concat
I0922 21:52:51.904654 12751 net.cpp:148] Top shape: 1 1 1501 (1501)
I0922 21:52:51.904659 12751 net.cpp:156] Memory required for data: 32412
I0922 21:52:51.904664 12751 layer_factory.hpp:77] Creating layer lstm2
I0922 21:52:51.904677 12751 net.cpp:91] Creating Layer lstm2
I0922 21:52:51.904682 12751 net.cpp:425] lstm2 <- lstm1_video_sequence
I0922 21:52:51.904690 12751 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0922 21:52:51.904696 12751 net.cpp:399] lstm2 -> lstm2
I0922 21:52:51.904708 12751 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0922 21:52:51.905005 12751 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0922 21:52:51.905107 12751 layer_factory.hpp:77] Creating layer lstm2_
I0922 21:52:51.905120 12751 net.cpp:91] Creating Layer lstm2_
I0922 21:52:51.905127 12751 net.cpp:399] lstm2_ -> x
I0922 21:52:51.905138 12751 net.cpp:399] lstm2_ -> cont
I0922 21:52:51.905197 12751 net.cpp:141] Setting up lstm2_
I0922 21:52:51.905208 12751 net.cpp:148] Top shape: 1 1 1501 (1501)
I0922 21:52:51.905215 12751 net.cpp:148] Top shape: 1 1 (1)
I0922 21:52:51.905220 12751 net.cpp:156] Memory required for data: 6008
I0922 21:52:51.905225 12751 layer_factory.hpp:77] Creating layer lstm2_
I0922 21:52:51.905236 12751 net.cpp:91] Creating Layer lstm2_
I0922 21:52:51.905243 12751 net.cpp:399] lstm2_ -> c_0
I0922 21:52:51.905253 12751 net.cpp:399] lstm2_ -> h_0
I0922 21:52:51.905308 12751 net.cpp:141] Setting up lstm2_
I0922 21:52:51.905318 12751 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:52:51.905324 12751 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:52:51.905328 12751 net.cpp:156] Memory required for data: 14008
I0922 21:52:51.905333 12751 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0922 21:52:51.905342 12751 net.cpp:91] Creating Layer lstm2_cont_slice
I0922 21:52:51.905347 12751 net.cpp:425] lstm2_cont_slice <- cont
I0922 21:52:51.905355 12751 net.cpp:399] lstm2_cont_slice -> cont_1
I0922 21:52:51.905395 12751 net.cpp:141] Setting up lstm2_cont_slice
I0922 21:52:51.905403 12751 net.cpp:148] Top shape: 1 1 (1)
I0922 21:52:51.905408 12751 net.cpp:156] Memory required for data: 14012
I0922 21:52:51.905413 12751 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0922 21:52:51.905421 12751 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0922 21:52:51.905426 12751 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0922 21:52:51.905434 12751 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0922 21:52:51.905443 12751 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0922 21:52:51.905493 12751 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0922 21:52:51.905504 12751 net.cpp:148] Top shape: 1 1 (1)
I0922 21:52:51.905510 12751 net.cpp:148] Top shape: 1 1 (1)
I0922 21:52:51.905515 12751 net.cpp:156] Memory required for data: 14020
I0922 21:52:51.905519 12751 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0922 21:52:51.905530 12751 net.cpp:91] Creating Layer lstm2_x_transform
I0922 21:52:51.905535 12751 net.cpp:425] lstm2_x_transform <- x
I0922 21:52:51.905545 12751 net.cpp:399] lstm2_x_transform -> W_xc_x
I0922 21:52:51.922081 12757 net.cpp:141] Setting up fc7
I0922 21:52:51.922128 12757 net.cpp:148] Top shape: 10 4096 (40960)
I0922 21:52:51.922134 12757 net.cpp:156] Memory required for data: 68273720
I0922 21:52:51.922150 12757 layer_factory.hpp:77] Creating layer relu7
I0922 21:52:51.922173 12757 net.cpp:91] Creating Layer relu7
I0922 21:52:51.922183 12757 net.cpp:425] relu7 <- fc7
I0922 21:52:51.922194 12757 net.cpp:386] relu7 -> fc7 (in-place)
I0922 21:52:51.922850 12757 net.cpp:141] Setting up relu7
I0922 21:52:51.922864 12757 net.cpp:148] Top shape: 10 4096 (40960)
I0922 21:52:51.922869 12757 net.cpp:156] Memory required for data: 68437560
I0922 21:52:51.922875 12757 layer_factory.hpp:77] Creating layer drop7
I0922 21:52:51.922891 12757 net.cpp:91] Creating Layer drop7
I0922 21:52:51.922897 12757 net.cpp:425] drop7 <- fc7
I0922 21:52:51.922907 12757 net.cpp:386] drop7 -> fc7 (in-place)
I0922 21:52:51.922950 12757 net.cpp:141] Setting up drop7
I0922 21:52:51.922958 12757 net.cpp:148] Top shape: 10 4096 (40960)
I0922 21:52:51.922963 12757 net.cpp:156] Memory required for data: 68601400
I0922 21:52:51.922968 12757 layer_factory.hpp:77] Creating layer fc8
I0922 21:52:51.922986 12757 net.cpp:91] Creating Layer fc8
I0922 21:52:51.922991 12757 net.cpp:425] fc8 <- fc7
I0922 21:52:51.922998 12757 net.cpp:399] fc8 -> fc8
I0922 21:52:51.936159 12757 net.cpp:141] Setting up fc8
I0922 21:52:51.936205 12757 net.cpp:148] Top shape: 10 1000 (10000)
I0922 21:52:51.936211 12757 net.cpp:156] Memory required for data: 68641400
I0922 21:52:51.936226 12757 layer_factory.hpp:77] Creating layer prob
I0922 21:52:51.936245 12757 net.cpp:91] Creating Layer prob
I0922 21:52:51.936254 12757 net.cpp:425] prob <- fc8
I0922 21:52:51.936264 12757 net.cpp:399] prob -> prob
I0922 21:52:51.936730 12757 net.cpp:141] Setting up prob
I0922 21:52:51.936744 12757 net.cpp:148] Top shape: 10 1000 (10000)
I0922 21:52:51.936749 12757 net.cpp:156] Memory required for data: 68681400
I0922 21:52:51.936756 12757 net.cpp:219] prob does not need backward computation.
I0922 21:52:51.936761 12757 net.cpp:219] fc8 does not need backward computation.
I0922 21:52:51.936769 12757 net.cpp:219] drop7 does not need backward computation.
I0922 21:52:51.936775 12757 net.cpp:219] relu7 does not need backward computation.
I0922 21:52:51.936779 12757 net.cpp:219] fc7 does not need backward computation.
I0922 21:52:51.936784 12757 net.cpp:219] drop6 does not need backward computation.
I0922 21:52:51.936789 12757 net.cpp:219] relu6 does not need backward computation.
I0922 21:52:51.936794 12757 net.cpp:219] fc6 does not need backward computation.
I0922 21:52:51.936797 12757 net.cpp:219] pool5 does not need backward computation.
I0922 21:52:51.936802 12757 net.cpp:219] relu5 does not need backward computation.
I0922 21:52:51.936807 12757 net.cpp:219] conv5 does not need backward computation.
I0922 21:52:51.936811 12757 net.cpp:219] relu4 does not need backward computation.
I0922 21:52:51.936816 12757 net.cpp:219] conv4 does not need backward computation.
I0922 21:52:51.936821 12757 net.cpp:219] relu3 does not need backward computation.
I0922 21:52:51.936825 12757 net.cpp:219] conv3 does not need backward computation.
I0922 21:52:51.936831 12757 net.cpp:219] norm2 does not need backward computation.
I0922 21:52:51.936836 12757 net.cpp:219] pool2 does not need backward computation.
I0922 21:52:51.936841 12757 net.cpp:219] relu2 does not need backward computation.
I0922 21:52:51.936846 12757 net.cpp:219] conv2 does not need backward computation.
I0922 21:52:51.936851 12757 net.cpp:219] norm1 does not need backward computation.
I0922 21:52:51.936856 12757 net.cpp:219] pool1 does not need backward computation.
I0922 21:52:51.936859 12757 net.cpp:219] relu1 does not need backward computation.
I0922 21:52:51.936864 12757 net.cpp:219] conv1 does not need backward computation.
I0922 21:52:51.936869 12757 net.cpp:219] data does not need backward computation.
I0922 21:52:51.936873 12757 net.cpp:261] This network produces output prob
I0922 21:52:51.936893 12757 net.cpp:274] Network initialization done.
I0922 21:52:51.970595 12751 net.cpp:141] Setting up lstm2_x_transform
I0922 21:52:51.970633 12751 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:52:51.970639 12751 net.cpp:156] Memory required for data: 30020
I0922 21:52:51.970660 12751 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0922 21:52:51.970679 12751 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0922 21:52:51.970685 12751 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0922 21:52:51.970695 12751 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0922 21:52:51.970742 12751 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0922 21:52:51.970753 12751 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:52:51.970758 12751 net.cpp:156] Memory required for data: 46020
I0922 21:52:51.970763 12751 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0922 21:52:51.970778 12751 net.cpp:91] Creating Layer lstm2_h_conted_0
I0922 21:52:51.970784 12751 net.cpp:425] lstm2_h_conted_0 <- h_0
I0922 21:52:51.970790 12751 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0922 21:52:51.970798 12751 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0922 21:52:51.970901 12751 net.cpp:141] Setting up lstm2_h_conted_0
I0922 21:52:51.970911 12751 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:52:51.970916 12751 net.cpp:156] Memory required for data: 50020
I0922 21:52:51.970921 12751 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0922 21:52:51.970935 12751 net.cpp:91] Creating Layer lstm2_transform_1
I0922 21:52:51.970940 12751 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0922 21:52:51.970949 12751 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0922 21:52:52.014045 12751 net.cpp:141] Setting up lstm2_transform_1
I0922 21:52:52.014092 12751 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:52:52.014099 12751 net.cpp:156] Memory required for data: 66020
I0922 21:52:52.014122 12751 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0922 21:52:52.014147 12751 net.cpp:91] Creating Layer lstm2_gate_input_1
I0922 21:52:52.014155 12751 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0922 21:52:52.014164 12751 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0922 21:52:52.014173 12751 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0922 21:52:52.014226 12751 net.cpp:141] Setting up lstm2_gate_input_1
I0922 21:52:52.014236 12751 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:52:52.014241 12751 net.cpp:156] Memory required for data: 82020
I0922 21:52:52.014246 12751 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0922 21:52:52.014256 12751 net.cpp:91] Creating Layer lstm2_unit_1
I0922 21:52:52.014261 12751 net.cpp:425] lstm2_unit_1 <- c_0
I0922 21:52:52.014266 12751 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0922 21:52:52.014272 12751 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0922 21:52:52.014279 12751 net.cpp:399] lstm2_unit_1 -> c_1
I0922 21:52:52.014288 12751 net.cpp:399] lstm2_unit_1 -> h_1
I0922 21:52:52.014358 12751 net.cpp:141] Setting up lstm2_unit_1
I0922 21:52:52.014366 12751 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:52:52.014374 12751 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:52:52.014377 12751 net.cpp:156] Memory required for data: 90020
I0922 21:52:52.014382 12751 layer_factory.hpp:77] Creating layer lstm2_
I0922 21:52:52.014394 12751 net.cpp:91] Creating Layer lstm2_
I0922 21:52:52.014399 12751 net.cpp:425] lstm2_ <- c_1
I0922 21:52:52.014407 12751 net.cpp:399] lstm2_ -> c_T
I0922 21:52:52.014441 12751 net.cpp:141] Setting up lstm2_
I0922 21:52:52.014449 12751 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:52:52.014453 12751 net.cpp:156] Memory required for data: 94020
I0922 21:52:52.014458 12751 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0922 21:52:52.014472 12751 net.cpp:91] Creating Layer lstm2_h_concat
I0922 21:52:52.014477 12751 net.cpp:425] lstm2_h_concat <- h_1
I0922 21:52:52.014487 12751 net.cpp:399] lstm2_h_concat -> h
I0922 21:52:52.014528 12751 net.cpp:141] Setting up lstm2_h_concat
I0922 21:52:52.014540 12751 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:52:52.014544 12751 net.cpp:156] Memory required for data: 98020
I0922 21:52:52.014549 12751 layer_factory.hpp:77] Creating layer h_pseudoloss
I0922 21:52:52.014561 12751 net.cpp:91] Creating Layer h_pseudoloss
I0922 21:52:52.014566 12751 net.cpp:425] h_pseudoloss <- h
I0922 21:52:52.014574 12751 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0922 21:52:52.014686 12751 net.cpp:141] Setting up h_pseudoloss
I0922 21:52:52.014699 12751 net.cpp:148] Top shape: (1)
I0922 21:52:52.014703 12751 net.cpp:151]     with loss weight 1
I0922 21:52:52.014724 12751 net.cpp:156] Memory required for data: 98024
I0922 21:52:52.014732 12751 net.cpp:217] h_pseudoloss needs backward computation.
I0922 21:52:52.014737 12751 net.cpp:217] lstm2_h_concat needs backward computation.
I0922 21:52:52.014742 12751 net.cpp:219] lstm2_ does not need backward computation.
I0922 21:52:52.014747 12751 net.cpp:217] lstm2_unit_1 needs backward computation.
I0922 21:52:52.014753 12751 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0922 21:52:52.014758 12751 net.cpp:217] lstm2_transform_1 needs backward computation.
I0922 21:52:52.014763 12751 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0922 21:52:52.014770 12751 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0922 21:52:52.014775 12751 net.cpp:217] lstm2_x_transform needs backward computation.
I0922 21:52:52.014780 12751 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0922 21:52:52.014786 12751 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0922 21:52:52.014791 12751 net.cpp:219] lstm2_ does not need backward computation.
I0922 21:52:52.014794 12751 net.cpp:219] lstm2_ does not need backward computation.
I0922 21:52:52.014798 12751 net.cpp:261] This network produces output c_T
I0922 21:52:52.014803 12751 net.cpp:261] This network produces output h_pseudoloss
I0922 21:52:52.014822 12751 net.cpp:274] Network initialization done.
I0922 21:52:52.014878 12751 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0922 21:52:52.014884 12751 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0922 21:52:52.014889 12751 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0922 21:52:52.015004 12751 net.cpp:141] Setting up lstm2
I0922 21:52:52.015017 12751 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:52:52.015030 12751 net.cpp:156] Memory required for data: 36412
I0922 21:52:52.015045 12751 layer_factory.hpp:77] Creating layer predict
I0922 21:52:52.015061 12751 net.cpp:91] Creating Layer predict
I0922 21:52:52.015067 12751 net.cpp:425] predict <- lstm2
I0922 21:52:52.015075 12751 net.cpp:399] predict -> predict
I0922 21:52:52.507086 12751 net.cpp:141] Setting up predict
I0922 21:52:52.507135 12751 net.cpp:148] Top shape: 1 1 46168 (46168)
I0922 21:52:52.507143 12751 net.cpp:156] Memory required for data: 221084
I0922 21:52:52.507158 12751 layer_factory.hpp:77] Creating layer probs
I0922 21:52:52.507179 12751 net.cpp:91] Creating Layer probs
I0922 21:52:52.507189 12751 net.cpp:425] probs <- predict
I0922 21:52:52.507200 12751 net.cpp:399] probs -> probs
I0922 21:52:52.508007 12751 net.cpp:141] Setting up probs
I0922 21:52:52.508021 12751 net.cpp:148] Top shape: 1 1 46168 (46168)
I0922 21:52:52.508026 12751 net.cpp:156] Memory required for data: 405756
I0922 21:52:52.508033 12751 net.cpp:219] probs does not need backward computation.
I0922 21:52:52.508039 12751 net.cpp:219] predict does not need backward computation.
I0922 21:52:52.508045 12751 net.cpp:219] lstm2 does not need backward computation.
I0922 21:52:52.508051 12751 net.cpp:219] concat does not need backward computation.
I0922 21:52:52.508057 12751 net.cpp:219] lstm1 does not need backward computation.
I0922 21:52:52.508064 12751 net.cpp:219] embedding does not need backward computation.
I0922 21:52:52.508069 12751 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0922 21:52:52.508074 12751 net.cpp:219] reshape_frames does not need backward computation.
I0922 21:52:52.508079 12751 net.cpp:219] embed_encoder does not need backward computation.
I0922 21:52:52.508083 12751 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0922 21:52:52.508090 12751 net.cpp:219] input does not need backward computation.
I0922 21:52:52.508093 12751 net.cpp:261] This network produces output probs
I0922 21:52:52.508116 12751 net.cpp:274] Network initialization done.
I0922 21:52:57.338517 12757 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /home/peifeng/work/run/storm102/data/workers/c5710ece-4852-4f0b-a332-5e9832c56081/tmp/cvld4391536668528237162/bvlc_reference_caffenet.caffemodel
I0922 21:52:57.338572 12757 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0922 21:52:57.338579 12757 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0922 21:52:57.338584 12757 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /home/peifeng/work/run/storm102/data/workers/c5710ece-4852-4f0b-a332-5e9832c56081/tmp/cvld4391536668528237162/bvlc_reference_caffenet.caffemodel
I0922 21:52:57.438989 12751 net.cpp:752] Ignoring source layer data
I0922 21:52:57.439049 12751 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0922 21:52:57.439059 12751 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0922 21:52:57.515651 12751 net.cpp:752] Ignoring source layer cross_entropy_loss
I0922 21:52:57.749344 12757 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0922 21:52:57.802275 12757 net.cpp:752] Ignoring source layer loss
Loading the model + trained: 5509.34ms
Using cv::Size and some other stuff: 0.132ms
Loading the mean file: 11482.2ms
TIMERTIMER 306298117
TIMERTIMER 245245929
TIMERTIMER 268292789
TIMERTIMER 225911486
TIMERTIMER 246260726
TIMERTIMER 224441892
TIMERTIMER 237518168
TIMERTIMER 235708197
TIMERTIMER 194546619
TIMERTIMER 186822574
TIMERTIMER 199405887
TIMERTIMER 189141535
TIMERTIMER 188977287
TIMERTIMER 193524326
TIMERTIMER 188053458
TIMERTIMER 187933887
TIMERTIMER 190469691
TIMERTIMER 195052076
TIMERTIMER 193311762
TIMERTIMER 196391945
TIMERTIMER 188502891
TIMERTIMER 187635826
TIMERTIMER 194630950
TIMERTIMER 192854336
TIMERTIMER 190205270
TIMERTIMER 193545636
TIMERTIMER 194565974
TIMERTIMER 194400686
TIMERTIMER 200446755
TIMERTIMER 188862839
TIMERTIMER 190408719
TIMERTIMER 189997748
