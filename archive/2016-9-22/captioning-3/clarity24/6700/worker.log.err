SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/peifeng/tools/storm102/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/peifeng/work/run/storm102/data/supervisor/stormdist/captioning-1-1474595005/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /home/peifeng/work/run/storm102/data/workers/e258c6fb-7c0a-4ffe-939e-10fca7f7905a/tmp/cvld1075256385114744262/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0922 21:44:04.860119 10720 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/e258c6fb-7c0a-4ffe-939e-10fca7f7905a/tmp/cvld1075256385114744262/s2vt.words_to_preds.prototxt
I0922 21:44:04.860246 10720 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0922 21:44:04.860255 10720 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0922 21:44:04.860471 10720 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0922 21:44:04.860476 10726 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0922 21:44:04.860592 10720 layer_factory.hpp:77] Creating layer input
I0922 21:44:04.860599 10726 layer_factory.hpp:77] Creating layer data
I0922 21:44:04.860615 10726 net.cpp:91] Creating Layer data
I0922 21:44:04.860615 10720 net.cpp:91] Creating Layer input
I0922 21:44:04.860632 10726 net.cpp:399] data -> data
I0922 21:44:04.860635 10720 net.cpp:399] input -> frames_fc7
I0922 21:44:04.860664 10720 net.cpp:399] input -> cont_sentence
I0922 21:44:04.860677 10720 net.cpp:399] input -> input_sentence
I0922 21:44:04.860687 10720 net.cpp:399] input -> stage_indicator
I0922 21:44:05.392060 10726 net.cpp:141] Setting up data
I0922 21:44:05.392122 10720 net.cpp:141] Setting up input
I0922 21:44:05.392151 10720 net.cpp:148] Top shape: 1 4096 (4096)
I0922 21:44:05.392153 10726 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0922 21:44:05.392159 10720 net.cpp:148] Top shape: 1 1 (1)
I0922 21:44:05.392165 10720 net.cpp:148] Top shape: 1 1 (1)
I0922 21:44:05.392171 10720 net.cpp:148] Top shape: 1 1 (1)
I0922 21:44:05.392164 10726 net.cpp:156] Memory required for data: 6183480
I0922 21:44:05.392176 10720 net.cpp:156] Memory required for data: 16396
I0922 21:44:05.392199 10720 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0922 21:44:05.392200 10726 layer_factory.hpp:77] Creating layer conv1
I0922 21:44:05.392225 10720 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0922 21:44:05.392235 10720 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0922 21:44:05.392237 10726 net.cpp:91] Creating Layer conv1
I0922 21:44:05.392248 10726 net.cpp:425] conv1 <- data
I0922 21:44:05.392261 10720 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0922 21:44:05.392266 10726 net.cpp:399] conv1 -> conv1
I0922 21:44:05.392274 10720 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0922 21:44:05.392320 10720 net.cpp:141] Setting up cont_sentence_input_1_split
I0922 21:44:05.392330 10720 net.cpp:148] Top shape: 1 1 (1)
I0922 21:44:05.392336 10720 net.cpp:148] Top shape: 1 1 (1)
I0922 21:44:05.392340 10720 net.cpp:156] Memory required for data: 16404
I0922 21:44:05.392345 10720 layer_factory.hpp:77] Creating layer embed_encoder
I0922 21:44:05.392364 10720 net.cpp:91] Creating Layer embed_encoder
I0922 21:44:05.392370 10720 net.cpp:425] embed_encoder <- frames_fc7
I0922 21:44:05.392379 10720 net.cpp:399] embed_encoder -> embedded_in_frames
I0922 21:44:05.414940 10720 net.cpp:141] Setting up embed_encoder
I0922 21:44:05.414990 10720 net.cpp:148] Top shape: 1 500 (500)
I0922 21:44:05.414999 10720 net.cpp:156] Memory required for data: 18404
I0922 21:44:05.415032 10720 layer_factory.hpp:77] Creating layer reshape_frames
I0922 21:44:05.415060 10720 net.cpp:91] Creating Layer reshape_frames
I0922 21:44:05.415071 10720 net.cpp:425] reshape_frames <- embedded_in_frames
I0922 21:44:05.415086 10720 net.cpp:399] reshape_frames -> embedded_input_frames
I0922 21:44:05.416203 10720 net.cpp:141] Setting up reshape_frames
I0922 21:44:05.416220 10720 net.cpp:148] Top shape: 1 1 500 (500)
I0922 21:44:05.416226 10720 net.cpp:156] Memory required for data: 20404
I0922 21:44:05.416231 10720 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0922 21:44:05.416244 10720 net.cpp:91] Creating Layer reshape_stage_indicator
I0922 21:44:05.416250 10720 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0922 21:44:05.416260 10720 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0922 21:44:05.419539 10720 net.cpp:141] Setting up reshape_stage_indicator
I0922 21:44:05.419559 10720 net.cpp:148] Top shape: 1 1 1 (1)
I0922 21:44:05.419565 10720 net.cpp:156] Memory required for data: 20408
I0922 21:44:05.419570 10720 layer_factory.hpp:77] Creating layer embedding
I0922 21:44:05.419584 10720 net.cpp:91] Creating Layer embedding
I0922 21:44:05.419589 10720 net.cpp:425] embedding <- input_sentence
I0922 21:44:05.419598 10720 net.cpp:399] embedding -> embedded_input_sentence
I0922 21:44:05.641342 10726 net.cpp:141] Setting up conv1
I0922 21:44:05.641391 10726 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0922 21:44:05.641397 10726 net.cpp:156] Memory required for data: 17799480
I0922 21:44:05.641422 10726 layer_factory.hpp:77] Creating layer relu1
I0922 21:44:05.641440 10726 net.cpp:91] Creating Layer relu1
I0922 21:44:05.641446 10726 net.cpp:425] relu1 <- conv1
I0922 21:44:05.641455 10726 net.cpp:386] relu1 -> conv1 (in-place)
I0922 21:44:05.641860 10726 net.cpp:141] Setting up relu1
I0922 21:44:05.641871 10726 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0922 21:44:05.641876 10726 net.cpp:156] Memory required for data: 29415480
I0922 21:44:05.641882 10726 layer_factory.hpp:77] Creating layer pool1
I0922 21:44:05.641897 10726 net.cpp:91] Creating Layer pool1
I0922 21:44:05.641902 10726 net.cpp:425] pool1 <- conv1
I0922 21:44:05.641911 10726 net.cpp:399] pool1 -> pool1
I0922 21:44:05.641980 10726 net.cpp:141] Setting up pool1
I0922 21:44:05.641993 10726 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0922 21:44:05.641996 10726 net.cpp:156] Memory required for data: 32214840
I0922 21:44:05.642004 10726 layer_factory.hpp:77] Creating layer norm1
I0922 21:44:05.642019 10726 net.cpp:91] Creating Layer norm1
I0922 21:44:05.642024 10726 net.cpp:425] norm1 <- pool1
I0922 21:44:05.642033 10726 net.cpp:399] norm1 -> norm1
I0922 21:44:05.642295 10726 net.cpp:141] Setting up norm1
I0922 21:44:05.642307 10726 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0922 21:44:05.642312 10726 net.cpp:156] Memory required for data: 35014200
I0922 21:44:05.642316 10726 layer_factory.hpp:77] Creating layer conv2
I0922 21:44:05.642333 10726 net.cpp:91] Creating Layer conv2
I0922 21:44:05.642338 10726 net.cpp:425] conv2 <- norm1
I0922 21:44:05.642348 10726 net.cpp:399] conv2 -> conv2
I0922 21:44:05.645488 10726 net.cpp:141] Setting up conv2
I0922 21:44:05.645508 10726 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0922 21:44:05.645514 10726 net.cpp:156] Memory required for data: 42479160
I0922 21:44:05.645525 10726 layer_factory.hpp:77] Creating layer relu2
I0922 21:44:05.645536 10726 net.cpp:91] Creating Layer relu2
I0922 21:44:05.645542 10726 net.cpp:425] relu2 <- conv2
I0922 21:44:05.645548 10726 net.cpp:386] relu2 -> conv2 (in-place)
I0922 21:44:05.645941 10726 net.cpp:141] Setting up relu2
I0922 21:44:05.645954 10726 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0922 21:44:05.645959 10726 net.cpp:156] Memory required for data: 49944120
I0922 21:44:05.645964 10726 layer_factory.hpp:77] Creating layer pool2
I0922 21:44:05.645972 10726 net.cpp:91] Creating Layer pool2
I0922 21:44:05.645977 10726 net.cpp:425] pool2 <- conv2
I0922 21:44:05.645987 10726 net.cpp:399] pool2 -> pool2
I0922 21:44:05.646039 10726 net.cpp:141] Setting up pool2
I0922 21:44:05.646047 10726 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0922 21:44:05.646052 10726 net.cpp:156] Memory required for data: 51674680
I0922 21:44:05.646056 10726 layer_factory.hpp:77] Creating layer norm2
I0922 21:44:05.646070 10726 net.cpp:91] Creating Layer norm2
I0922 21:44:05.646075 10726 net.cpp:425] norm2 <- pool2
I0922 21:44:05.646083 10726 net.cpp:399] norm2 -> norm2
I0922 21:44:05.646332 10726 net.cpp:141] Setting up norm2
I0922 21:44:05.646344 10726 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0922 21:44:05.646349 10726 net.cpp:156] Memory required for data: 53405240
I0922 21:44:05.646356 10726 layer_factory.hpp:77] Creating layer conv3
I0922 21:44:05.646370 10726 net.cpp:91] Creating Layer conv3
I0922 21:44:05.646376 10726 net.cpp:425] conv3 <- norm2
I0922 21:44:05.646385 10726 net.cpp:399] conv3 -> conv3
I0922 21:44:05.649863 10726 net.cpp:141] Setting up conv3
I0922 21:44:05.649883 10726 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0922 21:44:05.649889 10726 net.cpp:156] Memory required for data: 56001080
I0922 21:44:05.649901 10726 layer_factory.hpp:77] Creating layer relu3
I0922 21:44:05.649914 10726 net.cpp:91] Creating Layer relu3
I0922 21:44:05.649920 10726 net.cpp:425] relu3 <- conv3
I0922 21:44:05.649927 10726 net.cpp:386] relu3 -> conv3 (in-place)
I0922 21:44:05.650148 10726 net.cpp:141] Setting up relu3
I0922 21:44:05.650159 10726 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0922 21:44:05.650164 10726 net.cpp:156] Memory required for data: 58596920
I0922 21:44:05.650169 10726 layer_factory.hpp:77] Creating layer conv4
I0922 21:44:05.650182 10726 net.cpp:91] Creating Layer conv4
I0922 21:44:05.650187 10726 net.cpp:425] conv4 <- conv3
I0922 21:44:05.650194 10726 net.cpp:399] conv4 -> conv4
I0922 21:44:05.654146 10726 net.cpp:141] Setting up conv4
I0922 21:44:05.654172 10726 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0922 21:44:05.654177 10726 net.cpp:156] Memory required for data: 61192760
I0922 21:44:05.654187 10726 layer_factory.hpp:77] Creating layer relu4
I0922 21:44:05.654202 10726 net.cpp:91] Creating Layer relu4
I0922 21:44:05.654208 10726 net.cpp:425] relu4 <- conv4
I0922 21:44:05.654214 10726 net.cpp:386] relu4 -> conv4 (in-place)
I0922 21:44:05.654598 10726 net.cpp:141] Setting up relu4
I0922 21:44:05.654610 10726 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0922 21:44:05.654615 10726 net.cpp:156] Memory required for data: 63788600
I0922 21:44:05.654621 10726 layer_factory.hpp:77] Creating layer conv5
I0922 21:44:05.654634 10726 net.cpp:91] Creating Layer conv5
I0922 21:44:05.654640 10726 net.cpp:425] conv5 <- conv4
I0922 21:44:05.654647 10726 net.cpp:399] conv5 -> conv5
I0922 21:44:05.658143 10726 net.cpp:141] Setting up conv5
I0922 21:44:05.658161 10726 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0922 21:44:05.658169 10726 net.cpp:156] Memory required for data: 65519160
I0922 21:44:05.658182 10726 layer_factory.hpp:77] Creating layer relu5
I0922 21:44:05.658190 10726 net.cpp:91] Creating Layer relu5
I0922 21:44:05.658195 10726 net.cpp:425] relu5 <- conv5
I0922 21:44:05.658202 10726 net.cpp:386] relu5 -> conv5 (in-place)
I0922 21:44:05.658591 10726 net.cpp:141] Setting up relu5
I0922 21:44:05.658602 10726 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0922 21:44:05.658607 10726 net.cpp:156] Memory required for data: 67249720
I0922 21:44:05.658612 10726 layer_factory.hpp:77] Creating layer pool5
I0922 21:44:05.658622 10726 net.cpp:91] Creating Layer pool5
I0922 21:44:05.658627 10726 net.cpp:425] pool5 <- conv5
I0922 21:44:05.658633 10726 net.cpp:399] pool5 -> pool5
I0922 21:44:05.658694 10726 net.cpp:141] Setting up pool5
I0922 21:44:05.658704 10726 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0922 21:44:05.658709 10726 net.cpp:156] Memory required for data: 67618360
I0922 21:44:05.658712 10726 layer_factory.hpp:77] Creating layer fc6
I0922 21:44:05.658730 10726 net.cpp:91] Creating Layer fc6
I0922 21:44:05.658735 10726 net.cpp:425] fc6 <- pool5
I0922 21:44:05.658741 10726 net.cpp:399] fc6 -> fc6
I0922 21:44:05.726533 10720 net.cpp:141] Setting up embedding
I0922 21:44:05.726586 10720 net.cpp:148] Top shape: 1 1 500 (500)
I0922 21:44:05.726594 10720 net.cpp:156] Memory required for data: 22408
I0922 21:44:05.726616 10720 layer_factory.hpp:77] Creating layer lstm1
I0922 21:44:05.726642 10720 net.cpp:91] Creating Layer lstm1
I0922 21:44:05.726652 10720 net.cpp:425] lstm1 <- embedded_input_frames
I0922 21:44:05.726662 10720 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0922 21:44:05.726675 10720 net.cpp:399] lstm1 -> lstm1
I0922 21:44:05.726717 10720 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0922 21:44:05.727205 10720 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0922 21:44:05.727334 10720 layer_factory.hpp:77] Creating layer lstm1_
I0922 21:44:05.727352 10720 net.cpp:91] Creating Layer lstm1_
I0922 21:44:05.727360 10720 net.cpp:399] lstm1_ -> x
I0922 21:44:05.727376 10720 net.cpp:399] lstm1_ -> cont
I0922 21:44:05.727463 10720 net.cpp:141] Setting up lstm1_
I0922 21:44:05.727478 10720 net.cpp:148] Top shape: 1 1 500 (500)
I0922 21:44:05.727486 10720 net.cpp:148] Top shape: 1 1 (1)
I0922 21:44:05.727491 10720 net.cpp:156] Memory required for data: 2004
I0922 21:44:05.727499 10720 layer_factory.hpp:77] Creating layer lstm1_
I0922 21:44:05.727515 10720 net.cpp:91] Creating Layer lstm1_
I0922 21:44:05.727525 10720 net.cpp:399] lstm1_ -> c_0
I0922 21:44:05.727538 10720 net.cpp:399] lstm1_ -> h_0
I0922 21:44:05.727613 10720 net.cpp:141] Setting up lstm1_
I0922 21:44:05.727627 10720 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:44:05.727635 10720 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:44:05.727640 10720 net.cpp:156] Memory required for data: 10004
I0922 21:44:05.727648 10720 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0922 21:44:05.727659 10720 net.cpp:91] Creating Layer lstm1_cont_slice
I0922 21:44:05.727666 10720 net.cpp:425] lstm1_cont_slice <- cont
I0922 21:44:05.727679 10720 net.cpp:399] lstm1_cont_slice -> cont_1
I0922 21:44:05.727725 10720 net.cpp:141] Setting up lstm1_cont_slice
I0922 21:44:05.727737 10720 net.cpp:148] Top shape: 1 1 (1)
I0922 21:44:05.727743 10720 net.cpp:156] Memory required for data: 10008
I0922 21:44:05.727749 10720 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0922 21:44:05.727766 10720 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0922 21:44:05.727772 10720 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0922 21:44:05.727782 10720 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0922 21:44:05.727798 10720 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0922 21:44:05.727864 10720 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0922 21:44:05.727875 10720 net.cpp:148] Top shape: 1 1 (1)
I0922 21:44:05.727883 10720 net.cpp:148] Top shape: 1 1 (1)
I0922 21:44:05.727890 10720 net.cpp:156] Memory required for data: 10016
I0922 21:44:05.727895 10720 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0922 21:44:05.727911 10720 net.cpp:91] Creating Layer lstm1_x_transform
I0922 21:44:05.727918 10720 net.cpp:425] lstm1_x_transform <- x
I0922 21:44:05.727929 10720 net.cpp:399] lstm1_x_transform -> W_xc_x
I0922 21:44:05.754007 10720 net.cpp:141] Setting up lstm1_x_transform
I0922 21:44:05.754040 10720 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:44:05.754047 10720 net.cpp:156] Memory required for data: 26016
I0922 21:44:05.754065 10720 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0922 21:44:05.754081 10720 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0922 21:44:05.754086 10720 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0922 21:44:05.754096 10720 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0922 21:44:05.754143 10720 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0922 21:44:05.754158 10720 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:44:05.754163 10720 net.cpp:156] Memory required for data: 42016
I0922 21:44:05.754168 10720 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0922 21:44:05.754185 10720 net.cpp:91] Creating Layer lstm1_h_conted_0
I0922 21:44:05.754191 10720 net.cpp:425] lstm1_h_conted_0 <- h_0
I0922 21:44:05.754199 10720 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0922 21:44:05.754207 10720 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0922 21:44:05.754312 10720 net.cpp:141] Setting up lstm1_h_conted_0
I0922 21:44:05.754323 10720 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:44:05.754328 10720 net.cpp:156] Memory required for data: 46016
I0922 21:44:05.754334 10720 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0922 21:44:05.754351 10720 net.cpp:91] Creating Layer lstm1_transform_1
I0922 21:44:05.754357 10720 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0922 21:44:05.754367 10720 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0922 21:44:05.764643 10726 net.cpp:141] Setting up fc6
I0922 21:44:05.764700 10726 net.cpp:148] Top shape: 10 4096 (40960)
I0922 21:44:05.764708 10726 net.cpp:156] Memory required for data: 67782200
I0922 21:44:05.764721 10726 layer_factory.hpp:77] Creating layer relu6
I0922 21:44:05.764739 10726 net.cpp:91] Creating Layer relu6
I0922 21:44:05.764746 10726 net.cpp:425] relu6 <- fc6
I0922 21:44:05.764758 10726 net.cpp:386] relu6 -> fc6 (in-place)
I0922 21:44:05.765100 10726 net.cpp:141] Setting up relu6
I0922 21:44:05.765111 10726 net.cpp:148] Top shape: 10 4096 (40960)
I0922 21:44:05.765116 10726 net.cpp:156] Memory required for data: 67946040
I0922 21:44:05.765125 10726 layer_factory.hpp:77] Creating layer drop6
I0922 21:44:05.765138 10726 net.cpp:91] Creating Layer drop6
I0922 21:44:05.765143 10726 net.cpp:425] drop6 <- fc6
I0922 21:44:05.765151 10726 net.cpp:386] drop6 -> fc6 (in-place)
I0922 21:44:05.765327 10726 net.cpp:141] Setting up drop6
I0922 21:44:05.765339 10726 net.cpp:148] Top shape: 10 4096 (40960)
I0922 21:44:05.765343 10726 net.cpp:156] Memory required for data: 68109880
I0922 21:44:05.765348 10726 layer_factory.hpp:77] Creating layer fc7
I0922 21:44:05.765357 10726 net.cpp:91] Creating Layer fc7
I0922 21:44:05.765362 10726 net.cpp:425] fc7 <- fc6
I0922 21:44:05.765372 10726 net.cpp:399] fc7 -> fc7
I0922 21:44:05.798023 10720 net.cpp:141] Setting up lstm1_transform_1
I0922 21:44:05.798074 10720 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:44:05.798080 10720 net.cpp:156] Memory required for data: 62016
I0922 21:44:05.798105 10720 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0922 21:44:05.798135 10720 net.cpp:91] Creating Layer lstm1_gate_input_1
I0922 21:44:05.798142 10720 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0922 21:44:05.798161 10720 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0922 21:44:05.798169 10720 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0922 21:44:05.798231 10720 net.cpp:141] Setting up lstm1_gate_input_1
I0922 21:44:05.798241 10720 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:44:05.798246 10720 net.cpp:156] Memory required for data: 78016
I0922 21:44:05.798251 10720 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0922 21:44:05.798267 10720 net.cpp:91] Creating Layer lstm1_unit_1
I0922 21:44:05.798274 10720 net.cpp:425] lstm1_unit_1 <- c_0
I0922 21:44:05.798280 10720 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0922 21:44:05.798285 10720 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0922 21:44:05.798293 10720 net.cpp:399] lstm1_unit_1 -> c_1
I0922 21:44:05.798303 10720 net.cpp:399] lstm1_unit_1 -> h_1
I0922 21:44:05.798375 10720 net.cpp:141] Setting up lstm1_unit_1
I0922 21:44:05.798385 10720 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:44:05.798393 10720 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:44:05.798398 10720 net.cpp:156] Memory required for data: 86016
I0922 21:44:05.798403 10720 layer_factory.hpp:77] Creating layer lstm1_
I0922 21:44:05.798416 10720 net.cpp:91] Creating Layer lstm1_
I0922 21:44:05.798423 10720 net.cpp:425] lstm1_ <- c_1
I0922 21:44:05.798430 10720 net.cpp:399] lstm1_ -> c_T
I0922 21:44:05.798463 10720 net.cpp:141] Setting up lstm1_
I0922 21:44:05.798472 10720 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:44:05.798477 10720 net.cpp:156] Memory required for data: 90016
I0922 21:44:05.798483 10720 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0922 21:44:05.798496 10720 net.cpp:91] Creating Layer lstm1_h_concat
I0922 21:44:05.798509 10720 net.cpp:425] lstm1_h_concat <- h_1
I0922 21:44:05.798521 10720 net.cpp:399] lstm1_h_concat -> h
I0922 21:44:05.798569 10720 net.cpp:141] Setting up lstm1_h_concat
I0922 21:44:05.798578 10720 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:44:05.798583 10720 net.cpp:156] Memory required for data: 94016
I0922 21:44:05.798589 10720 layer_factory.hpp:77] Creating layer h_pseudoloss
I0922 21:44:05.798605 10720 net.cpp:91] Creating Layer h_pseudoloss
I0922 21:44:05.798611 10720 net.cpp:425] h_pseudoloss <- h
I0922 21:44:05.798619 10720 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0922 21:44:05.798727 10720 net.cpp:141] Setting up h_pseudoloss
I0922 21:44:05.798738 10720 net.cpp:148] Top shape: (1)
I0922 21:44:05.798743 10720 net.cpp:151]     with loss weight 1
I0922 21:44:05.798779 10720 net.cpp:156] Memory required for data: 94020
I0922 21:44:05.798786 10720 net.cpp:217] h_pseudoloss needs backward computation.
I0922 21:44:05.798791 10720 net.cpp:217] lstm1_h_concat needs backward computation.
I0922 21:44:05.798796 10720 net.cpp:219] lstm1_ does not need backward computation.
I0922 21:44:05.798802 10720 net.cpp:217] lstm1_unit_1 needs backward computation.
I0922 21:44:05.798809 10720 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0922 21:44:05.798815 10720 net.cpp:217] lstm1_transform_1 needs backward computation.
I0922 21:44:05.798820 10720 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0922 21:44:05.798825 10720 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0922 21:44:05.798831 10720 net.cpp:217] lstm1_x_transform needs backward computation.
I0922 21:44:05.798836 10720 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0922 21:44:05.798842 10720 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0922 21:44:05.798847 10720 net.cpp:219] lstm1_ does not need backward computation.
I0922 21:44:05.798852 10720 net.cpp:219] lstm1_ does not need backward computation.
I0922 21:44:05.798857 10720 net.cpp:261] This network produces output c_T
I0922 21:44:05.798862 10720 net.cpp:261] This network produces output h_pseudoloss
I0922 21:44:05.798884 10720 net.cpp:274] Network initialization done.
I0922 21:44:05.798954 10720 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0922 21:44:05.798960 10720 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0922 21:44:05.798965 10720 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0922 21:44:05.799096 10720 net.cpp:141] Setting up lstm1
I0922 21:44:05.799111 10720 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:44:05.799116 10720 net.cpp:156] Memory required for data: 26408
I0922 21:44:05.799131 10720 layer_factory.hpp:77] Creating layer concat
I0922 21:44:05.799142 10720 net.cpp:91] Creating Layer concat
I0922 21:44:05.799150 10720 net.cpp:425] concat <- lstm1
I0922 21:44:05.799157 10720 net.cpp:425] concat <- embedded_input_sentence
I0922 21:44:05.799163 10720 net.cpp:425] concat <- reshaped_stage_indicator
I0922 21:44:05.799171 10720 net.cpp:399] concat -> lstm1_video_sequence
I0922 21:44:05.799208 10720 net.cpp:141] Setting up concat
I0922 21:44:05.799217 10720 net.cpp:148] Top shape: 1 1 1501 (1501)
I0922 21:44:05.799222 10720 net.cpp:156] Memory required for data: 32412
I0922 21:44:05.799237 10720 layer_factory.hpp:77] Creating layer lstm2
I0922 21:44:05.799252 10720 net.cpp:91] Creating Layer lstm2
I0922 21:44:05.799257 10720 net.cpp:425] lstm2 <- lstm1_video_sequence
I0922 21:44:05.799264 10720 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0922 21:44:05.799271 10720 net.cpp:399] lstm2 -> lstm2
I0922 21:44:05.799283 10720 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0922 21:44:05.799588 10720 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0922 21:44:05.799688 10720 layer_factory.hpp:77] Creating layer lstm2_
I0922 21:44:05.799702 10720 net.cpp:91] Creating Layer lstm2_
I0922 21:44:05.799710 10720 net.cpp:399] lstm2_ -> x
I0922 21:44:05.799721 10720 net.cpp:399] lstm2_ -> cont
I0922 21:44:05.799779 10720 net.cpp:141] Setting up lstm2_
I0922 21:44:05.799790 10720 net.cpp:148] Top shape: 1 1 1501 (1501)
I0922 21:44:05.799798 10720 net.cpp:148] Top shape: 1 1 (1)
I0922 21:44:05.799801 10720 net.cpp:156] Memory required for data: 6008
I0922 21:44:05.799808 10720 layer_factory.hpp:77] Creating layer lstm2_
I0922 21:44:05.799821 10720 net.cpp:91] Creating Layer lstm2_
I0922 21:44:05.799829 10720 net.cpp:399] lstm2_ -> c_0
I0922 21:44:05.799839 10720 net.cpp:399] lstm2_ -> h_0
I0922 21:44:05.799895 10720 net.cpp:141] Setting up lstm2_
I0922 21:44:05.799906 10720 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:44:05.799911 10720 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:44:05.799916 10720 net.cpp:156] Memory required for data: 14008
I0922 21:44:05.799921 10720 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0922 21:44:05.799932 10720 net.cpp:91] Creating Layer lstm2_cont_slice
I0922 21:44:05.799937 10720 net.cpp:425] lstm2_cont_slice <- cont
I0922 21:44:05.799943 10720 net.cpp:399] lstm2_cont_slice -> cont_1
I0922 21:44:05.799983 10720 net.cpp:141] Setting up lstm2_cont_slice
I0922 21:44:05.799993 10720 net.cpp:148] Top shape: 1 1 (1)
I0922 21:44:05.799998 10720 net.cpp:156] Memory required for data: 14012
I0922 21:44:05.800004 10720 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0922 21:44:05.800011 10720 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0922 21:44:05.800016 10720 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0922 21:44:05.800025 10720 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0922 21:44:05.800034 10720 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0922 21:44:05.800086 10720 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0922 21:44:05.800096 10720 net.cpp:148] Top shape: 1 1 (1)
I0922 21:44:05.800103 10720 net.cpp:148] Top shape: 1 1 (1)
I0922 21:44:05.800107 10720 net.cpp:156] Memory required for data: 14020
I0922 21:44:05.800112 10720 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0922 21:44:05.800123 10720 net.cpp:91] Creating Layer lstm2_x_transform
I0922 21:44:05.800129 10720 net.cpp:425] lstm2_x_transform <- x
I0922 21:44:05.800142 10720 net.cpp:399] lstm2_x_transform -> W_xc_x
I0922 21:44:05.812325 10726 net.cpp:141] Setting up fc7
I0922 21:44:05.812366 10726 net.cpp:148] Top shape: 10 4096 (40960)
I0922 21:44:05.812371 10726 net.cpp:156] Memory required for data: 68273720
I0922 21:44:05.812384 10726 layer_factory.hpp:77] Creating layer relu7
I0922 21:44:05.812400 10726 net.cpp:91] Creating Layer relu7
I0922 21:44:05.812407 10726 net.cpp:425] relu7 <- fc7
I0922 21:44:05.812417 10726 net.cpp:386] relu7 -> fc7 (in-place)
I0922 21:44:05.813055 10726 net.cpp:141] Setting up relu7
I0922 21:44:05.813066 10726 net.cpp:148] Top shape: 10 4096 (40960)
I0922 21:44:05.813071 10726 net.cpp:156] Memory required for data: 68437560
I0922 21:44:05.813076 10726 layer_factory.hpp:77] Creating layer drop7
I0922 21:44:05.813086 10726 net.cpp:91] Creating Layer drop7
I0922 21:44:05.813091 10726 net.cpp:425] drop7 <- fc7
I0922 21:44:05.813100 10726 net.cpp:386] drop7 -> fc7 (in-place)
I0922 21:44:05.813135 10726 net.cpp:141] Setting up drop7
I0922 21:44:05.813145 10726 net.cpp:148] Top shape: 10 4096 (40960)
I0922 21:44:05.813150 10726 net.cpp:156] Memory required for data: 68601400
I0922 21:44:05.813154 10726 layer_factory.hpp:77] Creating layer fc8
I0922 21:44:05.813169 10726 net.cpp:91] Creating Layer fc8
I0922 21:44:05.813172 10726 net.cpp:425] fc8 <- fc7
I0922 21:44:05.813179 10726 net.cpp:399] fc8 -> fc8
I0922 21:44:05.824604 10726 net.cpp:141] Setting up fc8
I0922 21:44:05.824645 10726 net.cpp:148] Top shape: 10 1000 (10000)
I0922 21:44:05.824651 10726 net.cpp:156] Memory required for data: 68641400
I0922 21:44:05.824664 10726 layer_factory.hpp:77] Creating layer prob
I0922 21:44:05.824682 10726 net.cpp:91] Creating Layer prob
I0922 21:44:05.824688 10726 net.cpp:425] prob <- fc8
I0922 21:44:05.824697 10726 net.cpp:399] prob -> prob
I0922 21:44:05.825106 10726 net.cpp:141] Setting up prob
I0922 21:44:05.825119 10726 net.cpp:148] Top shape: 10 1000 (10000)
I0922 21:44:05.825124 10726 net.cpp:156] Memory required for data: 68681400
I0922 21:44:05.825129 10726 net.cpp:219] prob does not need backward computation.
I0922 21:44:05.825147 10726 net.cpp:219] fc8 does not need backward computation.
I0922 21:44:05.825151 10726 net.cpp:219] drop7 does not need backward computation.
I0922 21:44:05.825155 10726 net.cpp:219] relu7 does not need backward computation.
I0922 21:44:05.825160 10726 net.cpp:219] fc7 does not need backward computation.
I0922 21:44:05.825163 10726 net.cpp:219] drop6 does not need backward computation.
I0922 21:44:05.825168 10726 net.cpp:219] relu6 does not need backward computation.
I0922 21:44:05.825172 10726 net.cpp:219] fc6 does not need backward computation.
I0922 21:44:05.825176 10726 net.cpp:219] pool5 does not need backward computation.
I0922 21:44:05.825181 10726 net.cpp:219] relu5 does not need backward computation.
I0922 21:44:05.825184 10726 net.cpp:219] conv5 does not need backward computation.
I0922 21:44:05.825188 10726 net.cpp:219] relu4 does not need backward computation.
I0922 21:44:05.825192 10726 net.cpp:219] conv4 does not need backward computation.
I0922 21:44:05.825197 10726 net.cpp:219] relu3 does not need backward computation.
I0922 21:44:05.825201 10726 net.cpp:219] conv3 does not need backward computation.
I0922 21:44:05.825206 10726 net.cpp:219] norm2 does not need backward computation.
I0922 21:44:05.825211 10726 net.cpp:219] pool2 does not need backward computation.
I0922 21:44:05.825227 10726 net.cpp:219] relu2 does not need backward computation.
I0922 21:44:05.825232 10726 net.cpp:219] conv2 does not need backward computation.
I0922 21:44:05.825235 10726 net.cpp:219] norm1 does not need backward computation.
I0922 21:44:05.825240 10726 net.cpp:219] pool1 does not need backward computation.
I0922 21:44:05.825244 10726 net.cpp:219] relu1 does not need backward computation.
I0922 21:44:05.825249 10726 net.cpp:219] conv1 does not need backward computation.
I0922 21:44:05.825253 10726 net.cpp:219] data does not need backward computation.
I0922 21:44:05.825258 10726 net.cpp:261] This network produces output prob
I0922 21:44:05.825275 10726 net.cpp:274] Network initialization done.
I0922 21:44:05.864514 10720 net.cpp:141] Setting up lstm2_x_transform
I0922 21:44:05.864560 10720 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:44:05.864567 10720 net.cpp:156] Memory required for data: 30020
I0922 21:44:05.864591 10720 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0922 21:44:05.864611 10720 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0922 21:44:05.864619 10720 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0922 21:44:05.864627 10720 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0922 21:44:05.864686 10720 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0922 21:44:05.864697 10720 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:44:05.864702 10720 net.cpp:156] Memory required for data: 46020
I0922 21:44:05.864707 10720 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0922 21:44:05.864719 10720 net.cpp:91] Creating Layer lstm2_h_conted_0
I0922 21:44:05.864724 10720 net.cpp:425] lstm2_h_conted_0 <- h_0
I0922 21:44:05.864732 10720 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0922 21:44:05.864739 10720 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0922 21:44:05.865216 10720 net.cpp:141] Setting up lstm2_h_conted_0
I0922 21:44:05.865237 10720 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:44:05.865243 10720 net.cpp:156] Memory required for data: 50020
I0922 21:44:05.865249 10720 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0922 21:44:05.865267 10720 net.cpp:91] Creating Layer lstm2_transform_1
I0922 21:44:05.865272 10720 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0922 21:44:05.865281 10720 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0922 21:44:05.908118 10720 net.cpp:141] Setting up lstm2_transform_1
I0922 21:44:05.908167 10720 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:44:05.908174 10720 net.cpp:156] Memory required for data: 66020
I0922 21:44:05.908198 10720 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0922 21:44:05.908226 10720 net.cpp:91] Creating Layer lstm2_gate_input_1
I0922 21:44:05.908236 10720 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0922 21:44:05.908243 10720 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0922 21:44:05.908252 10720 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0922 21:44:05.908311 10720 net.cpp:141] Setting up lstm2_gate_input_1
I0922 21:44:05.908321 10720 net.cpp:148] Top shape: 1 1 4000 (4000)
I0922 21:44:05.908326 10720 net.cpp:156] Memory required for data: 82020
I0922 21:44:05.908332 10720 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0922 21:44:05.908342 10720 net.cpp:91] Creating Layer lstm2_unit_1
I0922 21:44:05.908349 10720 net.cpp:425] lstm2_unit_1 <- c_0
I0922 21:44:05.908355 10720 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0922 21:44:05.908360 10720 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0922 21:44:05.908370 10720 net.cpp:399] lstm2_unit_1 -> c_1
I0922 21:44:05.908380 10720 net.cpp:399] lstm2_unit_1 -> h_1
I0922 21:44:05.908459 10720 net.cpp:141] Setting up lstm2_unit_1
I0922 21:44:05.908470 10720 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:44:05.908476 10720 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:44:05.908481 10720 net.cpp:156] Memory required for data: 90020
I0922 21:44:05.908486 10720 layer_factory.hpp:77] Creating layer lstm2_
I0922 21:44:05.908499 10720 net.cpp:91] Creating Layer lstm2_
I0922 21:44:05.908505 10720 net.cpp:425] lstm2_ <- c_1
I0922 21:44:05.908514 10720 net.cpp:399] lstm2_ -> c_T
I0922 21:44:05.908546 10720 net.cpp:141] Setting up lstm2_
I0922 21:44:05.908556 10720 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:44:05.908561 10720 net.cpp:156] Memory required for data: 94020
I0922 21:44:05.908566 10720 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0922 21:44:05.908577 10720 net.cpp:91] Creating Layer lstm2_h_concat
I0922 21:44:05.908583 10720 net.cpp:425] lstm2_h_concat <- h_1
I0922 21:44:05.908596 10720 net.cpp:399] lstm2_h_concat -> h
I0922 21:44:05.908638 10720 net.cpp:141] Setting up lstm2_h_concat
I0922 21:44:05.908648 10720 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:44:05.908651 10720 net.cpp:156] Memory required for data: 98020
I0922 21:44:05.908658 10720 layer_factory.hpp:77] Creating layer h_pseudoloss
I0922 21:44:05.908668 10720 net.cpp:91] Creating Layer h_pseudoloss
I0922 21:44:05.908674 10720 net.cpp:425] h_pseudoloss <- h
I0922 21:44:05.908681 10720 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0922 21:44:05.908789 10720 net.cpp:141] Setting up h_pseudoloss
I0922 21:44:05.908800 10720 net.cpp:148] Top shape: (1)
I0922 21:44:05.908805 10720 net.cpp:151]     with loss weight 1
I0922 21:44:05.908825 10720 net.cpp:156] Memory required for data: 98024
I0922 21:44:05.908833 10720 net.cpp:217] h_pseudoloss needs backward computation.
I0922 21:44:05.908838 10720 net.cpp:217] lstm2_h_concat needs backward computation.
I0922 21:44:05.908843 10720 net.cpp:219] lstm2_ does not need backward computation.
I0922 21:44:05.908848 10720 net.cpp:217] lstm2_unit_1 needs backward computation.
I0922 21:44:05.908854 10720 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0922 21:44:05.908859 10720 net.cpp:217] lstm2_transform_1 needs backward computation.
I0922 21:44:05.908865 10720 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0922 21:44:05.908871 10720 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0922 21:44:05.908876 10720 net.cpp:217] lstm2_x_transform needs backward computation.
I0922 21:44:05.908882 10720 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0922 21:44:05.908891 10720 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0922 21:44:05.908897 10720 net.cpp:219] lstm2_ does not need backward computation.
I0922 21:44:05.908902 10720 net.cpp:219] lstm2_ does not need backward computation.
I0922 21:44:05.908906 10720 net.cpp:261] This network produces output c_T
I0922 21:44:05.908911 10720 net.cpp:261] This network produces output h_pseudoloss
I0922 21:44:05.908927 10720 net.cpp:274] Network initialization done.
I0922 21:44:05.908988 10720 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0922 21:44:05.908996 10720 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0922 21:44:05.909001 10720 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0922 21:44:05.909121 10720 net.cpp:141] Setting up lstm2
I0922 21:44:05.909133 10720 net.cpp:148] Top shape: 1 1 1000 (1000)
I0922 21:44:05.909138 10720 net.cpp:156] Memory required for data: 36412
I0922 21:44:05.909154 10720 layer_factory.hpp:77] Creating layer predict
I0922 21:44:05.909170 10720 net.cpp:91] Creating Layer predict
I0922 21:44:05.909178 10720 net.cpp:425] predict <- lstm2
I0922 21:44:05.909188 10720 net.cpp:399] predict -> predict
I0922 21:44:06.067639 10726 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /home/peifeng/work/run/storm102/data/workers/e258c6fb-7c0a-4ffe-939e-10fca7f7905a/tmp/cvld1075256385114744262/bvlc_reference_caffenet.caffemodel
I0922 21:44:06.067687 10726 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0922 21:44:06.067693 10726 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0922 21:44:06.067698 10726 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /home/peifeng/work/run/storm102/data/workers/e258c6fb-7c0a-4ffe-939e-10fca7f7905a/tmp/cvld1075256385114744262/bvlc_reference_caffenet.caffemodel
I0922 21:44:06.404858 10720 net.cpp:141] Setting up predict
I0922 21:44:06.404907 10720 net.cpp:148] Top shape: 1 1 46168 (46168)
I0922 21:44:06.404914 10720 net.cpp:156] Memory required for data: 221084
I0922 21:44:06.404928 10720 layer_factory.hpp:77] Creating layer probs
I0922 21:44:06.404944 10720 net.cpp:91] Creating Layer probs
I0922 21:44:06.404952 10720 net.cpp:425] probs <- predict
I0922 21:44:06.404961 10720 net.cpp:399] probs -> probs
I0922 21:44:06.406064 10720 net.cpp:141] Setting up probs
I0922 21:44:06.406085 10720 net.cpp:148] Top shape: 1 1 46168 (46168)
I0922 21:44:06.406090 10720 net.cpp:156] Memory required for data: 405756
I0922 21:44:06.406096 10720 net.cpp:219] probs does not need backward computation.
I0922 21:44:06.406101 10720 net.cpp:219] predict does not need backward computation.
I0922 21:44:06.406107 10720 net.cpp:219] lstm2 does not need backward computation.
I0922 21:44:06.406113 10720 net.cpp:219] concat does not need backward computation.
I0922 21:44:06.406119 10720 net.cpp:219] lstm1 does not need backward computation.
I0922 21:44:06.406126 10720 net.cpp:219] embedding does not need backward computation.
I0922 21:44:06.406131 10720 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0922 21:44:06.406134 10720 net.cpp:219] reshape_frames does not need backward computation.
I0922 21:44:06.406139 10720 net.cpp:219] embed_encoder does not need backward computation.
I0922 21:44:06.406146 10720 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0922 21:44:06.406154 10720 net.cpp:219] input does not need backward computation.
I0922 21:44:06.406158 10720 net.cpp:261] This network produces output probs
I0922 21:44:06.406172 10720 net.cpp:274] Network initialization done.
I0922 21:44:06.434473 10726 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0922 21:44:06.484355 10726 net.cpp:752] Ignoring source layer loss
Loading the model + trained: 6142.54ms
Using cv::Size and some other stuff: 0.079ms
I0922 21:44:06.717490 10720 net.cpp:752] Ignoring source layer data
I0922 21:44:06.717530 10720 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0922 21:44:06.717536 10720 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0922 21:44:06.808440 10720 net.cpp:752] Ignoring source layer cross_entropy_loss
Loading the mean file: 13510.6ms
TIMERTIMER 300698087
TIMERTIMER 271361478
TIMERTIMER 261435876
TIMERTIMER 230832146
TIMERTIMER 228190404
TIMERTIMER 243664713
TIMERTIMER 230561523
TIMERTIMER 232564396
TIMERTIMER 194411740
TIMERTIMER 188939380
TIMERTIMER 194624303
TIMERTIMER 188773720
TIMERTIMER 189010753
TIMERTIMER 196211831
TIMERTIMER 190546886
TIMERTIMER 189744589
TIMERTIMER 195921508
TIMERTIMER 195684578
TIMERTIMER 195269509
TIMERTIMER 195214267
TIMERTIMER 194249051
TIMERTIMER 187812522
TIMERTIMER 196223067
TIMERTIMER 189769064
TIMERTIMER 194973252
TIMERTIMER 189211718
TIMERTIMER 194947495
TIMERTIMER 194635583
TIMERTIMER 201437493
TIMERTIMER 188802687
TIMERTIMER 196289247
TIMERTIMER 188650948
TIMERTIMER 188975430
TIMERTIMER 193378688
