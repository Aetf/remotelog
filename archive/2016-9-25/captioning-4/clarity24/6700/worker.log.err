SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/peifeng/tools/storm102/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/peifeng/work/run/storm102/data/supervisor/stormdist/captioning-1-1474850513/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /home/peifeng/work/run/storm102/data/workers/14bcf982-577a-4c59-ba8d-ca7e0c342d3f/tmp/cvld7119620746758902993/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0925 20:43:11.644701  3283 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/14bcf982-577a-4c59-ba8d-ca7e0c342d3f/tmp/cvld7119620746758902993/s2vt.words_to_preds.prototxt
I0925 20:43:11.644814  3283 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0925 20:43:11.644824  3283 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0925 20:43:11.645072  3283 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0925 20:43:11.645081  3289 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0925 20:43:11.645203  3283 layer_factory.hpp:77] Creating layer input
I0925 20:43:11.645210  3289 layer_factory.hpp:77] Creating layer data
I0925 20:43:11.645233  3289 net.cpp:91] Creating Layer data
I0925 20:43:11.645233  3283 net.cpp:91] Creating Layer input
I0925 20:43:11.645252  3289 net.cpp:399] data -> data
I0925 20:43:11.645257  3283 net.cpp:399] input -> frames_fc7
I0925 20:43:11.645289  3283 net.cpp:399] input -> cont_sentence
I0925 20:43:11.645304  3283 net.cpp:399] input -> input_sentence
I0925 20:43:11.645316  3283 net.cpp:399] input -> stage_indicator
I0925 20:43:12.243501  3289 net.cpp:141] Setting up data
I0925 20:43:12.243589  3289 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0925 20:43:12.243590  3283 net.cpp:141] Setting up input
I0925 20:43:12.243598  3289 net.cpp:156] Memory required for data: 6183480
I0925 20:43:12.243613  3283 net.cpp:148] Top shape: 1 4096 (4096)
I0925 20:43:12.243619  3289 layer_factory.hpp:77] Creating layer conv1
I0925 20:43:12.243623  3283 net.cpp:148] Top shape: 1 1 (1)
I0925 20:43:12.243629  3283 net.cpp:148] Top shape: 1 1 (1)
I0925 20:43:12.243635  3283 net.cpp:148] Top shape: 1 1 (1)
I0925 20:43:12.243640  3283 net.cpp:156] Memory required for data: 16396
I0925 20:43:12.243648  3283 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0925 20:43:12.243652  3289 net.cpp:91] Creating Layer conv1
I0925 20:43:12.243662  3289 net.cpp:425] conv1 <- data
I0925 20:43:12.243669  3283 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0925 20:43:12.243677  3289 net.cpp:399] conv1 -> conv1
I0925 20:43:12.243677  3283 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0925 20:43:12.243703  3283 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0925 20:43:12.243717  3283 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0925 20:43:12.243793  3283 net.cpp:141] Setting up cont_sentence_input_1_split
I0925 20:43:12.243805  3283 net.cpp:148] Top shape: 1 1 (1)
I0925 20:43:12.243813  3283 net.cpp:148] Top shape: 1 1 (1)
I0925 20:43:12.243818  3283 net.cpp:156] Memory required for data: 16404
I0925 20:43:12.243823  3283 layer_factory.hpp:77] Creating layer embed_encoder
I0925 20:43:12.243844  3283 net.cpp:91] Creating Layer embed_encoder
I0925 20:43:12.243850  3283 net.cpp:425] embed_encoder <- frames_fc7
I0925 20:43:12.243860  3283 net.cpp:399] embed_encoder -> embedded_in_frames
I0925 20:43:12.271112  3283 net.cpp:141] Setting up embed_encoder
I0925 20:43:12.271162  3283 net.cpp:148] Top shape: 1 500 (500)
I0925 20:43:12.271169  3283 net.cpp:156] Memory required for data: 18404
I0925 20:43:12.271199  3283 layer_factory.hpp:77] Creating layer reshape_frames
I0925 20:43:12.271227  3283 net.cpp:91] Creating Layer reshape_frames
I0925 20:43:12.271237  3283 net.cpp:425] reshape_frames <- embedded_in_frames
I0925 20:43:12.271250  3283 net.cpp:399] reshape_frames -> embedded_input_frames
I0925 20:43:12.271486  3283 net.cpp:141] Setting up reshape_frames
I0925 20:43:12.271499  3283 net.cpp:148] Top shape: 1 1 500 (500)
I0925 20:43:12.271505  3283 net.cpp:156] Memory required for data: 20404
I0925 20:43:12.271512  3283 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0925 20:43:12.271523  3283 net.cpp:91] Creating Layer reshape_stage_indicator
I0925 20:43:12.271530  3283 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0925 20:43:12.271539  3283 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0925 20:43:12.278298  3283 net.cpp:141] Setting up reshape_stage_indicator
I0925 20:43:12.278327  3283 net.cpp:148] Top shape: 1 1 1 (1)
I0925 20:43:12.278334  3283 net.cpp:156] Memory required for data: 20408
I0925 20:43:12.278342  3283 layer_factory.hpp:77] Creating layer embedding
I0925 20:43:12.278357  3283 net.cpp:91] Creating Layer embedding
I0925 20:43:12.278364  3283 net.cpp:425] embedding <- input_sentence
I0925 20:43:12.278376  3283 net.cpp:399] embedding -> embedded_input_sentence
I0925 20:43:12.493757  3289 net.cpp:141] Setting up conv1
I0925 20:43:12.493813  3289 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0925 20:43:12.493820  3289 net.cpp:156] Memory required for data: 17799480
I0925 20:43:12.493844  3289 layer_factory.hpp:77] Creating layer relu1
I0925 20:43:12.493861  3289 net.cpp:91] Creating Layer relu1
I0925 20:43:12.493870  3289 net.cpp:425] relu1 <- conv1
I0925 20:43:12.493878  3289 net.cpp:386] relu1 -> conv1 (in-place)
I0925 20:43:12.494303  3289 net.cpp:141] Setting up relu1
I0925 20:43:12.494318  3289 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0925 20:43:12.494324  3289 net.cpp:156] Memory required for data: 29415480
I0925 20:43:12.494331  3289 layer_factory.hpp:77] Creating layer pool1
I0925 20:43:12.494344  3289 net.cpp:91] Creating Layer pool1
I0925 20:43:12.494350  3289 net.cpp:425] pool1 <- conv1
I0925 20:43:12.494359  3289 net.cpp:399] pool1 -> pool1
I0925 20:43:12.494436  3289 net.cpp:141] Setting up pool1
I0925 20:43:12.494447  3289 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0925 20:43:12.494453  3289 net.cpp:156] Memory required for data: 32214840
I0925 20:43:12.494458  3289 layer_factory.hpp:77] Creating layer norm1
I0925 20:43:12.494477  3289 net.cpp:91] Creating Layer norm1
I0925 20:43:12.494482  3289 net.cpp:425] norm1 <- pool1
I0925 20:43:12.494490  3289 net.cpp:399] norm1 -> norm1
I0925 20:43:12.494781  3289 net.cpp:141] Setting up norm1
I0925 20:43:12.494796  3289 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0925 20:43:12.494801  3289 net.cpp:156] Memory required for data: 35014200
I0925 20:43:12.494807  3289 layer_factory.hpp:77] Creating layer conv2
I0925 20:43:12.494822  3289 net.cpp:91] Creating Layer conv2
I0925 20:43:12.494827  3289 net.cpp:425] conv2 <- norm1
I0925 20:43:12.494837  3289 net.cpp:399] conv2 -> conv2
I0925 20:43:12.498185  3289 net.cpp:141] Setting up conv2
I0925 20:43:12.498214  3289 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0925 20:43:12.498220  3289 net.cpp:156] Memory required for data: 42479160
I0925 20:43:12.498236  3289 layer_factory.hpp:77] Creating layer relu2
I0925 20:43:12.498247  3289 net.cpp:91] Creating Layer relu2
I0925 20:43:12.498255  3289 net.cpp:425] relu2 <- conv2
I0925 20:43:12.498262  3289 net.cpp:386] relu2 -> conv2 (in-place)
I0925 20:43:12.498726  3289 net.cpp:141] Setting up relu2
I0925 20:43:12.498742  3289 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0925 20:43:12.498749  3289 net.cpp:156] Memory required for data: 49944120
I0925 20:43:12.498754  3289 layer_factory.hpp:77] Creating layer pool2
I0925 20:43:12.498765  3289 net.cpp:91] Creating Layer pool2
I0925 20:43:12.498771  3289 net.cpp:425] pool2 <- conv2
I0925 20:43:12.498780  3289 net.cpp:399] pool2 -> pool2
I0925 20:43:12.498848  3289 net.cpp:141] Setting up pool2
I0925 20:43:12.498859  3289 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0925 20:43:12.498864  3289 net.cpp:156] Memory required for data: 51674680
I0925 20:43:12.498869  3289 layer_factory.hpp:77] Creating layer norm2
I0925 20:43:12.498883  3289 net.cpp:91] Creating Layer norm2
I0925 20:43:12.498889  3289 net.cpp:425] norm2 <- pool2
I0925 20:43:12.498898  3289 net.cpp:399] norm2 -> norm2
I0925 20:43:12.499195  3289 net.cpp:141] Setting up norm2
I0925 20:43:12.499209  3289 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0925 20:43:12.499214  3289 net.cpp:156] Memory required for data: 53405240
I0925 20:43:12.499220  3289 layer_factory.hpp:77] Creating layer conv3
I0925 20:43:12.499234  3289 net.cpp:91] Creating Layer conv3
I0925 20:43:12.499239  3289 net.cpp:425] conv3 <- norm2
I0925 20:43:12.499248  3289 net.cpp:399] conv3 -> conv3
I0925 20:43:12.503639  3289 net.cpp:141] Setting up conv3
I0925 20:43:12.503696  3289 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0925 20:43:12.503703  3289 net.cpp:156] Memory required for data: 56001080
I0925 20:43:12.503723  3289 layer_factory.hpp:77] Creating layer relu3
I0925 20:43:12.503741  3289 net.cpp:91] Creating Layer relu3
I0925 20:43:12.503747  3289 net.cpp:425] relu3 <- conv3
I0925 20:43:12.503756  3289 net.cpp:386] relu3 -> conv3 (in-place)
I0925 20:43:12.504026  3289 net.cpp:141] Setting up relu3
I0925 20:43:12.504040  3289 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0925 20:43:12.504045  3289 net.cpp:156] Memory required for data: 58596920
I0925 20:43:12.504050  3289 layer_factory.hpp:77] Creating layer conv4
I0925 20:43:12.504067  3289 net.cpp:91] Creating Layer conv4
I0925 20:43:12.504075  3289 net.cpp:425] conv4 <- conv3
I0925 20:43:12.504082  3289 net.cpp:399] conv4 -> conv4
I0925 20:43:12.508561  3289 net.cpp:141] Setting up conv4
I0925 20:43:12.508591  3289 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0925 20:43:12.508597  3289 net.cpp:156] Memory required for data: 61192760
I0925 20:43:12.508608  3289 layer_factory.hpp:77] Creating layer relu4
I0925 20:43:12.508620  3289 net.cpp:91] Creating Layer relu4
I0925 20:43:12.508626  3289 net.cpp:425] relu4 <- conv4
I0925 20:43:12.508640  3289 net.cpp:386] relu4 -> conv4 (in-place)
I0925 20:43:12.509065  3289 net.cpp:141] Setting up relu4
I0925 20:43:12.509080  3289 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0925 20:43:12.509085  3289 net.cpp:156] Memory required for data: 63788600
I0925 20:43:12.509091  3289 layer_factory.hpp:77] Creating layer conv5
I0925 20:43:12.509107  3289 net.cpp:91] Creating Layer conv5
I0925 20:43:12.509114  3289 net.cpp:425] conv5 <- conv4
I0925 20:43:12.509122  3289 net.cpp:399] conv5 -> conv5
I0925 20:43:12.513229  3289 net.cpp:141] Setting up conv5
I0925 20:43:12.513255  3289 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0925 20:43:12.513262  3289 net.cpp:156] Memory required for data: 65519160
I0925 20:43:12.513278  3289 layer_factory.hpp:77] Creating layer relu5
I0925 20:43:12.513291  3289 net.cpp:91] Creating Layer relu5
I0925 20:43:12.513298  3289 net.cpp:425] relu5 <- conv5
I0925 20:43:12.513305  3289 net.cpp:386] relu5 -> conv5 (in-place)
I0925 20:43:12.513744  3289 net.cpp:141] Setting up relu5
I0925 20:43:12.513758  3289 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0925 20:43:12.513764  3289 net.cpp:156] Memory required for data: 67249720
I0925 20:43:12.513769  3289 layer_factory.hpp:77] Creating layer pool5
I0925 20:43:12.513784  3289 net.cpp:91] Creating Layer pool5
I0925 20:43:12.513792  3289 net.cpp:425] pool5 <- conv5
I0925 20:43:12.513802  3289 net.cpp:399] pool5 -> pool5
I0925 20:43:12.513870  3289 net.cpp:141] Setting up pool5
I0925 20:43:12.513880  3289 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0925 20:43:12.513885  3289 net.cpp:156] Memory required for data: 67618360
I0925 20:43:12.513890  3289 layer_factory.hpp:77] Creating layer fc6
I0925 20:43:12.513906  3289 net.cpp:91] Creating Layer fc6
I0925 20:43:12.513912  3289 net.cpp:425] fc6 <- pool5
I0925 20:43:12.513921  3289 net.cpp:399] fc6 -> fc6
I0925 20:43:12.587218  3283 net.cpp:141] Setting up embedding
I0925 20:43:12.587276  3283 net.cpp:148] Top shape: 1 1 500 (500)
I0925 20:43:12.587283  3283 net.cpp:156] Memory required for data: 22408
I0925 20:43:12.587306  3283 layer_factory.hpp:77] Creating layer lstm1
I0925 20:43:12.587340  3283 net.cpp:91] Creating Layer lstm1
I0925 20:43:12.587350  3283 net.cpp:425] lstm1 <- embedded_input_frames
I0925 20:43:12.587360  3283 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0925 20:43:12.587371  3283 net.cpp:399] lstm1 -> lstm1
I0925 20:43:12.587401  3283 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 20:43:12.587788  3283 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 20:43:12.587887  3283 layer_factory.hpp:77] Creating layer lstm1_
I0925 20:43:12.587899  3283 net.cpp:91] Creating Layer lstm1_
I0925 20:43:12.587906  3283 net.cpp:399] lstm1_ -> x
I0925 20:43:12.587918  3283 net.cpp:399] lstm1_ -> cont
I0925 20:43:12.588004  3283 net.cpp:141] Setting up lstm1_
I0925 20:43:12.588016  3283 net.cpp:148] Top shape: 1 1 500 (500)
I0925 20:43:12.588022  3283 net.cpp:148] Top shape: 1 1 (1)
I0925 20:43:12.588027  3283 net.cpp:156] Memory required for data: 2004
I0925 20:43:12.588032  3283 layer_factory.hpp:77] Creating layer lstm1_
I0925 20:43:12.588042  3283 net.cpp:91] Creating Layer lstm1_
I0925 20:43:12.588052  3283 net.cpp:399] lstm1_ -> c_0
I0925 20:43:12.588063  3283 net.cpp:399] lstm1_ -> h_0
I0925 20:43:12.588120  3283 net.cpp:141] Setting up lstm1_
I0925 20:43:12.588130  3283 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:43:12.588137  3283 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:43:12.588141  3283 net.cpp:156] Memory required for data: 10004
I0925 20:43:12.588146  3283 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0925 20:43:12.588156  3283 net.cpp:91] Creating Layer lstm1_cont_slice
I0925 20:43:12.588161  3283 net.cpp:425] lstm1_cont_slice <- cont
I0925 20:43:12.588170  3283 net.cpp:399] lstm1_cont_slice -> cont_1
I0925 20:43:12.588212  3283 net.cpp:141] Setting up lstm1_cont_slice
I0925 20:43:12.588222  3283 net.cpp:148] Top shape: 1 1 (1)
I0925 20:43:12.588227  3283 net.cpp:156] Memory required for data: 10008
I0925 20:43:12.588232  3283 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0925 20:43:12.588243  3283 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0925 20:43:12.588248  3283 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0925 20:43:12.588255  3283 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0925 20:43:12.588265  3283 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0925 20:43:12.588322  3283 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0925 20:43:12.588332  3283 net.cpp:148] Top shape: 1 1 (1)
I0925 20:43:12.588338  3283 net.cpp:148] Top shape: 1 1 (1)
I0925 20:43:12.588343  3283 net.cpp:156] Memory required for data: 10016
I0925 20:43:12.588348  3283 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0925 20:43:12.588362  3283 net.cpp:91] Creating Layer lstm1_x_transform
I0925 20:43:12.588368  3283 net.cpp:425] lstm1_x_transform <- x
I0925 20:43:12.588377  3283 net.cpp:399] lstm1_x_transform -> W_xc_x
I0925 20:43:12.610828  3283 net.cpp:141] Setting up lstm1_x_transform
I0925 20:43:12.610884  3283 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 20:43:12.610891  3283 net.cpp:156] Memory required for data: 26016
I0925 20:43:12.610913  3283 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0925 20:43:12.610932  3283 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0925 20:43:12.610939  3283 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0925 20:43:12.610949  3283 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0925 20:43:12.611004  3283 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0925 20:43:12.611016  3283 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 20:43:12.611021  3283 net.cpp:156] Memory required for data: 42016
I0925 20:43:12.611026  3283 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0925 20:43:12.611037  3283 net.cpp:91] Creating Layer lstm1_h_conted_0
I0925 20:43:12.611042  3283 net.cpp:425] lstm1_h_conted_0 <- h_0
I0925 20:43:12.611048  3283 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0925 20:43:12.611057  3283 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0925 20:43:12.611157  3283 net.cpp:141] Setting up lstm1_h_conted_0
I0925 20:43:12.611167  3283 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:43:12.611172  3283 net.cpp:156] Memory required for data: 46016
I0925 20:43:12.611177  3283 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0925 20:43:12.611191  3283 net.cpp:91] Creating Layer lstm1_transform_1
I0925 20:43:12.611196  3283 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0925 20:43:12.611205  3283 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0925 20:43:12.629851  3289 net.cpp:141] Setting up fc6
I0925 20:43:12.629904  3289 net.cpp:148] Top shape: 10 4096 (40960)
I0925 20:43:12.629910  3289 net.cpp:156] Memory required for data: 67782200
I0925 20:43:12.629925  3289 layer_factory.hpp:77] Creating layer relu6
I0925 20:43:12.629941  3289 net.cpp:91] Creating Layer relu6
I0925 20:43:12.629950  3289 net.cpp:425] relu6 <- fc6
I0925 20:43:12.629963  3289 net.cpp:386] relu6 -> fc6 (in-place)
I0925 20:43:12.630334  3289 net.cpp:141] Setting up relu6
I0925 20:43:12.630347  3289 net.cpp:148] Top shape: 10 4096 (40960)
I0925 20:43:12.630352  3289 net.cpp:156] Memory required for data: 67946040
I0925 20:43:12.630358  3289 layer_factory.hpp:77] Creating layer drop6
I0925 20:43:12.630385  3289 net.cpp:91] Creating Layer drop6
I0925 20:43:12.630391  3289 net.cpp:425] drop6 <- fc6
I0925 20:43:12.630399  3289 net.cpp:386] drop6 -> fc6 (in-place)
I0925 20:43:12.630455  3289 net.cpp:141] Setting up drop6
I0925 20:43:12.630465  3289 net.cpp:148] Top shape: 10 4096 (40960)
I0925 20:43:12.630470  3289 net.cpp:156] Memory required for data: 68109880
I0925 20:43:12.630475  3289 layer_factory.hpp:77] Creating layer fc7
I0925 20:43:12.630486  3289 net.cpp:91] Creating Layer fc7
I0925 20:43:12.630491  3289 net.cpp:425] fc7 <- fc6
I0925 20:43:12.630504  3289 net.cpp:399] fc7 -> fc7
I0925 20:43:12.664803  3283 net.cpp:141] Setting up lstm1_transform_1
I0925 20:43:12.664862  3283 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 20:43:12.664870  3283 net.cpp:156] Memory required for data: 62016
I0925 20:43:12.664891  3283 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0925 20:43:12.664912  3283 net.cpp:91] Creating Layer lstm1_gate_input_1
I0925 20:43:12.664921  3283 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0925 20:43:12.664929  3283 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0925 20:43:12.664942  3283 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0925 20:43:12.665015  3283 net.cpp:141] Setting up lstm1_gate_input_1
I0925 20:43:12.665030  3283 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 20:43:12.665035  3283 net.cpp:156] Memory required for data: 78016
I0925 20:43:12.665040  3283 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0925 20:43:12.665050  3283 net.cpp:91] Creating Layer lstm1_unit_1
I0925 20:43:12.665055  3283 net.cpp:425] lstm1_unit_1 <- c_0
I0925 20:43:12.665062  3283 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0925 20:43:12.665068  3283 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0925 20:43:12.665076  3283 net.cpp:399] lstm1_unit_1 -> c_1
I0925 20:43:12.665086  3283 net.cpp:399] lstm1_unit_1 -> h_1
I0925 20:43:12.665156  3283 net.cpp:141] Setting up lstm1_unit_1
I0925 20:43:12.665166  3283 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:43:12.665172  3283 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:43:12.665177  3283 net.cpp:156] Memory required for data: 86016
I0925 20:43:12.665182  3283 layer_factory.hpp:77] Creating layer lstm1_
I0925 20:43:12.665191  3283 net.cpp:91] Creating Layer lstm1_
I0925 20:43:12.665196  3283 net.cpp:425] lstm1_ <- c_1
I0925 20:43:12.665205  3283 net.cpp:399] lstm1_ -> c_T
I0925 20:43:12.665238  3283 net.cpp:141] Setting up lstm1_
I0925 20:43:12.665246  3283 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:43:12.665251  3283 net.cpp:156] Memory required for data: 90016
I0925 20:43:12.665256  3283 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0925 20:43:12.665271  3283 net.cpp:91] Creating Layer lstm1_h_concat
I0925 20:43:12.665277  3283 net.cpp:425] lstm1_h_concat <- h_1
I0925 20:43:12.665285  3283 net.cpp:399] lstm1_h_concat -> h
I0925 20:43:12.665324  3283 net.cpp:141] Setting up lstm1_h_concat
I0925 20:43:12.665334  3283 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:43:12.665338  3283 net.cpp:156] Memory required for data: 94016
I0925 20:43:12.665344  3283 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 20:43:12.665364  3283 net.cpp:91] Creating Layer h_pseudoloss
I0925 20:43:12.665369  3283 net.cpp:425] h_pseudoloss <- h
I0925 20:43:12.665380  3283 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 20:43:12.665483  3283 net.cpp:141] Setting up h_pseudoloss
I0925 20:43:12.665494  3283 net.cpp:148] Top shape: (1)
I0925 20:43:12.665499  3283 net.cpp:151]     with loss weight 1
I0925 20:43:12.665552  3283 net.cpp:156] Memory required for data: 94020
I0925 20:43:12.665558  3283 net.cpp:217] h_pseudoloss needs backward computation.
I0925 20:43:12.665565  3283 net.cpp:217] lstm1_h_concat needs backward computation.
I0925 20:43:12.665570  3283 net.cpp:219] lstm1_ does not need backward computation.
I0925 20:43:12.665575  3283 net.cpp:217] lstm1_unit_1 needs backward computation.
I0925 20:43:12.665581  3283 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0925 20:43:12.665586  3283 net.cpp:217] lstm1_transform_1 needs backward computation.
I0925 20:43:12.665592  3283 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0925 20:43:12.665599  3283 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0925 20:43:12.665604  3283 net.cpp:217] lstm1_x_transform needs backward computation.
I0925 20:43:12.665611  3283 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0925 20:43:12.665616  3283 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0925 20:43:12.665622  3283 net.cpp:219] lstm1_ does not need backward computation.
I0925 20:43:12.665627  3283 net.cpp:219] lstm1_ does not need backward computation.
I0925 20:43:12.665630  3283 net.cpp:261] This network produces output c_T
I0925 20:43:12.665635  3283 net.cpp:261] This network produces output h_pseudoloss
I0925 20:43:12.665657  3283 net.cpp:274] Network initialization done.
I0925 20:43:12.665720  3283 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 20:43:12.665727  3283 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 20:43:12.665732  3283 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 20:43:12.665864  3283 net.cpp:141] Setting up lstm1
I0925 20:43:12.665879  3283 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:43:12.665884  3283 net.cpp:156] Memory required for data: 26408
I0925 20:43:12.665899  3283 layer_factory.hpp:77] Creating layer concat
I0925 20:43:12.665907  3283 net.cpp:91] Creating Layer concat
I0925 20:43:12.665915  3283 net.cpp:425] concat <- lstm1
I0925 20:43:12.665922  3283 net.cpp:425] concat <- embedded_input_sentence
I0925 20:43:12.665930  3283 net.cpp:425] concat <- reshaped_stage_indicator
I0925 20:43:12.665937  3283 net.cpp:399] concat -> lstm1_video_sequence
I0925 20:43:12.665974  3283 net.cpp:141] Setting up concat
I0925 20:43:12.665983  3283 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 20:43:12.665988  3283 net.cpp:156] Memory required for data: 32412
I0925 20:43:12.665994  3283 layer_factory.hpp:77] Creating layer lstm2
I0925 20:43:12.666007  3283 net.cpp:91] Creating Layer lstm2
I0925 20:43:12.666013  3283 net.cpp:425] lstm2 <- lstm1_video_sequence
I0925 20:43:12.666020  3283 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0925 20:43:12.666028  3283 net.cpp:399] lstm2 -> lstm2
I0925 20:43:12.666040  3283 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 20:43:12.666313  3283 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 20:43:12.666421  3283 layer_factory.hpp:77] Creating layer lstm2_
I0925 20:43:12.666435  3283 net.cpp:91] Creating Layer lstm2_
I0925 20:43:12.666441  3283 net.cpp:399] lstm2_ -> x
I0925 20:43:12.666453  3283 net.cpp:399] lstm2_ -> cont
I0925 20:43:12.666513  3283 net.cpp:141] Setting up lstm2_
I0925 20:43:12.666523  3283 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 20:43:12.666530  3283 net.cpp:148] Top shape: 1 1 (1)
I0925 20:43:12.666535  3283 net.cpp:156] Memory required for data: 6008
I0925 20:43:12.666540  3283 layer_factory.hpp:77] Creating layer lstm2_
I0925 20:43:12.666549  3283 net.cpp:91] Creating Layer lstm2_
I0925 20:43:12.666556  3283 net.cpp:399] lstm2_ -> c_0
I0925 20:43:12.666568  3283 net.cpp:399] lstm2_ -> h_0
I0925 20:43:12.666643  3283 net.cpp:141] Setting up lstm2_
I0925 20:43:12.666656  3283 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:43:12.666662  3283 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:43:12.666666  3283 net.cpp:156] Memory required for data: 14008
I0925 20:43:12.666672  3283 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0925 20:43:12.666682  3283 net.cpp:91] Creating Layer lstm2_cont_slice
I0925 20:43:12.666687  3283 net.cpp:425] lstm2_cont_slice <- cont
I0925 20:43:12.666698  3283 net.cpp:399] lstm2_cont_slice -> cont_1
I0925 20:43:12.666734  3283 net.cpp:141] Setting up lstm2_cont_slice
I0925 20:43:12.666744  3283 net.cpp:148] Top shape: 1 1 (1)
I0925 20:43:12.666749  3283 net.cpp:156] Memory required for data: 14012
I0925 20:43:12.666754  3283 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0925 20:43:12.666761  3283 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0925 20:43:12.666766  3283 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0925 20:43:12.666774  3283 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0925 20:43:12.666786  3283 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0925 20:43:12.666838  3283 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0925 20:43:12.666847  3283 net.cpp:148] Top shape: 1 1 (1)
I0925 20:43:12.666854  3283 net.cpp:148] Top shape: 1 1 (1)
I0925 20:43:12.666858  3283 net.cpp:156] Memory required for data: 14020
I0925 20:43:12.666863  3283 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0925 20:43:12.666877  3283 net.cpp:91] Creating Layer lstm2_x_transform
I0925 20:43:12.666890  3283 net.cpp:425] lstm2_x_transform <- x
I0925 20:43:12.666899  3283 net.cpp:399] lstm2_x_transform -> W_xc_x
I0925 20:43:12.685376  3289 net.cpp:141] Setting up fc7
I0925 20:43:12.685420  3289 net.cpp:148] Top shape: 10 4096 (40960)
I0925 20:43:12.685426  3289 net.cpp:156] Memory required for data: 68273720
I0925 20:43:12.685441  3289 layer_factory.hpp:77] Creating layer relu7
I0925 20:43:12.685457  3289 net.cpp:91] Creating Layer relu7
I0925 20:43:12.685466  3289 net.cpp:425] relu7 <- fc7
I0925 20:43:12.685477  3289 net.cpp:386] relu7 -> fc7 (in-place)
I0925 20:43:12.686177  3289 net.cpp:141] Setting up relu7
I0925 20:43:12.686192  3289 net.cpp:148] Top shape: 10 4096 (40960)
I0925 20:43:12.686197  3289 net.cpp:156] Memory required for data: 68437560
I0925 20:43:12.686203  3289 layer_factory.hpp:77] Creating layer drop7
I0925 20:43:12.686213  3289 net.cpp:91] Creating Layer drop7
I0925 20:43:12.686218  3289 net.cpp:425] drop7 <- fc7
I0925 20:43:12.686229  3289 net.cpp:386] drop7 -> fc7 (in-place)
I0925 20:43:12.686278  3289 net.cpp:141] Setting up drop7
I0925 20:43:12.686287  3289 net.cpp:148] Top shape: 10 4096 (40960)
I0925 20:43:12.686292  3289 net.cpp:156] Memory required for data: 68601400
I0925 20:43:12.686297  3289 layer_factory.hpp:77] Creating layer fc8
I0925 20:43:12.686316  3289 net.cpp:91] Creating Layer fc8
I0925 20:43:12.686321  3289 net.cpp:425] fc8 <- fc7
I0925 20:43:12.686329  3289 net.cpp:399] fc8 -> fc8
I0925 20:43:12.699393  3289 net.cpp:141] Setting up fc8
I0925 20:43:12.699446  3289 net.cpp:148] Top shape: 10 1000 (10000)
I0925 20:43:12.699453  3289 net.cpp:156] Memory required for data: 68641400
I0925 20:43:12.699467  3289 layer_factory.hpp:77] Creating layer prob
I0925 20:43:12.699483  3289 net.cpp:91] Creating Layer prob
I0925 20:43:12.699491  3289 net.cpp:425] prob <- fc8
I0925 20:43:12.699512  3289 net.cpp:399] prob -> prob
I0925 20:43:12.699980  3289 net.cpp:141] Setting up prob
I0925 20:43:12.699995  3289 net.cpp:148] Top shape: 10 1000 (10000)
I0925 20:43:12.700000  3289 net.cpp:156] Memory required for data: 68681400
I0925 20:43:12.700006  3289 net.cpp:219] prob does not need backward computation.
I0925 20:43:12.700011  3289 net.cpp:219] fc8 does not need backward computation.
I0925 20:43:12.700016  3289 net.cpp:219] drop7 does not need backward computation.
I0925 20:43:12.700021  3289 net.cpp:219] relu7 does not need backward computation.
I0925 20:43:12.700026  3289 net.cpp:219] fc7 does not need backward computation.
I0925 20:43:12.700031  3289 net.cpp:219] drop6 does not need backward computation.
I0925 20:43:12.700037  3289 net.cpp:219] relu6 does not need backward computation.
I0925 20:43:12.700042  3289 net.cpp:219] fc6 does not need backward computation.
I0925 20:43:12.700047  3289 net.cpp:219] pool5 does not need backward computation.
I0925 20:43:12.700052  3289 net.cpp:219] relu5 does not need backward computation.
I0925 20:43:12.700057  3289 net.cpp:219] conv5 does not need backward computation.
I0925 20:43:12.700062  3289 net.cpp:219] relu4 does not need backward computation.
I0925 20:43:12.700067  3289 net.cpp:219] conv4 does not need backward computation.
I0925 20:43:12.700073  3289 net.cpp:219] relu3 does not need backward computation.
I0925 20:43:12.700078  3289 net.cpp:219] conv3 does not need backward computation.
I0925 20:43:12.700083  3289 net.cpp:219] norm2 does not need backward computation.
I0925 20:43:12.700088  3289 net.cpp:219] pool2 does not need backward computation.
I0925 20:43:12.700093  3289 net.cpp:219] relu2 does not need backward computation.
I0925 20:43:12.700098  3289 net.cpp:219] conv2 does not need backward computation.
I0925 20:43:12.700103  3289 net.cpp:219] norm1 does not need backward computation.
I0925 20:43:12.700109  3289 net.cpp:219] pool1 does not need backward computation.
I0925 20:43:12.700114  3289 net.cpp:219] relu1 does not need backward computation.
I0925 20:43:12.700117  3289 net.cpp:219] conv1 does not need backward computation.
I0925 20:43:12.700122  3289 net.cpp:219] data does not need backward computation.
I0925 20:43:12.700127  3289 net.cpp:261] This network produces output prob
I0925 20:43:12.700148  3289 net.cpp:274] Network initialization done.
I0925 20:43:12.733839  3283 net.cpp:141] Setting up lstm2_x_transform
I0925 20:43:12.733891  3283 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 20:43:12.733897  3283 net.cpp:156] Memory required for data: 30020
I0925 20:43:12.733919  3283 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0925 20:43:12.733935  3283 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0925 20:43:12.733943  3283 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0925 20:43:12.733958  3283 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0925 20:43:12.734006  3283 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0925 20:43:12.734016  3283 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 20:43:12.734021  3283 net.cpp:156] Memory required for data: 46020
I0925 20:43:12.734027  3283 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0925 20:43:12.734038  3283 net.cpp:91] Creating Layer lstm2_h_conted_0
I0925 20:43:12.734045  3283 net.cpp:425] lstm2_h_conted_0 <- h_0
I0925 20:43:12.734051  3283 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0925 20:43:12.734060  3283 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0925 20:43:12.734160  3283 net.cpp:141] Setting up lstm2_h_conted_0
I0925 20:43:12.734171  3283 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:43:12.734175  3283 net.cpp:156] Memory required for data: 50020
I0925 20:43:12.734180  3283 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0925 20:43:12.734194  3283 net.cpp:91] Creating Layer lstm2_transform_1
I0925 20:43:12.734200  3283 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0925 20:43:12.734211  3283 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0925 20:43:12.778097  3283 net.cpp:141] Setting up lstm2_transform_1
I0925 20:43:12.778148  3283 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 20:43:12.778156  3283 net.cpp:156] Memory required for data: 66020
I0925 20:43:12.778173  3283 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0925 20:43:12.778194  3283 net.cpp:91] Creating Layer lstm2_gate_input_1
I0925 20:43:12.778208  3283 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0925 20:43:12.778215  3283 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0925 20:43:12.778228  3283 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0925 20:43:12.778291  3283 net.cpp:141] Setting up lstm2_gate_input_1
I0925 20:43:12.778301  3283 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 20:43:12.778306  3283 net.cpp:156] Memory required for data: 82020
I0925 20:43:12.778311  3283 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0925 20:43:12.778321  3283 net.cpp:91] Creating Layer lstm2_unit_1
I0925 20:43:12.778326  3283 net.cpp:425] lstm2_unit_1 <- c_0
I0925 20:43:12.778333  3283 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0925 20:43:12.778339  3283 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0925 20:43:12.778347  3283 net.cpp:399] lstm2_unit_1 -> c_1
I0925 20:43:12.778360  3283 net.cpp:399] lstm2_unit_1 -> h_1
I0925 20:43:12.778430  3283 net.cpp:141] Setting up lstm2_unit_1
I0925 20:43:12.778439  3283 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:43:12.778446  3283 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:43:12.778450  3283 net.cpp:156] Memory required for data: 90020
I0925 20:43:12.778463  3283 layer_factory.hpp:77] Creating layer lstm2_
I0925 20:43:12.778472  3283 net.cpp:91] Creating Layer lstm2_
I0925 20:43:12.778478  3283 net.cpp:425] lstm2_ <- c_1
I0925 20:43:12.778486  3283 net.cpp:399] lstm2_ -> c_T
I0925 20:43:12.778523  3283 net.cpp:141] Setting up lstm2_
I0925 20:43:12.778533  3283 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:43:12.778538  3283 net.cpp:156] Memory required for data: 94020
I0925 20:43:12.778543  3283 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0925 20:43:12.778553  3283 net.cpp:91] Creating Layer lstm2_h_concat
I0925 20:43:12.778558  3283 net.cpp:425] lstm2_h_concat <- h_1
I0925 20:43:12.778569  3283 net.cpp:399] lstm2_h_concat -> h
I0925 20:43:12.778615  3283 net.cpp:141] Setting up lstm2_h_concat
I0925 20:43:12.778625  3283 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:43:12.778630  3283 net.cpp:156] Memory required for data: 98020
I0925 20:43:12.778635  3283 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 20:43:12.778656  3283 net.cpp:91] Creating Layer h_pseudoloss
I0925 20:43:12.778661  3283 net.cpp:425] h_pseudoloss <- h
I0925 20:43:12.778669  3283 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 20:43:12.778770  3283 net.cpp:141] Setting up h_pseudoloss
I0925 20:43:12.778781  3283 net.cpp:148] Top shape: (1)
I0925 20:43:12.778785  3283 net.cpp:151]     with loss weight 1
I0925 20:43:12.778807  3283 net.cpp:156] Memory required for data: 98024
I0925 20:43:12.778812  3283 net.cpp:217] h_pseudoloss needs backward computation.
I0925 20:43:12.778818  3283 net.cpp:217] lstm2_h_concat needs backward computation.
I0925 20:43:12.778823  3283 net.cpp:219] lstm2_ does not need backward computation.
I0925 20:43:12.778828  3283 net.cpp:217] lstm2_unit_1 needs backward computation.
I0925 20:43:12.778836  3283 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0925 20:43:12.778841  3283 net.cpp:217] lstm2_transform_1 needs backward computation.
I0925 20:43:12.778846  3283 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0925 20:43:12.778852  3283 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0925 20:43:12.778857  3283 net.cpp:217] lstm2_x_transform needs backward computation.
I0925 20:43:12.778863  3283 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0925 20:43:12.778869  3283 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0925 20:43:12.778874  3283 net.cpp:219] lstm2_ does not need backward computation.
I0925 20:43:12.778879  3283 net.cpp:219] lstm2_ does not need backward computation.
I0925 20:43:12.778883  3283 net.cpp:261] This network produces output c_T
I0925 20:43:12.778888  3283 net.cpp:261] This network produces output h_pseudoloss
I0925 20:43:12.778915  3283 net.cpp:274] Network initialization done.
I0925 20:43:12.778967  3283 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 20:43:12.778975  3283 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 20:43:12.778978  3283 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 20:43:12.779090  3283 net.cpp:141] Setting up lstm2
I0925 20:43:12.779103  3283 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:43:12.779108  3283 net.cpp:156] Memory required for data: 36412
I0925 20:43:12.779122  3283 layer_factory.hpp:77] Creating layer predict
I0925 20:43:12.779135  3283 net.cpp:91] Creating Layer predict
I0925 20:43:12.779142  3283 net.cpp:425] predict <- lstm2
I0925 20:43:12.779151  3283 net.cpp:399] predict -> predict
I0925 20:43:12.960916  3289 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /home/peifeng/work/run/storm102/data/workers/14bcf982-577a-4c59-ba8d-ca7e0c342d3f/tmp/cvld7119620746758902993/bvlc_reference_caffenet.caffemodel
I0925 20:43:12.960965  3289 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0925 20:43:12.960973  3289 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0925 20:43:12.960978  3289 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /home/peifeng/work/run/storm102/data/workers/14bcf982-577a-4c59-ba8d-ca7e0c342d3f/tmp/cvld7119620746758902993/bvlc_reference_caffenet.caffemodel
I0925 20:43:13.314960  3283 net.cpp:141] Setting up predict
Loading the model + trained: 5484.77ms
I0925 20:43:13.315023  3283 net.cpp:148] Top shape: 1 1 46168 (46168)
Using cv::Size and some other stuff: 0.071ms
I0925 20:43:13.315033  3283 net.cpp:156] Memory required for data: 221084
I0925 20:43:13.315053  3283 layer_factory.hpp:77] Creating layer probs
I0925 20:43:13.315076  3283 net.cpp:91] Creating Layer probs
I0925 20:43:13.315088  3283 net.cpp:425] probs <- predict
I0925 20:43:13.315100  3283 net.cpp:399] probs -> probs
I0925 20:43:13.316325  3283 net.cpp:141] Setting up probs
I0925 20:43:13.316341  3283 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 20:43:13.316347  3283 net.cpp:156] Memory required for data: 405756
I0925 20:43:13.316354  3283 net.cpp:219] probs does not need backward computation.
I0925 20:43:13.316359  3283 net.cpp:219] predict does not need backward computation.
I0925 20:43:13.316365  3283 net.cpp:219] lstm2 does not need backward computation.
I0925 20:43:13.316371  3283 net.cpp:219] concat does not need backward computation.
I0925 20:43:13.316378  3283 net.cpp:219] lstm1 does not need backward computation.
I0925 20:43:13.316385  3283 net.cpp:219] embedding does not need backward computation.
I0925 20:43:13.316390  3283 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0925 20:43:13.316396  3283 net.cpp:219] reshape_frames does not need backward computation.
I0925 20:43:13.316401  3283 net.cpp:219] embed_encoder does not need backward computation.
I0925 20:43:13.316409  3283 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0925 20:43:13.316417  3283 net.cpp:219] input does not need backward computation.
I0925 20:43:13.316422  3283 net.cpp:261] This network produces output probs
I0925 20:43:13.316442  3283 net.cpp:274] Network initialization done.
I0925 20:43:13.371574  3289 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0925 20:43:13.422837  3289 net.cpp:752] Ignoring source layer loss
I0925 20:43:14.989897  3283 net.cpp:752] Ignoring source layer data
I0925 20:43:14.989941  3283 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0925 20:43:14.989950  3283 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0925 20:43:15.108052  3283 net.cpp:752] Ignoring source layer cross_entropy_loss
Loading the mean file: 65048.5ms
TIMERTIMER 300745889
TIMERTIMER 243081799
TIMERTIMER 277748155
TIMERTIMER 220043597
TIMERTIMER 221993179
TIMERTIMER 241690735
TIMERTIMER 226733273
TIMERTIMER 235016622
TIMERTIMER 227655947
TIMERTIMER 227312904
TIMERTIMER 234066550
TIMERTIMER 220775557
TIMERTIMER 237036011
TIMERTIMER 237303819
TIMERTIMER 240901686
TIMERTIMER 243511147
TIMERTIMER 223651817
TIMERTIMER 247212245
TIMERTIMER 255255687
TIMERTIMER 242795320
TIMERTIMER 238792535
TIMERTIMER 234807778
TIMERTIMER 250698037
TIMERTIMER 230800277
TIMERTIMER 237267815
TIMERTIMER 235675799
TIMERTIMER 226651555
TIMERTIMER 237617577
TIMERTIMER 231218858
