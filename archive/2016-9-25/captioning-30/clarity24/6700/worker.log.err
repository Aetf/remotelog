SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/peifeng/tools/storm102/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/peifeng/work/run/storm102/data/supervisor/stormdist/captioning-1-1474856256/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /home/peifeng/work/run/storm102/data/workers/1eade8ef-e562-4da0-82f9-10e36a4c7c3f/tmp/cvld8080089181201485022/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0925 22:18:53.030933 25928 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/1eade8ef-e562-4da0-82f9-10e36a4c7c3f/tmp/cvld8080089181201485022/s2vt.words_to_preds.prototxt
I0925 22:18:53.030933 25946 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/1eade8ef-e562-4da0-82f9-10e36a4c7c3f/tmp/cvld8080089181201485022/s2vt.words_to_preds.prototxt
I0925 22:18:53.031062 25946 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
I0925 22:18:53.031064 25928 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0925 22:18:53.031083 25946 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
W0925 22:18:53.031087 25928 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0925 22:18:53.031134 25918 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/1eade8ef-e562-4da0-82f9-10e36a4c7c3f/tmp/cvld8080089181201485022/s2vt.words_to_preds.prototxt
I0925 22:18:53.031134 25922 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/1eade8ef-e562-4da0-82f9-10e36a4c7c3f/tmp/cvld8080089181201485022/s2vt.words_to_preds.prototxt
I0925 22:18:53.031178 25952 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/1eade8ef-e562-4da0-82f9-10e36a4c7c3f/tmp/cvld8080089181201485022/s2vt.words_to_preds.prototxt
I0925 22:18:53.031134 25920 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/1eade8ef-e562-4da0-82f9-10e36a4c7c3f/tmp/cvld8080089181201485022/s2vt.words_to_preds.prototxt
I0925 22:18:53.031215 25952 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
I0925 22:18:53.031199 25922 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0925 22:18:53.031232 25952 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0925 22:18:53.031234 25920 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0925 22:18:53.031242 25922 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0925 22:18:53.031199 25918 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0925 22:18:53.031253 25920 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
W0925 22:18:53.031268 25918 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0925 22:18:53.031265 25944 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0925 22:18:53.031349 25946 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0925 22:18:53.031421 25944 layer_factory.hpp:77] Creating layer data
I0925 22:18:53.031458 25928 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0925 22:18:53.031461 25944 net.cpp:91] Creating Layer data
I0925 22:18:53.031486 25946 layer_factory.hpp:77] Creating layer input
I0925 22:18:53.031493 25944 net.cpp:399] data -> data
I0925 22:18:53.031504 25946 net.cpp:91] Creating Layer input
I0925 22:18:53.031512 25946 net.cpp:399] input -> frames_fc7
I0925 22:18:53.031544 25946 net.cpp:399] input -> cont_sentence
I0925 22:18:53.031564 25946 net.cpp:399] input -> input_sentence
I0925 22:18:53.031576 25946 net.cpp:399] input -> stage_indicator
I0925 22:18:53.031579 25928 layer_factory.hpp:77] Creating layer input
I0925 22:18:53.031596 25928 net.cpp:91] Creating Layer input
I0925 22:18:53.031607 25928 net.cpp:399] input -> frames_fc7
I0925 22:18:53.031626 25928 net.cpp:399] input -> cont_sentence
I0925 22:18:53.031644 25928 net.cpp:399] input -> input_sentence
I0925 22:18:53.031649 25918 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0925 22:18:53.031663 25928 net.cpp:399] input -> stage_indicator
I0925 22:18:53.031649 25922 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0925 22:18:53.031649 25920 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0925 22:18:53.031683 25952 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0925 22:18:53.031813 25918 layer_factory.hpp:77] Creating layer input
I0925 22:18:53.031813 25922 layer_factory.hpp:77] Creating layer input
I0925 22:18:53.031822 25920 layer_factory.hpp:77] Creating layer input
I0925 22:18:53.031837 25952 layer_factory.hpp:77] Creating layer input
I0925 22:18:53.031853 25920 net.cpp:91] Creating Layer input
I0925 22:18:53.031850 25922 net.cpp:91] Creating Layer input
I0925 22:18:53.031867 25920 net.cpp:399] input -> frames_fc7
I0925 22:18:53.031850 25918 net.cpp:91] Creating Layer input
I0925 22:18:53.031875 25922 net.cpp:399] input -> frames_fc7
I0925 22:18:53.031860 25952 net.cpp:91] Creating Layer input
I0925 22:18:53.031901 25918 net.cpp:399] input -> frames_fc7
I0925 22:18:53.031911 25952 net.cpp:399] input -> frames_fc7
I0925 22:18:53.031922 25918 net.cpp:399] input -> cont_sentence
I0925 22:18:53.031914 25922 net.cpp:399] input -> cont_sentence
I0925 22:18:53.031913 25920 net.cpp:399] input -> cont_sentence
I0925 22:18:53.031952 25918 net.cpp:399] input -> input_sentence
I0925 22:18:53.031957 25922 net.cpp:399] input -> input_sentence
I0925 22:18:53.031942 25952 net.cpp:399] input -> cont_sentence
I0925 22:18:53.031975 25922 net.cpp:399] input -> stage_indicator
I0925 22:18:53.031980 25920 net.cpp:399] input -> input_sentence
I0925 22:18:53.031975 25918 net.cpp:399] input -> stage_indicator
I0925 22:18:53.032006 25920 net.cpp:399] input -> stage_indicator
I0925 22:18:53.031991 25952 net.cpp:399] input -> input_sentence
I0925 22:18:53.032033 25952 net.cpp:399] input -> stage_indicator
I0925 22:18:53.789243 25944 net.cpp:141] Setting up data
I0925 22:18:53.789440 25944 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0925 22:18:53.789454 25944 net.cpp:156] Memory required for data: 6183480
I0925 22:18:53.789515 25944 layer_factory.hpp:77] Creating layer conv1
I0925 22:18:53.789567 25944 net.cpp:91] Creating Layer conv1
I0925 22:18:53.789582 25944 net.cpp:425] conv1 <- data
I0925 22:18:53.789603 25944 net.cpp:399] conv1 -> conv1
I0925 22:18:53.789669 25928 net.cpp:141] Setting up input
I0925 22:18:53.789690 25928 net.cpp:148] Top shape: 1 4096 (4096)
I0925 22:18:53.789702 25928 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:53.789713 25928 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:53.789722 25928 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:53.789731 25928 net.cpp:156] Memory required for data: 16396
I0925 22:18:53.789739 25928 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0925 22:18:53.789763 25928 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0925 22:18:53.789772 25928 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0925 22:18:53.789803 25928 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0925 22:18:53.789821 25928 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0925 22:18:53.789929 25946 net.cpp:141] Setting up input
I0925 22:18:53.789952 25946 net.cpp:148] Top shape: 1 4096 (4096)
I0925 22:18:53.789964 25946 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:53.789974 25946 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:53.789985 25946 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:53.789993 25946 net.cpp:156] Memory required for data: 16396
I0925 22:18:53.789990 25952 net.cpp:141] Setting up input
I0925 22:18:53.790019 25946 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0925 22:18:53.790026 25922 net.cpp:141] Setting up input
I0925 22:18:53.790046 25952 net.cpp:148] Top shape: 1 4096 (4096)
I0925 22:18:53.790052 25946 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0925 22:18:53.790060 25922 net.cpp:148] Top shape: 1 4096 (4096)
I0925 22:18:53.790063 25952 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:53.790071 25922 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:53.790065 25946 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0925 22:18:53.790081 25952 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:53.790079 25922 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:53.790096 25952 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:53.790099 25922 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:53.790101 25946 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0925 22:18:53.790107 25922 net.cpp:156] Memory required for data: 16396
I0925 22:18:53.790119 25946 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0925 22:18:53.790104 25952 net.cpp:156] Memory required for data: 16396
I0925 22:18:53.790132 25922 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0925 22:18:53.790140 25952 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0925 22:18:53.790146 25928 net.cpp:141] Setting up cont_sentence_input_1_split
I0925 22:18:53.790153 25922 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0925 22:18:53.790160 25952 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0925 22:18:53.790166 25928 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:53.790163 25922 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0925 22:18:53.790179 25952 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0925 22:18:53.790189 25922 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0925 22:18:53.790179 25928 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:53.790207 25922 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0925 22:18:53.790206 25952 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0925 22:18:53.790211 25928 net.cpp:156] Memory required for data: 16404
I0925 22:18:53.790222 25928 layer_factory.hpp:77] Creating layer embed_encoder
I0925 22:18:53.790230 25952 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0925 22:18:53.790235 25920 net.cpp:141] Setting up input
I0925 22:18:53.790251 25928 net.cpp:91] Creating Layer embed_encoder
I0925 22:18:53.790258 25920 net.cpp:148] Top shape: 1 4096 (4096)
I0925 22:18:53.790262 25928 net.cpp:425] embed_encoder <- frames_fc7
I0925 22:18:53.790268 25920 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:53.790277 25920 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:53.790278 25928 net.cpp:399] embed_encoder -> embedded_in_frames
I0925 22:18:53.790284 25920 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:53.790289 25920 net.cpp:156] Memory required for data: 16396
I0925 22:18:53.790297 25920 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0925 22:18:53.790310 25920 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0925 22:18:53.790318 25920 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0925 22:18:53.790329 25920 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0925 22:18:53.790338 25918 net.cpp:141] Setting up input
I0925 22:18:53.790349 25920 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0925 22:18:53.790364 25918 net.cpp:148] Top shape: 1 4096 (4096)
I0925 22:18:53.790379 25918 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:53.790390 25918 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:53.790400 25918 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:53.790408 25918 net.cpp:156] Memory required for data: 16396
I0925 22:18:53.790418 25918 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0925 22:18:53.790437 25918 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0925 22:18:53.790437 25920 net.cpp:141] Setting up cont_sentence_input_1_split
I0925 22:18:53.790449 25918 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0925 22:18:53.790457 25920 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:53.790464 25920 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:53.790465 25918 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0925 22:18:53.790469 25920 net.cpp:156] Memory required for data: 16404
I0925 22:18:53.790475 25920 layer_factory.hpp:77] Creating layer embed_encoder
I0925 22:18:53.790477 25952 net.cpp:141] Setting up cont_sentence_input_1_split
I0925 22:18:53.790484 25918 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0925 22:18:53.790493 25920 net.cpp:91] Creating Layer embed_encoder
I0925 22:18:53.790495 25952 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:53.790499 25920 net.cpp:425] embed_encoder <- frames_fc7
I0925 22:18:53.790508 25952 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:53.790510 25920 net.cpp:399] embed_encoder -> embedded_in_frames
I0925 22:18:53.790515 25952 net.cpp:156] Memory required for data: 16404
I0925 22:18:53.790525 25952 layer_factory.hpp:77] Creating layer embed_encoder
I0925 22:18:53.790546 25952 net.cpp:91] Creating Layer embed_encoder
I0925 22:18:53.790556 25952 net.cpp:425] embed_encoder <- frames_fc7
I0925 22:18:53.790567 25922 net.cpp:141] Setting up cont_sentence_input_1_split
I0925 22:18:53.790570 25952 net.cpp:399] embed_encoder -> embedded_in_frames
I0925 22:18:53.790581 25922 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:53.790590 25922 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:53.790606 25922 net.cpp:156] Memory required for data: 16404
I0925 22:18:53.790614 25922 layer_factory.hpp:77] Creating layer embed_encoder
I0925 22:18:53.790629 25922 net.cpp:91] Creating Layer embed_encoder
I0925 22:18:53.790635 25922 net.cpp:425] embed_encoder <- frames_fc7
I0925 22:18:53.790647 25922 net.cpp:399] embed_encoder -> embedded_in_frames
I0925 22:18:53.795133 25946 net.cpp:141] Setting up cont_sentence_input_1_split
I0925 22:18:53.795155 25946 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:53.795166 25946 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:53.795172 25946 net.cpp:156] Memory required for data: 16404
I0925 22:18:53.795181 25946 layer_factory.hpp:77] Creating layer embed_encoder
I0925 22:18:53.795228 25946 net.cpp:91] Creating Layer embed_encoder
I0925 22:18:53.795238 25946 net.cpp:425] embed_encoder <- frames_fc7
I0925 22:18:53.795256 25946 net.cpp:399] embed_encoder -> embedded_in_frames
I0925 22:18:53.801304 25918 net.cpp:141] Setting up cont_sentence_input_1_split
I0925 22:18:53.801373 25918 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:53.801388 25918 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:53.801398 25918 net.cpp:156] Memory required for data: 16404
I0925 22:18:53.801409 25918 layer_factory.hpp:77] Creating layer embed_encoder
I0925 22:18:53.801440 25918 net.cpp:91] Creating Layer embed_encoder
I0925 22:18:53.801452 25918 net.cpp:425] embed_encoder <- frames_fc7
I0925 22:18:53.801473 25918 net.cpp:399] embed_encoder -> embedded_in_frames
I0925 22:18:53.833256 25946 net.cpp:141] Setting up embed_encoder
I0925 22:18:53.833315 25946 net.cpp:148] Top shape: 1 500 (500)
I0925 22:18:53.833328 25946 net.cpp:156] Memory required for data: 18404
I0925 22:18:53.833374 25946 layer_factory.hpp:77] Creating layer reshape_frames
I0925 22:18:53.833416 25946 net.cpp:91] Creating Layer reshape_frames
I0925 22:18:53.833431 25946 net.cpp:425] reshape_frames <- embedded_in_frames
I0925 22:18:53.833451 25946 net.cpp:399] reshape_frames -> embedded_input_frames
I0925 22:18:53.833536 25920 net.cpp:141] Setting up embed_encoder
I0925 22:18:53.833576 25920 net.cpp:148] Top shape: 1 500 (500)
I0925 22:18:53.833583 25920 net.cpp:156] Memory required for data: 18404
I0925 22:18:53.833605 25920 layer_factory.hpp:77] Creating layer reshape_frames
I0925 22:18:53.833626 25920 net.cpp:91] Creating Layer reshape_frames
I0925 22:18:53.833634 25920 net.cpp:425] reshape_frames <- embedded_in_frames
I0925 22:18:53.833645 25920 net.cpp:399] reshape_frames -> embedded_input_frames
I0925 22:18:53.833648 25928 net.cpp:141] Setting up embed_encoder
I0925 22:18:53.833674 25928 net.cpp:148] Top shape: 1 500 (500)
I0925 22:18:53.833683 25928 net.cpp:156] Memory required for data: 18404
I0925 22:18:53.833708 25946 net.cpp:141] Setting up reshape_frames
I0925 22:18:53.833709 25928 layer_factory.hpp:77] Creating layer reshape_frames
I0925 22:18:53.833730 25946 net.cpp:148] Top shape: 1 1 500 (500)
I0925 22:18:53.833739 25946 net.cpp:156] Memory required for data: 20404
I0925 22:18:53.833740 25928 net.cpp:91] Creating Layer reshape_frames
I0925 22:18:53.833755 25946 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0925 22:18:53.833765 25928 net.cpp:425] reshape_frames <- embedded_in_frames
I0925 22:18:53.833770 25952 net.cpp:141] Setting up embed_encoder
I0925 22:18:53.833781 25946 net.cpp:91] Creating Layer reshape_stage_indicator
I0925 22:18:53.833789 25952 net.cpp:148] Top shape: 1 500 (500)
I0925 22:18:53.833781 25928 net.cpp:399] reshape_frames -> embedded_input_frames
I0925 22:18:53.833797 25946 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0925 22:18:53.833796 25952 net.cpp:156] Memory required for data: 18404
I0925 22:18:53.833814 25946 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0925 22:18:53.833819 25920 net.cpp:141] Setting up reshape_frames
I0925 22:18:53.833823 25952 layer_factory.hpp:77] Creating layer reshape_frames
I0925 22:18:53.833832 25920 net.cpp:148] Top shape: 1 1 500 (500)
I0925 22:18:53.833838 25952 net.cpp:91] Creating Layer reshape_frames
I0925 22:18:53.833838 25920 net.cpp:156] Memory required for data: 20404
I0925 22:18:53.833850 25952 net.cpp:425] reshape_frames <- embedded_in_frames
I0925 22:18:53.833853 25920 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0925 22:18:53.833861 25952 net.cpp:399] reshape_frames -> embedded_input_frames
I0925 22:18:53.833868 25920 net.cpp:91] Creating Layer reshape_stage_indicator
I0925 22:18:53.833873 25920 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0925 22:18:53.833884 25920 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0925 22:18:53.833885 25928 net.cpp:141] Setting up reshape_frames
I0925 22:18:53.833902 25928 net.cpp:148] Top shape: 1 1 500 (500)
I0925 22:18:53.833912 25928 net.cpp:156] Memory required for data: 20404
I0925 22:18:53.833921 25928 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0925 22:18:53.833923 25952 net.cpp:141] Setting up reshape_frames
I0925 22:18:53.833945 25952 net.cpp:148] Top shape: 1 1 500 (500)
I0925 22:18:53.833945 25928 net.cpp:91] Creating Layer reshape_stage_indicator
I0925 22:18:53.833950 25952 net.cpp:156] Memory required for data: 20404
I0925 22:18:53.833961 25928 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0925 22:18:53.833966 25952 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0925 22:18:53.833979 25952 net.cpp:91] Creating Layer reshape_stage_indicator
I0925 22:18:53.833982 25946 net.cpp:141] Setting up reshape_stage_indicator
I0925 22:18:53.833992 25952 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0925 22:18:53.833978 25928 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0925 22:18:53.834002 25946 net.cpp:148] Top shape: 1 1 1 (1)
I0925 22:18:53.834003 25952 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0925 22:18:53.834017 25946 net.cpp:156] Memory required for data: 20408
I0925 22:18:53.834027 25946 layer_factory.hpp:77] Creating layer embedding
I0925 22:18:53.834029 25920 net.cpp:141] Setting up reshape_stage_indicator
I0925 22:18:53.834043 25920 net.cpp:148] Top shape: 1 1 1 (1)
I0925 22:18:53.834048 25920 net.cpp:156] Memory required for data: 20408
I0925 22:18:53.834053 25920 layer_factory.hpp:77] Creating layer embedding
I0925 22:18:53.834055 25946 net.cpp:91] Creating Layer embedding
I0925 22:18:53.834062 25952 net.cpp:141] Setting up reshape_stage_indicator
I0925 22:18:53.834067 25946 net.cpp:425] embedding <- input_sentence
I0925 22:18:53.834075 25952 net.cpp:148] Top shape: 1 1 1 (1)
I0925 22:18:53.834081 25952 net.cpp:156] Memory required for data: 20408
I0925 22:18:53.834070 25920 net.cpp:91] Creating Layer embedding
I0925 22:18:53.834087 25952 layer_factory.hpp:77] Creating layer embedding
I0925 22:18:53.834090 25920 net.cpp:425] embedding <- input_sentence
I0925 22:18:53.834090 25946 net.cpp:399] embedding -> embedded_input_sentence
I0925 22:18:53.834100 25952 net.cpp:91] Creating Layer embedding
I0925 22:18:53.834101 25920 net.cpp:399] embedding -> embedded_input_sentence
I0925 22:18:53.834110 25952 net.cpp:425] embedding <- input_sentence
I0925 22:18:53.834121 25952 net.cpp:399] embedding -> embedded_input_sentence
I0925 22:18:53.834130 25928 net.cpp:141] Setting up reshape_stage_indicator
I0925 22:18:53.834148 25928 net.cpp:148] Top shape: 1 1 1 (1)
I0925 22:18:53.834157 25928 net.cpp:156] Memory required for data: 20408
I0925 22:18:53.834167 25928 layer_factory.hpp:77] Creating layer embedding
I0925 22:18:53.834182 25928 net.cpp:91] Creating Layer embedding
I0925 22:18:53.834192 25928 net.cpp:425] embedding <- input_sentence
I0925 22:18:53.834208 25928 net.cpp:399] embedding -> embedded_input_sentence
I0925 22:18:54.003556 25922 net.cpp:141] Setting up embed_encoder
I0925 22:18:54.003620 25922 net.cpp:148] Top shape: 1 500 (500)
I0925 22:18:54.003633 25922 net.cpp:156] Memory required for data: 18404
I0925 22:18:54.003667 25922 layer_factory.hpp:77] Creating layer reshape_frames
I0925 22:18:54.003795 25922 net.cpp:91] Creating Layer reshape_frames
I0925 22:18:54.003810 25922 net.cpp:425] reshape_frames <- embedded_in_frames
I0925 22:18:54.003832 25922 net.cpp:399] reshape_frames -> embedded_input_frames
I0925 22:18:54.053207 25922 net.cpp:141] Setting up reshape_frames
I0925 22:18:54.053267 25922 net.cpp:148] Top shape: 1 1 500 (500)
I0925 22:18:54.053278 25922 net.cpp:156] Memory required for data: 20404
I0925 22:18:54.053292 25922 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0925 22:18:54.053329 25922 net.cpp:91] Creating Layer reshape_stage_indicator
I0925 22:18:54.053341 25922 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0925 22:18:54.053361 25922 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0925 22:18:54.053442 25922 net.cpp:141] Setting up reshape_stage_indicator
I0925 22:18:54.053460 25922 net.cpp:148] Top shape: 1 1 1 (1)
I0925 22:18:54.053468 25922 net.cpp:156] Memory required for data: 20408
I0925 22:18:54.053478 25922 layer_factory.hpp:77] Creating layer embedding
I0925 22:18:54.053503 25922 net.cpp:91] Creating Layer embedding
I0925 22:18:54.053511 25922 net.cpp:425] embedding <- input_sentence
I0925 22:18:54.053527 25922 net.cpp:399] embedding -> embedded_input_sentence
I0925 22:18:54.102907 25918 net.cpp:141] Setting up embed_encoder
I0925 22:18:54.102999 25918 net.cpp:148] Top shape: 1 500 (500)
I0925 22:18:54.103014 25918 net.cpp:156] Memory required for data: 18404
I0925 22:18:54.103060 25918 layer_factory.hpp:77] Creating layer reshape_frames
I0925 22:18:54.103050 25946 net.cpp:141] Setting up embedding
I0925 22:18:54.103099 25918 net.cpp:91] Creating Layer reshape_frames
I0925 22:18:54.103155 25918 net.cpp:425] reshape_frames <- embedded_in_frames
I0925 22:18:54.103191 25918 net.cpp:399] reshape_frames -> embedded_input_frames
I0925 22:18:54.103106 25946 net.cpp:148] Top shape: 1 1 500 (500)
I0925 22:18:54.103260 25946 net.cpp:156] Memory required for data: 22408
I0925 22:18:54.103291 25946 layer_factory.hpp:77] Creating layer lstm1
I0925 22:18:54.103355 25946 net.cpp:91] Creating Layer lstm1
I0925 22:18:54.103374 25946 net.cpp:425] lstm1 <- embedded_input_frames
I0925 22:18:54.103394 25946 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0925 22:18:54.103425 25946 net.cpp:399] lstm1 -> lstm1
I0925 22:18:54.103480 25946 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 22:18:54.104022 25918 net.cpp:141] Setting up reshape_frames
I0925 22:18:54.104045 25918 net.cpp:148] Top shape: 1 1 500 (500)
I0925 22:18:54.104053 25918 net.cpp:156] Memory required for data: 20404
I0925 22:18:54.104064 25918 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0925 22:18:54.104091 25918 net.cpp:91] Creating Layer reshape_stage_indicator
I0925 22:18:54.104091 25946 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 22:18:54.104105 25918 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0925 22:18:54.104125 25918 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0925 22:18:54.104218 25946 layer_factory.hpp:77] Creating layer lstm1_
I0925 22:18:54.104235 25946 net.cpp:91] Creating Layer lstm1_
I0925 22:18:54.104243 25946 net.cpp:399] lstm1_ -> x
I0925 22:18:54.104260 25946 net.cpp:399] lstm1_ -> cont
I0925 22:18:54.104678 25918 net.cpp:141] Setting up reshape_stage_indicator
I0925 22:18:54.104704 25918 net.cpp:148] Top shape: 1 1 1 (1)
I0925 22:18:54.104713 25918 net.cpp:156] Memory required for data: 20408
I0925 22:18:54.104727 25918 layer_factory.hpp:77] Creating layer embedding
I0925 22:18:54.104753 25918 net.cpp:91] Creating Layer embedding
I0925 22:18:54.104764 25918 net.cpp:425] embedding <- input_sentence
I0925 22:18:54.104775 25946 net.cpp:141] Setting up lstm1_
I0925 22:18:54.104784 25918 net.cpp:399] embedding -> embedded_input_sentence
I0925 22:18:54.104794 25946 net.cpp:148] Top shape: 1 1 500 (500)
I0925 22:18:54.104802 25946 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.104807 25946 net.cpp:156] Memory required for data: 2004
I0925 22:18:54.104812 25946 layer_factory.hpp:77] Creating layer lstm1_
I0925 22:18:54.104830 25946 net.cpp:91] Creating Layer lstm1_
I0925 22:18:54.104838 25946 net.cpp:399] lstm1_ -> c_0
I0925 22:18:54.104851 25946 net.cpp:399] lstm1_ -> h_0
I0925 22:18:54.110031 25946 net.cpp:141] Setting up lstm1_
I0925 22:18:54.110080 25946 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.110088 25946 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.110093 25946 net.cpp:156] Memory required for data: 10004
I0925 22:18:54.110101 25946 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0925 22:18:54.110126 25946 net.cpp:91] Creating Layer lstm1_cont_slice
I0925 22:18:54.110132 25946 net.cpp:425] lstm1_cont_slice <- cont
I0925 22:18:54.110143 25946 net.cpp:399] lstm1_cont_slice -> cont_1
I0925 22:18:54.187633 25946 net.cpp:141] Setting up lstm1_cont_slice
I0925 22:18:54.187685 25946 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.187693 25946 net.cpp:156] Memory required for data: 10008
I0925 22:18:54.187702 25946 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0925 22:18:54.187722 25946 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0925 22:18:54.187708 25920 net.cpp:141] Setting up embedding
I0925 22:18:54.187731 25946 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0925 22:18:54.187764 25920 net.cpp:148] Top shape: 1 1 500 (500)
I0925 22:18:54.187768 25946 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0925 22:18:54.187784 25920 net.cpp:156] Memory required for data: 22408
I0925 22:18:54.187799 25946 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0925 22:18:54.187813 25920 layer_factory.hpp:77] Creating layer lstm1
I0925 22:18:54.187846 25920 net.cpp:91] Creating Layer lstm1
I0925 22:18:54.187861 25920 net.cpp:425] lstm1 <- embedded_input_frames
I0925 22:18:54.187876 25920 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0925 22:18:54.187896 25920 net.cpp:399] lstm1 -> lstm1
I0925 22:18:54.187924 25920 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 22:18:54.188413 25920 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 22:18:54.188494 25946 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0925 22:18:54.188515 25946 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.188524 25946 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.188527 25946 net.cpp:156] Memory required for data: 10016
I0925 22:18:54.188534 25946 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0925 22:18:54.188550 25946 net.cpp:91] Creating Layer lstm1_x_transform
I0925 22:18:54.188556 25946 net.cpp:425] lstm1_x_transform <- x
I0925 22:18:54.188567 25946 net.cpp:399] lstm1_x_transform -> W_xc_x
I0925 22:18:54.188590 25920 layer_factory.hpp:77] Creating layer lstm1_
I0925 22:18:54.188613 25920 net.cpp:91] Creating Layer lstm1_
I0925 22:18:54.188624 25920 net.cpp:399] lstm1_ -> x
I0925 22:18:54.188647 25920 net.cpp:399] lstm1_ -> cont
I0925 22:18:54.196403 25920 net.cpp:141] Setting up lstm1_
I0925 22:18:54.196460 25920 net.cpp:148] Top shape: 1 1 500 (500)
I0925 22:18:54.196475 25920 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.196482 25920 net.cpp:156] Memory required for data: 2004
I0925 22:18:54.196496 25920 layer_factory.hpp:77] Creating layer lstm1_
I0925 22:18:54.196528 25920 net.cpp:91] Creating Layer lstm1_
I0925 22:18:54.196547 25920 net.cpp:399] lstm1_ -> c_0
I0925 22:18:54.196575 25920 net.cpp:399] lstm1_ -> h_0
I0925 22:18:54.200562 25920 net.cpp:141] Setting up lstm1_
I0925 22:18:54.200621 25920 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.200636 25920 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.200645 25920 net.cpp:156] Memory required for data: 10004
I0925 22:18:54.200659 25920 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0925 22:18:54.200683 25920 net.cpp:91] Creating Layer lstm1_cont_slice
I0925 22:18:54.200696 25920 net.cpp:425] lstm1_cont_slice <- cont
I0925 22:18:54.200712 25920 net.cpp:399] lstm1_cont_slice -> cont_1
I0925 22:18:54.202155 25920 net.cpp:141] Setting up lstm1_cont_slice
I0925 22:18:54.202194 25920 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.202205 25920 net.cpp:156] Memory required for data: 10008
I0925 22:18:54.202216 25920 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0925 22:18:54.202239 25920 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0925 22:18:54.202250 25920 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0925 22:18:54.202265 25920 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0925 22:18:54.202285 25920 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0925 22:18:54.207708 25952 net.cpp:141] Setting up embedding
I0925 22:18:54.207762 25952 net.cpp:148] Top shape: 1 1 500 (500)
I0925 22:18:54.207773 25952 net.cpp:156] Memory required for data: 22408
I0925 22:18:54.207801 25952 layer_factory.hpp:77] Creating layer lstm1
I0925 22:18:54.207833 25952 net.cpp:91] Creating Layer lstm1
I0925 22:18:54.207870 25952 net.cpp:425] lstm1 <- embedded_input_frames
I0925 22:18:54.207885 25952 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0925 22:18:54.207906 25952 net.cpp:399] lstm1 -> lstm1
I0925 22:18:54.207932 25952 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 22:18:54.207967 25920 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0925 22:18:54.207988 25920 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.208000 25920 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.208009 25920 net.cpp:156] Memory required for data: 10016
I0925 22:18:54.208019 25920 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0925 22:18:54.208041 25920 net.cpp:91] Creating Layer lstm1_x_transform
I0925 22:18:54.208051 25920 net.cpp:425] lstm1_x_transform <- x
I0925 22:18:54.208070 25920 net.cpp:399] lstm1_x_transform -> W_xc_x
I0925 22:18:54.208447 25952 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 22:18:54.208628 25952 layer_factory.hpp:77] Creating layer lstm1_
I0925 22:18:54.208649 25952 net.cpp:91] Creating Layer lstm1_
I0925 22:18:54.208662 25952 net.cpp:399] lstm1_ -> x
I0925 22:18:54.208681 25952 net.cpp:399] lstm1_ -> cont
I0925 22:18:54.215325 25952 net.cpp:141] Setting up lstm1_
I0925 22:18:54.215374 25952 net.cpp:148] Top shape: 1 1 500 (500)
I0925 22:18:54.215386 25946 net.cpp:141] Setting up lstm1_x_transform
I0925 22:18:54.215389 25952 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.215445 25946 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.215448 25952 net.cpp:156] Memory required for data: 2004
I0925 22:18:54.215452 25946 net.cpp:156] Memory required for data: 26016
I0925 22:18:54.215468 25952 layer_factory.hpp:77] Creating layer lstm1_
I0925 22:18:54.215487 25946 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0925 22:18:54.215497 25952 net.cpp:91] Creating Layer lstm1_
I0925 22:18:54.215508 25946 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0925 22:18:54.215517 25946 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0925 22:18:54.215517 25952 net.cpp:399] lstm1_ -> c_0
I0925 22:18:54.215526 25946 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0925 22:18:54.215545 25952 net.cpp:399] lstm1_ -> h_0
I0925 22:18:54.215694 25946 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0925 22:18:54.215706 25946 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.215711 25946 net.cpp:156] Memory required for data: 42016
I0925 22:18:54.215716 25946 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0925 22:18:54.215736 25946 net.cpp:91] Creating Layer lstm1_h_conted_0
I0925 22:18:54.215741 25946 net.cpp:425] lstm1_h_conted_0 <- h_0
I0925 22:18:54.215749 25946 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0925 22:18:54.215759 25946 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0925 22:18:54.215770 25952 net.cpp:141] Setting up lstm1_
I0925 22:18:54.215790 25952 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.215803 25952 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.215811 25952 net.cpp:156] Memory required for data: 10004
I0925 22:18:54.215821 25952 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0925 22:18:54.215837 25952 net.cpp:91] Creating Layer lstm1_cont_slice
I0925 22:18:54.215847 25952 net.cpp:425] lstm1_cont_slice <- cont
I0925 22:18:54.215860 25952 net.cpp:399] lstm1_cont_slice -> cont_1
I0925 22:18:54.215958 25952 net.cpp:141] Setting up lstm1_cont_slice
I0925 22:18:54.215975 25952 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.215982 25952 net.cpp:156] Memory required for data: 10008
I0925 22:18:54.215991 25952 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0925 22:18:54.216008 25952 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0925 22:18:54.216013 25946 net.cpp:141] Setting up lstm1_h_conted_0
I0925 22:18:54.216018 25952 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0925 22:18:54.216027 25946 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.216032 25946 net.cpp:156] Memory required for data: 46016
I0925 22:18:54.216032 25952 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0925 22:18:54.216037 25946 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0925 22:18:54.216048 25952 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0925 22:18:54.216053 25946 net.cpp:91] Creating Layer lstm1_transform_1
I0925 22:18:54.216059 25946 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0925 22:18:54.216068 25946 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0925 22:18:54.216150 25952 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0925 22:18:54.216164 25952 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.216176 25952 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.216183 25952 net.cpp:156] Memory required for data: 10016
I0925 22:18:54.216192 25952 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0925 22:18:54.216212 25952 net.cpp:91] Creating Layer lstm1_x_transform
I0925 22:18:54.216222 25952 net.cpp:425] lstm1_x_transform <- x
I0925 22:18:54.216254 25952 net.cpp:399] lstm1_x_transform -> W_xc_x
I0925 22:18:54.233675 25920 net.cpp:141] Setting up lstm1_x_transform
I0925 22:18:54.233737 25920 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.233748 25920 net.cpp:156] Memory required for data: 26016
I0925 22:18:54.233779 25920 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0925 22:18:54.233804 25920 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0925 22:18:54.233815 25920 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0925 22:18:54.233837 25920 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0925 22:18:54.234169 25920 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0925 22:18:54.234189 25920 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.234196 25920 net.cpp:156] Memory required for data: 42016
I0925 22:18:54.234205 25920 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0925 22:18:54.234222 25920 net.cpp:91] Creating Layer lstm1_h_conted_0
I0925 22:18:54.234232 25920 net.cpp:425] lstm1_h_conted_0 <- h_0
I0925 22:18:54.234243 25920 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0925 22:18:54.234257 25920 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0925 22:18:54.236616 25920 net.cpp:141] Setting up lstm1_h_conted_0
I0925 22:18:54.236647 25920 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.236657 25920 net.cpp:156] Memory required for data: 46016
I0925 22:18:54.236667 25920 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0925 22:18:54.236688 25920 net.cpp:91] Creating Layer lstm1_transform_1
I0925 22:18:54.236697 25920 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0925 22:18:54.237604 25920 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0925 22:18:54.254330 25928 net.cpp:141] Setting up embedding
I0925 22:18:54.254398 25928 net.cpp:148] Top shape: 1 1 500 (500)
I0925 22:18:54.254406 25928 net.cpp:156] Memory required for data: 22408
I0925 22:18:54.254429 25928 layer_factory.hpp:77] Creating layer lstm1
I0925 22:18:54.254453 25928 net.cpp:91] Creating Layer lstm1
I0925 22:18:54.254462 25928 net.cpp:425] lstm1 <- embedded_input_frames
I0925 22:18:54.254473 25928 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0925 22:18:54.254484 25928 net.cpp:399] lstm1 -> lstm1
I0925 22:18:54.254504 25928 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 22:18:54.254806 25952 net.cpp:141] Setting up lstm1_x_transform
I0925 22:18:54.254850 25952 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.254855 25928 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 22:18:54.254861 25952 net.cpp:156] Memory required for data: 26016
I0925 22:18:54.254909 25952 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0925 22:18:54.254932 25952 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0925 22:18:54.254945 25952 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0925 22:18:54.254959 25928 layer_factory.hpp:77] Creating layer lstm1_
I0925 22:18:54.254964 25952 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0925 22:18:54.254973 25928 net.cpp:91] Creating Layer lstm1_
I0925 22:18:54.254981 25928 net.cpp:399] lstm1_ -> x
I0925 22:18:54.254992 25928 net.cpp:399] lstm1_ -> cont
I0925 22:18:54.256373 25952 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0925 22:18:54.256392 25952 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.256397 25952 net.cpp:156] Memory required for data: 42016
I0925 22:18:54.256403 25952 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0925 22:18:54.256417 25952 net.cpp:91] Creating Layer lstm1_h_conted_0
I0925 22:18:54.256423 25952 net.cpp:425] lstm1_h_conted_0 <- h_0
I0925 22:18:54.256433 25952 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0925 22:18:54.256445 25952 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0925 22:18:54.256448 25946 net.cpp:141] Setting up lstm1_transform_1
I0925 22:18:54.256465 25946 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.256470 25946 net.cpp:156] Memory required for data: 62016
I0925 22:18:54.256482 25946 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0925 22:18:54.256499 25946 net.cpp:91] Creating Layer lstm1_gate_input_1
I0925 22:18:54.256505 25946 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0925 22:18:54.256512 25946 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0925 22:18:54.256518 25928 net.cpp:141] Setting up lstm1_
I0925 22:18:54.256522 25946 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0925 22:18:54.256539 25928 net.cpp:148] Top shape: 1 1 500 (500)
I0925 22:18:54.256547 25928 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.256552 25928 net.cpp:156] Memory required for data: 2004
I0925 22:18:54.256558 25928 layer_factory.hpp:77] Creating layer lstm1_
I0925 22:18:54.256569 25928 net.cpp:91] Creating Layer lstm1_
I0925 22:18:54.256577 25928 net.cpp:399] lstm1_ -> c_0
I0925 22:18:54.256589 25928 net.cpp:399] lstm1_ -> h_0
I0925 22:18:54.256688 25952 net.cpp:141] Setting up lstm1_h_conted_0
I0925 22:18:54.256705 25952 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.256711 25952 net.cpp:156] Memory required for data: 46016
I0925 22:18:54.256716 25952 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0925 22:18:54.256731 25952 net.cpp:91] Creating Layer lstm1_transform_1
I0925 22:18:54.256733 25946 net.cpp:141] Setting up lstm1_gate_input_1
I0925 22:18:54.256736 25952 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0925 22:18:54.256750 25946 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.256757 25946 net.cpp:156] Memory required for data: 78016
I0925 22:18:54.256762 25946 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0925 22:18:54.256764 25952 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0925 22:18:54.256774 25946 net.cpp:91] Creating Layer lstm1_unit_1
I0925 22:18:54.256779 25946 net.cpp:425] lstm1_unit_1 <- c_0
I0925 22:18:54.256786 25946 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0925 22:18:54.256785 25928 net.cpp:141] Setting up lstm1_
I0925 22:18:54.256793 25946 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0925 22:18:54.256798 25928 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.256799 25946 net.cpp:399] lstm1_unit_1 -> c_1
I0925 22:18:54.256804 25928 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.256808 25928 net.cpp:156] Memory required for data: 10004
I0925 22:18:54.256810 25946 net.cpp:399] lstm1_unit_1 -> h_1
I0925 22:18:54.256814 25928 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0925 22:18:54.256842 25928 net.cpp:91] Creating Layer lstm1_cont_slice
I0925 22:18:54.256850 25928 net.cpp:425] lstm1_cont_slice <- cont
I0925 22:18:54.256857 25928 net.cpp:399] lstm1_cont_slice -> cont_1
I0925 22:18:54.256922 25946 net.cpp:141] Setting up lstm1_unit_1
I0925 22:18:54.256932 25946 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.256939 25946 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.256943 25946 net.cpp:156] Memory required for data: 86016
I0925 22:18:54.256948 25946 layer_factory.hpp:77] Creating layer lstm1_
I0925 22:18:54.256956 25946 net.cpp:91] Creating Layer lstm1_
I0925 22:18:54.256956 25928 net.cpp:141] Setting up lstm1_cont_slice
I0925 22:18:54.256963 25946 net.cpp:425] lstm1_ <- c_1
I0925 22:18:54.256968 25928 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.256973 25928 net.cpp:156] Memory required for data: 10008
I0925 22:18:54.256973 25946 net.cpp:399] lstm1_ -> c_T
I0925 22:18:54.256983 25928 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0925 22:18:54.256991 25928 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0925 22:18:54.256996 25928 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0925 22:18:54.257007 25928 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0925 22:18:54.257017 25928 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0925 22:18:54.266362 25946 net.cpp:141] Setting up lstm1_
I0925 22:18:54.266394 25946 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.266402 25946 net.cpp:156] Memory required for data: 90016
I0925 22:18:54.266412 25946 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0925 22:18:54.266428 25946 net.cpp:91] Creating Layer lstm1_h_concat
I0925 22:18:54.266436 25946 net.cpp:425] lstm1_h_concat <- h_1
I0925 22:18:54.266444 25928 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0925 22:18:54.266450 25946 net.cpp:399] lstm1_h_concat -> h
I0925 22:18:54.266479 25928 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.266490 25928 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.266497 25928 net.cpp:156] Memory required for data: 10016
I0925 22:18:54.266505 25928 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0925 22:18:54.266530 25928 net.cpp:91] Creating Layer lstm1_x_transform
I0925 22:18:54.266540 25928 net.cpp:425] lstm1_x_transform <- x
I0925 22:18:54.266554 25928 net.cpp:399] lstm1_x_transform -> W_xc_x
I0925 22:18:54.267431 25946 net.cpp:141] Setting up lstm1_h_concat
I0925 22:18:54.267446 25946 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.267452 25946 net.cpp:156] Memory required for data: 94016
I0925 22:18:54.267460 25946 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 22:18:54.267480 25946 net.cpp:91] Creating Layer h_pseudoloss
I0925 22:18:54.267488 25946 net.cpp:425] h_pseudoloss <- h
I0925 22:18:54.267498 25946 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 22:18:54.272532 25946 net.cpp:141] Setting up h_pseudoloss
I0925 22:18:54.272554 25946 net.cpp:148] Top shape: (1)
I0925 22:18:54.272562 25946 net.cpp:151]     with loss weight 1
I0925 22:18:54.272614 25946 net.cpp:156] Memory required for data: 94020
I0925 22:18:54.272621 25946 net.cpp:217] h_pseudoloss needs backward computation.
I0925 22:18:54.272629 25946 net.cpp:217] lstm1_h_concat needs backward computation.
I0925 22:18:54.272636 25946 net.cpp:219] lstm1_ does not need backward computation.
I0925 22:18:54.272644 25946 net.cpp:217] lstm1_unit_1 needs backward computation.
I0925 22:18:54.272653 25946 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0925 22:18:54.272665 25946 net.cpp:217] lstm1_transform_1 needs backward computation.
I0925 22:18:54.272675 25946 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0925 22:18:54.272683 25946 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0925 22:18:54.272691 25946 net.cpp:217] lstm1_x_transform needs backward computation.
I0925 22:18:54.272699 25946 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0925 22:18:54.272707 25946 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0925 22:18:54.272716 25946 net.cpp:219] lstm1_ does not need backward computation.
I0925 22:18:54.272724 25946 net.cpp:219] lstm1_ does not need backward computation.
I0925 22:18:54.272730 25946 net.cpp:261] This network produces output c_T
I0925 22:18:54.272738 25946 net.cpp:261] This network produces output h_pseudoloss
I0925 22:18:54.272764 25946 net.cpp:274] Network initialization done.
I0925 22:18:54.272845 25946 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 22:18:54.272855 25946 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 22:18:54.272861 25946 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 22:18:54.278311 25946 net.cpp:141] Setting up lstm1
I0925 22:18:54.278331 25946 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.278338 25946 net.cpp:156] Memory required for data: 26408
I0925 22:18:54.278355 25946 layer_factory.hpp:77] Creating layer concat
I0925 22:18:54.278373 25946 net.cpp:91] Creating Layer concat
I0925 22:18:54.278383 25946 net.cpp:425] concat <- lstm1
I0925 22:18:54.278394 25946 net.cpp:425] concat <- embedded_input_sentence
I0925 22:18:54.278401 25946 net.cpp:425] concat <- reshaped_stage_indicator
I0925 22:18:54.278410 25946 net.cpp:399] concat -> lstm1_video_sequence
I0925 22:18:54.280789 25946 net.cpp:141] Setting up concat
I0925 22:18:54.280812 25946 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 22:18:54.280822 25946 net.cpp:156] Memory required for data: 32412
I0925 22:18:54.280832 25946 layer_factory.hpp:77] Creating layer lstm2
I0925 22:18:54.280853 25946 net.cpp:91] Creating Layer lstm2
I0925 22:18:54.280863 25946 net.cpp:425] lstm2 <- lstm1_video_sequence
I0925 22:18:54.280874 25946 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0925 22:18:54.280886 25946 net.cpp:399] lstm2 -> lstm2
I0925 22:18:54.280905 25946 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 22:18:54.281338 25946 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 22:18:54.281487 25946 layer_factory.hpp:77] Creating layer lstm2_
I0925 22:18:54.281509 25946 net.cpp:91] Creating Layer lstm2_
I0925 22:18:54.281522 25946 net.cpp:399] lstm2_ -> x
I0925 22:18:54.281539 25946 net.cpp:399] lstm2_ -> cont
I0925 22:18:54.282577 25946 net.cpp:141] Setting up lstm2_
I0925 22:18:54.282611 25946 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 22:18:54.282626 25946 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.282634 25946 net.cpp:156] Memory required for data: 6008
I0925 22:18:54.282644 25946 layer_factory.hpp:77] Creating layer lstm2_
I0925 22:18:54.282666 25946 net.cpp:91] Creating Layer lstm2_
I0925 22:18:54.282680 25946 net.cpp:399] lstm2_ -> c_0
I0925 22:18:54.282698 25946 net.cpp:399] lstm2_ -> h_0
I0925 22:18:54.288460 25946 net.cpp:141] Setting up lstm2_
I0925 22:18:54.288506 25946 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.288518 25946 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.288527 25946 net.cpp:156] Memory required for data: 14008
I0925 22:18:54.288537 25946 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0925 22:18:54.288563 25946 net.cpp:91] Creating Layer lstm2_cont_slice
I0925 22:18:54.288573 25946 net.cpp:425] lstm2_cont_slice <- cont
I0925 22:18:54.288589 25946 net.cpp:399] lstm2_cont_slice -> cont_1
I0925 22:18:54.288790 25946 net.cpp:141] Setting up lstm2_cont_slice
I0925 22:18:54.288806 25946 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.288813 25946 net.cpp:156] Memory required for data: 14012
I0925 22:18:54.288821 25946 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0925 22:18:54.288838 25946 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0925 22:18:54.288847 25946 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0925 22:18:54.288858 25946 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0925 22:18:54.288877 25946 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0925 22:18:54.290050 25946 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0925 22:18:54.290066 25946 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.290076 25946 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.290083 25946 net.cpp:156] Memory required for data: 14020
I0925 22:18:54.290091 25946 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0925 22:18:54.290122 25946 net.cpp:91] Creating Layer lstm2_x_transform
I0925 22:18:54.290132 25946 net.cpp:425] lstm2_x_transform <- x
I0925 22:18:54.290148 25946 net.cpp:399] lstm2_x_transform -> W_xc_x
I0925 22:18:54.309968 25928 net.cpp:141] Setting up lstm1_x_transform
I0925 22:18:54.310034 25928 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.310045 25928 net.cpp:156] Memory required for data: 26016
I0925 22:18:54.310087 25928 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0925 22:18:54.310123 25928 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0925 22:18:54.310135 25928 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0925 22:18:54.310151 25928 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0925 22:18:54.312641 25952 net.cpp:141] Setting up lstm1_transform_1
I0925 22:18:54.312696 25952 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.312695 25928 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0925 22:18:54.312738 25928 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.312746 25928 net.cpp:156] Memory required for data: 42016
I0925 22:18:54.312752 25928 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0925 22:18:54.312777 25928 net.cpp:91] Creating Layer lstm1_h_conted_0
I0925 22:18:54.312785 25928 net.cpp:425] lstm1_h_conted_0 <- h_0
I0925 22:18:54.312793 25928 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0925 22:18:54.312803 25928 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0925 22:18:54.312716 25952 net.cpp:156] Memory required for data: 62016
I0925 22:18:54.314132 25952 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0925 22:18:54.314169 25952 net.cpp:91] Creating Layer lstm1_gate_input_1
I0925 22:18:54.314182 25952 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0925 22:18:54.314196 25952 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0925 22:18:54.314210 25952 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0925 22:18:54.314260 25920 net.cpp:141] Setting up lstm1_transform_1
I0925 22:18:54.314293 25952 net.cpp:141] Setting up lstm1_gate_input_1
I0925 22:18:54.314286 25920 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.314311 25952 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.314321 25952 net.cpp:156] Memory required for data: 78016
I0925 22:18:54.314321 25920 net.cpp:156] Memory required for data: 62016
I0925 22:18:54.314329 25952 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0925 22:18:54.314345 25952 net.cpp:91] Creating Layer lstm1_unit_1
I0925 22:18:54.314357 25952 net.cpp:425] lstm1_unit_1 <- c_0
I0925 22:18:54.314344 25920 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0925 22:18:54.314368 25952 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0925 22:18:54.314404 25952 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0925 22:18:54.314424 25952 net.cpp:399] lstm1_unit_1 -> c_1
I0925 22:18:54.314427 25920 net.cpp:91] Creating Layer lstm1_gate_input_1
I0925 22:18:54.314440 25952 net.cpp:399] lstm1_unit_1 -> h_1
I0925 22:18:54.314446 25920 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0925 22:18:54.314461 25920 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0925 22:18:54.314498 25920 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0925 22:18:54.314692 25952 net.cpp:141] Setting up lstm1_unit_1
I0925 22:18:54.314707 25952 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.314715 25952 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.314719 25952 net.cpp:156] Memory required for data: 86016
I0925 22:18:54.314725 25952 layer_factory.hpp:77] Creating layer lstm1_
I0925 22:18:54.314736 25952 net.cpp:91] Creating Layer lstm1_
I0925 22:18:54.314741 25952 net.cpp:425] lstm1_ <- c_1
I0925 22:18:54.314750 25952 net.cpp:399] lstm1_ -> c_T
I0925 22:18:54.314795 25952 net.cpp:141] Setting up lstm1_
I0925 22:18:54.314805 25952 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.314810 25952 net.cpp:156] Memory required for data: 90016
I0925 22:18:54.314815 25952 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0925 22:18:54.314826 25952 net.cpp:91] Creating Layer lstm1_h_concat
I0925 22:18:54.314834 25952 net.cpp:425] lstm1_h_concat <- h_1
I0925 22:18:54.314842 25952 net.cpp:399] lstm1_h_concat -> h
I0925 22:18:54.315647 25952 net.cpp:141] Setting up lstm1_h_concat
I0925 22:18:54.315667 25952 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.315673 25952 net.cpp:156] Memory required for data: 94016
I0925 22:18:54.315680 25952 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 22:18:54.315701 25952 net.cpp:91] Creating Layer h_pseudoloss
I0925 22:18:54.315704 25920 net.cpp:141] Setting up lstm1_gate_input_1
I0925 22:18:54.315711 25952 net.cpp:425] h_pseudoloss <- h
I0925 22:18:54.315734 25920 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.315737 25952 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 22:18:54.315752 25920 net.cpp:156] Memory required for data: 78016
I0925 22:18:54.315764 25920 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0925 22:18:54.315781 25920 net.cpp:91] Creating Layer lstm1_unit_1
I0925 22:18:54.315794 25920 net.cpp:425] lstm1_unit_1 <- c_0
I0925 22:18:54.315807 25920 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0925 22:18:54.315819 25920 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0925 22:18:54.315842 25920 net.cpp:399] lstm1_unit_1 -> c_1
I0925 22:18:54.315865 25920 net.cpp:399] lstm1_unit_1 -> h_1
I0925 22:18:54.333547 25928 net.cpp:141] Setting up lstm1_h_conted_0
I0925 22:18:54.333597 25928 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.333595 25920 net.cpp:141] Setting up lstm1_unit_1
I0925 22:18:54.333616 25928 net.cpp:156] Memory required for data: 46016
I0925 22:18:54.333613 25952 net.cpp:141] Setting up h_pseudoloss
I0925 22:18:54.333647 25928 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0925 22:18:54.333647 25920 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.333657 25952 net.cpp:148] Top shape: (1)
I0925 22:18:54.333665 25920 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.333675 25920 net.cpp:156] Memory required for data: 86016
I0925 22:18:54.333663 25952 net.cpp:151]     with loss weight 1
I0925 22:18:54.333686 25952 net.cpp:156] Memory required for data: 94020
I0925 22:18:54.333688 25920 layer_factory.hpp:77] Creating layer lstm1_
I0925 22:18:54.333698 25952 net.cpp:217] h_pseudoloss needs backward computation.
I0925 22:18:54.333706 25952 net.cpp:217] lstm1_h_concat needs backward computation.
I0925 22:18:54.333711 25952 net.cpp:219] lstm1_ does not need backward computation.
I0925 22:18:54.333719 25952 net.cpp:217] lstm1_unit_1 needs backward computation.
I0925 22:18:54.333715 25920 net.cpp:91] Creating Layer lstm1_
I0925 22:18:54.333726 25952 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0925 22:18:54.333730 25920 net.cpp:425] lstm1_ <- c_1
I0925 22:18:54.333734 25952 net.cpp:217] lstm1_transform_1 needs backward computation.
I0925 22:18:54.333750 25952 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0925 22:18:54.333758 25952 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0925 22:18:54.333756 25920 net.cpp:399] lstm1_ -> c_T
I0925 22:18:54.333766 25952 net.cpp:217] lstm1_x_transform needs backward computation.
I0925 22:18:54.333772 25952 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0925 22:18:54.333780 25952 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0925 22:18:54.333786 25952 net.cpp:219] lstm1_ does not need backward computation.
I0925 22:18:54.333791 25952 net.cpp:219] lstm1_ does not need backward computation.
I0925 22:18:54.333796 25952 net.cpp:261] This network produces output c_T
I0925 22:18:54.333802 25952 net.cpp:261] This network produces output h_pseudoloss
I0925 22:18:54.333809 25928 net.cpp:91] Creating Layer lstm1_transform_1
I0925 22:18:54.333824 25928 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0925 22:18:54.333825 25952 net.cpp:274] Network initialization done.
I0925 22:18:54.333840 25920 net.cpp:141] Setting up lstm1_
I0925 22:18:54.333847 25928 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0925 22:18:54.333860 25920 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.333871 25920 net.cpp:156] Memory required for data: 90016
I0925 22:18:54.333883 25920 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0925 22:18:54.333892 25952 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 22:18:54.333900 25952 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 22:18:54.333906 25952 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 22:18:54.333901 25920 net.cpp:91] Creating Layer lstm1_h_concat
I0925 22:18:54.333920 25920 net.cpp:425] lstm1_h_concat <- h_1
I0925 22:18:54.333936 25920 net.cpp:399] lstm1_h_concat -> h
I0925 22:18:54.343633 25952 net.cpp:141] Setting up lstm1
I0925 22:18:54.343689 25952 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.343701 25952 net.cpp:156] Memory required for data: 26408
I0925 22:18:54.343736 25952 layer_factory.hpp:77] Creating layer concat
I0925 22:18:54.343765 25952 net.cpp:91] Creating Layer concat
I0925 22:18:54.343778 25952 net.cpp:425] concat <- lstm1
I0925 22:18:54.343792 25952 net.cpp:425] concat <- embedded_input_sentence
I0925 22:18:54.343804 25952 net.cpp:425] concat <- reshaped_stage_indicator
I0925 22:18:54.343822 25952 net.cpp:399] concat -> lstm1_video_sequence
I0925 22:18:54.343895 25952 net.cpp:141] Setting up concat
I0925 22:18:54.343914 25952 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 22:18:54.343921 25952 net.cpp:156] Memory required for data: 32412
I0925 22:18:54.343930 25952 layer_factory.hpp:77] Creating layer lstm2
I0925 22:18:54.343955 25952 net.cpp:91] Creating Layer lstm2
I0925 22:18:54.343968 25952 net.cpp:425] lstm2 <- lstm1_video_sequence
I0925 22:18:54.343981 25952 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0925 22:18:54.343994 25952 net.cpp:399] lstm2 -> lstm2
I0925 22:18:54.344014 25952 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 22:18:54.344529 25952 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 22:18:54.344712 25952 layer_factory.hpp:77] Creating layer lstm2_
I0925 22:18:54.344738 25952 net.cpp:91] Creating Layer lstm2_
I0925 22:18:54.344753 25952 net.cpp:399] lstm2_ -> x
I0925 22:18:54.344779 25952 net.cpp:399] lstm2_ -> cont
I0925 22:18:54.344887 25952 net.cpp:141] Setting up lstm2_
I0925 22:18:54.344910 25952 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 22:18:54.344925 25952 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.344935 25952 net.cpp:156] Memory required for data: 6008
I0925 22:18:54.344946 25952 layer_factory.hpp:77] Creating layer lstm2_
I0925 22:18:54.344965 25952 net.cpp:91] Creating Layer lstm2_
I0925 22:18:54.344987 25952 net.cpp:399] lstm2_ -> c_0
I0925 22:18:54.345016 25952 net.cpp:399] lstm2_ -> h_0
I0925 22:18:54.345118 25952 net.cpp:141] Setting up lstm2_
I0925 22:18:54.345140 25952 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.345155 25952 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.345165 25952 net.cpp:156] Memory required for data: 14008
I0925 22:18:54.345175 25952 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0925 22:18:54.345201 25952 net.cpp:91] Creating Layer lstm2_cont_slice
I0925 22:18:54.345213 25952 net.cpp:425] lstm2_cont_slice <- cont
I0925 22:18:54.345230 25952 net.cpp:399] lstm2_cont_slice -> cont_1
I0925 22:18:54.345306 25952 net.cpp:141] Setting up lstm2_cont_slice
I0925 22:18:54.345327 25952 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.345337 25952 net.cpp:156] Memory required for data: 14012
I0925 22:18:54.345347 25952 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0925 22:18:54.345363 25952 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0925 22:18:54.345376 25952 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0925 22:18:54.345397 25952 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0925 22:18:54.345420 25952 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0925 22:18:54.345430 25920 net.cpp:141] Setting up lstm1_h_concat
I0925 22:18:54.345473 25920 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.345492 25920 net.cpp:156] Memory required for data: 94016
I0925 22:18:54.345512 25920 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 22:18:54.345540 25952 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0925 22:18:54.345552 25920 net.cpp:91] Creating Layer h_pseudoloss
I0925 22:18:54.345561 25952 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.345577 25920 net.cpp:425] h_pseudoloss <- h
I0925 22:18:54.345577 25952 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.345618 25952 net.cpp:156] Memory required for data: 14020
I0925 22:18:54.345630 25952 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0925 22:18:54.345633 25920 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 22:18:54.345659 25952 net.cpp:91] Creating Layer lstm2_x_transform
I0925 22:18:54.345672 25952 net.cpp:425] lstm2_x_transform <- x
I0925 22:18:54.345691 25952 net.cpp:399] lstm2_x_transform -> W_xc_x
I0925 22:18:54.345954 25920 net.cpp:141] Setting up h_pseudoloss
I0925 22:18:54.345980 25920 net.cpp:148] Top shape: (1)
I0925 22:18:54.345993 25920 net.cpp:151]     with loss weight 1
I0925 22:18:54.346024 25920 net.cpp:156] Memory required for data: 94020
I0925 22:18:54.346037 25920 net.cpp:217] h_pseudoloss needs backward computation.
I0925 22:18:54.346050 25920 net.cpp:217] lstm1_h_concat needs backward computation.
I0925 22:18:54.346062 25920 net.cpp:219] lstm1_ does not need backward computation.
I0925 22:18:54.346074 25920 net.cpp:217] lstm1_unit_1 needs backward computation.
I0925 22:18:54.346088 25920 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0925 22:18:54.346102 25920 net.cpp:217] lstm1_transform_1 needs backward computation.
I0925 22:18:54.346115 25920 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0925 22:18:54.346129 25920 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0925 22:18:54.346143 25920 net.cpp:217] lstm1_x_transform needs backward computation.
I0925 22:18:54.346155 25920 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0925 22:18:54.346168 25920 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0925 22:18:54.346182 25920 net.cpp:219] lstm1_ does not need backward computation.
I0925 22:18:54.346194 25920 net.cpp:219] lstm1_ does not need backward computation.
I0925 22:18:54.346204 25920 net.cpp:261] This network produces output c_T
I0925 22:18:54.346215 25920 net.cpp:261] This network produces output h_pseudoloss
I0925 22:18:54.346256 25920 net.cpp:274] Network initialization done.
I0925 22:18:54.346330 25920 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 22:18:54.346343 25920 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 22:18:54.346354 25920 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 22:18:54.363963 25922 net.cpp:141] Setting up embedding
I0925 22:18:54.364020 25922 net.cpp:148] Top shape: 1 1 500 (500)
I0925 22:18:54.364030 25922 net.cpp:156] Memory required for data: 22408
I0925 22:18:54.364058 25922 layer_factory.hpp:77] Creating layer lstm1
I0925 22:18:54.364089 25922 net.cpp:91] Creating Layer lstm1
I0925 22:18:54.364101 25922 net.cpp:425] lstm1 <- embedded_input_frames
I0925 22:18:54.364115 25922 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0925 22:18:54.364133 25922 net.cpp:399] lstm1 -> lstm1
I0925 22:18:54.364161 25922 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 22:18:54.364267 25920 net.cpp:141] Setting up lstm1
I0925 22:18:54.364287 25920 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.364295 25920 net.cpp:156] Memory required for data: 26408
I0925 22:18:54.364310 25920 layer_factory.hpp:77] Creating layer concat
I0925 22:18:54.364323 25920 net.cpp:91] Creating Layer concat
I0925 22:18:54.364331 25920 net.cpp:425] concat <- lstm1
I0925 22:18:54.364339 25920 net.cpp:425] concat <- embedded_input_sentence
I0925 22:18:54.364346 25920 net.cpp:425] concat <- reshaped_stage_indicator
I0925 22:18:54.364354 25920 net.cpp:399] concat -> lstm1_video_sequence
I0925 22:18:54.364403 25920 net.cpp:141] Setting up concat
I0925 22:18:54.364414 25920 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 22:18:54.364419 25920 net.cpp:156] Memory required for data: 32412
I0925 22:18:54.364425 25920 layer_factory.hpp:77] Creating layer lstm2
I0925 22:18:54.364439 25920 net.cpp:91] Creating Layer lstm2
I0925 22:18:54.364449 25920 net.cpp:425] lstm2 <- lstm1_video_sequence
I0925 22:18:54.364461 25920 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0925 22:18:54.364473 25920 net.cpp:399] lstm2 -> lstm2
I0925 22:18:54.364485 25920 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 22:18:54.364704 25922 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 22:18:54.364719 25920 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 22:18:54.364814 25946 net.cpp:141] Setting up lstm2_x_transform
I0925 22:18:54.364856 25946 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.364863 25920 layer_factory.hpp:77] Creating layer lstm2_
I0925 22:18:54.364864 25946 net.cpp:156] Memory required for data: 30020
I0925 22:18:54.364892 25920 net.cpp:91] Creating Layer lstm2_
I0925 22:18:54.364900 25920 net.cpp:399] lstm2_ -> x
I0925 22:18:54.364908 25946 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0925 22:18:54.364914 25920 net.cpp:399] lstm2_ -> cont
I0925 22:18:54.364928 25946 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0925 22:18:54.364924 25922 layer_factory.hpp:77] Creating layer lstm1_
I0925 22:18:54.364935 25946 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0925 22:18:54.364965 25922 net.cpp:91] Creating Layer lstm1_
I0925 22:18:54.364967 25946 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0925 22:18:54.364990 25922 net.cpp:399] lstm1_ -> x
I0925 22:18:54.365002 25920 net.cpp:141] Setting up lstm2_
I0925 22:18:54.365015 25920 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 22:18:54.365022 25920 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.365021 25922 net.cpp:399] lstm1_ -> cont
I0925 22:18:54.365027 25920 net.cpp:156] Memory required for data: 6008
I0925 22:18:54.365034 25920 layer_factory.hpp:77] Creating layer lstm2_
I0925 22:18:54.365046 25920 net.cpp:91] Creating Layer lstm2_
I0925 22:18:54.365057 25920 net.cpp:399] lstm2_ -> c_0
I0925 22:18:54.365066 25946 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0925 22:18:54.365070 25920 net.cpp:399] lstm2_ -> h_0
I0925 22:18:54.365078 25946 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.365084 25946 net.cpp:156] Memory required for data: 46020
I0925 22:18:54.365089 25946 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0925 22:18:54.365100 25946 net.cpp:91] Creating Layer lstm2_h_conted_0
I0925 22:18:54.365106 25946 net.cpp:425] lstm2_h_conted_0 <- h_0
I0925 22:18:54.365113 25946 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0925 22:18:54.365121 25946 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0925 22:18:54.365197 25920 net.cpp:141] Setting up lstm2_
I0925 22:18:54.365211 25920 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.365218 25920 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.365223 25920 net.cpp:156] Memory required for data: 14008
I0925 22:18:54.365228 25920 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0925 22:18:54.365243 25920 net.cpp:91] Creating Layer lstm2_cont_slice
I0925 22:18:54.365250 25920 net.cpp:425] lstm2_cont_slice <- cont
I0925 22:18:54.365259 25920 net.cpp:399] lstm2_cont_slice -> cont_1
I0925 22:18:54.365274 25922 net.cpp:141] Setting up lstm1_
I0925 22:18:54.365300 25922 net.cpp:148] Top shape: 1 1 500 (500)
I0925 22:18:54.365316 25922 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.365327 25922 net.cpp:156] Memory required for data: 2004
I0925 22:18:54.365339 25922 layer_factory.hpp:77] Creating layer lstm1_
I0925 22:18:54.365368 25922 net.cpp:91] Creating Layer lstm1_
I0925 22:18:54.365389 25922 net.cpp:399] lstm1_ -> c_0
I0925 22:18:54.365399 25946 net.cpp:141] Setting up lstm2_h_conted_0
I0925 22:18:54.365411 25946 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.365417 25946 net.cpp:156] Memory required for data: 50020
I0925 22:18:54.365417 25922 net.cpp:399] lstm1_ -> h_0
I0925 22:18:54.365422 25946 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0925 22:18:54.365443 25920 net.cpp:141] Setting up lstm2_cont_slice
I0925 22:18:54.365452 25946 net.cpp:91] Creating Layer lstm2_transform_1
I0925 22:18:54.365458 25920 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.365468 25920 net.cpp:156] Memory required for data: 14012
I0925 22:18:54.365478 25920 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0925 22:18:54.365458 25946 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0925 22:18:54.365489 25920 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0925 22:18:54.365496 25920 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0925 22:18:54.365496 25946 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0925 22:18:54.365510 25920 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0925 22:18:54.365521 25920 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0925 22:18:54.374064 25922 net.cpp:141] Setting up lstm1_
I0925 22:18:54.374120 25922 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.374126 25920 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0925 22:18:54.374132 25922 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.374163 25922 net.cpp:156] Memory required for data: 10004
I0925 22:18:54.374166 25920 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.374176 25922 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0925 22:18:54.374181 25920 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.374189 25920 net.cpp:156] Memory required for data: 14020
I0925 22:18:54.374199 25920 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0925 22:18:54.374202 25922 net.cpp:91] Creating Layer lstm1_cont_slice
I0925 22:18:54.374213 25922 net.cpp:425] lstm1_cont_slice <- cont
I0925 22:18:54.374229 25922 net.cpp:399] lstm1_cont_slice -> cont_1
I0925 22:18:54.374231 25920 net.cpp:91] Creating Layer lstm2_x_transform
I0925 22:18:54.374217 25928 net.cpp:141] Setting up lstm1_transform_1
I0925 22:18:54.374253 25920 net.cpp:425] lstm2_x_transform <- x
I0925 22:18:54.374285 25928 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.374296 25928 net.cpp:156] Memory required for data: 62016
I0925 22:18:54.374295 25920 net.cpp:399] lstm2_x_transform -> W_xc_x
I0925 22:18:54.374316 25922 net.cpp:141] Setting up lstm1_cont_slice
I0925 22:18:54.374322 25928 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0925 22:18:54.374331 25922 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.374339 25922 net.cpp:156] Memory required for data: 10008
I0925 22:18:54.374347 25922 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0925 22:18:54.374352 25928 net.cpp:91] Creating Layer lstm1_gate_input_1
I0925 22:18:54.374361 25922 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0925 22:18:54.374364 25928 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0925 22:18:54.374372 25922 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0925 22:18:54.374377 25928 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0925 22:18:54.374387 25922 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0925 22:18:54.374392 25928 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0925 22:18:54.374403 25922 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0925 22:18:54.387284 25928 net.cpp:141] Setting up lstm1_gate_input_1
I0925 22:18:54.387331 25928 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.387337 25928 net.cpp:156] Memory required for data: 78016
I0925 22:18:54.387347 25928 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0925 22:18:54.387385 25928 net.cpp:91] Creating Layer lstm1_unit_1
I0925 22:18:54.387398 25928 net.cpp:425] lstm1_unit_1 <- c_0
I0925 22:18:54.387415 25928 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0925 22:18:54.387423 25928 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0925 22:18:54.387433 25928 net.cpp:399] lstm1_unit_1 -> c_1
I0925 22:18:54.387447 25928 net.cpp:399] lstm1_unit_1 -> h_1
I0925 22:18:54.387492 25922 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0925 22:18:54.387550 25922 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.387576 25922 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.387594 25922 net.cpp:156] Memory required for data: 10016
I0925 22:18:54.387614 25928 net.cpp:141] Setting up lstm1_unit_1
I0925 22:18:54.387617 25922 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0925 22:18:54.387634 25928 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.387645 25928 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.387652 25928 net.cpp:156] Memory required for data: 86016
I0925 22:18:54.387661 25928 layer_factory.hpp:77] Creating layer lstm1_
I0925 22:18:54.387675 25928 net.cpp:91] Creating Layer lstm1_
I0925 22:18:54.387670 25922 net.cpp:91] Creating Layer lstm1_x_transform
I0925 22:18:54.387684 25928 net.cpp:425] lstm1_ <- c_1
I0925 22:18:54.387696 25922 net.cpp:425] lstm1_x_transform <- x
I0925 22:18:54.387702 25928 net.cpp:399] lstm1_ -> c_T
I0925 22:18:54.387754 25922 net.cpp:399] lstm1_x_transform -> W_xc_x
I0925 22:18:54.387785 25928 net.cpp:141] Setting up lstm1_
I0925 22:18:54.387802 25928 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.387809 25928 net.cpp:156] Memory required for data: 90016
I0925 22:18:54.387817 25928 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0925 22:18:54.387833 25928 net.cpp:91] Creating Layer lstm1_h_concat
I0925 22:18:54.387842 25928 net.cpp:425] lstm1_h_concat <- h_1
I0925 22:18:54.387861 25928 net.cpp:399] lstm1_h_concat -> h
I0925 22:18:54.394840 25928 net.cpp:141] Setting up lstm1_h_concat
I0925 22:18:54.394886 25928 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.394894 25928 net.cpp:156] Memory required for data: 94016
I0925 22:18:54.394906 25928 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 22:18:54.394930 25928 net.cpp:91] Creating Layer h_pseudoloss
I0925 22:18:54.394940 25928 net.cpp:425] h_pseudoloss <- h
I0925 22:18:54.394956 25928 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 22:18:54.395144 25928 net.cpp:141] Setting up h_pseudoloss
I0925 22:18:54.395166 25928 net.cpp:148] Top shape: (1)
I0925 22:18:54.395174 25928 net.cpp:151]     with loss weight 1
I0925 22:18:54.395197 25928 net.cpp:156] Memory required for data: 94020
I0925 22:18:54.395206 25928 net.cpp:217] h_pseudoloss needs backward computation.
I0925 22:18:54.395215 25928 net.cpp:217] lstm1_h_concat needs backward computation.
I0925 22:18:54.395223 25928 net.cpp:219] lstm1_ does not need backward computation.
I0925 22:18:54.395231 25928 net.cpp:217] lstm1_unit_1 needs backward computation.
I0925 22:18:54.395241 25928 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0925 22:18:54.395251 25928 net.cpp:217] lstm1_transform_1 needs backward computation.
I0925 22:18:54.395259 25928 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0925 22:18:54.395269 25928 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0925 22:18:54.395277 25928 net.cpp:217] lstm1_x_transform needs backward computation.
I0925 22:18:54.395287 25928 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0925 22:18:54.395297 25928 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0925 22:18:54.395305 25928 net.cpp:219] lstm1_ does not need backward computation.
I0925 22:18:54.395313 25928 net.cpp:219] lstm1_ does not need backward computation.
I0925 22:18:54.395319 25928 net.cpp:261] This network produces output c_T
I0925 22:18:54.395328 25928 net.cpp:261] This network produces output h_pseudoloss
I0925 22:18:54.395354 25928 net.cpp:274] Network initialization done.
I0925 22:18:54.395426 25928 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 22:18:54.395436 25928 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 22:18:54.395443 25928 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 22:18:54.396330 25928 net.cpp:141] Setting up lstm1
I0925 22:18:54.396348 25928 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.396356 25928 net.cpp:156] Memory required for data: 26408
I0925 22:18:54.396380 25928 layer_factory.hpp:77] Creating layer concat
I0925 22:18:54.396396 25928 net.cpp:91] Creating Layer concat
I0925 22:18:54.396405 25928 net.cpp:425] concat <- lstm1
I0925 22:18:54.396416 25928 net.cpp:425] concat <- embedded_input_sentence
I0925 22:18:54.396425 25928 net.cpp:425] concat <- reshaped_stage_indicator
I0925 22:18:54.396437 25928 net.cpp:399] concat -> lstm1_video_sequence
I0925 22:18:54.396641 25928 net.cpp:141] Setting up concat
I0925 22:18:54.396657 25928 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 22:18:54.396666 25928 net.cpp:156] Memory required for data: 32412
I0925 22:18:54.396673 25928 layer_factory.hpp:77] Creating layer lstm2
I0925 22:18:54.396692 25928 net.cpp:91] Creating Layer lstm2
I0925 22:18:54.396702 25928 net.cpp:425] lstm2 <- lstm1_video_sequence
I0925 22:18:54.396711 25928 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0925 22:18:54.396724 25928 net.cpp:399] lstm2 -> lstm2
I0925 22:18:54.396740 25928 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 22:18:54.397192 25928 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 22:18:54.410670 25928 layer_factory.hpp:77] Creating layer lstm2_
I0925 22:18:54.410735 25928 net.cpp:91] Creating Layer lstm2_
I0925 22:18:54.410745 25928 net.cpp:399] lstm2_ -> x
I0925 22:18:54.410770 25928 net.cpp:399] lstm2_ -> cont
I0925 22:18:54.414064 25946 net.cpp:141] Setting up lstm2_transform_1
I0925 22:18:54.414085 25928 net.cpp:141] Setting up lstm2_
I0925 22:18:54.414098 25946 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.414104 25928 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 22:18:54.414108 25946 net.cpp:156] Memory required for data: 66020
I0925 22:18:54.414111 25928 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.414125 25928 net.cpp:156] Memory required for data: 6008
I0925 22:18:54.414132 25928 layer_factory.hpp:77] Creating layer lstm2_
I0925 22:18:54.414135 25946 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0925 22:18:54.414155 25928 net.cpp:91] Creating Layer lstm2_
I0925 22:18:54.414155 25946 net.cpp:91] Creating Layer lstm2_gate_input_1
I0925 22:18:54.414163 25928 net.cpp:399] lstm2_ -> c_0
I0925 22:18:54.414166 25946 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0925 22:18:54.414177 25946 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0925 22:18:54.414178 25928 net.cpp:399] lstm2_ -> h_0
I0925 22:18:54.414194 25946 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0925 22:18:54.416512 25928 net.cpp:141] Setting up lstm2_
I0925 22:18:54.416529 25928 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.416535 25928 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.416540 25928 net.cpp:156] Memory required for data: 14008
I0925 22:18:54.416548 25928 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0925 22:18:54.416566 25928 net.cpp:91] Creating Layer lstm2_cont_slice
I0925 22:18:54.416566 25946 net.cpp:141] Setting up lstm2_gate_input_1
I0925 22:18:54.416574 25928 net.cpp:425] lstm2_cont_slice <- cont
I0925 22:18:54.416584 25928 net.cpp:399] lstm2_cont_slice -> cont_1
I0925 22:18:54.416584 25946 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.416594 25946 net.cpp:156] Memory required for data: 82020
I0925 22:18:54.416601 25946 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0925 22:18:54.416618 25946 net.cpp:91] Creating Layer lstm2_unit_1
I0925 22:18:54.416626 25946 net.cpp:425] lstm2_unit_1 <- c_0
I0925 22:18:54.416636 25946 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0925 22:18:54.416646 25946 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0925 22:18:54.416658 25946 net.cpp:399] lstm2_unit_1 -> c_1
I0925 22:18:54.416674 25946 net.cpp:399] lstm2_unit_1 -> h_1
I0925 22:18:54.421963 25928 net.cpp:141] Setting up lstm2_cont_slice
I0925 22:18:54.421991 25928 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.421996 25928 net.cpp:156] Memory required for data: 14012
I0925 22:18:54.422003 25928 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0925 22:18:54.422020 25928 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0925 22:18:54.422026 25928 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0925 22:18:54.422039 25928 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0925 22:18:54.422051 25928 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0925 22:18:54.422212 25946 net.cpp:141] Setting up lstm2_unit_1
I0925 22:18:54.422235 25946 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.422242 25946 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.422247 25946 net.cpp:156] Memory required for data: 90020
I0925 22:18:54.422252 25946 layer_factory.hpp:77] Creating layer lstm2_
I0925 22:18:54.422261 25946 net.cpp:91] Creating Layer lstm2_
I0925 22:18:54.422266 25946 net.cpp:425] lstm2_ <- c_1
I0925 22:18:54.422279 25946 net.cpp:399] lstm2_ -> c_T
I0925 22:18:54.422339 25946 net.cpp:141] Setting up lstm2_
I0925 22:18:54.422353 25946 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.422356 25946 net.cpp:156] Memory required for data: 94020
I0925 22:18:54.422361 25946 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0925 22:18:54.422374 25946 net.cpp:91] Creating Layer lstm2_h_concat
I0925 22:18:54.422380 25946 net.cpp:425] lstm2_h_concat <- h_1
I0925 22:18:54.422389 25946 net.cpp:399] lstm2_h_concat -> h
I0925 22:18:54.422415 25928 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0925 22:18:54.422432 25928 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.422438 25928 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.422443 25928 net.cpp:156] Memory required for data: 14020
I0925 22:18:54.422443 25946 net.cpp:141] Setting up lstm2_h_concat
I0925 22:18:54.422451 25928 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0925 22:18:54.422458 25946 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.422467 25946 net.cpp:156] Memory required for data: 98020
I0925 22:18:54.422468 25928 net.cpp:91] Creating Layer lstm2_x_transform
I0925 22:18:54.422472 25946 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 22:18:54.422474 25928 net.cpp:425] lstm2_x_transform <- x
I0925 22:18:54.422482 25946 net.cpp:91] Creating Layer h_pseudoloss
I0925 22:18:54.422487 25946 net.cpp:425] h_pseudoloss <- h
I0925 22:18:54.422488 25928 net.cpp:399] lstm2_x_transform -> W_xc_x
I0925 22:18:54.422497 25946 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 22:18:54.433688 25918 net.cpp:141] Setting up embedding
I0925 22:18:54.433755 25918 net.cpp:148] Top shape: 1 1 500 (500)
I0925 22:18:54.433768 25918 net.cpp:156] Memory required for data: 22408
I0925 22:18:54.433773 25946 net.cpp:141] Setting up h_pseudoloss
I0925 22:18:54.433799 25918 layer_factory.hpp:77] Creating layer lstm1
I0925 22:18:54.433809 25946 net.cpp:148] Top shape: (1)
I0925 22:18:54.433815 25946 net.cpp:151]     with loss weight 1
I0925 22:18:54.433828 25918 net.cpp:91] Creating Layer lstm1
I0925 22:18:54.433836 25946 net.cpp:156] Memory required for data: 98024
I0925 22:18:54.433832 25922 net.cpp:141] Setting up lstm1_x_transform
I0925 22:18:54.433846 25946 net.cpp:217] h_pseudoloss needs backward computation.
I0925 22:18:54.433846 25918 net.cpp:425] lstm1 <- embedded_input_frames
I0925 22:18:54.433854 25946 net.cpp:217] lstm2_h_concat needs backward computation.
I0925 22:18:54.433858 25922 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.433863 25918 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0925 22:18:54.433887 25918 net.cpp:399] lstm1 -> lstm1
I0925 22:18:54.433892 25922 net.cpp:156] Memory required for data: 26016
I0925 22:18:54.433861 25946 net.cpp:219] lstm2_ does not need backward computation.
I0925 22:18:54.433917 25918 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 22:18:54.433923 25946 net.cpp:217] lstm2_unit_1 needs backward computation.
I0925 22:18:54.433938 25946 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0925 22:18:54.433919 25922 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0925 22:18:54.433948 25946 net.cpp:217] lstm2_transform_1 needs backward computation.
I0925 22:18:54.433960 25946 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0925 22:18:54.433965 25922 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0925 22:18:54.433971 25946 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0925 22:18:54.433977 25922 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0925 22:18:54.433984 25946 net.cpp:217] lstm2_x_transform needs backward computation.
I0925 22:18:54.433993 25922 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0925 22:18:54.433995 25946 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0925 22:18:54.434010 25946 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0925 22:18:54.434020 25946 net.cpp:219] lstm2_ does not need backward computation.
I0925 22:18:54.434028 25946 net.cpp:219] lstm2_ does not need backward computation.
I0925 22:18:54.434034 25946 net.cpp:261] This network produces output c_T
I0925 22:18:54.434043 25946 net.cpp:261] This network produces output h_pseudoloss
I0925 22:18:54.434075 25946 net.cpp:274] Network initialization done.
I0925 22:18:54.434161 25946 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 22:18:54.434175 25946 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 22:18:54.434183 25946 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 22:18:54.434226 25922 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0925 22:18:54.434244 25922 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.434253 25922 net.cpp:156] Memory required for data: 42016
I0925 22:18:54.434262 25922 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0925 22:18:54.434278 25922 net.cpp:91] Creating Layer lstm1_h_conted_0
I0925 22:18:54.434288 25922 net.cpp:425] lstm1_h_conted_0 <- h_0
I0925 22:18:54.434298 25922 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0925 22:18:54.434312 25922 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0925 22:18:54.434475 25918 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 22:18:54.434659 25918 layer_factory.hpp:77] Creating layer lstm1_
I0925 22:18:54.434686 25918 net.cpp:91] Creating Layer lstm1_
I0925 22:18:54.434700 25918 net.cpp:399] lstm1_ -> x
I0925 22:18:54.434722 25918 net.cpp:399] lstm1_ -> cont
I0925 22:18:54.434815 25922 net.cpp:141] Setting up lstm1_h_conted_0
I0925 22:18:54.434834 25922 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.434842 25922 net.cpp:156] Memory required for data: 46016
I0925 22:18:54.434851 25922 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0925 22:18:54.434869 25922 net.cpp:91] Creating Layer lstm1_transform_1
I0925 22:18:54.434877 25922 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0925 22:18:54.434885 25946 net.cpp:141] Setting up lstm2
I0925 22:18:54.434898 25922 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0925 22:18:54.434909 25946 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.434921 25946 net.cpp:156] Memory required for data: 36412
I0925 22:18:54.434952 25946 layer_factory.hpp:77] Creating layer predict
I0925 22:18:54.434979 25946 net.cpp:91] Creating Layer predict
I0925 22:18:54.434993 25946 net.cpp:425] predict <- lstm2
I0925 22:18:54.435010 25946 net.cpp:399] predict -> predict
I0925 22:18:54.435302 25918 net.cpp:141] Setting up lstm1_
I0925 22:18:54.435323 25918 net.cpp:148] Top shape: 1 1 500 (500)
I0925 22:18:54.435338 25918 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.435345 25918 net.cpp:156] Memory required for data: 2004
I0925 22:18:54.435356 25918 layer_factory.hpp:77] Creating layer lstm1_
I0925 22:18:54.435372 25918 net.cpp:91] Creating Layer lstm1_
I0925 22:18:54.435391 25918 net.cpp:399] lstm1_ -> c_0
I0925 22:18:54.435415 25918 net.cpp:399] lstm1_ -> h_0
I0925 22:18:54.521215 25952 net.cpp:141] Setting up lstm2_x_transform
I0925 22:18:54.521265 25952 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.521272 25952 net.cpp:156] Memory required for data: 30020
I0925 22:18:54.521299 25952 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0925 22:18:54.521318 25952 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0925 22:18:54.521327 25952 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0925 22:18:54.521337 25952 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0925 22:18:54.529330 25952 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0925 22:18:54.529350 25952 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.529356 25952 net.cpp:156] Memory required for data: 46020
I0925 22:18:54.529361 25952 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0925 22:18:54.529381 25952 net.cpp:91] Creating Layer lstm2_h_conted_0
I0925 22:18:54.529387 25952 net.cpp:425] lstm2_h_conted_0 <- h_0
I0925 22:18:54.529395 25952 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0925 22:18:54.529405 25952 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0925 22:18:54.540875 25920 net.cpp:141] Setting up lstm2_x_transform
I0925 22:18:54.540920 25920 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.540926 25920 net.cpp:156] Memory required for data: 30020
I0925 22:18:54.540946 25920 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0925 22:18:54.540962 25920 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0925 22:18:54.540969 25920 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0925 22:18:54.540979 25920 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0925 22:18:54.540992 25918 net.cpp:141] Setting up lstm1_
I0925 22:18:54.541015 25918 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.541023 25918 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.541028 25918 net.cpp:156] Memory required for data: 10004
I0925 22:18:54.541034 25918 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0925 22:18:54.541050 25918 net.cpp:91] Creating Layer lstm1_cont_slice
I0925 22:18:54.541057 25918 net.cpp:425] lstm1_cont_slice <- cont
I0925 22:18:54.541066 25918 net.cpp:399] lstm1_cont_slice -> cont_1
I0925 22:18:54.541132 25918 net.cpp:141] Setting up lstm1_cont_slice
I0925 22:18:54.541144 25918 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.541149 25918 net.cpp:156] Memory required for data: 10008
I0925 22:18:54.541155 25918 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0925 22:18:54.541164 25918 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0925 22:18:54.541170 25918 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0925 22:18:54.541177 25920 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0925 22:18:54.541182 25918 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0925 22:18:54.541191 25920 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.541194 25918 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0925 22:18:54.541198 25920 net.cpp:156] Memory required for data: 46020
I0925 22:18:54.541203 25920 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0925 22:18:54.541219 25920 net.cpp:91] Creating Layer lstm2_h_conted_0
I0925 22:18:54.541226 25920 net.cpp:425] lstm2_h_conted_0 <- h_0
I0925 22:18:54.541234 25920 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0925 22:18:54.541242 25920 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0925 22:18:54.541267 25918 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0925 22:18:54.541280 25918 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.541286 25918 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.541291 25918 net.cpp:156] Memory required for data: 10016
I0925 22:18:54.541296 25918 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0925 22:18:54.541316 25918 net.cpp:91] Creating Layer lstm1_x_transform
I0925 22:18:54.541321 25918 net.cpp:425] lstm1_x_transform <- x
I0925 22:18:54.541332 25918 net.cpp:399] lstm1_x_transform -> W_xc_x
I0925 22:18:54.541359 25952 net.cpp:141] Setting up lstm2_h_conted_0
I0925 22:18:54.541380 25952 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.541386 25952 net.cpp:156] Memory required for data: 50020
I0925 22:18:54.541393 25952 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0925 22:18:54.541406 25952 net.cpp:91] Creating Layer lstm2_transform_1
I0925 22:18:54.541414 25952 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0925 22:18:54.541424 25952 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0925 22:18:54.551035 25928 net.cpp:141] Setting up lstm2_x_transform
I0925 22:18:54.551084 25928 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.551090 25928 net.cpp:156] Memory required for data: 30020
I0925 22:18:54.551115 25928 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0925 22:18:54.551133 25928 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0925 22:18:54.551141 25928 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0925 22:18:54.551149 25928 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0925 22:18:54.559368 25920 net.cpp:141] Setting up lstm2_h_conted_0
I0925 22:18:54.559417 25920 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.559413 25928 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0925 22:18:54.559424 25920 net.cpp:156] Memory required for data: 50020
I0925 22:18:54.559434 25928 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.559447 25928 net.cpp:156] Memory required for data: 46020
I0925 22:18:54.559434 25920 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0925 22:18:54.559453 25928 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0925 22:18:54.559465 25928 net.cpp:91] Creating Layer lstm2_h_conted_0
I0925 22:18:54.559471 25928 net.cpp:425] lstm2_h_conted_0 <- h_0
I0925 22:18:54.559471 25920 net.cpp:91] Creating Layer lstm2_transform_1
I0925 22:18:54.559478 25928 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0925 22:18:54.559481 25920 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0925 22:18:54.559487 25928 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0925 22:18:54.559496 25920 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0925 22:18:54.566130 25928 net.cpp:141] Setting up lstm2_h_conted_0
I0925 22:18:54.566166 25928 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.566171 25928 net.cpp:156] Memory required for data: 50020
I0925 22:18:54.566179 25928 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0925 22:18:54.566196 25928 net.cpp:91] Creating Layer lstm2_transform_1
I0925 22:18:54.566203 25928 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0925 22:18:54.566218 25928 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0925 22:18:54.573807 25918 net.cpp:141] Setting up lstm1_x_transform
I0925 22:18:54.573861 25918 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.573868 25918 net.cpp:156] Memory required for data: 26016
I0925 22:18:54.573892 25918 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0925 22:18:54.573935 25918 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0925 22:18:54.573945 25918 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0925 22:18:54.573957 25918 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0925 22:18:54.582345 25918 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0925 22:18:54.582399 25918 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.582406 25918 net.cpp:156] Memory required for data: 42016
I0925 22:18:54.582406 25922 net.cpp:141] Setting up lstm1_transform_1
I0925 22:18:54.582415 25918 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0925 22:18:54.582433 25922 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.582439 25922 net.cpp:156] Memory required for data: 62016
I0925 22:18:54.582454 25918 net.cpp:91] Creating Layer lstm1_h_conted_0
I0925 22:18:54.582459 25922 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0925 22:18:54.582463 25918 net.cpp:425] lstm1_h_conted_0 <- h_0
I0925 22:18:54.582473 25918 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0925 22:18:54.582476 25922 net.cpp:91] Creating Layer lstm1_gate_input_1
I0925 22:18:54.582484 25922 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0925 22:18:54.582484 25918 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0925 22:18:54.582492 25922 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0925 22:18:54.582505 25922 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0925 22:18:54.582665 25918 net.cpp:141] Setting up lstm1_h_conted_0
I0925 22:18:54.582679 25918 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.582684 25918 net.cpp:156] Memory required for data: 46016
I0925 22:18:54.582690 25918 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0925 22:18:54.582703 25922 net.cpp:141] Setting up lstm1_gate_input_1
I0925 22:18:54.582710 25918 net.cpp:91] Creating Layer lstm1_transform_1
I0925 22:18:54.582716 25922 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.582717 25918 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0925 22:18:54.582723 25922 net.cpp:156] Memory required for data: 78016
I0925 22:18:54.582728 25922 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0925 22:18:54.582728 25918 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0925 22:18:54.582746 25922 net.cpp:91] Creating Layer lstm1_unit_1
I0925 22:18:54.582751 25922 net.cpp:425] lstm1_unit_1 <- c_0
I0925 22:18:54.582758 25922 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0925 22:18:54.582764 25922 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0925 22:18:54.582772 25922 net.cpp:399] lstm1_unit_1 -> c_1
I0925 22:18:54.582787 25922 net.cpp:399] lstm1_unit_1 -> h_1
I0925 22:18:54.582887 25922 net.cpp:141] Setting up lstm1_unit_1
I0925 22:18:54.582900 25922 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.582906 25922 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.582911 25922 net.cpp:156] Memory required for data: 86016
I0925 22:18:54.582916 25922 layer_factory.hpp:77] Creating layer lstm1_
I0925 22:18:54.582926 25922 net.cpp:91] Creating Layer lstm1_
I0925 22:18:54.582931 25922 net.cpp:425] lstm1_ <- c_1
I0925 22:18:54.582939 25922 net.cpp:399] lstm1_ -> c_T
I0925 22:18:54.591316 25922 net.cpp:141] Setting up lstm1_
I0925 22:18:54.591374 25922 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.591382 25922 net.cpp:156] Memory required for data: 90016
I0925 22:18:54.591392 25922 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0925 22:18:54.591411 25922 net.cpp:91] Creating Layer lstm1_h_concat
I0925 22:18:54.591419 25922 net.cpp:425] lstm1_h_concat <- h_1
I0925 22:18:54.591435 25922 net.cpp:399] lstm1_h_concat -> h
I0925 22:18:54.595213 25922 net.cpp:141] Setting up lstm1_h_concat
I0925 22:18:54.595262 25922 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.595268 25922 net.cpp:156] Memory required for data: 94016
I0925 22:18:54.595275 25922 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 22:18:54.595285 25952 net.cpp:141] Setting up lstm2_transform_1
I0925 22:18:54.595300 25922 net.cpp:91] Creating Layer h_pseudoloss
I0925 22:18:54.595307 25952 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.595309 25922 net.cpp:425] h_pseudoloss <- h
I0925 22:18:54.595314 25952 net.cpp:156] Memory required for data: 66020
I0925 22:18:54.595321 25922 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 22:18:54.595329 25952 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0925 22:18:54.595350 25952 net.cpp:91] Creating Layer lstm2_gate_input_1
I0925 22:18:54.595357 25952 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0925 22:18:54.595366 25952 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0925 22:18:54.595374 25952 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0925 22:18:54.595546 25952 net.cpp:141] Setting up lstm2_gate_input_1
I0925 22:18:54.595559 25952 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.595564 25952 net.cpp:156] Memory required for data: 82020
I0925 22:18:54.595569 25952 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0925 22:18:54.595580 25952 net.cpp:91] Creating Layer lstm2_unit_1
I0925 22:18:54.595587 25952 net.cpp:425] lstm2_unit_1 <- c_0
I0925 22:18:54.595593 25952 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0925 22:18:54.595599 25952 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0925 22:18:54.595607 25952 net.cpp:399] lstm2_unit_1 -> c_1
I0925 22:18:54.595618 25952 net.cpp:399] lstm2_unit_1 -> h_1
I0925 22:18:54.601081 25922 net.cpp:141] Setting up h_pseudoloss
I0925 22:18:54.601102 25922 net.cpp:148] Top shape: (1)
I0925 22:18:54.601109 25922 net.cpp:151]     with loss weight 1
I0925 22:18:54.601130 25922 net.cpp:156] Memory required for data: 94020
I0925 22:18:54.601136 25922 net.cpp:217] h_pseudoloss needs backward computation.
I0925 22:18:54.601143 25922 net.cpp:217] lstm1_h_concat needs backward computation.
I0925 22:18:54.601150 25922 net.cpp:219] lstm1_ does not need backward computation.
I0925 22:18:54.601155 25922 net.cpp:217] lstm1_unit_1 needs backward computation.
I0925 22:18:54.601162 25922 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0925 22:18:54.601168 25922 net.cpp:217] lstm1_transform_1 needs backward computation.
I0925 22:18:54.601174 25922 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0925 22:18:54.601181 25922 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0925 22:18:54.601187 25922 net.cpp:217] lstm1_x_transform needs backward computation.
I0925 22:18:54.601193 25922 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0925 22:18:54.601199 25922 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0925 22:18:54.601207 25922 net.cpp:219] lstm1_ does not need backward computation.
I0925 22:18:54.601203 25952 net.cpp:141] Setting up lstm2_unit_1
I0925 22:18:54.601212 25922 net.cpp:219] lstm1_ does not need backward computation.
I0925 22:18:54.601227 25922 net.cpp:261] This network produces output c_T
I0925 22:18:54.601229 25952 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.601233 25922 net.cpp:261] This network produces output h_pseudoloss
I0925 22:18:54.601238 25952 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.601243 25952 net.cpp:156] Memory required for data: 90020
I0925 22:18:54.601249 25952 layer_factory.hpp:77] Creating layer lstm2_
I0925 22:18:54.601256 25922 net.cpp:274] Network initialization done.
I0925 22:18:54.601263 25952 net.cpp:91] Creating Layer lstm2_
I0925 22:18:54.601270 25952 net.cpp:425] lstm2_ <- c_1
I0925 22:18:54.601279 25952 net.cpp:399] lstm2_ -> c_T
I0925 22:18:54.601312 25922 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 22:18:54.601320 25922 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 22:18:54.601325 25922 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 22:18:54.601443 25952 net.cpp:141] Setting up lstm2_
I0925 22:18:54.601455 25952 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.601460 25952 net.cpp:156] Memory required for data: 94020
I0925 22:18:54.601465 25952 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0925 22:18:54.601476 25952 net.cpp:91] Creating Layer lstm2_h_concat
I0925 22:18:54.601482 25952 net.cpp:425] lstm2_h_concat <- h_1
I0925 22:18:54.601495 25952 net.cpp:399] lstm2_h_concat -> h
I0925 22:18:54.608330 25922 net.cpp:141] Setting up lstm1
I0925 22:18:54.608353 25922 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.608360 25922 net.cpp:156] Memory required for data: 26408
I0925 22:18:54.608376 25922 layer_factory.hpp:77] Creating layer concat
I0925 22:18:54.608387 25922 net.cpp:91] Creating Layer concat
I0925 22:18:54.608393 25922 net.cpp:425] concat <- lstm1
I0925 22:18:54.608395 25952 net.cpp:141] Setting up lstm2_h_concat
I0925 22:18:54.608402 25922 net.cpp:425] concat <- embedded_input_sentence
I0925 22:18:54.608420 25952 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.608422 25922 net.cpp:425] concat <- reshaped_stage_indicator
I0925 22:18:54.608428 25952 net.cpp:156] Memory required for data: 98020
I0925 22:18:54.608433 25922 net.cpp:399] concat -> lstm1_video_sequence
I0925 22:18:54.608433 25952 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 22:18:54.608445 25952 net.cpp:91] Creating Layer h_pseudoloss
I0925 22:18:54.608453 25952 net.cpp:425] h_pseudoloss <- h
I0925 22:18:54.608461 25952 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 22:18:54.608505 25928 net.cpp:141] Setting up lstm2_transform_1
I0925 22:18:54.608546 25928 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.608551 25928 net.cpp:156] Memory required for data: 66020
I0925 22:18:54.608569 25928 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0925 22:18:54.608588 25928 net.cpp:91] Creating Layer lstm2_gate_input_1
I0925 22:18:54.608595 25928 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0925 22:18:54.608597 25952 net.cpp:141] Setting up h_pseudoloss
I0925 22:18:54.608604 25928 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0925 22:18:54.608611 25952 net.cpp:148] Top shape: (1)
I0925 22:18:54.608619 25928 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0925 22:18:54.608618 25952 net.cpp:151]     with loss weight 1
I0925 22:18:54.608629 25952 net.cpp:156] Memory required for data: 98024
I0925 22:18:54.608633 25922 net.cpp:141] Setting up concat
I0925 22:18:54.608635 25952 net.cpp:217] h_pseudoloss needs backward computation.
I0925 22:18:54.608651 25922 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 22:18:54.608654 25952 net.cpp:217] lstm2_h_concat needs backward computation.
I0925 22:18:54.608657 25922 net.cpp:156] Memory required for data: 32412
I0925 22:18:54.608659 25952 net.cpp:219] lstm2_ does not need backward computation.
I0925 22:18:54.608664 25922 layer_factory.hpp:77] Creating layer lstm2
I0925 22:18:54.608665 25952 net.cpp:217] lstm2_unit_1 needs backward computation.
I0925 22:18:54.608672 25952 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0925 22:18:54.608678 25922 net.cpp:91] Creating Layer lstm2
I0925 22:18:54.608680 25952 net.cpp:217] lstm2_transform_1 needs backward computation.
I0925 22:18:54.608686 25928 net.cpp:141] Setting up lstm2_gate_input_1
I0925 22:18:54.608688 25922 net.cpp:425] lstm2 <- lstm1_video_sequence
I0925 22:18:54.608700 25952 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0925 22:18:54.608705 25928 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.608706 25922 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0925 22:18:54.608711 25928 net.cpp:156] Memory required for data: 82020
I0925 22:18:54.608708 25952 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0925 22:18:54.608717 25928 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0925 22:18:54.608718 25922 net.cpp:399] lstm2 -> lstm2
I0925 22:18:54.608719 25952 net.cpp:217] lstm2_x_transform needs backward computation.
I0925 22:18:54.608728 25928 net.cpp:91] Creating Layer lstm2_unit_1
I0925 22:18:54.608733 25952 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0925 22:18:54.608734 25928 net.cpp:425] lstm2_unit_1 <- c_0
I0925 22:18:54.608736 25922 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 22:18:54.608741 25952 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0925 22:18:54.608742 25928 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0925 22:18:54.608750 25952 net.cpp:219] lstm2_ does not need backward computation.
I0925 22:18:54.608762 25952 net.cpp:219] lstm2_ does not need backward computation.
I0925 22:18:54.608750 25928 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0925 22:18:54.608767 25952 net.cpp:261] This network produces output c_T
I0925 22:18:54.608772 25928 net.cpp:399] lstm2_unit_1 -> c_1
I0925 22:18:54.608773 25952 net.cpp:261] This network produces output h_pseudoloss
I0925 22:18:54.608790 25928 net.cpp:399] lstm2_unit_1 -> h_1
I0925 22:18:54.608801 25952 net.cpp:274] Network initialization done.
I0925 22:18:54.608850 25952 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 22:18:54.608856 25952 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 22:18:54.608861 25952 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 22:18:54.608979 25928 net.cpp:141] Setting up lstm2_unit_1
I0925 22:18:54.608991 25928 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.608997 25928 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.609001 25928 net.cpp:156] Memory required for data: 90020
I0925 22:18:54.609006 25928 layer_factory.hpp:77] Creating layer lstm2_
I0925 22:18:54.609014 25928 net.cpp:91] Creating Layer lstm2_
I0925 22:18:54.609019 25928 net.cpp:425] lstm2_ <- c_1
I0925 22:18:54.609027 25928 net.cpp:399] lstm2_ -> c_T
I0925 22:18:54.609026 25922 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 22:18:54.609035 25952 net.cpp:141] Setting up lstm2
I0925 22:18:54.609050 25952 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.609055 25952 net.cpp:156] Memory required for data: 36412
I0925 22:18:54.609071 25952 layer_factory.hpp:77] Creating layer predict
I0925 22:18:54.609084 25952 net.cpp:91] Creating Layer predict
I0925 22:18:54.609083 25928 net.cpp:141] Setting up lstm2_
I0925 22:18:54.609097 25952 net.cpp:425] predict <- lstm2
I0925 22:18:54.609109 25928 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.609114 25928 net.cpp:156] Memory required for data: 94020
I0925 22:18:54.609118 25952 net.cpp:399] predict -> predict
I0925 22:18:54.609119 25928 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0925 22:18:54.609129 25922 layer_factory.hpp:77] Creating layer lstm2_
I0925 22:18:54.609139 25928 net.cpp:91] Creating Layer lstm2_h_concat
I0925 22:18:54.609144 25922 net.cpp:91] Creating Layer lstm2_
I0925 22:18:54.609146 25928 net.cpp:425] lstm2_h_concat <- h_1
I0925 22:18:54.609153 25922 net.cpp:399] lstm2_ -> x
I0925 22:18:54.609158 25928 net.cpp:399] lstm2_h_concat -> h
I0925 22:18:54.609166 25922 net.cpp:399] lstm2_ -> cont
I0925 22:18:54.704306 25922 net.cpp:141] Setting up lstm2_
I0925 22:18:54.704345 25920 net.cpp:141] Setting up lstm2_transform_1
I0925 22:18:54.704367 25920 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.704366 25922 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 22:18:54.704385 25920 net.cpp:156] Memory required for data: 66020
I0925 22:18:54.704404 25922 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.704413 25922 net.cpp:156] Memory required for data: 6008
I0925 22:18:54.704422 25920 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0925 22:18:54.704423 25922 layer_factory.hpp:77] Creating layer lstm2_
I0925 22:18:54.704448 25920 net.cpp:91] Creating Layer lstm2_gate_input_1
I0925 22:18:54.704450 25922 net.cpp:91] Creating Layer lstm2_
I0925 22:18:54.704457 25920 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0925 22:18:54.704450 25928 net.cpp:141] Setting up lstm2_h_concat
I0925 22:18:54.704468 25920 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0925 22:18:54.704475 25922 net.cpp:399] lstm2_ -> c_0
I0925 22:18:54.704504 25920 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0925 22:18:54.704504 25918 net.cpp:141] Setting up lstm1_transform_1
I0925 22:18:54.704496 25928 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.704530 25918 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.704535 25928 net.cpp:156] Memory required for data: 98020
I0925 22:18:54.704529 25922 net.cpp:399] lstm2_ -> h_0
I0925 22:18:54.704546 25928 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 22:18:54.704541 25918 net.cpp:156] Memory required for data: 62016
I0925 22:18:54.704566 25918 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0925 22:18:54.704579 25928 net.cpp:91] Creating Layer h_pseudoloss
I0925 22:18:54.704586 25918 net.cpp:91] Creating Layer lstm1_gate_input_1
I0925 22:18:54.704588 25928 net.cpp:425] h_pseudoloss <- h
I0925 22:18:54.704596 25918 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0925 22:18:54.704602 25928 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 22:18:54.704604 25918 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0925 22:18:54.704615 25918 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0925 22:18:54.714987 25920 net.cpp:141] Setting up lstm2_gate_input_1
I0925 22:18:54.715040 25920 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.715047 25920 net.cpp:156] Memory required for data: 82020
I0925 22:18:54.715057 25920 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0925 22:18:54.715062 25922 net.cpp:141] Setting up lstm2_
I0925 22:18:54.715085 25920 net.cpp:91] Creating Layer lstm2_unit_1
I0925 22:18:54.715090 25922 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.715092 25920 net.cpp:425] lstm2_unit_1 <- c_0
I0925 22:18:54.715111 25922 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.715116 25920 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0925 22:18:54.715119 25922 net.cpp:156] Memory required for data: 14008
I0925 22:18:54.715124 25920 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0925 22:18:54.715129 25922 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0925 22:18:54.715134 25920 net.cpp:399] lstm2_unit_1 -> c_1
I0925 22:18:54.715150 25920 net.cpp:399] lstm2_unit_1 -> h_1
I0925 22:18:54.715155 25922 net.cpp:91] Creating Layer lstm2_cont_slice
I0925 22:18:54.715167 25922 net.cpp:425] lstm2_cont_slice <- cont
I0925 22:18:54.715181 25922 net.cpp:399] lstm2_cont_slice -> cont_1
I0925 22:18:54.715277 25922 net.cpp:141] Setting up lstm2_cont_slice
I0925 22:18:54.715292 25922 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.715299 25922 net.cpp:156] Memory required for data: 14012
I0925 22:18:54.715307 25922 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0925 22:18:54.715322 25922 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0925 22:18:54.715330 25922 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0925 22:18:54.715339 25918 net.cpp:141] Setting up lstm1_gate_input_1
I0925 22:18:54.715347 25922 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0925 22:18:54.715365 25918 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.715373 25918 net.cpp:156] Memory required for data: 78016
I0925 22:18:54.715375 25922 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0925 22:18:54.715378 25918 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0925 22:18:54.715399 25918 net.cpp:91] Creating Layer lstm1_unit_1
I0925 22:18:54.715407 25918 net.cpp:425] lstm1_unit_1 <- c_0
I0925 22:18:54.715415 25918 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0925 22:18:54.715422 25918 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0925 22:18:54.715421 25920 net.cpp:141] Setting up lstm2_unit_1
I0925 22:18:54.715431 25918 net.cpp:399] lstm1_unit_1 -> c_1
I0925 22:18:54.715435 25920 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.715445 25920 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.715443 25918 net.cpp:399] lstm1_unit_1 -> h_1
I0925 22:18:54.715454 25920 net.cpp:156] Memory required for data: 90020
I0925 22:18:54.715461 25920 layer_factory.hpp:77] Creating layer lstm2_
I0925 22:18:54.715473 25920 net.cpp:91] Creating Layer lstm2_
I0925 22:18:54.715479 25920 net.cpp:425] lstm2_ <- c_1
I0925 22:18:54.715488 25920 net.cpp:399] lstm2_ -> c_T
I0925 22:18:54.718999 25922 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0925 22:18:54.719049 25922 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.719061 25922 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.719069 25920 net.cpp:141] Setting up lstm2_
I0925 22:18:54.719069 25922 net.cpp:156] Memory required for data: 14020
I0925 22:18:54.719101 25920 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.719105 25922 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0925 22:18:54.719108 25920 net.cpp:156] Memory required for data: 94020
I0925 22:18:54.719127 25920 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0925 22:18:54.719141 25920 net.cpp:91] Creating Layer lstm2_h_concat
I0925 22:18:54.719154 25920 net.cpp:425] lstm2_h_concat <- h_1
I0925 22:18:54.719171 25922 net.cpp:91] Creating Layer lstm2_x_transform
I0925 22:18:54.719182 25922 net.cpp:425] lstm2_x_transform <- x
I0925 22:18:54.719175 25920 net.cpp:399] lstm2_h_concat -> h
I0925 22:18:54.719199 25922 net.cpp:399] lstm2_x_transform -> W_xc_x
I0925 22:18:54.719174 25928 net.cpp:141] Setting up h_pseudoloss
I0925 22:18:54.719238 25928 net.cpp:148] Top shape: (1)
I0925 22:18:54.719244 25928 net.cpp:151]     with loss weight 1
I0925 22:18:54.719259 25928 net.cpp:156] Memory required for data: 98024
I0925 22:18:54.719267 25928 net.cpp:217] h_pseudoloss needs backward computation.
I0925 22:18:54.719274 25928 net.cpp:217] lstm2_h_concat needs backward computation.
I0925 22:18:54.719279 25928 net.cpp:219] lstm2_ does not need backward computation.
I0925 22:18:54.719285 25928 net.cpp:217] lstm2_unit_1 needs backward computation.
I0925 22:18:54.719291 25928 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0925 22:18:54.719297 25928 net.cpp:217] lstm2_transform_1 needs backward computation.
I0925 22:18:54.719302 25928 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0925 22:18:54.719308 25928 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0925 22:18:54.719315 25928 net.cpp:217] lstm2_x_transform needs backward computation.
I0925 22:18:54.719319 25918 net.cpp:141] Setting up lstm1_unit_1
I0925 22:18:54.719321 25928 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0925 22:18:54.719349 25918 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.719354 25928 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0925 22:18:54.719358 25918 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.719362 25928 net.cpp:219] lstm2_ does not need backward computation.
I0925 22:18:54.719365 25918 net.cpp:156] Memory required for data: 86016
I0925 22:18:54.719364 25920 net.cpp:141] Setting up lstm2_h_concat
I0925 22:18:54.719378 25918 layer_factory.hpp:77] Creating layer lstm1_
I0925 22:18:54.719368 25928 net.cpp:219] lstm2_ does not need backward computation.
I0925 22:18:54.719389 25920 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.719394 25928 net.cpp:261] This network produces output c_T
I0925 22:18:54.719395 25920 net.cpp:156] Memory required for data: 98020
I0925 22:18:54.719403 25928 net.cpp:261] This network produces output h_pseudoloss
I0925 22:18:54.719395 25918 net.cpp:91] Creating Layer lstm1_
I0925 22:18:54.719408 25920 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 22:18:54.719414 25918 net.cpp:425] lstm1_ <- c_1
I0925 22:18:54.719421 25920 net.cpp:91] Creating Layer h_pseudoloss
I0925 22:18:54.719424 25918 net.cpp:399] lstm1_ -> c_T
I0925 22:18:54.719427 25920 net.cpp:425] h_pseudoloss <- h
I0925 22:18:54.719427 25928 net.cpp:274] Network initialization done.
I0925 22:18:54.719440 25920 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 22:18:54.719497 25928 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 22:18:54.719506 25928 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 22:18:54.719511 25928 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 22:18:54.739748 25918 net.cpp:141] Setting up lstm1_
I0925 22:18:54.739800 25918 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.739814 25918 net.cpp:156] Memory required for data: 90016
I0925 22:18:54.739823 25918 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0925 22:18:54.739841 25918 net.cpp:91] Creating Layer lstm1_h_concat
I0925 22:18:54.739850 25918 net.cpp:425] lstm1_h_concat <- h_1
I0925 22:18:54.739888 25918 net.cpp:399] lstm1_h_concat -> h
I0925 22:18:54.739917 25920 net.cpp:141] Setting up h_pseudoloss
I0925 22:18:54.739938 25920 net.cpp:148] Top shape: (1)
I0925 22:18:54.739943 25920 net.cpp:151]     with loss weight 1
I0925 22:18:54.739962 25920 net.cpp:156] Memory required for data: 98024
I0925 22:18:54.739970 25920 net.cpp:217] h_pseudoloss needs backward computation.
I0925 22:18:54.739976 25920 net.cpp:217] lstm2_h_concat needs backward computation.
I0925 22:18:54.739969 25928 net.cpp:141] Setting up lstm2
I0925 22:18:54.739989 25920 net.cpp:219] lstm2_ does not need backward computation.
I0925 22:18:54.740011 25928 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.740015 25920 net.cpp:217] lstm2_unit_1 needs backward computation.
I0925 22:18:54.740018 25928 net.cpp:156] Memory required for data: 36412
I0925 22:18:54.740020 25918 net.cpp:141] Setting up lstm1_h_concat
I0925 22:18:54.740025 25920 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0925 22:18:54.740038 25918 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.740041 25920 net.cpp:217] lstm2_transform_1 needs backward computation.
I0925 22:18:54.740049 25920 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0925 22:18:54.740038 25928 layer_factory.hpp:77] Creating layer predict
I0925 22:18:54.740061 25920 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0925 22:18:54.740049 25918 net.cpp:156] Memory required for data: 94016
I0925 22:18:54.740068 25920 net.cpp:217] lstm2_x_transform needs backward computation.
I0925 22:18:54.740077 25918 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 22:18:54.740079 25920 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0925 22:18:54.740080 25928 net.cpp:91] Creating Layer predict
I0925 22:18:54.740087 25920 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0925 22:18:54.740089 25928 net.cpp:425] predict <- lstm2
I0925 22:18:54.740092 25918 net.cpp:91] Creating Layer h_pseudoloss
I0925 22:18:54.740094 25920 net.cpp:219] lstm2_ does not need backward computation.
I0925 22:18:54.740098 25918 net.cpp:425] h_pseudoloss <- h
I0925 22:18:54.740100 25928 net.cpp:399] predict -> predict
I0925 22:18:54.740108 25918 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 22:18:54.740100 25920 net.cpp:219] lstm2_ does not need backward computation.
I0925 22:18:54.740118 25920 net.cpp:261] This network produces output c_T
I0925 22:18:54.740124 25920 net.cpp:261] This network produces output h_pseudoloss
I0925 22:18:54.740144 25920 net.cpp:274] Network initialization done.
I0925 22:18:54.740202 25920 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 22:18:54.740209 25920 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 22:18:54.740214 25920 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 22:18:54.754096 25918 net.cpp:141] Setting up h_pseudoloss
I0925 22:18:54.754140 25918 net.cpp:148] Top shape: (1)
I0925 22:18:54.754146 25918 net.cpp:151]     with loss weight 1
I0925 22:18:54.754164 25918 net.cpp:156] Memory required for data: 94020
I0925 22:18:54.754173 25918 net.cpp:217] h_pseudoloss needs backward computation.
I0925 22:18:54.754179 25918 net.cpp:217] lstm1_h_concat needs backward computation.
I0925 22:18:54.754185 25918 net.cpp:219] lstm1_ does not need backward computation.
I0925 22:18:54.754192 25918 net.cpp:217] lstm1_unit_1 needs backward computation.
I0925 22:18:54.754201 25918 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0925 22:18:54.754207 25918 net.cpp:217] lstm1_transform_1 needs backward computation.
I0925 22:18:54.754214 25918 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0925 22:18:54.754221 25918 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0925 22:18:54.754227 25918 net.cpp:217] lstm1_x_transform needs backward computation.
I0925 22:18:54.754233 25918 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0925 22:18:54.754240 25918 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0925 22:18:54.754246 25918 net.cpp:219] lstm1_ does not need backward computation.
I0925 22:18:54.754251 25918 net.cpp:219] lstm1_ does not need backward computation.
I0925 22:18:54.754256 25918 net.cpp:261] This network produces output c_T
I0925 22:18:54.754262 25918 net.cpp:261] This network produces output h_pseudoloss
I0925 22:18:54.754283 25918 net.cpp:274] Network initialization done.
I0925 22:18:54.754333 25918 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 22:18:54.754339 25918 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 22:18:54.754344 25918 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 22:18:54.830878 25920 net.cpp:141] Setting up lstm2
I0925 22:18:54.830935 25920 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.830940 25920 net.cpp:156] Memory required for data: 36412
I0925 22:18:54.830965 25920 layer_factory.hpp:77] Creating layer predict
I0925 22:18:54.830984 25920 net.cpp:91] Creating Layer predict
I0925 22:18:54.830992 25920 net.cpp:425] predict <- lstm2
I0925 22:18:54.831003 25920 net.cpp:399] predict -> predict
I0925 22:18:54.831003 25918 net.cpp:141] Setting up lstm1
I0925 22:18:54.831024 25918 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.831030 25918 net.cpp:156] Memory required for data: 26408
I0925 22:18:54.831048 25918 layer_factory.hpp:77] Creating layer concat
I0925 22:18:54.831068 25918 net.cpp:91] Creating Layer concat
I0925 22:18:54.831075 25918 net.cpp:425] concat <- lstm1
I0925 22:18:54.831084 25918 net.cpp:425] concat <- embedded_input_sentence
I0925 22:18:54.831090 25918 net.cpp:425] concat <- reshaped_stage_indicator
I0925 22:18:54.831099 25918 net.cpp:399] concat -> lstm1_video_sequence
I0925 22:18:54.831254 25918 net.cpp:141] Setting up concat
I0925 22:18:54.831266 25918 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 22:18:54.831271 25918 net.cpp:156] Memory required for data: 32412
I0925 22:18:54.831277 25918 layer_factory.hpp:77] Creating layer lstm2
I0925 22:18:54.831291 25918 net.cpp:91] Creating Layer lstm2
I0925 22:18:54.831297 25918 net.cpp:425] lstm2 <- lstm1_video_sequence
I0925 22:18:54.831305 25918 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0925 22:18:54.831313 25918 net.cpp:399] lstm2 -> lstm2
I0925 22:18:54.831326 25918 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 22:18:54.831631 25918 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 22:18:54.831732 25918 layer_factory.hpp:77] Creating layer lstm2_
I0925 22:18:54.831745 25918 net.cpp:91] Creating Layer lstm2_
I0925 22:18:54.831753 25918 net.cpp:399] lstm2_ -> x
I0925 22:18:54.831765 25918 net.cpp:399] lstm2_ -> cont
I0925 22:18:54.919147 25922 net.cpp:141] Setting up lstm2_x_transform
I0925 22:18:54.919208 25922 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.919214 25922 net.cpp:156] Memory required for data: 30020
I0925 22:18:54.919241 25922 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0925 22:18:54.919267 25922 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0925 22:18:54.919276 25922 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0925 22:18:54.919286 25922 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0925 22:18:54.919409 25918 net.cpp:141] Setting up lstm2_
I0925 22:18:54.919430 25918 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 22:18:54.919440 25918 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.919445 25918 net.cpp:156] Memory required for data: 6008
I0925 22:18:54.919450 25918 layer_factory.hpp:77] Creating layer lstm2_
I0925 22:18:54.919455 25922 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0925 22:18:54.919468 25922 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.919471 25918 net.cpp:91] Creating Layer lstm2_
I0925 22:18:54.919473 25922 net.cpp:156] Memory required for data: 46020
I0925 22:18:54.919481 25922 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0925 22:18:54.919484 25918 net.cpp:399] lstm2_ -> c_0
I0925 22:18:54.919497 25922 net.cpp:91] Creating Layer lstm2_h_conted_0
I0925 22:18:54.919502 25918 net.cpp:399] lstm2_ -> h_0
I0925 22:18:54.919504 25922 net.cpp:425] lstm2_h_conted_0 <- h_0
I0925 22:18:54.919512 25922 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0925 22:18:54.919522 25922 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0925 22:18:54.919824 25922 net.cpp:141] Setting up lstm2_h_conted_0
I0925 22:18:54.919837 25922 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.919843 25922 net.cpp:156] Memory required for data: 50020
I0925 22:18:54.919849 25922 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0925 22:18:54.919865 25922 net.cpp:91] Creating Layer lstm2_transform_1
I0925 22:18:54.919872 25922 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0925 22:18:54.919881 25922 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0925 22:18:54.923728 25918 net.cpp:141] Setting up lstm2_
I0925 22:18:54.923777 25918 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.923785 25918 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.923790 25918 net.cpp:156] Memory required for data: 14008
I0925 22:18:54.923799 25918 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0925 22:18:54.923817 25918 net.cpp:91] Creating Layer lstm2_cont_slice
I0925 22:18:54.923825 25918 net.cpp:425] lstm2_cont_slice <- cont
I0925 22:18:54.923837 25918 net.cpp:399] lstm2_cont_slice -> cont_1
I0925 22:18:54.932749 25946 net.cpp:141] Setting up predict
I0925 22:18:54.932803 25946 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 22:18:54.932811 25946 net.cpp:156] Memory required for data: 221084
I0925 22:18:54.932863 25946 layer_factory.hpp:77] Creating layer probs
I0925 22:18:54.932886 25946 net.cpp:91] Creating Layer probs
I0925 22:18:54.932869 25918 net.cpp:141] Setting up lstm2_cont_slice
I0925 22:18:54.932898 25946 net.cpp:425] probs <- predict
I0925 22:18:54.932927 25918 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.932929 25946 net.cpp:399] probs -> probs
I0925 22:18:54.932937 25918 net.cpp:156] Memory required for data: 14012
I0925 22:18:54.932965 25918 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0925 22:18:54.932984 25918 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0925 22:18:54.932996 25918 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0925 22:18:54.933008 25918 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0925 22:18:54.933023 25918 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0925 22:18:54.935209 25918 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0925 22:18:54.935256 25918 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.935264 25918 net.cpp:148] Top shape: 1 1 (1)
I0925 22:18:54.935269 25918 net.cpp:156] Memory required for data: 14020
I0925 22:18:54.935278 25918 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0925 22:18:54.935304 25918 net.cpp:91] Creating Layer lstm2_x_transform
I0925 22:18:54.935320 25918 net.cpp:425] lstm2_x_transform <- x
I0925 22:18:54.935340 25918 net.cpp:399] lstm2_x_transform -> W_xc_x
I0925 22:18:54.965559 25946 net.cpp:141] Setting up probs
I0925 22:18:54.965606 25946 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 22:18:54.965613 25946 net.cpp:156] Memory required for data: 405756
I0925 22:18:54.965623 25946 net.cpp:219] probs does not need backward computation.
I0925 22:18:54.965631 25946 net.cpp:219] predict does not need backward computation.
I0925 22:18:54.965638 25946 net.cpp:219] lstm2 does not need backward computation.
I0925 22:18:54.965646 25946 net.cpp:219] concat does not need backward computation.
I0925 22:18:54.965651 25946 net.cpp:219] lstm1 does not need backward computation.
I0925 22:18:54.965658 25946 net.cpp:219] embedding does not need backward computation.
I0925 22:18:54.965663 25946 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0925 22:18:54.965668 25946 net.cpp:219] reshape_frames does not need backward computation.
I0925 22:18:54.965674 25946 net.cpp:219] embed_encoder does not need backward computation.
I0925 22:18:54.965679 25946 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0925 22:18:54.965687 25946 net.cpp:219] input does not need backward computation.
I0925 22:18:54.965692 25946 net.cpp:261] This network produces output probs
I0925 22:18:54.965713 25946 net.cpp:274] Network initialization done.
I0925 22:18:54.966475 25944 net.cpp:141] Setting up conv1
I0925 22:18:54.966500 25944 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0925 22:18:54.966509 25944 net.cpp:156] Memory required for data: 17799480
I0925 22:18:54.966537 25944 layer_factory.hpp:77] Creating layer relu1
I0925 22:18:54.966558 25944 net.cpp:91] Creating Layer relu1
I0925 22:18:54.966567 25944 net.cpp:425] relu1 <- conv1
I0925 22:18:54.966574 25944 net.cpp:386] relu1 -> conv1 (in-place)
I0925 22:18:54.966825 25944 net.cpp:141] Setting up relu1
I0925 22:18:54.966838 25944 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0925 22:18:54.966843 25944 net.cpp:156] Memory required for data: 29415480
I0925 22:18:54.966850 25944 layer_factory.hpp:77] Creating layer pool1
I0925 22:18:54.966862 25944 net.cpp:91] Creating Layer pool1
I0925 22:18:54.966867 25944 net.cpp:425] pool1 <- conv1
I0925 22:18:54.966876 25944 net.cpp:399] pool1 -> pool1
I0925 22:18:54.966953 25944 net.cpp:141] Setting up pool1
I0925 22:18:54.966964 25944 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0925 22:18:54.966969 25944 net.cpp:156] Memory required for data: 32214840
I0925 22:18:54.966975 25944 layer_factory.hpp:77] Creating layer norm1
I0925 22:18:54.966994 25944 net.cpp:91] Creating Layer norm1
I0925 22:18:54.966998 25944 net.cpp:425] norm1 <- pool1
I0925 22:18:54.967005 25944 net.cpp:399] norm1 -> norm1
I0925 22:18:54.967420 25944 net.cpp:141] Setting up norm1
I0925 22:18:54.967434 25944 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0925 22:18:54.967439 25944 net.cpp:156] Memory required for data: 35014200
I0925 22:18:54.967444 25944 layer_factory.hpp:77] Creating layer conv2
I0925 22:18:54.967463 25944 net.cpp:91] Creating Layer conv2
I0925 22:18:54.967468 25944 net.cpp:425] conv2 <- norm1
I0925 22:18:54.967476 25944 net.cpp:399] conv2 -> conv2
I0925 22:18:54.968641 25922 net.cpp:141] Setting up lstm2_transform_1
I0925 22:18:54.968689 25922 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.968695 25922 net.cpp:156] Memory required for data: 66020
I0925 22:18:54.968719 25922 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0925 22:18:54.968750 25922 net.cpp:91] Creating Layer lstm2_gate_input_1
I0925 22:18:54.968760 25922 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0925 22:18:54.968770 25922 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0925 22:18:54.968778 25922 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0925 22:18:54.969048 25922 net.cpp:141] Setting up lstm2_gate_input_1
I0925 22:18:54.969060 25922 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:54.969065 25922 net.cpp:156] Memory required for data: 82020
I0925 22:18:54.969071 25922 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0925 22:18:54.969085 25922 net.cpp:91] Creating Layer lstm2_unit_1
I0925 22:18:54.969091 25922 net.cpp:425] lstm2_unit_1 <- c_0
I0925 22:18:54.969099 25922 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0925 22:18:54.969105 25922 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0925 22:18:54.969113 25922 net.cpp:399] lstm2_unit_1 -> c_1
I0925 22:18:54.969125 25922 net.cpp:399] lstm2_unit_1 -> h_1
I0925 22:18:54.969405 25922 net.cpp:141] Setting up lstm2_unit_1
I0925 22:18:54.969419 25922 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.969425 25922 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.969430 25922 net.cpp:156] Memory required for data: 90020
I0925 22:18:54.969435 25922 layer_factory.hpp:77] Creating layer lstm2_
I0925 22:18:54.969445 25922 net.cpp:91] Creating Layer lstm2_
I0925 22:18:54.969451 25922 net.cpp:425] lstm2_ <- c_1
I0925 22:18:54.969473 25922 net.cpp:399] lstm2_ -> c_T
I0925 22:18:54.969856 25922 net.cpp:141] Setting up lstm2_
I0925 22:18:54.969869 25922 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.969874 25922 net.cpp:156] Memory required for data: 94020
I0925 22:18:54.969879 25922 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0925 22:18:54.969892 25922 net.cpp:91] Creating Layer lstm2_h_concat
I0925 22:18:54.969897 25922 net.cpp:425] lstm2_h_concat <- h_1
I0925 22:18:54.969907 25922 net.cpp:399] lstm2_h_concat -> h
I0925 22:18:54.969964 25922 net.cpp:141] Setting up lstm2_h_concat
I0925 22:18:54.969975 25922 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.969980 25922 net.cpp:156] Memory required for data: 98020
I0925 22:18:54.969986 25922 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 22:18:54.969998 25922 net.cpp:91] Creating Layer h_pseudoloss
I0925 22:18:54.970005 25922 net.cpp:425] h_pseudoloss <- h
I0925 22:18:54.970012 25922 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 22:18:54.970284 25922 net.cpp:141] Setting up h_pseudoloss
I0925 22:18:54.970298 25922 net.cpp:148] Top shape: (1)
I0925 22:18:54.970304 25922 net.cpp:151]     with loss weight 1
I0925 22:18:54.970326 25922 net.cpp:156] Memory required for data: 98024
I0925 22:18:54.970333 25922 net.cpp:217] h_pseudoloss needs backward computation.
I0925 22:18:54.970338 25922 net.cpp:217] lstm2_h_concat needs backward computation.
I0925 22:18:54.970345 25922 net.cpp:219] lstm2_ does not need backward computation.
I0925 22:18:54.970356 25922 net.cpp:217] lstm2_unit_1 needs backward computation.
I0925 22:18:54.970365 25922 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0925 22:18:54.970371 25922 net.cpp:217] lstm2_transform_1 needs backward computation.
I0925 22:18:54.970376 25922 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0925 22:18:54.970382 25922 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0925 22:18:54.970388 25922 net.cpp:217] lstm2_x_transform needs backward computation.
I0925 22:18:54.970394 25922 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0925 22:18:54.970401 25922 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0925 22:18:54.970407 25922 net.cpp:219] lstm2_ does not need backward computation.
I0925 22:18:54.970412 25922 net.cpp:219] lstm2_ does not need backward computation.
I0925 22:18:54.970417 25922 net.cpp:261] This network produces output c_T
I0925 22:18:54.970422 25922 net.cpp:261] This network produces output h_pseudoloss
I0925 22:18:54.970441 25922 net.cpp:274] Network initialization done.
I0925 22:18:54.970502 25922 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 22:18:54.970510 25922 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 22:18:54.970515 25922 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 22:18:54.970870 25922 net.cpp:141] Setting up lstm2
I0925 22:18:54.970885 25922 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:54.970891 25922 net.cpp:156] Memory required for data: 36412
I0925 22:18:54.970911 25922 layer_factory.hpp:77] Creating layer predict
I0925 22:18:54.970933 25922 net.cpp:91] Creating Layer predict
I0925 22:18:54.970942 25922 net.cpp:425] predict <- lstm2
I0925 22:18:54.970952 25922 net.cpp:399] predict -> predict
I0925 22:18:55.060997 25918 net.cpp:141] Setting up lstm2_x_transform
I0925 22:18:55.061028 25944 net.cpp:141] Setting up conv2
I0925 22:18:55.061094 25918 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:55.061103 25918 net.cpp:156] Memory required for data: 30020
I0925 22:18:55.061111 25944 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0925 22:18:55.061118 25944 net.cpp:156] Memory required for data: 42479160
I0925 22:18:55.061131 25918 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0925 22:18:55.061139 25944 layer_factory.hpp:77] Creating layer relu2
I0925 22:18:55.061151 25918 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0925 22:18:55.061158 25944 net.cpp:91] Creating Layer relu2
I0925 22:18:55.061161 25918 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0925 22:18:55.061168 25944 net.cpp:425] relu2 <- conv2
I0925 22:18:55.061172 25918 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0925 22:18:55.061177 25944 net.cpp:386] relu2 -> conv2 (in-place)
I0925 22:18:55.061244 25918 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0925 22:18:55.061259 25918 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:55.061264 25918 net.cpp:156] Memory required for data: 46020
I0925 22:18:55.061269 25918 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0925 22:18:55.061280 25918 net.cpp:91] Creating Layer lstm2_h_conted_0
I0925 22:18:55.061288 25918 net.cpp:425] lstm2_h_conted_0 <- h_0
I0925 22:18:55.061295 25918 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0925 22:18:55.061303 25918 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0925 22:18:55.061553 25918 net.cpp:141] Setting up lstm2_h_conted_0
I0925 22:18:55.061566 25918 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:55.061571 25918 net.cpp:156] Memory required for data: 50020
I0925 22:18:55.061576 25918 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0925 22:18:55.061591 25918 net.cpp:91] Creating Layer lstm2_transform_1
I0925 22:18:55.061597 25918 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0925 22:18:55.061609 25918 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0925 22:18:55.061667 25944 net.cpp:141] Setting up relu2
I0925 22:18:55.061681 25944 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0925 22:18:55.061686 25944 net.cpp:156] Memory required for data: 49944120
I0925 22:18:55.061691 25944 layer_factory.hpp:77] Creating layer pool2
I0925 22:18:55.061704 25944 net.cpp:91] Creating Layer pool2
I0925 22:18:55.061710 25944 net.cpp:425] pool2 <- conv2
I0925 22:18:55.061719 25944 net.cpp:399] pool2 -> pool2
I0925 22:18:55.070037 25944 net.cpp:141] Setting up pool2
I0925 22:18:55.070051 25944 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0925 22:18:55.070055 25944 net.cpp:156] Memory required for data: 51674680
I0925 22:18:55.070060 25944 layer_factory.hpp:77] Creating layer norm2
I0925 22:18:55.070077 25944 net.cpp:91] Creating Layer norm2
I0925 22:18:55.070082 25944 net.cpp:425] norm2 <- pool2
I0925 22:18:55.070089 25944 net.cpp:399] norm2 -> norm2
I0925 22:18:55.070659 25944 net.cpp:141] Setting up norm2
I0925 22:18:55.070673 25944 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0925 22:18:55.070678 25944 net.cpp:156] Memory required for data: 53405240
I0925 22:18:55.070688 25944 layer_factory.hpp:77] Creating layer conv3
I0925 22:18:55.070703 25944 net.cpp:91] Creating Layer conv3
I0925 22:18:55.070708 25944 net.cpp:425] conv3 <- norm2
I0925 22:18:55.070720 25944 net.cpp:399] conv3 -> conv3
I0925 22:18:55.074162 25944 net.cpp:141] Setting up conv3
I0925 22:18:55.074178 25944 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0925 22:18:55.074184 25944 net.cpp:156] Memory required for data: 56001080
I0925 22:18:55.074199 25944 layer_factory.hpp:77] Creating layer relu3
I0925 22:18:55.074208 25944 net.cpp:91] Creating Layer relu3
I0925 22:18:55.074213 25944 net.cpp:425] relu3 <- conv3
I0925 22:18:55.074220 25944 net.cpp:386] relu3 -> conv3 (in-place)
I0925 22:18:55.074626 25944 net.cpp:141] Setting up relu3
I0925 22:18:55.074642 25944 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0925 22:18:55.074647 25944 net.cpp:156] Memory required for data: 58596920
I0925 22:18:55.074652 25944 layer_factory.hpp:77] Creating layer conv4
I0925 22:18:55.074666 25944 net.cpp:91] Creating Layer conv4
I0925 22:18:55.074671 25944 net.cpp:425] conv4 <- conv3
I0925 22:18:55.074682 25944 net.cpp:399] conv4 -> conv4
I0925 22:18:55.078897 25944 net.cpp:141] Setting up conv4
I0925 22:18:55.078913 25944 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0925 22:18:55.078922 25944 net.cpp:156] Memory required for data: 61192760
I0925 22:18:55.078932 25944 layer_factory.hpp:77] Creating layer relu4
I0925 22:18:55.078940 25944 net.cpp:91] Creating Layer relu4
I0925 22:18:55.078945 25944 net.cpp:425] relu4 <- conv4
I0925 22:18:55.078953 25944 net.cpp:386] relu4 -> conv4 (in-place)
I0925 22:18:55.079207 25944 net.cpp:141] Setting up relu4
I0925 22:18:55.079218 25944 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0925 22:18:55.079223 25944 net.cpp:156] Memory required for data: 63788600
I0925 22:18:55.079231 25944 layer_factory.hpp:77] Creating layer conv5
I0925 22:18:55.079246 25944 net.cpp:91] Creating Layer conv5
I0925 22:18:55.079252 25944 net.cpp:425] conv5 <- conv4
I0925 22:18:55.079258 25944 net.cpp:399] conv5 -> conv5
I0925 22:18:55.083045 25944 net.cpp:141] Setting up conv5
I0925 22:18:55.083063 25944 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0925 22:18:55.083070 25944 net.cpp:156] Memory required for data: 65519160
I0925 22:18:55.083087 25944 layer_factory.hpp:77] Creating layer relu5
I0925 22:18:55.083099 25944 net.cpp:91] Creating Layer relu5
I0925 22:18:55.083104 25944 net.cpp:425] relu5 <- conv5
I0925 22:18:55.083112 25944 net.cpp:386] relu5 -> conv5 (in-place)
I0925 22:18:55.083346 25944 net.cpp:141] Setting up relu5
I0925 22:18:55.083359 25944 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0925 22:18:55.083362 25944 net.cpp:156] Memory required for data: 67249720
I0925 22:18:55.083367 25944 layer_factory.hpp:77] Creating layer pool5
I0925 22:18:55.083381 25944 net.cpp:91] Creating Layer pool5
I0925 22:18:55.083386 25944 net.cpp:425] pool5 <- conv5
I0925 22:18:55.083396 25944 net.cpp:399] pool5 -> pool5
I0925 22:18:55.083462 25944 net.cpp:141] Setting up pool5
I0925 22:18:55.083472 25944 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0925 22:18:55.083477 25944 net.cpp:156] Memory required for data: 67618360
I0925 22:18:55.083482 25944 layer_factory.hpp:77] Creating layer fc6
I0925 22:18:55.083497 25944 net.cpp:91] Creating Layer fc6
I0925 22:18:55.083501 25944 net.cpp:425] fc6 <- pool5
I0925 22:18:55.083508 25944 net.cpp:399] fc6 -> fc6
I0925 22:18:55.147881 25918 net.cpp:141] Setting up lstm2_transform_1
I0925 22:18:55.147933 25918 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:55.147938 25918 net.cpp:156] Memory required for data: 66020
I0925 22:18:55.147958 25918 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0925 22:18:55.147977 25918 net.cpp:91] Creating Layer lstm2_gate_input_1
I0925 22:18:55.147984 25918 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0925 22:18:55.147992 25918 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0925 22:18:55.148005 25918 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0925 22:18:55.148069 25918 net.cpp:141] Setting up lstm2_gate_input_1
I0925 22:18:55.148079 25918 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 22:18:55.148083 25918 net.cpp:156] Memory required for data: 82020
I0925 22:18:55.148088 25918 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0925 22:18:55.148098 25918 net.cpp:91] Creating Layer lstm2_unit_1
I0925 22:18:55.148103 25918 net.cpp:425] lstm2_unit_1 <- c_0
I0925 22:18:55.148109 25918 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0925 22:18:55.148115 25918 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0925 22:18:55.148124 25918 net.cpp:399] lstm2_unit_1 -> c_1
I0925 22:18:55.148134 25918 net.cpp:399] lstm2_unit_1 -> h_1
I0925 22:18:55.148164 25952 net.cpp:141] Setting up predict
I0925 22:18:55.148185 25952 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 22:18:55.148190 25952 net.cpp:156] Memory required for data: 221084
I0925 22:18:55.148231 25952 layer_factory.hpp:77] Creating layer probs
I0925 22:18:55.148231 25918 net.cpp:141] Setting up lstm2_unit_1
I0925 22:18:55.148243 25918 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:55.148246 25952 net.cpp:91] Creating Layer probs
I0925 22:18:55.148250 25918 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:55.148253 25952 net.cpp:425] probs <- predict
I0925 22:18:55.148254 25918 net.cpp:156] Memory required for data: 90020
I0925 22:18:55.148260 25918 layer_factory.hpp:77] Creating layer lstm2_
I0925 22:18:55.148263 25952 net.cpp:399] probs -> probs
I0925 22:18:55.148270 25918 net.cpp:91] Creating Layer lstm2_
I0925 22:18:55.148275 25918 net.cpp:425] lstm2_ <- c_1
I0925 22:18:55.148283 25918 net.cpp:399] lstm2_ -> c_T
I0925 22:18:55.148783 25918 net.cpp:141] Setting up lstm2_
I0925 22:18:55.148794 25918 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:55.148798 25918 net.cpp:156] Memory required for data: 94020
I0925 22:18:55.148803 25918 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0925 22:18:55.148813 25918 net.cpp:91] Creating Layer lstm2_h_concat
I0925 22:18:55.148818 25918 net.cpp:425] lstm2_h_concat <- h_1
I0925 22:18:55.148833 25918 net.cpp:399] lstm2_h_concat -> h
I0925 22:18:55.148900 25918 net.cpp:141] Setting up lstm2_h_concat
I0925 22:18:55.148910 25918 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:56.151964 25918 net.cpp:156] Memory required for data: 98020
I0925 22:18:56.152000 25918 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 22:18:55.149195 25952 net.cpp:141] Setting up probs
I0925 22:18:56.152076 25918 net.cpp:91] Creating Layer h_pseudoloss
I0925 22:18:56.152088 25952 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 22:18:55.394637 25922 net.cpp:141] Setting up predict
I0925 22:18:56.152103 25918 net.cpp:425] h_pseudoloss <- h
I0925 22:18:56.152102 25952 net.cpp:156] Memory required for data: 405756
I0925 22:18:56.152117 25952 net.cpp:219] probs does not need backward computation.
I0925 22:18:56.152122 25922 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 22:18:56.152132 25922 net.cpp:156] Memory required for data: 221084
I0925 22:18:56.152119 25918 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 22:18:56.152146 25922 layer_factory.hpp:77] Creating layer probs
I0925 22:18:56.152145 25952 net.cpp:219] predict does not need backward computation.
I0925 22:18:56.152163 25922 net.cpp:91] Creating Layer probs
I0925 22:18:56.152170 25922 net.cpp:425] probs <- predict
I0925 22:18:56.152179 25922 net.cpp:399] probs -> probs
I0925 22:18:56.152204 25952 net.cpp:219] lstm2 does not need backward computation.
I0925 22:18:56.152225 25952 net.cpp:219] concat does not need backward computation.
I0925 22:18:56.152232 25952 net.cpp:219] lstm1 does not need backward computation.
I0925 22:18:56.152240 25952 net.cpp:219] embedding does not need backward computation.
I0925 22:18:56.152245 25952 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0925 22:18:56.152252 25952 net.cpp:219] reshape_frames does not need backward computation.
I0925 22:18:55.172955 25928 net.cpp:141] Setting up predict
I0925 22:18:56.152261 25952 net.cpp:219] embed_encoder does not need backward computation.
I0925 22:18:56.152290 25928 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 22:18:56.152299 25952 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0925 22:18:56.152304 25928 net.cpp:156] Memory required for data: 221084
I0925 22:18:56.152317 25952 net.cpp:219] input does not need backward computation.
I0925 22:18:56.152321 25952 net.cpp:261] This network produces output probs
I0925 22:18:56.152331 25928 layer_factory.hpp:77] Creating layer probs
I0925 22:18:56.152343 25952 net.cpp:274] Network initialization done.
I0925 22:18:56.152354 25928 net.cpp:91] Creating Layer probs
I0925 22:18:56.152369 25928 net.cpp:425] probs <- predict
I0925 22:18:56.152385 25928 net.cpp:399] probs -> probs
I0925 22:18:55.186620 25944 net.cpp:141] Setting up fc6
I0925 22:18:56.152441 25944 net.cpp:148] Top shape: 10 4096 (40960)
I0925 22:18:56.152452 25944 net.cpp:156] Memory required for data: 67782200
I0925 22:18:55.285246 25920 net.cpp:141] Setting up predict
I0925 22:18:56.152473 25944 layer_factory.hpp:77] Creating layer relu6
I0925 22:18:56.152721 25920 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 22:18:56.152734 25920 net.cpp:156] Memory required for data: 221084
I0925 22:18:56.152765 25920 layer_factory.hpp:77] Creating layer probs
I0925 22:18:56.152776 25920 net.cpp:91] Creating Layer probs
I0925 22:18:56.152786 25920 net.cpp:425] probs <- predict
I0925 22:18:56.152794 25920 net.cpp:399] probs -> probs
I0925 22:18:56.153658 25944 net.cpp:91] Creating Layer relu6
I0925 22:18:56.153674 25944 net.cpp:425] relu6 <- fc6
I0925 22:18:56.153695 25944 net.cpp:386] relu6 -> fc6 (in-place)
I0925 22:18:56.153724 25922 net.cpp:141] Setting up probs
I0925 22:18:56.153748 25922 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 22:18:56.153756 25922 net.cpp:156] Memory required for data: 405756
I0925 22:18:56.153765 25922 net.cpp:219] probs does not need backward computation.
I0925 22:18:56.153774 25922 net.cpp:219] predict does not need backward computation.
I0925 22:18:56.153784 25922 net.cpp:219] lstm2 does not need backward computation.
I0925 22:18:56.153794 25922 net.cpp:219] concat does not need backward computation.
I0925 22:18:56.153803 25922 net.cpp:219] lstm1 does not need backward computation.
I0925 22:18:56.153815 25922 net.cpp:219] embedding does not need backward computation.
I0925 22:18:56.153825 25922 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0925 22:18:56.153836 25922 net.cpp:219] reshape_frames does not need backward computation.
I0925 22:18:56.153846 25922 net.cpp:219] embed_encoder does not need backward computation.
I0925 22:18:56.153931 25922 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0925 22:18:56.153944 25918 net.cpp:141] Setting up h_pseudoloss
I0925 22:18:56.153949 25922 net.cpp:219] input does not need backward computation.
I0925 22:18:56.153959 25918 net.cpp:148] Top shape: (1)
I0925 22:18:56.153973 25922 net.cpp:261] This network produces output probs
I0925 22:18:56.153964 25918 net.cpp:151]     with loss weight 1
I0925 22:18:56.153987 25918 net.cpp:156] Memory required for data: 98024
I0925 22:18:56.153993 25922 net.cpp:274] Network initialization done.
I0925 22:18:56.153993 25918 net.cpp:217] h_pseudoloss needs backward computation.
I0925 22:18:56.154013 25918 net.cpp:217] lstm2_h_concat needs backward computation.
I0925 22:18:56.154019 25918 net.cpp:219] lstm2_ does not need backward computation.
I0925 22:18:56.154026 25918 net.cpp:217] lstm2_unit_1 needs backward computation.
I0925 22:18:56.154031 25918 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0925 22:18:56.154037 25918 net.cpp:217] lstm2_transform_1 needs backward computation.
I0925 22:18:56.154043 25918 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0925 22:18:56.154049 25918 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0925 22:18:56.154055 25918 net.cpp:217] lstm2_x_transform needs backward computation.
I0925 22:18:56.154060 25918 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0925 22:18:56.154067 25918 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0925 22:18:56.154072 25918 net.cpp:219] lstm2_ does not need backward computation.
I0925 22:18:56.154076 25918 net.cpp:219] lstm2_ does not need backward computation.
I0925 22:18:56.154080 25918 net.cpp:261] This network produces output c_T
I0925 22:18:56.154085 25918 net.cpp:261] This network produces output h_pseudoloss
I0925 22:18:56.154105 25918 net.cpp:274] Network initialization done.
I0925 22:18:56.154148 25928 net.cpp:141] Setting up probs
I0925 22:18:56.154168 25918 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 22:18:56.154172 25928 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 22:18:56.154176 25918 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 22:18:56.154181 25918 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 22:18:56.154182 25928 net.cpp:156] Memory required for data: 405756
I0925 22:18:56.154192 25928 net.cpp:219] probs does not need backward computation.
I0925 22:18:56.154202 25928 net.cpp:219] predict does not need backward computation.
I0925 22:18:56.154214 25928 net.cpp:219] lstm2 does not need backward computation.
I0925 22:18:56.154224 25928 net.cpp:219] concat does not need backward computation.
I0925 22:18:56.154235 25928 net.cpp:219] lstm1 does not need backward computation.
I0925 22:18:56.154245 25928 net.cpp:219] embedding does not need backward computation.
I0925 22:18:56.154255 25928 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0925 22:18:56.154265 25928 net.cpp:219] reshape_frames does not need backward computation.
I0925 22:18:56.154278 25928 net.cpp:219] embed_encoder does not need backward computation.
I0925 22:18:56.154287 25928 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0925 22:18:56.154299 25928 net.cpp:219] input does not need backward computation.
I0925 22:18:56.154306 25928 net.cpp:261] This network produces output probs
I0925 22:18:56.154331 25928 net.cpp:274] Network initialization done.
I0925 22:18:56.155370 25920 net.cpp:141] Setting up probs
I0925 22:18:56.155392 25920 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 22:18:56.160415 25918 net.cpp:141] Setting up lstm2
I0925 22:18:56.161592 25920 net.cpp:156] Memory required for data: 405756
I0925 22:18:56.161623 25920 net.cpp:219] probs does not need backward computation.
I0925 22:18:56.161623 25918 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 22:18:56.161631 25920 net.cpp:219] predict does not need backward computation.
I0925 22:18:56.161634 25918 net.cpp:156] Memory required for data: 36412
I0925 22:18:56.162053 25918 layer_factory.hpp:77] Creating layer predict
I0925 22:18:56.162057 25944 net.cpp:141] Setting up relu6
I0925 22:18:56.162061 25920 net.cpp:219] lstm2 does not need backward computation.
I0925 22:18:56.162088 25918 net.cpp:91] Creating Layer predict
I0925 22:18:56.162104 25944 net.cpp:148] Top shape: 10 4096 (40960)
I0925 22:18:56.162117 25918 net.cpp:425] predict <- lstm2
I0925 22:18:56.162122 25944 net.cpp:156] Memory required for data: 67946040
I0925 22:18:56.162116 25920 net.cpp:219] concat does not need backward computation.
I0925 22:18:56.162140 25918 net.cpp:399] predict -> predict
I0925 22:18:56.162139 25944 layer_factory.hpp:77] Creating layer drop6
I0925 22:18:56.162147 25920 net.cpp:219] lstm1 does not need backward computation.
I0925 22:18:56.162166 25920 net.cpp:219] embedding does not need backward computation.
I0925 22:18:56.162176 25920 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0925 22:18:56.162186 25920 net.cpp:219] reshape_frames does not need backward computation.
I0925 22:18:56.162192 25944 net.cpp:91] Creating Layer drop6
I0925 22:18:56.162199 25920 net.cpp:219] embed_encoder does not need backward computation.
I0925 22:18:56.162217 25944 net.cpp:425] drop6 <- fc6
I0925 22:18:56.162228 25920 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0925 22:18:56.162243 25920 net.cpp:219] input does not need backward computation.
I0925 22:18:56.162248 25944 net.cpp:386] drop6 -> fc6 (in-place)
I0925 22:18:56.162252 25920 net.cpp:261] This network produces output probs
I0925 22:18:56.162308 25920 net.cpp:274] Network initialization done.
I0925 22:18:56.240093 25944 net.cpp:141] Setting up drop6
I0925 22:18:56.240170 25944 net.cpp:148] Top shape: 10 4096 (40960)
I0925 22:18:56.240185 25944 net.cpp:156] Memory required for data: 68109880
I0925 22:18:56.240202 25944 layer_factory.hpp:77] Creating layer fc7
I0925 22:18:56.241930 25944 net.cpp:91] Creating Layer fc7
I0925 22:18:56.241962 25944 net.cpp:425] fc7 <- fc6
I0925 22:18:56.241981 25944 net.cpp:399] fc7 -> fc7
I0925 22:18:56.307360 25944 net.cpp:141] Setting up fc7
I0925 22:18:56.307422 25944 net.cpp:148] Top shape: 10 4096 (40960)
I0925 22:18:56.307430 25944 net.cpp:156] Memory required for data: 68273720
I0925 22:18:56.307447 25944 layer_factory.hpp:77] Creating layer relu7
I0925 22:18:56.307467 25944 net.cpp:91] Creating Layer relu7
I0925 22:18:56.307476 25944 net.cpp:425] relu7 <- fc7
I0925 22:18:56.307485 25944 net.cpp:386] relu7 -> fc7 (in-place)
I0925 22:18:56.308230 25944 net.cpp:141] Setting up relu7
I0925 22:18:56.308272 25944 net.cpp:148] Top shape: 10 4096 (40960)
I0925 22:18:56.308279 25944 net.cpp:156] Memory required for data: 68437560
I0925 22:18:56.308289 25944 layer_factory.hpp:77] Creating layer drop7
I0925 22:18:56.308312 25944 net.cpp:91] Creating Layer drop7
I0925 22:18:56.308320 25944 net.cpp:425] drop7 <- fc7
I0925 22:18:56.308331 25944 net.cpp:386] drop7 -> fc7 (in-place)
I0925 22:18:56.308423 25944 net.cpp:141] Setting up drop7
I0925 22:18:56.308434 25944 net.cpp:148] Top shape: 10 4096 (40960)
I0925 22:18:56.308439 25944 net.cpp:156] Memory required for data: 68601400
I0925 22:18:56.308444 25944 layer_factory.hpp:77] Creating layer fc8
I0925 22:18:56.308470 25944 net.cpp:91] Creating Layer fc8
I0925 22:18:56.308476 25944 net.cpp:425] fc8 <- fc7
I0925 22:18:56.308487 25944 net.cpp:399] fc8 -> fc8
I0925 22:18:56.324910 25944 net.cpp:141] Setting up fc8
I0925 22:18:56.324978 25944 net.cpp:148] Top shape: 10 1000 (10000)
I0925 22:18:56.324988 25944 net.cpp:156] Memory required for data: 68641400
I0925 22:18:56.325007 25944 layer_factory.hpp:77] Creating layer prob
I0925 22:18:56.325028 25944 net.cpp:91] Creating Layer prob
I0925 22:18:56.325037 25944 net.cpp:425] prob <- fc8
I0925 22:18:56.325618 25944 net.cpp:399] prob -> prob
I0925 22:18:56.327433 25944 net.cpp:141] Setting up prob
I0925 22:18:56.327491 25944 net.cpp:148] Top shape: 10 1000 (10000)
I0925 22:18:56.327499 25944 net.cpp:156] Memory required for data: 68681400
I0925 22:18:56.327512 25944 net.cpp:219] prob does not need backward computation.
I0925 22:18:56.327520 25944 net.cpp:219] fc8 does not need backward computation.
I0925 22:18:56.327527 25944 net.cpp:219] drop7 does not need backward computation.
I0925 22:18:56.327531 25944 net.cpp:219] relu7 does not need backward computation.
I0925 22:18:56.327536 25944 net.cpp:219] fc7 does not need backward computation.
I0925 22:18:56.327543 25944 net.cpp:219] drop6 does not need backward computation.
I0925 22:18:56.327548 25944 net.cpp:219] relu6 does not need backward computation.
I0925 22:18:56.327553 25944 net.cpp:219] fc6 does not need backward computation.
I0925 22:18:56.327558 25944 net.cpp:219] pool5 does not need backward computation.
I0925 22:18:56.327564 25944 net.cpp:219] relu5 does not need backward computation.
I0925 22:18:56.327569 25944 net.cpp:219] conv5 does not need backward computation.
I0925 22:18:56.327574 25944 net.cpp:219] relu4 does not need backward computation.
I0925 22:18:56.327579 25944 net.cpp:219] conv4 does not need backward computation.
I0925 22:18:56.327584 25944 net.cpp:219] relu3 does not need backward computation.
I0925 22:18:56.327589 25944 net.cpp:219] conv3 does not need backward computation.
I0925 22:18:56.327595 25944 net.cpp:219] norm2 does not need backward computation.
I0925 22:18:56.327601 25944 net.cpp:219] pool2 does not need backward computation.
I0925 22:18:56.327606 25944 net.cpp:219] relu2 does not need backward computation.
I0925 22:18:56.327611 25944 net.cpp:219] conv2 does not need backward computation.
I0925 22:18:56.327617 25944 net.cpp:219] norm1 does not need backward computation.
I0925 22:18:56.327622 25944 net.cpp:219] pool1 does not need backward computation.
I0925 22:18:56.327628 25944 net.cpp:219] relu1 does not need backward computation.
I0925 22:18:56.327633 25944 net.cpp:219] conv1 does not need backward computation.
I0925 22:18:56.327638 25944 net.cpp:219] data does not need backward computation.
I0925 22:18:56.327643 25944 net.cpp:261] This network produces output prob
I0925 22:18:56.327679 25944 net.cpp:274] Network initialization done.
I0925 22:18:56.642773 25946 net.cpp:752] Ignoring source layer data
I0925 22:18:56.642813 25946 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0925 22:18:56.642818 25946 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0925 22:18:56.644661 25944 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /home/peifeng/work/run/storm102/data/workers/1eade8ef-e562-4da0-82f9-10e36a4c7c3f/tmp/cvld8080089181201485022/bvlc_reference_caffenet.caffemodel
I0925 22:18:56.644727 25944 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0925 22:18:56.644737 25944 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0925 22:18:56.644745 25944 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /home/peifeng/work/run/storm102/data/workers/1eade8ef-e562-4da0-82f9-10e36a4c7c3f/tmp/cvld8080089181201485022/bvlc_reference_caffenet.caffemodel
I0925 22:18:56.646786 25928 net.cpp:752] Ignoring source layer data
I0925 22:18:56.646826 25928 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0925 22:18:56.646832 25928 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0925 22:18:56.681772 25918 net.cpp:141] Setting up predict
I0925 22:18:56.681841 25918 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 22:18:56.681852 25918 net.cpp:156] Memory required for data: 221084
I0925 22:18:56.681875 25918 layer_factory.hpp:77] Creating layer probs
I0925 22:18:56.681905 25918 net.cpp:91] Creating Layer probs
I0925 22:18:56.681917 25918 net.cpp:425] probs <- predict
I0925 22:18:56.681932 25918 net.cpp:399] probs -> probs
I0925 22:18:56.685592 25918 net.cpp:141] Setting up probs
I0925 22:18:56.685667 25918 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 22:18:56.685678 25918 net.cpp:156] Memory required for data: 405756
I0925 22:18:56.685690 25918 net.cpp:219] probs does not need backward computation.
I0925 22:18:56.685703 25918 net.cpp:219] predict does not need backward computation.
I0925 22:18:56.685712 25918 net.cpp:219] lstm2 does not need backward computation.
I0925 22:18:56.685721 25918 net.cpp:219] concat does not need backward computation.
I0925 22:18:56.685731 25918 net.cpp:219] lstm1 does not need backward computation.
I0925 22:18:56.685742 25918 net.cpp:219] embedding does not need backward computation.
I0925 22:18:56.685751 25918 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0925 22:18:56.685761 25918 net.cpp:219] reshape_frames does not need backward computation.
I0925 22:18:56.685771 25918 net.cpp:219] embed_encoder does not need backward computation.
I0925 22:18:56.685781 25918 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0925 22:18:56.685789 25918 net.cpp:219] input does not need backward computation.
I0925 22:18:56.685796 25918 net.cpp:261] This network produces output probs
I0925 22:18:56.685825 25918 net.cpp:274] Network initialization done.
I0925 22:18:56.697675 25920 net.cpp:752] Ignoring source layer data
I0925 22:18:56.697721 25920 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0925 22:18:56.697727 25920 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0925 22:18:56.698992 25952 net.cpp:752] Ignoring source layer data
I0925 22:18:56.699059 25952 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0925 22:18:56.699067 25952 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0925 22:18:56.718647 25922 net.cpp:752] Ignoring source layer data
I0925 22:18:56.718706 25922 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0925 22:18:56.718715 25922 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0925 22:18:56.737623 25946 net.cpp:752] Ignoring source layer cross_entropy_loss
I0925 22:18:56.737663 25928 net.cpp:752] Ignoring source layer cross_entropy_loss
I0925 22:18:56.789489 25952 net.cpp:752] Ignoring source layer cross_entropy_loss
I0925 22:18:56.800427 25920 net.cpp:752] Ignoring source layer cross_entropy_loss
I0925 22:18:56.812793 25922 net.cpp:752] Ignoring source layer cross_entropy_loss
I0925 22:18:57.046360 25944 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0925 22:18:57.054250 25918 net.cpp:752] Ignoring source layer data
I0925 22:18:57.054293 25918 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0925 22:18:57.054301 25918 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0925 22:18:57.095717 25944 net.cpp:752] Ignoring source layer loss
Loading the model + trained: 29887.7ms
Using cv::Size and some other stuff: 0.426ms
I0925 22:18:57.124426 25918 net.cpp:752] Ignoring source layer cross_entropy_loss
Loading the mean file: 296954ms
TIMERTIMER 265632140
TIMERTIMER 249329072
TIMERTIMER 472137147
TIMERTIMER 480531283
TIMERTIMER 281837491
TIMERTIMER 300869571
TIMERTIMER 210033142
TIMERTIMER 202423652
TIMERTIMER 278719651
TIMERTIMER 257907603
TIMERTIMER 216861268
TIMERTIMER 220001787
TIMERTIMER 217560182
TIMERTIMER 183517100
TIMERTIMER 216330476
TIMERTIMER 241706498
TIMERTIMER 206933269
TIMERTIMER 237269492
TIMERTIMER 237548491
TIMERTIMER 241665049
TIMERTIMER 232918084
TIMERTIMER 228866794
TIMERTIMER 249714625
TIMERTIMER 242466231
TIMERTIMER 241637891
TIMERTIMER 258145829
TIMERTIMER 236851584
TIMERTIMER 231031612
TIMERTIMER 239494174
TIMERTIMER 233506899
TIMERTIMER 237119204
TIMERTIMER 243857191
TIMERTIMER 238125284
TIMERTIMER 234051062
TIMERTIMER 238610366
TIMERTIMER 226998803
TIMERTIMER 239436281
TIMERTIMER 239279772
TIMERTIMER 238525090
TIMERTIMER 240710797
TIMERTIMER 241996494
TIMERTIMER 231305452
TIMERTIMER 254553502
TIMERTIMER 234741266
