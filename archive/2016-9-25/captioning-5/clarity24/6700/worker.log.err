SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/peifeng/tools/storm102/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/peifeng/work/run/storm102/data/supervisor/stormdist/captioning-1-1474850729/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /home/peifeng/work/run/storm102/data/workers/15f6d291-2172-4264-8836-3953294fe137/tmp/cvld1439520717747607693/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0925 20:46:41.262903  5297 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/15f6d291-2172-4264-8836-3953294fe137/tmp/cvld1439520717747607693/s2vt.words_to_preds.prototxt
I0925 20:46:41.263051  5297 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0925 20:46:41.263062  5297 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0925 20:46:41.263288  5303 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0925 20:46:41.263366  5297 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0925 20:46:41.263443  5303 layer_factory.hpp:77] Creating layer data
I0925 20:46:41.263473  5303 net.cpp:91] Creating Layer data
I0925 20:46:41.263485  5303 net.cpp:399] data -> data
I0925 20:46:41.263504  5297 layer_factory.hpp:77] Creating layer input
I0925 20:46:41.263522  5297 net.cpp:91] Creating Layer input
I0925 20:46:41.263530  5297 net.cpp:399] input -> frames_fc7
I0925 20:46:41.263550  5297 net.cpp:399] input -> cont_sentence
I0925 20:46:41.263563  5297 net.cpp:399] input -> input_sentence
I0925 20:46:41.263576  5297 net.cpp:399] input -> stage_indicator
I0925 20:46:41.894892  5303 net.cpp:141] Setting up data
I0925 20:46:41.894950  5297 net.cpp:141] Setting up input
I0925 20:46:41.895038  5297 net.cpp:148] Top shape: 1 4096 (4096)
I0925 20:46:41.895040  5303 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0925 20:46:41.895058  5297 net.cpp:148] Top shape: 1 1 (1)
I0925 20:46:41.895066  5297 net.cpp:148] Top shape: 1 1 (1)
I0925 20:46:41.895061  5303 net.cpp:156] Memory required for data: 6183480
I0925 20:46:41.895071  5297 net.cpp:148] Top shape: 1 1 (1)
I0925 20:46:41.895084  5297 net.cpp:156] Memory required for data: 16396
I0925 20:46:41.895095  5297 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0925 20:46:41.895095  5303 layer_factory.hpp:77] Creating layer conv1
I0925 20:46:41.895139  5297 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0925 20:46:41.895145  5303 net.cpp:91] Creating Layer conv1
I0925 20:46:41.895151  5297 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0925 20:46:41.895153  5303 net.cpp:425] conv1 <- data
I0925 20:46:41.895170  5303 net.cpp:399] conv1 -> conv1
I0925 20:46:41.895180  5297 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0925 20:46:41.895193  5297 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0925 20:46:41.895253  5297 net.cpp:141] Setting up cont_sentence_input_1_split
I0925 20:46:41.895264  5297 net.cpp:148] Top shape: 1 1 (1)
I0925 20:46:41.895270  5297 net.cpp:148] Top shape: 1 1 (1)
I0925 20:46:41.895275  5297 net.cpp:156] Memory required for data: 16404
I0925 20:46:41.895280  5297 layer_factory.hpp:77] Creating layer embed_encoder
I0925 20:46:41.895309  5297 net.cpp:91] Creating Layer embed_encoder
I0925 20:46:41.895316  5297 net.cpp:425] embed_encoder <- frames_fc7
I0925 20:46:41.895328  5297 net.cpp:399] embed_encoder -> embedded_in_frames
I0925 20:46:41.923609  5297 net.cpp:141] Setting up embed_encoder
I0925 20:46:41.923666  5297 net.cpp:148] Top shape: 1 500 (500)
I0925 20:46:41.923673  5297 net.cpp:156] Memory required for data: 18404
I0925 20:46:41.923707  5297 layer_factory.hpp:77] Creating layer reshape_frames
I0925 20:46:41.923748  5297 net.cpp:91] Creating Layer reshape_frames
I0925 20:46:41.923758  5297 net.cpp:425] reshape_frames <- embedded_in_frames
I0925 20:46:41.923779  5297 net.cpp:399] reshape_frames -> embedded_input_frames
I0925 20:46:41.925449  5297 net.cpp:141] Setting up reshape_frames
I0925 20:46:41.925472  5297 net.cpp:148] Top shape: 1 1 500 (500)
I0925 20:46:41.925477  5297 net.cpp:156] Memory required for data: 20404
I0925 20:46:41.925482  5297 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0925 20:46:41.925496  5297 net.cpp:91] Creating Layer reshape_stage_indicator
I0925 20:46:41.925503  5297 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0925 20:46:41.925513  5297 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0925 20:46:41.929739  5297 net.cpp:141] Setting up reshape_stage_indicator
I0925 20:46:41.929765  5297 net.cpp:148] Top shape: 1 1 1 (1)
I0925 20:46:41.929771  5297 net.cpp:156] Memory required for data: 20408
I0925 20:46:41.929777  5297 layer_factory.hpp:77] Creating layer embedding
I0925 20:46:41.929796  5297 net.cpp:91] Creating Layer embedding
I0925 20:46:41.929803  5297 net.cpp:425] embedding <- input_sentence
I0925 20:46:41.929813  5297 net.cpp:399] embedding -> embedded_input_sentence
I0925 20:46:42.151088  5303 net.cpp:141] Setting up conv1
I0925 20:46:42.151149  5303 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0925 20:46:42.151156  5303 net.cpp:156] Memory required for data: 17799480
I0925 20:46:42.151185  5303 layer_factory.hpp:77] Creating layer relu1
I0925 20:46:42.151213  5303 net.cpp:91] Creating Layer relu1
I0925 20:46:42.151222  5303 net.cpp:425] relu1 <- conv1
I0925 20:46:42.151231  5303 net.cpp:386] relu1 -> conv1 (in-place)
I0925 20:46:42.151684  5303 net.cpp:141] Setting up relu1
I0925 20:46:42.151697  5303 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0925 20:46:42.151703  5303 net.cpp:156] Memory required for data: 29415480
I0925 20:46:42.151708  5303 layer_factory.hpp:77] Creating layer pool1
I0925 20:46:42.151727  5303 net.cpp:91] Creating Layer pool1
I0925 20:46:42.151733  5303 net.cpp:425] pool1 <- conv1
I0925 20:46:42.151741  5303 net.cpp:399] pool1 -> pool1
I0925 20:46:42.151829  5303 net.cpp:141] Setting up pool1
I0925 20:46:42.151839  5303 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0925 20:46:42.151844  5303 net.cpp:156] Memory required for data: 32214840
I0925 20:46:42.151850  5303 layer_factory.hpp:77] Creating layer norm1
I0925 20:46:42.151875  5303 net.cpp:91] Creating Layer norm1
I0925 20:46:42.151880  5303 net.cpp:425] norm1 <- pool1
I0925 20:46:42.151888  5303 net.cpp:399] norm1 -> norm1
I0925 20:46:42.152199  5303 net.cpp:141] Setting up norm1
I0925 20:46:42.152216  5303 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0925 20:46:42.152221  5303 net.cpp:156] Memory required for data: 35014200
I0925 20:46:42.152227  5303 layer_factory.hpp:77] Creating layer conv2
I0925 20:46:42.152245  5303 net.cpp:91] Creating Layer conv2
I0925 20:46:42.152251  5303 net.cpp:425] conv2 <- norm1
I0925 20:46:42.152262  5303 net.cpp:399] conv2 -> conv2
I0925 20:46:42.155899  5303 net.cpp:141] Setting up conv2
I0925 20:46:42.155921  5303 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0925 20:46:42.155927  5303 net.cpp:156] Memory required for data: 42479160
I0925 20:46:42.155941  5303 layer_factory.hpp:77] Creating layer relu2
I0925 20:46:42.155952  5303 net.cpp:91] Creating Layer relu2
I0925 20:46:42.155958  5303 net.cpp:425] relu2 <- conv2
I0925 20:46:42.155971  5303 net.cpp:386] relu2 -> conv2 (in-place)
I0925 20:46:42.156404  5303 net.cpp:141] Setting up relu2
I0925 20:46:42.156419  5303 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0925 20:46:42.156424  5303 net.cpp:156] Memory required for data: 49944120
I0925 20:46:42.156430  5303 layer_factory.hpp:77] Creating layer pool2
I0925 20:46:42.156440  5303 net.cpp:91] Creating Layer pool2
I0925 20:46:42.156445  5303 net.cpp:425] pool2 <- conv2
I0925 20:46:42.156456  5303 net.cpp:399] pool2 -> pool2
I0925 20:46:42.156522  5303 net.cpp:141] Setting up pool2
I0925 20:46:42.156530  5303 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0925 20:46:42.156535  5303 net.cpp:156] Memory required for data: 51674680
I0925 20:46:42.156543  5303 layer_factory.hpp:77] Creating layer norm2
I0925 20:46:42.156558  5303 net.cpp:91] Creating Layer norm2
I0925 20:46:42.156563  5303 net.cpp:425] norm2 <- pool2
I0925 20:46:42.156570  5303 net.cpp:399] norm2 -> norm2
I0925 20:46:42.156860  5303 net.cpp:141] Setting up norm2
I0925 20:46:42.156873  5303 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0925 20:46:42.156878  5303 net.cpp:156] Memory required for data: 53405240
I0925 20:46:42.156884  5303 layer_factory.hpp:77] Creating layer conv3
I0925 20:46:42.156900  5303 net.cpp:91] Creating Layer conv3
I0925 20:46:42.156906  5303 net.cpp:425] conv3 <- norm2
I0925 20:46:42.156915  5303 net.cpp:399] conv3 -> conv3
I0925 20:46:42.161118  5303 net.cpp:141] Setting up conv3
I0925 20:46:42.161144  5303 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0925 20:46:42.161150  5303 net.cpp:156] Memory required for data: 56001080
I0925 20:46:42.161166  5303 layer_factory.hpp:77] Creating layer relu3
I0925 20:46:42.161180  5303 net.cpp:91] Creating Layer relu3
I0925 20:46:42.161185  5303 net.cpp:425] relu3 <- conv3
I0925 20:46:42.161195  5303 net.cpp:386] relu3 -> conv3 (in-place)
I0925 20:46:42.161450  5303 net.cpp:141] Setting up relu3
I0925 20:46:42.161463  5303 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0925 20:46:42.161468  5303 net.cpp:156] Memory required for data: 58596920
I0925 20:46:42.161475  5303 layer_factory.hpp:77] Creating layer conv4
I0925 20:46:42.161494  5303 net.cpp:91] Creating Layer conv4
I0925 20:46:42.161499  5303 net.cpp:425] conv4 <- conv3
I0925 20:46:42.161509  5303 net.cpp:399] conv4 -> conv4
I0925 20:46:42.166048  5303 net.cpp:141] Setting up conv4
I0925 20:46:42.166079  5303 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0925 20:46:42.166087  5303 net.cpp:156] Memory required for data: 61192760
I0925 20:46:42.166100  5303 layer_factory.hpp:77] Creating layer relu4
I0925 20:46:42.166112  5303 net.cpp:91] Creating Layer relu4
I0925 20:46:42.166118  5303 net.cpp:425] relu4 <- conv4
I0925 20:46:42.166126  5303 net.cpp:386] relu4 -> conv4 (in-place)
I0925 20:46:42.166550  5303 net.cpp:141] Setting up relu4
I0925 20:46:42.166565  5303 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0925 20:46:42.166570  5303 net.cpp:156] Memory required for data: 63788600
I0925 20:46:42.166575  5303 layer_factory.hpp:77] Creating layer conv5
I0925 20:46:42.166594  5303 net.cpp:91] Creating Layer conv5
I0925 20:46:42.166607  5303 net.cpp:425] conv5 <- conv4
I0925 20:46:42.166620  5303 net.cpp:399] conv5 -> conv5
I0925 20:46:42.171059  5303 net.cpp:141] Setting up conv5
I0925 20:46:42.171087  5303 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0925 20:46:42.171092  5303 net.cpp:156] Memory required for data: 65519160
I0925 20:46:42.171111  5303 layer_factory.hpp:77] Creating layer relu5
I0925 20:46:42.171123  5303 net.cpp:91] Creating Layer relu5
I0925 20:46:42.171129  5303 net.cpp:425] relu5 <- conv5
I0925 20:46:42.171141  5303 net.cpp:386] relu5 -> conv5 (in-place)
I0925 20:46:42.171571  5303 net.cpp:141] Setting up relu5
I0925 20:46:42.171586  5303 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0925 20:46:42.171591  5303 net.cpp:156] Memory required for data: 67249720
I0925 20:46:42.171596  5303 layer_factory.hpp:77] Creating layer pool5
I0925 20:46:42.171608  5303 net.cpp:91] Creating Layer pool5
I0925 20:46:42.171613  5303 net.cpp:425] pool5 <- conv5
I0925 20:46:42.171625  5303 net.cpp:399] pool5 -> pool5
I0925 20:46:42.171694  5303 net.cpp:141] Setting up pool5
I0925 20:46:42.171705  5303 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0925 20:46:42.171708  5303 net.cpp:156] Memory required for data: 67618360
I0925 20:46:42.171713  5303 layer_factory.hpp:77] Creating layer fc6
I0925 20:46:42.171736  5303 net.cpp:91] Creating Layer fc6
I0925 20:46:42.171741  5303 net.cpp:425] fc6 <- pool5
I0925 20:46:42.171751  5303 net.cpp:399] fc6 -> fc6
I0925 20:46:42.261435  5297 net.cpp:141] Setting up embedding
I0925 20:46:42.261494  5297 net.cpp:148] Top shape: 1 1 500 (500)
I0925 20:46:42.261502  5297 net.cpp:156] Memory required for data: 22408
I0925 20:46:42.261526  5297 layer_factory.hpp:77] Creating layer lstm1
I0925 20:46:42.261564  5297 net.cpp:91] Creating Layer lstm1
I0925 20:46:42.261572  5297 net.cpp:425] lstm1 <- embedded_input_frames
I0925 20:46:42.261582  5297 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0925 20:46:42.261595  5297 net.cpp:399] lstm1 -> lstm1
I0925 20:46:42.261641  5297 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 20:46:42.262109  5297 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 20:46:42.262219  5297 layer_factory.hpp:77] Creating layer lstm1_
I0925 20:46:42.262234  5297 net.cpp:91] Creating Layer lstm1_
I0925 20:46:42.262240  5297 net.cpp:399] lstm1_ -> x
I0925 20:46:42.262254  5297 net.cpp:399] lstm1_ -> cont
I0925 20:46:42.262334  5297 net.cpp:141] Setting up lstm1_
I0925 20:46:42.262346  5297 net.cpp:148] Top shape: 1 1 500 (500)
I0925 20:46:42.262352  5297 net.cpp:148] Top shape: 1 1 (1)
I0925 20:46:42.262356  5297 net.cpp:156] Memory required for data: 2004
I0925 20:46:42.262362  5297 layer_factory.hpp:77] Creating layer lstm1_
I0925 20:46:42.262372  5297 net.cpp:91] Creating Layer lstm1_
I0925 20:46:42.262382  5297 net.cpp:399] lstm1_ -> c_0
I0925 20:46:42.262392  5297 net.cpp:399] lstm1_ -> h_0
I0925 20:46:42.262447  5297 net.cpp:141] Setting up lstm1_
I0925 20:46:42.262456  5297 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:46:42.262464  5297 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:46:42.262467  5297 net.cpp:156] Memory required for data: 10004
I0925 20:46:42.262472  5297 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0925 20:46:42.262487  5297 net.cpp:91] Creating Layer lstm1_cont_slice
I0925 20:46:42.262493  5297 net.cpp:425] lstm1_cont_slice <- cont
I0925 20:46:42.262501  5297 net.cpp:399] lstm1_cont_slice -> cont_1
I0925 20:46:42.262542  5297 net.cpp:141] Setting up lstm1_cont_slice
I0925 20:46:42.262552  5297 net.cpp:148] Top shape: 1 1 (1)
I0925 20:46:42.262557  5297 net.cpp:156] Memory required for data: 10008
I0925 20:46:42.262562  5297 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0925 20:46:42.262569  5297 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0925 20:46:42.262574  5297 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0925 20:46:42.262584  5297 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0925 20:46:42.262609  5297 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0925 20:46:42.262678  5297 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0925 20:46:42.262693  5297 net.cpp:148] Top shape: 1 1 (1)
I0925 20:46:42.262699  5297 net.cpp:148] Top shape: 1 1 (1)
I0925 20:46:42.262704  5297 net.cpp:156] Memory required for data: 10016
I0925 20:46:42.262709  5297 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0925 20:46:42.262720  5297 net.cpp:91] Creating Layer lstm1_x_transform
I0925 20:46:42.262725  5297 net.cpp:425] lstm1_x_transform <- x
I0925 20:46:42.262733  5297 net.cpp:399] lstm1_x_transform -> W_xc_x
I0925 20:46:42.286665  5297 net.cpp:141] Setting up lstm1_x_transform
I0925 20:46:42.286725  5297 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 20:46:42.286736  5297 net.cpp:156] Memory required for data: 26016
I0925 20:46:42.286770  5297 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0925 20:46:42.286803  5297 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0925 20:46:42.286815  5297 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0925 20:46:42.286830  5297 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0925 20:46:42.286903  5297 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0925 20:46:42.286921  5297 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 20:46:42.286928  5297 net.cpp:156] Memory required for data: 42016
I0925 20:46:42.286938  5297 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0925 20:46:42.286960  5297 net.cpp:91] Creating Layer lstm1_h_conted_0
I0925 20:46:42.286970  5297 net.cpp:425] lstm1_h_conted_0 <- h_0
I0925 20:46:42.286981  5297 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0925 20:46:42.286994  5297 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0925 20:46:42.287145  5297 net.cpp:141] Setting up lstm1_h_conted_0
I0925 20:46:42.287163  5297 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:46:42.287170  5297 net.cpp:156] Memory required for data: 46016
I0925 20:46:42.287178  5297 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0925 20:46:42.287205  5297 net.cpp:91] Creating Layer lstm1_transform_1
I0925 20:46:42.287216  5297 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0925 20:46:42.287230  5297 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0925 20:46:42.314846  5303 net.cpp:141] Setting up fc6
I0925 20:46:42.314915  5303 net.cpp:148] Top shape: 10 4096 (40960)
I0925 20:46:42.314923  5303 net.cpp:156] Memory required for data: 67782200
I0925 20:46:42.314940  5303 layer_factory.hpp:77] Creating layer relu6
I0925 20:46:42.314959  5303 net.cpp:91] Creating Layer relu6
I0925 20:46:42.314966  5303 net.cpp:425] relu6 <- fc6
I0925 20:46:42.315032  5303 net.cpp:386] relu6 -> fc6 (in-place)
I0925 20:46:42.315448  5303 net.cpp:141] Setting up relu6
I0925 20:46:42.315466  5303 net.cpp:148] Top shape: 10 4096 (40960)
I0925 20:46:42.315472  5303 net.cpp:156] Memory required for data: 67946040
I0925 20:46:42.315477  5303 layer_factory.hpp:77] Creating layer drop6
I0925 20:46:42.315500  5303 net.cpp:91] Creating Layer drop6
I0925 20:46:42.315505  5303 net.cpp:425] drop6 <- fc6
I0925 20:46:42.315512  5303 net.cpp:386] drop6 -> fc6 (in-place)
I0925 20:46:42.315573  5303 net.cpp:141] Setting up drop6
I0925 20:46:42.315583  5303 net.cpp:148] Top shape: 10 4096 (40960)
I0925 20:46:42.315588  5303 net.cpp:156] Memory required for data: 68109880
I0925 20:46:42.315593  5303 layer_factory.hpp:77] Creating layer fc7
I0925 20:46:42.315606  5303 net.cpp:91] Creating Layer fc7
I0925 20:46:42.315613  5303 net.cpp:425] fc7 <- fc6
I0925 20:46:42.315620  5303 net.cpp:399] fc7 -> fc7
I0925 20:46:42.349133  5297 net.cpp:141] Setting up lstm1_transform_1
I0925 20:46:42.349189  5297 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 20:46:42.349197  5297 net.cpp:156] Memory required for data: 62016
I0925 20:46:42.349221  5297 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0925 20:46:42.349251  5297 net.cpp:91] Creating Layer lstm1_gate_input_1
I0925 20:46:42.349258  5297 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0925 20:46:42.349267  5297 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0925 20:46:42.349278  5297 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0925 20:46:42.349354  5297 net.cpp:141] Setting up lstm1_gate_input_1
I0925 20:46:42.349364  5297 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 20:46:42.349369  5297 net.cpp:156] Memory required for data: 78016
I0925 20:46:42.349373  5297 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0925 20:46:42.349387  5297 net.cpp:91] Creating Layer lstm1_unit_1
I0925 20:46:42.349392  5297 net.cpp:425] lstm1_unit_1 <- c_0
I0925 20:46:42.349400  5297 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0925 20:46:42.349405  5297 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0925 20:46:42.349411  5297 net.cpp:399] lstm1_unit_1 -> c_1
I0925 20:46:42.349421  5297 net.cpp:399] lstm1_unit_1 -> h_1
I0925 20:46:42.349493  5297 net.cpp:141] Setting up lstm1_unit_1
I0925 20:46:42.349510  5297 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:46:42.349517  5297 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:46:42.349521  5297 net.cpp:156] Memory required for data: 86016
I0925 20:46:42.349526  5297 layer_factory.hpp:77] Creating layer lstm1_
I0925 20:46:42.349536  5297 net.cpp:91] Creating Layer lstm1_
I0925 20:46:42.349541  5297 net.cpp:425] lstm1_ <- c_1
I0925 20:46:42.349551  5297 net.cpp:399] lstm1_ -> c_T
I0925 20:46:42.349587  5297 net.cpp:141] Setting up lstm1_
I0925 20:46:42.349596  5297 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:46:42.349601  5297 net.cpp:156] Memory required for data: 90016
I0925 20:46:42.349606  5297 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0925 20:46:42.349616  5297 net.cpp:91] Creating Layer lstm1_h_concat
I0925 20:46:42.349622  5297 net.cpp:425] lstm1_h_concat <- h_1
I0925 20:46:42.349628  5297 net.cpp:399] lstm1_h_concat -> h
I0925 20:46:42.349669  5297 net.cpp:141] Setting up lstm1_h_concat
I0925 20:46:42.349678  5297 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:46:42.349684  5297 net.cpp:156] Memory required for data: 94016
I0925 20:46:42.349687  5297 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 20:46:42.349704  5297 net.cpp:91] Creating Layer h_pseudoloss
I0925 20:46:42.349709  5297 net.cpp:425] h_pseudoloss <- h
I0925 20:46:42.349716  5297 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 20:46:42.349819  5297 net.cpp:141] Setting up h_pseudoloss
I0925 20:46:42.349830  5297 net.cpp:148] Top shape: (1)
I0925 20:46:42.349835  5297 net.cpp:151]     with loss weight 1
I0925 20:46:42.349876  5297 net.cpp:156] Memory required for data: 94020
I0925 20:46:42.349884  5297 net.cpp:217] h_pseudoloss needs backward computation.
I0925 20:46:42.349889  5297 net.cpp:217] lstm1_h_concat needs backward computation.
I0925 20:46:42.349894  5297 net.cpp:219] lstm1_ does not need backward computation.
I0925 20:46:42.349897  5297 net.cpp:217] lstm1_unit_1 needs backward computation.
I0925 20:46:42.349905  5297 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0925 20:46:42.349912  5297 net.cpp:217] lstm1_transform_1 needs backward computation.
I0925 20:46:42.349917  5297 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0925 20:46:42.349925  5297 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0925 20:46:42.349930  5297 net.cpp:217] lstm1_x_transform needs backward computation.
I0925 20:46:42.349936  5297 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0925 20:46:42.349941  5297 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0925 20:46:42.349946  5297 net.cpp:219] lstm1_ does not need backward computation.
I0925 20:46:42.349951  5297 net.cpp:219] lstm1_ does not need backward computation.
I0925 20:46:42.349954  5297 net.cpp:261] This network produces output c_T
I0925 20:46:42.349959  5297 net.cpp:261] This network produces output h_pseudoloss
I0925 20:46:42.349979  5297 net.cpp:274] Network initialization done.
I0925 20:46:42.350047  5297 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 20:46:42.350054  5297 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 20:46:42.350059  5297 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 20:46:42.350181  5297 net.cpp:141] Setting up lstm1
I0925 20:46:42.350194  5297 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:46:42.350199  5297 net.cpp:156] Memory required for data: 26408
I0925 20:46:42.350214  5297 layer_factory.hpp:77] Creating layer concat
I0925 20:46:42.350222  5297 net.cpp:91] Creating Layer concat
I0925 20:46:42.350229  5297 net.cpp:425] concat <- lstm1
I0925 20:46:42.350235  5297 net.cpp:425] concat <- embedded_input_sentence
I0925 20:46:42.350242  5297 net.cpp:425] concat <- reshaped_stage_indicator
I0925 20:46:42.350250  5297 net.cpp:399] concat -> lstm1_video_sequence
I0925 20:46:42.350287  5297 net.cpp:141] Setting up concat
I0925 20:46:42.350296  5297 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 20:46:42.350301  5297 net.cpp:156] Memory required for data: 32412
I0925 20:46:42.350306  5297 layer_factory.hpp:77] Creating layer lstm2
I0925 20:46:42.350318  5297 net.cpp:91] Creating Layer lstm2
I0925 20:46:42.350324  5297 net.cpp:425] lstm2 <- lstm1_video_sequence
I0925 20:46:42.350330  5297 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0925 20:46:42.350337  5297 net.cpp:399] lstm2 -> lstm2
I0925 20:46:42.350350  5297 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 20:46:42.350682  5297 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 20:46:42.350785  5297 layer_factory.hpp:77] Creating layer lstm2_
I0925 20:46:42.350796  5297 net.cpp:91] Creating Layer lstm2_
I0925 20:46:42.350803  5297 net.cpp:399] lstm2_ -> x
I0925 20:46:42.350816  5297 net.cpp:399] lstm2_ -> cont
I0925 20:46:42.350875  5297 net.cpp:141] Setting up lstm2_
I0925 20:46:42.350885  5297 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 20:46:42.350891  5297 net.cpp:148] Top shape: 1 1 (1)
I0925 20:46:42.350895  5297 net.cpp:156] Memory required for data: 6008
I0925 20:46:42.350900  5297 layer_factory.hpp:77] Creating layer lstm2_
I0925 20:46:42.350914  5297 net.cpp:91] Creating Layer lstm2_
I0925 20:46:42.350920  5297 net.cpp:399] lstm2_ -> c_0
I0925 20:46:42.350930  5297 net.cpp:399] lstm2_ -> h_0
I0925 20:46:42.350986  5297 net.cpp:141] Setting up lstm2_
I0925 20:46:42.350994  5297 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:46:42.351001  5297 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:46:42.351004  5297 net.cpp:156] Memory required for data: 14008
I0925 20:46:42.351009  5297 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0925 20:46:42.351018  5297 net.cpp:91] Creating Layer lstm2_cont_slice
I0925 20:46:42.351023  5297 net.cpp:425] lstm2_cont_slice <- cont
I0925 20:46:42.351032  5297 net.cpp:399] lstm2_cont_slice -> cont_1
I0925 20:46:42.351065  5297 net.cpp:141] Setting up lstm2_cont_slice
I0925 20:46:42.351074  5297 net.cpp:148] Top shape: 1 1 (1)
I0925 20:46:42.351078  5297 net.cpp:156] Memory required for data: 14012
I0925 20:46:42.351083  5297 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0925 20:46:42.351094  5297 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0925 20:46:42.351099  5297 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0925 20:46:42.351105  5297 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0925 20:46:42.351116  5297 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0925 20:46:42.351166  5297 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0925 20:46:42.351176  5297 net.cpp:148] Top shape: 1 1 (1)
I0925 20:46:42.351181  5297 net.cpp:148] Top shape: 1 1 (1)
I0925 20:46:42.351186  5297 net.cpp:156] Memory required for data: 14020
I0925 20:46:42.351189  5297 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0925 20:46:42.351202  5297 net.cpp:91] Creating Layer lstm2_x_transform
I0925 20:46:42.351208  5297 net.cpp:425] lstm2_x_transform <- x
I0925 20:46:42.351218  5297 net.cpp:399] lstm2_x_transform -> W_xc_x
I0925 20:46:42.367463  5303 net.cpp:141] Setting up fc7
I0925 20:46:42.367512  5303 net.cpp:148] Top shape: 10 4096 (40960)
I0925 20:46:42.367518  5303 net.cpp:156] Memory required for data: 68273720
I0925 20:46:42.367533  5303 layer_factory.hpp:77] Creating layer relu7
I0925 20:46:42.367554  5303 net.cpp:91] Creating Layer relu7
I0925 20:46:42.367563  5303 net.cpp:425] relu7 <- fc7
I0925 20:46:42.367571  5303 net.cpp:386] relu7 -> fc7 (in-place)
I0925 20:46:42.368301  5303 net.cpp:141] Setting up relu7
I0925 20:46:42.368316  5303 net.cpp:148] Top shape: 10 4096 (40960)
I0925 20:46:42.368321  5303 net.cpp:156] Memory required for data: 68437560
I0925 20:46:42.368327  5303 layer_factory.hpp:77] Creating layer drop7
I0925 20:46:42.368342  5303 net.cpp:91] Creating Layer drop7
I0925 20:46:42.368348  5303 net.cpp:425] drop7 <- fc7
I0925 20:46:42.368355  5303 net.cpp:386] drop7 -> fc7 (in-place)
I0925 20:46:42.368439  5303 net.cpp:141] Setting up drop7
I0925 20:46:42.368484  5303 net.cpp:148] Top shape: 10 4096 (40960)
I0925 20:46:42.368494  5303 net.cpp:156] Memory required for data: 68601400
I0925 20:46:42.368506  5303 layer_factory.hpp:77] Creating layer fc8
I0925 20:46:42.368530  5303 net.cpp:91] Creating Layer fc8
I0925 20:46:42.368540  5303 net.cpp:425] fc8 <- fc7
I0925 20:46:42.368585  5303 net.cpp:399] fc8 -> fc8
I0925 20:46:42.385455  5303 net.cpp:141] Setting up fc8
I0925 20:46:42.385514  5303 net.cpp:148] Top shape: 10 1000 (10000)
I0925 20:46:42.385524  5303 net.cpp:156] Memory required for data: 68641400
I0925 20:46:42.385545  5303 layer_factory.hpp:77] Creating layer prob
I0925 20:46:42.385573  5303 net.cpp:91] Creating Layer prob
I0925 20:46:42.385584  5303 net.cpp:425] prob <- fc8
I0925 20:46:42.385599  5303 net.cpp:399] prob -> prob
I0925 20:46:42.386230  5303 net.cpp:141] Setting up prob
I0925 20:46:42.386248  5303 net.cpp:148] Top shape: 10 1000 (10000)
I0925 20:46:42.386255  5303 net.cpp:156] Memory required for data: 68681400
I0925 20:46:42.386265  5303 net.cpp:219] prob does not need backward computation.
I0925 20:46:42.386273  5303 net.cpp:219] fc8 does not need backward computation.
I0925 20:46:42.386282  5303 net.cpp:219] drop7 does not need backward computation.
I0925 20:46:42.386289  5303 net.cpp:219] relu7 does not need backward computation.
I0925 20:46:42.386297  5303 net.cpp:219] fc7 does not need backward computation.
I0925 20:46:42.386306  5303 net.cpp:219] drop6 does not need backward computation.
I0925 20:46:42.386314  5303 net.cpp:219] relu6 does not need backward computation.
I0925 20:46:42.386322  5303 net.cpp:219] fc6 does not need backward computation.
I0925 20:46:42.386329  5303 net.cpp:219] pool5 does not need backward computation.
I0925 20:46:42.386337  5303 net.cpp:219] relu5 does not need backward computation.
I0925 20:46:42.386345  5303 net.cpp:219] conv5 does not need backward computation.
I0925 20:46:42.386353  5303 net.cpp:219] relu4 does not need backward computation.
I0925 20:46:42.386360  5303 net.cpp:219] conv4 does not need backward computation.
I0925 20:46:42.386368  5303 net.cpp:219] relu3 does not need backward computation.
I0925 20:46:42.386376  5303 net.cpp:219] conv3 does not need backward computation.
I0925 20:46:42.386386  5303 net.cpp:219] norm2 does not need backward computation.
I0925 20:46:42.386394  5303 net.cpp:219] pool2 does not need backward computation.
I0925 20:46:42.386404  5303 net.cpp:219] relu2 does not need backward computation.
I0925 20:46:42.386410  5303 net.cpp:219] conv2 does not need backward computation.
I0925 20:46:42.386418  5303 net.cpp:219] norm1 does not need backward computation.
I0925 20:46:42.386427  5303 net.cpp:219] pool1 does not need backward computation.
I0925 20:46:42.386435  5303 net.cpp:219] relu1 does not need backward computation.
I0925 20:46:42.386452  5303 net.cpp:219] conv1 does not need backward computation.
I0925 20:46:42.386461  5303 net.cpp:219] data does not need backward computation.
I0925 20:46:42.386466  5303 net.cpp:261] This network produces output prob
I0925 20:46:42.386509  5303 net.cpp:274] Network initialization done.
I0925 20:46:42.423316  5297 net.cpp:141] Setting up lstm2_x_transform
I0925 20:46:42.423367  5297 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 20:46:42.423374  5297 net.cpp:156] Memory required for data: 30020
I0925 20:46:42.423401  5297 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0925 20:46:42.423427  5297 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0925 20:46:42.423434  5297 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0925 20:46:42.423445  5297 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0925 20:46:42.423496  5297 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0925 20:46:42.423506  5297 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 20:46:42.423511  5297 net.cpp:156] Memory required for data: 46020
I0925 20:46:42.423516  5297 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0925 20:46:42.423530  5297 net.cpp:91] Creating Layer lstm2_h_conted_0
I0925 20:46:42.423537  5297 net.cpp:425] lstm2_h_conted_0 <- h_0
I0925 20:46:42.423542  5297 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0925 20:46:42.423550  5297 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0925 20:46:42.423653  5297 net.cpp:141] Setting up lstm2_h_conted_0
I0925 20:46:42.423663  5297 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:46:42.423668  5297 net.cpp:156] Memory required for data: 50020
I0925 20:46:42.423673  5297 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0925 20:46:42.423689  5297 net.cpp:91] Creating Layer lstm2_transform_1
I0925 20:46:42.423696  5297 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0925 20:46:42.423704  5297 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0925 20:46:42.466863  5297 net.cpp:141] Setting up lstm2_transform_1
Loading the model + trained: 5220.17ms
I0925 20:46:42.466914  5297 net.cpp:148] Top shape: 1 1 4000 (4000)
Using cv::Size and some other stuff: 0.03ms
I0925 20:46:42.466922  5297 net.cpp:156] Memory required for data: 66020
I0925 20:46:42.466944  5297 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0925 20:46:42.466972  5297 net.cpp:91] Creating Layer lstm2_gate_input_1
I0925 20:46:42.466979  5297 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0925 20:46:42.466989  5297 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0925 20:46:42.467000  5297 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0925 20:46:42.467054  5297 net.cpp:141] Setting up lstm2_gate_input_1
I0925 20:46:42.467063  5297 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 20:46:42.467067  5297 net.cpp:156] Memory required for data: 82020
I0925 20:46:42.467072  5297 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0925 20:46:42.467087  5297 net.cpp:91] Creating Layer lstm2_unit_1
I0925 20:46:42.467092  5297 net.cpp:425] lstm2_unit_1 <- c_0
I0925 20:46:42.467098  5297 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0925 20:46:42.467103  5297 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0925 20:46:42.467110  5297 net.cpp:399] lstm2_unit_1 -> c_1
I0925 20:46:42.467120  5297 net.cpp:399] lstm2_unit_1 -> h_1
I0925 20:46:42.467190  5297 net.cpp:141] Setting up lstm2_unit_1
I0925 20:46:42.467198  5297 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:46:42.467206  5297 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:46:42.467209  5297 net.cpp:156] Memory required for data: 90020
I0925 20:46:42.467214  5297 layer_factory.hpp:77] Creating layer lstm2_
I0925 20:46:42.467224  5297 net.cpp:91] Creating Layer lstm2_
I0925 20:46:42.467229  5297 net.cpp:425] lstm2_ <- c_1
I0925 20:46:42.467238  5297 net.cpp:399] lstm2_ -> c_T
I0925 20:46:42.467272  5297 net.cpp:141] Setting up lstm2_
I0925 20:46:42.467280  5297 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:46:42.467285  5297 net.cpp:156] Memory required for data: 94020
I0925 20:46:42.467290  5297 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0925 20:46:42.467301  5297 net.cpp:91] Creating Layer lstm2_h_concat
I0925 20:46:42.467306  5297 net.cpp:425] lstm2_h_concat <- h_1
I0925 20:46:42.467314  5297 net.cpp:399] lstm2_h_concat -> h
I0925 20:46:42.467355  5297 net.cpp:141] Setting up lstm2_h_concat
I0925 20:46:42.467365  5297 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:46:42.467368  5297 net.cpp:156] Memory required for data: 98020
I0925 20:46:42.467373  5297 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 20:46:42.467383  5297 net.cpp:91] Creating Layer h_pseudoloss
I0925 20:46:42.467388  5297 net.cpp:425] h_pseudoloss <- h
I0925 20:46:42.467396  5297 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 20:46:42.467496  5297 net.cpp:141] Setting up h_pseudoloss
I0925 20:46:42.467514  5297 net.cpp:148] Top shape: (1)
I0925 20:46:42.467519  5297 net.cpp:151]     with loss weight 1
I0925 20:46:42.467537  5297 net.cpp:156] Memory required for data: 98024
I0925 20:46:42.467543  5297 net.cpp:217] h_pseudoloss needs backward computation.
I0925 20:46:42.467548  5297 net.cpp:217] lstm2_h_concat needs backward computation.
I0925 20:46:42.467553  5297 net.cpp:219] lstm2_ does not need backward computation.
I0925 20:46:42.467558  5297 net.cpp:217] lstm2_unit_1 needs backward computation.
I0925 20:46:42.467564  5297 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0925 20:46:42.467569  5297 net.cpp:217] lstm2_transform_1 needs backward computation.
I0925 20:46:42.467574  5297 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0925 20:46:42.467581  5297 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0925 20:46:42.467586  5297 net.cpp:217] lstm2_x_transform needs backward computation.
I0925 20:46:42.467591  5297 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0925 20:46:42.467597  5297 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0925 20:46:42.467602  5297 net.cpp:219] lstm2_ does not need backward computation.
I0925 20:46:42.467605  5297 net.cpp:219] lstm2_ does not need backward computation.
I0925 20:46:42.467609  5297 net.cpp:261] This network produces output c_T
I0925 20:46:42.467613  5297 net.cpp:261] This network produces output h_pseudoloss
I0925 20:46:42.467631  5297 net.cpp:274] Network initialization done.
I0925 20:46:42.467689  5297 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 20:46:42.467696  5297 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 20:46:42.467701  5297 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 20:46:42.467815  5297 net.cpp:141] Setting up lstm2
I0925 20:46:42.467828  5297 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:46:42.467833  5297 net.cpp:156] Memory required for data: 36412
I0925 20:46:42.467847  5297 layer_factory.hpp:77] Creating layer predict
I0925 20:46:42.467862  5297 net.cpp:91] Creating Layer predict
I0925 20:46:42.467869  5297 net.cpp:425] predict <- lstm2
I0925 20:46:42.467876  5297 net.cpp:399] predict -> predict
I0925 20:46:42.636440  5303 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /home/peifeng/work/run/storm102/data/workers/15f6d291-2172-4264-8836-3953294fe137/tmp/cvld1439520717747607693/bvlc_reference_caffenet.caffemodel
I0925 20:46:42.636487  5303 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0925 20:46:42.636492  5303 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0925 20:46:42.636497  5303 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /home/peifeng/work/run/storm102/data/workers/15f6d291-2172-4264-8836-3953294fe137/tmp/cvld1439520717747607693/bvlc_reference_caffenet.caffemodel
I0925 20:46:42.954258  5297 net.cpp:141] Setting up predict
I0925 20:46:42.954313  5297 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 20:46:42.954319  5297 net.cpp:156] Memory required for data: 221084
I0925 20:46:42.954335  5297 layer_factory.hpp:77] Creating layer probs
I0925 20:46:42.954356  5297 net.cpp:91] Creating Layer probs
I0925 20:46:42.954365  5297 net.cpp:425] probs <- predict
I0925 20:46:42.954376  5297 net.cpp:399] probs -> probs
I0925 20:46:42.955247  5297 net.cpp:141] Setting up probs
I0925 20:46:42.955263  5297 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 20:46:42.955268  5297 net.cpp:156] Memory required for data: 405756
I0925 20:46:42.955274  5297 net.cpp:219] probs does not need backward computation.
I0925 20:46:42.955281  5297 net.cpp:219] predict does not need backward computation.
I0925 20:46:42.955286  5297 net.cpp:219] lstm2 does not need backward computation.
I0925 20:46:42.955292  5297 net.cpp:219] concat does not need backward computation.
I0925 20:46:42.955298  5297 net.cpp:219] lstm1 does not need backward computation.
I0925 20:46:42.955304  5297 net.cpp:219] embedding does not need backward computation.
I0925 20:46:42.955309  5297 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0925 20:46:42.955314  5297 net.cpp:219] reshape_frames does not need backward computation.
I0925 20:46:42.955319  5297 net.cpp:219] embed_encoder does not need backward computation.
I0925 20:46:42.955324  5297 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0925 20:46:42.955330  5297 net.cpp:219] input does not need backward computation.
I0925 20:46:42.955334  5297 net.cpp:261] This network produces output probs
I0925 20:46:42.955355  5297 net.cpp:274] Network initialization done.
I0925 20:46:43.036581  5303 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0925 20:46:43.092775  5303 net.cpp:752] Ignoring source layer loss
I0925 20:46:44.337806  5297 net.cpp:752] Ignoring source layer data
I0925 20:46:44.337851  5297 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0925 20:46:44.337857  5297 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0925 20:46:44.438333  5297 net.cpp:752] Ignoring source layer cross_entropy_loss
Loading the mean file: 68335.5ms
TIMERTIMER 313764934
TIMERTIMER 255851288
TIMERTIMER 267769251
TIMERTIMER 222570367
TIMERTIMER 228572749
TIMERTIMER 224726993
TIMERTIMER 233024791
TIMERTIMER 226304712
TIMERTIMER 221650670
TIMERTIMER 217461668
TIMERTIMER 233584486
TIMERTIMER 220762081
TIMERTIMER 223188182
TIMERTIMER 234989085
TIMERTIMER 236516286
TIMERTIMER 242039146
TIMERTIMER 220294949
TIMERTIMER 210033205
TIMERTIMER 221043245
TIMERTIMER 225603903
TIMERTIMER 208496259
TIMERTIMER 225430410
TIMERTIMER 225664924
TIMERTIMER 241955262
TIMERTIMER 229964024
TIMERTIMER 242622032
TIMERTIMER 239928702
TIMERTIMER 227622778
TIMERTIMER 224991342
TIMERTIMER 232896254
TIMERTIMER 224650478
TIMERTIMER 186824302
TIMERTIMER 192430692
TIMERTIMER 192781595
