SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/peifeng/tools/storm102/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/peifeng/work/run/storm102/data/supervisor/stormdist/captioning-1-1474854934/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /home/peifeng/work/run/storm102/data/workers/ef478da2-4fe4-4b49-abee-548938eadce6/tmp/cvld3031443149427038578/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0925 21:56:52.445158 12712 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/ef478da2-4fe4-4b49-abee-548938eadce6/tmp/cvld3031443149427038578/s2vt.words_to_preds.prototxt
I0925 21:56:52.445269 12694 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/ef478da2-4fe4-4b49-abee-548938eadce6/tmp/cvld3031443149427038578/s2vt.words_to_preds.prototxt
I0925 21:56:52.445293 12712 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
I0925 21:56:52.445300 12694 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0925 21:56:52.445305 12712 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
W0925 21:56:52.445309 12694 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0925 21:56:52.445430 12690 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/ef478da2-4fe4-4b49-abee-548938eadce6/tmp/cvld3031443149427038578/s2vt.words_to_preds.prototxt
I0925 21:56:52.445458 12718 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/ef478da2-4fe4-4b49-abee-548938eadce6/tmp/cvld3031443149427038578/s2vt.words_to_preds.prototxt
I0925 21:56:52.445430 12700 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/ef478da2-4fe4-4b49-abee-548938eadce6/tmp/cvld3031443149427038578/s2vt.words_to_preds.prototxt
I0925 21:56:52.445487 12690 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
I0925 21:56:52.445495 12718 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
I0925 21:56:52.445499 12700 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0925 21:56:52.445510 12700 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
W0925 21:56:52.445515 12718 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
W0925 21:56:52.445499 12690 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0925 21:56:52.445695 12712 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0925 21:56:52.445780 12694 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0925 21:56:52.445806 12698 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0925 21:56:52.445858 12712 layer_factory.hpp:77] Creating layer input
I0925 21:56:52.445889 12712 net.cpp:91] Creating Layer input
I0925 21:56:52.445902 12712 net.cpp:399] input -> frames_fc7
I0925 21:56:52.445940 12712 net.cpp:399] input -> cont_sentence
I0925 21:56:52.445953 12700 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0925 21:56:52.445961 12712 net.cpp:399] input -> input_sentence
I0925 21:56:52.445953 12690 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0925 21:56:52.446033 12712 net.cpp:399] input -> stage_indicator
I0925 21:56:52.446157 12690 layer_factory.hpp:77] Creating layer input
I0925 21:56:52.446157 12700 layer_factory.hpp:77] Creating layer input
I0925 21:56:52.446197 12690 net.cpp:91] Creating Layer input
I0925 21:56:52.446197 12700 net.cpp:91] Creating Layer input
I0925 21:56:52.446226 12690 net.cpp:399] input -> frames_fc7
I0925 21:56:52.446233 12700 net.cpp:399] input -> frames_fc7
I0925 21:56:52.446259 12700 net.cpp:399] input -> cont_sentence
I0925 21:56:52.446264 12690 net.cpp:399] input -> cont_sentence
I0925 21:56:52.446295 12700 net.cpp:399] input -> input_sentence
I0925 21:56:52.446298 12690 net.cpp:399] input -> input_sentence
I0925 21:56:52.446315 12690 net.cpp:399] input -> stage_indicator
I0925 21:56:52.446315 12700 net.cpp:399] input -> stage_indicator
I0925 21:56:52.446344 12694 layer_factory.hpp:77] Creating layer input
I0925 21:56:52.446378 12694 net.cpp:91] Creating Layer input
I0925 21:56:52.446393 12694 net.cpp:399] input -> frames_fc7
I0925 21:56:52.446415 12694 net.cpp:399] input -> cont_sentence
I0925 21:56:52.446434 12694 net.cpp:399] input -> input_sentence
I0925 21:56:52.446452 12694 net.cpp:399] input -> stage_indicator
I0925 21:56:52.446616 12718 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0925 21:56:52.446741 12718 layer_factory.hpp:77] Creating layer input
I0925 21:56:52.446758 12718 net.cpp:91] Creating Layer input
I0925 21:56:52.446768 12718 net.cpp:399] input -> frames_fc7
I0925 21:56:52.446784 12718 net.cpp:399] input -> cont_sentence
I0925 21:56:52.446800 12718 net.cpp:399] input -> input_sentence
I0925 21:56:52.446813 12718 net.cpp:399] input -> stage_indicator
I0925 21:56:52.449434 12698 layer_factory.hpp:77] Creating layer data
I0925 21:56:52.449494 12698 net.cpp:91] Creating Layer data
I0925 21:56:52.449512 12698 net.cpp:399] data -> data
I0925 21:56:53.207401 12712 net.cpp:141] Setting up input
I0925 21:56:53.207538 12698 net.cpp:141] Setting up data
I0925 21:56:53.207588 12698 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0925 21:56:53.207590 12712 net.cpp:148] Top shape: 1 4096 (4096)
I0925 21:56:53.207597 12698 net.cpp:156] Memory required for data: 6183480
I0925 21:56:53.207604 12712 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.207612 12712 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.207618 12712 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.207619 12698 layer_factory.hpp:77] Creating layer conv1
I0925 21:56:53.207624 12712 net.cpp:156] Memory required for data: 16396
I0925 21:56:53.207633 12712 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0925 21:56:53.207658 12712 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0925 21:56:53.207667 12712 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0925 21:56:53.207665 12698 net.cpp:91] Creating Layer conv1
I0925 21:56:53.207691 12698 net.cpp:425] conv1 <- data
I0925 21:56:53.207698 12712 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0925 21:56:53.207710 12698 net.cpp:399] conv1 -> conv1
I0925 21:56:53.207715 12712 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0925 21:56:53.207968 12718 net.cpp:141] Setting up input
I0925 21:56:53.208009 12718 net.cpp:148] Top shape: 1 4096 (4096)
I0925 21:56:53.208019 12718 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.208024 12718 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.208032 12718 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.208037 12718 net.cpp:156] Memory required for data: 16396
I0925 21:56:53.208046 12718 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0925 21:56:53.208065 12718 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0925 21:56:53.208072 12718 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0925 21:56:53.208083 12718 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0925 21:56:53.208099 12718 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0925 21:56:53.208132 12712 net.cpp:141] Setting up cont_sentence_input_1_split
I0925 21:56:53.208148 12712 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.208155 12712 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.208160 12712 net.cpp:156] Memory required for data: 16404
I0925 21:56:53.208166 12712 layer_factory.hpp:77] Creating layer embed_encoder
I0925 21:56:53.208189 12712 net.cpp:91] Creating Layer embed_encoder
I0925 21:56:53.208195 12712 net.cpp:425] embed_encoder <- frames_fc7
I0925 21:56:53.208205 12712 net.cpp:399] embed_encoder -> embedded_in_frames
I0925 21:56:53.208209 12690 net.cpp:141] Setting up input
I0925 21:56:53.208230 12690 net.cpp:148] Top shape: 1 4096 (4096)
I0925 21:56:53.208237 12690 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.208243 12690 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.208251 12690 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.208256 12690 net.cpp:156] Memory required for data: 16396
I0925 21:56:53.208262 12690 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0925 21:56:53.208261 12694 net.cpp:141] Setting up input
I0925 21:56:53.208276 12690 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0925 21:56:53.208277 12700 net.cpp:141] Setting up input
I0925 21:56:53.208282 12690 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0925 21:56:53.208298 12700 net.cpp:148] Top shape: 1 4096 (4096)
I0925 21:56:53.208299 12694 net.cpp:148] Top shape: 1 4096 (4096)
I0925 21:56:53.208307 12700 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.208309 12690 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0925 21:56:53.208313 12700 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.208313 12694 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.208326 12700 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.208323 12690 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0925 21:56:53.208333 12700 net.cpp:156] Memory required for data: 16396
I0925 21:56:53.208338 12694 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.208341 12700 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0925 21:56:53.208345 12718 net.cpp:141] Setting up cont_sentence_input_1_split
I0925 21:56:53.208346 12694 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.208360 12700 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0925 21:56:53.208376 12694 net.cpp:156] Memory required for data: 16396
I0925 21:56:53.208381 12700 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0925 21:56:53.208364 12718 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.208392 12700 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0925 21:56:53.208392 12694 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0925 21:56:53.208400 12718 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.208410 12700 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0925 21:56:53.208416 12694 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0925 21:56:53.208410 12690 net.cpp:141] Setting up cont_sentence_input_1_split
I0925 21:56:53.208416 12718 net.cpp:156] Memory required for data: 16404
I0925 21:56:53.208430 12694 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0925 21:56:53.208433 12718 layer_factory.hpp:77] Creating layer embed_encoder
I0925 21:56:53.208432 12690 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.208449 12690 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.208449 12694 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0925 21:56:53.208453 12718 net.cpp:91] Creating Layer embed_encoder
I0925 21:56:53.208456 12690 net.cpp:156] Memory required for data: 16404
I0925 21:56:53.208461 12718 net.cpp:425] embed_encoder <- frames_fc7
I0925 21:56:53.208463 12690 layer_factory.hpp:77] Creating layer embed_encoder
I0925 21:56:53.208465 12694 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0925 21:56:53.208475 12718 net.cpp:399] embed_encoder -> embedded_in_frames
I0925 21:56:53.208487 12690 net.cpp:91] Creating Layer embed_encoder
I0925 21:56:53.208505 12690 net.cpp:425] embed_encoder <- frames_fc7
I0925 21:56:53.208518 12690 net.cpp:399] embed_encoder -> embedded_in_frames
I0925 21:56:53.213106 12700 net.cpp:141] Setting up cont_sentence_input_1_split
I0925 21:56:53.213152 12700 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.213172 12700 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.213187 12700 net.cpp:156] Memory required for data: 16404
I0925 21:56:53.213203 12700 layer_factory.hpp:77] Creating layer embed_encoder
I0925 21:56:53.213234 12700 net.cpp:91] Creating Layer embed_encoder
I0925 21:56:53.213253 12700 net.cpp:425] embed_encoder <- frames_fc7
I0925 21:56:53.213282 12700 net.cpp:399] embed_encoder -> embedded_in_frames
I0925 21:56:53.218195 12694 net.cpp:141] Setting up cont_sentence_input_1_split
I0925 21:56:53.218227 12694 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.218235 12694 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.218241 12694 net.cpp:156] Memory required for data: 16404
I0925 21:56:53.218247 12694 layer_factory.hpp:77] Creating layer embed_encoder
I0925 21:56:53.218276 12694 net.cpp:91] Creating Layer embed_encoder
I0925 21:56:53.218283 12694 net.cpp:425] embed_encoder <- frames_fc7
I0925 21:56:53.218293 12694 net.cpp:399] embed_encoder -> embedded_in_frames
I0925 21:56:53.240522 12712 net.cpp:141] Setting up embed_encoder
I0925 21:56:53.240576 12712 net.cpp:148] Top shape: 1 500 (500)
I0925 21:56:53.240588 12712 net.cpp:156] Memory required for data: 18404
I0925 21:56:53.240627 12712 layer_factory.hpp:77] Creating layer reshape_frames
I0925 21:56:53.240661 12712 net.cpp:91] Creating Layer reshape_frames
I0925 21:56:53.240674 12712 net.cpp:425] reshape_frames <- embedded_in_frames
I0925 21:56:53.240690 12712 net.cpp:399] reshape_frames -> embedded_input_frames
I0925 21:56:53.240759 12712 net.cpp:141] Setting up reshape_frames
I0925 21:56:53.240773 12712 net.cpp:148] Top shape: 1 1 500 (500)
I0925 21:56:53.240782 12712 net.cpp:156] Memory required for data: 20404
I0925 21:56:53.240792 12712 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0925 21:56:53.240806 12712 net.cpp:91] Creating Layer reshape_stage_indicator
I0925 21:56:53.240816 12712 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0925 21:56:53.240829 12712 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0925 21:56:53.240880 12712 net.cpp:141] Setting up reshape_stage_indicator
I0925 21:56:53.240895 12712 net.cpp:148] Top shape: 1 1 1 (1)
I0925 21:56:53.240903 12712 net.cpp:156] Memory required for data: 20408
I0925 21:56:53.240912 12712 layer_factory.hpp:77] Creating layer embedding
I0925 21:56:53.240928 12712 net.cpp:91] Creating Layer embedding
I0925 21:56:53.240937 12712 net.cpp:425] embedding <- input_sentence
I0925 21:56:53.240955 12712 net.cpp:399] embedding -> embedded_input_sentence
I0925 21:56:53.291218 12718 net.cpp:141] Setting up embed_encoder
I0925 21:56:53.291273 12718 net.cpp:148] Top shape: 1 500 (500)
I0925 21:56:53.291280 12718 net.cpp:156] Memory required for data: 18404
I0925 21:56:53.291308 12718 layer_factory.hpp:77] Creating layer reshape_frames
I0925 21:56:53.291335 12718 net.cpp:91] Creating Layer reshape_frames
I0925 21:56:53.291344 12718 net.cpp:425] reshape_frames <- embedded_in_frames
I0925 21:56:53.291357 12718 net.cpp:399] reshape_frames -> embedded_input_frames
I0925 21:56:53.291767 12700 net.cpp:141] Setting up embed_encoder
I0925 21:56:53.291833 12700 net.cpp:148] Top shape: 1 500 (500)
I0925 21:56:53.291852 12700 net.cpp:156] Memory required for data: 18404
I0925 21:56:53.291901 12700 layer_factory.hpp:77] Creating layer reshape_frames
I0925 21:56:53.291940 12700 net.cpp:91] Creating Layer reshape_frames
I0925 21:56:53.291963 12700 net.cpp:425] reshape_frames <- embedded_in_frames
I0925 21:56:53.291991 12700 net.cpp:399] reshape_frames -> embedded_input_frames
I0925 21:56:53.292105 12700 net.cpp:141] Setting up reshape_frames
I0925 21:56:53.292135 12700 net.cpp:148] Top shape: 1 1 500 (500)
I0925 21:56:53.292150 12700 net.cpp:156] Memory required for data: 20404
I0925 21:56:53.292167 12700 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0925 21:56:53.292196 12700 net.cpp:91] Creating Layer reshape_stage_indicator
I0925 21:56:53.292214 12700 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0925 21:56:53.292240 12700 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0925 21:56:53.292335 12700 net.cpp:141] Setting up reshape_stage_indicator
I0925 21:56:53.292366 12700 net.cpp:148] Top shape: 1 1 1 (1)
I0925 21:56:53.292382 12700 net.cpp:156] Memory required for data: 20408
I0925 21:56:53.292397 12700 layer_factory.hpp:77] Creating layer embedding
I0925 21:56:53.292425 12700 net.cpp:91] Creating Layer embedding
I0925 21:56:53.292443 12700 net.cpp:425] embedding <- input_sentence
I0925 21:56:53.292469 12700 net.cpp:399] embedding -> embedded_input_sentence
I0925 21:56:53.361052 12718 net.cpp:141] Setting up reshape_frames
I0925 21:56:53.361116 12718 net.cpp:148] Top shape: 1 1 500 (500)
I0925 21:56:53.361127 12718 net.cpp:156] Memory required for data: 20404
I0925 21:56:53.361141 12718 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0925 21:56:53.361179 12718 net.cpp:91] Creating Layer reshape_stage_indicator
I0925 21:56:53.361191 12718 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0925 21:56:53.361212 12718 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0925 21:56:53.361320 12718 net.cpp:141] Setting up reshape_stage_indicator
I0925 21:56:53.361340 12718 net.cpp:148] Top shape: 1 1 1 (1)
I0925 21:56:53.361347 12718 net.cpp:156] Memory required for data: 20408
I0925 21:56:53.361356 12718 layer_factory.hpp:77] Creating layer embedding
I0925 21:56:53.361379 12718 net.cpp:91] Creating Layer embedding
I0925 21:56:53.361388 12718 net.cpp:425] embedding <- input_sentence
I0925 21:56:53.361403 12718 net.cpp:399] embedding -> embedded_input_sentence
I0925 21:56:53.361459 12690 net.cpp:141] Setting up embed_encoder
I0925 21:56:53.361486 12690 net.cpp:148] Top shape: 1 500 (500)
I0925 21:56:53.361495 12690 net.cpp:156] Memory required for data: 18404
I0925 21:56:53.361522 12690 layer_factory.hpp:77] Creating layer reshape_frames
I0925 21:56:53.361541 12690 net.cpp:91] Creating Layer reshape_frames
I0925 21:56:53.361552 12690 net.cpp:425] reshape_frames <- embedded_in_frames
I0925 21:56:53.361554 12694 net.cpp:141] Setting up embed_encoder
I0925 21:56:53.361572 12690 net.cpp:399] reshape_frames -> embedded_input_frames
I0925 21:56:53.361603 12694 net.cpp:148] Top shape: 1 500 (500)
I0925 21:56:53.361611 12694 net.cpp:156] Memory required for data: 18404
I0925 21:56:53.361632 12694 layer_factory.hpp:77] Creating layer reshape_frames
I0925 21:56:53.361666 12694 net.cpp:91] Creating Layer reshape_frames
I0925 21:56:53.361675 12694 net.cpp:425] reshape_frames <- embedded_in_frames
I0925 21:56:53.361686 12694 net.cpp:399] reshape_frames -> embedded_input_frames
I0925 21:56:53.412979 12690 net.cpp:141] Setting up reshape_frames
I0925 21:56:53.413044 12690 net.cpp:148] Top shape: 1 1 500 (500)
I0925 21:56:53.413055 12690 net.cpp:156] Memory required for data: 20404
I0925 21:56:53.413072 12690 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0925 21:56:53.413090 12694 net.cpp:141] Setting up reshape_frames
I0925 21:56:53.413110 12690 net.cpp:91] Creating Layer reshape_stage_indicator
I0925 21:56:53.413143 12694 net.cpp:148] Top shape: 1 1 500 (500)
I0925 21:56:53.413154 12694 net.cpp:156] Memory required for data: 20404
I0925 21:56:53.413156 12690 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0925 21:56:53.413167 12694 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0925 21:56:53.413192 12690 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0925 21:56:53.413198 12694 net.cpp:91] Creating Layer reshape_stage_indicator
I0925 21:56:53.413210 12694 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0925 21:56:53.413228 12694 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0925 21:56:53.413285 12690 net.cpp:141] Setting up reshape_stage_indicator
I0925 21:56:53.413298 12690 net.cpp:148] Top shape: 1 1 1 (1)
I0925 21:56:53.413303 12690 net.cpp:156] Memory required for data: 20408
I0925 21:56:53.413310 12690 layer_factory.hpp:77] Creating layer embedding
I0925 21:56:53.413326 12690 net.cpp:91] Creating Layer embedding
I0925 21:56:53.413331 12690 net.cpp:425] embedding <- input_sentence
I0925 21:56:53.413341 12690 net.cpp:399] embedding -> embedded_input_sentence
I0925 21:56:53.413363 12694 net.cpp:141] Setting up reshape_stage_indicator
I0925 21:56:53.413383 12694 net.cpp:148] Top shape: 1 1 1 (1)
I0925 21:56:53.413390 12694 net.cpp:156] Memory required for data: 20408
I0925 21:56:53.413400 12694 layer_factory.hpp:77] Creating layer embedding
I0925 21:56:53.413437 12694 net.cpp:91] Creating Layer embedding
I0925 21:56:53.413450 12694 net.cpp:425] embedding <- input_sentence
I0925 21:56:53.413465 12694 net.cpp:399] embedding -> embedded_input_sentence
I0925 21:56:53.516204 12712 net.cpp:141] Setting up embedding
I0925 21:56:53.516273 12712 net.cpp:148] Top shape: 1 1 500 (500)
I0925 21:56:53.516286 12712 net.cpp:156] Memory required for data: 22408
I0925 21:56:53.516320 12712 layer_factory.hpp:77] Creating layer lstm1
I0925 21:56:53.516357 12712 net.cpp:91] Creating Layer lstm1
I0925 21:56:53.516378 12712 net.cpp:425] lstm1 <- embedded_input_frames
I0925 21:56:53.516399 12712 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0925 21:56:53.516424 12712 net.cpp:399] lstm1 -> lstm1
I0925 21:56:53.516499 12712 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 21:56:53.517051 12712 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 21:56:53.517200 12712 layer_factory.hpp:77] Creating layer lstm1_
I0925 21:56:53.517220 12712 net.cpp:91] Creating Layer lstm1_
I0925 21:56:53.517231 12712 net.cpp:399] lstm1_ -> x
I0925 21:56:53.517251 12712 net.cpp:399] lstm1_ -> cont
I0925 21:56:53.529372 12712 net.cpp:141] Setting up lstm1_
I0925 21:56:53.529433 12712 net.cpp:148] Top shape: 1 1 500 (500)
I0925 21:56:53.529448 12712 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.529458 12712 net.cpp:156] Memory required for data: 2004
I0925 21:56:53.529471 12712 layer_factory.hpp:77] Creating layer lstm1_
I0925 21:56:53.529501 12712 net.cpp:91] Creating Layer lstm1_
I0925 21:56:53.529517 12712 net.cpp:399] lstm1_ -> c_0
I0925 21:56:53.529546 12712 net.cpp:399] lstm1_ -> h_0
I0925 21:56:53.529706 12712 net.cpp:141] Setting up lstm1_
I0925 21:56:53.529721 12712 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.529728 12712 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.529733 12712 net.cpp:156] Memory required for data: 10004
I0925 21:56:53.529741 12712 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0925 21:56:53.529752 12712 net.cpp:91] Creating Layer lstm1_cont_slice
I0925 21:56:53.529759 12712 net.cpp:425] lstm1_cont_slice <- cont
I0925 21:56:53.529772 12712 net.cpp:399] lstm1_cont_slice -> cont_1
I0925 21:56:53.533949 12712 net.cpp:141] Setting up lstm1_cont_slice
I0925 21:56:53.533983 12712 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.533989 12712 net.cpp:156] Memory required for data: 10008
I0925 21:56:53.533998 12712 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0925 21:56:53.534013 12712 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0925 21:56:53.534024 12712 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0925 21:56:53.534035 12712 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0925 21:56:53.534052 12712 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0925 21:56:53.534458 12712 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0925 21:56:53.534476 12712 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.534483 12712 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.534489 12712 net.cpp:156] Memory required for data: 10016
I0925 21:56:53.534495 12712 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0925 21:56:53.534518 12712 net.cpp:91] Creating Layer lstm1_x_transform
I0925 21:56:53.534525 12712 net.cpp:425] lstm1_x_transform <- x
I0925 21:56:53.534536 12712 net.cpp:399] lstm1_x_transform -> W_xc_x
I0925 21:56:53.562091 12712 net.cpp:141] Setting up lstm1_x_transform
I0925 21:56:53.562144 12712 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:53.562152 12712 net.cpp:156] Memory required for data: 26016
I0925 21:56:53.562177 12712 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0925 21:56:53.562198 12712 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0925 21:56:53.562206 12712 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0925 21:56:53.562217 12712 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0925 21:56:53.562269 12712 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0925 21:56:53.562281 12712 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:53.562286 12712 net.cpp:156] Memory required for data: 42016
I0925 21:56:53.562292 12712 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0925 21:56:53.562314 12712 net.cpp:91] Creating Layer lstm1_h_conted_0
I0925 21:56:53.562320 12712 net.cpp:425] lstm1_h_conted_0 <- h_0
I0925 21:56:53.562328 12712 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0925 21:56:53.562338 12712 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0925 21:56:53.562463 12712 net.cpp:141] Setting up lstm1_h_conted_0
I0925 21:56:53.562474 12712 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.562479 12712 net.cpp:156] Memory required for data: 46016
I0925 21:56:53.562486 12712 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0925 21:56:53.562501 12712 net.cpp:91] Creating Layer lstm1_transform_1
I0925 21:56:53.562507 12712 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0925 21:56:53.562517 12712 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0925 21:56:53.571259 12700 net.cpp:141] Setting up embedding
I0925 21:56:53.571321 12700 net.cpp:148] Top shape: 1 1 500 (500)
I0925 21:56:53.571333 12700 net.cpp:156] Memory required for data: 22408
I0925 21:56:53.571357 12700 layer_factory.hpp:77] Creating layer lstm1
I0925 21:56:53.571401 12700 net.cpp:91] Creating Layer lstm1
I0925 21:56:53.571414 12700 net.cpp:425] lstm1 <- embedded_input_frames
I0925 21:56:53.571424 12700 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0925 21:56:53.571442 12700 net.cpp:399] lstm1 -> lstm1
I0925 21:56:53.571468 12700 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 21:56:53.571873 12700 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 21:56:53.572002 12700 layer_factory.hpp:77] Creating layer lstm1_
I0925 21:56:53.572019 12700 net.cpp:91] Creating Layer lstm1_
I0925 21:56:53.572026 12700 net.cpp:399] lstm1_ -> x
I0925 21:56:53.572046 12700 net.cpp:399] lstm1_ -> cont
I0925 21:56:53.572194 12700 net.cpp:141] Setting up lstm1_
I0925 21:56:53.572209 12700 net.cpp:148] Top shape: 1 1 500 (500)
I0925 21:56:53.572222 12700 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.572232 12700 net.cpp:156] Memory required for data: 2004
I0925 21:56:53.572238 12700 layer_factory.hpp:77] Creating layer lstm1_
I0925 21:56:53.572324 12700 net.cpp:91] Creating Layer lstm1_
I0925 21:56:53.572343 12700 net.cpp:399] lstm1_ -> c_0
I0925 21:56:53.572361 12700 net.cpp:399] lstm1_ -> h_0
I0925 21:56:53.574781 12700 net.cpp:141] Setting up lstm1_
I0925 21:56:53.574846 12700 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.574862 12700 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.574870 12700 net.cpp:156] Memory required for data: 10004
I0925 21:56:53.574882 12700 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0925 21:56:53.574903 12700 net.cpp:91] Creating Layer lstm1_cont_slice
I0925 21:56:53.574916 12700 net.cpp:425] lstm1_cont_slice <- cont
I0925 21:56:53.574934 12700 net.cpp:399] lstm1_cont_slice -> cont_1
I0925 21:56:53.579262 12700 net.cpp:141] Setting up lstm1_cont_slice
I0925 21:56:53.579313 12700 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.579326 12700 net.cpp:156] Memory required for data: 10008
I0925 21:56:53.579340 12700 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0925 21:56:53.579363 12700 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0925 21:56:53.579378 12700 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0925 21:56:53.579402 12700 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0925 21:56:53.579426 12700 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0925 21:56:53.585633 12700 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0925 21:56:53.585690 12700 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.585705 12700 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.585716 12700 net.cpp:156] Memory required for data: 10016
I0925 21:56:53.585731 12700 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0925 21:56:53.585762 12700 net.cpp:91] Creating Layer lstm1_x_transform
I0925 21:56:53.585775 12700 net.cpp:425] lstm1_x_transform <- x
I0925 21:56:53.585803 12700 net.cpp:399] lstm1_x_transform -> W_xc_x
I0925 21:56:53.612385 12712 net.cpp:141] Setting up lstm1_transform_1
I0925 21:56:53.612433 12712 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:53.612442 12712 net.cpp:156] Memory required for data: 62016
I0925 21:56:53.612462 12712 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0925 21:56:53.612496 12712 net.cpp:91] Creating Layer lstm1_gate_input_1
I0925 21:56:53.612504 12712 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0925 21:56:53.612514 12712 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0925 21:56:53.612522 12712 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0925 21:56:53.616816 12712 net.cpp:141] Setting up lstm1_gate_input_1
I0925 21:56:53.616858 12712 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:53.616864 12712 net.cpp:156] Memory required for data: 78016
I0925 21:56:53.616873 12712 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0925 21:56:53.616901 12712 net.cpp:91] Creating Layer lstm1_unit_1
I0925 21:56:53.616909 12712 net.cpp:425] lstm1_unit_1 <- c_0
I0925 21:56:53.616919 12712 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0925 21:56:53.616931 12712 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0925 21:56:53.616941 12712 net.cpp:399] lstm1_unit_1 -> c_1
I0925 21:56:53.616953 12712 net.cpp:399] lstm1_unit_1 -> h_1
I0925 21:56:53.617144 12712 net.cpp:141] Setting up lstm1_unit_1
I0925 21:56:53.617156 12712 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.617163 12712 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.617168 12712 net.cpp:156] Memory required for data: 86016
I0925 21:56:53.617174 12712 layer_factory.hpp:77] Creating layer lstm1_
I0925 21:56:53.617184 12712 net.cpp:91] Creating Layer lstm1_
I0925 21:56:53.617190 12712 net.cpp:425] lstm1_ <- c_1
I0925 21:56:53.617198 12712 net.cpp:399] lstm1_ -> c_T
I0925 21:56:53.632201 12712 net.cpp:141] Setting up lstm1_
I0925 21:56:53.632256 12712 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.632263 12712 net.cpp:156] Memory required for data: 90016
I0925 21:56:53.632273 12712 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0925 21:56:53.632292 12712 net.cpp:91] Creating Layer lstm1_h_concat
I0925 21:56:53.632299 12712 net.cpp:425] lstm1_h_concat <- h_1
I0925 21:56:53.632313 12712 net.cpp:399] lstm1_h_concat -> h
I0925 21:56:53.632426 12700 net.cpp:141] Setting up lstm1_x_transform
I0925 21:56:53.632450 12700 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:53.632459 12700 net.cpp:156] Memory required for data: 26016
I0925 21:56:53.632479 12712 net.cpp:141] Setting up lstm1_h_concat
I0925 21:56:53.632483 12700 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0925 21:56:53.632515 12712 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.632524 12712 net.cpp:156] Memory required for data: 94016
I0925 21:56:53.632525 12700 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0925 21:56:53.632534 12712 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 21:56:53.632537 12700 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0925 21:56:53.632552 12700 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0925 21:56:53.632561 12712 net.cpp:91] Creating Layer h_pseudoloss
I0925 21:56:53.632570 12712 net.cpp:425] h_pseudoloss <- h
I0925 21:56:53.632583 12712 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 21:56:53.632632 12700 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0925 21:56:53.632649 12700 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:53.632658 12700 net.cpp:156] Memory required for data: 42016
I0925 21:56:53.632666 12700 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0925 21:56:53.632683 12700 net.cpp:91] Creating Layer lstm1_h_conted_0
I0925 21:56:53.632693 12700 net.cpp:425] lstm1_h_conted_0 <- h_0
I0925 21:56:53.632704 12700 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0925 21:56:53.632716 12700 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0925 21:56:53.632767 12712 net.cpp:141] Setting up h_pseudoloss
I0925 21:56:53.632793 12712 net.cpp:148] Top shape: (1)
I0925 21:56:53.632803 12712 net.cpp:151]     with loss weight 1
I0925 21:56:53.632866 12712 net.cpp:156] Memory required for data: 94020
I0925 21:56:53.632879 12712 net.cpp:217] h_pseudoloss needs backward computation.
I0925 21:56:53.632889 12712 net.cpp:217] lstm1_h_concat needs backward computation.
I0925 21:56:53.632897 12712 net.cpp:219] lstm1_ does not need backward computation.
I0925 21:56:53.632907 12712 net.cpp:217] lstm1_unit_1 needs backward computation.
I0925 21:56:53.632920 12712 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0925 21:56:53.632930 12712 net.cpp:217] lstm1_transform_1 needs backward computation.
I0925 21:56:53.632936 12700 net.cpp:141] Setting up lstm1_h_conted_0
I0925 21:56:53.632942 12712 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0925 21:56:53.632956 12700 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.632956 12712 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0925 21:56:53.632972 12700 net.cpp:156] Memory required for data: 46016
I0925 21:56:53.632982 12712 net.cpp:217] lstm1_x_transform needs backward computation.
I0925 21:56:53.632983 12700 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0925 21:56:53.633009 12712 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0925 21:56:53.633018 12700 net.cpp:91] Creating Layer lstm1_transform_1
I0925 21:56:53.633023 12712 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0925 21:56:53.633028 12700 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0925 21:56:53.633035 12712 net.cpp:219] lstm1_ does not need backward computation.
I0925 21:56:53.633045 12712 net.cpp:219] lstm1_ does not need backward computation.
I0925 21:56:53.633051 12700 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0925 21:56:53.633054 12712 net.cpp:261] This network produces output c_T
I0925 21:56:53.633080 12712 net.cpp:261] This network produces output h_pseudoloss
I0925 21:56:53.633121 12712 net.cpp:274] Network initialization done.
I0925 21:56:53.633265 12712 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 21:56:53.633280 12712 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 21:56:53.633291 12712 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 21:56:53.643262 12712 net.cpp:141] Setting up lstm1
I0925 21:56:53.643319 12712 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.643329 12712 net.cpp:156] Memory required for data: 26408
I0925 21:56:53.643354 12712 layer_factory.hpp:77] Creating layer concat
I0925 21:56:53.643378 12712 net.cpp:91] Creating Layer concat
I0925 21:56:53.643391 12712 net.cpp:425] concat <- lstm1
I0925 21:56:53.643401 12712 net.cpp:425] concat <- embedded_input_sentence
I0925 21:56:53.643409 12712 net.cpp:425] concat <- reshaped_stage_indicator
I0925 21:56:53.643417 12712 net.cpp:399] concat -> lstm1_video_sequence
I0925 21:56:53.643477 12712 net.cpp:141] Setting up concat
I0925 21:56:53.643496 12712 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 21:56:53.643504 12712 net.cpp:156] Memory required for data: 32412
I0925 21:56:53.643512 12712 layer_factory.hpp:77] Creating layer lstm2
I0925 21:56:53.643528 12712 net.cpp:91] Creating Layer lstm2
I0925 21:56:53.643534 12712 net.cpp:425] lstm2 <- lstm1_video_sequence
I0925 21:56:53.643542 12712 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0925 21:56:53.643555 12712 net.cpp:399] lstm2 -> lstm2
I0925 21:56:53.643573 12712 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 21:56:53.644011 12712 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 21:56:53.644161 12712 layer_factory.hpp:77] Creating layer lstm2_
I0925 21:56:53.644181 12712 net.cpp:91] Creating Layer lstm2_
I0925 21:56:53.644188 12712 net.cpp:399] lstm2_ -> x
I0925 21:56:53.644202 12712 net.cpp:399] lstm2_ -> cont
I0925 21:56:53.649011 12712 net.cpp:141] Setting up lstm2_
I0925 21:56:53.649070 12712 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 21:56:53.649085 12712 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.649094 12712 net.cpp:156] Memory required for data: 6008
I0925 21:56:53.649109 12712 layer_factory.hpp:77] Creating layer lstm2_
I0925 21:56:53.649153 12712 net.cpp:91] Creating Layer lstm2_
I0925 21:56:53.649171 12712 net.cpp:399] lstm2_ -> c_0
I0925 21:56:53.649200 12712 net.cpp:399] lstm2_ -> h_0
I0925 21:56:53.665848 12712 net.cpp:141] Setting up lstm2_
I0925 21:56:53.665875 12718 net.cpp:141] Setting up embedding
I0925 21:56:53.665916 12712 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.665922 12718 net.cpp:148] Top shape: 1 1 500 (500)
I0925 21:56:53.665925 12712 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.665940 12718 net.cpp:156] Memory required for data: 22408
I0925 21:56:53.665944 12712 net.cpp:156] Memory required for data: 14008
I0925 21:56:53.665962 12712 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0925 21:56:53.665973 12718 layer_factory.hpp:77] Creating layer lstm1
I0925 21:56:53.665984 12712 net.cpp:91] Creating Layer lstm2_cont_slice
I0925 21:56:53.665992 12712 net.cpp:425] lstm2_cont_slice <- cont
I0925 21:56:53.666003 12712 net.cpp:399] lstm2_cont_slice -> cont_1
I0925 21:56:53.666066 12718 net.cpp:91] Creating Layer lstm1
I0925 21:56:53.666102 12718 net.cpp:425] lstm1 <- embedded_input_frames
I0925 21:56:53.666118 12718 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0925 21:56:53.666141 12718 net.cpp:399] lstm1 -> lstm1
I0925 21:56:53.666168 12718 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 21:56:53.666710 12718 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 21:56:53.666865 12718 layer_factory.hpp:77] Creating layer lstm1_
I0925 21:56:53.666887 12718 net.cpp:91] Creating Layer lstm1_
I0925 21:56:53.666899 12718 net.cpp:399] lstm1_ -> x
I0925 21:56:53.666920 12718 net.cpp:399] lstm1_ -> cont
I0925 21:56:53.668165 12712 net.cpp:141] Setting up lstm2_cont_slice
I0925 21:56:53.668186 12712 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.668192 12712 net.cpp:156] Memory required for data: 14012
I0925 21:56:53.668200 12712 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0925 21:56:53.668210 12712 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0925 21:56:53.668215 12712 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0925 21:56:53.668227 12712 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0925 21:56:53.668238 12712 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0925 21:56:53.669368 12718 net.cpp:141] Setting up lstm1_
I0925 21:56:53.669389 12718 net.cpp:148] Top shape: 1 1 500 (500)
I0925 21:56:53.669401 12718 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.669409 12718 net.cpp:156] Memory required for data: 2004
I0925 21:56:53.669419 12718 layer_factory.hpp:77] Creating layer lstm1_
I0925 21:56:53.669440 12718 net.cpp:91] Creating Layer lstm1_
I0925 21:56:53.669452 12718 net.cpp:399] lstm1_ -> c_0
I0925 21:56:53.669471 12718 net.cpp:399] lstm1_ -> h_0
I0925 21:56:53.669469 12712 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0925 21:56:53.669507 12712 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.669515 12712 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.669520 12712 net.cpp:156] Memory required for data: 14020
I0925 21:56:53.669526 12712 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0925 21:56:53.669543 12712 net.cpp:91] Creating Layer lstm2_x_transform
I0925 21:56:53.669549 12712 net.cpp:425] lstm2_x_transform <- x
I0925 21:56:53.669570 12712 net.cpp:399] lstm2_x_transform -> W_xc_x
I0925 21:56:53.694932 12718 net.cpp:141] Setting up lstm1_
I0925 21:56:53.694970 12700 net.cpp:141] Setting up lstm1_transform_1
I0925 21:56:53.695013 12700 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:53.695013 12718 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.695030 12700 net.cpp:156] Memory required for data: 62016
I0925 21:56:53.695039 12718 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.695046 12718 net.cpp:156] Memory required for data: 10004
I0925 21:56:53.695058 12700 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0925 21:56:53.695057 12718 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0925 21:56:53.695086 12718 net.cpp:91] Creating Layer lstm1_cont_slice
I0925 21:56:53.695086 12700 net.cpp:91] Creating Layer lstm1_gate_input_1
I0925 21:56:53.695107 12718 net.cpp:425] lstm1_cont_slice <- cont
I0925 21:56:53.695109 12700 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0925 21:56:53.695121 12700 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0925 21:56:53.695129 12718 net.cpp:399] lstm1_cont_slice -> cont_1
I0925 21:56:53.695142 12700 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0925 21:56:53.695353 12700 net.cpp:141] Setting up lstm1_gate_input_1
I0925 21:56:53.695371 12700 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:53.695380 12700 net.cpp:156] Memory required for data: 78016
I0925 21:56:53.695389 12700 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0925 21:56:53.695392 12718 net.cpp:141] Setting up lstm1_cont_slice
I0925 21:56:53.695405 12700 net.cpp:91] Creating Layer lstm1_unit_1
I0925 21:56:53.695407 12718 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.695421 12700 net.cpp:425] lstm1_unit_1 <- c_0
I0925 21:56:53.695425 12718 net.cpp:156] Memory required for data: 10008
I0925 21:56:53.695433 12700 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0925 21:56:53.695433 12718 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0925 21:56:53.695447 12700 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0925 21:56:53.695453 12718 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0925 21:56:53.695461 12700 net.cpp:399] lstm1_unit_1 -> c_1
I0925 21:56:53.695462 12718 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0925 21:56:53.695482 12718 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0925 21:56:53.695488 12700 net.cpp:399] lstm1_unit_1 -> h_1
I0925 21:56:53.695498 12718 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0925 21:56:53.695963 12700 net.cpp:141] Setting up lstm1_unit_1
I0925 21:56:53.695984 12700 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.695991 12700 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.695997 12700 net.cpp:156] Memory required for data: 86016
I0925 21:56:53.696003 12700 layer_factory.hpp:77] Creating layer lstm1_
I0925 21:56:53.696012 12700 net.cpp:91] Creating Layer lstm1_
I0925 21:56:53.696018 12700 net.cpp:425] lstm1_ <- c_1
I0925 21:56:53.696027 12700 net.cpp:399] lstm1_ -> c_T
I0925 21:56:53.697439 12718 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0925 21:56:53.697496 12718 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.697510 12718 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.697518 12718 net.cpp:156] Memory required for data: 10016
I0925 21:56:53.697531 12718 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0925 21:56:53.697569 12718 net.cpp:91] Creating Layer lstm1_x_transform
I0925 21:56:53.697582 12718 net.cpp:425] lstm1_x_transform <- x
I0925 21:56:53.697602 12718 net.cpp:399] lstm1_x_transform -> W_xc_x
I0925 21:56:53.708751 12690 net.cpp:141] Setting up embedding
I0925 21:56:53.708775 12700 net.cpp:141] Setting up lstm1_
I0925 21:56:53.708824 12690 net.cpp:148] Top shape: 1 1 500 (500)
I0925 21:56:53.708832 12700 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.708837 12690 net.cpp:156] Memory required for data: 22408
I0925 21:56:53.708842 12700 net.cpp:156] Memory required for data: 90016
I0925 21:56:53.708861 12700 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0925 21:56:53.708873 12690 layer_factory.hpp:77] Creating layer lstm1
I0925 21:56:53.708881 12700 net.cpp:91] Creating Layer lstm1_h_concat
I0925 21:56:53.708889 12700 net.cpp:425] lstm1_h_concat <- h_1
I0925 21:56:53.708901 12690 net.cpp:91] Creating Layer lstm1
I0925 21:56:53.708909 12700 net.cpp:399] lstm1_h_concat -> h
I0925 21:56:53.708914 12690 net.cpp:425] lstm1 <- embedded_input_frames
I0925 21:56:53.708927 12690 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0925 21:56:53.708947 12690 net.cpp:399] lstm1 -> lstm1
I0925 21:56:53.708976 12690 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 21:56:53.709463 12690 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 21:56:53.709617 12690 layer_factory.hpp:77] Creating layer lstm1_
I0925 21:56:53.709637 12690 net.cpp:91] Creating Layer lstm1_
I0925 21:56:53.709650 12690 net.cpp:399] lstm1_ -> x
I0925 21:56:53.709668 12690 net.cpp:399] lstm1_ -> cont
I0925 21:56:53.712306 12700 net.cpp:141] Setting up lstm1_h_concat
I0925 21:56:53.712329 12700 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.712335 12700 net.cpp:156] Memory required for data: 94016
I0925 21:56:53.712342 12700 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 21:56:53.712363 12700 net.cpp:91] Creating Layer h_pseudoloss
I0925 21:56:53.712369 12700 net.cpp:425] h_pseudoloss <- h
I0925 21:56:53.712378 12700 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 21:56:53.712513 12700 net.cpp:141] Setting up h_pseudoloss
I0925 21:56:53.712525 12700 net.cpp:148] Top shape: (1)
I0925 21:56:53.712532 12700 net.cpp:151]     with loss weight 1
I0925 21:56:53.712548 12700 net.cpp:156] Memory required for data: 94020
I0925 21:56:53.712553 12700 net.cpp:217] h_pseudoloss needs backward computation.
I0925 21:56:53.712558 12700 net.cpp:217] lstm1_h_concat needs backward computation.
I0925 21:56:53.712564 12700 net.cpp:219] lstm1_ does not need backward computation.
I0925 21:56:53.712570 12700 net.cpp:217] lstm1_unit_1 needs backward computation.
I0925 21:56:53.712577 12700 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0925 21:56:53.712574 12690 net.cpp:141] Setting up lstm1_
I0925 21:56:53.712584 12700 net.cpp:217] lstm1_transform_1 needs backward computation.
I0925 21:56:53.712606 12700 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0925 21:56:53.712605 12690 net.cpp:148] Top shape: 1 1 500 (500)
I0925 21:56:53.712616 12700 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0925 21:56:53.712623 12700 net.cpp:217] lstm1_x_transform needs backward computation.
I0925 21:56:53.712623 12690 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.712632 12700 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0925 21:56:53.712635 12690 net.cpp:156] Memory required for data: 2004
I0925 21:56:53.712640 12700 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0925 21:56:53.712647 12700 net.cpp:219] lstm1_ does not need backward computation.
I0925 21:56:53.712667 12700 net.cpp:219] lstm1_ does not need backward computation.
I0925 21:56:53.712646 12690 layer_factory.hpp:77] Creating layer lstm1_
I0925 21:56:53.712672 12700 net.cpp:261] This network produces output c_T
I0925 21:56:53.712692 12700 net.cpp:261] This network produces output h_pseudoloss
I0925 21:56:53.712692 12690 net.cpp:91] Creating Layer lstm1_
I0925 21:56:53.712713 12690 net.cpp:399] lstm1_ -> c_0
I0925 21:56:53.712716 12700 net.cpp:274] Network initialization done.
I0925 21:56:53.712731 12690 net.cpp:399] lstm1_ -> h_0
I0925 21:56:53.712772 12700 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 21:56:53.712779 12700 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 21:56:53.712785 12700 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 21:56:53.713995 12690 net.cpp:141] Setting up lstm1_
I0925 21:56:53.714015 12690 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.714025 12690 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.714033 12690 net.cpp:156] Memory required for data: 10004
I0925 21:56:53.714042 12690 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0925 21:56:53.714062 12690 net.cpp:91] Creating Layer lstm1_cont_slice
I0925 21:56:53.714072 12690 net.cpp:425] lstm1_cont_slice <- cont
I0925 21:56:53.714085 12690 net.cpp:399] lstm1_cont_slice -> cont_1
I0925 21:56:53.721710 12700 net.cpp:141] Setting up lstm1
I0925 21:56:53.721755 12700 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.721762 12700 net.cpp:156] Memory required for data: 26408
I0925 21:56:53.721784 12700 layer_factory.hpp:77] Creating layer concat
I0925 21:56:53.721803 12700 net.cpp:91] Creating Layer concat
I0925 21:56:53.721812 12700 net.cpp:425] concat <- lstm1
I0925 21:56:53.721803 12690 net.cpp:141] Setting up lstm1_cont_slice
I0925 21:56:53.721822 12700 net.cpp:425] concat <- embedded_input_sentence
I0925 21:56:53.721853 12700 net.cpp:425] concat <- reshaped_stage_indicator
I0925 21:56:53.721854 12690 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.721865 12700 net.cpp:399] concat -> lstm1_video_sequence
I0925 21:56:53.721866 12690 net.cpp:156] Memory required for data: 10008
I0925 21:56:53.721904 12690 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0925 21:56:53.721927 12690 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0925 21:56:53.721938 12690 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0925 21:56:53.721961 12690 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0925 21:56:53.721982 12690 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0925 21:56:53.727712 12700 net.cpp:141] Setting up concat
I0925 21:56:53.727764 12700 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 21:56:53.727774 12700 net.cpp:156] Memory required for data: 32412
I0925 21:56:53.727787 12700 layer_factory.hpp:77] Creating layer lstm2
I0925 21:56:53.727818 12700 net.cpp:91] Creating Layer lstm2
I0925 21:56:53.727831 12700 net.cpp:425] lstm2 <- lstm1_video_sequence
I0925 21:56:53.727844 12700 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0925 21:56:53.727860 12700 net.cpp:399] lstm2 -> lstm2
I0925 21:56:53.727886 12700 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 21:56:53.727893 12690 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0925 21:56:53.727939 12690 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.727953 12690 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.727963 12690 net.cpp:156] Memory required for data: 10016
I0925 21:56:53.727984 12690 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0925 21:56:53.728020 12690 net.cpp:91] Creating Layer lstm1_x_transform
I0925 21:56:53.728032 12690 net.cpp:425] lstm1_x_transform <- x
I0925 21:56:53.728055 12690 net.cpp:399] lstm1_x_transform -> W_xc_x
I0925 21:56:53.728441 12700 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 21:56:53.728621 12700 layer_factory.hpp:77] Creating layer lstm2_
I0925 21:56:53.728644 12700 net.cpp:91] Creating Layer lstm2_
I0925 21:56:53.728657 12700 net.cpp:399] lstm2_ -> x
I0925 21:56:53.728677 12700 net.cpp:399] lstm2_ -> cont
I0925 21:56:53.741377 12700 net.cpp:141] Setting up lstm2_
I0925 21:56:53.741431 12700 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 21:56:53.741446 12700 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.741454 12700 net.cpp:156] Memory required for data: 6008
I0925 21:56:53.741468 12700 layer_factory.hpp:77] Creating layer lstm2_
I0925 21:56:53.741499 12700 net.cpp:91] Creating Layer lstm2_
I0925 21:56:53.741530 12700 net.cpp:399] lstm2_ -> c_0
I0925 21:56:53.741559 12700 net.cpp:399] lstm2_ -> h_0
I0925 21:56:53.750377 12718 net.cpp:141] Setting up lstm1_x_transform
I0925 21:56:53.750406 12700 net.cpp:141] Setting up lstm2_
I0925 21:56:53.750428 12718 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:53.750432 12700 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.750442 12718 net.cpp:156] Memory required for data: 26016
I0925 21:56:53.750448 12700 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.750458 12700 net.cpp:156] Memory required for data: 14008
I0925 21:56:53.750468 12700 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0925 21:56:53.750474 12718 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0925 21:56:53.750494 12718 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0925 21:56:53.750507 12718 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0925 21:56:53.750505 12700 net.cpp:91] Creating Layer lstm2_cont_slice
I0925 21:56:53.750535 12700 net.cpp:425] lstm2_cont_slice <- cont
I0925 21:56:53.750536 12712 net.cpp:141] Setting up lstm2_x_transform
I0925 21:56:53.750538 12718 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0925 21:56:53.750561 12712 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:53.750552 12700 net.cpp:399] lstm2_cont_slice -> cont_1
I0925 21:56:53.750576 12712 net.cpp:156] Memory required for data: 30020
I0925 21:56:53.750605 12712 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0925 21:56:53.750622 12712 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0925 21:56:53.750629 12712 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0925 21:56:53.750638 12712 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0925 21:56:53.750653 12718 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0925 21:56:53.750674 12718 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:53.750684 12718 net.cpp:156] Memory required for data: 42016
I0925 21:56:53.750694 12718 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0925 21:56:53.750704 12712 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0925 21:56:53.750712 12718 net.cpp:91] Creating Layer lstm1_h_conted_0
I0925 21:56:53.750721 12712 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:53.750725 12718 net.cpp:425] lstm1_h_conted_0 <- h_0
I0925 21:56:53.750732 12712 net.cpp:156] Memory required for data: 46020
I0925 21:56:53.750738 12718 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0925 21:56:53.750742 12712 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0925 21:56:53.750746 12700 net.cpp:141] Setting up lstm2_cont_slice
I0925 21:56:53.750758 12712 net.cpp:91] Creating Layer lstm2_h_conted_0
I0925 21:56:53.750761 12718 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0925 21:56:53.750759 12700 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.750774 12712 net.cpp:425] lstm2_h_conted_0 <- h_0
I0925 21:56:53.750777 12700 net.cpp:156] Memory required for data: 14012
I0925 21:56:53.750787 12700 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0925 21:56:53.750787 12712 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0925 21:56:53.750805 12700 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0925 21:56:53.750810 12712 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0925 21:56:53.750816 12700 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0925 21:56:53.750835 12700 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0925 21:56:53.750854 12700 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0925 21:56:53.750928 12700 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0925 21:56:53.750944 12700 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.750957 12700 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.750964 12700 net.cpp:156] Memory required for data: 14020
I0925 21:56:53.750975 12700 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0925 21:56:53.751003 12700 net.cpp:91] Creating Layer lstm2_x_transform
I0925 21:56:53.751010 12700 net.cpp:425] lstm2_x_transform <- x
I0925 21:56:53.751020 12700 net.cpp:399] lstm2_x_transform -> W_xc_x
I0925 21:56:53.751201 12694 net.cpp:141] Setting up embedding
I0925 21:56:53.751220 12694 net.cpp:148] Top shape: 1 1 500 (500)
I0925 21:56:53.751227 12694 net.cpp:156] Memory required for data: 22408
I0925 21:56:53.751240 12694 layer_factory.hpp:77] Creating layer lstm1
I0925 21:56:53.751255 12694 net.cpp:91] Creating Layer lstm1
I0925 21:56:53.751261 12694 net.cpp:425] lstm1 <- embedded_input_frames
I0925 21:56:53.751268 12694 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0925 21:56:53.751273 12718 net.cpp:141] Setting up lstm1_h_conted_0
I0925 21:56:53.751298 12718 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.751305 12694 net.cpp:399] lstm1 -> lstm1
I0925 21:56:53.751308 12718 net.cpp:156] Memory required for data: 46016
I0925 21:56:53.751322 12694 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 21:56:53.751322 12718 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0925 21:56:53.751348 12718 net.cpp:91] Creating Layer lstm1_transform_1
I0925 21:56:53.751359 12718 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0925 21:56:53.751380 12718 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0925 21:56:53.751690 12694 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 21:56:53.751796 12694 layer_factory.hpp:77] Creating layer lstm1_
I0925 21:56:53.751808 12694 net.cpp:91] Creating Layer lstm1_
I0925 21:56:53.751816 12694 net.cpp:399] lstm1_ -> x
I0925 21:56:53.751828 12694 net.cpp:399] lstm1_ -> cont
I0925 21:56:53.763921 12712 net.cpp:141] Setting up lstm2_h_conted_0
I0925 21:56:53.763969 12712 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.763980 12712 net.cpp:156] Memory required for data: 50020
I0925 21:56:53.763994 12712 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0925 21:56:53.764021 12712 net.cpp:91] Creating Layer lstm2_transform_1
I0925 21:56:53.764034 12712 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0925 21:56:53.764086 12712 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0925 21:56:53.776374 12694 net.cpp:141] Setting up lstm1_
I0925 21:56:53.776425 12694 net.cpp:148] Top shape: 1 1 500 (500)
I0925 21:56:53.776434 12694 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.776439 12694 net.cpp:156] Memory required for data: 2004
I0925 21:56:53.776450 12694 layer_factory.hpp:77] Creating layer lstm1_
I0925 21:56:53.776473 12694 net.cpp:91] Creating Layer lstm1_
I0925 21:56:53.776485 12694 net.cpp:399] lstm1_ -> c_0
I0925 21:56:53.776506 12694 net.cpp:399] lstm1_ -> h_0
I0925 21:56:53.776623 12694 net.cpp:141] Setting up lstm1_
I0925 21:56:53.776636 12694 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.776643 12694 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.776648 12694 net.cpp:156] Memory required for data: 10004
I0925 21:56:53.776654 12694 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0925 21:56:53.776666 12694 net.cpp:91] Creating Layer lstm1_cont_slice
I0925 21:56:53.776671 12694 net.cpp:425] lstm1_cont_slice <- cont
I0925 21:56:53.776680 12694 net.cpp:399] lstm1_cont_slice -> cont_1
I0925 21:56:53.793870 12690 net.cpp:141] Setting up lstm1_x_transform
I0925 21:56:53.793932 12690 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:53.793943 12690 net.cpp:156] Memory required for data: 26016
I0925 21:56:53.793983 12690 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0925 21:56:53.793979 12694 net.cpp:141] Setting up lstm1_cont_slice
I0925 21:56:53.794009 12690 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0925 21:56:53.794018 12690 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0925 21:56:53.794021 12694 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.794029 12690 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0925 21:56:53.794050 12694 net.cpp:156] Memory required for data: 10008
I0925 21:56:53.794070 12694 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0925 21:56:53.794106 12694 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0925 21:56:53.794126 12694 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0925 21:56:53.794149 12694 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0925 21:56:53.794178 12694 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0925 21:56:53.797307 12690 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0925 21:56:53.797355 12690 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:53.797363 12690 net.cpp:156] Memory required for data: 42016
I0925 21:56:53.797372 12690 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0925 21:56:53.797391 12694 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0925 21:56:53.797399 12690 net.cpp:91] Creating Layer lstm1_h_conted_0
I0925 21:56:53.797410 12690 net.cpp:425] lstm1_h_conted_0 <- h_0
I0925 21:56:53.797412 12694 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.797420 12690 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0925 21:56:53.797423 12694 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.797430 12690 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0925 21:56:53.797431 12694 net.cpp:156] Memory required for data: 10016
I0925 21:56:53.797441 12694 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0925 21:56:53.797469 12694 net.cpp:91] Creating Layer lstm1_x_transform
I0925 21:56:53.797479 12694 net.cpp:425] lstm1_x_transform <- x
I0925 21:56:53.797493 12694 net.cpp:399] lstm1_x_transform -> W_xc_x
I0925 21:56:53.806874 12690 net.cpp:141] Setting up lstm1_h_conted_0
I0925 21:56:53.806931 12690 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.806938 12690 net.cpp:156] Memory required for data: 46016
I0925 21:56:53.806947 12690 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0925 21:56:53.806972 12690 net.cpp:91] Creating Layer lstm1_transform_1
I0925 21:56:53.806965 12718 net.cpp:141] Setting up lstm1_transform_1
I0925 21:56:53.806980 12690 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0925 21:56:53.806993 12718 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:53.806995 12690 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0925 21:56:53.807001 12718 net.cpp:156] Memory required for data: 62016
I0925 21:56:53.807026 12718 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0925 21:56:53.807054 12718 net.cpp:91] Creating Layer lstm1_gate_input_1
I0925 21:56:53.807065 12718 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0925 21:56:53.807075 12718 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0925 21:56:53.807092 12718 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0925 21:56:53.809249 12718 net.cpp:141] Setting up lstm1_gate_input_1
I0925 21:56:53.809294 12718 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:53.809305 12718 net.cpp:156] Memory required for data: 78016
I0925 21:56:53.809317 12718 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0925 21:56:53.809346 12718 net.cpp:91] Creating Layer lstm1_unit_1
I0925 21:56:53.809361 12718 net.cpp:425] lstm1_unit_1 <- c_0
I0925 21:56:53.809376 12718 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0925 21:56:53.809387 12718 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0925 21:56:53.809402 12718 net.cpp:399] lstm1_unit_1 -> c_1
I0925 21:56:53.809427 12718 net.cpp:399] lstm1_unit_1 -> h_1
I0925 21:56:53.820605 12718 net.cpp:141] Setting up lstm1_unit_1
I0925 21:56:53.820659 12718 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.820667 12718 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.820673 12718 net.cpp:156] Memory required for data: 86016
I0925 21:56:53.820683 12718 layer_factory.hpp:77] Creating layer lstm1_
I0925 21:56:53.820701 12718 net.cpp:91] Creating Layer lstm1_
I0925 21:56:53.820709 12718 net.cpp:425] lstm1_ <- c_1
I0925 21:56:53.820750 12718 net.cpp:399] lstm1_ -> c_T
I0925 21:56:53.823823 12718 net.cpp:141] Setting up lstm1_
I0925 21:56:53.823873 12718 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.823880 12718 net.cpp:156] Memory required for data: 90016
I0925 21:56:53.823890 12718 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0925 21:56:53.823909 12718 net.cpp:91] Creating Layer lstm1_h_concat
I0925 21:56:53.823916 12718 net.cpp:425] lstm1_h_concat <- h_1
I0925 21:56:53.823928 12718 net.cpp:399] lstm1_h_concat -> h
I0925 21:56:53.832314 12718 net.cpp:141] Setting up lstm1_h_concat
I0925 21:56:53.832365 12718 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.832373 12718 net.cpp:156] Memory required for data: 94016
I0925 21:56:53.832382 12718 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 21:56:53.832401 12718 net.cpp:91] Creating Layer h_pseudoloss
I0925 21:56:53.832409 12718 net.cpp:425] h_pseudoloss <- h
I0925 21:56:53.832422 12718 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 21:56:53.837970 12700 net.cpp:141] Setting up lstm2_x_transform
I0925 21:56:53.838004 12700 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:53.838011 12700 net.cpp:156] Memory required for data: 30020
I0925 21:56:53.838030 12700 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0925 21:56:53.838054 12718 net.cpp:141] Setting up h_pseudoloss
I0925 21:56:53.838059 12700 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0925 21:56:53.838079 12718 net.cpp:148] Top shape: (1)
I0925 21:56:53.838083 12700 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0925 21:56:53.838094 12700 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0925 21:56:53.838085 12718 net.cpp:151]     with loss weight 1
I0925 21:56:53.838105 12718 net.cpp:156] Memory required for data: 94020
I0925 21:56:53.838112 12718 net.cpp:217] h_pseudoloss needs backward computation.
I0925 21:56:53.838119 12718 net.cpp:217] lstm1_h_concat needs backward computation.
I0925 21:56:53.838124 12718 net.cpp:219] lstm1_ does not need backward computation.
I0925 21:56:53.838130 12718 net.cpp:217] lstm1_unit_1 needs backward computation.
I0925 21:56:53.838138 12718 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0925 21:56:53.838145 12718 net.cpp:217] lstm1_transform_1 needs backward computation.
I0925 21:56:53.838147 12694 net.cpp:141] Setting up lstm1_x_transform
I0925 21:56:53.838153 12718 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0925 21:56:53.838174 12718 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0925 21:56:53.838174 12694 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:53.838188 12718 net.cpp:217] lstm1_x_transform needs backward computation.
I0925 21:56:53.838191 12700 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0925 21:56:53.838196 12718 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0925 21:56:53.838203 12700 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:53.838207 12718 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0925 21:56:53.838194 12694 net.cpp:156] Memory required for data: 26016
I0925 21:56:53.838213 12700 net.cpp:156] Memory required for data: 46020
I0925 21:56:53.838214 12718 net.cpp:219] lstm1_ does not need backward computation.
I0925 21:56:53.838223 12700 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0925 21:56:53.838227 12718 net.cpp:219] lstm1_ does not need backward computation.
I0925 21:56:53.838232 12718 net.cpp:261] This network produces output c_T
I0925 21:56:53.838232 12694 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0925 21:56:53.838238 12718 net.cpp:261] This network produces output h_pseudoloss
I0925 21:56:53.838240 12700 net.cpp:91] Creating Layer lstm2_h_conted_0
I0925 21:56:53.838248 12700 net.cpp:425] lstm2_h_conted_0 <- h_0
I0925 21:56:53.838258 12718 net.cpp:274] Network initialization done.
I0925 21:56:53.838261 12700 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0925 21:56:53.838248 12694 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0925 21:56:53.838270 12700 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0925 21:56:53.838274 12694 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0925 21:56:53.838292 12694 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0925 21:56:53.838320 12718 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 21:56:53.838327 12718 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 21:56:53.838333 12718 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 21:56:53.838568 12694 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0925 21:56:53.838585 12694 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:53.838606 12694 net.cpp:156] Memory required for data: 42016
I0925 21:56:53.838616 12694 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0925 21:56:53.838631 12694 net.cpp:91] Creating Layer lstm1_h_conted_0
I0925 21:56:53.838639 12694 net.cpp:425] lstm1_h_conted_0 <- h_0
I0925 21:56:53.838650 12694 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0925 21:56:53.838666 12694 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0925 21:56:53.838735 12700 net.cpp:141] Setting up lstm2_h_conted_0
I0925 21:56:53.838747 12700 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.838753 12700 net.cpp:156] Memory required for data: 50020
I0925 21:56:53.838758 12700 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0925 21:56:53.838775 12700 net.cpp:91] Creating Layer lstm2_transform_1
I0925 21:56:53.838781 12700 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0925 21:56:53.838790 12700 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0925 21:56:53.838816 12718 net.cpp:141] Setting up lstm1
I0925 21:56:53.838832 12718 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.838838 12718 net.cpp:156] Memory required for data: 26408
I0925 21:56:53.838855 12718 layer_factory.hpp:77] Creating layer concat
I0925 21:56:53.838867 12718 net.cpp:91] Creating Layer concat
I0925 21:56:53.838876 12718 net.cpp:425] concat <- lstm1
I0925 21:56:53.838883 12718 net.cpp:425] concat <- embedded_input_sentence
I0925 21:56:53.838889 12718 net.cpp:425] concat <- reshaped_stage_indicator
I0925 21:56:53.838897 12718 net.cpp:399] concat -> lstm1_video_sequence
I0925 21:56:53.850450 12718 net.cpp:141] Setting up concat
I0925 21:56:53.850508 12712 net.cpp:141] Setting up lstm2_transform_1
I0925 21:56:53.850538 12712 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:53.850549 12712 net.cpp:156] Memory required for data: 66020
I0925 21:56:53.850570 12694 net.cpp:141] Setting up lstm1_h_conted_0
I0925 21:56:53.850579 12712 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0925 21:56:53.850612 12694 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.850620 12694 net.cpp:156] Memory required for data: 46016
I0925 21:56:53.850628 12694 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0925 21:56:53.850630 12712 net.cpp:91] Creating Layer lstm2_gate_input_1
I0925 21:56:53.850646 12694 net.cpp:91] Creating Layer lstm1_transform_1
I0925 21:56:53.850646 12712 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0925 21:56:53.850652 12694 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0925 21:56:53.850661 12712 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0925 21:56:53.850668 12694 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0925 21:56:53.850684 12712 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0925 21:56:53.850515 12718 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 21:56:53.850715 12718 net.cpp:156] Memory required for data: 32412
I0925 21:56:53.850728 12718 layer_factory.hpp:77] Creating layer lstm2
I0925 21:56:53.850770 12718 net.cpp:91] Creating Layer lstm2
I0925 21:56:53.850781 12718 net.cpp:425] lstm2 <- lstm1_video_sequence
I0925 21:56:53.850791 12718 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0925 21:56:53.850808 12718 net.cpp:399] lstm2 -> lstm2
I0925 21:56:53.850831 12718 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 21:56:53.850949 12712 net.cpp:141] Setting up lstm2_gate_input_1
I0925 21:56:53.850968 12712 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:53.850976 12712 net.cpp:156] Memory required for data: 82020
I0925 21:56:53.850986 12712 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0925 21:56:53.851001 12712 net.cpp:91] Creating Layer lstm2_unit_1
I0925 21:56:53.851011 12712 net.cpp:425] lstm2_unit_1 <- c_0
I0925 21:56:53.851022 12712 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0925 21:56:53.851032 12712 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0925 21:56:53.851045 12712 net.cpp:399] lstm2_unit_1 -> c_1
I0925 21:56:53.851071 12712 net.cpp:399] lstm2_unit_1 -> h_1
I0925 21:56:53.851306 12718 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 21:56:53.851475 12718 layer_factory.hpp:77] Creating layer lstm2_
I0925 21:56:53.851495 12718 net.cpp:91] Creating Layer lstm2_
I0925 21:56:53.851508 12718 net.cpp:399] lstm2_ -> x
I0925 21:56:53.851531 12718 net.cpp:399] lstm2_ -> cont
I0925 21:56:53.877970 12690 net.cpp:141] Setting up lstm1_transform_1
I0925 21:56:53.878034 12690 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:53.878047 12690 net.cpp:156] Memory required for data: 62016
I0925 21:56:53.878078 12690 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0925 21:56:53.878085 12718 net.cpp:141] Setting up lstm2_
I0925 21:56:53.878103 12718 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 21:56:53.878113 12690 net.cpp:91] Creating Layer lstm1_gate_input_1
I0925 21:56:53.878116 12718 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.878134 12690 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0925 21:56:53.878136 12718 net.cpp:156] Memory required for data: 6008
I0925 21:56:53.878152 12690 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0925 21:56:53.878152 12718 layer_factory.hpp:77] Creating layer lstm2_
I0925 21:56:53.878171 12690 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0925 21:56:53.878190 12718 net.cpp:91] Creating Layer lstm2_
I0925 21:56:53.878203 12718 net.cpp:399] lstm2_ -> c_0
I0925 21:56:53.878221 12712 net.cpp:141] Setting up lstm2_unit_1
I0925 21:56:53.878226 12718 net.cpp:399] lstm2_ -> h_0
I0925 21:56:53.878249 12690 net.cpp:141] Setting up lstm1_gate_input_1
I0925 21:56:53.878252 12712 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.878265 12690 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:53.878269 12712 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.878275 12690 net.cpp:156] Memory required for data: 78016
I0925 21:56:53.878280 12712 net.cpp:156] Memory required for data: 90020
I0925 21:56:53.878285 12690 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0925 21:56:53.878291 12712 layer_factory.hpp:77] Creating layer lstm2_
I0925 21:56:53.878303 12690 net.cpp:91] Creating Layer lstm1_unit_1
I0925 21:56:53.878307 12712 net.cpp:91] Creating Layer lstm2_
I0925 21:56:53.878314 12690 net.cpp:425] lstm1_unit_1 <- c_0
I0925 21:56:53.878319 12712 net.cpp:425] lstm2_ <- c_1
I0925 21:56:53.878325 12690 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0925 21:56:53.878334 12712 net.cpp:399] lstm2_ -> c_T
I0925 21:56:53.878337 12690 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0925 21:56:53.878346 12718 net.cpp:141] Setting up lstm2_
I0925 21:56:53.878352 12690 net.cpp:399] lstm1_unit_1 -> c_1
I0925 21:56:53.878361 12718 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.878370 12690 net.cpp:399] lstm1_unit_1 -> h_1
I0925 21:56:53.878374 12718 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.878381 12718 net.cpp:156] Memory required for data: 14008
I0925 21:56:53.878391 12718 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0925 21:56:53.878408 12718 net.cpp:91] Creating Layer lstm2_cont_slice
I0925 21:56:53.878417 12718 net.cpp:425] lstm2_cont_slice <- cont
I0925 21:56:53.878419 12712 net.cpp:141] Setting up lstm2_
I0925 21:56:53.878432 12718 net.cpp:399] lstm2_cont_slice -> cont_1
I0925 21:56:53.878448 12712 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.878458 12712 net.cpp:156] Memory required for data: 94020
I0925 21:56:53.878469 12712 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0925 21:56:53.878489 12712 net.cpp:91] Creating Layer lstm2_h_concat
I0925 21:56:53.878500 12712 net.cpp:425] lstm2_h_concat <- h_1
I0925 21:56:53.878518 12712 net.cpp:399] lstm2_h_concat -> h
I0925 21:56:53.878566 12718 net.cpp:141] Setting up lstm2_cont_slice
I0925 21:56:53.878584 12718 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.878608 12718 net.cpp:156] Memory required for data: 14012
I0925 21:56:53.878620 12718 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0925 21:56:53.878639 12718 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0925 21:56:53.878645 12690 net.cpp:141] Setting up lstm1_unit_1
I0925 21:56:53.878650 12718 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0925 21:56:53.878662 12690 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.878664 12718 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0925 21:56:53.878681 12690 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.878691 12690 net.cpp:156] Memory required for data: 86016
I0925 21:56:53.878695 12718 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0925 21:56:53.878701 12690 layer_factory.hpp:77] Creating layer lstm1_
I0925 21:56:53.878707 12712 net.cpp:141] Setting up lstm2_h_concat
I0925 21:56:53.878718 12690 net.cpp:91] Creating Layer lstm1_
I0925 21:56:53.878726 12712 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.878729 12690 net.cpp:425] lstm1_ <- c_1
I0925 21:56:53.878736 12712 net.cpp:156] Memory required for data: 98020
I0925 21:56:53.878743 12690 net.cpp:399] lstm1_ -> c_T
I0925 21:56:53.878746 12712 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 21:56:53.878777 12712 net.cpp:91] Creating Layer h_pseudoloss
I0925 21:56:53.878789 12712 net.cpp:425] h_pseudoloss <- h
I0925 21:56:53.878795 12690 net.cpp:141] Setting up lstm1_
I0925 21:56:53.878803 12712 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 21:56:53.878813 12690 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.878821 12690 net.cpp:156] Memory required for data: 90016
I0925 21:56:53.878831 12690 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0925 21:56:53.878846 12690 net.cpp:91] Creating Layer lstm1_h_concat
I0925 21:56:53.878846 12718 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0925 21:56:53.878860 12690 net.cpp:425] lstm1_h_concat <- h_1
I0925 21:56:53.878870 12718 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.878883 12718 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.878885 12690 net.cpp:399] lstm1_h_concat -> h
I0925 21:56:53.878907 12718 net.cpp:156] Memory required for data: 14020
I0925 21:56:53.878917 12718 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0925 21:56:53.878944 12718 net.cpp:91] Creating Layer lstm2_x_transform
I0925 21:56:53.878952 12718 net.cpp:425] lstm2_x_transform <- x
I0925 21:56:53.878965 12718 net.cpp:399] lstm2_x_transform -> W_xc_x
I0925 21:56:53.879026 12712 net.cpp:141] Setting up h_pseudoloss
I0925 21:56:53.879046 12712 net.cpp:148] Top shape: (1)
I0925 21:56:53.879065 12690 net.cpp:141] Setting up lstm1_h_concat
I0925 21:56:53.879055 12712 net.cpp:151]     with loss weight 1
I0925 21:56:53.879084 12712 net.cpp:156] Memory required for data: 98024
I0925 21:56:53.879084 12690 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.879101 12712 net.cpp:217] h_pseudoloss needs backward computation.
I0925 21:56:53.879108 12690 net.cpp:156] Memory required for data: 94016
I0925 21:56:53.879112 12712 net.cpp:217] lstm2_h_concat needs backward computation.
I0925 21:56:53.879119 12690 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 21:56:53.879122 12712 net.cpp:219] lstm2_ does not need backward computation.
I0925 21:56:53.879132 12712 net.cpp:217] lstm2_unit_1 needs backward computation.
I0925 21:56:53.879133 12690 net.cpp:91] Creating Layer h_pseudoloss
I0925 21:56:53.879149 12712 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0925 21:56:53.879153 12690 net.cpp:425] h_pseudoloss <- h
I0925 21:56:53.879161 12712 net.cpp:217] lstm2_transform_1 needs backward computation.
I0925 21:56:53.879168 12690 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 21:56:53.879173 12712 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0925 21:56:53.879184 12712 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0925 21:56:53.879194 12712 net.cpp:217] lstm2_x_transform needs backward computation.
I0925 21:56:53.879205 12712 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0925 21:56:53.879217 12712 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0925 21:56:53.879227 12712 net.cpp:219] lstm2_ does not need backward computation.
I0925 21:56:53.879236 12712 net.cpp:219] lstm2_ does not need backward computation.
I0925 21:56:53.879245 12712 net.cpp:261] This network produces output c_T
I0925 21:56:53.879254 12712 net.cpp:261] This network produces output h_pseudoloss
I0925 21:56:53.893194 12712 net.cpp:274] Network initialization done.
I0925 21:56:53.893309 12712 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 21:56:53.893318 12712 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 21:56:53.893324 12712 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 21:56:53.895579 12700 net.cpp:141] Setting up lstm2_transform_1
I0925 21:56:53.895622 12700 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:53.895633 12700 net.cpp:156] Memory required for data: 66020
I0925 21:56:53.895660 12700 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0925 21:56:53.895692 12700 net.cpp:91] Creating Layer lstm2_gate_input_1
I0925 21:56:53.895704 12700 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0925 21:56:53.895717 12700 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0925 21:56:53.895732 12700 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0925 21:56:53.895759 12690 net.cpp:141] Setting up h_pseudoloss
I0925 21:56:53.895784 12690 net.cpp:148] Top shape: (1)
I0925 21:56:53.895807 12712 net.cpp:141] Setting up lstm2
I0925 21:56:53.895794 12690 net.cpp:151]     with loss weight 1
I0925 21:56:53.895838 12712 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.895839 12690 net.cpp:156] Memory required for data: 94020
I0925 21:56:53.895854 12712 net.cpp:156] Memory required for data: 36412
I0925 21:56:53.895861 12690 net.cpp:217] h_pseudoloss needs backward computation.
I0925 21:56:53.895871 12700 net.cpp:141] Setting up lstm2_gate_input_1
I0925 21:56:53.895882 12712 layer_factory.hpp:77] Creating layer predict
I0925 21:56:53.895874 12690 net.cpp:217] lstm1_h_concat needs backward computation.
I0925 21:56:53.895910 12712 net.cpp:91] Creating Layer predict
I0925 21:56:53.895918 12690 net.cpp:219] lstm1_ does not need backward computation.
I0925 21:56:53.895895 12700 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:53.895931 12712 net.cpp:425] predict <- lstm2
I0925 21:56:53.895933 12700 net.cpp:156] Memory required for data: 82020
I0925 21:56:53.895931 12690 net.cpp:217] lstm1_unit_1 needs backward computation.
I0925 21:56:53.895943 12700 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0925 21:56:53.895952 12712 net.cpp:399] predict -> predict
I0925 21:56:53.895958 12700 net.cpp:91] Creating Layer lstm2_unit_1
I0925 21:56:53.895954 12690 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0925 21:56:53.895967 12700 net.cpp:425] lstm2_unit_1 <- c_0
I0925 21:56:53.895977 12690 net.cpp:217] lstm1_transform_1 needs backward computation.
I0925 21:56:53.895978 12700 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0925 21:56:53.895988 12690 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0925 21:56:53.895990 12700 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0925 21:56:53.896000 12690 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0925 21:56:53.896004 12700 net.cpp:399] lstm2_unit_1 -> c_1
I0925 21:56:53.896010 12690 net.cpp:217] lstm1_x_transform needs backward computation.
I0925 21:56:53.896018 12700 net.cpp:399] lstm2_unit_1 -> h_1
I0925 21:56:53.896021 12690 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0925 21:56:53.896037 12690 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0925 21:56:53.896049 12690 net.cpp:219] lstm1_ does not need backward computation.
I0925 21:56:53.896057 12690 net.cpp:219] lstm1_ does not need backward computation.
I0925 21:56:53.896064 12690 net.cpp:261] This network produces output c_T
I0925 21:56:53.896075 12690 net.cpp:261] This network produces output h_pseudoloss
I0925 21:56:53.896103 12690 net.cpp:274] Network initialization done.
I0925 21:56:53.896183 12690 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 21:56:53.896195 12690 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 21:56:53.896205 12690 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 21:56:53.896440 12700 net.cpp:141] Setting up lstm2_unit_1
I0925 21:56:53.896461 12700 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.896472 12700 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.896481 12700 net.cpp:156] Memory required for data: 90020
I0925 21:56:53.896488 12700 layer_factory.hpp:77] Creating layer lstm2_
I0925 21:56:53.896529 12700 net.cpp:91] Creating Layer lstm2_
I0925 21:56:53.896541 12700 net.cpp:425] lstm2_ <- c_1
I0925 21:56:53.896556 12700 net.cpp:399] lstm2_ -> c_T
I0925 21:56:53.987076 12700 net.cpp:141] Setting up lstm2_
I0925 21:56:53.987133 12694 net.cpp:141] Setting up lstm1_transform_1
I0925 21:56:53.987159 12694 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:53.987159 12700 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.987170 12694 net.cpp:156] Memory required for data: 62016
I0925 21:56:53.987184 12700 net.cpp:156] Memory required for data: 94020
I0925 21:56:53.987201 12694 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0925 21:56:53.987203 12700 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0925 21:56:53.987241 12694 net.cpp:91] Creating Layer lstm1_gate_input_1
I0925 21:56:53.987242 12700 net.cpp:91] Creating Layer lstm2_h_concat
I0925 21:56:53.987254 12694 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0925 21:56:53.987265 12700 net.cpp:425] lstm2_h_concat <- h_1
I0925 21:56:53.987268 12694 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0925 21:56:53.987314 12694 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0925 21:56:53.987331 12700 net.cpp:399] lstm2_h_concat -> h
I0925 21:56:53.987411 12694 net.cpp:141] Setting up lstm1_gate_input_1
I0925 21:56:53.987427 12694 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:53.987435 12694 net.cpp:156] Memory required for data: 78016
I0925 21:56:53.987444 12694 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0925 21:56:53.987459 12694 net.cpp:91] Creating Layer lstm1_unit_1
I0925 21:56:53.987468 12694 net.cpp:425] lstm1_unit_1 <- c_0
I0925 21:56:53.987479 12694 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0925 21:56:53.987496 12694 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0925 21:56:53.987514 12694 net.cpp:399] lstm1_unit_1 -> c_1
I0925 21:56:53.987532 12694 net.cpp:399] lstm1_unit_1 -> h_1
I0925 21:56:53.987581 12690 net.cpp:141] Setting up lstm1
I0925 21:56:53.987617 12690 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.987623 12690 net.cpp:156] Memory required for data: 26408
I0925 21:56:53.987645 12690 layer_factory.hpp:77] Creating layer concat
I0925 21:56:53.987663 12690 net.cpp:91] Creating Layer concat
I0925 21:56:53.987670 12690 net.cpp:425] concat <- lstm1
I0925 21:56:53.987679 12690 net.cpp:425] concat <- embedded_input_sentence
I0925 21:56:53.987679 12694 net.cpp:141] Setting up lstm1_unit_1
I0925 21:56:53.987687 12690 net.cpp:425] concat <- reshaped_stage_indicator
I0925 21:56:53.987697 12690 net.cpp:399] concat -> lstm1_video_sequence
I0925 21:56:53.987696 12694 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.987736 12694 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.987746 12694 net.cpp:156] Memory required for data: 86016
I0925 21:56:53.987753 12694 layer_factory.hpp:77] Creating layer lstm1_
I0925 21:56:53.987767 12694 net.cpp:91] Creating Layer lstm1_
I0925 21:56:53.987776 12690 net.cpp:141] Setting up concat
I0925 21:56:53.987798 12690 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 21:56:53.987814 12690 net.cpp:156] Memory required for data: 32412
I0925 21:56:53.987776 12694 net.cpp:425] lstm1_ <- c_1
I0925 21:56:53.987820 12690 layer_factory.hpp:77] Creating layer lstm2
I0925 21:56:53.987833 12694 net.cpp:399] lstm1_ -> c_T
I0925 21:56:53.987838 12690 net.cpp:91] Creating Layer lstm2
I0925 21:56:53.987844 12690 net.cpp:425] lstm2 <- lstm1_video_sequence
I0925 21:56:53.987851 12690 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0925 21:56:53.987860 12690 net.cpp:399] lstm2 -> lstm2
I0925 21:56:53.987874 12690 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 21:56:53.987918 12694 net.cpp:141] Setting up lstm1_
I0925 21:56:53.987934 12694 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.987943 12694 net.cpp:156] Memory required for data: 90016
I0925 21:56:53.987952 12694 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0925 21:56:53.987965 12694 net.cpp:91] Creating Layer lstm1_h_concat
I0925 21:56:53.987973 12694 net.cpp:425] lstm1_h_concat <- h_1
I0925 21:56:53.987987 12694 net.cpp:399] lstm1_h_concat -> h
I0925 21:56:53.988060 12694 net.cpp:141] Setting up lstm1_h_concat
I0925 21:56:53.988080 12694 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.988090 12694 net.cpp:156] Memory required for data: 94016
I0925 21:56:53.988101 12694 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 21:56:53.988117 12694 net.cpp:91] Creating Layer h_pseudoloss
I0925 21:56:53.988129 12694 net.cpp:425] h_pseudoloss <- h
I0925 21:56:53.988143 12694 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 21:56:53.988350 12694 net.cpp:141] Setting up h_pseudoloss
I0925 21:56:53.988369 12694 net.cpp:148] Top shape: (1)
I0925 21:56:53.988379 12694 net.cpp:151]     with loss weight 1
I0925 21:56:53.988404 12694 net.cpp:156] Memory required for data: 94020
I0925 21:56:53.988415 12694 net.cpp:217] h_pseudoloss needs backward computation.
I0925 21:56:53.988425 12694 net.cpp:217] lstm1_h_concat needs backward computation.
I0925 21:56:53.988432 12694 net.cpp:219] lstm1_ does not need backward computation.
I0925 21:56:53.988441 12694 net.cpp:217] lstm1_unit_1 needs backward computation.
I0925 21:56:53.988453 12694 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0925 21:56:53.988466 12694 net.cpp:217] lstm1_transform_1 needs backward computation.
I0925 21:56:53.988477 12694 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0925 21:56:53.988492 12694 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0925 21:56:53.988502 12694 net.cpp:217] lstm1_x_transform needs backward computation.
I0925 21:56:53.988512 12694 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0925 21:56:53.988529 12694 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0925 21:56:53.988541 12694 net.cpp:219] lstm1_ does not need backward computation.
I0925 21:56:53.988551 12694 net.cpp:219] lstm1_ does not need backward computation.
I0925 21:56:53.988559 12694 net.cpp:261] This network produces output c_T
I0925 21:56:53.988555 12690 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 21:56:53.988586 12694 net.cpp:261] This network produces output h_pseudoloss
I0925 21:56:53.988647 12694 net.cpp:274] Network initialization done.
I0925 21:56:53.988711 12690 layer_factory.hpp:77] Creating layer lstm2_
I0925 21:56:53.988728 12690 net.cpp:91] Creating Layer lstm2_
I0925 21:56:53.988749 12690 net.cpp:399] lstm2_ -> x
I0925 21:56:53.988723 12694 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 21:56:53.988762 12690 net.cpp:399] lstm2_ -> cont
I0925 21:56:53.988762 12694 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 21:56:53.988775 12694 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 21:56:53.988867 12690 net.cpp:141] Setting up lstm2_
I0925 21:56:53.988879 12690 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 21:56:53.988886 12690 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.988891 12690 net.cpp:156] Memory required for data: 6008
I0925 21:56:53.988898 12690 layer_factory.hpp:77] Creating layer lstm2_
I0925 21:56:53.988908 12690 net.cpp:91] Creating Layer lstm2_
I0925 21:56:53.988917 12690 net.cpp:399] lstm2_ -> c_0
I0925 21:56:53.988929 12690 net.cpp:399] lstm2_ -> h_0
I0925 21:56:53.989063 12690 net.cpp:141] Setting up lstm2_
I0925 21:56:53.989078 12690 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.989084 12690 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.989089 12690 net.cpp:156] Memory required for data: 14008
I0925 21:56:53.989095 12690 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0925 21:56:53.989107 12690 net.cpp:91] Creating Layer lstm2_cont_slice
I0925 21:56:53.989114 12690 net.cpp:425] lstm2_cont_slice <- cont
I0925 21:56:53.989121 12690 net.cpp:399] lstm2_cont_slice -> cont_1
I0925 21:56:53.989140 12694 net.cpp:141] Setting up lstm1
I0925 21:56:53.989161 12694 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.989171 12694 net.cpp:156] Memory required for data: 26408
I0925 21:56:53.989197 12694 layer_factory.hpp:77] Creating layer concat
I0925 21:56:53.989217 12694 net.cpp:91] Creating Layer concat
I0925 21:56:53.989228 12694 net.cpp:425] concat <- lstm1
I0925 21:56:53.989239 12694 net.cpp:425] concat <- embedded_input_sentence
I0925 21:56:53.989249 12694 net.cpp:425] concat <- reshaped_stage_indicator
I0925 21:56:53.989262 12694 net.cpp:399] concat -> lstm1_video_sequence
I0925 21:56:53.991261 12694 net.cpp:141] Setting up concat
I0925 21:56:53.991300 12694 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 21:56:53.991309 12694 net.cpp:156] Memory required for data: 32412
I0925 21:56:53.991320 12694 layer_factory.hpp:77] Creating layer lstm2
I0925 21:56:53.991341 12690 net.cpp:141] Setting up lstm2_cont_slice
I0925 21:56:53.991349 12694 net.cpp:91] Creating Layer lstm2
I0925 21:56:53.991370 12690 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.991389 12694 net.cpp:425] lstm2 <- lstm1_video_sequence
I0925 21:56:53.991391 12690 net.cpp:156] Memory required for data: 14012
I0925 21:56:53.991408 12690 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0925 21:56:53.991407 12700 net.cpp:141] Setting up lstm2_h_concat
I0925 21:56:53.991408 12694 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0925 21:56:53.991439 12700 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:53.991425 12690 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0925 21:56:53.991446 12700 net.cpp:156] Memory required for data: 98020
I0925 21:56:53.991459 12690 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0925 21:56:53.991456 12694 net.cpp:399] lstm2 -> lstm2
I0925 21:56:53.991471 12700 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 21:56:53.991472 12690 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0925 21:56:53.991490 12694 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 21:56:53.991497 12700 net.cpp:91] Creating Layer h_pseudoloss
I0925 21:56:53.991503 12690 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0925 21:56:53.991506 12700 net.cpp:425] h_pseudoloss <- h
I0925 21:56:53.991518 12700 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 21:56:53.991952 12694 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 21:56:53.992115 12694 layer_factory.hpp:77] Creating layer lstm2_
I0925 21:56:53.992138 12694 net.cpp:91] Creating Layer lstm2_
I0925 21:56:53.992151 12694 net.cpp:399] lstm2_ -> x
I0925 21:56:53.992171 12694 net.cpp:399] lstm2_ -> cont
I0925 21:56:53.998340 12690 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0925 21:56:53.998399 12690 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.998414 12690 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.998421 12690 net.cpp:156] Memory required for data: 14020
I0925 21:56:53.998437 12690 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0925 21:56:53.998479 12690 net.cpp:91] Creating Layer lstm2_x_transform
I0925 21:56:53.998494 12690 net.cpp:425] lstm2_x_transform <- x
I0925 21:56:53.998504 12718 net.cpp:141] Setting up lstm2_x_transform
I0925 21:56:53.998524 12718 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:53.998522 12690 net.cpp:399] lstm2_x_transform -> W_xc_x
I0925 21:56:53.998531 12718 net.cpp:156] Memory required for data: 30020
I0925 21:56:53.998571 12718 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0925 21:56:53.998641 12718 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0925 21:56:53.998654 12718 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0925 21:56:53.998667 12718 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0925 21:56:53.998755 12694 net.cpp:141] Setting up lstm2_
I0925 21:56:53.998797 12700 net.cpp:141] Setting up h_pseudoloss
I0925 21:56:53.998803 12694 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 21:56:53.998834 12700 net.cpp:148] Top shape: (1)
I0925 21:56:53.998845 12694 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:53.998842 12700 net.cpp:151]     with loss weight 1
I0925 21:56:53.998847 12718 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0925 21:56:53.998868 12694 net.cpp:156] Memory required for data: 6008
I0925 21:56:53.998867 12700 net.cpp:156] Memory required for data: 98024
I0925 21:56:53.998886 12694 layer_factory.hpp:77] Creating layer lstm2_
I0925 21:56:53.998893 12700 net.cpp:217] h_pseudoloss needs backward computation.
I0925 21:56:53.998903 12700 net.cpp:217] lstm2_h_concat needs backward computation.
I0925 21:56:53.998889 12718 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:53.998908 12700 net.cpp:219] lstm2_ does not need backward computation.
I0925 21:56:53.998911 12718 net.cpp:156] Memory required for data: 46020
I0925 21:56:53.998915 12700 net.cpp:217] lstm2_unit_1 needs backward computation.
I0925 21:56:53.998920 12718 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0925 21:56:53.998924 12700 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0925 21:56:53.998926 12694 net.cpp:91] Creating Layer lstm2_
I0925 21:56:53.998931 12700 net.cpp:217] lstm2_transform_1 needs backward computation.
I0925 21:56:53.998934 12718 net.cpp:91] Creating Layer lstm2_h_conted_0
I0925 21:56:53.998955 12700 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0925 21:56:53.998961 12694 net.cpp:399] lstm2_ -> c_0
I0925 21:56:53.998957 12718 net.cpp:425] lstm2_h_conted_0 <- h_0
I0925 21:56:53.998970 12700 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0925 21:56:53.998977 12700 net.cpp:217] lstm2_x_transform needs backward computation.
I0925 21:56:53.998978 12718 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0925 21:56:53.998985 12700 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0925 21:56:53.998988 12718 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0925 21:56:53.998991 12700 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0925 21:56:53.998991 12694 net.cpp:399] lstm2_ -> h_0
I0925 21:56:53.999001 12700 net.cpp:219] lstm2_ does not need backward computation.
I0925 21:56:53.999006 12700 net.cpp:219] lstm2_ does not need backward computation.
I0925 21:56:53.999011 12700 net.cpp:261] This network produces output c_T
I0925 21:56:53.999017 12700 net.cpp:261] This network produces output h_pseudoloss
I0925 21:56:53.999039 12700 net.cpp:274] Network initialization done.
I0925 21:56:53.999097 12700 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 21:56:53.999105 12700 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 21:56:53.999110 12700 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 21:56:54.015578 12694 net.cpp:141] Setting up lstm2_
I0925 21:56:54.015602 12700 net.cpp:141] Setting up lstm2
I0925 21:56:54.015637 12700 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:54.015638 12694 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:54.015645 12700 net.cpp:156] Memory required for data: 36412
I0925 21:56:54.015652 12694 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:54.015661 12694 net.cpp:156] Memory required for data: 14008
I0925 21:56:54.015666 12700 layer_factory.hpp:77] Creating layer predict
I0925 21:56:54.015671 12694 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0925 21:56:54.015687 12700 net.cpp:91] Creating Layer predict
I0925 21:56:54.015691 12694 net.cpp:91] Creating Layer lstm2_cont_slice
I0925 21:56:54.015697 12700 net.cpp:425] predict <- lstm2
I0925 21:56:54.015702 12694 net.cpp:425] lstm2_cont_slice <- cont
I0925 21:56:54.015707 12700 net.cpp:399] predict -> predict
I0925 21:56:54.015717 12694 net.cpp:399] lstm2_cont_slice -> cont_1
I0925 21:56:54.015938 12694 net.cpp:141] Setting up lstm2_cont_slice
I0925 21:56:54.015956 12694 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:54.015965 12694 net.cpp:156] Memory required for data: 14012
I0925 21:56:54.015975 12694 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0925 21:56:54.015996 12694 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0925 21:56:54.016007 12694 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0925 21:56:54.016021 12694 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0925 21:56:54.016038 12694 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0925 21:56:54.104506 12718 net.cpp:141] Setting up lstm2_h_conted_0
I0925 21:56:54.104578 12718 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:54.104590 12718 net.cpp:156] Memory required for data: 50020
I0925 21:56:54.104607 12718 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0925 21:56:54.104673 12718 net.cpp:91] Creating Layer lstm2_transform_1
I0925 21:56:54.104689 12718 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0925 21:56:54.104715 12718 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0925 21:56:54.116258 12694 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0925 21:56:54.116322 12694 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:54.116336 12694 net.cpp:148] Top shape: 1 1 (1)
I0925 21:56:54.116345 12694 net.cpp:156] Memory required for data: 14020
I0925 21:56:54.116358 12694 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0925 21:56:54.116380 12690 net.cpp:141] Setting up lstm2_x_transform
I0925 21:56:54.116397 12694 net.cpp:91] Creating Layer lstm2_x_transform
I0925 21:56:54.116428 12690 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:54.116432 12694 net.cpp:425] lstm2_x_transform <- x
I0925 21:56:54.116441 12690 net.cpp:156] Memory required for data: 30020
I0925 21:56:54.116456 12694 net.cpp:399] lstm2_x_transform -> W_xc_x
I0925 21:56:54.116474 12690 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0925 21:56:54.116499 12690 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0925 21:56:54.116510 12690 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0925 21:56:54.116533 12690 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0925 21:56:54.116827 12690 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0925 21:56:54.116847 12690 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:54.116855 12690 net.cpp:156] Memory required for data: 46020
I0925 21:56:54.116864 12690 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0925 21:56:54.116883 12690 net.cpp:91] Creating Layer lstm2_h_conted_0
I0925 21:56:54.116892 12690 net.cpp:425] lstm2_h_conted_0 <- h_0
I0925 21:56:54.116904 12690 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0925 21:56:54.116917 12690 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0925 21:56:54.133803 12690 net.cpp:141] Setting up lstm2_h_conted_0
I0925 21:56:54.133865 12690 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:54.133877 12690 net.cpp:156] Memory required for data: 50020
I0925 21:56:54.133891 12690 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0925 21:56:54.133924 12690 net.cpp:91] Creating Layer lstm2_transform_1
I0925 21:56:54.133937 12690 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0925 21:56:54.133962 12690 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0925 21:56:54.153108 12718 net.cpp:141] Setting up lstm2_transform_1
I0925 21:56:54.153170 12718 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:54.153180 12718 net.cpp:156] Memory required for data: 66020
I0925 21:56:54.153211 12718 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0925 21:56:54.153245 12718 net.cpp:91] Creating Layer lstm2_gate_input_1
I0925 21:56:54.153259 12718 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0925 21:56:54.153273 12718 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0925 21:56:54.153290 12718 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0925 21:56:54.153565 12718 net.cpp:141] Setting up lstm2_gate_input_1
I0925 21:56:54.153589 12718 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:54.153599 12718 net.cpp:156] Memory required for data: 82020
I0925 21:56:54.153607 12718 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0925 21:56:54.153692 12718 net.cpp:91] Creating Layer lstm2_unit_1
I0925 21:56:54.153707 12718 net.cpp:425] lstm2_unit_1 <- c_0
I0925 21:56:54.153719 12718 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0925 21:56:54.153731 12718 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0925 21:56:54.153746 12718 net.cpp:399] lstm2_unit_1 -> c_1
I0925 21:56:54.153767 12718 net.cpp:399] lstm2_unit_1 -> h_1
I0925 21:56:54.163365 12718 net.cpp:141] Setting up lstm2_unit_1
I0925 21:56:54.163422 12718 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:54.163430 12718 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:54.163436 12718 net.cpp:156] Memory required for data: 90020
I0925 21:56:54.163447 12718 layer_factory.hpp:77] Creating layer lstm2_
I0925 21:56:54.163470 12718 net.cpp:91] Creating Layer lstm2_
I0925 21:56:54.163478 12718 net.cpp:425] lstm2_ <- c_1
I0925 21:56:54.163492 12718 net.cpp:399] lstm2_ -> c_T
I0925 21:56:54.166321 12718 net.cpp:141] Setting up lstm2_
I0925 21:56:54.166342 12718 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:54.166349 12718 net.cpp:156] Memory required for data: 94020
I0925 21:56:54.166355 12718 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0925 21:56:54.166376 12718 net.cpp:91] Creating Layer lstm2_h_concat
I0925 21:56:54.166383 12718 net.cpp:425] lstm2_h_concat <- h_1
I0925 21:56:54.166393 12718 net.cpp:399] lstm2_h_concat -> h
I0925 21:56:54.166613 12718 net.cpp:141] Setting up lstm2_h_concat
I0925 21:56:54.166626 12718 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:54.166631 12718 net.cpp:156] Memory required for data: 98020
I0925 21:56:54.166637 12718 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 21:56:54.166648 12718 net.cpp:91] Creating Layer h_pseudoloss
I0925 21:56:54.166654 12718 net.cpp:425] h_pseudoloss <- h
I0925 21:56:54.166666 12718 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 21:56:54.168073 12718 net.cpp:141] Setting up h_pseudoloss
I0925 21:56:54.168099 12718 net.cpp:148] Top shape: (1)
I0925 21:56:54.168107 12718 net.cpp:151]     with loss weight 1
I0925 21:56:54.168121 12718 net.cpp:156] Memory required for data: 98024
I0925 21:56:54.168128 12718 net.cpp:217] h_pseudoloss needs backward computation.
I0925 21:56:54.168133 12718 net.cpp:217] lstm2_h_concat needs backward computation.
I0925 21:56:54.168138 12718 net.cpp:219] lstm2_ does not need backward computation.
I0925 21:56:54.168144 12718 net.cpp:217] lstm2_unit_1 needs backward computation.
I0925 21:56:54.168151 12718 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0925 21:56:54.168157 12718 net.cpp:217] lstm2_transform_1 needs backward computation.
I0925 21:56:54.168162 12718 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0925 21:56:54.168169 12718 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0925 21:56:54.168174 12718 net.cpp:217] lstm2_x_transform needs backward computation.
I0925 21:56:54.168180 12718 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0925 21:56:54.168187 12718 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0925 21:56:54.168193 12718 net.cpp:219] lstm2_ does not need backward computation.
I0925 21:56:54.168200 12718 net.cpp:219] lstm2_ does not need backward computation.
I0925 21:56:54.168203 12718 net.cpp:261] This network produces output c_T
I0925 21:56:54.168208 12718 net.cpp:261] This network produces output h_pseudoloss
I0925 21:56:54.168229 12718 net.cpp:274] Network initialization done.
I0925 21:56:54.168347 12718 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 21:56:54.168356 12718 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 21:56:54.168362 12718 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 21:56:54.168807 12718 net.cpp:141] Setting up lstm2
I0925 21:56:54.168823 12718 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:54.168829 12718 net.cpp:156] Memory required for data: 36412
I0925 21:56:54.168850 12718 layer_factory.hpp:77] Creating layer predict
I0925 21:56:54.168866 12718 net.cpp:91] Creating Layer predict
I0925 21:56:54.168874 12718 net.cpp:425] predict <- lstm2
I0925 21:56:54.168884 12718 net.cpp:399] predict -> predict
I0925 21:56:54.260426 12694 net.cpp:141] Setting up lstm2_x_transform
I0925 21:56:54.260484 12694 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:54.260495 12694 net.cpp:156] Memory required for data: 30020
I0925 21:56:54.260529 12694 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0925 21:56:54.260560 12694 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0925 21:56:54.260572 12694 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0925 21:56:54.260591 12694 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0925 21:56:54.263623 12694 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0925 21:56:54.263659 12694 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:54.263672 12694 net.cpp:156] Memory required for data: 46020
I0925 21:56:54.263687 12694 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0925 21:56:54.263711 12694 net.cpp:91] Creating Layer lstm2_h_conted_0
I0925 21:56:54.263725 12694 net.cpp:425] lstm2_h_conted_0 <- h_0
I0925 21:56:54.263736 12694 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0925 21:56:54.263756 12694 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0925 21:56:54.264077 12694 net.cpp:141] Setting up lstm2_h_conted_0
I0925 21:56:54.264101 12694 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:54.264111 12694 net.cpp:156] Memory required for data: 50020
I0925 21:56:54.264122 12694 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0925 21:56:54.264153 12694 net.cpp:91] Creating Layer lstm2_transform_1
I0925 21:56:54.264166 12694 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0925 21:56:54.264185 12694 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0925 21:56:54.275638 12690 net.cpp:141] Setting up lstm2_transform_1
I0925 21:56:54.275732 12690 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:54.275743 12690 net.cpp:156] Memory required for data: 66020
I0925 21:56:54.275815 12690 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0925 21:56:54.275867 12690 net.cpp:91] Creating Layer lstm2_gate_input_1
I0925 21:56:54.275882 12690 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0925 21:56:54.275897 12690 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0925 21:56:54.275913 12690 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0925 21:56:54.277456 12690 net.cpp:141] Setting up lstm2_gate_input_1
I0925 21:56:54.277505 12690 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:54.277518 12690 net.cpp:156] Memory required for data: 82020
I0925 21:56:54.277531 12690 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0925 21:56:54.277556 12690 net.cpp:91] Creating Layer lstm2_unit_1
I0925 21:56:54.277565 12690 net.cpp:425] lstm2_unit_1 <- c_0
I0925 21:56:54.277576 12690 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0925 21:56:54.277582 12690 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0925 21:56:54.277596 12690 net.cpp:399] lstm2_unit_1 -> c_1
I0925 21:56:54.277611 12690 net.cpp:399] lstm2_unit_1 -> h_1
I0925 21:56:54.278267 12690 net.cpp:141] Setting up lstm2_unit_1
I0925 21:56:54.278290 12690 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:54.278298 12690 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:54.278303 12690 net.cpp:156] Memory required for data: 90020
I0925 21:56:54.278309 12690 layer_factory.hpp:77] Creating layer lstm2_
I0925 21:56:54.278321 12690 net.cpp:91] Creating Layer lstm2_
I0925 21:56:54.278326 12690 net.cpp:425] lstm2_ <- c_1
I0925 21:56:54.278336 12690 net.cpp:399] lstm2_ -> c_T
I0925 21:56:54.279932 12690 net.cpp:141] Setting up lstm2_
I0925 21:56:54.279994 12690 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:54.280004 12690 net.cpp:156] Memory required for data: 94020
I0925 21:56:54.280019 12690 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0925 21:56:54.280050 12690 net.cpp:91] Creating Layer lstm2_h_concat
I0925 21:56:54.280068 12690 net.cpp:425] lstm2_h_concat <- h_1
I0925 21:56:54.280089 12690 net.cpp:399] lstm2_h_concat -> h
I0925 21:56:54.284797 12690 net.cpp:141] Setting up lstm2_h_concat
I0925 21:56:54.284862 12690 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:54.284874 12690 net.cpp:156] Memory required for data: 98020
I0925 21:56:54.284890 12690 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 21:56:54.284929 12690 net.cpp:91] Creating Layer h_pseudoloss
I0925 21:56:54.284942 12690 net.cpp:425] h_pseudoloss <- h
I0925 21:56:54.284963 12690 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 21:56:54.297457 12690 net.cpp:141] Setting up h_pseudoloss
I0925 21:56:54.297502 12690 net.cpp:148] Top shape: (1)
I0925 21:56:54.297508 12690 net.cpp:151]     with loss weight 1
I0925 21:56:54.297526 12690 net.cpp:156] Memory required for data: 98024
I0925 21:56:54.297535 12690 net.cpp:217] h_pseudoloss needs backward computation.
I0925 21:56:54.297544 12690 net.cpp:217] lstm2_h_concat needs backward computation.
I0925 21:56:54.297549 12690 net.cpp:219] lstm2_ does not need backward computation.
I0925 21:56:54.297554 12690 net.cpp:217] lstm2_unit_1 needs backward computation.
I0925 21:56:54.297562 12690 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0925 21:56:54.297569 12690 net.cpp:217] lstm2_transform_1 needs backward computation.
I0925 21:56:54.297575 12690 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0925 21:56:54.297582 12690 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0925 21:56:54.297588 12690 net.cpp:217] lstm2_x_transform needs backward computation.
I0925 21:56:54.297595 12690 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0925 21:56:54.297600 12690 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0925 21:56:54.297607 12690 net.cpp:219] lstm2_ does not need backward computation.
I0925 21:56:54.297611 12690 net.cpp:219] lstm2_ does not need backward computation.
I0925 21:56:54.297616 12690 net.cpp:261] This network produces output c_T
I0925 21:56:54.297623 12690 net.cpp:261] This network produces output h_pseudoloss
I0925 21:56:54.297646 12690 net.cpp:274] Network initialization done.
I0925 21:56:54.297741 12690 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 21:56:54.297750 12690 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 21:56:54.297756 12690 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 21:56:54.297916 12690 net.cpp:141] Setting up lstm2
I0925 21:56:54.297932 12690 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:54.297940 12690 net.cpp:156] Memory required for data: 36412
I0925 21:56:54.297961 12690 layer_factory.hpp:77] Creating layer predict
I0925 21:56:54.297983 12690 net.cpp:91] Creating Layer predict
I0925 21:56:54.297991 12690 net.cpp:425] predict <- lstm2
I0925 21:56:54.298001 12690 net.cpp:399] predict -> predict
I0925 21:56:54.407696 12694 net.cpp:141] Setting up lstm2_transform_1
I0925 21:56:54.407757 12694 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:54.407764 12694 net.cpp:156] Memory required for data: 66020
I0925 21:56:54.407786 12694 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0925 21:56:54.407814 12694 net.cpp:91] Creating Layer lstm2_gate_input_1
I0925 21:56:54.407821 12694 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0925 21:56:54.407830 12694 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0925 21:56:54.407840 12694 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0925 21:56:54.408152 12712 net.cpp:141] Setting up predict
I0925 21:56:54.408176 12712 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 21:56:54.408184 12712 net.cpp:156] Memory required for data: 221084
I0925 21:56:54.408200 12712 layer_factory.hpp:77] Creating layer probs
I0925 21:56:54.408213 12712 net.cpp:91] Creating Layer probs
I0925 21:56:54.408212 12694 net.cpp:141] Setting up lstm2_gate_input_1
I0925 21:56:54.408222 12712 net.cpp:425] probs <- predict
I0925 21:56:54.408237 12694 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 21:56:54.408242 12712 net.cpp:399] probs -> probs
I0925 21:56:54.408244 12694 net.cpp:156] Memory required for data: 82020
I0925 21:56:54.408252 12694 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0925 21:56:54.408265 12694 net.cpp:91] Creating Layer lstm2_unit_1
I0925 21:56:54.408272 12694 net.cpp:425] lstm2_unit_1 <- c_0
I0925 21:56:54.408280 12694 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0925 21:56:54.408287 12694 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0925 21:56:54.408294 12694 net.cpp:399] lstm2_unit_1 -> c_1
I0925 21:56:54.408305 12694 net.cpp:399] lstm2_unit_1 -> h_1
I0925 21:56:54.410466 12694 net.cpp:141] Setting up lstm2_unit_1
I0925 21:56:54.410490 12694 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:54.410497 12694 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:54.410502 12694 net.cpp:156] Memory required for data: 90020
I0925 21:56:54.410508 12694 layer_factory.hpp:77] Creating layer lstm2_
I0925 21:56:54.410521 12694 net.cpp:91] Creating Layer lstm2_
I0925 21:56:54.410528 12694 net.cpp:425] lstm2_ <- c_1
I0925 21:56:54.410537 12694 net.cpp:399] lstm2_ -> c_T
I0925 21:56:54.410581 12694 net.cpp:141] Setting up lstm2_
I0925 21:56:54.410591 12694 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:54.410612 12694 net.cpp:156] Memory required for data: 94020
I0925 21:56:54.410619 12694 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0925 21:56:54.410629 12694 net.cpp:91] Creating Layer lstm2_h_concat
I0925 21:56:54.410634 12694 net.cpp:425] lstm2_h_concat <- h_1
I0925 21:56:54.410657 12694 net.cpp:399] lstm2_h_concat -> h
I0925 21:56:54.414224 12694 net.cpp:141] Setting up lstm2_h_concat
I0925 21:56:54.414248 12694 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:54.414254 12694 net.cpp:156] Memory required for data: 98020
I0925 21:56:54.414260 12694 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 21:56:54.414271 12694 net.cpp:91] Creating Layer h_pseudoloss
I0925 21:56:54.414278 12694 net.cpp:425] h_pseudoloss <- h
I0925 21:56:54.414289 12694 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 21:56:54.414800 12694 net.cpp:141] Setting up h_pseudoloss
I0925 21:56:54.414818 12694 net.cpp:148] Top shape: (1)
I0925 21:56:54.414822 12694 net.cpp:151]     with loss weight 1
I0925 21:56:54.414841 12694 net.cpp:156] Memory required for data: 98024
I0925 21:56:54.414847 12694 net.cpp:217] h_pseudoloss needs backward computation.
I0925 21:56:54.414854 12694 net.cpp:217] lstm2_h_concat needs backward computation.
I0925 21:56:54.414858 12694 net.cpp:219] lstm2_ does not need backward computation.
I0925 21:56:54.414863 12694 net.cpp:217] lstm2_unit_1 needs backward computation.
I0925 21:56:54.414870 12694 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0925 21:56:54.414876 12694 net.cpp:217] lstm2_transform_1 needs backward computation.
I0925 21:56:54.414885 12694 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0925 21:56:54.414891 12694 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0925 21:56:54.414896 12694 net.cpp:217] lstm2_x_transform needs backward computation.
I0925 21:56:54.414902 12694 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0925 21:56:54.414908 12694 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0925 21:56:54.414914 12694 net.cpp:219] lstm2_ does not need backward computation.
I0925 21:56:54.414919 12694 net.cpp:219] lstm2_ does not need backward computation.
I0925 21:56:54.414923 12694 net.cpp:261] This network produces output c_T
I0925 21:56:54.414929 12694 net.cpp:261] This network produces output h_pseudoloss
I0925 21:56:54.414947 12694 net.cpp:274] Network initialization done.
I0925 21:56:54.415014 12694 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 21:56:54.415026 12694 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 21:56:54.415036 12694 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 21:56:54.415722 12694 net.cpp:141] Setting up lstm2
I0925 21:56:54.415750 12694 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 21:56:54.415761 12694 net.cpp:156] Memory required for data: 36412
I0925 21:56:54.415798 12694 layer_factory.hpp:77] Creating layer predict
I0925 21:56:54.415822 12694 net.cpp:91] Creating Layer predict
I0925 21:56:54.415838 12694 net.cpp:425] predict <- lstm2
I0925 21:56:54.415855 12694 net.cpp:399] predict -> predict
I0925 21:56:54.508093 12700 net.cpp:141] Setting up predict
I0925 21:56:54.508157 12700 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 21:56:54.508163 12700 net.cpp:156] Memory required for data: 221084
I0925 21:56:54.508186 12700 layer_factory.hpp:77] Creating layer probs
I0925 21:56:54.508204 12700 net.cpp:91] Creating Layer probs
I0925 21:56:54.508214 12700 net.cpp:425] probs <- predict
I0925 21:56:54.508226 12700 net.cpp:399] probs -> probs
I0925 21:56:54.509181 12712 net.cpp:141] Setting up probs
I0925 21:56:54.509212 12712 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 21:56:54.509223 12712 net.cpp:156] Memory required for data: 405756
I0925 21:56:54.509237 12712 net.cpp:219] probs does not need backward computation.
I0925 21:56:54.509248 12712 net.cpp:219] predict does not need backward computation.
I0925 21:56:54.509258 12712 net.cpp:219] lstm2 does not need backward computation.
I0925 21:56:54.509273 12712 net.cpp:219] concat does not need backward computation.
I0925 21:56:54.509285 12712 net.cpp:219] lstm1 does not need backward computation.
I0925 21:56:54.509296 12712 net.cpp:219] embedding does not need backward computation.
I0925 21:56:54.509306 12712 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0925 21:56:54.509316 12712 net.cpp:219] reshape_frames does not need backward computation.
I0925 21:56:54.509325 12712 net.cpp:219] embed_encoder does not need backward computation.
I0925 21:56:54.509335 12712 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0925 21:56:54.509349 12712 net.cpp:219] input does not need backward computation.
I0925 21:56:54.509358 12712 net.cpp:261] This network produces output probs
I0925 21:56:54.509389 12712 net.cpp:274] Network initialization done.
I0925 21:56:54.509735 12700 net.cpp:141] Setting up probs
I0925 21:56:54.509752 12700 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 21:56:54.509757 12700 net.cpp:156] Memory required for data: 405756
I0925 21:56:54.509763 12700 net.cpp:219] probs does not need backward computation.
I0925 21:56:54.509769 12700 net.cpp:219] predict does not need backward computation.
I0925 21:56:54.509776 12700 net.cpp:219] lstm2 does not need backward computation.
I0925 21:56:54.509783 12700 net.cpp:219] concat does not need backward computation.
I0925 21:56:54.509793 12700 net.cpp:219] lstm1 does not need backward computation.
I0925 21:56:54.509799 12700 net.cpp:219] embedding does not need backward computation.
I0925 21:56:54.509806 12700 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0925 21:56:54.509814 12700 net.cpp:219] reshape_frames does not need backward computation.
I0925 21:56:54.509819 12700 net.cpp:219] embed_encoder does not need backward computation.
I0925 21:56:54.509825 12700 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0925 21:56:54.509832 12700 net.cpp:219] input does not need backward computation.
I0925 21:56:54.509836 12700 net.cpp:261] This network produces output probs
I0925 21:56:54.509866 12700 net.cpp:274] Network initialization done.
I0925 21:56:54.510290 12698 net.cpp:141] Setting up conv1
I0925 21:56:54.510318 12698 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0925 21:56:54.510330 12698 net.cpp:156] Memory required for data: 17799480
I0925 21:56:54.510355 12698 layer_factory.hpp:77] Creating layer relu1
I0925 21:56:54.510376 12698 net.cpp:91] Creating Layer relu1
I0925 21:56:54.510388 12698 net.cpp:425] relu1 <- conv1
I0925 21:56:54.510401 12698 net.cpp:386] relu1 -> conv1 (in-place)
I0925 21:56:54.511014 12698 net.cpp:141] Setting up relu1
I0925 21:56:54.511034 12698 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0925 21:56:54.511044 12698 net.cpp:156] Memory required for data: 29415480
I0925 21:56:54.511055 12698 layer_factory.hpp:77] Creating layer pool1
I0925 21:56:54.511072 12698 net.cpp:91] Creating Layer pool1
I0925 21:56:54.511078 12698 net.cpp:425] pool1 <- conv1
I0925 21:56:54.511088 12698 net.cpp:399] pool1 -> pool1
I0925 21:56:54.511224 12698 net.cpp:141] Setting up pool1
I0925 21:56:54.511242 12698 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0925 21:56:54.511248 12698 net.cpp:156] Memory required for data: 32214840
I0925 21:56:54.511257 12698 layer_factory.hpp:77] Creating layer norm1
I0925 21:56:54.511279 12698 net.cpp:91] Creating Layer norm1
I0925 21:56:54.511289 12698 net.cpp:425] norm1 <- pool1
I0925 21:56:54.511303 12698 net.cpp:399] norm1 -> norm1
I0925 21:56:54.511986 12698 net.cpp:141] Setting up norm1
I0925 21:56:54.512011 12698 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0925 21:56:54.512020 12698 net.cpp:156] Memory required for data: 35014200
I0925 21:56:54.512027 12698 layer_factory.hpp:77] Creating layer conv2
I0925 21:56:54.512050 12698 net.cpp:91] Creating Layer conv2
I0925 21:56:54.512056 12698 net.cpp:425] conv2 <- norm1
I0925 21:56:54.512071 12698 net.cpp:399] conv2 -> conv2
I0925 21:56:54.517704 12698 net.cpp:141] Setting up conv2
I0925 21:56:54.517771 12698 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0925 21:56:54.517782 12698 net.cpp:156] Memory required for data: 42479160
I0925 21:56:54.517808 12698 layer_factory.hpp:77] Creating layer relu2
I0925 21:56:54.517846 12698 net.cpp:91] Creating Layer relu2
I0925 21:56:54.517855 12698 net.cpp:425] relu2 <- conv2
I0925 21:56:54.517875 12698 net.cpp:386] relu2 -> conv2 (in-place)
I0925 21:56:54.518839 12698 net.cpp:141] Setting up relu2
I0925 21:56:54.518885 12698 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0925 21:56:54.518893 12698 net.cpp:156] Memory required for data: 49944120
I0925 21:56:54.518903 12698 layer_factory.hpp:77] Creating layer pool2
I0925 21:56:54.518923 12698 net.cpp:91] Creating Layer pool2
I0925 21:56:54.518935 12698 net.cpp:425] pool2 <- conv2
I0925 21:56:54.518952 12698 net.cpp:399] pool2 -> pool2
I0925 21:56:54.519868 12698 net.cpp:141] Setting up pool2
I0925 21:56:54.519917 12698 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0925 21:56:54.519927 12698 net.cpp:156] Memory required for data: 51674680
I0925 21:56:54.519945 12698 layer_factory.hpp:77] Creating layer norm2
I0925 21:56:54.520550 12698 net.cpp:91] Creating Layer norm2
I0925 21:56:54.520584 12698 net.cpp:425] norm2 <- pool2
I0925 21:56:54.520607 12698 net.cpp:399] norm2 -> norm2
I0925 21:56:54.522111 12698 net.cpp:141] Setting up norm2
I0925 21:56:54.522187 12698 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0925 21:56:54.522200 12698 net.cpp:156] Memory required for data: 53405240
I0925 21:56:54.522217 12698 layer_factory.hpp:77] Creating layer conv3
I0925 21:56:54.522251 12698 net.cpp:91] Creating Layer conv3
I0925 21:56:54.522266 12698 net.cpp:425] conv3 <- norm2
I0925 21:56:54.522878 12698 net.cpp:399] conv3 -> conv3
I0925 21:56:54.548231 12698 net.cpp:141] Setting up conv3
I0925 21:56:54.548286 12698 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0925 21:56:54.548295 12698 net.cpp:156] Memory required for data: 56001080
I0925 21:56:54.548322 12698 layer_factory.hpp:77] Creating layer relu3
I0925 21:56:54.553844 12698 net.cpp:91] Creating Layer relu3
I0925 21:56:54.553880 12698 net.cpp:425] relu3 <- conv3
I0925 21:56:54.554209 12698 net.cpp:386] relu3 -> conv3 (in-place)
I0925 21:56:54.555423 12698 net.cpp:141] Setting up relu3
I0925 21:56:54.555481 12698 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0925 21:56:54.555488 12698 net.cpp:156] Memory required for data: 58596920
I0925 21:56:54.555498 12698 layer_factory.hpp:77] Creating layer conv4
I0925 21:56:54.555927 12698 net.cpp:91] Creating Layer conv4
I0925 21:56:54.555938 12698 net.cpp:425] conv4 <- conv3
I0925 21:56:54.555951 12698 net.cpp:399] conv4 -> conv4
I0925 21:56:54.582736 12698 net.cpp:141] Setting up conv4
I0925 21:56:54.582806 12698 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0925 21:56:54.582818 12698 net.cpp:156] Memory required for data: 61192760
I0925 21:56:54.582842 12698 layer_factory.hpp:77] Creating layer relu4
I0925 21:56:54.582887 12698 net.cpp:91] Creating Layer relu4
I0925 21:56:54.582901 12698 net.cpp:425] relu4 <- conv4
I0925 21:56:54.582914 12698 net.cpp:386] relu4 -> conv4 (in-place)
I0925 21:56:54.584040 12698 net.cpp:141] Setting up relu4
I0925 21:56:54.584091 12698 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0925 21:56:54.584102 12698 net.cpp:156] Memory required for data: 63788600
I0925 21:56:54.584116 12698 layer_factory.hpp:77] Creating layer conv5
I0925 21:56:54.584151 12698 net.cpp:91] Creating Layer conv5
I0925 21:56:54.584162 12698 net.cpp:425] conv5 <- conv4
I0925 21:56:54.584244 12698 net.cpp:399] conv5 -> conv5
I0925 21:56:54.590925 12698 net.cpp:141] Setting up conv5
I0925 21:56:54.590977 12698 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0925 21:56:54.590986 12698 net.cpp:156] Memory required for data: 65519160
I0925 21:56:54.591015 12698 layer_factory.hpp:77] Creating layer relu5
I0925 21:56:54.591048 12698 net.cpp:91] Creating Layer relu5
I0925 21:56:54.591059 12698 net.cpp:425] relu5 <- conv5
I0925 21:56:54.591071 12698 net.cpp:386] relu5 -> conv5 (in-place)
I0925 21:56:54.591795 12698 net.cpp:141] Setting up relu5
I0925 21:56:54.591820 12698 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0925 21:56:54.591828 12698 net.cpp:156] Memory required for data: 67249720
I0925 21:56:54.591837 12698 layer_factory.hpp:77] Creating layer pool5
I0925 21:56:54.591858 12698 net.cpp:91] Creating Layer pool5
I0925 21:56:54.591868 12698 net.cpp:425] pool5 <- conv5
I0925 21:56:54.591881 12698 net.cpp:399] pool5 -> pool5
I0925 21:56:54.592011 12698 net.cpp:141] Setting up pool5
I0925 21:56:54.592028 12698 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0925 21:56:54.592037 12698 net.cpp:156] Memory required for data: 67618360
I0925 21:56:54.592047 12698 layer_factory.hpp:77] Creating layer fc6
I0925 21:56:54.592070 12698 net.cpp:91] Creating Layer fc6
I0925 21:56:54.592079 12698 net.cpp:425] fc6 <- pool5
I0925 21:56:54.592110 12698 net.cpp:399] fc6 -> fc6
I0925 21:56:54.740623 12718 net.cpp:141] Setting up predict
I0925 21:56:54.740680 12718 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 21:56:54.740689 12718 net.cpp:156] Memory required for data: 221084
I0925 21:56:54.740710 12718 layer_factory.hpp:77] Creating layer probs
I0925 21:56:54.740732 12718 net.cpp:91] Creating Layer probs
I0925 21:56:54.740741 12718 net.cpp:425] probs <- predict
I0925 21:56:54.740754 12718 net.cpp:399] probs -> probs
I0925 21:56:54.741168 12698 net.cpp:141] Setting up fc6
I0925 21:56:54.741219 12698 net.cpp:148] Top shape: 10 4096 (40960)
I0925 21:56:54.741228 12698 net.cpp:156] Memory required for data: 67782200
I0925 21:56:54.741253 12698 layer_factory.hpp:77] Creating layer relu6
I0925 21:56:54.741281 12698 net.cpp:91] Creating Layer relu6
I0925 21:56:54.741291 12698 net.cpp:425] relu6 <- fc6
I0925 21:56:54.741305 12698 net.cpp:386] relu6 -> fc6 (in-place)
I0925 21:56:54.742108 12718 net.cpp:141] Setting up probs
I0925 21:56:54.742127 12718 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 21:56:54.742132 12718 net.cpp:156] Memory required for data: 405756
I0925 21:56:54.742139 12718 net.cpp:219] probs does not need backward computation.
I0925 21:56:54.742147 12718 net.cpp:219] predict does not need backward computation.
I0925 21:56:54.742152 12718 net.cpp:219] lstm2 does not need backward computation.
I0925 21:56:54.742161 12718 net.cpp:219] concat does not need backward computation.
I0925 21:56:54.742167 12718 net.cpp:219] lstm1 does not need backward computation.
I0925 21:56:54.742174 12718 net.cpp:219] embedding does not need backward computation.
I0925 21:56:54.742187 12718 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0925 21:56:54.742194 12718 net.cpp:219] reshape_frames does not need backward computation.
I0925 21:56:54.742200 12718 net.cpp:219] embed_encoder does not need backward computation.
I0925 21:56:54.742207 12718 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0925 21:56:54.742213 12718 net.cpp:219] input does not need backward computation.
I0925 21:56:54.742218 12718 net.cpp:261] This network produces output probs
I0925 21:56:54.742235 12718 net.cpp:274] Network initialization done.
I0925 21:56:54.746843 12698 net.cpp:141] Setting up relu6
I0925 21:56:54.746901 12698 net.cpp:148] Top shape: 10 4096 (40960)
I0925 21:56:54.746912 12698 net.cpp:156] Memory required for data: 67946040
I0925 21:56:54.746924 12698 layer_factory.hpp:77] Creating layer drop6
I0925 21:56:54.746947 12698 net.cpp:91] Creating Layer drop6
I0925 21:56:54.746958 12698 net.cpp:425] drop6 <- fc6
I0925 21:56:54.746973 12698 net.cpp:386] drop6 -> fc6 (in-place)
I0925 21:56:54.747371 12698 net.cpp:141] Setting up drop6
I0925 21:56:54.747390 12698 net.cpp:148] Top shape: 10 4096 (40960)
I0925 21:56:54.747397 12698 net.cpp:156] Memory required for data: 68109880
I0925 21:56:54.747406 12698 layer_factory.hpp:77] Creating layer fc7
I0925 21:56:54.747426 12698 net.cpp:91] Creating Layer fc7
I0925 21:56:54.747433 12698 net.cpp:425] fc7 <- fc6
I0925 21:56:54.747445 12698 net.cpp:399] fc7 -> fc7
I0925 21:56:54.811059 12698 net.cpp:141] Setting up fc7
I0925 21:56:54.811121 12698 net.cpp:148] Top shape: 10 4096 (40960)
I0925 21:56:54.811158 12698 net.cpp:156] Memory required for data: 68273720
I0925 21:56:54.811182 12698 layer_factory.hpp:77] Creating layer relu7
I0925 21:56:54.811724 12698 net.cpp:91] Creating Layer relu7
I0925 21:56:54.811741 12698 net.cpp:425] relu7 <- fc7
I0925 21:56:54.811756 12698 net.cpp:386] relu7 -> fc7 (in-place)
I0925 21:56:54.815282 12698 net.cpp:141] Setting up relu7
I0925 21:56:54.815338 12698 net.cpp:148] Top shape: 10 4096 (40960)
I0925 21:56:54.815349 12698 net.cpp:156] Memory required for data: 68437560
I0925 21:56:54.815363 12698 layer_factory.hpp:77] Creating layer drop7
I0925 21:56:54.815392 12698 net.cpp:91] Creating Layer drop7
I0925 21:56:54.815404 12698 net.cpp:425] drop7 <- fc7
I0925 21:56:54.815419 12698 net.cpp:386] drop7 -> fc7 (in-place)
I0925 21:56:54.817885 12698 net.cpp:141] Setting up drop7
I0925 21:56:54.817914 12698 net.cpp:148] Top shape: 10 4096 (40960)
I0925 21:56:54.817924 12698 net.cpp:156] Memory required for data: 68601400
I0925 21:56:54.817932 12698 layer_factory.hpp:77] Creating layer fc8
I0925 21:56:54.817955 12698 net.cpp:91] Creating Layer fc8
I0925 21:56:54.817965 12698 net.cpp:425] fc8 <- fc7
I0925 21:56:54.817981 12698 net.cpp:399] fc8 -> fc8
I0925 21:56:54.836748 12698 net.cpp:141] Setting up fc8
I0925 21:56:54.836810 12698 net.cpp:148] Top shape: 10 1000 (10000)
I0925 21:56:54.836822 12698 net.cpp:156] Memory required for data: 68641400
I0925 21:56:54.836841 12698 layer_factory.hpp:77] Creating layer prob
I0925 21:56:54.836859 12698 net.cpp:91] Creating Layer prob
I0925 21:56:54.836868 12698 net.cpp:425] prob <- fc8
I0925 21:56:54.837348 12698 net.cpp:399] prob -> prob
I0925 21:56:54.838851 12698 net.cpp:141] Setting up prob
I0925 21:56:54.838898 12698 net.cpp:148] Top shape: 10 1000 (10000)
I0925 21:56:54.838910 12698 net.cpp:156] Memory required for data: 68681400
I0925 21:56:54.838925 12698 net.cpp:219] prob does not need backward computation.
I0925 21:56:54.838937 12698 net.cpp:219] fc8 does not need backward computation.
I0925 21:56:54.838948 12698 net.cpp:219] drop7 does not need backward computation.
I0925 21:56:54.838956 12698 net.cpp:219] relu7 does not need backward computation.
I0925 21:56:54.838965 12698 net.cpp:219] fc7 does not need backward computation.
I0925 21:56:54.838975 12698 net.cpp:219] drop6 does not need backward computation.
I0925 21:56:54.838984 12698 net.cpp:219] relu6 does not need backward computation.
I0925 21:56:54.838994 12698 net.cpp:219] fc6 does not need backward computation.
I0925 21:56:54.839004 12698 net.cpp:219] pool5 does not need backward computation.
I0925 21:56:54.839013 12698 net.cpp:219] relu5 does not need backward computation.
I0925 21:56:54.839022 12698 net.cpp:219] conv5 does not need backward computation.
I0925 21:56:54.839032 12698 net.cpp:219] relu4 does not need backward computation.
I0925 21:56:54.839042 12698 net.cpp:219] conv4 does not need backward computation.
I0925 21:56:54.839051 12698 net.cpp:219] relu3 does not need backward computation.
I0925 21:56:54.839061 12698 net.cpp:219] conv3 does not need backward computation.
I0925 21:56:54.839071 12698 net.cpp:219] norm2 does not need backward computation.
I0925 21:56:54.839079 12698 net.cpp:219] pool2 does not need backward computation.
I0925 21:56:54.839087 12698 net.cpp:219] relu2 does not need backward computation.
I0925 21:56:54.839092 12698 net.cpp:219] conv2 does not need backward computation.
I0925 21:56:54.839097 12698 net.cpp:219] norm1 does not need backward computation.
I0925 21:56:54.839103 12698 net.cpp:219] pool1 does not need backward computation.
I0925 21:56:54.839109 12698 net.cpp:219] relu1 does not need backward computation.
I0925 21:56:54.839114 12698 net.cpp:219] conv1 does not need backward computation.
I0925 21:56:54.839119 12698 net.cpp:219] data does not need backward computation.
I0925 21:56:54.839124 12698 net.cpp:261] This network produces output prob
I0925 21:56:54.839489 12698 net.cpp:274] Network initialization done.
I0925 21:56:54.931782 12690 net.cpp:141] Setting up predict
I0925 21:56:54.931843 12690 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 21:56:54.931851 12690 net.cpp:156] Memory required for data: 221084
I0925 21:56:54.931866 12690 layer_factory.hpp:77] Creating layer probs
I0925 21:56:54.931890 12690 net.cpp:91] Creating Layer probs
I0925 21:56:54.931898 12690 net.cpp:425] probs <- predict
I0925 21:56:54.931908 12690 net.cpp:399] probs -> probs
I0925 21:56:54.932420 12690 net.cpp:141] Setting up probs
I0925 21:56:54.932431 12690 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 21:56:54.932435 12690 net.cpp:156] Memory required for data: 405756
I0925 21:56:54.932441 12690 net.cpp:219] probs does not need backward computation.
I0925 21:56:54.932446 12690 net.cpp:219] predict does not need backward computation.
I0925 21:56:54.932452 12690 net.cpp:219] lstm2 does not need backward computation.
I0925 21:56:54.932457 12690 net.cpp:219] concat does not need backward computation.
I0925 21:56:54.932464 12690 net.cpp:219] lstm1 does not need backward computation.
I0925 21:56:54.932471 12690 net.cpp:219] embedding does not need backward computation.
I0925 21:56:54.932476 12690 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0925 21:56:54.932481 12690 net.cpp:219] reshape_frames does not need backward computation.
I0925 21:56:54.932484 12690 net.cpp:219] embed_encoder does not need backward computation.
I0925 21:56:54.932489 12690 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0925 21:56:54.932495 12690 net.cpp:219] input does not need backward computation.
I0925 21:56:54.932499 12690 net.cpp:261] This network produces output probs
I0925 21:56:54.932513 12690 net.cpp:274] Network initialization done.
I0925 21:56:54.959611 12694 net.cpp:141] Setting up predict
I0925 21:56:54.959669 12694 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 21:56:54.959677 12694 net.cpp:156] Memory required for data: 221084
I0925 21:56:54.959694 12694 layer_factory.hpp:77] Creating layer probs
I0925 21:56:54.959712 12694 net.cpp:91] Creating Layer probs
I0925 21:56:54.959720 12694 net.cpp:425] probs <- predict
I0925 21:56:54.959731 12694 net.cpp:399] probs -> probs
I0925 21:56:54.962045 12694 net.cpp:141] Setting up probs
I0925 21:56:54.962105 12694 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 21:56:54.962112 12694 net.cpp:156] Memory required for data: 405756
I0925 21:56:54.962122 12694 net.cpp:219] probs does not need backward computation.
I0925 21:56:54.962131 12694 net.cpp:219] predict does not need backward computation.
I0925 21:56:54.962137 12694 net.cpp:219] lstm2 does not need backward computation.
I0925 21:56:54.962144 12694 net.cpp:219] concat does not need backward computation.
I0925 21:56:54.962152 12694 net.cpp:219] lstm1 does not need backward computation.
I0925 21:56:54.962162 12694 net.cpp:219] embedding does not need backward computation.
I0925 21:56:54.962167 12694 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0925 21:56:54.962174 12694 net.cpp:219] reshape_frames does not need backward computation.
I0925 21:56:54.962180 12694 net.cpp:219] embed_encoder does not need backward computation.
I0925 21:56:54.962185 12694 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0925 21:56:54.962193 12694 net.cpp:219] input does not need backward computation.
I0925 21:56:54.962198 12694 net.cpp:261] This network produces output probs
I0925 21:56:54.962216 12694 net.cpp:274] Network initialization done.
I0925 21:56:55.004808 12712 net.cpp:752] Ignoring source layer data
I0925 21:56:55.004855 12712 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0925 21:56:55.004863 12712 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0925 21:56:55.024197 12700 net.cpp:752] Ignoring source layer data
I0925 21:56:55.024796 12700 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0925 21:56:55.024948 12700 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0925 21:56:55.099185 12712 net.cpp:752] Ignoring source layer cross_entropy_loss
I0925 21:56:55.126657 12700 net.cpp:752] Ignoring source layer cross_entropy_loss
I0925 21:56:55.168437 12698 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /home/peifeng/work/run/storm102/data/workers/ef478da2-4fe4-4b49-abee-548938eadce6/tmp/cvld3031443149427038578/bvlc_reference_caffenet.caffemodel
I0925 21:56:55.168481 12698 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0925 21:56:55.168488 12698 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0925 21:56:55.168491 12698 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /home/peifeng/work/run/storm102/data/workers/ef478da2-4fe4-4b49-abee-548938eadce6/tmp/cvld3031443149427038578/bvlc_reference_caffenet.caffemodel
I0925 21:56:55.225625 12718 net.cpp:752] Ignoring source layer data
I0925 21:56:55.225669 12718 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0925 21:56:55.225678 12718 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0925 21:56:55.329206 12690 net.cpp:752] Ignoring source layer data
I0925 21:56:55.329680 12690 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0925 21:56:55.329807 12690 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0925 21:56:55.355268 12718 net.cpp:752] Ignoring source layer cross_entropy_loss
I0925 21:56:55.363095 12694 net.cpp:752] Ignoring source layer data
I0925 21:56:55.363142 12694 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0925 21:56:55.363152 12694 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0925 21:56:55.407094 12690 net.cpp:752] Ignoring source layer cross_entropy_loss
I0925 21:56:55.438716 12694 net.cpp:752] Ignoring source layer cross_entropy_loss
I0925 21:56:55.616449 12698 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0925 21:56:55.667098 12698 net.cpp:752] Ignoring source layer loss
Loading the model + trained: 35868.7ms
Using cv::Size and some other stuff: 0.323ms
Loading the mean file: 252622ms
TIMERTIMER 369170363
TIMERTIMER 452832710
TIMERTIMER 504355273
TIMERTIMER 400843826
TIMERTIMER 395090996
TIMERTIMER 245065750
TIMERTIMER 397108627
TIMERTIMER 452837953
TIMERTIMER 397330310
TIMERTIMER 456990144
TIMERTIMER 268358692
TIMERTIMER 424339716
TIMERTIMER 389324267
TIMERTIMER 213725487
TIMERTIMER 209882415
TIMERTIMER 208049030
TIMERTIMER 227532491
TIMERTIMER 204319968
TIMERTIMER 212339010
TIMERTIMER 215168316
TIMERTIMER 203824556
TIMERTIMER 229256086
TIMERTIMER 221381058
TIMERTIMER 234704693
TIMERTIMER 215944813
TIMERTIMER 232295386
TIMERTIMER 226862965
TIMERTIMER 238317554
TIMERTIMER 244078349
TIMERTIMER 243298396
TIMERTIMER 249939070
TIMERTIMER 259320853
TIMERTIMER 241902215
TIMERTIMER 242248283
TIMERTIMER 241685063
TIMERTIMER 218718931
TIMERTIMER 245149580
TIMERTIMER 240705296
TIMERTIMER 239521994
TIMERTIMER 241002363
TIMERTIMER 244241049
TIMERTIMER 237417291
TIMERTIMER 240932395
TIMERTIMER 239661456
TIMERTIMER 251055594
TIMERTIMER 237461944
TIMERTIMER 245646031
TIMERTIMER 241651572
TIMERTIMER 234208074
TIMERTIMER 214732642
TIMERTIMER 241091215
TIMERTIMER 233972731
TIMERTIMER 240614402
TIMERTIMER 237218979
TIMERTIMER 243857123
TIMERTIMER 244752808
