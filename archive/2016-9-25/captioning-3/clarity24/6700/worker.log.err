SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/peifeng/tools/storm102/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/peifeng/work/run/storm102/data/supervisor/stormdist/captioning-1-1474850297/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /home/peifeng/work/run/storm102/data/workers/3fbab32d-6305-4e02-a83b-b6209a395c21/tmp/cvld6108081456596242107/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0925 20:39:29.093176  1236 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/3fbab32d-6305-4e02-a83b-b6209a395c21/tmp/cvld6108081456596242107/s2vt.words_to_preds.prototxt
I0925 20:39:29.093317  1236 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0925 20:39:29.093327  1236 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0925 20:39:29.093528  1242 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0925 20:39:29.093547  1236 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0925 20:39:29.093658  1242 layer_factory.hpp:77] Creating layer data
I0925 20:39:29.093670  1236 layer_factory.hpp:77] Creating layer input
I0925 20:39:29.093688  1236 net.cpp:91] Creating Layer input
I0925 20:39:29.093688  1242 net.cpp:91] Creating Layer data
I0925 20:39:29.093699  1242 net.cpp:399] data -> data
I0925 20:39:29.093699  1236 net.cpp:399] input -> frames_fc7
I0925 20:39:29.093751  1236 net.cpp:399] input -> cont_sentence
I0925 20:39:29.093765  1236 net.cpp:399] input -> input_sentence
I0925 20:39:29.093776  1236 net.cpp:399] input -> stage_indicator
I0925 20:39:29.678549  1242 net.cpp:141] Setting up data
I0925 20:39:29.678639  1242 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0925 20:39:29.678648  1242 net.cpp:156] Memory required for data: 6183480
I0925 20:39:29.678673  1242 layer_factory.hpp:77] Creating layer conv1
I0925 20:39:29.678668  1236 net.cpp:141] Setting up input
I0925 20:39:29.678690  1236 net.cpp:148] Top shape: 1 4096 (4096)
I0925 20:39:29.678697  1236 net.cpp:148] Top shape: 1 1 (1)
I0925 20:39:29.678704  1236 net.cpp:148] Top shape: 1 1 (1)
I0925 20:39:29.678709  1236 net.cpp:148] Top shape: 1 1 (1)
I0925 20:39:29.678710  1242 net.cpp:91] Creating Layer conv1
I0925 20:39:29.678714  1236 net.cpp:156] Memory required for data: 16396
I0925 20:39:29.678720  1236 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0925 20:39:29.678721  1242 net.cpp:425] conv1 <- data
I0925 20:39:29.678738  1242 net.cpp:399] conv1 -> conv1
I0925 20:39:29.678743  1236 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0925 20:39:29.678750  1236 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0925 20:39:29.678778  1236 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0925 20:39:29.678791  1236 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0925 20:39:29.678856  1236 net.cpp:141] Setting up cont_sentence_input_1_split
I0925 20:39:29.678867  1236 net.cpp:148] Top shape: 1 1 (1)
I0925 20:39:29.678874  1236 net.cpp:148] Top shape: 1 1 (1)
I0925 20:39:29.678879  1236 net.cpp:156] Memory required for data: 16404
I0925 20:39:29.678882  1236 layer_factory.hpp:77] Creating layer embed_encoder
I0925 20:39:29.678900  1236 net.cpp:91] Creating Layer embed_encoder
I0925 20:39:29.678906  1236 net.cpp:425] embed_encoder <- frames_fc7
I0925 20:39:29.678915  1236 net.cpp:399] embed_encoder -> embedded_in_frames
I0925 20:39:29.712469  1236 net.cpp:141] Setting up embed_encoder
I0925 20:39:29.712523  1236 net.cpp:148] Top shape: 1 500 (500)
I0925 20:39:29.712530  1236 net.cpp:156] Memory required for data: 18404
I0925 20:39:29.712563  1236 layer_factory.hpp:77] Creating layer reshape_frames
I0925 20:39:29.712594  1236 net.cpp:91] Creating Layer reshape_frames
I0925 20:39:29.712604  1236 net.cpp:425] reshape_frames <- embedded_in_frames
I0925 20:39:29.712615  1236 net.cpp:399] reshape_frames -> embedded_input_frames
I0925 20:39:29.712676  1236 net.cpp:141] Setting up reshape_frames
I0925 20:39:29.712684  1236 net.cpp:148] Top shape: 1 1 500 (500)
I0925 20:39:29.712689  1236 net.cpp:156] Memory required for data: 20404
I0925 20:39:29.712694  1236 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0925 20:39:29.712708  1236 net.cpp:91] Creating Layer reshape_stage_indicator
I0925 20:39:29.712714  1236 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0925 20:39:29.712723  1236 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0925 20:39:29.712762  1236 net.cpp:141] Setting up reshape_stage_indicator
I0925 20:39:29.712772  1236 net.cpp:148] Top shape: 1 1 1 (1)
I0925 20:39:29.712776  1236 net.cpp:156] Memory required for data: 20408
I0925 20:39:29.712781  1236 layer_factory.hpp:77] Creating layer embedding
I0925 20:39:29.712795  1236 net.cpp:91] Creating Layer embedding
I0925 20:39:29.712800  1236 net.cpp:425] embedding <- input_sentence
I0925 20:39:29.712811  1236 net.cpp:399] embedding -> embedded_input_sentence
I0925 20:39:29.931957  1242 net.cpp:141] Setting up conv1
I0925 20:39:29.932024  1242 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0925 20:39:29.932034  1242 net.cpp:156] Memory required for data: 17799480
I0925 20:39:29.932065  1242 layer_factory.hpp:77] Creating layer relu1
I0925 20:39:29.932091  1242 net.cpp:91] Creating Layer relu1
I0925 20:39:29.932106  1242 net.cpp:425] relu1 <- conv1
I0925 20:39:29.932119  1242 net.cpp:386] relu1 -> conv1 (in-place)
I0925 20:39:29.932698  1242 net.cpp:141] Setting up relu1
I0925 20:39:29.932719  1242 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0925 20:39:29.932729  1242 net.cpp:156] Memory required for data: 29415480
I0925 20:39:29.932739  1242 layer_factory.hpp:77] Creating layer pool1
I0925 20:39:29.932760  1242 net.cpp:91] Creating Layer pool1
I0925 20:39:29.932771  1242 net.cpp:425] pool1 <- conv1
I0925 20:39:29.932785  1242 net.cpp:399] pool1 -> pool1
I0925 20:39:29.932891  1242 net.cpp:141] Setting up pool1
I0925 20:39:29.932910  1242 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0925 20:39:29.932919  1242 net.cpp:156] Memory required for data: 32214840
I0925 20:39:29.932929  1242 layer_factory.hpp:77] Creating layer norm1
I0925 20:39:29.932955  1242 net.cpp:91] Creating Layer norm1
I0925 20:39:29.932966  1242 net.cpp:425] norm1 <- pool1
I0925 20:39:29.932981  1242 net.cpp:399] norm1 -> norm1
I0925 20:39:29.933452  1242 net.cpp:141] Setting up norm1
I0925 20:39:29.933475  1242 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0925 20:39:29.933485  1242 net.cpp:156] Memory required for data: 35014200
I0925 20:39:29.933496  1242 layer_factory.hpp:77] Creating layer conv2
I0925 20:39:29.933521  1242 net.cpp:91] Creating Layer conv2
I0925 20:39:29.933533  1242 net.cpp:425] conv2 <- norm1
I0925 20:39:29.933549  1242 net.cpp:399] conv2 -> conv2
I0925 20:39:29.938788  1242 net.cpp:141] Setting up conv2
I0925 20:39:29.938817  1242 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0925 20:39:29.938827  1242 net.cpp:156] Memory required for data: 42479160
I0925 20:39:29.938849  1242 layer_factory.hpp:77] Creating layer relu2
I0925 20:39:29.938872  1242 net.cpp:91] Creating Layer relu2
I0925 20:39:29.938884  1242 net.cpp:425] relu2 <- conv2
I0925 20:39:29.938899  1242 net.cpp:386] relu2 -> conv2 (in-place)
I0925 20:39:29.939594  1242 net.cpp:141] Setting up relu2
I0925 20:39:29.939616  1242 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0925 20:39:29.939627  1242 net.cpp:156] Memory required for data: 49944120
I0925 20:39:29.939638  1242 layer_factory.hpp:77] Creating layer pool2
I0925 20:39:29.939661  1242 net.cpp:91] Creating Layer pool2
I0925 20:39:29.939674  1242 net.cpp:425] pool2 <- conv2
I0925 20:39:29.939690  1242 net.cpp:399] pool2 -> pool2
I0925 20:39:29.939800  1242 net.cpp:141] Setting up pool2
I0925 20:39:29.939820  1242 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0925 20:39:29.939829  1242 net.cpp:156] Memory required for data: 51674680
I0925 20:39:29.939839  1242 layer_factory.hpp:77] Creating layer norm2
I0925 20:39:29.939862  1242 net.cpp:91] Creating Layer norm2
I0925 20:39:29.939873  1242 net.cpp:425] norm2 <- pool2
I0925 20:39:29.939888  1242 net.cpp:399] norm2 -> norm2
I0925 20:39:29.940403  1242 net.cpp:141] Setting up norm2
I0925 20:39:29.940423  1242 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0925 20:39:29.940431  1242 net.cpp:156] Memory required for data: 53405240
I0925 20:39:29.940440  1242 layer_factory.hpp:77] Creating layer conv3
I0925 20:39:29.940464  1242 net.cpp:91] Creating Layer conv3
I0925 20:39:29.940475  1242 net.cpp:425] conv3 <- norm2
I0925 20:39:29.940490  1242 net.cpp:399] conv3 -> conv3
I0925 20:39:29.945657  1242 net.cpp:141] Setting up conv3
I0925 20:39:29.945683  1242 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0925 20:39:29.945694  1242 net.cpp:156] Memory required for data: 56001080
I0925 20:39:29.945724  1242 layer_factory.hpp:77] Creating layer relu3
I0925 20:39:29.945741  1242 net.cpp:91] Creating Layer relu3
I0925 20:39:29.945752  1242 net.cpp:425] relu3 <- conv3
I0925 20:39:29.945765  1242 net.cpp:386] relu3 -> conv3 (in-place)
I0925 20:39:29.946220  1242 net.cpp:141] Setting up relu3
I0925 20:39:29.946244  1242 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0925 20:39:29.946254  1242 net.cpp:156] Memory required for data: 58596920
I0925 20:39:29.946264  1242 layer_factory.hpp:77] Creating layer conv4
I0925 20:39:29.946295  1242 net.cpp:91] Creating Layer conv4
I0925 20:39:29.946307  1242 net.cpp:425] conv4 <- conv3
I0925 20:39:29.946324  1242 net.cpp:399] conv4 -> conv4
I0925 20:39:29.951558  1242 net.cpp:141] Setting up conv4
I0925 20:39:29.951586  1242 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0925 20:39:29.951597  1242 net.cpp:156] Memory required for data: 61192760
I0925 20:39:29.951617  1242 layer_factory.hpp:77] Creating layer relu4
I0925 20:39:29.951632  1242 net.cpp:91] Creating Layer relu4
I0925 20:39:29.951642  1242 net.cpp:425] relu4 <- conv4
I0925 20:39:29.951656  1242 net.cpp:386] relu4 -> conv4 (in-place)
I0925 20:39:29.952339  1242 net.cpp:141] Setting up relu4
I0925 20:39:29.952363  1242 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0925 20:39:29.952373  1242 net.cpp:156] Memory required for data: 63788600
I0925 20:39:29.952383  1242 layer_factory.hpp:77] Creating layer conv5
I0925 20:39:29.952404  1242 net.cpp:91] Creating Layer conv5
I0925 20:39:29.952416  1242 net.cpp:425] conv5 <- conv4
I0925 20:39:29.952440  1242 net.cpp:399] conv5 -> conv5
I0925 20:39:29.956982  1236 net.cpp:141] Setting up embedding
I0925 20:39:29.957029  1236 net.cpp:148] Top shape: 1 1 500 (500)
I0925 20:39:29.957036  1236 net.cpp:156] Memory required for data: 22408
I0925 20:39:29.957054  1236 layer_factory.hpp:77] Creating layer lstm1
I0925 20:39:29.957087  1236 net.cpp:91] Creating Layer lstm1
I0925 20:39:29.957094  1236 net.cpp:425] lstm1 <- embedded_input_frames
I0925 20:39:29.957103  1236 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0925 20:39:29.957132  1236 net.cpp:399] lstm1 -> lstm1
I0925 20:39:29.957207  1236 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 20:39:29.957514  1242 net.cpp:141] Setting up conv5
I0925 20:39:29.957537  1242 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0925 20:39:29.957543  1242 net.cpp:156] Memory required for data: 65519160
I0925 20:39:29.957561  1242 layer_factory.hpp:77] Creating layer relu5
I0925 20:39:29.957576  1242 net.cpp:91] Creating Layer relu5
I0925 20:39:29.957583  1242 net.cpp:425] relu5 <- conv5
I0925 20:39:29.957590  1242 net.cpp:386] relu5 -> conv5 (in-place)
I0925 20:39:29.957623  1236 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 20:39:29.957731  1236 layer_factory.hpp:77] Creating layer lstm1_
I0925 20:39:29.957744  1236 net.cpp:91] Creating Layer lstm1_
I0925 20:39:29.957751  1236 net.cpp:399] lstm1_ -> x
I0925 20:39:29.957764  1236 net.cpp:399] lstm1_ -> cont
I0925 20:39:29.958039  1236 net.cpp:141] Setting up lstm1_
I0925 20:39:29.958051  1236 net.cpp:148] Top shape: 1 1 500 (500)
I0925 20:39:29.958058  1236 net.cpp:148] Top shape: 1 1 (1)
I0925 20:39:29.958062  1236 net.cpp:156] Memory required for data: 2004
I0925 20:39:29.958067  1236 layer_factory.hpp:77] Creating layer lstm1_
I0925 20:39:29.958077  1236 net.cpp:91] Creating Layer lstm1_
I0925 20:39:29.958089  1236 net.cpp:399] lstm1_ -> c_0
I0925 20:39:29.958101  1236 net.cpp:399] lstm1_ -> h_0
I0925 20:39:29.958147  1242 net.cpp:141] Setting up relu5
I0925 20:39:29.958161  1242 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0925 20:39:29.958166  1242 net.cpp:156] Memory required for data: 67249720
I0925 20:39:29.958173  1242 layer_factory.hpp:77] Creating layer pool5
I0925 20:39:29.958189  1242 net.cpp:91] Creating Layer pool5
I0925 20:39:29.958194  1242 net.cpp:425] pool5 <- conv5
I0925 20:39:29.958205  1242 net.cpp:399] pool5 -> pool5
I0925 20:39:29.958205  1236 net.cpp:141] Setting up lstm1_
I0925 20:39:29.958219  1236 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:39:29.958225  1236 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:39:29.958230  1236 net.cpp:156] Memory required for data: 10004
I0925 20:39:29.958235  1236 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0925 20:39:29.958245  1236 net.cpp:91] Creating Layer lstm1_cont_slice
I0925 20:39:29.958250  1236 net.cpp:425] lstm1_cont_slice <- cont
I0925 20:39:29.958261  1236 net.cpp:399] lstm1_cont_slice -> cont_1
I0925 20:39:29.958290  1242 net.cpp:141] Setting up pool5
I0925 20:39:29.958302  1242 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0925 20:39:29.958307  1242 net.cpp:156] Memory required for data: 67618360
I0925 20:39:29.958312  1242 layer_factory.hpp:77] Creating layer fc6
I0925 20:39:29.958329  1242 net.cpp:91] Creating Layer fc6
I0925 20:39:29.958330  1236 net.cpp:141] Setting up lstm1_cont_slice
I0925 20:39:29.958335  1242 net.cpp:425] fc6 <- pool5
I0925 20:39:29.958343  1236 net.cpp:148] Top shape: 1 1 (1)
I0925 20:39:29.958345  1242 net.cpp:399] fc6 -> fc6
I0925 20:39:29.958348  1236 net.cpp:156] Memory required for data: 10008
I0925 20:39:29.958353  1236 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0925 20:39:29.958367  1236 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0925 20:39:29.958374  1236 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0925 20:39:29.958380  1236 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0925 20:39:29.958392  1236 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0925 20:39:30.033483  1236 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0925 20:39:30.033509  1236 net.cpp:148] Top shape: 1 1 (1)
I0925 20:39:30.033515  1236 net.cpp:148] Top shape: 1 1 (1)
I0925 20:39:30.033520  1236 net.cpp:156] Memory required for data: 10016
I0925 20:39:30.033525  1236 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0925 20:39:30.033540  1236 net.cpp:91] Creating Layer lstm1_x_transform
I0925 20:39:30.033545  1236 net.cpp:425] lstm1_x_transform <- x
I0925 20:39:30.033555  1236 net.cpp:399] lstm1_x_transform -> W_xc_x
I0925 20:39:30.065325  1236 net.cpp:141] Setting up lstm1_x_transform
I0925 20:39:30.065383  1236 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 20:39:30.065392  1236 net.cpp:156] Memory required for data: 26016
I0925 20:39:30.065424  1236 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0925 20:39:30.065446  1236 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0925 20:39:30.065455  1236 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0925 20:39:30.065469  1236 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0925 20:39:30.065534  1236 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0925 20:39:30.065548  1236 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 20:39:30.065554  1236 net.cpp:156] Memory required for data: 42016
I0925 20:39:30.065562  1236 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0925 20:39:30.065583  1236 net.cpp:91] Creating Layer lstm1_h_conted_0
I0925 20:39:30.065592  1236 net.cpp:425] lstm1_h_conted_0 <- h_0
I0925 20:39:30.065600  1236 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0925 20:39:30.065611  1236 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0925 20:39:30.065747  1236 net.cpp:141] Setting up lstm1_h_conted_0
I0925 20:39:30.065762  1236 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:39:30.065768  1236 net.cpp:156] Memory required for data: 46016
I0925 20:39:30.065774  1236 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0925 20:39:30.065798  1236 net.cpp:91] Creating Layer lstm1_transform_1
I0925 20:39:30.065805  1236 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0925 20:39:30.065816  1236 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0925 20:39:30.075398  1242 net.cpp:141] Setting up fc6
I0925 20:39:30.075450  1242 net.cpp:148] Top shape: 10 4096 (40960)
I0925 20:39:30.075458  1242 net.cpp:156] Memory required for data: 67782200
I0925 20:39:30.075472  1242 layer_factory.hpp:77] Creating layer relu6
I0925 20:39:30.075489  1242 net.cpp:91] Creating Layer relu6
I0925 20:39:30.075497  1242 net.cpp:425] relu6 <- fc6
I0925 20:39:30.075508  1242 net.cpp:386] relu6 -> fc6 (in-place)
I0925 20:39:30.075891  1242 net.cpp:141] Setting up relu6
I0925 20:39:30.075903  1242 net.cpp:148] Top shape: 10 4096 (40960)
I0925 20:39:30.075908  1242 net.cpp:156] Memory required for data: 67946040
I0925 20:39:30.075913  1242 layer_factory.hpp:77] Creating layer drop6
I0925 20:39:30.075935  1242 net.cpp:91] Creating Layer drop6
I0925 20:39:30.075940  1242 net.cpp:425] drop6 <- fc6
I0925 20:39:30.075953  1242 net.cpp:386] drop6 -> fc6 (in-place)
I0925 20:39:30.076007  1242 net.cpp:141] Setting up drop6
I0925 20:39:30.076016  1242 net.cpp:148] Top shape: 10 4096 (40960)
I0925 20:39:30.076021  1242 net.cpp:156] Memory required for data: 68109880
I0925 20:39:30.076026  1242 layer_factory.hpp:77] Creating layer fc7
I0925 20:39:30.076037  1242 net.cpp:91] Creating Layer fc7
I0925 20:39:30.076041  1242 net.cpp:425] fc7 <- fc6
I0925 20:39:30.076048  1242 net.cpp:399] fc7 -> fc7
I0925 20:39:30.109817  1236 net.cpp:141] Setting up lstm1_transform_1
I0925 20:39:30.109875  1236 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 20:39:30.109881  1236 net.cpp:156] Memory required for data: 62016
I0925 20:39:30.109905  1236 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0925 20:39:30.109935  1236 net.cpp:91] Creating Layer lstm1_gate_input_1
I0925 20:39:30.109942  1236 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0925 20:39:30.109951  1236 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0925 20:39:30.109961  1236 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0925 20:39:30.110036  1236 net.cpp:141] Setting up lstm1_gate_input_1
I0925 20:39:30.110046  1236 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 20:39:30.110051  1236 net.cpp:156] Memory required for data: 78016
I0925 20:39:30.110055  1236 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0925 20:39:30.110072  1236 net.cpp:91] Creating Layer lstm1_unit_1
I0925 20:39:30.110077  1236 net.cpp:425] lstm1_unit_1 <- c_0
I0925 20:39:30.110083  1236 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0925 20:39:30.110090  1236 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0925 20:39:30.110097  1236 net.cpp:399] lstm1_unit_1 -> c_1
I0925 20:39:30.110106  1236 net.cpp:399] lstm1_unit_1 -> h_1
I0925 20:39:30.110177  1236 net.cpp:141] Setting up lstm1_unit_1
I0925 20:39:30.110188  1236 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:39:30.110193  1236 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:39:30.110198  1236 net.cpp:156] Memory required for data: 86016
I0925 20:39:30.110203  1236 layer_factory.hpp:77] Creating layer lstm1_
I0925 20:39:30.110213  1236 net.cpp:91] Creating Layer lstm1_
I0925 20:39:30.110216  1236 net.cpp:425] lstm1_ <- c_1
I0925 20:39:30.110227  1236 net.cpp:399] lstm1_ -> c_T
I0925 20:39:30.110261  1236 net.cpp:141] Setting up lstm1_
I0925 20:39:30.110270  1236 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:39:30.110275  1236 net.cpp:156] Memory required for data: 90016
I0925 20:39:30.110280  1236 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0925 20:39:30.110290  1236 net.cpp:91] Creating Layer lstm1_h_concat
I0925 20:39:30.110294  1236 net.cpp:425] lstm1_h_concat <- h_1
I0925 20:39:30.110306  1236 net.cpp:399] lstm1_h_concat -> h
I0925 20:39:30.110344  1236 net.cpp:141] Setting up lstm1_h_concat
I0925 20:39:30.110352  1236 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:39:30.110357  1236 net.cpp:156] Memory required for data: 94016
I0925 20:39:30.110363  1236 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 20:39:30.110378  1236 net.cpp:91] Creating Layer h_pseudoloss
I0925 20:39:30.110383  1236 net.cpp:425] h_pseudoloss <- h
I0925 20:39:30.110391  1236 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 20:39:30.110496  1236 net.cpp:141] Setting up h_pseudoloss
I0925 20:39:30.110505  1236 net.cpp:148] Top shape: (1)
I0925 20:39:30.110510  1236 net.cpp:151]     with loss weight 1
I0925 20:39:30.110553  1236 net.cpp:156] Memory required for data: 94020
I0925 20:39:30.110559  1236 net.cpp:217] h_pseudoloss needs backward computation.
I0925 20:39:30.110564  1236 net.cpp:217] lstm1_h_concat needs backward computation.
I0925 20:39:30.110569  1236 net.cpp:219] lstm1_ does not need backward computation.
I0925 20:39:30.110574  1236 net.cpp:217] lstm1_unit_1 needs backward computation.
I0925 20:39:30.110580  1236 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0925 20:39:30.110585  1236 net.cpp:217] lstm1_transform_1 needs backward computation.
I0925 20:39:30.110590  1236 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0925 20:39:30.110608  1236 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0925 20:39:30.110615  1236 net.cpp:217] lstm1_x_transform needs backward computation.
I0925 20:39:30.110620  1236 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0925 20:39:30.110625  1236 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0925 20:39:30.110631  1236 net.cpp:219] lstm1_ does not need backward computation.
I0925 20:39:30.110635  1236 net.cpp:219] lstm1_ does not need backward computation.
I0925 20:39:30.110640  1236 net.cpp:261] This network produces output c_T
I0925 20:39:30.110644  1236 net.cpp:261] This network produces output h_pseudoloss
I0925 20:39:30.110666  1236 net.cpp:274] Network initialization done.
I0925 20:39:30.110731  1236 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 20:39:30.110738  1236 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 20:39:30.110743  1236 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 20:39:30.110862  1236 net.cpp:141] Setting up lstm1
I0925 20:39:30.110877  1236 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:39:30.110882  1236 net.cpp:156] Memory required for data: 26408
I0925 20:39:30.110896  1236 layer_factory.hpp:77] Creating layer concat
I0925 20:39:30.110906  1236 net.cpp:91] Creating Layer concat
I0925 20:39:30.110913  1236 net.cpp:425] concat <- lstm1
I0925 20:39:30.110919  1236 net.cpp:425] concat <- embedded_input_sentence
I0925 20:39:30.110925  1236 net.cpp:425] concat <- reshaped_stage_indicator
I0925 20:39:30.110932  1236 net.cpp:399] concat -> lstm1_video_sequence
I0925 20:39:30.110968  1236 net.cpp:141] Setting up concat
I0925 20:39:30.110978  1236 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 20:39:30.110982  1236 net.cpp:156] Memory required for data: 32412
I0925 20:39:30.110987  1236 layer_factory.hpp:77] Creating layer lstm2
I0925 20:39:30.111001  1236 net.cpp:91] Creating Layer lstm2
I0925 20:39:30.111006  1236 net.cpp:425] lstm2 <- lstm1_video_sequence
I0925 20:39:30.111012  1236 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0925 20:39:30.111021  1236 net.cpp:399] lstm2 -> lstm2
I0925 20:39:30.111032  1236 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 20:39:30.111317  1236 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 20:39:30.111416  1236 layer_factory.hpp:77] Creating layer lstm2_
I0925 20:39:30.111430  1236 net.cpp:91] Creating Layer lstm2_
I0925 20:39:30.111436  1236 net.cpp:399] lstm2_ -> x
I0925 20:39:30.111449  1236 net.cpp:399] lstm2_ -> cont
I0925 20:39:30.111505  1236 net.cpp:141] Setting up lstm2_
I0925 20:39:30.111515  1236 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 20:39:30.111521  1236 net.cpp:148] Top shape: 1 1 (1)
I0925 20:39:30.111526  1236 net.cpp:156] Memory required for data: 6008
I0925 20:39:30.111531  1236 layer_factory.hpp:77] Creating layer lstm2_
I0925 20:39:30.111544  1236 net.cpp:91] Creating Layer lstm2_
I0925 20:39:30.111552  1236 net.cpp:399] lstm2_ -> c_0
I0925 20:39:30.111562  1236 net.cpp:399] lstm2_ -> h_0
I0925 20:39:30.111614  1236 net.cpp:141] Setting up lstm2_
I0925 20:39:30.111624  1236 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:39:30.111630  1236 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:39:30.111634  1236 net.cpp:156] Memory required for data: 14008
I0925 20:39:30.111639  1236 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0925 20:39:30.111649  1236 net.cpp:91] Creating Layer lstm2_cont_slice
I0925 20:39:30.111654  1236 net.cpp:425] lstm2_cont_slice <- cont
I0925 20:39:30.111660  1236 net.cpp:399] lstm2_cont_slice -> cont_1
I0925 20:39:30.111699  1236 net.cpp:141] Setting up lstm2_cont_slice
I0925 20:39:30.111709  1236 net.cpp:148] Top shape: 1 1 (1)
I0925 20:39:30.111714  1236 net.cpp:156] Memory required for data: 14012
I0925 20:39:30.111718  1236 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0925 20:39:30.111726  1236 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0925 20:39:30.111731  1236 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0925 20:39:30.111739  1236 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0925 20:39:30.111747  1236 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0925 20:39:30.111799  1236 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0925 20:39:30.111809  1236 net.cpp:148] Top shape: 1 1 (1)
I0925 20:39:30.111814  1236 net.cpp:148] Top shape: 1 1 (1)
I0925 20:39:30.111819  1236 net.cpp:156] Memory required for data: 14020
I0925 20:39:30.111824  1236 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0925 20:39:30.111834  1236 net.cpp:91] Creating Layer lstm2_x_transform
I0925 20:39:30.111838  1236 net.cpp:425] lstm2_x_transform <- x
I0925 20:39:30.111850  1236 net.cpp:399] lstm2_x_transform -> W_xc_x
I0925 20:39:30.128484  1242 net.cpp:141] Setting up fc7
I0925 20:39:30.128532  1242 net.cpp:148] Top shape: 10 4096 (40960)
I0925 20:39:30.128538  1242 net.cpp:156] Memory required for data: 68273720
I0925 20:39:30.128553  1242 layer_factory.hpp:77] Creating layer relu7
I0925 20:39:30.128569  1242 net.cpp:91] Creating Layer relu7
I0925 20:39:30.128576  1242 net.cpp:425] relu7 <- fc7
I0925 20:39:30.128592  1242 net.cpp:386] relu7 -> fc7 (in-place)
I0925 20:39:30.129307  1242 net.cpp:141] Setting up relu7
I0925 20:39:30.129322  1242 net.cpp:148] Top shape: 10 4096 (40960)
I0925 20:39:30.129326  1242 net.cpp:156] Memory required for data: 68437560
I0925 20:39:30.129331  1242 layer_factory.hpp:77] Creating layer drop7
I0925 20:39:30.129343  1242 net.cpp:91] Creating Layer drop7
I0925 20:39:30.129348  1242 net.cpp:425] drop7 <- fc7
I0925 20:39:30.129359  1242 net.cpp:386] drop7 -> fc7 (in-place)
I0925 20:39:30.129401  1242 net.cpp:141] Setting up drop7
I0925 20:39:30.129410  1242 net.cpp:148] Top shape: 10 4096 (40960)
I0925 20:39:30.129415  1242 net.cpp:156] Memory required for data: 68601400
I0925 20:39:30.129420  1242 layer_factory.hpp:77] Creating layer fc8
I0925 20:39:30.129434  1242 net.cpp:91] Creating Layer fc8
I0925 20:39:30.129441  1242 net.cpp:425] fc8 <- fc7
I0925 20:39:30.129447  1242 net.cpp:399] fc8 -> fc8
I0925 20:39:30.141870  1242 net.cpp:141] Setting up fc8
I0925 20:39:30.141916  1242 net.cpp:148] Top shape: 10 1000 (10000)
I0925 20:39:30.141921  1242 net.cpp:156] Memory required for data: 68641400
I0925 20:39:30.141935  1242 layer_factory.hpp:77] Creating layer prob
I0925 20:39:30.141952  1242 net.cpp:91] Creating Layer prob
I0925 20:39:30.141960  1242 net.cpp:425] prob <- fc8
I0925 20:39:30.141976  1242 net.cpp:399] prob -> prob
I0925 20:39:30.142438  1242 net.cpp:141] Setting up prob
I0925 20:39:30.142452  1242 net.cpp:148] Top shape: 10 1000 (10000)
I0925 20:39:30.142457  1242 net.cpp:156] Memory required for data: 68681400
I0925 20:39:30.142462  1242 net.cpp:219] prob does not need backward computation.
I0925 20:39:30.142467  1242 net.cpp:219] fc8 does not need backward computation.
I0925 20:39:30.142472  1242 net.cpp:219] drop7 does not need backward computation.
I0925 20:39:30.142477  1242 net.cpp:219] relu7 does not need backward computation.
I0925 20:39:30.142482  1242 net.cpp:219] fc7 does not need backward computation.
I0925 20:39:30.142487  1242 net.cpp:219] drop6 does not need backward computation.
I0925 20:39:30.142491  1242 net.cpp:219] relu6 does not need backward computation.
I0925 20:39:30.142496  1242 net.cpp:219] fc6 does not need backward computation.
I0925 20:39:30.142501  1242 net.cpp:219] pool5 does not need backward computation.
I0925 20:39:30.142505  1242 net.cpp:219] relu5 does not need backward computation.
I0925 20:39:30.142510  1242 net.cpp:219] conv5 does not need backward computation.
I0925 20:39:30.142515  1242 net.cpp:219] relu4 does not need backward computation.
I0925 20:39:30.142519  1242 net.cpp:219] conv4 does not need backward computation.
I0925 20:39:30.142524  1242 net.cpp:219] relu3 does not need backward computation.
I0925 20:39:30.142529  1242 net.cpp:219] conv3 does not need backward computation.
I0925 20:39:30.142534  1242 net.cpp:219] norm2 does not need backward computation.
I0925 20:39:30.142539  1242 net.cpp:219] pool2 does not need backward computation.
I0925 20:39:30.142544  1242 net.cpp:219] relu2 does not need backward computation.
I0925 20:39:30.142549  1242 net.cpp:219] conv2 does not need backward computation.
I0925 20:39:30.142554  1242 net.cpp:219] norm1 does not need backward computation.
I0925 20:39:30.142559  1242 net.cpp:219] pool1 does not need backward computation.
I0925 20:39:30.142563  1242 net.cpp:219] relu1 does not need backward computation.
I0925 20:39:30.142567  1242 net.cpp:219] conv1 does not need backward computation.
I0925 20:39:30.142572  1242 net.cpp:219] data does not need backward computation.
I0925 20:39:30.142576  1242 net.cpp:261] This network produces output prob
I0925 20:39:30.142613  1242 net.cpp:274] Network initialization done.
I0925 20:39:30.175587  1236 net.cpp:141] Setting up lstm2_x_transform
I0925 20:39:30.175642  1236 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 20:39:30.175649  1236 net.cpp:156] Memory required for data: 30020
I0925 20:39:30.175673  1236 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0925 20:39:30.175690  1236 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0925 20:39:30.175698  1236 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0925 20:39:30.175707  1236 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0925 20:39:30.176278  1236 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0925 20:39:30.176300  1236 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 20:39:30.176306  1236 net.cpp:156] Memory required for data: 46020
I0925 20:39:30.176311  1236 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0925 20:39:30.176324  1236 net.cpp:91] Creating Layer lstm2_h_conted_0
I0925 20:39:30.176331  1236 net.cpp:425] lstm2_h_conted_0 <- h_0
I0925 20:39:30.176337  1236 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0925 20:39:30.176345  1236 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0925 20:39:30.176476  1236 net.cpp:141] Setting up lstm2_h_conted_0
I0925 20:39:30.176486  1236 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:39:30.176491  1236 net.cpp:156] Memory required for data: 50020
I0925 20:39:30.176496  1236 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0925 20:39:30.176509  1236 net.cpp:91] Creating Layer lstm2_transform_1
I0925 20:39:30.176515  1236 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0925 20:39:30.176523  1236 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0925 20:39:30.219039  1236 net.cpp:141] Setting up lstm2_transform_1
I0925 20:39:30.219092  1236 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 20:39:30.219099  1236 net.cpp:156] Memory required for data: 66020
I0925 20:39:30.219121  1236 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0925 20:39:30.219147  1236 net.cpp:91] Creating Layer lstm2_gate_input_1
I0925 20:39:30.219156  1236 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0925 20:39:30.219163  1236 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0925 20:39:30.219172  1236 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0925 20:39:30.219588  1236 net.cpp:141] Setting up lstm2_gate_input_1
I0925 20:39:30.219609  1236 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 20:39:30.219614  1236 net.cpp:156] Memory required for data: 82020
I0925 20:39:30.219619  1236 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0925 20:39:30.219630  1236 net.cpp:91] Creating Layer lstm2_unit_1
I0925 20:39:30.219635  1236 net.cpp:425] lstm2_unit_1 <- c_0
I0925 20:39:30.219642  1236 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0925 20:39:30.219648  1236 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0925 20:39:30.219658  1236 net.cpp:399] lstm2_unit_1 -> c_1
I0925 20:39:30.219669  1236 net.cpp:399] lstm2_unit_1 -> h_1
I0925 20:39:30.219758  1236 net.cpp:141] Setting up lstm2_unit_1
I0925 20:39:30.219768  1236 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:39:30.219774  1236 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:39:30.219779  1236 net.cpp:156] Memory required for data: 90020
I0925 20:39:30.219784  1236 layer_factory.hpp:77] Creating layer lstm2_
I0925 20:39:30.219799  1236 net.cpp:91] Creating Layer lstm2_
I0925 20:39:30.219804  1236 net.cpp:425] lstm2_ <- c_1
I0925 20:39:30.219812  1236 net.cpp:399] lstm2_ -> c_T
I0925 20:39:30.219846  1236 net.cpp:141] Setting up lstm2_
I0925 20:39:30.219856  1236 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:39:30.219861  1236 net.cpp:156] Memory required for data: 94020
I0925 20:39:30.219864  1236 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0925 20:39:30.219877  1236 net.cpp:91] Creating Layer lstm2_h_concat
I0925 20:39:30.219882  1236 net.cpp:425] lstm2_h_concat <- h_1
I0925 20:39:30.219893  1236 net.cpp:399] lstm2_h_concat -> h
I0925 20:39:30.219935  1236 net.cpp:141] Setting up lstm2_h_concat
I0925 20:39:30.219945  1236 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:39:30.219949  1236 net.cpp:156] Memory required for data: 98020
I0925 20:39:30.219954  1236 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 20:39:30.219964  1236 net.cpp:91] Creating Layer h_pseudoloss
I0925 20:39:30.219969  1236 net.cpp:425] h_pseudoloss <- h
I0925 20:39:30.219976  1236 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 20:39:30.220594  1236 net.cpp:141] Setting up h_pseudoloss
I0925 20:39:30.220615  1236 net.cpp:148] Top shape: (1)
I0925 20:39:30.220621  1236 net.cpp:151]     with loss weight 1
I0925 20:39:30.220641  1236 net.cpp:156] Memory required for data: 98024
I0925 20:39:30.220648  1236 net.cpp:217] h_pseudoloss needs backward computation.
I0925 20:39:30.220652  1236 net.cpp:217] lstm2_h_concat needs backward computation.
I0925 20:39:30.220657  1236 net.cpp:219] lstm2_ does not need backward computation.
I0925 20:39:30.220662  1236 net.cpp:217] lstm2_unit_1 needs backward computation.
I0925 20:39:30.220669  1236 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0925 20:39:30.220674  1236 net.cpp:217] lstm2_transform_1 needs backward computation.
I0925 20:39:30.220677  1236 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0925 20:39:30.220684  1236 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0925 20:39:30.220688  1236 net.cpp:217] lstm2_x_transform needs backward computation.
I0925 20:39:30.220693  1236 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0925 20:39:30.220701  1236 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0925 20:39:30.220707  1236 net.cpp:219] lstm2_ does not need backward computation.
I0925 20:39:30.220711  1236 net.cpp:219] lstm2_ does not need backward computation.
I0925 20:39:30.220715  1236 net.cpp:261] This network produces output c_T
I0925 20:39:30.220721  1236 net.cpp:261] This network produces output h_pseudoloss
I0925 20:39:30.220736  1236 net.cpp:274] Network initialization done.
I0925 20:39:30.220791  1236 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 20:39:30.220798  1236 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 20:39:30.220803  1236 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 20:39:30.220932  1236 net.cpp:141] Setting up lstm2
I0925 20:39:30.220943  1236 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:39:30.220948  1236 net.cpp:156] Memory required for data: 36412
I0925 20:39:30.220963  1236 layer_factory.hpp:77] Creating layer predict
I0925 20:39:30.220978  1236 net.cpp:91] Creating Layer predict
I0925 20:39:30.220984  1236 net.cpp:425] predict <- lstm2
I0925 20:39:30.220993  1236 net.cpp:399] predict -> predict
I0925 20:39:30.410646  1242 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /home/peifeng/work/run/storm102/data/workers/3fbab32d-6305-4e02-a83b-b6209a395c21/tmp/cvld6108081456596242107/bvlc_reference_caffenet.caffemodel
I0925 20:39:30.410697  1242 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0925 20:39:30.410704  1242 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0925 20:39:30.410708  1242 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /home/peifeng/work/run/storm102/data/workers/3fbab32d-6305-4e02-a83b-b6209a395c21/tmp/cvld6108081456596242107/bvlc_reference_caffenet.caffemodel
I0925 20:39:30.710945  1236 net.cpp:141] Setting up predict
I0925 20:39:30.711001  1236 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 20:39:30.711009  1236 net.cpp:156] Memory required for data: 221084
I0925 20:39:30.711030  1236 layer_factory.hpp:77] Creating layer probs
I0925 20:39:30.711050  1236 net.cpp:91] Creating Layer probs
I0925 20:39:30.711061  1236 net.cpp:425] probs <- predict
I0925 20:39:30.711072  1236 net.cpp:399] probs -> probs
I0925 20:39:30.712301  1236 net.cpp:141] Setting up probs
I0925 20:39:30.712321  1236 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 20:39:30.712326  1236 net.cpp:156] Memory required for data: 405756
I0925 20:39:30.712332  1236 net.cpp:219] probs does not need backward computation.
I0925 20:39:30.712338  1236 net.cpp:219] predict does not need backward computation.
I0925 20:39:30.712343  1236 net.cpp:219] lstm2 does not need backward computation.
I0925 20:39:30.712349  1236 net.cpp:219] concat does not need backward computation.
I0925 20:39:30.712357  1236 net.cpp:219] lstm1 does not need backward computation.
I0925 20:39:30.712363  1236 net.cpp:219] embedding does not need backward computation.
I0925 20:39:30.712368  1236 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0925 20:39:30.712373  1236 net.cpp:219] reshape_frames does not need backward computation.
I0925 20:39:30.712378  1236 net.cpp:219] embed_encoder does not need backward computation.
I0925 20:39:30.712383  1236 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0925 20:39:30.712389  1236 net.cpp:219] input does not need backward computation.
I0925 20:39:30.712394  1236 net.cpp:261] This network produces output probs
I0925 20:39:30.712415  1236 net.cpp:274] Network initialization done.
I0925 20:39:30.843430  1242 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0925 20:39:30.901983  1242 net.cpp:752] Ignoring source layer loss
Loading the model + trained: 6508.53ms
Using cv::Size and some other stuff: 0.155ms
I0925 20:39:31.060621  1236 net.cpp:752] Ignoring source layer data
I0925 20:39:31.060662  1236 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0925 20:39:31.060668  1236 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0925 20:39:31.145301  1236 net.cpp:752] Ignoring source layer cross_entropy_loss
Loading the mean file: 63663ms
TIMERTIMER 324994947
TIMERTIMER 240510854
TIMERTIMER 275785672
TIMERTIMER 231214400
TIMERTIMER 247650461
TIMERTIMER 245334320
TIMERTIMER 233367610
TIMERTIMER 235711224
TIMERTIMER 226945022
TIMERTIMER 230854395
TIMERTIMER 223056841
TIMERTIMER 224213195
TIMERTIMER 230690916
TIMERTIMER 233569915
TIMERTIMER 231398946
TIMERTIMER 219506448
TIMERTIMER 225766187
TIMERTIMER 235579207
TIMERTIMER 225048480
TIMERTIMER 224894481
TIMERTIMER 238039366
TIMERTIMER 229938040
TIMERTIMER 226471014
TIMERTIMER 229070119
TIMERTIMER 223620654
TIMERTIMER 232938724
TIMERTIMER 241688648
TIMERTIMER 230076569
TIMERTIMER 200806234
TIMERTIMER 191963660
