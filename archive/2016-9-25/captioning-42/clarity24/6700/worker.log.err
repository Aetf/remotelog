SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/peifeng/tools/storm102/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/peifeng/work/run/storm102/data/supervisor/stormdist/captioning-1-1474858934/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /home/peifeng/work/run/storm102/data/workers/3507868b-8089-46cf-b9c3-07ccbf177d02/tmp/cvld1195509740947419724/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0925 23:03:31.749868 20594 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/3507868b-8089-46cf-b9c3-07ccbf177d02/tmp/cvld1195509740947419724/s2vt.words_to_preds.prototxt
I0925 23:03:31.749871 20584 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/3507868b-8089-46cf-b9c3-07ccbf177d02/tmp/cvld1195509740947419724/s2vt.words_to_preds.prototxt
I0925 23:03:31.749868 20588 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/3507868b-8089-46cf-b9c3-07ccbf177d02/tmp/cvld1195509740947419724/s2vt.words_to_preds.prototxt
I0925 23:03:31.749868 20634 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/3507868b-8089-46cf-b9c3-07ccbf177d02/tmp/cvld1195509740947419724/s2vt.words_to_preds.prototxt
I0925 23:03:31.749868 20590 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/3507868b-8089-46cf-b9c3-07ccbf177d02/tmp/cvld1195509740947419724/s2vt.words_to_preds.prototxt
I0925 23:03:31.750008 20584 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
I0925 23:03:31.750011 20588 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0925 23:03:31.750021 20584 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0925 23:03:31.750006 20594 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0925 23:03:31.750028 20588 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
W0925 23:03:31.750035 20594 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0925 23:03:31.750028 20590 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
I0925 23:03:31.750016 20634 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0925 23:03:31.750044 20590 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
W0925 23:03:31.750049 20634 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0925 23:03:31.750064 20638 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/3507868b-8089-46cf-b9c3-07ccbf177d02/tmp/cvld1195509740947419724/s2vt.words_to_preds.prototxt
I0925 23:03:31.750064 20608 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/3507868b-8089-46cf-b9c3-07ccbf177d02/tmp/cvld1195509740947419724/s2vt.words_to_preds.prototxt
I0925 23:03:31.750097 20638 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
I0925 23:03:31.750102 20608 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0925 23:03:31.750108 20638 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
W0925 23:03:31.750108 20608 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0925 23:03:31.750365 20634 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0925 23:03:31.750365 20594 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0925 23:03:31.750365 20590 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0925 23:03:31.750371 20584 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0925 23:03:31.750452 20588 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0925 23:03:31.750483 20608 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0925 23:03:31.750483 20638 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0925 23:03:31.750521 20590 layer_factory.hpp:77] Creating layer input
I0925 23:03:31.750521 20634 layer_factory.hpp:77] Creating layer input
I0925 23:03:31.750529 20584 layer_factory.hpp:77] Creating layer input
I0925 23:03:31.750521 20594 layer_factory.hpp:77] Creating layer input
I0925 23:03:31.750550 20590 net.cpp:91] Creating Layer input
I0925 23:03:31.750551 20584 net.cpp:91] Creating Layer input
I0925 23:03:31.750555 20594 net.cpp:91] Creating Layer input
I0925 23:03:31.750550 20634 net.cpp:91] Creating Layer input
I0925 23:03:31.750566 20584 net.cpp:399] input -> frames_fc7
I0925 23:03:31.750568 20634 net.cpp:399] input -> frames_fc7
I0925 23:03:31.750571 20588 layer_factory.hpp:77] Creating layer input
I0925 23:03:31.750566 20590 net.cpp:399] input -> frames_fc7
I0925 23:03:31.750566 20594 net.cpp:399] input -> frames_fc7
I0925 23:03:31.750586 20588 net.cpp:91] Creating Layer input
I0925 23:03:31.750603 20588 net.cpp:399] input -> frames_fc7
I0925 23:03:31.750620 20588 net.cpp:399] input -> cont_sentence
I0925 23:03:31.750622 20594 net.cpp:399] input -> cont_sentence
I0925 23:03:31.750624 20584 net.cpp:399] input -> cont_sentence
I0925 23:03:31.750620 20634 net.cpp:399] input -> cont_sentence
I0925 23:03:31.750622 20590 net.cpp:399] input -> cont_sentence
I0925 23:03:31.750640 20588 net.cpp:399] input -> input_sentence
I0925 23:03:31.750644 20584 net.cpp:399] input -> input_sentence
I0925 23:03:31.750641 20594 net.cpp:399] input -> input_sentence
I0925 23:03:31.750654 20590 net.cpp:399] input -> input_sentence
I0925 23:03:31.750658 20588 net.cpp:399] input -> stage_indicator
I0925 23:03:31.750645 20634 net.cpp:399] input -> input_sentence
I0925 23:03:31.750665 20594 net.cpp:399] input -> stage_indicator
I0925 23:03:31.750658 20638 layer_factory.hpp:77] Creating layer input
I0925 23:03:31.750661 20584 net.cpp:399] input -> stage_indicator
I0925 23:03:31.750658 20608 layer_factory.hpp:77] Creating layer input
I0925 23:03:31.750680 20634 net.cpp:399] input -> stage_indicator
I0925 23:03:31.750670 20590 net.cpp:399] input -> stage_indicator
I0925 23:03:31.750689 20638 net.cpp:91] Creating Layer input
I0925 23:03:31.750690 20608 net.cpp:91] Creating Layer input
I0925 23:03:31.750705 20638 net.cpp:399] input -> frames_fc7
I0925 23:03:31.750707 20608 net.cpp:399] input -> frames_fc7
I0925 23:03:31.750728 20638 net.cpp:399] input -> cont_sentence
I0925 23:03:31.750728 20608 net.cpp:399] input -> cont_sentence
I0925 23:03:31.750756 20608 net.cpp:399] input -> input_sentence
I0925 23:03:31.750756 20638 net.cpp:399] input -> input_sentence
I0925 23:03:31.750779 20638 net.cpp:399] input -> stage_indicator
I0925 23:03:31.750779 20608 net.cpp:399] input -> stage_indicator
I0925 23:03:32.272500 20590 net.cpp:141] Setting up input
I0925 23:03:32.272574 20590 net.cpp:148] Top shape: 1 4096 (4096)
I0925 23:03:32.272583 20590 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.272590 20590 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.272596 20590 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.272601 20590 net.cpp:156] Memory required for data: 16396
I0925 23:03:32.272621 20590 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0925 23:03:32.272655 20590 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0925 23:03:32.272665 20590 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0925 23:03:32.272686 20590 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0925 23:03:32.272701 20590 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0925 23:03:32.272694 20588 net.cpp:141] Setting up input
I0925 23:03:32.272742 20588 net.cpp:148] Top shape: 1 4096 (4096)
I0925 23:03:32.272752 20588 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.272758 20588 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.272763 20588 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.272768 20588 net.cpp:156] Memory required for data: 16396
I0925 23:03:32.272775 20588 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0925 23:03:32.272804 20588 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0925 23:03:32.272810 20588 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0925 23:03:32.272775 20590 net.cpp:141] Setting up cont_sentence_input_1_split
I0925 23:03:32.272821 20588 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0925 23:03:32.272836 20590 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.272836 20588 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0925 23:03:32.272853 20590 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.272858 20590 net.cpp:156] Memory required for data: 16404
I0925 23:03:32.272864 20590 layer_factory.hpp:77] Creating layer embed_encoder
I0925 23:03:32.272898 20590 net.cpp:91] Creating Layer embed_encoder
I0925 23:03:32.272907 20590 net.cpp:425] embed_encoder <- frames_fc7
I0925 23:03:32.272912 20588 net.cpp:141] Setting up cont_sentence_input_1_split
I0925 23:03:32.272918 20590 net.cpp:399] embed_encoder -> embedded_in_frames
I0925 23:03:32.272923 20588 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.272929 20588 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.272934 20588 net.cpp:156] Memory required for data: 16404
I0925 23:03:32.272939 20588 layer_factory.hpp:77] Creating layer embed_encoder
I0925 23:03:32.272956 20588 net.cpp:91] Creating Layer embed_encoder
I0925 23:03:32.272961 20588 net.cpp:425] embed_encoder <- frames_fc7
I0925 23:03:32.272970 20588 net.cpp:399] embed_encoder -> embedded_in_frames
I0925 23:03:32.279289 20638 net.cpp:141] Setting up input
I0925 23:03:32.279333 20638 net.cpp:148] Top shape: 1 4096 (4096)
I0925 23:03:32.279350 20638 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.279361 20638 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.279373 20638 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.279382 20638 net.cpp:156] Memory required for data: 16396
I0925 23:03:32.279394 20638 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0925 23:03:32.279414 20638 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0925 23:03:32.279427 20638 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0925 23:03:32.279466 20638 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0925 23:03:32.279494 20638 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0925 23:03:32.286193 20594 net.cpp:141] Setting up input
I0925 23:03:32.286239 20594 net.cpp:148] Top shape: 1 4096 (4096)
I0925 23:03:32.286247 20594 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.286253 20594 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.286259 20594 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.286263 20594 net.cpp:156] Memory required for data: 16396
I0925 23:03:32.286270 20594 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0925 23:03:32.286283 20594 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0925 23:03:32.286289 20594 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0925 23:03:32.286300 20594 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0925 23:03:32.286314 20594 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0925 23:03:32.286339 20634 net.cpp:141] Setting up input
I0925 23:03:32.286366 20594 net.cpp:141] Setting up cont_sentence_input_1_split
I0925 23:03:32.286376 20594 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.286382 20594 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.286378 20634 net.cpp:148] Top shape: 1 4096 (4096)
I0925 23:03:32.286396 20594 net.cpp:156] Memory required for data: 16404
I0925 23:03:32.286415 20594 layer_factory.hpp:77] Creating layer embed_encoder
I0925 23:03:32.286423 20634 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.286433 20594 net.cpp:91] Creating Layer embed_encoder
I0925 23:03:32.286444 20608 net.cpp:141] Setting up input
I0925 23:03:32.286458 20634 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.286471 20608 net.cpp:148] Top shape: 1 4096 (4096)
I0925 23:03:32.286450 20594 net.cpp:425] embed_encoder <- frames_fc7
I0925 23:03:32.286479 20608 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.286486 20608 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.286487 20594 net.cpp:399] embed_encoder -> embedded_in_frames
I0925 23:03:32.286492 20634 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.286494 20608 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.286512 20584 net.cpp:141] Setting up input
I0925 23:03:32.286520 20634 net.cpp:156] Memory required for data: 16396
I0925 23:03:32.286520 20608 net.cpp:156] Memory required for data: 16396
I0925 23:03:32.286533 20584 net.cpp:148] Top shape: 1 4096 (4096)
I0925 23:03:32.286553 20608 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0925 23:03:32.286573 20584 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.286551 20634 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0925 23:03:32.286584 20584 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.286602 20584 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.286608 20584 net.cpp:156] Memory required for data: 16396
I0925 23:03:32.286608 20608 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0925 23:03:32.286620 20584 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0925 23:03:32.286640 20608 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0925 23:03:32.286655 20584 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0925 23:03:32.286664 20638 net.cpp:141] Setting up cont_sentence_input_1_split
I0925 23:03:32.286684 20584 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0925 23:03:32.286643 20634 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0925 23:03:32.286706 20638 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.286662 20608 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0925 23:03:32.286723 20638 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.286731 20584 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0925 23:03:32.286733 20638 net.cpp:156] Memory required for data: 16404
I0925 23:03:32.286741 20634 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0925 23:03:32.286762 20638 layer_factory.hpp:77] Creating layer embed_encoder
I0925 23:03:32.286744 20608 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0925 23:03:32.286761 20584 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0925 23:03:32.286816 20638 net.cpp:91] Creating Layer embed_encoder
I0925 23:03:32.286813 20634 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0925 23:03:32.286831 20638 net.cpp:425] embed_encoder <- frames_fc7
I0925 23:03:32.286893 20638 net.cpp:399] embed_encoder -> embedded_in_frames
I0925 23:03:32.286897 20634 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0925 23:03:32.293009 20608 net.cpp:141] Setting up cont_sentence_input_1_split
I0925 23:03:32.293028 20608 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.293050 20608 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.293056 20608 net.cpp:156] Memory required for data: 16404
I0925 23:03:32.293066 20608 layer_factory.hpp:77] Creating layer embed_encoder
I0925 23:03:32.293099 20608 net.cpp:91] Creating Layer embed_encoder
I0925 23:03:32.293109 20608 net.cpp:425] embed_encoder <- frames_fc7
I0925 23:03:32.293139 20608 net.cpp:399] embed_encoder -> embedded_in_frames
I0925 23:03:32.293184 20584 net.cpp:141] Setting up cont_sentence_input_1_split
I0925 23:03:32.293205 20584 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.293212 20584 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.293217 20584 net.cpp:156] Memory required for data: 16404
I0925 23:03:32.293225 20584 layer_factory.hpp:77] Creating layer embed_encoder
I0925 23:03:32.293242 20584 net.cpp:91] Creating Layer embed_encoder
I0925 23:03:32.293249 20584 net.cpp:425] embed_encoder <- frames_fc7
I0925 23:03:32.293259 20584 net.cpp:399] embed_encoder -> embedded_in_frames
I0925 23:03:32.304818 20634 net.cpp:141] Setting up cont_sentence_input_1_split
I0925 23:03:32.304863 20634 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.304874 20634 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.304883 20634 net.cpp:156] Memory required for data: 16404
I0925 23:03:32.304893 20634 layer_factory.hpp:77] Creating layer embed_encoder
I0925 23:03:32.304919 20634 net.cpp:91] Creating Layer embed_encoder
I0925 23:03:32.304929 20634 net.cpp:425] embed_encoder <- frames_fc7
I0925 23:03:32.304946 20634 net.cpp:399] embed_encoder -> embedded_in_frames
I0925 23:03:32.318846 20590 net.cpp:141] Setting up embed_encoder
I0925 23:03:32.318892 20590 net.cpp:148] Top shape: 1 500 (500)
I0925 23:03:32.318898 20590 net.cpp:156] Memory required for data: 18404
I0925 23:03:32.318928 20590 layer_factory.hpp:77] Creating layer reshape_frames
I0925 23:03:32.319020 20590 net.cpp:91] Creating Layer reshape_frames
I0925 23:03:32.319048 20590 net.cpp:425] reshape_frames <- embedded_in_frames
I0925 23:03:32.319067 20594 net.cpp:141] Setting up embed_encoder
I0925 23:03:32.319077 20590 net.cpp:399] reshape_frames -> embedded_input_frames
I0925 23:03:32.319087 20594 net.cpp:148] Top shape: 1 500 (500)
I0925 23:03:32.319092 20594 net.cpp:156] Memory required for data: 18404
I0925 23:03:32.319108 20594 layer_factory.hpp:77] Creating layer reshape_frames
I0925 23:03:32.319125 20594 net.cpp:91] Creating Layer reshape_frames
I0925 23:03:32.319133 20594 net.cpp:425] reshape_frames <- embedded_in_frames
I0925 23:03:32.319144 20594 net.cpp:399] reshape_frames -> embedded_input_frames
I0925 23:03:32.319193 20590 net.cpp:141] Setting up reshape_frames
I0925 23:03:32.319212 20590 net.cpp:148] Top shape: 1 1 500 (500)
I0925 23:03:32.319219 20590 net.cpp:156] Memory required for data: 20404
I0925 23:03:32.319229 20590 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0925 23:03:32.319243 20590 net.cpp:91] Creating Layer reshape_stage_indicator
I0925 23:03:32.319252 20590 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0925 23:03:32.319264 20590 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0925 23:03:32.319293 20594 net.cpp:141] Setting up reshape_frames
I0925 23:03:32.319305 20594 net.cpp:148] Top shape: 1 1 500 (500)
I0925 23:03:32.319309 20594 net.cpp:156] Memory required for data: 20404
I0925 23:03:32.319314 20594 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0925 23:03:32.319325 20594 net.cpp:91] Creating Layer reshape_stage_indicator
I0925 23:03:32.319331 20594 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0925 23:03:32.319340 20594 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0925 23:03:32.319344 20590 net.cpp:141] Setting up reshape_stage_indicator
I0925 23:03:32.319360 20590 net.cpp:148] Top shape: 1 1 1 (1)
I0925 23:03:32.319367 20590 net.cpp:156] Memory required for data: 20408
I0925 23:03:32.319375 20590 layer_factory.hpp:77] Creating layer embedding
I0925 23:03:32.319418 20590 net.cpp:91] Creating Layer embedding
I0925 23:03:32.319429 20590 net.cpp:425] embedding <- input_sentence
I0925 23:03:32.319425 20588 net.cpp:141] Setting up embed_encoder
I0925 23:03:32.319444 20590 net.cpp:399] embedding -> embedded_input_sentence
I0925 23:03:32.319439 20594 net.cpp:141] Setting up reshape_stage_indicator
I0925 23:03:32.319463 20594 net.cpp:148] Top shape: 1 1 1 (1)
I0925 23:03:32.319468 20588 net.cpp:148] Top shape: 1 500 (500)
I0925 23:03:32.319468 20594 net.cpp:156] Memory required for data: 20408
I0925 23:03:32.319496 20588 net.cpp:156] Memory required for data: 18404
I0925 23:03:32.319496 20594 layer_factory.hpp:77] Creating layer embedding
I0925 23:03:32.319532 20594 net.cpp:91] Creating Layer embedding
I0925 23:03:32.319538 20594 net.cpp:425] embedding <- input_sentence
I0925 23:03:32.319546 20588 layer_factory.hpp:77] Creating layer reshape_frames
I0925 23:03:32.319547 20594 net.cpp:399] embedding -> embedded_input_sentence
I0925 23:03:32.319591 20588 net.cpp:91] Creating Layer reshape_frames
I0925 23:03:32.319610 20588 net.cpp:425] reshape_frames <- embedded_in_frames
I0925 23:03:32.319634 20588 net.cpp:399] reshape_frames -> embedded_input_frames
I0925 23:03:32.361899 20588 net.cpp:141] Setting up reshape_frames
I0925 23:03:32.361917 20588 net.cpp:148] Top shape: 1 1 500 (500)
I0925 23:03:32.361925 20588 net.cpp:156] Memory required for data: 20404
I0925 23:03:32.361932 20588 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0925 23:03:32.361949 20588 net.cpp:91] Creating Layer reshape_stage_indicator
I0925 23:03:32.361958 20588 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0925 23:03:32.361974 20588 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0925 23:03:32.362083 20638 net.cpp:141] Setting up embed_encoder
I0925 23:03:32.362102 20638 net.cpp:148] Top shape: 1 500 (500)
I0925 23:03:32.362108 20638 net.cpp:156] Memory required for data: 18404
I0925 23:03:32.362123 20638 layer_factory.hpp:77] Creating layer reshape_frames
I0925 23:03:32.362134 20638 net.cpp:91] Creating Layer reshape_frames
I0925 23:03:32.362141 20638 net.cpp:425] reshape_frames <- embedded_in_frames
I0925 23:03:32.362160 20638 net.cpp:399] reshape_frames -> embedded_input_frames
I0925 23:03:32.402426 20588 net.cpp:141] Setting up reshape_stage_indicator
I0925 23:03:32.402480 20588 net.cpp:148] Top shape: 1 1 1 (1)
I0925 23:03:32.402488 20588 net.cpp:156] Memory required for data: 20408
I0925 23:03:32.402498 20588 layer_factory.hpp:77] Creating layer embedding
I0925 23:03:32.402520 20588 net.cpp:91] Creating Layer embedding
I0925 23:03:32.402528 20588 net.cpp:425] embedding <- input_sentence
I0925 23:03:32.402547 20588 net.cpp:399] embedding -> embedded_input_sentence
I0925 23:03:32.402639 20638 net.cpp:141] Setting up reshape_frames
I0925 23:03:32.402659 20638 net.cpp:148] Top shape: 1 1 500 (500)
I0925 23:03:32.402665 20638 net.cpp:156] Memory required for data: 20404
I0925 23:03:32.402672 20638 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0925 23:03:32.402688 20638 net.cpp:91] Creating Layer reshape_stage_indicator
I0925 23:03:32.402695 20638 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0925 23:03:32.402705 20638 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0925 23:03:32.402845 20608 net.cpp:141] Setting up embed_encoder
I0925 23:03:32.402881 20608 net.cpp:148] Top shape: 1 500 (500)
I0925 23:03:32.402886 20608 net.cpp:156] Memory required for data: 18404
I0925 23:03:32.402899 20638 net.cpp:141] Setting up reshape_stage_indicator
I0925 23:03:32.402910 20608 layer_factory.hpp:77] Creating layer reshape_frames
I0925 23:03:32.402914 20638 net.cpp:148] Top shape: 1 1 1 (1)
I0925 23:03:32.402920 20638 net.cpp:156] Memory required for data: 20408
I0925 23:03:32.402925 20638 layer_factory.hpp:77] Creating layer embedding
I0925 23:03:32.402930 20608 net.cpp:91] Creating Layer reshape_frames
I0925 23:03:32.402935 20638 net.cpp:91] Creating Layer embedding
I0925 23:03:32.402940 20608 net.cpp:425] reshape_frames <- embedded_in_frames
I0925 23:03:32.402941 20638 net.cpp:425] embedding <- input_sentence
I0925 23:03:32.402951 20608 net.cpp:399] reshape_frames -> embedded_input_frames
I0925 23:03:32.402952 20638 net.cpp:399] embedding -> embedded_input_sentence
I0925 23:03:32.403028 20584 net.cpp:141] Setting up embed_encoder
I0925 23:03:32.403048 20584 net.cpp:148] Top shape: 1 500 (500)
I0925 23:03:32.403053 20584 net.cpp:156] Memory required for data: 18404
I0925 23:03:32.403070 20584 layer_factory.hpp:77] Creating layer reshape_frames
I0925 23:03:32.403081 20584 net.cpp:91] Creating Layer reshape_frames
I0925 23:03:32.403089 20584 net.cpp:425] reshape_frames <- embedded_in_frames
I0925 23:03:32.403098 20584 net.cpp:399] reshape_frames -> embedded_input_frames
I0925 23:03:32.488833 20608 net.cpp:141] Setting up reshape_frames
I0925 23:03:32.488855 20608 net.cpp:148] Top shape: 1 1 500 (500)
I0925 23:03:32.488862 20608 net.cpp:156] Memory required for data: 20404
I0925 23:03:32.488868 20608 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0925 23:03:32.488872 20584 net.cpp:141] Setting up reshape_frames
I0925 23:03:32.488881 20608 net.cpp:91] Creating Layer reshape_stage_indicator
I0925 23:03:32.488888 20608 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0925 23:03:32.488889 20584 net.cpp:148] Top shape: 1 1 500 (500)
I0925 23:03:32.488895 20584 net.cpp:156] Memory required for data: 20404
I0925 23:03:32.488900 20584 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0925 23:03:32.488906 20608 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0925 23:03:32.488914 20584 net.cpp:91] Creating Layer reshape_stage_indicator
I0925 23:03:32.488919 20584 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0925 23:03:32.488929 20584 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0925 23:03:32.489030 20608 net.cpp:141] Setting up reshape_stage_indicator
I0925 23:03:32.489043 20608 net.cpp:148] Top shape: 1 1 1 (1)
I0925 23:03:32.489048 20608 net.cpp:156] Memory required for data: 20408
I0925 23:03:32.489053 20608 layer_factory.hpp:77] Creating layer embedding
I0925 23:03:32.489063 20584 net.cpp:141] Setting up reshape_stage_indicator
I0925 23:03:32.489068 20608 net.cpp:91] Creating Layer embedding
I0925 23:03:32.489074 20584 net.cpp:148] Top shape: 1 1 1 (1)
I0925 23:03:32.489075 20608 net.cpp:425] embedding <- input_sentence
I0925 23:03:32.489079 20584 net.cpp:156] Memory required for data: 20408
I0925 23:03:32.489092 20584 layer_factory.hpp:77] Creating layer embedding
I0925 23:03:32.489099 20608 net.cpp:399] embedding -> embedded_input_sentence
I0925 23:03:32.489104 20584 net.cpp:91] Creating Layer embedding
I0925 23:03:32.489109 20584 net.cpp:425] embedding <- input_sentence
I0925 23:03:32.489120 20584 net.cpp:399] embedding -> embedded_input_sentence
I0925 23:03:32.489166 20634 net.cpp:141] Setting up embed_encoder
I0925 23:03:32.489230 20634 net.cpp:148] Top shape: 1 500 (500)
I0925 23:03:32.489246 20634 net.cpp:156] Memory required for data: 18404
I0925 23:03:32.489292 20634 layer_factory.hpp:77] Creating layer reshape_frames
I0925 23:03:32.489328 20634 net.cpp:91] Creating Layer reshape_frames
I0925 23:03:32.489347 20634 net.cpp:425] reshape_frames <- embedded_in_frames
I0925 23:03:32.489373 20634 net.cpp:399] reshape_frames -> embedded_input_frames
I0925 23:03:32.574482 20634 net.cpp:141] Setting up reshape_frames
I0925 23:03:32.574532 20634 net.cpp:148] Top shape: 1 1 500 (500)
I0925 23:03:32.574542 20634 net.cpp:156] Memory required for data: 20404
I0925 23:03:32.574553 20634 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0925 23:03:32.574582 20634 net.cpp:91] Creating Layer reshape_stage_indicator
I0925 23:03:32.574592 20634 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0925 23:03:32.574582 20590 net.cpp:141] Setting up embedding
I0925 23:03:32.574627 20634 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0925 23:03:32.574638 20590 net.cpp:148] Top shape: 1 1 500 (500)
I0925 23:03:32.574645 20590 net.cpp:156] Memory required for data: 22408
I0925 23:03:32.574664 20590 layer_factory.hpp:77] Creating layer lstm1
I0925 23:03:32.574694 20590 net.cpp:91] Creating Layer lstm1
I0925 23:03:32.574702 20590 net.cpp:425] lstm1 <- embedded_input_frames
I0925 23:03:32.574712 20590 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0925 23:03:32.574710 20634 net.cpp:141] Setting up reshape_stage_indicator
I0925 23:03:32.574725 20590 net.cpp:399] lstm1 -> lstm1
I0925 23:03:32.574725 20634 net.cpp:148] Top shape: 1 1 1 (1)
I0925 23:03:32.574735 20634 net.cpp:156] Memory required for data: 20408
I0925 23:03:32.574743 20634 layer_factory.hpp:77] Creating layer embedding
I0925 23:03:32.574760 20634 net.cpp:91] Creating Layer embedding
I0925 23:03:32.574769 20634 net.cpp:425] embedding <- input_sentence
I0925 23:03:32.574774 20590 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 23:03:32.574782 20634 net.cpp:399] embedding -> embedded_input_sentence
I0925 23:03:32.622720 20590 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 23:03:32.622889 20590 layer_factory.hpp:77] Creating layer lstm1_
I0925 23:03:32.622906 20590 net.cpp:91] Creating Layer lstm1_
I0925 23:03:32.622913 20590 net.cpp:399] lstm1_ -> x
I0925 23:03:32.622931 20590 net.cpp:399] lstm1_ -> cont
I0925 23:03:32.625933 20594 net.cpp:141] Setting up embedding
I0925 23:03:32.625979 20594 net.cpp:148] Top shape: 1 1 500 (500)
I0925 23:03:32.625984 20594 net.cpp:156] Memory required for data: 22408
I0925 23:03:32.625988 20638 net.cpp:141] Setting up embedding
I0925 23:03:32.626003 20594 layer_factory.hpp:77] Creating layer lstm1
I0925 23:03:32.626008 20638 net.cpp:148] Top shape: 1 1 500 (500)
I0925 23:03:32.626014 20638 net.cpp:156] Memory required for data: 22408
I0925 23:03:32.626024 20594 net.cpp:91] Creating Layer lstm1
I0925 23:03:32.626027 20638 layer_factory.hpp:77] Creating layer lstm1
I0925 23:03:32.626032 20594 net.cpp:425] lstm1 <- embedded_input_frames
I0925 23:03:32.626041 20594 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0925 23:03:32.626051 20638 net.cpp:91] Creating Layer lstm1
I0925 23:03:32.626052 20594 net.cpp:399] lstm1 -> lstm1
I0925 23:03:32.626060 20638 net.cpp:425] lstm1 <- embedded_input_frames
I0925 23:03:32.626068 20638 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0925 23:03:32.626071 20594 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 23:03:32.626077 20638 net.cpp:399] lstm1 -> lstm1
I0925 23:03:32.626081 20590 net.cpp:141] Setting up lstm1_
I0925 23:03:32.626091 20638 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 23:03:32.626102 20590 net.cpp:148] Top shape: 1 1 500 (500)
I0925 23:03:32.626111 20590 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.626116 20590 net.cpp:156] Memory required for data: 2004
I0925 23:03:32.626122 20590 layer_factory.hpp:77] Creating layer lstm1_
I0925 23:03:32.626135 20590 net.cpp:91] Creating Layer lstm1_
I0925 23:03:32.626150 20590 net.cpp:399] lstm1_ -> c_0
I0925 23:03:32.626163 20590 net.cpp:399] lstm1_ -> h_0
I0925 23:03:32.626219 20590 net.cpp:141] Setting up lstm1_
I0925 23:03:32.626230 20590 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:32.626236 20590 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:32.626241 20590 net.cpp:156] Memory required for data: 10004
I0925 23:03:32.626245 20590 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0925 23:03:32.626260 20590 net.cpp:91] Creating Layer lstm1_cont_slice
I0925 23:03:32.626266 20590 net.cpp:425] lstm1_cont_slice <- cont
I0925 23:03:32.626273 20590 net.cpp:399] lstm1_cont_slice -> cont_1
I0925 23:03:32.626312 20590 net.cpp:141] Setting up lstm1_cont_slice
I0925 23:03:32.626320 20590 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.626325 20590 net.cpp:156] Memory required for data: 10008
I0925 23:03:32.626329 20590 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0925 23:03:32.626338 20590 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0925 23:03:32.626343 20590 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0925 23:03:32.626354 20590 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0925 23:03:32.626366 20590 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0925 23:03:32.626372 20594 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 23:03:32.626387 20638 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 23:03:32.626411 20590 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0925 23:03:32.626425 20590 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.626433 20590 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.626438 20590 net.cpp:156] Memory required for data: 10016
I0925 23:03:32.626443 20590 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0925 23:03:32.626456 20590 net.cpp:91] Creating Layer lstm1_x_transform
I0925 23:03:32.626461 20590 net.cpp:425] lstm1_x_transform <- x
I0925 23:03:32.626469 20590 net.cpp:399] lstm1_x_transform -> W_xc_x
I0925 23:03:32.626472 20594 layer_factory.hpp:77] Creating layer lstm1_
I0925 23:03:32.626485 20594 net.cpp:91] Creating Layer lstm1_
I0925 23:03:32.626492 20594 net.cpp:399] lstm1_ -> x
I0925 23:03:32.626495 20638 layer_factory.hpp:77] Creating layer lstm1_
I0925 23:03:32.626504 20594 net.cpp:399] lstm1_ -> cont
I0925 23:03:32.626508 20638 net.cpp:91] Creating Layer lstm1_
I0925 23:03:32.626514 20638 net.cpp:399] lstm1_ -> x
I0925 23:03:32.626526 20638 net.cpp:399] lstm1_ -> cont
I0925 23:03:32.630584 20594 net.cpp:141] Setting up lstm1_
I0925 23:03:32.630616 20638 net.cpp:141] Setting up lstm1_
I0925 23:03:32.630653 20594 net.cpp:148] Top shape: 1 1 500 (500)
I0925 23:03:32.630662 20594 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.630667 20594 net.cpp:156] Memory required for data: 2004
I0925 23:03:32.630678 20594 layer_factory.hpp:77] Creating layer lstm1_
I0925 23:03:32.630702 20594 net.cpp:91] Creating Layer lstm1_
I0925 23:03:32.630700 20638 net.cpp:148] Top shape: 1 1 500 (500)
I0925 23:03:32.630713 20638 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:32.630718 20638 net.cpp:156] Memory required for data: 2004
I0925 23:03:32.630720 20594 net.cpp:399] lstm1_ -> c_0
I0925 23:03:32.630724 20638 layer_factory.hpp:77] Creating layer lstm1_
I0925 23:03:32.630738 20638 net.cpp:91] Creating Layer lstm1_
I0925 23:03:32.630739 20594 net.cpp:399] lstm1_ -> h_0
I0925 23:03:32.630744 20638 net.cpp:399] lstm1_ -> c_0
I0925 23:03:32.630795 20594 net.cpp:141] Setting up lstm1_
I0925 23:03:32.646301 20590 net.cpp:141] Setting up lstm1_x_transform
I0925 23:03:32.681852 20588 net.cpp:141] Setting up embedding
I0925 23:03:32.708293 20584 net.cpp:141] Setting up embedding
I0925 23:03:32.976928 20638 net.cpp:399] lstm1_ -> h_0
I0925 23:03:32.782572 20608 net.cpp:141] Setting up embedding
I0925 23:03:32.976999 20584 net.cpp:148] Top shape: 1 1 500 (500)
I0925 23:03:32.967106 20626 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/3507868b-8089-46cf-b9c3-07ccbf177d02/tmp/cvld1195509740947419724/s2vt.words_to_preds.prototxt
I0925 23:03:32.977016 20608 net.cpp:148] Top shape: 1 1 500 (500)
I0925 23:03:32.968097 20610 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0925 23:03:32.977036 20608 net.cpp:156] Memory required for data: 22408
I0925 23:03:32.976959 20590 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:32.977073 20590 net.cpp:156] Memory required for data: 26016
I0925 23:03:32.977071 20626 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0925 23:03:32.977094 20626 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0925 23:03:32.977015 20584 net.cpp:156] Memory required for data: 22408
I0925 23:03:32.976950 20588 net.cpp:148] Top shape: 1 1 500 (500)
I0925 23:03:32.976932 20594 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:32.967433 20602 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/3507868b-8089-46cf-b9c3-07ccbf177d02/tmp/cvld1195509740947419724/s2vt.words_to_preds.prototxt
I0925 23:03:32.977130 20588 net.cpp:156] Memory required for data: 22408
I0925 23:03:32.977099 20590 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0925 23:03:32.977140 20594 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:32.977128 20584 layer_factory.hpp:77] Creating layer lstm1
I0925 23:03:32.977155 20594 net.cpp:156] Memory required for data: 10004
I0925 23:03:32.977167 20590 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0925 23:03:32.977169 20594 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0925 23:03:32.977213 20590 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0925 23:03:32.977165 20602 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
I0925 23:03:32.977169 20588 layer_factory.hpp:77] Creating layer lstm1
I0925 23:03:32.977237 20590 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
W0925 23:03:32.977239 20602 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0925 23:03:32.977177 20584 net.cpp:91] Creating Layer lstm1
I0925 23:03:32.800899 20634 net.cpp:141] Setting up embedding
I0925 23:03:32.977262 20588 net.cpp:91] Creating Layer lstm1
I0925 23:03:32.977267 20584 net.cpp:425] lstm1 <- embedded_input_frames
I0925 23:03:32.977247 20594 net.cpp:91] Creating Layer lstm1_cont_slice
I0925 23:03:32.977279 20584 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0925 23:03:32.977286 20594 net.cpp:425] lstm1_cont_slice <- cont
I0925 23:03:32.977295 20584 net.cpp:399] lstm1 -> lstm1
I0925 23:03:32.977282 20634 net.cpp:148] Top shape: 1 1 500 (500)
I0925 23:03:32.977299 20610 layer_factory.hpp:77] Creating layer data
I0925 23:03:32.977282 20588 net.cpp:425] lstm1 <- embedded_input_frames
I0925 23:03:32.977314 20584 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 23:03:32.977319 20634 net.cpp:156] Memory required for data: 22408
I0925 23:03:32.977305 20594 net.cpp:399] lstm1_cont_slice -> cont_1
I0925 23:03:32.977336 20610 net.cpp:91] Creating Layer data
I0925 23:03:32.977346 20634 layer_factory.hpp:77] Creating layer lstm1
I0925 23:03:32.977339 20588 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0925 23:03:32.977382 20588 net.cpp:399] lstm1 -> lstm1
I0925 23:03:32.977365 20634 net.cpp:91] Creating Layer lstm1
I0925 23:03:32.977365 20610 net.cpp:399] data -> data
I0925 23:03:32.977406 20634 net.cpp:425] lstm1 <- embedded_input_frames
I0925 23:03:32.977413 20588 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 23:03:32.977437 20634 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0925 23:03:32.977455 20634 net.cpp:399] lstm1 -> lstm1
I0925 23:03:32.977478 20634 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 23:03:32.977500 20626 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0925 23:03:32.977566 20602 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0925 23:03:32.977581 20584 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 23:03:32.977672 20590 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0925 23:03:32.977723 20594 net.cpp:141] Setting up lstm1_cont_slice
I0925 23:03:32.977741 20588 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 23:03:32.977778 20610 net.cpp:141] Setting up data
I0925 23:03:32.977840 20634 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 23:03:32.977875 20638 net.cpp:141] Setting up lstm1_
I0925 23:03:33.125838 20610 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0925 23:03:33.125861 20610 net.cpp:156] Memory required for data: 6183480
I0925 23:03:32.977078 20608 layer_factory.hpp:77] Creating layer lstm1
I0925 23:03:33.068862 20594 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.125882 20610 layer_factory.hpp:77] Creating layer conv1
I0925 23:03:33.068925 20602 layer_factory.hpp:77] Creating layer input
I0925 23:03:33.125905 20608 net.cpp:91] Creating Layer lstm1
I0925 23:03:33.125926 20608 net.cpp:425] lstm1 <- embedded_input_frames
I0925 23:03:33.125932 20610 net.cpp:91] Creating Layer conv1
I0925 23:03:33.125903 20594 net.cpp:156] Memory required for data: 10008
I0925 23:03:33.125947 20610 net.cpp:425] conv1 <- data
I0925 23:03:33.068956 20626 layer_factory.hpp:77] Creating layer input
I0925 23:03:33.125859 20638 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.125972 20610 net.cpp:399] conv1 -> conv1
I0925 23:03:33.068919 20584 layer_factory.hpp:77] Creating layer lstm1_
I0925 23:03:33.125979 20634 layer_factory.hpp:77] Creating layer lstm1_
I0925 23:03:33.125954 20588 layer_factory.hpp:77] Creating layer lstm1_
I0925 23:03:33.125941 20602 net.cpp:91] Creating Layer input
I0925 23:03:33.126004 20634 net.cpp:91] Creating Layer lstm1_
I0925 23:03:33.126005 20584 net.cpp:91] Creating Layer lstm1_
I0925 23:03:33.126022 20634 net.cpp:399] lstm1_ -> x
I0925 23:03:33.126026 20602 net.cpp:399] input -> frames_fc7
I0925 23:03:33.126022 20588 net.cpp:91] Creating Layer lstm1_
I0925 23:03:33.126024 20584 net.cpp:399] lstm1_ -> x
I0925 23:03:33.126042 20588 net.cpp:399] lstm1_ -> x
I0925 23:03:33.126060 20602 net.cpp:399] input -> cont_sentence
I0925 23:03:33.126068 20584 net.cpp:399] lstm1_ -> cont
I0925 23:03:33.126077 20602 net.cpp:399] input -> input_sentence
I0925 23:03:33.126054 20634 net.cpp:399] lstm1_ -> cont
I0925 23:03:33.125963 20594 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0925 23:03:33.126091 20588 net.cpp:399] lstm1_ -> cont
I0925 23:03:33.126096 20602 net.cpp:399] input -> stage_indicator
I0925 23:03:33.151193 20594 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0925 23:03:33.151231 20594 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0925 23:03:33.125993 20626 net.cpp:91] Creating Layer input
I0925 23:03:33.151262 20594 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0925 23:03:33.151288 20594 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0925 23:03:33.126312 20634 net.cpp:141] Setting up lstm1_
I0925 23:03:33.125943 20608 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0925 23:03:33.126345 20584 net.cpp:141] Setting up lstm1_
I0925 23:03:33.151330 20634 net.cpp:148] Top shape: 1 1 500 (500)
I0925 23:03:33.068841 20590 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.151342 20634 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.151347 20634 net.cpp:156] Memory required for data: 2004
I0925 23:03:33.151355 20634 layer_factory.hpp:77] Creating layer lstm1_
I0925 23:03:33.151350 20590 net.cpp:156] Memory required for data: 42016
I0925 23:03:33.151373 20634 net.cpp:91] Creating Layer lstm1_
I0925 23:03:33.151350 20584 net.cpp:148] Top shape: 1 1 500 (500)
I0925 23:03:33.151406 20584 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.151412 20584 net.cpp:156] Memory required for data: 2004
I0925 23:03:33.151420 20584 layer_factory.hpp:77] Creating layer lstm1_
I0925 23:03:33.151437 20584 net.cpp:91] Creating Layer lstm1_
I0925 23:03:33.125995 20638 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.151463 20638 net.cpp:156] Memory required for data: 10004
I0925 23:03:33.151473 20638 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0925 23:03:33.151489 20638 net.cpp:91] Creating Layer lstm1_cont_slice
I0925 23:03:33.151499 20638 net.cpp:425] lstm1_cont_slice <- cont
I0925 23:03:33.151288 20626 net.cpp:399] input -> frames_fc7
I0925 23:03:33.151528 20626 net.cpp:399] input -> cont_sentence
I0925 23:03:33.151546 20626 net.cpp:399] input -> input_sentence
I0925 23:03:33.151561 20626 net.cpp:399] input -> stage_indicator
I0925 23:03:33.151377 20590 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0925 23:03:33.151605 20608 net.cpp:399] lstm1 -> lstm1
I0925 23:03:33.151617 20634 net.cpp:399] lstm1_ -> c_0
I0925 23:03:33.151638 20608 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 23:03:33.151646 20634 net.cpp:399] lstm1_ -> h_0
I0925 23:03:33.151636 20590 net.cpp:91] Creating Layer lstm1_h_conted_0
I0925 23:03:33.151664 20590 net.cpp:425] lstm1_h_conted_0 <- h_0
I0925 23:03:33.151670 20584 net.cpp:399] lstm1_ -> c_0
I0925 23:03:33.151676 20590 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0925 23:03:33.151684 20584 net.cpp:399] lstm1_ -> h_0
I0925 23:03:33.151686 20590 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0925 23:03:33.151729 20638 net.cpp:399] lstm1_cont_slice -> cont_1
I0925 23:03:33.151985 20608 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 23:03:33.152087 20608 layer_factory.hpp:77] Creating layer lstm1_
I0925 23:03:33.152099 20608 net.cpp:91] Creating Layer lstm1_
I0925 23:03:33.152107 20608 net.cpp:399] lstm1_ -> x
I0925 23:03:33.152118 20608 net.cpp:399] lstm1_ -> cont
I0925 23:03:33.152568 20588 net.cpp:141] Setting up lstm1_
I0925 23:03:33.152580 20588 net.cpp:148] Top shape: 1 1 500 (500)
I0925 23:03:33.152587 20588 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.152591 20588 net.cpp:156] Memory required for data: 2004
I0925 23:03:33.152597 20588 layer_factory.hpp:77] Creating layer lstm1_
I0925 23:03:33.152608 20588 net.cpp:91] Creating Layer lstm1_
I0925 23:03:33.152621 20588 net.cpp:399] lstm1_ -> c_0
I0925 23:03:33.152631 20588 net.cpp:399] lstm1_ -> h_0
I0925 23:03:33.152871 20634 net.cpp:141] Setting up lstm1_
I0925 23:03:33.152889 20634 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.152894 20634 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.152899 20634 net.cpp:156] Memory required for data: 10004
I0925 23:03:33.152905 20634 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0925 23:03:33.152915 20634 net.cpp:91] Creating Layer lstm1_cont_slice
I0925 23:03:33.152921 20634 net.cpp:425] lstm1_cont_slice <- cont
I0925 23:03:33.152922 20584 net.cpp:141] Setting up lstm1_
I0925 23:03:33.152931 20634 net.cpp:399] lstm1_cont_slice -> cont_1
I0925 23:03:33.152937 20584 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.152945 20584 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.152948 20584 net.cpp:156] Memory required for data: 10004
I0925 23:03:33.152953 20584 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0925 23:03:33.152966 20584 net.cpp:91] Creating Layer lstm1_cont_slice
I0925 23:03:33.152972 20584 net.cpp:425] lstm1_cont_slice <- cont
I0925 23:03:33.152981 20584 net.cpp:399] lstm1_cont_slice -> cont_1
I0925 23:03:33.153056 20638 net.cpp:141] Setting up lstm1_cont_slice
I0925 23:03:33.153080 20638 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.160861 20638 net.cpp:156] Memory required for data: 10008
I0925 23:03:33.160897 20638 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0925 23:03:33.160925 20638 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0925 23:03:33.160940 20638 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0925 23:03:33.160962 20638 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0925 23:03:33.160986 20638 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0925 23:03:33.153175 20608 net.cpp:141] Setting up lstm1_
I0925 23:03:33.161051 20608 net.cpp:148] Top shape: 1 1 500 (500)
I0925 23:03:33.161062 20608 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.161070 20608 net.cpp:156] Memory required for data: 2004
I0925 23:03:33.161079 20608 layer_factory.hpp:77] Creating layer lstm1_
I0925 23:03:33.161101 20608 net.cpp:91] Creating Layer lstm1_
I0925 23:03:33.161128 20608 net.cpp:399] lstm1_ -> c_0
I0925 23:03:33.161150 20608 net.cpp:399] lstm1_ -> h_0
I0925 23:03:33.153385 20602 net.cpp:141] Setting up input
I0925 23:03:33.161195 20602 net.cpp:148] Top shape: 1 4096 (4096)
I0925 23:03:33.161211 20602 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.161224 20602 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.161237 20602 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.161247 20602 net.cpp:156] Memory required for data: 16396
I0925 23:03:33.161257 20602 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0925 23:03:33.161274 20602 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0925 23:03:33.161288 20602 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0925 23:03:33.153445 20588 net.cpp:141] Setting up lstm1_
I0925 23:03:33.161329 20588 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.161344 20588 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.161352 20588 net.cpp:156] Memory required for data: 10004
I0925 23:03:33.161362 20588 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0925 23:03:33.161381 20588 net.cpp:91] Creating Layer lstm1_cont_slice
I0925 23:03:33.161393 20588 net.cpp:425] lstm1_cont_slice <- cont
I0925 23:03:33.153537 20594 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0925 23:03:33.161425 20594 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.161439 20594 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.161449 20594 net.cpp:156] Memory required for data: 10016
I0925 23:03:33.161459 20594 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0925 23:03:33.153569 20626 net.cpp:141] Setting up input
I0925 23:03:33.161504 20626 net.cpp:148] Top shape: 1 4096 (4096)
I0925 23:03:33.161520 20626 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.161533 20626 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.161546 20626 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.161556 20626 net.cpp:156] Memory required for data: 16396
I0925 23:03:33.161566 20626 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0925 23:03:33.153503 20584 net.cpp:141] Setting up lstm1_cont_slice
I0925 23:03:33.161604 20584 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.161615 20584 net.cpp:156] Memory required for data: 10008
I0925 23:03:33.161625 20584 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0925 23:03:33.161641 20584 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0925 23:03:33.161654 20584 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0925 23:03:33.153475 20634 net.cpp:141] Setting up lstm1_cont_slice
I0925 23:03:33.161691 20634 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.161702 20634 net.cpp:156] Memory required for data: 10008
I0925 23:03:33.161713 20634 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0925 23:03:33.153241 20590 net.cpp:141] Setting up lstm1_h_conted_0
I0925 23:03:33.161803 20594 net.cpp:91] Creating Layer lstm1_x_transform
I0925 23:03:33.161819 20594 net.cpp:425] lstm1_x_transform <- x
I0925 23:03:33.161815 20602 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0925 23:03:33.161840 20594 net.cpp:399] lstm1_x_transform -> W_xc_x
I0925 23:03:33.161875 20602 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0925 23:03:33.161887 20588 net.cpp:399] lstm1_cont_slice -> cont_1
I0925 23:03:33.161926 20626 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0925 23:03:33.161942 20626 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0925 23:03:33.161957 20626 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0925 23:03:33.161975 20626 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0925 23:03:33.162009 20634 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0925 23:03:33.162022 20634 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0925 23:03:33.162039 20634 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0925 23:03:33.162065 20634 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0925 23:03:33.162099 20584 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0925 23:03:33.162120 20584 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0925 23:03:33.162183 20590 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.162196 20590 net.cpp:156] Memory required for data: 46016
I0925 23:03:33.162206 20590 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0925 23:03:33.162271 20590 net.cpp:91] Creating Layer lstm1_transform_1
I0925 23:03:33.162283 20590 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0925 23:03:33.162299 20590 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0925 23:03:33.164203 20638 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0925 23:03:33.164225 20638 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.164239 20638 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.164249 20638 net.cpp:156] Memory required for data: 10016
I0925 23:03:33.164259 20638 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0925 23:03:33.164297 20638 net.cpp:91] Creating Layer lstm1_x_transform
I0925 23:03:33.164311 20638 net.cpp:425] lstm1_x_transform <- x
I0925 23:03:33.164330 20638 net.cpp:399] lstm1_x_transform -> W_xc_x
I0925 23:03:33.170313 20602 net.cpp:141] Setting up cont_sentence_input_1_split
I0925 23:03:33.170356 20602 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.170367 20602 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.170374 20602 net.cpp:156] Memory required for data: 16404
I0925 23:03:33.170385 20602 layer_factory.hpp:77] Creating layer embed_encoder
I0925 23:03:33.170411 20602 net.cpp:91] Creating Layer embed_encoder
I0925 23:03:33.170420 20602 net.cpp:425] embed_encoder <- frames_fc7
I0925 23:03:33.170436 20602 net.cpp:399] embed_encoder -> embedded_in_frames
I0925 23:03:33.176205 20626 net.cpp:141] Setting up cont_sentence_input_1_split
I0925 23:03:33.176262 20626 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.176278 20626 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.176288 20626 net.cpp:156] Memory required for data: 16404
I0925 23:03:33.176302 20626 layer_factory.hpp:77] Creating layer embed_encoder
I0925 23:03:33.176342 20626 net.cpp:91] Creating Layer embed_encoder
I0925 23:03:33.176357 20626 net.cpp:425] embed_encoder <- frames_fc7
I0925 23:03:33.176379 20626 net.cpp:399] embed_encoder -> embedded_in_frames
I0925 23:03:33.182754 20634 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0925 23:03:33.182809 20634 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.182822 20634 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.182831 20634 net.cpp:156] Memory required for data: 10016
I0925 23:03:33.182843 20634 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0925 23:03:33.182883 20634 net.cpp:91] Creating Layer lstm1_x_transform
I0925 23:03:33.182895 20634 net.cpp:425] lstm1_x_transform <- x
I0925 23:03:33.182914 20634 net.cpp:399] lstm1_x_transform -> W_xc_x
I0925 23:03:33.200515 20588 net.cpp:141] Setting up lstm1_cont_slice
I0925 23:03:33.200567 20588 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.200574 20588 net.cpp:156] Memory required for data: 10008
I0925 23:03:33.200588 20588 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0925 23:03:33.202051 20588 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0925 23:03:33.202066 20588 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0925 23:03:33.202082 20588 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0925 23:03:33.202168 20588 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0925 23:03:33.211146 20608 net.cpp:141] Setting up lstm1_
I0925 23:03:33.211194 20608 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.211201 20608 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.211206 20608 net.cpp:156] Memory required for data: 10004
I0925 23:03:33.211216 20608 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0925 23:03:33.211237 20608 net.cpp:91] Creating Layer lstm1_cont_slice
I0925 23:03:33.211246 20608 net.cpp:425] lstm1_cont_slice <- cont
I0925 23:03:33.211238 20584 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0925 23:03:33.211261 20608 net.cpp:399] lstm1_cont_slice -> cont_1
I0925 23:03:33.211297 20584 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.211313 20584 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.211321 20584 net.cpp:156] Memory required for data: 10016
I0925 23:03:33.211324 20588 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0925 23:03:33.211334 20584 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0925 23:03:33.211344 20588 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.211354 20588 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.211361 20588 net.cpp:156] Memory required for data: 10016
I0925 23:03:33.211369 20584 net.cpp:91] Creating Layer lstm1_x_transform
I0925 23:03:33.211377 20608 net.cpp:141] Setting up lstm1_cont_slice
I0925 23:03:33.211386 20584 net.cpp:425] lstm1_x_transform <- x
I0925 23:03:33.211369 20588 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0925 23:03:33.211400 20608 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.211405 20608 net.cpp:156] Memory required for data: 10008
I0925 23:03:33.211406 20584 net.cpp:399] lstm1_x_transform -> W_xc_x
I0925 23:03:33.211416 20588 net.cpp:91] Creating Layer lstm1_x_transform
I0925 23:03:33.211411 20608 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0925 23:03:33.211426 20588 net.cpp:425] lstm1_x_transform <- x
I0925 23:03:33.211441 20608 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0925 23:03:33.211441 20588 net.cpp:399] lstm1_x_transform -> W_xc_x
I0925 23:03:33.211447 20608 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0925 23:03:33.211455 20608 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0925 23:03:33.211467 20608 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0925 23:03:33.213413 20608 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0925 23:03:33.213431 20608 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.213438 20608 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.213443 20608 net.cpp:156] Memory required for data: 10016
I0925 23:03:33.213449 20608 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0925 23:03:33.213462 20608 net.cpp:91] Creating Layer lstm1_x_transform
I0925 23:03:33.213469 20608 net.cpp:425] lstm1_x_transform <- x
I0925 23:03:33.213479 20608 net.cpp:399] lstm1_x_transform -> W_xc_x
I0925 23:03:33.228332 20602 net.cpp:141] Setting up embed_encoder
I0925 23:03:33.228375 20602 net.cpp:148] Top shape: 1 500 (500)
I0925 23:03:33.228380 20602 net.cpp:156] Memory required for data: 18404
I0925 23:03:33.228402 20602 layer_factory.hpp:77] Creating layer reshape_frames
I0925 23:03:33.228425 20602 net.cpp:91] Creating Layer reshape_frames
I0925 23:03:33.228432 20602 net.cpp:425] reshape_frames <- embedded_in_frames
I0925 23:03:33.228444 20602 net.cpp:399] reshape_frames -> embedded_input_frames
I0925 23:03:33.228490 20602 net.cpp:141] Setting up reshape_frames
I0925 23:03:33.228502 20602 net.cpp:148] Top shape: 1 1 500 (500)
I0925 23:03:33.228509 20602 net.cpp:156] Memory required for data: 20404
I0925 23:03:33.228516 20602 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0925 23:03:33.228531 20602 net.cpp:91] Creating Layer reshape_stage_indicator
I0925 23:03:33.228540 20602 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0925 23:03:33.228551 20602 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0925 23:03:33.228616 20602 net.cpp:141] Setting up reshape_stage_indicator
I0925 23:03:33.228631 20602 net.cpp:148] Top shape: 1 1 1 (1)
I0925 23:03:33.228639 20602 net.cpp:156] Memory required for data: 20408
I0925 23:03:33.228647 20602 layer_factory.hpp:77] Creating layer embedding
I0925 23:03:33.228664 20602 net.cpp:91] Creating Layer embedding
I0925 23:03:33.228674 20602 net.cpp:425] embedding <- input_sentence
I0925 23:03:33.228688 20602 net.cpp:399] embedding -> embedded_input_sentence
I0925 23:03:33.284003 20590 net.cpp:141] Setting up lstm1_transform_1
I0925 23:03:33.284050 20590 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.284060 20590 net.cpp:156] Memory required for data: 62016
I0925 23:03:33.284085 20590 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0925 23:03:33.284111 20590 net.cpp:91] Creating Layer lstm1_gate_input_1
I0925 23:03:33.284122 20590 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0925 23:03:33.284135 20590 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0925 23:03:33.284155 20590 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0925 23:03:33.284440 20584 net.cpp:141] Setting up lstm1_x_transform
I0925 23:03:33.284461 20584 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.284469 20584 net.cpp:156] Memory required for data: 26016
I0925 23:03:33.284479 20608 net.cpp:141] Setting up lstm1_x_transform
I0925 23:03:33.284492 20584 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0925 23:03:33.284498 20608 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.284505 20608 net.cpp:156] Memory required for data: 26016
I0925 23:03:33.284510 20584 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0925 23:03:33.284520 20584 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0925 23:03:33.284523 20608 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0925 23:03:33.284533 20584 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0925 23:03:33.284535 20608 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0925 23:03:33.284546 20608 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0925 23:03:33.284559 20608 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0925 23:03:33.284559 20626 net.cpp:141] Setting up embed_encoder
I0925 23:03:33.284597 20626 net.cpp:148] Top shape: 1 500 (500)
I0925 23:03:33.284603 20626 net.cpp:156] Memory required for data: 18404
I0925 23:03:33.284615 20584 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0925 23:03:33.284622 20626 layer_factory.hpp:77] Creating layer reshape_frames
I0925 23:03:33.284631 20584 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.284638 20584 net.cpp:156] Memory required for data: 42016
I0925 23:03:33.284643 20626 net.cpp:91] Creating Layer reshape_frames
I0925 23:03:33.284646 20584 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0925 23:03:33.284652 20626 net.cpp:425] reshape_frames <- embedded_in_frames
I0925 23:03:33.284659 20634 net.cpp:141] Setting up lstm1_x_transform
I0925 23:03:33.284664 20626 net.cpp:399] reshape_frames -> embedded_input_frames
I0925 23:03:33.284687 20634 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.284693 20634 net.cpp:156] Memory required for data: 26016
I0925 23:03:33.284708 20634 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0925 23:03:33.284719 20634 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0925 23:03:33.284726 20634 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0925 23:03:33.284735 20634 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0925 23:03:33.284749 20626 net.cpp:141] Setting up reshape_frames
I0925 23:03:33.284761 20626 net.cpp:148] Top shape: 1 1 500 (500)
I0925 23:03:33.284765 20626 net.cpp:156] Memory required for data: 20404
I0925 23:03:33.284771 20626 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0925 23:03:33.284782 20626 net.cpp:91] Creating Layer reshape_stage_indicator
I0925 23:03:33.284788 20626 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0925 23:03:33.284798 20626 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0925 23:03:33.284898 20608 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0925 23:03:33.284914 20608 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.284921 20608 net.cpp:156] Memory required for data: 42016
I0925 23:03:33.284929 20608 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0925 23:03:33.284942 20608 net.cpp:91] Creating Layer lstm1_h_conted_0
I0925 23:03:33.284950 20608 net.cpp:425] lstm1_h_conted_0 <- h_0
I0925 23:03:33.284960 20608 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0925 23:03:33.284971 20608 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0925 23:03:33.284977 20634 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0925 23:03:33.284991 20634 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.284996 20634 net.cpp:156] Memory required for data: 42016
I0925 23:03:33.285001 20634 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0925 23:03:33.285012 20634 net.cpp:91] Creating Layer lstm1_h_conted_0
I0925 23:03:33.285019 20634 net.cpp:425] lstm1_h_conted_0 <- h_0
I0925 23:03:33.285027 20634 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0925 23:03:33.285034 20634 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0925 23:03:33.285032 20638 net.cpp:141] Setting up lstm1_x_transform
I0925 23:03:33.285040 20626 net.cpp:141] Setting up reshape_stage_indicator
I0925 23:03:33.285051 20638 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.285053 20626 net.cpp:148] Top shape: 1 1 1 (1)
I0925 23:03:33.285058 20638 net.cpp:156] Memory required for data: 26016
I0925 23:03:33.285058 20626 net.cpp:156] Memory required for data: 20408
I0925 23:03:33.285076 20626 layer_factory.hpp:77] Creating layer embedding
I0925 23:03:33.285080 20638 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0925 23:03:33.285089 20626 net.cpp:91] Creating Layer embedding
I0925 23:03:33.285095 20626 net.cpp:425] embedding <- input_sentence
I0925 23:03:33.285104 20638 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0925 23:03:33.285107 20626 net.cpp:399] embedding -> embedded_input_sentence
I0925 23:03:33.285106 20588 net.cpp:141] Setting up lstm1_x_transform
I0925 23:03:33.285111 20638 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0925 23:03:33.285128 20588 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.285135 20588 net.cpp:156] Memory required for data: 26016
I0925 23:03:33.285135 20638 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0925 23:03:33.285147 20588 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0925 23:03:33.285157 20588 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0925 23:03:33.285163 20588 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0925 23:03:33.285172 20588 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0925 23:03:33.285264 20594 net.cpp:141] Setting up lstm1_x_transform
I0925 23:03:33.285276 20594 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.285281 20594 net.cpp:156] Memory required for data: 26016
I0925 23:03:33.285296 20594 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0925 23:03:33.285297 20638 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0925 23:03:33.285305 20594 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0925 23:03:33.285311 20594 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0925 23:03:33.285313 20638 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.285318 20638 net.cpp:156] Memory required for data: 42016
I0925 23:03:33.285320 20594 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0925 23:03:33.285325 20638 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0925 23:03:33.285336 20638 net.cpp:91] Creating Layer lstm1_h_conted_0
I0925 23:03:33.285343 20638 net.cpp:425] lstm1_h_conted_0 <- h_0
I0925 23:03:33.285351 20638 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0925 23:03:33.285387 20638 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0925 23:03:33.285399 20588 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0925 23:03:33.285411 20588 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.285416 20588 net.cpp:156] Memory required for data: 42016
I0925 23:03:33.285423 20588 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0925 23:03:33.285431 20588 net.cpp:91] Creating Layer lstm1_h_conted_0
I0925 23:03:33.285437 20588 net.cpp:425] lstm1_h_conted_0 <- h_0
I0925 23:03:33.285444 20588 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0925 23:03:33.285452 20588 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0925 23:03:33.285564 20588 net.cpp:141] Setting up lstm1_h_conted_0
I0925 23:03:33.285574 20588 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.285579 20588 net.cpp:156] Memory required for data: 46016
I0925 23:03:33.285584 20588 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0925 23:03:33.285598 20588 net.cpp:91] Creating Layer lstm1_transform_1
I0925 23:03:33.285603 20588 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0925 23:03:33.285611 20588 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0925 23:03:33.285609 20594 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0925 23:03:33.285627 20594 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.285632 20594 net.cpp:156] Memory required for data: 42016
I0925 23:03:33.285639 20594 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0925 23:03:33.285653 20594 net.cpp:91] Creating Layer lstm1_h_conted_0
I0925 23:03:33.285660 20594 net.cpp:425] lstm1_h_conted_0 <- h_0
I0925 23:03:33.285666 20594 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0925 23:03:33.285676 20594 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0925 23:03:33.284667 20584 net.cpp:91] Creating Layer lstm1_h_conted_0
I0925 23:03:33.289680 20584 net.cpp:425] lstm1_h_conted_0 <- h_0
I0925 23:03:33.289717 20584 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0925 23:03:33.289746 20584 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0925 23:03:33.327637 20590 net.cpp:141] Setting up lstm1_gate_input_1
I0925 23:03:33.327688 20590 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.327694 20590 net.cpp:156] Memory required for data: 78016
I0925 23:03:33.327704 20590 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0925 23:03:33.327721 20590 net.cpp:91] Creating Layer lstm1_unit_1
I0925 23:03:33.327728 20590 net.cpp:425] lstm1_unit_1 <- c_0
I0925 23:03:33.327739 20590 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0925 23:03:33.327745 20590 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0925 23:03:33.327754 20590 net.cpp:399] lstm1_unit_1 -> c_1
I0925 23:03:33.327766 20590 net.cpp:399] lstm1_unit_1 -> h_1
I0925 23:03:33.327883 20590 net.cpp:141] Setting up lstm1_unit_1
I0925 23:03:33.327894 20590 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.327901 20590 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.327905 20590 net.cpp:156] Memory required for data: 86016
I0925 23:03:33.327911 20590 layer_factory.hpp:77] Creating layer lstm1_
I0925 23:03:33.327920 20590 net.cpp:91] Creating Layer lstm1_
I0925 23:03:33.327925 20590 net.cpp:425] lstm1_ <- c_1
I0925 23:03:33.327935 20590 net.cpp:399] lstm1_ -> c_T
I0925 23:03:33.328002 20608 net.cpp:141] Setting up lstm1_h_conted_0
I0925 23:03:33.328017 20608 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.328023 20608 net.cpp:156] Memory required for data: 46016
I0925 23:03:33.328032 20608 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0925 23:03:33.328053 20608 net.cpp:91] Creating Layer lstm1_transform_1
I0925 23:03:33.328061 20608 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0925 23:03:33.328071 20608 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0925 23:03:33.328346 20590 net.cpp:141] Setting up lstm1_
I0925 23:03:33.328363 20590 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.328372 20590 net.cpp:156] Memory required for data: 90016
I0925 23:03:33.328380 20590 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0925 23:03:33.328402 20590 net.cpp:91] Creating Layer lstm1_h_concat
I0925 23:03:33.328411 20590 net.cpp:425] lstm1_h_concat <- h_1
I0925 23:03:33.328423 20590 net.cpp:399] lstm1_h_concat -> h
I0925 23:03:33.328462 20634 net.cpp:141] Setting up lstm1_h_conted_0
I0925 23:03:33.328483 20590 net.cpp:141] Setting up lstm1_h_concat
I0925 23:03:33.328511 20634 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.328521 20590 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.328536 20590 net.cpp:156] Memory required for data: 94016
I0925 23:03:33.328522 20634 net.cpp:156] Memory required for data: 46016
I0925 23:03:33.328542 20590 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 23:03:33.328549 20634 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0925 23:03:33.328560 20590 net.cpp:91] Creating Layer h_pseudoloss
I0925 23:03:33.328569 20590 net.cpp:425] h_pseudoloss <- h
I0925 23:03:33.328573 20634 net.cpp:91] Creating Layer lstm1_transform_1
I0925 23:03:33.328584 20634 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0925 23:03:33.328603 20634 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0925 23:03:33.328619 20590 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 23:03:33.328620 20638 net.cpp:141] Setting up lstm1_h_conted_0
I0925 23:03:33.328655 20638 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.328672 20638 net.cpp:156] Memory required for data: 46016
I0925 23:03:33.328690 20638 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0925 23:03:33.328739 20638 net.cpp:91] Creating Layer lstm1_transform_1
I0925 23:03:33.328761 20638 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0925 23:03:33.328788 20638 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0925 23:03:33.343019 20594 net.cpp:141] Setting up lstm1_h_conted_0
I0925 23:03:33.343068 20594 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.343078 20594 net.cpp:156] Memory required for data: 46016
I0925 23:03:33.343091 20594 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0925 23:03:33.343119 20594 net.cpp:91] Creating Layer lstm1_transform_1
I0925 23:03:33.343130 20594 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0925 23:03:33.343149 20594 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0925 23:03:33.374361 20584 net.cpp:141] Setting up lstm1_h_conted_0
I0925 23:03:33.374413 20584 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.374423 20584 net.cpp:156] Memory required for data: 46016
I0925 23:03:33.374435 20584 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0925 23:03:33.374462 20584 net.cpp:91] Creating Layer lstm1_transform_1
I0925 23:03:33.374476 20584 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0925 23:03:33.374495 20584 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0925 23:03:33.394163 20588 net.cpp:141] Setting up lstm1_transform_1
I0925 23:03:33.394229 20590 net.cpp:141] Setting up h_pseudoloss
I0925 23:03:33.394235 20588 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.394259 20588 net.cpp:156] Memory required for data: 62016
I0925 23:03:33.394260 20590 net.cpp:148] Top shape: (1)
I0925 23:03:33.394294 20588 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0925 23:03:33.394318 20588 net.cpp:91] Creating Layer lstm1_gate_input_1
I0925 23:03:33.394282 20590 net.cpp:151]     with loss weight 1
I0925 23:03:33.394330 20588 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0925 23:03:33.394332 20590 net.cpp:156] Memory required for data: 94020
I0925 23:03:33.394340 20588 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0925 23:03:33.394342 20590 net.cpp:217] h_pseudoloss needs backward computation.
I0925 23:03:33.394351 20590 net.cpp:217] lstm1_h_concat needs backward computation.
I0925 23:03:33.394353 20588 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0925 23:03:33.394358 20590 net.cpp:219] lstm1_ does not need backward computation.
I0925 23:03:33.394367 20590 net.cpp:217] lstm1_unit_1 needs backward computation.
I0925 23:03:33.394377 20590 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0925 23:03:33.394387 20590 net.cpp:217] lstm1_transform_1 needs backward computation.
I0925 23:03:33.394394 20590 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0925 23:03:33.394403 20590 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0925 23:03:33.394412 20590 net.cpp:217] lstm1_x_transform needs backward computation.
I0925 23:03:33.394418 20590 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0925 23:03:33.394428 20590 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0925 23:03:33.394436 20590 net.cpp:219] lstm1_ does not need backward computation.
I0925 23:03:33.394443 20590 net.cpp:219] lstm1_ does not need backward computation.
I0925 23:03:33.394449 20590 net.cpp:261] This network produces output c_T
I0925 23:03:33.394456 20590 net.cpp:261] This network produces output h_pseudoloss
I0925 23:03:33.402832 20590 net.cpp:274] Network initialization done.
I0925 23:03:33.403069 20590 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 23:03:33.403102 20590 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 23:03:33.403112 20590 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 23:03:33.437013 20594 net.cpp:141] Setting up lstm1_transform_1
I0925 23:03:33.437075 20594 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.437086 20594 net.cpp:156] Memory required for data: 62016
I0925 23:03:33.437119 20594 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0925 23:03:33.437153 20594 net.cpp:91] Creating Layer lstm1_gate_input_1
I0925 23:03:33.437165 20594 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0925 23:03:33.437178 20594 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0925 23:03:33.437192 20594 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0925 23:03:33.437311 20594 net.cpp:141] Setting up lstm1_gate_input_1
I0925 23:03:33.437342 20594 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.437356 20594 net.cpp:156] Memory required for data: 78016
I0925 23:03:33.437372 20594 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0925 23:03:33.437397 20594 net.cpp:91] Creating Layer lstm1_unit_1
I0925 23:03:33.437397 20638 net.cpp:141] Setting up lstm1_transform_1
I0925 23:03:33.437427 20594 net.cpp:425] lstm1_unit_1 <- c_0
I0925 23:03:33.437440 20638 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.437444 20594 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0925 23:03:33.437451 20638 net.cpp:156] Memory required for data: 62016
I0925 23:03:33.437474 20638 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0925 23:03:33.437458 20608 net.cpp:141] Setting up lstm1_transform_1
I0925 23:03:33.437520 20638 net.cpp:91] Creating Layer lstm1_gate_input_1
I0925 23:03:33.437528 20608 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.437536 20638 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0925 23:03:33.437541 20608 net.cpp:156] Memory required for data: 62016
I0925 23:03:33.437551 20638 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0925 23:03:33.437568 20608 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0925 23:03:33.437587 20638 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0925 23:03:33.437592 20608 net.cpp:91] Creating Layer lstm1_gate_input_1
I0925 23:03:33.437614 20608 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0925 23:03:33.437623 20608 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0925 23:03:33.437633 20608 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0925 23:03:33.437679 20638 net.cpp:141] Setting up lstm1_gate_input_1
I0925 23:03:33.437698 20638 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.437711 20638 net.cpp:156] Memory required for data: 78016
I0925 23:03:33.437726 20638 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0925 23:03:33.437733 20590 net.cpp:141] Setting up lstm1
I0925 23:03:33.437757 20590 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.437760 20608 net.cpp:141] Setting up lstm1_gate_input_1
I0925 23:03:33.437767 20590 net.cpp:156] Memory required for data: 26408
I0925 23:03:33.437777 20608 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.437775 20638 net.cpp:91] Creating Layer lstm1_unit_1
I0925 23:03:33.437784 20608 net.cpp:156] Memory required for data: 78016
I0925 23:03:33.437793 20590 layer_factory.hpp:77] Creating layer concat
I0925 23:03:33.437794 20608 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0925 23:03:33.437796 20638 net.cpp:425] lstm1_unit_1 <- c_0
I0925 23:03:33.437809 20590 net.cpp:91] Creating Layer concat
I0925 23:03:33.437809 20608 net.cpp:91] Creating Layer lstm1_unit_1
I0925 23:03:33.437819 20638 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0925 23:03:33.437825 20590 net.cpp:425] concat <- lstm1
I0925 23:03:33.437829 20608 net.cpp:425] lstm1_unit_1 <- c_0
I0925 23:03:33.437841 20638 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0925 23:03:33.437844 20608 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0925 23:03:33.437844 20590 net.cpp:425] concat <- embedded_input_sentence
I0925 23:03:33.437861 20608 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0925 23:03:33.437863 20590 net.cpp:425] concat <- reshaped_stage_indicator
I0925 23:03:33.437870 20638 net.cpp:399] lstm1_unit_1 -> c_1
I0925 23:03:33.437875 20608 net.cpp:399] lstm1_unit_1 -> c_1
I0925 23:03:33.437875 20590 net.cpp:399] concat -> lstm1_video_sequence
I0925 23:03:33.437907 20638 net.cpp:399] lstm1_unit_1 -> h_1
I0925 23:03:33.437909 20608 net.cpp:399] lstm1_unit_1 -> h_1
I0925 23:03:33.437964 20590 net.cpp:141] Setting up concat
I0925 23:03:33.437981 20590 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 23:03:33.437990 20590 net.cpp:156] Memory required for data: 32412
I0925 23:03:33.437999 20590 layer_factory.hpp:77] Creating layer lstm2
I0925 23:03:33.438020 20590 net.cpp:91] Creating Layer lstm2
I0925 23:03:33.438030 20590 net.cpp:425] lstm2 <- lstm1_video_sequence
I0925 23:03:33.438040 20590 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0925 23:03:33.438051 20608 net.cpp:141] Setting up lstm1_unit_1
I0925 23:03:33.438055 20590 net.cpp:399] lstm2 -> lstm2
I0925 23:03:33.438066 20608 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.438073 20590 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 23:03:33.438077 20608 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.438083 20608 net.cpp:156] Memory required for data: 86016
I0925 23:03:33.438091 20608 layer_factory.hpp:77] Creating layer lstm1_
I0925 23:03:33.438104 20608 net.cpp:91] Creating Layer lstm1_
I0925 23:03:33.438112 20608 net.cpp:425] lstm1_ <- c_1
I0925 23:03:33.438124 20608 net.cpp:399] lstm1_ -> c_T
I0925 23:03:33.438205 20638 net.cpp:141] Setting up lstm1_unit_1
I0925 23:03:33.438225 20638 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.438236 20638 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.438246 20638 net.cpp:156] Memory required for data: 86016
I0925 23:03:33.438254 20638 layer_factory.hpp:77] Creating layer lstm1_
I0925 23:03:33.438268 20638 net.cpp:91] Creating Layer lstm1_
I0925 23:03:33.438277 20638 net.cpp:425] lstm1_ <- c_1
I0925 23:03:33.438282 20608 net.cpp:141] Setting up lstm1_
I0925 23:03:33.438299 20608 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.438309 20608 net.cpp:156] Memory required for data: 90016
I0925 23:03:33.438313 20638 net.cpp:399] lstm1_ -> c_T
I0925 23:03:33.438319 20608 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0925 23:03:33.438338 20608 net.cpp:91] Creating Layer lstm1_h_concat
I0925 23:03:33.438346 20608 net.cpp:425] lstm1_h_concat <- h_1
I0925 23:03:33.438359 20608 net.cpp:399] lstm1_h_concat -> h
I0925 23:03:33.438388 20638 net.cpp:141] Setting up lstm1_
I0925 23:03:33.438405 20638 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.438413 20638 net.cpp:156] Memory required for data: 90016
I0925 23:03:33.438422 20638 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0925 23:03:33.438437 20638 net.cpp:91] Creating Layer lstm1_h_concat
I0925 23:03:33.438446 20608 net.cpp:141] Setting up lstm1_h_concat
I0925 23:03:33.438468 20608 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.438477 20608 net.cpp:156] Memory required for data: 94016
I0925 23:03:33.438485 20608 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 23:03:33.438499 20608 net.cpp:91] Creating Layer h_pseudoloss
I0925 23:03:33.438508 20608 net.cpp:425] h_pseudoloss <- h
I0925 23:03:33.438524 20608 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 23:03:33.438545 20590 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 23:03:33.438733 20608 net.cpp:141] Setting up h_pseudoloss
I0925 23:03:33.438733 20590 layer_factory.hpp:77] Creating layer lstm2_
I0925 23:03:33.438766 20608 net.cpp:148] Top shape: (1)
I0925 23:03:33.438776 20590 net.cpp:91] Creating Layer lstm2_
I0925 23:03:33.438776 20608 net.cpp:151]     with loss weight 1
I0925 23:03:33.438787 20590 net.cpp:399] lstm2_ -> x
I0925 23:03:33.438792 20608 net.cpp:156] Memory required for data: 94020
I0925 23:03:33.438802 20608 net.cpp:217] h_pseudoloss needs backward computation.
I0925 23:03:33.438805 20590 net.cpp:399] lstm2_ -> cont
I0925 23:03:33.438810 20608 net.cpp:217] lstm1_h_concat needs backward computation.
I0925 23:03:33.438818 20608 net.cpp:219] lstm1_ does not need backward computation.
I0925 23:03:33.438827 20608 net.cpp:217] lstm1_unit_1 needs backward computation.
I0925 23:03:33.438838 20608 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0925 23:03:33.438848 20608 net.cpp:217] lstm1_transform_1 needs backward computation.
I0925 23:03:33.438858 20608 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0925 23:03:33.438869 20608 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0925 23:03:33.438879 20608 net.cpp:217] lstm1_x_transform needs backward computation.
I0925 23:03:33.438887 20590 net.cpp:141] Setting up lstm2_
I0925 23:03:33.438911 20590 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 23:03:33.438923 20590 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.438931 20590 net.cpp:156] Memory required for data: 6008
I0925 23:03:33.438941 20590 layer_factory.hpp:77] Creating layer lstm2_
I0925 23:03:33.438956 20590 net.cpp:91] Creating Layer lstm2_
I0925 23:03:33.438967 20590 net.cpp:399] lstm2_ -> c_0
I0925 23:03:33.439009 20590 net.cpp:399] lstm2_ -> h_0
I0925 23:03:33.439105 20590 net.cpp:141] Setting up lstm2_
I0925 23:03:33.439122 20590 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.439133 20590 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.439141 20590 net.cpp:156] Memory required for data: 14008
I0925 23:03:33.439148 20590 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0925 23:03:33.439163 20590 net.cpp:91] Creating Layer lstm2_cont_slice
I0925 23:03:33.439172 20590 net.cpp:425] lstm2_cont_slice <- cont
I0925 23:03:33.439214 20590 net.cpp:399] lstm2_cont_slice -> cont_1
I0925 23:03:33.438887 20608 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0925 23:03:33.439239 20608 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0925 23:03:33.439250 20608 net.cpp:219] lstm1_ does not need backward computation.
I0925 23:03:33.439259 20608 net.cpp:219] lstm1_ does not need backward computation.
I0925 23:03:33.439266 20608 net.cpp:261] This network produces output c_T
I0925 23:03:33.439275 20608 net.cpp:261] This network produces output h_pseudoloss
I0925 23:03:33.439281 20590 net.cpp:141] Setting up lstm2_cont_slice
I0925 23:03:33.439294 20590 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.439303 20590 net.cpp:156] Memory required for data: 14012
I0925 23:03:33.439303 20608 net.cpp:274] Network initialization done.
I0925 23:03:33.439317 20590 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0925 23:03:33.439330 20590 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0925 23:03:33.439339 20590 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0925 23:03:33.439378 20608 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 23:03:33.439389 20608 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 23:03:33.439394 20590 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0925 23:03:33.439399 20608 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 23:03:33.437461 20594 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0925 23:03:33.439412 20590 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0925 23:03:33.439427 20594 net.cpp:399] lstm1_unit_1 -> c_1
I0925 23:03:33.439450 20594 net.cpp:399] lstm1_unit_1 -> h_1
I0925 23:03:33.439627 20590 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0925 23:03:33.439646 20590 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.439656 20590 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.439664 20590 net.cpp:156] Memory required for data: 14020
I0925 23:03:33.439664 20608 net.cpp:141] Setting up lstm1
I0925 23:03:33.439672 20590 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0925 23:03:33.439678 20608 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.439687 20608 net.cpp:156] Memory required for data: 26408
I0925 23:03:33.439713 20608 layer_factory.hpp:77] Creating layer concat
I0925 23:03:33.439721 20590 net.cpp:91] Creating Layer lstm2_x_transform
I0925 23:03:33.439729 20608 net.cpp:91] Creating Layer concat
I0925 23:03:33.439730 20590 net.cpp:425] lstm2_x_transform <- x
I0925 23:03:33.439744 20608 net.cpp:425] concat <- lstm1
I0925 23:03:33.439754 20590 net.cpp:399] lstm2_x_transform -> W_xc_x
I0925 23:03:33.439757 20608 net.cpp:425] concat <- embedded_input_sentence
I0925 23:03:33.439766 20608 net.cpp:425] concat <- reshaped_stage_indicator
I0925 23:03:33.439779 20608 net.cpp:399] concat -> lstm1_video_sequence
I0925 23:03:33.439803 20594 net.cpp:141] Setting up lstm1_unit_1
I0925 23:03:33.439832 20594 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.439849 20594 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.439862 20594 net.cpp:156] Memory required for data: 86016
I0925 23:03:33.439872 20608 net.cpp:141] Setting up concat
I0925 23:03:33.439874 20594 layer_factory.hpp:77] Creating layer lstm1_
I0925 23:03:33.439895 20608 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 23:03:33.439904 20608 net.cpp:156] Memory required for data: 32412
I0925 23:03:33.439913 20608 layer_factory.hpp:77] Creating layer lstm2
I0925 23:03:33.439919 20594 net.cpp:91] Creating Layer lstm1_
I0925 23:03:33.439930 20608 net.cpp:91] Creating Layer lstm2
I0925 23:03:33.439940 20608 net.cpp:425] lstm2 <- lstm1_video_sequence
I0925 23:03:33.439941 20594 net.cpp:425] lstm1_ <- c_1
I0925 23:03:33.439952 20608 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0925 23:03:33.439963 20608 net.cpp:399] lstm2 -> lstm2
I0925 23:03:33.439965 20594 net.cpp:399] lstm1_ -> c_T
I0925 23:03:33.439999 20608 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 23:03:33.440354 20608 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 23:03:33.440488 20608 layer_factory.hpp:77] Creating layer lstm2_
I0925 23:03:33.440508 20608 net.cpp:91] Creating Layer lstm2_
I0925 23:03:33.440521 20608 net.cpp:399] lstm2_ -> x
I0925 23:03:33.440541 20608 net.cpp:399] lstm2_ -> cont
I0925 23:03:33.438447 20638 net.cpp:425] lstm1_h_concat <- h_1
I0925 23:03:33.447494 20638 net.cpp:399] lstm1_h_concat -> h
I0925 23:03:33.455338 20594 net.cpp:141] Setting up lstm1_
I0925 23:03:33.455384 20594 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.455391 20594 net.cpp:156] Memory required for data: 90016
I0925 23:03:33.455400 20594 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0925 23:03:33.455420 20594 net.cpp:91] Creating Layer lstm1_h_concat
I0925 23:03:33.455427 20594 net.cpp:425] lstm1_h_concat <- h_1
I0925 23:03:33.455446 20594 net.cpp:399] lstm1_h_concat -> h
I0925 23:03:33.455557 20638 net.cpp:141] Setting up lstm1_h_concat
I0925 23:03:33.455570 20638 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.455575 20638 net.cpp:156] Memory required for data: 94016
I0925 23:03:33.455581 20638 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 23:03:33.455592 20638 net.cpp:91] Creating Layer h_pseudoloss
I0925 23:03:33.455598 20638 net.cpp:425] h_pseudoloss <- h
I0925 23:03:33.455607 20638 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 23:03:33.455643 20584 net.cpp:141] Setting up lstm1_transform_1
I0925 23:03:33.455690 20584 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.455699 20584 net.cpp:156] Memory required for data: 62016
I0925 23:03:33.455700 20608 net.cpp:141] Setting up lstm2_
I0925 23:03:33.455726 20584 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0925 23:03:33.455735 20608 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 23:03:33.455740 20594 net.cpp:141] Setting up lstm1_h_concat
I0925 23:03:33.455760 20584 net.cpp:91] Creating Layer lstm1_gate_input_1
I0925 23:03:33.455768 20594 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.455768 20608 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.455775 20594 net.cpp:156] Memory required for data: 94016
I0925 23:03:33.455791 20608 net.cpp:156] Memory required for data: 6008
I0925 23:03:33.455797 20594 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 23:03:33.455793 20634 net.cpp:141] Setting up lstm1_transform_1
I0925 23:03:33.455822 20594 net.cpp:91] Creating Layer h_pseudoloss
I0925 23:03:33.455773 20584 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0925 23:03:33.455837 20594 net.cpp:425] h_pseudoloss <- h
I0925 23:03:33.455816 20608 layer_factory.hpp:77] Creating layer lstm2_
I0925 23:03:33.455847 20584 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0925 23:03:33.455833 20588 net.cpp:141] Setting up lstm1_gate_input_1
I0925 23:03:33.455862 20594 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 23:03:33.455839 20634 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.455875 20584 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0925 23:03:33.455868 20588 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.455888 20634 net.cpp:156] Memory required for data: 62016
I0925 23:03:33.455889 20588 net.cpp:156] Memory required for data: 78016
I0925 23:03:33.455899 20588 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0925 23:03:33.455884 20608 net.cpp:91] Creating Layer lstm2_
I0925 23:03:33.455917 20634 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0925 23:03:33.455919 20588 net.cpp:91] Creating Layer lstm1_unit_1
I0925 23:03:33.455936 20608 net.cpp:399] lstm2_ -> c_0
I0925 23:03:33.455943 20588 net.cpp:425] lstm1_unit_1 <- c_0
I0925 23:03:33.455994 20588 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0925 23:03:33.455997 20608 net.cpp:399] lstm2_ -> h_0
I0925 23:03:33.456007 20588 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0925 23:03:33.456022 20588 net.cpp:399] lstm1_unit_1 -> c_1
I0925 23:03:33.456022 20638 net.cpp:141] Setting up h_pseudoloss
I0925 23:03:33.456037 20588 net.cpp:399] lstm1_unit_1 -> h_1
I0925 23:03:33.456038 20638 net.cpp:148] Top shape: (1)
I0925 23:03:33.456061 20638 net.cpp:151]     with loss weight 1
I0925 23:03:33.456087 20638 net.cpp:156] Memory required for data: 94020
I0925 23:03:33.456097 20638 net.cpp:217] h_pseudoloss needs backward computation.
I0925 23:03:33.456105 20638 net.cpp:217] lstm1_h_concat needs backward computation.
I0925 23:03:33.455945 20634 net.cpp:91] Creating Layer lstm1_gate_input_1
I0925 23:03:33.456117 20638 net.cpp:219] lstm1_ does not need backward computation.
I0925 23:03:33.456127 20638 net.cpp:217] lstm1_unit_1 needs backward computation.
I0925 23:03:33.456126 20634 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0925 23:03:33.456143 20638 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0925 23:03:33.456147 20634 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0925 23:03:33.456161 20634 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0925 23:03:33.456184 20638 net.cpp:217] lstm1_transform_1 needs backward computation.
I0925 23:03:33.456197 20638 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0925 23:03:33.456207 20638 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0925 23:03:33.456217 20638 net.cpp:217] lstm1_x_transform needs backward computation.
I0925 23:03:33.456226 20638 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0925 23:03:33.456236 20638 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0925 23:03:33.456236 20594 net.cpp:141] Setting up h_pseudoloss
I0925 23:03:33.456246 20638 net.cpp:219] lstm1_ does not need backward computation.
I0925 23:03:33.456253 20594 net.cpp:148] Top shape: (1)
I0925 23:03:33.456255 20638 net.cpp:219] lstm1_ does not need backward computation.
I0925 23:03:33.456262 20638 net.cpp:261] This network produces output c_T
I0925 23:03:33.456260 20594 net.cpp:151]     with loss weight 1
I0925 23:03:33.456270 20638 net.cpp:261] This network produces output h_pseudoloss
I0925 23:03:33.456272 20594 net.cpp:156] Memory required for data: 94020
I0925 23:03:33.456280 20594 net.cpp:217] h_pseudoloss needs backward computation.
I0925 23:03:33.456288 20594 net.cpp:217] lstm1_h_concat needs backward computation.
I0925 23:03:33.456296 20594 net.cpp:219] lstm1_ does not need backward computation.
I0925 23:03:33.456321 20594 net.cpp:217] lstm1_unit_1 needs backward computation.
I0925 23:03:33.456331 20594 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0925 23:03:33.456334 20588 net.cpp:141] Setting up lstm1_unit_1
I0925 23:03:33.456339 20594 net.cpp:217] lstm1_transform_1 needs backward computation.
I0925 23:03:33.456351 20588 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.456296 20638 net.cpp:274] Network initialization done.
I0925 23:03:33.456362 20594 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0925 23:03:33.456379 20594 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0925 23:03:33.456388 20594 net.cpp:217] lstm1_x_transform needs backward computation.
I0925 23:03:33.456398 20594 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0925 23:03:33.456406 20594 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0925 23:03:33.456408 20634 net.cpp:141] Setting up lstm1_gate_input_1
I0925 23:03:33.456416 20594 net.cpp:219] lstm1_ does not need backward computation.
I0925 23:03:33.456363 20588 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.456429 20638 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 23:03:33.456434 20588 net.cpp:156] Memory required for data: 86016
I0925 23:03:33.456441 20638 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 23:03:33.456435 20594 net.cpp:219] lstm1_ does not need backward computation.
I0925 23:03:33.456449 20588 layer_factory.hpp:77] Creating layer lstm1_
I0925 23:03:33.456450 20638 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 23:03:33.456452 20594 net.cpp:261] This network produces output c_T
I0925 23:03:33.456462 20588 net.cpp:91] Creating Layer lstm1_
I0925 23:03:33.456468 20594 net.cpp:261] This network produces output h_pseudoloss
I0925 23:03:33.456423 20634 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.456481 20634 net.cpp:156] Memory required for data: 78016
I0925 23:03:33.456488 20634 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0925 23:03:33.456495 20594 net.cpp:274] Network initialization done.
I0925 23:03:33.456503 20634 net.cpp:91] Creating Layer lstm1_unit_1
I0925 23:03:33.456511 20634 net.cpp:425] lstm1_unit_1 <- c_0
I0925 23:03:33.456521 20634 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0925 23:03:33.456532 20634 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0925 23:03:33.456537 20594 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 23:03:33.456542 20634 net.cpp:399] lstm1_unit_1 -> c_1
I0925 23:03:33.456543 20594 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 23:03:33.456548 20608 net.cpp:141] Setting up lstm2_
I0925 23:03:33.456470 20588 net.cpp:425] lstm1_ <- c_1
I0925 23:03:33.456558 20594 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 23:03:33.456560 20634 net.cpp:399] lstm1_unit_1 -> h_1
I0925 23:03:33.456580 20588 net.cpp:399] lstm1_ -> c_T
I0925 23:03:33.456586 20608 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.456609 20608 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.456622 20608 net.cpp:156] Memory required for data: 14008
I0925 23:03:33.456637 20608 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0925 23:03:33.456665 20608 net.cpp:91] Creating Layer lstm2_cont_slice
I0925 23:03:33.456681 20608 net.cpp:425] lstm2_cont_slice <- cont
I0925 23:03:33.456707 20594 net.cpp:141] Setting up lstm1
I0925 23:03:33.456709 20608 net.cpp:399] lstm2_cont_slice -> cont_1
I0925 23:03:33.456719 20594 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.456742 20594 net.cpp:156] Memory required for data: 26408
I0925 23:03:33.456758 20594 layer_factory.hpp:77] Creating layer concat
I0925 23:03:33.456766 20594 net.cpp:91] Creating Layer concat
I0925 23:03:33.456773 20594 net.cpp:425] concat <- lstm1
I0925 23:03:33.456780 20594 net.cpp:425] concat <- embedded_input_sentence
I0925 23:03:33.456785 20594 net.cpp:425] concat <- reshaped_stage_indicator
I0925 23:03:33.456794 20594 net.cpp:399] concat -> lstm1_video_sequence
I0925 23:03:33.456809 20584 net.cpp:141] Setting up lstm1_gate_input_1
I0925 23:03:33.456827 20584 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.456835 20584 net.cpp:156] Memory required for data: 78016
I0925 23:03:33.456843 20584 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0925 23:03:33.456857 20584 net.cpp:91] Creating Layer lstm1_unit_1
I0925 23:03:33.456866 20584 net.cpp:425] lstm1_unit_1 <- c_0
I0925 23:03:33.456877 20584 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0925 23:03:33.456887 20584 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0925 23:03:33.456892 20588 net.cpp:141] Setting up lstm1_
I0925 23:03:33.456899 20584 net.cpp:399] lstm1_unit_1 -> c_1
I0925 23:03:33.456907 20588 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.456915 20588 net.cpp:156] Memory required for data: 90016
I0925 23:03:33.456918 20584 net.cpp:399] lstm1_unit_1 -> h_1
I0925 23:03:33.456923 20588 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0925 23:03:33.456940 20588 net.cpp:91] Creating Layer lstm1_h_concat
I0925 23:03:33.456948 20588 net.cpp:425] lstm1_h_concat <- h_1
I0925 23:03:33.456959 20588 net.cpp:399] lstm1_h_concat -> h
I0925 23:03:33.456996 20608 net.cpp:141] Setting up lstm2_cont_slice
I0925 23:03:33.457010 20608 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.457015 20608 net.cpp:156] Memory required for data: 14012
I0925 23:03:33.457021 20608 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0925 23:03:33.457031 20608 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0925 23:03:33.457037 20608 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0925 23:03:33.457046 20608 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0925 23:03:33.457056 20608 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0925 23:03:33.457062 20594 net.cpp:141] Setting up concat
I0925 23:03:33.457079 20594 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 23:03:33.457084 20594 net.cpp:156] Memory required for data: 32412
I0925 23:03:33.457089 20594 layer_factory.hpp:77] Creating layer lstm2
I0925 23:03:33.457105 20594 net.cpp:91] Creating Layer lstm2
I0925 23:03:33.457111 20594 net.cpp:425] lstm2 <- lstm1_video_sequence
I0925 23:03:33.457118 20594 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0925 23:03:33.457129 20594 net.cpp:399] lstm2 -> lstm2
I0925 23:03:33.457141 20594 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 23:03:33.457231 20584 net.cpp:141] Setting up lstm1_unit_1
I0925 23:03:33.457252 20584 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.457263 20584 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.457271 20584 net.cpp:156] Memory required for data: 86016
I0925 23:03:33.457279 20584 layer_factory.hpp:77] Creating layer lstm1_
I0925 23:03:33.457307 20584 net.cpp:91] Creating Layer lstm1_
I0925 23:03:33.457319 20584 net.cpp:425] lstm1_ <- c_1
I0925 23:03:33.457335 20584 net.cpp:399] lstm1_ -> c_T
I0925 23:03:33.457383 20588 net.cpp:141] Setting up lstm1_h_concat
I0925 23:03:33.457398 20588 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.457406 20588 net.cpp:156] Memory required for data: 94016
I0925 23:03:33.457414 20588 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 23:03:33.457427 20588 net.cpp:91] Creating Layer h_pseudoloss
I0925 23:03:33.457433 20588 net.cpp:425] h_pseudoloss <- h
I0925 23:03:33.457449 20588 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 23:03:33.457455 20638 net.cpp:141] Setting up lstm1
I0925 23:03:33.457470 20638 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.457468 20594 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 23:03:33.457475 20638 net.cpp:156] Memory required for data: 26408
I0925 23:03:33.457502 20638 layer_factory.hpp:77] Creating layer concat
I0925 23:03:33.457512 20638 net.cpp:91] Creating Layer concat
I0925 23:03:33.457520 20638 net.cpp:425] concat <- lstm1
I0925 23:03:33.457525 20638 net.cpp:425] concat <- embedded_input_sentence
I0925 23:03:33.457531 20638 net.cpp:425] concat <- reshaped_stage_indicator
I0925 23:03:33.457538 20638 net.cpp:399] concat -> lstm1_video_sequence
I0925 23:03:33.457540 20634 net.cpp:141] Setting up lstm1_unit_1
I0925 23:03:33.457558 20634 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.457569 20634 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.457577 20634 net.cpp:156] Memory required for data: 86016
I0925 23:03:33.457587 20634 layer_factory.hpp:77] Creating layer lstm1_
I0925 23:03:33.457593 20584 net.cpp:141] Setting up lstm1_
I0925 23:03:33.457598 20634 net.cpp:91] Creating Layer lstm1_
I0925 23:03:33.457625 20584 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.457619 20594 layer_factory.hpp:77] Creating layer lstm2_
I0925 23:03:33.457635 20584 net.cpp:156] Memory required for data: 90016
I0925 23:03:33.457646 20608 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0925 23:03:33.457648 20594 net.cpp:91] Creating Layer lstm2_
I0925 23:03:33.457636 20634 net.cpp:425] lstm1_ <- c_1
I0925 23:03:33.457661 20608 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.457665 20594 net.cpp:399] lstm2_ -> x
I0925 23:03:33.457671 20634 net.cpp:399] lstm1_ -> c_T
I0925 23:03:33.457660 20584 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0925 23:03:33.457674 20608 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.457684 20594 net.cpp:399] lstm2_ -> cont
I0925 23:03:33.457689 20608 net.cpp:156] Memory required for data: 14020
I0925 23:03:33.457691 20584 net.cpp:91] Creating Layer lstm1_h_concat
I0925 23:03:33.457695 20608 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0925 23:03:33.457707 20584 net.cpp:425] lstm1_h_concat <- h_1
I0925 23:03:33.457727 20608 net.cpp:91] Creating Layer lstm2_x_transform
I0925 23:03:33.457729 20584 net.cpp:399] lstm1_h_concat -> h
I0925 23:03:33.457736 20608 net.cpp:425] lstm2_x_transform <- x
I0925 23:03:33.457744 20608 net.cpp:399] lstm2_x_transform -> W_xc_x
I0925 23:03:33.457778 20634 net.cpp:141] Setting up lstm1_
I0925 23:03:33.457792 20634 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.457797 20634 net.cpp:156] Memory required for data: 90016
I0925 23:03:33.457803 20634 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0925 23:03:33.457814 20634 net.cpp:91] Creating Layer lstm1_h_concat
I0925 23:03:33.457813 20588 net.cpp:141] Setting up h_pseudoloss
I0925 23:03:33.457823 20634 net.cpp:425] lstm1_h_concat <- h_1
I0925 23:03:33.457831 20634 net.cpp:399] lstm1_h_concat -> h
I0925 23:03:33.457834 20588 net.cpp:148] Top shape: (1)
I0925 23:03:33.457839 20588 net.cpp:151]     with loss weight 1
I0925 23:03:33.457842 20638 net.cpp:141] Setting up concat
I0925 23:03:33.457849 20588 net.cpp:156] Memory required for data: 94020
I0925 23:03:33.457854 20588 net.cpp:217] h_pseudoloss needs backward computation.
I0925 23:03:33.457855 20638 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 23:03:33.457859 20588 net.cpp:217] lstm1_h_concat needs backward computation.
I0925 23:03:33.457860 20638 net.cpp:156] Memory required for data: 32412
I0925 23:03:33.457864 20588 net.cpp:219] lstm1_ does not need backward computation.
I0925 23:03:33.457866 20638 layer_factory.hpp:77] Creating layer lstm2
I0925 23:03:33.457868 20588 net.cpp:217] lstm1_unit_1 needs backward computation.
I0925 23:03:33.457875 20588 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0925 23:03:33.457877 20638 net.cpp:91] Creating Layer lstm2
I0925 23:03:33.457880 20588 net.cpp:217] lstm1_transform_1 needs backward computation.
I0925 23:03:33.457885 20638 net.cpp:425] lstm2 <- lstm1_video_sequence
I0925 23:03:33.457886 20588 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0925 23:03:33.457890 20638 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0925 23:03:33.457888 20594 net.cpp:141] Setting up lstm2_
I0925 23:03:33.457900 20638 net.cpp:399] lstm2 -> lstm2
I0925 23:03:33.457892 20588 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0925 23:03:33.457911 20638 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 23:03:33.457911 20594 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 23:03:33.457911 20588 net.cpp:217] lstm1_x_transform needs backward computation.
I0925 23:03:33.457924 20594 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.457926 20588 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0925 23:03:33.457929 20594 net.cpp:156] Memory required for data: 6008
I0925 23:03:33.457932 20588 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0925 23:03:33.457934 20594 layer_factory.hpp:77] Creating layer lstm2_
I0925 23:03:33.457938 20588 net.cpp:219] lstm1_ does not need backward computation.
I0925 23:03:33.457942 20588 net.cpp:219] lstm1_ does not need backward computation.
I0925 23:03:33.457945 20594 net.cpp:91] Creating Layer lstm2_
I0925 23:03:33.457947 20588 net.cpp:261] This network produces output c_T
I0925 23:03:33.457957 20588 net.cpp:261] This network produces output h_pseudoloss
I0925 23:03:33.457959 20594 net.cpp:399] lstm2_ -> c_0
I0925 23:03:33.457972 20594 net.cpp:399] lstm2_ -> h_0
I0925 23:03:33.457975 20588 net.cpp:274] Network initialization done.
I0925 23:03:33.457967 20584 net.cpp:141] Setting up lstm1_h_concat
I0925 23:03:33.458000 20584 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.458009 20584 net.cpp:156] Memory required for data: 94016
I0925 23:03:33.458017 20584 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 23:03:33.458020 20588 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 23:03:33.458027 20588 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 23:03:33.458031 20584 net.cpp:91] Creating Layer h_pseudoloss
I0925 23:03:33.458032 20588 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 23:03:33.458047 20584 net.cpp:425] h_pseudoloss <- h
I0925 23:03:33.458060 20584 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 23:03:33.458063 20634 net.cpp:141] Setting up lstm1_h_concat
I0925 23:03:33.458078 20634 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.458084 20634 net.cpp:156] Memory required for data: 94016
I0925 23:03:33.458093 20634 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 23:03:33.458102 20634 net.cpp:91] Creating Layer h_pseudoloss
I0925 23:03:33.458108 20634 net.cpp:425] h_pseudoloss <- h
I0925 23:03:33.458118 20634 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 23:03:33.458138 20638 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 23:03:33.458236 20638 layer_factory.hpp:77] Creating layer lstm2_
I0925 23:03:33.458248 20638 net.cpp:91] Creating Layer lstm2_
I0925 23:03:33.458256 20638 net.cpp:399] lstm2_ -> x
I0925 23:03:33.458272 20638 net.cpp:399] lstm2_ -> cont
I0925 23:03:33.458292 20588 net.cpp:141] Setting up lstm1
I0925 23:03:33.458304 20588 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.458309 20588 net.cpp:156] Memory required for data: 26408
I0925 23:03:33.458323 20588 layer_factory.hpp:77] Creating layer concat
I0925 23:03:33.458333 20588 net.cpp:91] Creating Layer concat
I0925 23:03:33.458338 20588 net.cpp:425] concat <- lstm1
I0925 23:03:33.458345 20588 net.cpp:425] concat <- embedded_input_sentence
I0925 23:03:33.458351 20588 net.cpp:425] concat <- reshaped_stage_indicator
I0925 23:03:33.458359 20588 net.cpp:399] concat -> lstm1_video_sequence
I0925 23:03:33.458369 20634 net.cpp:141] Setting up h_pseudoloss
I0925 23:03:33.458389 20634 net.cpp:148] Top shape: (1)
I0925 23:03:33.458400 20594 net.cpp:141] Setting up lstm2_
I0925 23:03:33.458398 20634 net.cpp:151]     with loss weight 1
I0925 23:03:33.458411 20634 net.cpp:156] Memory required for data: 94020
I0925 23:03:33.458413 20594 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.458420 20634 net.cpp:217] h_pseudoloss needs backward computation.
I0925 23:03:33.458423 20594 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.458428 20634 net.cpp:217] lstm1_h_concat needs backward computation.
I0925 23:03:33.458431 20594 net.cpp:156] Memory required for data: 14008
I0925 23:03:33.458442 20634 net.cpp:219] lstm1_ does not need backward computation.
I0925 23:03:33.458446 20594 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0925 23:03:33.458451 20634 net.cpp:217] lstm1_unit_1 needs backward computation.
I0925 23:03:33.458461 20594 net.cpp:91] Creating Layer lstm2_cont_slice
I0925 23:03:33.458461 20634 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0925 23:03:33.458473 20594 net.cpp:425] lstm2_cont_slice <- cont
I0925 23:03:33.458479 20634 net.cpp:217] lstm1_transform_1 needs backward computation.
I0925 23:03:33.458485 20594 net.cpp:399] lstm2_cont_slice -> cont_1
I0925 23:03:33.458488 20634 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0925 23:03:33.458498 20634 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0925 23:03:33.458508 20634 net.cpp:217] lstm1_x_transform needs backward computation.
I0925 23:03:33.458516 20634 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0925 23:03:33.458523 20634 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0925 23:03:33.458529 20634 net.cpp:219] lstm1_ does not need backward computation.
I0925 23:03:33.458534 20634 net.cpp:219] lstm1_ does not need backward computation.
I0925 23:03:33.458537 20634 net.cpp:261] This network produces output c_T
I0925 23:03:33.458542 20634 net.cpp:261] This network produces output h_pseudoloss
I0925 23:03:33.458561 20634 net.cpp:274] Network initialization done.
I0925 23:03:33.458616 20634 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 23:03:33.458624 20634 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 23:03:33.458628 20634 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 23:03:33.469591 20638 net.cpp:141] Setting up lstm2_
I0925 23:03:33.469660 20638 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 23:03:33.469666 20588 net.cpp:141] Setting up concat
I0925 23:03:33.469686 20638 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.469687 20588 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 23:03:33.469718 20638 net.cpp:156] Memory required for data: 6008
I0925 23:03:33.469722 20588 net.cpp:156] Memory required for data: 32412
I0925 23:03:33.469751 20588 layer_factory.hpp:77] Creating layer lstm2
I0925 23:03:33.469753 20638 layer_factory.hpp:77] Creating layer lstm2_
I0925 23:03:33.469784 20588 net.cpp:91] Creating Layer lstm2
I0925 23:03:33.469787 20638 net.cpp:91] Creating Layer lstm2_
I0925 23:03:33.469796 20588 net.cpp:425] lstm2 <- lstm1_video_sequence
I0925 23:03:33.469811 20588 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0925 23:03:33.469799 20584 net.cpp:141] Setting up h_pseudoloss
I0925 23:03:33.469826 20588 net.cpp:399] lstm2 -> lstm2
I0925 23:03:33.469856 20594 net.cpp:141] Setting up lstm2_cont_slice
I0925 23:03:33.469863 20588 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 23:03:33.469867 20584 net.cpp:148] Top shape: (1)
I0925 23:03:33.469879 20594 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.469892 20594 net.cpp:156] Memory required for data: 14012
I0925 23:03:33.469900 20594 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0925 23:03:33.469879 20584 net.cpp:151]     with loss weight 1
I0925 23:03:33.469913 20584 net.cpp:156] Memory required for data: 94020
I0925 23:03:33.469923 20594 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0925 23:03:33.469928 20584 net.cpp:217] h_pseudoloss needs backward computation.
I0925 23:03:33.469935 20594 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0925 23:03:33.469939 20584 net.cpp:217] lstm1_h_concat needs backward computation.
I0925 23:03:33.469949 20594 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0925 23:03:33.469950 20584 net.cpp:219] lstm1_ does not need backward computation.
I0925 23:03:33.469974 20594 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0925 23:03:33.469979 20584 net.cpp:217] lstm1_unit_1 needs backward computation.
I0925 23:03:33.469992 20584 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0925 23:03:33.470003 20584 net.cpp:217] lstm1_transform_1 needs backward computation.
I0925 23:03:33.470013 20584 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0925 23:03:33.470024 20584 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0925 23:03:33.470036 20584 net.cpp:217] lstm1_x_transform needs backward computation.
I0925 23:03:33.470046 20584 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0925 23:03:33.470057 20584 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0925 23:03:33.470070 20584 net.cpp:219] lstm1_ does not need backward computation.
I0925 23:03:33.470080 20584 net.cpp:219] lstm1_ does not need backward computation.
I0925 23:03:33.470088 20584 net.cpp:261] This network produces output c_T
I0925 23:03:33.470098 20584 net.cpp:261] This network produces output h_pseudoloss
I0925 23:03:33.470124 20584 net.cpp:274] Network initialization done.
I0925 23:03:33.470172 20634 net.cpp:141] Setting up lstm1
I0925 23:03:33.470201 20584 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 23:03:33.470203 20634 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.470214 20584 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 23:03:33.470221 20634 net.cpp:156] Memory required for data: 26408
I0925 23:03:33.470224 20584 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 23:03:33.470273 20634 layer_factory.hpp:77] Creating layer concat
I0925 23:03:33.470291 20588 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 23:03:33.470301 20634 net.cpp:91] Creating Layer concat
I0925 23:03:33.470320 20634 net.cpp:425] concat <- lstm1
I0925 23:03:33.470340 20634 net.cpp:425] concat <- embedded_input_sentence
I0925 23:03:33.470360 20634 net.cpp:425] concat <- reshaped_stage_indicator
I0925 23:03:33.470381 20634 net.cpp:399] concat -> lstm1_video_sequence
I0925 23:03:33.469812 20638 net.cpp:399] lstm2_ -> c_0
I0925 23:03:33.470433 20588 layer_factory.hpp:77] Creating layer lstm2_
I0925 23:03:33.470451 20588 net.cpp:91] Creating Layer lstm2_
I0925 23:03:33.470453 20638 net.cpp:399] lstm2_ -> h_0
I0925 23:03:33.470463 20588 net.cpp:399] lstm2_ -> x
I0925 23:03:33.470480 20588 net.cpp:399] lstm2_ -> cont
I0925 23:03:33.471458 20634 net.cpp:141] Setting up concat
I0925 23:03:33.471496 20634 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 23:03:33.471510 20634 net.cpp:156] Memory required for data: 32412
I0925 23:03:33.471529 20634 layer_factory.hpp:77] Creating layer lstm2
I0925 23:03:33.471565 20634 net.cpp:91] Creating Layer lstm2
I0925 23:03:33.471583 20634 net.cpp:425] lstm2 <- lstm1_video_sequence
I0925 23:03:33.471603 20634 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0925 23:03:33.471629 20634 net.cpp:399] lstm2 -> lstm2
I0925 23:03:33.471663 20634 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 23:03:33.472239 20588 net.cpp:141] Setting up lstm2_
I0925 23:03:33.472245 20634 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 23:03:33.472260 20588 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 23:03:33.472272 20588 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.472280 20588 net.cpp:156] Memory required for data: 6008
I0925 23:03:33.472290 20588 layer_factory.hpp:77] Creating layer lstm2_
I0925 23:03:33.472307 20588 net.cpp:91] Creating Layer lstm2_
I0925 23:03:33.472321 20588 net.cpp:399] lstm2_ -> c_0
I0925 23:03:33.472340 20588 net.cpp:399] lstm2_ -> h_0
I0925 23:03:33.472445 20634 layer_factory.hpp:77] Creating layer lstm2_
I0925 23:03:33.472476 20634 net.cpp:91] Creating Layer lstm2_
I0925 23:03:33.472497 20634 net.cpp:399] lstm2_ -> x
I0925 23:03:33.472527 20634 net.cpp:399] lstm2_ -> cont
I0925 23:03:33.473362 20584 net.cpp:141] Setting up lstm1
I0925 23:03:33.473388 20584 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.473397 20584 net.cpp:156] Memory required for data: 26408
I0925 23:03:33.473423 20584 layer_factory.hpp:77] Creating layer concat
I0925 23:03:33.473424 20588 net.cpp:141] Setting up lstm2_
I0925 23:03:33.473443 20584 net.cpp:91] Creating Layer concat
I0925 23:03:33.473444 20588 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.473470 20584 net.cpp:425] concat <- lstm1
I0925 23:03:33.473481 20588 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.473484 20584 net.cpp:425] concat <- embedded_input_sentence
I0925 23:03:33.473503 20588 net.cpp:156] Memory required for data: 14008
I0925 23:03:33.473526 20584 net.cpp:425] concat <- reshaped_stage_indicator
I0925 23:03:33.473533 20588 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0925 23:03:33.473541 20584 net.cpp:399] concat -> lstm1_video_sequence
I0925 23:03:33.473551 20588 net.cpp:91] Creating Layer lstm2_cont_slice
I0925 23:03:33.473562 20588 net.cpp:425] lstm2_cont_slice <- cont
I0925 23:03:33.473579 20588 net.cpp:399] lstm2_cont_slice -> cont_1
I0925 23:03:33.473685 20634 net.cpp:141] Setting up lstm2_
I0925 23:03:33.473701 20634 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 23:03:33.473712 20634 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.473719 20634 net.cpp:156] Memory required for data: 6008
I0925 23:03:33.473727 20634 layer_factory.hpp:77] Creating layer lstm2_
I0925 23:03:33.473737 20588 net.cpp:141] Setting up lstm2_cont_slice
I0925 23:03:33.473740 20634 net.cpp:91] Creating Layer lstm2_
I0925 23:03:33.473765 20588 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.473768 20634 net.cpp:399] lstm2_ -> c_0
I0925 23:03:33.473774 20588 net.cpp:156] Memory required for data: 14012
I0925 23:03:33.473783 20588 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0925 23:03:33.473785 20634 net.cpp:399] lstm2_ -> h_0
I0925 23:03:33.473795 20588 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0925 23:03:33.473804 20588 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0925 23:03:33.473815 20588 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0925 23:03:33.473830 20588 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0925 23:03:33.479256 20584 net.cpp:141] Setting up concat
I0925 23:03:33.479293 20584 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 23:03:33.479303 20584 net.cpp:156] Memory required for data: 32412
I0925 23:03:33.479313 20584 layer_factory.hpp:77] Creating layer lstm2
I0925 23:03:33.479338 20584 net.cpp:91] Creating Layer lstm2
I0925 23:03:33.479349 20584 net.cpp:425] lstm2 <- lstm1_video_sequence
I0925 23:03:33.479363 20584 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0925 23:03:33.479382 20584 net.cpp:399] lstm2 -> lstm2
I0925 23:03:33.479387 20638 net.cpp:141] Setting up lstm2_
I0925 23:03:33.479405 20584 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 23:03:33.479425 20638 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.479437 20638 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.479451 20638 net.cpp:156] Memory required for data: 14008
I0925 23:03:33.479462 20638 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0925 23:03:33.479483 20638 net.cpp:91] Creating Layer lstm2_cont_slice
I0925 23:03:33.479493 20638 net.cpp:425] lstm2_cont_slice <- cont
I0925 23:03:33.479509 20638 net.cpp:399] lstm2_cont_slice -> cont_1
I0925 23:03:33.479434 20594 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0925 23:03:33.479545 20594 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.479555 20594 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.479562 20594 net.cpp:156] Memory required for data: 14020
I0925 23:03:33.479569 20588 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0925 23:03:33.479601 20588 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.479614 20588 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.479620 20588 net.cpp:156] Memory required for data: 14020
I0925 23:03:33.479629 20588 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0925 23:03:33.479631 20638 net.cpp:141] Setting up lstm2_cont_slice
I0925 23:03:33.479645 20638 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.479652 20638 net.cpp:156] Memory required for data: 14012
I0925 23:03:33.479655 20588 net.cpp:91] Creating Layer lstm2_x_transform
I0925 23:03:33.479660 20638 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0925 23:03:33.479665 20588 net.cpp:425] lstm2_x_transform <- x
I0925 23:03:33.479673 20638 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0925 23:03:33.479681 20588 net.cpp:399] lstm2_x_transform -> W_xc_x
I0925 23:03:33.479570 20594 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0925 23:03:33.479702 20594 net.cpp:91] Creating Layer lstm2_x_transform
I0925 23:03:33.479712 20594 net.cpp:425] lstm2_x_transform <- x
I0925 23:03:33.479729 20594 net.cpp:399] lstm2_x_transform -> W_xc_x
I0925 23:03:33.479682 20638 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0925 23:03:33.479825 20638 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0925 23:03:33.479835 20584 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 23:03:33.479842 20638 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0925 23:03:33.479893 20634 net.cpp:141] Setting up lstm2_
I0925 23:03:33.479908 20634 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.479919 20634 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.479926 20634 net.cpp:156] Memory required for data: 14008
I0925 23:03:33.479934 20634 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0925 23:03:33.479948 20634 net.cpp:91] Creating Layer lstm2_cont_slice
I0925 23:03:33.479955 20634 net.cpp:425] lstm2_cont_slice <- cont
I0925 23:03:33.479970 20634 net.cpp:399] lstm2_cont_slice -> cont_1
I0925 23:03:33.479974 20584 layer_factory.hpp:77] Creating layer lstm2_
I0925 23:03:33.479992 20584 net.cpp:91] Creating Layer lstm2_
I0925 23:03:33.480005 20584 net.cpp:399] lstm2_ -> x
I0925 23:03:33.480021 20584 net.cpp:399] lstm2_ -> cont
I0925 23:03:33.507694 20638 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0925 23:03:33.507740 20638 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.507751 20638 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.507758 20638 net.cpp:156] Memory required for data: 14020
I0925 23:03:33.507771 20638 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0925 23:03:33.507830 20638 net.cpp:91] Creating Layer lstm2_x_transform
I0925 23:03:33.507843 20638 net.cpp:425] lstm2_x_transform <- x
I0925 23:03:33.507860 20638 net.cpp:399] lstm2_x_transform -> W_xc_x
I0925 23:03:33.522738 20602 net.cpp:141] Setting up embedding
I0925 23:03:33.522797 20602 net.cpp:148] Top shape: 1 1 500 (500)
I0925 23:03:33.522809 20602 net.cpp:156] Memory required for data: 22408
I0925 23:03:33.522835 20602 layer_factory.hpp:77] Creating layer lstm1
I0925 23:03:33.522864 20602 net.cpp:91] Creating Layer lstm1
I0925 23:03:33.522861 20634 net.cpp:141] Setting up lstm2_cont_slice
I0925 23:03:33.522912 20584 net.cpp:141] Setting up lstm2_
I0925 23:03:33.522919 20602 net.cpp:425] lstm1 <- embedded_input_frames
I0925 23:03:33.522958 20634 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.522964 20584 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 23:03:33.522971 20634 net.cpp:156] Memory required for data: 14012
I0925 23:03:33.522972 20602 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0925 23:03:33.522980 20584 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.522986 20634 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0925 23:03:33.522989 20584 net.cpp:156] Memory required for data: 6008
I0925 23:03:33.523000 20584 layer_factory.hpp:77] Creating layer lstm2_
I0925 23:03:33.523008 20634 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0925 23:03:33.522999 20602 net.cpp:399] lstm1 -> lstm1
I0925 23:03:33.523020 20634 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0925 23:03:33.523030 20584 net.cpp:91] Creating Layer lstm2_
I0925 23:03:33.523037 20634 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0925 23:03:33.523041 20602 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 23:03:33.523046 20584 net.cpp:399] lstm2_ -> c_0
I0925 23:03:33.523057 20634 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0925 23:03:33.523067 20584 net.cpp:399] lstm2_ -> h_0
I0925 23:03:33.523525 20602 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 23:03:33.523677 20602 layer_factory.hpp:77] Creating layer lstm1_
I0925 23:03:33.523697 20602 net.cpp:91] Creating Layer lstm1_
I0925 23:03:33.523710 20602 net.cpp:399] lstm1_ -> x
I0925 23:03:33.523730 20602 net.cpp:399] lstm1_ -> cont
I0925 23:03:33.525208 20602 net.cpp:141] Setting up lstm1_
I0925 23:03:33.525235 20602 net.cpp:148] Top shape: 1 1 500 (500)
I0925 23:03:33.525249 20602 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.525256 20602 net.cpp:156] Memory required for data: 2004
I0925 23:03:33.525266 20602 layer_factory.hpp:77] Creating layer lstm1_
I0925 23:03:33.525285 20602 net.cpp:91] Creating Layer lstm1_
I0925 23:03:33.525302 20602 net.cpp:399] lstm1_ -> c_0
I0925 23:03:33.525296 20634 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0925 23:03:33.525323 20602 net.cpp:399] lstm1_ -> h_0
I0925 23:03:33.525342 20634 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.525346 20584 net.cpp:141] Setting up lstm2_
I0925 23:03:33.525357 20634 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.525367 20584 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.525367 20634 net.cpp:156] Memory required for data: 14020
I0925 23:03:33.525391 20584 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.525399 20584 net.cpp:156] Memory required for data: 14008
I0925 23:03:33.525403 20634 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0925 23:03:33.525408 20584 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0925 23:03:33.525424 20584 net.cpp:91] Creating Layer lstm2_cont_slice
I0925 23:03:33.525434 20584 net.cpp:425] lstm2_cont_slice <- cont
I0925 23:03:33.525442 20634 net.cpp:91] Creating Layer lstm2_x_transform
I0925 23:03:33.525446 20584 net.cpp:399] lstm2_cont_slice -> cont_1
I0925 23:03:33.525475 20634 net.cpp:425] lstm2_x_transform <- x
I0925 23:03:33.525497 20634 net.cpp:399] lstm2_x_transform -> W_xc_x
I0925 23:03:33.525593 20590 net.cpp:141] Setting up lstm2_x_transform
I0925 23:03:33.525616 20590 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.525629 20590 net.cpp:156] Memory required for data: 30020
I0925 23:03:33.525627 20584 net.cpp:141] Setting up lstm2_cont_slice
I0925 23:03:33.525661 20584 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.525663 20590 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0925 23:03:33.525671 20584 net.cpp:156] Memory required for data: 14012
I0925 23:03:33.525681 20584 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0925 23:03:33.525710 20590 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0925 23:03:33.525712 20584 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0925 23:03:33.525727 20590 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0925 23:03:33.525730 20584 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0925 23:03:33.525741 20590 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0925 23:03:33.525743 20584 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0925 23:03:33.525758 20584 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0925 23:03:33.525794 20602 net.cpp:141] Setting up lstm1_
I0925 23:03:33.525812 20602 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.525825 20602 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.525831 20602 net.cpp:156] Memory required for data: 10004
I0925 23:03:33.525840 20602 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0925 23:03:33.525858 20602 net.cpp:91] Creating Layer lstm1_cont_slice
I0925 23:03:33.525867 20602 net.cpp:425] lstm1_cont_slice <- cont
I0925 23:03:33.525881 20602 net.cpp:399] lstm1_cont_slice -> cont_1
I0925 23:03:33.541740 20590 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0925 23:03:33.541800 20590 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.541810 20590 net.cpp:156] Memory required for data: 46020
I0925 23:03:33.541822 20590 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0925 23:03:33.541872 20590 net.cpp:91] Creating Layer lstm2_h_conted_0
I0925 23:03:33.541887 20590 net.cpp:425] lstm2_h_conted_0 <- h_0
I0925 23:03:33.541893 20584 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0925 23:03:33.541900 20590 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0925 23:03:33.541931 20584 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.541939 20590 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0925 23:03:33.541944 20584 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.541950 20584 net.cpp:156] Memory required for data: 14020
I0925 23:03:33.541960 20584 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0925 23:03:33.541982 20584 net.cpp:91] Creating Layer lstm2_x_transform
I0925 23:03:33.541990 20584 net.cpp:425] lstm2_x_transform <- x
I0925 23:03:33.542014 20584 net.cpp:399] lstm2_x_transform -> W_xc_x
I0925 23:03:33.558941 20588 net.cpp:141] Setting up lstm2_x_transform
I0925 23:03:33.558990 20588 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.558998 20588 net.cpp:156] Memory required for data: 30020
I0925 23:03:33.559026 20588 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0925 23:03:33.559046 20588 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0925 23:03:33.559056 20588 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0925 23:03:33.559073 20588 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0925 23:03:33.559131 20588 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0925 23:03:33.559145 20588 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.559154 20588 net.cpp:156] Memory required for data: 46020
I0925 23:03:33.559160 20588 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0925 23:03:33.559175 20588 net.cpp:91] Creating Layer lstm2_h_conted_0
I0925 23:03:33.559182 20588 net.cpp:425] lstm2_h_conted_0 <- h_0
I0925 23:03:33.559191 20588 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0925 23:03:33.559206 20588 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0925 23:03:33.559345 20588 net.cpp:141] Setting up lstm2_h_conted_0
I0925 23:03:33.559357 20588 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.559365 20588 net.cpp:156] Memory required for data: 50020
I0925 23:03:33.559372 20588 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0925 23:03:33.559391 20588 net.cpp:91] Creating Layer lstm2_transform_1
I0925 23:03:33.559401 20588 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0925 23:03:33.559412 20588 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0925 23:03:33.570827 20602 net.cpp:141] Setting up lstm1_cont_slice
I0925 23:03:33.570885 20602 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.570895 20602 net.cpp:156] Memory required for data: 10008
I0925 23:03:33.570909 20602 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0925 23:03:33.570920 20590 net.cpp:141] Setting up lstm2_h_conted_0
I0925 23:03:33.570930 20602 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0925 23:03:33.570942 20602 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0925 23:03:33.570943 20590 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.570953 20590 net.cpp:156] Memory required for data: 50020
I0925 23:03:33.570962 20590 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0925 23:03:33.570967 20602 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0925 23:03:33.570987 20602 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0925 23:03:33.570988 20590 net.cpp:91] Creating Layer lstm2_transform_1
I0925 23:03:33.570999 20590 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0925 23:03:33.571015 20590 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0925 23:03:33.574645 20608 net.cpp:141] Setting up lstm2_x_transform
I0925 23:03:33.574684 20608 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.574692 20608 net.cpp:156] Memory required for data: 30020
I0925 23:03:33.574720 20608 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0925 23:03:33.574740 20608 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0925 23:03:33.574750 20608 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0925 23:03:33.574766 20608 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0925 23:03:33.582806 20602 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0925 23:03:33.582859 20602 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.582870 20602 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.582878 20602 net.cpp:156] Memory required for data: 10016
I0925 23:03:33.582890 20602 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0925 23:03:33.582931 20602 net.cpp:91] Creating Layer lstm1_x_transform
I0925 23:03:33.582921 20626 net.cpp:141] Setting up embedding
I0925 23:03:33.582943 20602 net.cpp:425] lstm1_x_transform <- x
I0925 23:03:33.582970 20626 net.cpp:148] Top shape: 1 1 500 (500)
I0925 23:03:33.582975 20608 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0925 23:03:33.582979 20626 net.cpp:156] Memory required for data: 22408
I0925 23:03:33.582981 20602 net.cpp:399] lstm1_x_transform -> W_xc_x
I0925 23:03:33.583003 20608 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.583019 20626 layer_factory.hpp:77] Creating layer lstm1
I0925 23:03:33.583026 20608 net.cpp:156] Memory required for data: 46020
I0925 23:03:33.583036 20608 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0925 23:03:33.583042 20626 net.cpp:91] Creating Layer lstm1
I0925 23:03:33.583052 20626 net.cpp:425] lstm1 <- embedded_input_frames
I0925 23:03:33.583052 20608 net.cpp:91] Creating Layer lstm2_h_conted_0
I0925 23:03:33.583063 20626 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0925 23:03:33.583065 20608 net.cpp:425] lstm2_h_conted_0 <- h_0
I0925 23:03:33.583086 20608 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0925 23:03:33.583086 20626 net.cpp:399] lstm1 -> lstm1
I0925 23:03:33.583112 20608 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0925 23:03:33.583119 20626 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 23:03:33.583479 20608 net.cpp:141] Setting up lstm2_h_conted_0
I0925 23:03:33.583494 20608 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.583503 20608 net.cpp:156] Memory required for data: 50020
I0925 23:03:33.583510 20608 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0925 23:03:33.583523 20626 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 23:03:33.583529 20608 net.cpp:91] Creating Layer lstm2_transform_1
I0925 23:03:33.583552 20608 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0925 23:03:33.583565 20608 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0925 23:03:33.583662 20626 layer_factory.hpp:77] Creating layer lstm1_
I0925 23:03:33.583679 20626 net.cpp:91] Creating Layer lstm1_
I0925 23:03:33.583689 20626 net.cpp:399] lstm1_ -> x
I0925 23:03:33.583706 20626 net.cpp:399] lstm1_ -> cont
I0925 23:03:33.588987 20626 net.cpp:141] Setting up lstm1_
I0925 23:03:33.589022 20626 net.cpp:148] Top shape: 1 1 500 (500)
I0925 23:03:33.589033 20626 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.589040 20626 net.cpp:156] Memory required for data: 2004
I0925 23:03:33.589051 20626 layer_factory.hpp:77] Creating layer lstm1_
I0925 23:03:33.589071 20626 net.cpp:91] Creating Layer lstm1_
I0925 23:03:33.589087 20626 net.cpp:399] lstm1_ -> c_0
I0925 23:03:33.589108 20626 net.cpp:399] lstm1_ -> h_0
I0925 23:03:33.606467 20638 net.cpp:141] Setting up lstm2_x_transform
I0925 23:03:33.606525 20638 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.606537 20638 net.cpp:156] Memory required for data: 30020
I0925 23:03:33.606578 20638 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0925 23:03:33.606618 20638 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0925 23:03:33.606632 20638 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0925 23:03:33.606655 20638 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0925 23:03:33.606884 20602 net.cpp:141] Setting up lstm1_x_transform
I0925 23:03:33.606922 20602 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.606927 20602 net.cpp:156] Memory required for data: 26016
I0925 23:03:33.606940 20626 net.cpp:141] Setting up lstm1_
I0925 23:03:33.606950 20602 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0925 23:03:33.606962 20626 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.606967 20602 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0925 23:03:33.606974 20602 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0925 23:03:33.606977 20626 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.606983 20602 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0925 23:03:33.606987 20626 net.cpp:156] Memory required for data: 10004
I0925 23:03:33.606998 20626 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0925 23:03:33.607015 20626 net.cpp:91] Creating Layer lstm1_cont_slice
I0925 23:03:33.607026 20626 net.cpp:425] lstm1_cont_slice <- cont
I0925 23:03:33.607038 20602 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0925 23:03:33.607049 20602 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.607046 20626 net.cpp:399] lstm1_cont_slice -> cont_1
I0925 23:03:33.607055 20602 net.cpp:156] Memory required for data: 42016
I0925 23:03:33.607060 20602 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0925 23:03:33.607074 20602 net.cpp:91] Creating Layer lstm1_h_conted_0
I0925 23:03:33.607079 20602 net.cpp:425] lstm1_h_conted_0 <- h_0
I0925 23:03:33.607086 20602 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0925 23:03:33.607095 20602 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0925 23:03:33.607144 20626 net.cpp:141] Setting up lstm1_cont_slice
I0925 23:03:33.607163 20626 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.607172 20626 net.cpp:156] Memory required for data: 10008
I0925 23:03:33.607182 20626 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0925 23:03:33.607201 20626 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0925 23:03:33.607213 20626 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0925 23:03:33.607226 20626 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0925 23:03:33.607244 20626 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0925 23:03:33.607267 20602 net.cpp:141] Setting up lstm1_h_conted_0
I0925 23:03:33.607280 20602 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.607285 20602 net.cpp:156] Memory required for data: 46016
I0925 23:03:33.607290 20602 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0925 23:03:33.607302 20602 net.cpp:91] Creating Layer lstm1_transform_1
I0925 23:03:33.607307 20602 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0925 23:03:33.607316 20602 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0925 23:03:33.607378 20626 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0925 23:03:33.607398 20626 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.607410 20626 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:33.607419 20626 net.cpp:156] Memory required for data: 10016
I0925 23:03:33.607429 20626 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0925 23:03:33.607450 20626 net.cpp:91] Creating Layer lstm1_x_transform
I0925 23:03:33.607462 20626 net.cpp:425] lstm1_x_transform <- x
I0925 23:03:33.607478 20626 net.cpp:399] lstm1_x_transform -> W_xc_x
I0925 23:03:33.623704 20588 net.cpp:141] Setting up lstm2_transform_1
I0925 23:03:33.623752 20588 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.623761 20588 net.cpp:156] Memory required for data: 66020
I0925 23:03:33.623788 20588 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0925 23:03:33.623801 20638 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0925 23:03:33.623819 20588 net.cpp:91] Creating Layer lstm2_gate_input_1
I0925 23:03:33.623849 20588 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0925 23:03:33.623852 20638 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.623860 20638 net.cpp:156] Memory required for data: 46020
I0925 23:03:33.623862 20588 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0925 23:03:33.623872 20638 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0925 23:03:33.623879 20588 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0925 23:03:33.623908 20638 net.cpp:91] Creating Layer lstm2_h_conted_0
I0925 23:03:33.623919 20638 net.cpp:425] lstm2_h_conted_0 <- h_0
I0925 23:03:33.623932 20638 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0925 23:03:33.623947 20638 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0925 23:03:33.623968 20588 net.cpp:141] Setting up lstm2_gate_input_1
I0925 23:03:33.623983 20588 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.623991 20588 net.cpp:156] Memory required for data: 82020
I0925 23:03:33.623998 20588 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0925 23:03:33.624016 20588 net.cpp:91] Creating Layer lstm2_unit_1
I0925 23:03:33.624022 20588 net.cpp:425] lstm2_unit_1 <- c_0
I0925 23:03:33.624032 20588 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0925 23:03:33.624040 20588 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0925 23:03:33.624052 20588 net.cpp:399] lstm2_unit_1 -> c_1
I0925 23:03:33.624064 20588 net.cpp:399] lstm2_unit_1 -> h_1
I0925 23:03:33.624166 20594 net.cpp:141] Setting up lstm2_x_transform
I0925 23:03:33.624187 20594 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.624194 20594 net.cpp:156] Memory required for data: 30020
I0925 23:03:33.624213 20594 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0925 23:03:33.624228 20594 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0925 23:03:33.624236 20594 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0925 23:03:33.624248 20594 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0925 23:03:33.624275 20588 net.cpp:141] Setting up lstm2_unit_1
I0925 23:03:33.624290 20588 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.624300 20588 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.624307 20588 net.cpp:156] Memory required for data: 90020
I0925 23:03:33.624315 20588 layer_factory.hpp:77] Creating layer lstm2_
I0925 23:03:33.624318 20594 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0925 23:03:33.624326 20588 net.cpp:91] Creating Layer lstm2_
I0925 23:03:33.624333 20594 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.624333 20588 net.cpp:425] lstm2_ <- c_1
I0925 23:03:33.624348 20594 net.cpp:156] Memory required for data: 46020
I0925 23:03:33.624356 20594 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0925 23:03:33.624358 20588 net.cpp:399] lstm2_ -> c_T
I0925 23:03:33.624371 20594 net.cpp:91] Creating Layer lstm2_h_conted_0
I0925 23:03:33.624379 20594 net.cpp:425] lstm2_h_conted_0 <- h_0
I0925 23:03:33.624389 20594 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0925 23:03:33.624399 20594 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0925 23:03:33.624488 20588 net.cpp:141] Setting up lstm2_
I0925 23:03:33.624502 20588 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.624510 20588 net.cpp:156] Memory required for data: 94020
I0925 23:03:33.624516 20588 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0925 23:03:33.624529 20588 net.cpp:91] Creating Layer lstm2_h_concat
I0925 23:03:33.624536 20588 net.cpp:425] lstm2_h_concat <- h_1
I0925 23:03:33.624547 20588 net.cpp:399] lstm2_h_concat -> h
I0925 23:03:33.624766 20638 net.cpp:141] Setting up lstm2_h_conted_0
I0925 23:03:33.624788 20638 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.624797 20638 net.cpp:156] Memory required for data: 50020
I0925 23:03:33.624805 20638 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0925 23:03:33.624824 20638 net.cpp:91] Creating Layer lstm2_transform_1
I0925 23:03:33.624832 20638 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0925 23:03:33.624833 20588 net.cpp:141] Setting up lstm2_h_concat
I0925 23:03:33.624847 20588 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.624850 20638 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0925 23:03:33.624855 20588 net.cpp:156] Memory required for data: 98020
I0925 23:03:33.624862 20588 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 23:03:33.624876 20588 net.cpp:91] Creating Layer h_pseudoloss
I0925 23:03:33.624882 20588 net.cpp:425] h_pseudoloss <- h
I0925 23:03:33.624893 20588 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 23:03:33.634822 20594 net.cpp:141] Setting up lstm2_h_conted_0
I0925 23:03:33.634907 20594 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.634917 20594 net.cpp:156] Memory required for data: 50020
I0925 23:03:33.634934 20594 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0925 23:03:33.634963 20588 net.cpp:141] Setting up h_pseudoloss
I0925 23:03:33.634981 20594 net.cpp:91] Creating Layer lstm2_transform_1
I0925 23:03:33.634985 20588 net.cpp:148] Top shape: (1)
I0925 23:03:33.634995 20594 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0925 23:03:33.634994 20588 net.cpp:151]     with loss weight 1
I0925 23:03:33.635020 20588 net.cpp:156] Memory required for data: 98024
I0925 23:03:33.635027 20594 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0925 23:03:33.635030 20588 net.cpp:217] h_pseudoloss needs backward computation.
I0925 23:03:33.635052 20588 net.cpp:217] lstm2_h_concat needs backward computation.
I0925 23:03:33.635061 20588 net.cpp:219] lstm2_ does not need backward computation.
I0925 23:03:33.635071 20588 net.cpp:217] lstm2_unit_1 needs backward computation.
I0925 23:03:33.635080 20588 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0925 23:03:33.635093 20588 net.cpp:217] lstm2_transform_1 needs backward computation.
I0925 23:03:33.635102 20588 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0925 23:03:33.635112 20588 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0925 23:03:33.635119 20588 net.cpp:217] lstm2_x_transform needs backward computation.
I0925 23:03:33.635128 20588 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0925 23:03:33.635136 20588 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0925 23:03:33.635144 20588 net.cpp:219] lstm2_ does not need backward computation.
I0925 23:03:33.635151 20588 net.cpp:219] lstm2_ does not need backward computation.
I0925 23:03:33.635159 20588 net.cpp:261] This network produces output c_T
I0925 23:03:33.635165 20588 net.cpp:261] This network produces output h_pseudoloss
I0925 23:03:33.635192 20588 net.cpp:274] Network initialization done.
I0925 23:03:33.635293 20588 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 23:03:33.635304 20588 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 23:03:33.635313 20588 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 23:03:33.659368 20590 net.cpp:141] Setting up lstm2_transform_1
I0925 23:03:33.659422 20590 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.659431 20590 net.cpp:156] Memory required for data: 66020
I0925 23:03:33.659454 20590 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0925 23:03:33.659481 20590 net.cpp:91] Creating Layer lstm2_gate_input_1
I0925 23:03:33.659490 20590 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0925 23:03:33.659502 20590 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0925 23:03:33.659520 20590 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0925 23:03:33.659584 20590 net.cpp:141] Setting up lstm2_gate_input_1
I0925 23:03:33.659600 20590 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.659606 20590 net.cpp:156] Memory required for data: 82020
I0925 23:03:33.659615 20590 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0925 23:03:33.659634 20590 net.cpp:91] Creating Layer lstm2_unit_1
I0925 23:03:33.659643 20590 net.cpp:425] lstm2_unit_1 <- c_0
I0925 23:03:33.659653 20590 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0925 23:03:33.659662 20590 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0925 23:03:33.659673 20590 net.cpp:399] lstm2_unit_1 -> c_1
I0925 23:03:33.659687 20590 net.cpp:399] lstm2_unit_1 -> h_1
I0925 23:03:33.659797 20590 net.cpp:141] Setting up lstm2_unit_1
I0925 23:03:33.659812 20590 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.659821 20590 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.659829 20590 net.cpp:156] Memory required for data: 90020
I0925 23:03:33.659837 20590 layer_factory.hpp:77] Creating layer lstm2_
I0925 23:03:33.659850 20590 net.cpp:91] Creating Layer lstm2_
I0925 23:03:33.659858 20590 net.cpp:425] lstm2_ <- c_1
I0925 23:03:33.659875 20590 net.cpp:399] lstm2_ -> c_T
I0925 23:03:33.659932 20590 net.cpp:141] Setting up lstm2_
I0925 23:03:33.659946 20590 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.659953 20590 net.cpp:156] Memory required for data: 94020
I0925 23:03:33.659961 20590 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0925 23:03:33.659976 20590 net.cpp:91] Creating Layer lstm2_h_concat
I0925 23:03:33.659983 20590 net.cpp:425] lstm2_h_concat <- h_1
I0925 23:03:33.659996 20590 net.cpp:399] lstm2_h_concat -> h
I0925 23:03:33.660053 20590 net.cpp:141] Setting up lstm2_h_concat
I0925 23:03:33.660066 20590 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.660073 20590 net.cpp:156] Memory required for data: 98020
I0925 23:03:33.660080 20590 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 23:03:33.660094 20590 net.cpp:91] Creating Layer h_pseudoloss
I0925 23:03:33.660102 20590 net.cpp:425] h_pseudoloss <- h
I0925 23:03:33.660114 20590 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 23:03:33.660257 20590 net.cpp:141] Setting up h_pseudoloss
I0925 23:03:33.660277 20590 net.cpp:148] Top shape: (1)
I0925 23:03:33.660285 20590 net.cpp:151]     with loss weight 1
I0925 23:03:33.660310 20590 net.cpp:156] Memory required for data: 98024
I0925 23:03:33.660317 20590 net.cpp:217] h_pseudoloss needs backward computation.
I0925 23:03:33.660325 20590 net.cpp:217] lstm2_h_concat needs backward computation.
I0925 23:03:33.660332 20590 net.cpp:219] lstm2_ does not need backward computation.
I0925 23:03:33.660341 20590 net.cpp:217] lstm2_unit_1 needs backward computation.
I0925 23:03:33.660349 20590 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0925 23:03:33.660357 20590 net.cpp:217] lstm2_transform_1 needs backward computation.
I0925 23:03:33.660367 20590 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0925 23:03:33.660375 20590 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0925 23:03:33.660383 20590 net.cpp:217] lstm2_x_transform needs backward computation.
I0925 23:03:33.660392 20590 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0925 23:03:33.660400 20590 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0925 23:03:33.660409 20590 net.cpp:219] lstm2_ does not need backward computation.
I0925 23:03:33.660416 20590 net.cpp:219] lstm2_ does not need backward computation.
I0925 23:03:33.660424 20590 net.cpp:261] This network produces output c_T
I0925 23:03:33.660431 20590 net.cpp:261] This network produces output h_pseudoloss
I0925 23:03:33.660454 20590 net.cpp:274] Network initialization done.
I0925 23:03:33.660521 20590 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 23:03:33.660531 20590 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 23:03:33.660539 20590 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 23:03:33.660693 20590 net.cpp:141] Setting up lstm2
I0925 23:03:33.660708 20590 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.660717 20590 net.cpp:156] Memory required for data: 36412
I0925 23:03:33.660738 20590 layer_factory.hpp:77] Creating layer predict
I0925 23:03:33.660756 20590 net.cpp:91] Creating Layer predict
I0925 23:03:33.660765 20590 net.cpp:425] predict <- lstm2
I0925 23:03:33.660778 20590 net.cpp:399] predict -> predict
I0925 23:03:33.746031 20602 net.cpp:141] Setting up lstm1_transform_1
I0925 23:03:33.746088 20602 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.746098 20602 net.cpp:156] Memory required for data: 62016
I0925 23:03:33.746124 20602 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0925 23:03:33.746155 20602 net.cpp:91] Creating Layer lstm1_gate_input_1
I0925 23:03:33.746168 20602 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0925 23:03:33.746181 20602 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0925 23:03:33.746194 20602 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0925 23:03:33.746268 20588 net.cpp:141] Setting up lstm2
I0925 23:03:33.746309 20588 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.746320 20588 net.cpp:156] Memory required for data: 36412
I0925 23:03:33.746348 20588 layer_factory.hpp:77] Creating layer predict
I0925 23:03:33.746351 20634 net.cpp:141] Setting up lstm2_x_transform
I0925 23:03:33.746373 20588 net.cpp:91] Creating Layer predict
I0925 23:03:33.746373 20634 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.746392 20588 net.cpp:425] predict <- lstm2
I0925 23:03:33.746395 20634 net.cpp:156] Memory required for data: 30020
I0925 23:03:33.746409 20588 net.cpp:399] predict -> predict
I0925 23:03:33.746417 20634 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0925 23:03:33.746433 20634 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0925 23:03:33.746443 20634 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0925 23:03:33.746461 20634 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0925 23:03:33.836534 20638 net.cpp:141] Setting up lstm2_transform_1
I0925 23:03:33.836601 20638 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.836611 20638 net.cpp:156] Memory required for data: 66020
I0925 23:03:33.836643 20638 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0925 23:03:33.836675 20638 net.cpp:91] Creating Layer lstm2_gate_input_1
I0925 23:03:33.836688 20638 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0925 23:03:33.836699 20638 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0925 23:03:33.836712 20638 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0925 23:03:33.836786 20594 net.cpp:141] Setting up lstm2_transform_1
I0925 23:03:33.836798 20638 net.cpp:141] Setting up lstm2_gate_input_1
I0925 23:03:33.836809 20594 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.836812 20638 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.836817 20594 net.cpp:156] Memory required for data: 66020
I0925 23:03:33.836820 20638 net.cpp:156] Memory required for data: 82020
I0925 23:03:33.836827 20638 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0925 23:03:33.836833 20594 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0925 23:03:33.836840 20638 net.cpp:91] Creating Layer lstm2_unit_1
I0925 23:03:33.836848 20638 net.cpp:425] lstm2_unit_1 <- c_0
I0925 23:03:33.836853 20594 net.cpp:91] Creating Layer lstm2_gate_input_1
I0925 23:03:33.836858 20638 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0925 23:03:33.836863 20594 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0925 23:03:33.836866 20638 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0925 23:03:33.836872 20594 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0925 23:03:33.836879 20638 net.cpp:399] lstm2_unit_1 -> c_1
I0925 23:03:33.836884 20594 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0925 23:03:33.836892 20638 net.cpp:399] lstm2_unit_1 -> h_1
I0925 23:03:33.836941 20602 net.cpp:141] Setting up lstm1_gate_input_1
I0925 23:03:33.836987 20602 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.836994 20602 net.cpp:156] Memory required for data: 78016
I0925 23:03:33.837002 20608 net.cpp:141] Setting up lstm2_transform_1
I0925 23:03:33.837025 20608 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.837033 20608 net.cpp:156] Memory required for data: 66020
I0925 23:03:33.837049 20608 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0925 23:03:33.837069 20608 net.cpp:91] Creating Layer lstm2_gate_input_1
I0925 23:03:33.837080 20608 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0925 23:03:33.837091 20608 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0925 23:03:33.837106 20608 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0925 23:03:33.837146 20608 net.cpp:141] Setting up lstm2_gate_input_1
I0925 23:03:33.837155 20608 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.837160 20608 net.cpp:156] Memory required for data: 82020
I0925 23:03:33.837165 20608 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0925 23:03:33.837177 20608 net.cpp:91] Creating Layer lstm2_unit_1
I0925 23:03:33.837183 20608 net.cpp:425] lstm2_unit_1 <- c_0
I0925 23:03:33.837189 20608 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0925 23:03:33.837198 20608 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0925 23:03:33.837209 20608 net.cpp:399] lstm2_unit_1 -> c_1
I0925 23:03:33.837224 20608 net.cpp:399] lstm2_unit_1 -> h_1
I0925 23:03:33.837312 20608 net.cpp:141] Setting up lstm2_unit_1
I0925 23:03:33.837324 20608 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.837332 20608 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.837337 20608 net.cpp:156] Memory required for data: 90020
I0925 23:03:33.837342 20608 layer_factory.hpp:77] Creating layer lstm2_
I0925 23:03:33.837350 20608 net.cpp:91] Creating Layer lstm2_
I0925 23:03:33.837355 20608 net.cpp:425] lstm2_ <- c_1
I0925 23:03:33.837365 20608 net.cpp:399] lstm2_ -> c_T
I0925 23:03:33.837400 20608 net.cpp:141] Setting up lstm2_
I0925 23:03:33.837409 20608 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.837414 20608 net.cpp:156] Memory required for data: 94020
I0925 23:03:33.837419 20608 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0925 23:03:33.837430 20608 net.cpp:91] Creating Layer lstm2_h_concat
I0925 23:03:33.837435 20608 net.cpp:425] lstm2_h_concat <- h_1
I0925 23:03:33.837442 20608 net.cpp:399] lstm2_h_concat -> h
I0925 23:03:33.837482 20608 net.cpp:141] Setting up lstm2_h_concat
I0925 23:03:33.837492 20608 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.837496 20608 net.cpp:156] Memory required for data: 98020
I0925 23:03:33.837502 20608 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 23:03:33.837512 20608 net.cpp:91] Creating Layer h_pseudoloss
I0925 23:03:33.837517 20608 net.cpp:425] h_pseudoloss <- h
I0925 23:03:33.837523 20608 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 23:03:33.837005 20602 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0925 23:03:33.837610 20602 net.cpp:91] Creating Layer lstm1_unit_1
I0925 23:03:33.837618 20602 net.cpp:425] lstm1_unit_1 <- c_0
I0925 23:03:33.837625 20602 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0925 23:03:33.837631 20602 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0925 23:03:33.837640 20602 net.cpp:399] lstm1_unit_1 -> c_1
I0925 23:03:33.837649 20602 net.cpp:399] lstm1_unit_1 -> h_1
I0925 23:03:33.837716 20594 net.cpp:141] Setting up lstm2_gate_input_1
I0925 23:03:33.837726 20594 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.837730 20594 net.cpp:156] Memory required for data: 82020
I0925 23:03:33.837735 20594 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0925 23:03:33.837743 20594 net.cpp:91] Creating Layer lstm2_unit_1
I0925 23:03:33.837749 20594 net.cpp:425] lstm2_unit_1 <- c_0
I0925 23:03:33.837754 20594 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0925 23:03:33.837759 20594 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0925 23:03:33.837772 20594 net.cpp:399] lstm2_unit_1 -> c_1
I0925 23:03:33.837781 20594 net.cpp:399] lstm2_unit_1 -> h_1
I0925 23:03:33.837880 20634 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0925 23:03:33.837898 20634 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.837903 20634 net.cpp:156] Memory required for data: 46020
I0925 23:03:33.837914 20634 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0925 23:03:33.837926 20608 net.cpp:141] Setting up h_pseudoloss
I0925 23:03:33.837935 20634 net.cpp:91] Creating Layer lstm2_h_conted_0
I0925 23:03:33.837959 20608 net.cpp:148] Top shape: (1)
I0925 23:03:33.837962 20634 net.cpp:425] lstm2_h_conted_0 <- h_0
I0925 23:03:33.837966 20608 net.cpp:151]     with loss weight 1
I0925 23:03:33.837981 20634 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0925 23:03:33.837996 20608 net.cpp:156] Memory required for data: 98024
I0925 23:03:33.838007 20608 net.cpp:217] h_pseudoloss needs backward computation.
I0925 23:03:33.838016 20608 net.cpp:217] lstm2_h_concat needs backward computation.
I0925 23:03:33.838016 20634 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0925 23:03:33.838023 20608 net.cpp:219] lstm2_ does not need backward computation.
I0925 23:03:33.838032 20608 net.cpp:217] lstm2_unit_1 needs backward computation.
I0925 23:03:33.838043 20608 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0925 23:03:33.838055 20608 net.cpp:217] lstm2_transform_1 needs backward computation.
I0925 23:03:33.838062 20608 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0925 23:03:33.838069 20608 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0925 23:03:33.838075 20608 net.cpp:217] lstm2_x_transform needs backward computation.
I0925 23:03:33.838080 20608 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0925 23:03:33.838086 20608 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0925 23:03:33.838093 20608 net.cpp:219] lstm2_ does not need backward computation.
I0925 23:03:33.838096 20608 net.cpp:219] lstm2_ does not need backward computation.
I0925 23:03:33.838100 20608 net.cpp:261] This network produces output c_T
I0925 23:03:33.838105 20608 net.cpp:261] This network produces output h_pseudoloss
I0925 23:03:33.838127 20608 net.cpp:274] Network initialization done.
I0925 23:03:33.838158 20594 net.cpp:141] Setting up lstm2_unit_1
I0925 23:03:33.838176 20594 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.838187 20594 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.838187 20602 net.cpp:141] Setting up lstm1_unit_1
I0925 23:03:33.838196 20594 net.cpp:156] Memory required for data: 90020
I0925 23:03:33.838196 20608 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 23:03:33.838202 20602 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.838209 20608 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 23:03:33.838203 20594 layer_factory.hpp:77] Creating layer lstm2_
I0925 23:03:33.838218 20608 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 23:03:33.838225 20594 net.cpp:91] Creating Layer lstm2_
I0925 23:03:33.838218 20602 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.838239 20594 net.cpp:425] lstm2_ <- c_1
I0925 23:03:33.838246 20602 net.cpp:156] Memory required for data: 86016
I0925 23:03:33.838253 20594 net.cpp:399] lstm2_ -> c_T
I0925 23:03:33.838254 20602 layer_factory.hpp:77] Creating layer lstm1_
I0925 23:03:33.838270 20602 net.cpp:91] Creating Layer lstm1_
I0925 23:03:33.838281 20602 net.cpp:425] lstm1_ <- c_1
I0925 23:03:33.838290 20602 net.cpp:399] lstm1_ -> c_T
I0925 23:03:33.838346 20638 net.cpp:141] Setting up lstm2_unit_1
I0925 23:03:33.838371 20638 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.838383 20638 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.838392 20638 net.cpp:156] Memory required for data: 90020
I0925 23:03:33.838399 20638 layer_factory.hpp:77] Creating layer lstm2_
I0925 23:03:33.838397 20584 net.cpp:141] Setting up lstm2_x_transform
I0925 23:03:33.838420 20638 net.cpp:91] Creating Layer lstm2_
I0925 23:03:33.838423 20584 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.838431 20638 net.cpp:425] lstm2_ <- c_1
I0925 23:03:33.838431 20584 net.cpp:156] Memory required for data: 30020
I0925 23:03:33.838451 20638 net.cpp:399] lstm2_ -> c_T
I0925 23:03:33.838462 20584 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0925 23:03:33.838464 20594 net.cpp:141] Setting up lstm2_
I0925 23:03:33.838477 20594 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.838479 20584 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0925 23:03:33.838481 20594 net.cpp:156] Memory required for data: 94020
I0925 23:03:33.838493 20584 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0925 23:03:33.838495 20594 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0925 23:03:33.838505 20594 net.cpp:91] Creating Layer lstm2_h_concat
I0925 23:03:33.838507 20584 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0925 23:03:33.838520 20594 net.cpp:425] lstm2_h_concat <- h_1
I0925 23:03:33.838536 20594 net.cpp:399] lstm2_h_concat -> h
I0925 23:03:33.838553 20602 net.cpp:141] Setting up lstm1_
I0925 23:03:33.838569 20602 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.838575 20602 net.cpp:156] Memory required for data: 90016
I0925 23:03:33.838580 20602 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0925 23:03:33.838593 20626 net.cpp:141] Setting up lstm1_x_transform
I0925 23:03:33.838623 20626 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.838627 20626 net.cpp:156] Memory required for data: 26016
I0925 23:03:33.838649 20626 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0925 23:03:33.838662 20626 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0925 23:03:33.838673 20626 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0925 23:03:33.838686 20626 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0925 23:03:33.838593 20602 net.cpp:91] Creating Layer lstm1_h_concat
I0925 23:03:33.838711 20602 net.cpp:425] lstm1_h_concat <- h_1
I0925 23:03:33.838726 20602 net.cpp:399] lstm1_h_concat -> h
I0925 23:03:33.838724 20638 net.cpp:141] Setting up lstm2_
I0925 23:03:33.838747 20638 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.838752 20638 net.cpp:156] Memory required for data: 94020
I0925 23:03:33.838757 20638 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0925 23:03:33.838767 20638 net.cpp:91] Creating Layer lstm2_h_concat
I0925 23:03:33.838771 20638 net.cpp:425] lstm2_h_concat <- h_1
I0925 23:03:33.838783 20638 net.cpp:399] lstm2_h_concat -> h
I0925 23:03:33.838809 20584 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0925 23:03:33.838826 20584 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.838835 20584 net.cpp:156] Memory required for data: 46020
I0925 23:03:33.838842 20584 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0925 23:03:33.838843 20594 net.cpp:141] Setting up lstm2_h_concat
I0925 23:03:33.838863 20584 net.cpp:91] Creating Layer lstm2_h_conted_0
I0925 23:03:33.838867 20594 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.838873 20584 net.cpp:425] lstm2_h_conted_0 <- h_0
I0925 23:03:33.838874 20594 net.cpp:156] Memory required for data: 98020
I0925 23:03:33.838888 20594 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 23:03:33.838888 20584 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0925 23:03:33.838914 20584 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0925 23:03:33.838917 20594 net.cpp:91] Creating Layer h_pseudoloss
I0925 23:03:33.838933 20594 net.cpp:425] h_pseudoloss <- h
I0925 23:03:33.838948 20594 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 23:03:33.843749 20626 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0925 23:03:33.843783 20602 net.cpp:141] Setting up lstm1_h_concat
I0925 23:03:33.843798 20626 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.843804 20602 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.843807 20626 net.cpp:156] Memory required for data: 42016
I0925 23:03:33.843812 20602 net.cpp:156] Memory required for data: 94016
I0925 23:03:33.843819 20626 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0925 23:03:33.843822 20602 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 23:03:33.843842 20602 net.cpp:91] Creating Layer h_pseudoloss
I0925 23:03:33.843843 20626 net.cpp:91] Creating Layer lstm1_h_conted_0
I0925 23:03:33.843854 20602 net.cpp:425] h_pseudoloss <- h
I0925 23:03:33.843854 20626 net.cpp:425] lstm1_h_conted_0 <- h_0
I0925 23:03:33.843869 20634 net.cpp:141] Setting up lstm2_h_conted_0
I0925 23:03:33.843880 20626 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0925 23:03:33.843881 20602 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 23:03:33.843904 20626 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0925 23:03:33.843894 20634 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.843917 20638 net.cpp:141] Setting up lstm2_h_concat
I0925 23:03:33.843927 20634 net.cpp:156] Memory required for data: 50020
I0925 23:03:33.843933 20638 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.843942 20638 net.cpp:156] Memory required for data: 98020
I0925 23:03:33.843940 20634 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0925 23:03:33.843958 20638 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 23:03:33.843973 20638 net.cpp:91] Creating Layer h_pseudoloss
I0925 23:03:33.843981 20634 net.cpp:91] Creating Layer lstm2_transform_1
I0925 23:03:33.843981 20608 net.cpp:141] Setting up lstm2
I0925 23:03:33.843981 20638 net.cpp:425] h_pseudoloss <- h
I0925 23:03:33.843997 20634 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0925 23:03:33.844019 20638 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 23:03:33.844008 20608 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.844036 20634 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0925 23:03:33.844039 20608 net.cpp:156] Memory required for data: 36412
I0925 23:03:33.844082 20608 layer_factory.hpp:77] Creating layer predict
I0925 23:03:33.844089 20602 net.cpp:141] Setting up h_pseudoloss
I0925 23:03:33.844100 20608 net.cpp:91] Creating Layer predict
I0925 23:03:33.844105 20602 net.cpp:148] Top shape: (1)
I0925 23:03:33.844110 20608 net.cpp:425] predict <- lstm2
I0925 23:03:33.844125 20608 net.cpp:399] predict -> predict
I0925 23:03:33.844112 20602 net.cpp:151]     with loss weight 1
I0925 23:03:33.844136 20602 net.cpp:156] Memory required for data: 94020
I0925 23:03:33.844144 20602 net.cpp:217] h_pseudoloss needs backward computation.
I0925 23:03:33.844153 20602 net.cpp:217] lstm1_h_concat needs backward computation.
I0925 23:03:33.844161 20602 net.cpp:219] lstm1_ does not need backward computation.
I0925 23:03:33.844172 20602 net.cpp:217] lstm1_unit_1 needs backward computation.
I0925 23:03:33.844182 20602 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0925 23:03:33.844189 20602 net.cpp:217] lstm1_transform_1 needs backward computation.
I0925 23:03:33.844199 20602 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0925 23:03:33.844209 20602 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0925 23:03:33.844218 20602 net.cpp:217] lstm1_x_transform needs backward computation.
I0925 23:03:33.844226 20602 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0925 23:03:33.844238 20602 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0925 23:03:33.844251 20602 net.cpp:219] lstm1_ does not need backward computation.
I0925 23:03:33.844259 20602 net.cpp:219] lstm1_ does not need backward computation.
I0925 23:03:33.844265 20602 net.cpp:261] This network produces output c_T
I0925 23:03:33.844274 20602 net.cpp:261] This network produces output h_pseudoloss
I0925 23:03:33.844297 20602 net.cpp:274] Network initialization done.
I0925 23:03:33.844373 20602 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 23:03:33.844385 20602 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 23:03:33.844394 20602 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 23:03:33.856503 20638 net.cpp:141] Setting up h_pseudoloss
I0925 23:03:33.856555 20638 net.cpp:148] Top shape: (1)
I0925 23:03:33.856564 20638 net.cpp:151]     with loss weight 1
I0925 23:03:33.856596 20638 net.cpp:156] Memory required for data: 98024
I0925 23:03:33.856609 20638 net.cpp:217] h_pseudoloss needs backward computation.
I0925 23:03:33.856621 20638 net.cpp:217] lstm2_h_concat needs backward computation.
I0925 23:03:33.856629 20638 net.cpp:219] lstm2_ does not need backward computation.
I0925 23:03:33.856638 20638 net.cpp:217] lstm2_unit_1 needs backward computation.
I0925 23:03:33.856648 20638 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0925 23:03:33.856658 20638 net.cpp:217] lstm2_transform_1 needs backward computation.
I0925 23:03:33.856667 20638 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0925 23:03:33.856676 20638 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0925 23:03:33.856685 20638 net.cpp:217] lstm2_x_transform needs backward computation.
I0925 23:03:33.856694 20638 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0925 23:03:33.856703 20638 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0925 23:03:33.856716 20638 net.cpp:219] lstm2_ does not need backward computation.
I0925 23:03:33.856724 20638 net.cpp:219] lstm2_ does not need backward computation.
I0925 23:03:33.856731 20638 net.cpp:261] This network produces output c_T
I0925 23:03:33.856740 20638 net.cpp:261] This network produces output h_pseudoloss
I0925 23:03:33.856765 20638 net.cpp:274] Network initialization done.
I0925 23:03:33.856859 20638 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 23:03:33.856870 20638 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 23:03:33.856878 20638 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 23:03:33.857066 20638 net.cpp:141] Setting up lstm2
I0925 23:03:33.857084 20638 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.857092 20638 net.cpp:156] Memory required for data: 36412
I0925 23:03:33.857125 20638 layer_factory.hpp:77] Creating layer predict
I0925 23:03:33.857156 20638 net.cpp:91] Creating Layer predict
I0925 23:03:33.857168 20638 net.cpp:425] predict <- lstm2
I0925 23:03:33.857182 20638 net.cpp:399] predict -> predict
I0925 23:03:33.947927 20584 net.cpp:141] Setting up lstm2_h_conted_0
I0925 23:03:33.948004 20584 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:33.948010 20584 net.cpp:156] Memory required for data: 50020
I0925 23:03:33.948025 20584 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0925 23:03:33.948014 20634 net.cpp:141] Setting up lstm2_transform_1
I0925 23:03:33.948056 20584 net.cpp:91] Creating Layer lstm2_transform_1
I0925 23:03:33.948063 20634 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.948071 20584 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0925 23:03:33.948074 20634 net.cpp:156] Memory required for data: 66020
I0925 23:03:33.948097 20584 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0925 23:03:33.948107 20634 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0925 23:03:33.948149 20634 net.cpp:91] Creating Layer lstm2_gate_input_1
I0925 23:03:33.948163 20634 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0925 23:03:33.948174 20634 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0925 23:03:33.948191 20634 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0925 23:03:33.948693 20634 net.cpp:141] Setting up lstm2_gate_input_1
I0925 23:03:33.955083 20634 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:33.955094 20634 net.cpp:156] Memory required for data: 82020
I0925 23:03:33.955109 20634 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0925 23:03:33.955148 20634 net.cpp:91] Creating Layer lstm2_unit_1
I0925 23:03:33.955162 20634 net.cpp:425] lstm2_unit_1 <- c_0
I0925 23:03:33.955179 20634 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0925 23:03:33.955193 20634 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0925 23:03:33.955206 20634 net.cpp:399] lstm2_unit_1 -> c_1
I0925 23:03:33.955230 20634 net.cpp:399] lstm2_unit_1 -> h_1
I0925 23:03:34.031005 20602 net.cpp:141] Setting up lstm1
I0925 23:03:34.031060 20602 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:34.031069 20602 net.cpp:156] Memory required for data: 26408
I0925 23:03:34.031132 20602 layer_factory.hpp:77] Creating layer concat
I0925 23:03:34.031162 20602 net.cpp:91] Creating Layer concat
I0925 23:03:34.031174 20602 net.cpp:425] concat <- lstm1
I0925 23:03:34.031188 20602 net.cpp:425] concat <- embedded_input_sentence
I0925 23:03:34.031198 20602 net.cpp:425] concat <- reshaped_stage_indicator
I0925 23:03:34.031210 20602 net.cpp:399] concat -> lstm1_video_sequence
I0925 23:03:34.039829 20594 net.cpp:141] Setting up h_pseudoloss
I0925 23:03:34.039899 20594 net.cpp:148] Top shape: (1)
I0925 23:03:34.039911 20594 net.cpp:151]     with loss weight 1
I0925 23:03:34.039948 20594 net.cpp:156] Memory required for data: 98024
I0925 23:03:34.039965 20594 net.cpp:217] h_pseudoloss needs backward computation.
I0925 23:03:34.039979 20594 net.cpp:217] lstm2_h_concat needs backward computation.
I0925 23:03:34.039991 20594 net.cpp:219] lstm2_ does not need backward computation.
I0925 23:03:34.040002 20594 net.cpp:217] lstm2_unit_1 needs backward computation.
I0925 23:03:34.040016 20594 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0925 23:03:34.039995 20602 net.cpp:141] Setting up concat
I0925 23:03:34.040025 20594 net.cpp:217] lstm2_transform_1 needs backward computation.
I0925 23:03:34.040066 20594 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0925 23:03:34.040073 20602 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 23:03:34.040077 20594 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0925 23:03:34.040102 20602 net.cpp:156] Memory required for data: 32412
I0925 23:03:34.040109 20594 net.cpp:217] lstm2_x_transform needs backward computation.
I0925 23:03:34.040124 20594 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0925 23:03:34.040128 20602 layer_factory.hpp:77] Creating layer lstm2
I0925 23:03:34.040134 20594 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0925 23:03:34.040146 20594 net.cpp:219] lstm2_ does not need backward computation.
I0925 23:03:34.040156 20594 net.cpp:219] lstm2_ does not need backward computation.
I0925 23:03:34.040163 20594 net.cpp:261] This network produces output c_T
I0925 23:03:34.040174 20594 net.cpp:261] This network produces output h_pseudoloss
I0925 23:03:34.040186 20602 net.cpp:91] Creating Layer lstm2
I0925 23:03:34.040208 20594 net.cpp:274] Network initialization done.
I0925 23:03:34.040211 20602 net.cpp:425] lstm2 <- lstm1_video_sequence
I0925 23:03:34.040240 20602 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0925 23:03:34.040271 20602 net.cpp:399] lstm2 -> lstm2
I0925 23:03:34.040314 20602 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 23:03:34.040319 20594 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 23:03:34.040354 20594 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 23:03:34.040364 20594 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 23:03:34.041600 20602 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 23:03:34.042331 20602 layer_factory.hpp:77] Creating layer lstm2_
I0925 23:03:34.042361 20602 net.cpp:91] Creating Layer lstm2_
I0925 23:03:34.042373 20602 net.cpp:399] lstm2_ -> x
I0925 23:03:34.042398 20602 net.cpp:399] lstm2_ -> cont
I0925 23:03:34.048782 20626 net.cpp:141] Setting up lstm1_h_conted_0
I0925 23:03:34.048841 20626 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:34.048844 20634 net.cpp:141] Setting up lstm2_unit_1
I0925 23:03:34.048852 20626 net.cpp:156] Memory required for data: 46016
I0925 23:03:34.048861 20634 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:34.048869 20634 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:34.048885 20634 net.cpp:156] Memory required for data: 90020
I0925 23:03:34.048897 20634 layer_factory.hpp:77] Creating layer lstm2_
I0925 23:03:34.048868 20626 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0925 23:03:34.048920 20634 net.cpp:91] Creating Layer lstm2_
I0925 23:03:34.048928 20626 net.cpp:91] Creating Layer lstm1_transform_1
I0925 23:03:34.048933 20634 net.cpp:425] lstm2_ <- c_1
I0925 23:03:34.048941 20626 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0925 23:03:34.048956 20626 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0925 23:03:34.049146 20594 net.cpp:141] Setting up lstm2
I0925 23:03:34.049173 20594 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:34.049185 20594 net.cpp:156] Memory required for data: 36412
I0925 23:03:34.049221 20594 layer_factory.hpp:77] Creating layer predict
I0925 23:03:34.049243 20594 net.cpp:91] Creating Layer predict
I0925 23:03:34.049257 20594 net.cpp:425] predict <- lstm2
I0925 23:03:34.049275 20594 net.cpp:399] predict -> predict
I0925 23:03:34.048955 20634 net.cpp:399] lstm2_ -> c_T
I0925 23:03:34.136612 20634 net.cpp:141] Setting up lstm2_
I0925 23:03:34.136677 20634 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:34.136687 20634 net.cpp:156] Memory required for data: 94020
I0925 23:03:34.136699 20634 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0925 23:03:34.136723 20634 net.cpp:91] Creating Layer lstm2_h_concat
I0925 23:03:34.136734 20634 net.cpp:425] lstm2_h_concat <- h_1
I0925 23:03:34.136754 20634 net.cpp:399] lstm2_h_concat -> h
I0925 23:03:34.137686 20602 net.cpp:141] Setting up lstm2_
I0925 23:03:34.137740 20602 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 23:03:34.137751 20602 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:34.137758 20602 net.cpp:156] Memory required for data: 6008
I0925 23:03:34.137769 20602 layer_factory.hpp:77] Creating layer lstm2_
I0925 23:03:34.137794 20602 net.cpp:91] Creating Layer lstm2_
I0925 23:03:34.137809 20602 net.cpp:399] lstm2_ -> c_0
I0925 23:03:34.137831 20602 net.cpp:399] lstm2_ -> h_0
I0925 23:03:34.150410 20634 net.cpp:141] Setting up lstm2_h_concat
I0925 23:03:34.150462 20634 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:34.150472 20634 net.cpp:156] Memory required for data: 98020
I0925 23:03:34.150485 20634 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 23:03:34.150507 20634 net.cpp:91] Creating Layer h_pseudoloss
I0925 23:03:34.150518 20634 net.cpp:425] h_pseudoloss <- h
I0925 23:03:34.150534 20634 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 23:03:34.150591 20584 net.cpp:141] Setting up lstm2_transform_1
I0925 23:03:34.150629 20584 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:34.150635 20584 net.cpp:156] Memory required for data: 66020
I0925 23:03:34.150650 20584 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0925 23:03:34.150674 20584 net.cpp:91] Creating Layer lstm2_gate_input_1
I0925 23:03:34.150683 20584 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0925 23:03:34.150691 20584 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0925 23:03:34.150699 20584 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0925 23:03:34.150710 20590 net.cpp:141] Setting up predict
I0925 23:03:34.150732 20590 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 23:03:34.150738 20590 net.cpp:156] Memory required for data: 221084
I0925 23:03:34.150749 20590 layer_factory.hpp:77] Creating layer probs
I0925 23:03:34.150756 20584 net.cpp:141] Setting up lstm2_gate_input_1
I0925 23:03:34.150763 20590 net.cpp:91] Creating Layer probs
I0925 23:03:34.150768 20584 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:34.150771 20590 net.cpp:425] probs <- predict
I0925 23:03:34.150771 20584 net.cpp:156] Memory required for data: 82020
I0925 23:03:34.150777 20584 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0925 23:03:34.150780 20590 net.cpp:399] probs -> probs
I0925 23:03:34.150787 20584 net.cpp:91] Creating Layer lstm2_unit_1
I0925 23:03:34.150792 20584 net.cpp:425] lstm2_unit_1 <- c_0
I0925 23:03:34.150799 20584 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0925 23:03:34.150804 20584 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0925 23:03:34.150813 20584 net.cpp:399] lstm2_unit_1 -> c_1
I0925 23:03:34.150825 20584 net.cpp:399] lstm2_unit_1 -> h_1
I0925 23:03:34.150934 20634 net.cpp:141] Setting up h_pseudoloss
I0925 23:03:34.150954 20634 net.cpp:148] Top shape: (1)
I0925 23:03:34.150962 20634 net.cpp:151]     with loss weight 1
I0925 23:03:34.150987 20602 net.cpp:141] Setting up lstm2_
I0925 23:03:34.150995 20634 net.cpp:156] Memory required for data: 98024
I0925 23:03:34.151015 20602 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:34.151021 20634 net.cpp:217] h_pseudoloss needs backward computation.
I0925 23:03:34.151023 20602 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:34.151036 20634 net.cpp:217] lstm2_h_concat needs backward computation.
I0925 23:03:34.151042 20602 net.cpp:156] Memory required for data: 14008
I0925 23:03:34.151046 20634 net.cpp:219] lstm2_ does not need backward computation.
I0925 23:03:34.151049 20602 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0925 23:03:34.151056 20634 net.cpp:217] lstm2_unit_1 needs backward computation.
I0925 23:03:34.151063 20602 net.cpp:91] Creating Layer lstm2_cont_slice
I0925 23:03:34.151067 20634 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0925 23:03:34.151069 20602 net.cpp:425] lstm2_cont_slice <- cont
I0925 23:03:34.151079 20634 net.cpp:217] lstm2_transform_1 needs backward computation.
I0925 23:03:34.151080 20602 net.cpp:399] lstm2_cont_slice -> cont_1
I0925 23:03:34.151093 20584 net.cpp:141] Setting up lstm2_unit_1
I0925 23:03:34.151096 20634 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0925 23:03:34.151108 20634 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0925 23:03:34.151118 20634 net.cpp:217] lstm2_x_transform needs backward computation.
I0925 23:03:34.151121 20584 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:34.151126 20634 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0925 23:03:34.151130 20584 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:34.151135 20584 net.cpp:156] Memory required for data: 90020
I0925 23:03:34.151136 20634 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0925 23:03:34.151140 20584 layer_factory.hpp:77] Creating layer lstm2_
I0925 23:03:34.151146 20634 net.cpp:219] lstm2_ does not need backward computation.
I0925 23:03:34.151151 20584 net.cpp:91] Creating Layer lstm2_
I0925 23:03:34.151154 20634 net.cpp:219] lstm2_ does not need backward computation.
I0925 23:03:34.151157 20584 net.cpp:425] lstm2_ <- c_1
I0925 23:03:34.151162 20634 net.cpp:261] This network produces output c_T
I0925 23:03:34.151166 20584 net.cpp:399] lstm2_ -> c_T
I0925 23:03:34.151171 20634 net.cpp:261] This network produces output h_pseudoloss
I0925 23:03:34.151196 20634 net.cpp:274] Network initialization done.
I0925 23:03:34.151326 20634 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 23:03:34.151338 20634 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 23:03:34.151346 20634 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 23:03:34.189822 20602 net.cpp:141] Setting up lstm2_cont_slice
I0925 23:03:34.189878 20602 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:34.189888 20602 net.cpp:156] Memory required for data: 14012
I0925 23:03:34.189901 20602 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0925 23:03:34.189927 20602 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0925 23:03:34.189939 20602 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0925 23:03:34.189954 20602 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0925 23:03:34.189973 20602 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0925 23:03:34.190084 20602 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0925 23:03:34.190099 20602 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:34.190109 20602 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:34.190116 20602 net.cpp:156] Memory required for data: 14020
I0925 23:03:34.190124 20602 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0925 23:03:34.190147 20602 net.cpp:91] Creating Layer lstm2_x_transform
I0925 23:03:34.190155 20602 net.cpp:425] lstm2_x_transform <- x
I0925 23:03:34.190176 20602 net.cpp:399] lstm2_x_transform -> W_xc_x
I0925 23:03:34.204833 20584 net.cpp:141] Setting up lstm2_
I0925 23:03:34.204882 20626 net.cpp:141] Setting up lstm1_transform_1
I0925 23:03:34.205433 20584 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:34.205451 20626 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:34.204929 20634 net.cpp:141] Setting up lstm2
I0925 23:03:34.205458 20584 net.cpp:156] Memory required for data: 94020
I0925 23:03:34.205463 20626 net.cpp:156] Memory required for data: 62016
I0925 23:03:34.205479 20634 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:34.205488 20634 net.cpp:156] Memory required for data: 36412
I0925 23:03:34.205488 20584 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0925 23:03:34.205507 20626 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0925 23:03:34.205513 20634 layer_factory.hpp:77] Creating layer predict
I0925 23:03:34.205528 20584 net.cpp:91] Creating Layer lstm2_h_concat
I0925 23:03:34.205548 20634 net.cpp:91] Creating Layer predict
I0925 23:03:34.205549 20626 net.cpp:91] Creating Layer lstm1_gate_input_1
I0925 23:03:34.205549 20584 net.cpp:425] lstm2_h_concat <- h_1
I0925 23:03:34.205564 20626 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0925 23:03:34.205559 20634 net.cpp:425] predict <- lstm2
I0925 23:03:34.205576 20626 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0925 23:03:34.205591 20626 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0925 23:03:34.205591 20634 net.cpp:399] predict -> predict
I0925 23:03:34.205601 20584 net.cpp:399] lstm2_h_concat -> h
I0925 23:03:34.207252 20626 net.cpp:141] Setting up lstm1_gate_input_1
I0925 23:03:34.207270 20626 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:34.207276 20626 net.cpp:156] Memory required for data: 78016
I0925 23:03:34.207281 20626 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0925 23:03:34.207295 20626 net.cpp:91] Creating Layer lstm1_unit_1
I0925 23:03:34.207301 20626 net.cpp:425] lstm1_unit_1 <- c_0
I0925 23:03:34.207309 20626 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0925 23:03:34.207314 20626 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0925 23:03:34.207320 20626 net.cpp:399] lstm1_unit_1 -> c_1
I0925 23:03:34.207330 20626 net.cpp:399] lstm1_unit_1 -> h_1
I0925 23:03:34.293655 20584 net.cpp:141] Setting up lstm2_h_concat
I0925 23:03:34.293715 20584 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:34.293730 20584 net.cpp:156] Memory required for data: 98020
I0925 23:03:34.293745 20584 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 23:03:34.293781 20584 net.cpp:91] Creating Layer h_pseudoloss
I0925 23:03:34.293793 20584 net.cpp:425] h_pseudoloss <- h
I0925 23:03:34.293813 20584 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 23:03:34.294011 20584 net.cpp:141] Setting up h_pseudoloss
I0925 23:03:34.294029 20584 net.cpp:148] Top shape: (1)
I0925 23:03:34.294039 20584 net.cpp:151]     with loss weight 1
I0925 23:03:34.294075 20584 net.cpp:156] Memory required for data: 98024
I0925 23:03:34.294083 20584 net.cpp:217] h_pseudoloss needs backward computation.
I0925 23:03:34.294091 20584 net.cpp:217] lstm2_h_concat needs backward computation.
I0925 23:03:34.294098 20584 net.cpp:219] lstm2_ does not need backward computation.
I0925 23:03:34.294107 20584 net.cpp:217] lstm2_unit_1 needs backward computation.
I0925 23:03:34.294118 20584 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0925 23:03:34.294128 20584 net.cpp:217] lstm2_transform_1 needs backward computation.
I0925 23:03:34.294137 20584 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0925 23:03:34.294149 20584 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0925 23:03:34.294159 20584 net.cpp:217] lstm2_x_transform needs backward computation.
I0925 23:03:34.294169 20584 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0925 23:03:34.294179 20584 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0925 23:03:34.294190 20584 net.cpp:219] lstm2_ does not need backward computation.
I0925 23:03:34.294198 20584 net.cpp:219] lstm2_ does not need backward computation.
I0925 23:03:34.294206 20584 net.cpp:261] This network produces output c_T
I0925 23:03:34.294215 20584 net.cpp:261] This network produces output h_pseudoloss
I0925 23:03:34.294248 20584 net.cpp:274] Network initialization done.
I0925 23:03:34.294343 20584 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 23:03:34.294358 20584 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 23:03:34.294366 20584 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 23:03:34.294586 20584 net.cpp:141] Setting up lstm2
I0925 23:03:34.294625 20584 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:34.294636 20584 net.cpp:156] Memory required for data: 36412
I0925 23:03:34.294672 20584 layer_factory.hpp:77] Creating layer predict
I0925 23:03:34.294695 20584 net.cpp:91] Creating Layer predict
I0925 23:03:34.294710 20584 net.cpp:425] predict <- lstm2
I0925 23:03:34.294726 20584 net.cpp:399] predict -> predict
I0925 23:03:34.380475 20588 net.cpp:141] Setting up predict
I0925 23:03:34.380535 20588 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 23:03:34.380542 20588 net.cpp:156] Memory required for data: 221084
I0925 23:03:34.380574 20588 layer_factory.hpp:77] Creating layer probs
I0925 23:03:34.380596 20588 net.cpp:91] Creating Layer probs
I0925 23:03:34.380605 20588 net.cpp:425] probs <- predict
I0925 23:03:34.380619 20588 net.cpp:399] probs -> probs
I0925 23:03:34.380801 20626 net.cpp:141] Setting up lstm1_unit_1
I0925 23:03:34.380821 20626 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:34.380830 20626 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:34.380833 20626 net.cpp:156] Memory required for data: 86016
I0925 23:03:34.380839 20626 layer_factory.hpp:77] Creating layer lstm1_
I0925 23:03:34.380877 20626 net.cpp:91] Creating Layer lstm1_
I0925 23:03:34.380887 20626 net.cpp:425] lstm1_ <- c_1
I0925 23:03:34.380895 20626 net.cpp:399] lstm1_ -> c_T
I0925 23:03:34.380913 20602 net.cpp:141] Setting up lstm2_x_transform
I0925 23:03:34.380957 20602 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:34.380964 20602 net.cpp:156] Memory required for data: 30020
I0925 23:03:34.380985 20602 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0925 23:03:34.380998 20626 net.cpp:141] Setting up lstm1_
I0925 23:03:34.381002 20602 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0925 23:03:34.381016 20626 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:34.381021 20626 net.cpp:156] Memory required for data: 90016
I0925 23:03:34.381022 20602 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0925 23:03:34.381026 20626 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0925 23:03:34.381049 20602 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0925 23:03:34.381050 20626 net.cpp:91] Creating Layer lstm1_h_concat
I0925 23:03:34.381067 20626 net.cpp:425] lstm1_h_concat <- h_1
I0925 23:03:34.381079 20626 net.cpp:399] lstm1_h_concat -> h
I0925 23:03:34.381189 20602 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0925 23:03:34.381202 20602 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:34.381206 20602 net.cpp:156] Memory required for data: 46020
I0925 23:03:34.381212 20602 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0925 23:03:34.381223 20602 net.cpp:91] Creating Layer lstm2_h_conted_0
I0925 23:03:34.381228 20602 net.cpp:425] lstm2_h_conted_0 <- h_0
I0925 23:03:34.381235 20602 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0925 23:03:34.381243 20602 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0925 23:03:34.386096 20626 net.cpp:141] Setting up lstm1_h_concat
I0925 23:03:34.386150 20626 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:34.386159 20626 net.cpp:156] Memory required for data: 94016
I0925 23:03:34.386173 20626 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 23:03:34.386200 20626 net.cpp:91] Creating Layer h_pseudoloss
I0925 23:03:34.386212 20626 net.cpp:425] h_pseudoloss <- h
I0925 23:03:34.386229 20626 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 23:03:34.386379 20602 net.cpp:141] Setting up lstm2_h_conted_0
I0925 23:03:34.386421 20602 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:34.386427 20602 net.cpp:156] Memory required for data: 50020
I0925 23:03:34.386435 20602 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0925 23:03:34.386457 20602 net.cpp:91] Creating Layer lstm2_transform_1
I0925 23:03:34.386466 20602 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0925 23:03:34.386482 20602 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0925 23:03:34.386538 20626 net.cpp:141] Setting up h_pseudoloss
I0925 23:03:34.386556 20626 net.cpp:148] Top shape: (1)
I0925 23:03:34.386564 20626 net.cpp:151]     with loss weight 1
I0925 23:03:34.386592 20626 net.cpp:156] Memory required for data: 94020
I0925 23:03:34.386616 20626 net.cpp:217] h_pseudoloss needs backward computation.
I0925 23:03:34.386625 20626 net.cpp:217] lstm1_h_concat needs backward computation.
I0925 23:03:34.386633 20626 net.cpp:219] lstm1_ does not need backward computation.
I0925 23:03:34.386642 20626 net.cpp:217] lstm1_unit_1 needs backward computation.
I0925 23:03:34.386652 20626 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0925 23:03:34.386660 20626 net.cpp:217] lstm1_transform_1 needs backward computation.
I0925 23:03:34.386668 20626 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0925 23:03:34.386683 20626 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0925 23:03:34.386693 20626 net.cpp:217] lstm1_x_transform needs backward computation.
I0925 23:03:34.386703 20626 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0925 23:03:34.386711 20626 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0925 23:03:34.386720 20626 net.cpp:219] lstm1_ does not need backward computation.
I0925 23:03:34.386728 20626 net.cpp:219] lstm1_ does not need backward computation.
I0925 23:03:34.386734 20626 net.cpp:261] This network produces output c_T
I0925 23:03:34.386741 20626 net.cpp:261] This network produces output h_pseudoloss
I0925 23:03:34.386765 20626 net.cpp:274] Network initialization done.
I0925 23:03:34.386845 20626 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 23:03:34.386858 20626 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 23:03:34.386867 20626 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 23:03:34.395050 20638 net.cpp:141] Setting up predict
I0925 23:03:34.395115 20638 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 23:03:34.395124 20638 net.cpp:156] Memory required for data: 221084
I0925 23:03:34.395148 20638 layer_factory.hpp:77] Creating layer probs
I0925 23:03:34.395174 20638 net.cpp:91] Creating Layer probs
I0925 23:03:34.395185 20638 net.cpp:425] probs <- predict
I0925 23:03:34.395201 20638 net.cpp:399] probs -> probs
I0925 23:03:34.396667 20626 net.cpp:141] Setting up lstm1
I0925 23:03:34.396733 20626 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:34.396746 20626 net.cpp:156] Memory required for data: 26408
I0925 23:03:34.396786 20626 layer_factory.hpp:77] Creating layer concat
I0925 23:03:34.396819 20626 net.cpp:91] Creating Layer concat
I0925 23:03:34.396833 20626 net.cpp:425] concat <- lstm1
I0925 23:03:34.396847 20626 net.cpp:425] concat <- embedded_input_sentence
I0925 23:03:34.396857 20626 net.cpp:425] concat <- reshaped_stage_indicator
I0925 23:03:34.396872 20626 net.cpp:399] concat -> lstm1_video_sequence
I0925 23:03:34.399171 20626 net.cpp:141] Setting up concat
I0925 23:03:34.399212 20626 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 23:03:34.399222 20626 net.cpp:156] Memory required for data: 32412
I0925 23:03:34.399232 20626 layer_factory.hpp:77] Creating layer lstm2
I0925 23:03:34.399262 20626 net.cpp:91] Creating Layer lstm2
I0925 23:03:34.399274 20626 net.cpp:425] lstm2 <- lstm1_video_sequence
I0925 23:03:34.399286 20626 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0925 23:03:34.399302 20626 net.cpp:399] lstm2 -> lstm2
I0925 23:03:34.399322 20626 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 23:03:34.399749 20626 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 23:03:34.399886 20626 layer_factory.hpp:77] Creating layer lstm2_
I0925 23:03:34.399904 20626 net.cpp:91] Creating Layer lstm2_
I0925 23:03:34.399915 20626 net.cpp:399] lstm2_ -> x
I0925 23:03:34.399935 20626 net.cpp:399] lstm2_ -> cont
I0925 23:03:34.424702 20626 net.cpp:141] Setting up lstm2_
I0925 23:03:34.424767 20626 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 23:03:34.424783 20626 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:34.424792 20626 net.cpp:156] Memory required for data: 6008
I0925 23:03:34.424805 20626 layer_factory.hpp:77] Creating layer lstm2_
I0925 23:03:34.424836 20626 net.cpp:91] Creating Layer lstm2_
I0925 23:03:34.424855 20626 net.cpp:399] lstm2_ -> c_0
I0925 23:03:34.424886 20626 net.cpp:399] lstm2_ -> h_0
I0925 23:03:34.424999 20626 net.cpp:141] Setting up lstm2_
I0925 23:03:34.425017 20626 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:34.425029 20626 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:34.425037 20626 net.cpp:156] Memory required for data: 14008
I0925 23:03:34.425046 20626 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0925 23:03:34.425065 20626 net.cpp:91] Creating Layer lstm2_cont_slice
I0925 23:03:34.425074 20626 net.cpp:425] lstm2_cont_slice <- cont
I0925 23:03:34.425087 20626 net.cpp:399] lstm2_cont_slice -> cont_1
I0925 23:03:34.425155 20626 net.cpp:141] Setting up lstm2_cont_slice
I0925 23:03:34.425173 20626 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:34.425181 20626 net.cpp:156] Memory required for data: 14012
I0925 23:03:34.425190 20626 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0925 23:03:34.425207 20626 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0925 23:03:34.425217 20626 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0925 23:03:34.425230 20626 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0925 23:03:34.425245 20626 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0925 23:03:34.425339 20626 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0925 23:03:34.425354 20626 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:34.425364 20626 net.cpp:148] Top shape: 1 1 (1)
I0925 23:03:34.425374 20626 net.cpp:156] Memory required for data: 14020
I0925 23:03:34.425382 20626 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0925 23:03:34.425406 20626 net.cpp:91] Creating Layer lstm2_x_transform
I0925 23:03:34.425415 20626 net.cpp:425] lstm2_x_transform <- x
I0925 23:03:34.425428 20626 net.cpp:399] lstm2_x_transform -> W_xc_x
I0925 23:03:34.442576 20602 net.cpp:141] Setting up lstm2_transform_1
I0925 23:03:34.442636 20602 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:34.442642 20602 net.cpp:156] Memory required for data: 66020
I0925 23:03:34.442664 20602 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0925 23:03:34.442689 20602 net.cpp:91] Creating Layer lstm2_gate_input_1
I0925 23:03:34.442698 20602 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0925 23:03:34.442705 20602 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0925 23:03:34.442713 20602 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0925 23:03:34.443861 20602 net.cpp:141] Setting up lstm2_gate_input_1
I0925 23:03:34.443878 20602 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:34.443883 20602 net.cpp:156] Memory required for data: 82020
I0925 23:03:34.443889 20602 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0925 23:03:34.443899 20602 net.cpp:91] Creating Layer lstm2_unit_1
I0925 23:03:34.443905 20602 net.cpp:425] lstm2_unit_1 <- c_0
I0925 23:03:34.443912 20602 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0925 23:03:34.443917 20602 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0925 23:03:34.443928 20602 net.cpp:399] lstm2_unit_1 -> c_1
I0925 23:03:34.443939 20602 net.cpp:399] lstm2_unit_1 -> h_1
I0925 23:03:34.449067 20602 net.cpp:141] Setting up lstm2_unit_1
I0925 23:03:34.449125 20602 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:34.449141 20602 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:34.449148 20602 net.cpp:156] Memory required for data: 90020
I0925 23:03:34.449162 20602 layer_factory.hpp:77] Creating layer lstm2_
I0925 23:03:34.449184 20602 net.cpp:91] Creating Layer lstm2_
I0925 23:03:34.449195 20602 net.cpp:425] lstm2_ <- c_1
I0925 23:03:34.449214 20602 net.cpp:399] lstm2_ -> c_T
I0925 23:03:34.475278 20602 net.cpp:141] Setting up lstm2_
I0925 23:03:34.475339 20602 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:34.475349 20602 net.cpp:156] Memory required for data: 94020
I0925 23:03:34.475360 20602 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0925 23:03:34.475381 20602 net.cpp:91] Creating Layer lstm2_h_concat
I0925 23:03:34.475391 20602 net.cpp:425] lstm2_h_concat <- h_1
I0925 23:03:34.475409 20602 net.cpp:399] lstm2_h_concat -> h
I0925 23:03:34.476727 20602 net.cpp:141] Setting up lstm2_h_concat
I0925 23:03:34.476749 20602 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:34.476758 20602 net.cpp:156] Memory required for data: 98020
I0925 23:03:34.476765 20602 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 23:03:34.476788 20602 net.cpp:91] Creating Layer h_pseudoloss
I0925 23:03:34.476796 20602 net.cpp:425] h_pseudoloss <- h
I0925 23:03:34.476807 20602 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 23:03:34.479156 20602 net.cpp:141] Setting up h_pseudoloss
I0925 23:03:34.479179 20602 net.cpp:148] Top shape: (1)
I0925 23:03:34.479187 20602 net.cpp:151]     with loss weight 1
I0925 23:03:34.479209 20602 net.cpp:156] Memory required for data: 98024
I0925 23:03:34.479218 20602 net.cpp:217] h_pseudoloss needs backward computation.
I0925 23:03:34.479224 20602 net.cpp:217] lstm2_h_concat needs backward computation.
I0925 23:03:34.479231 20602 net.cpp:219] lstm2_ does not need backward computation.
I0925 23:03:34.479238 20602 net.cpp:217] lstm2_unit_1 needs backward computation.
I0925 23:03:34.479248 20602 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0925 23:03:34.479255 20602 net.cpp:217] lstm2_transform_1 needs backward computation.
I0925 23:03:34.479264 20602 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0925 23:03:34.479271 20602 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0925 23:03:34.479279 20602 net.cpp:217] lstm2_x_transform needs backward computation.
I0925 23:03:34.479286 20602 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0925 23:03:34.479295 20602 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0925 23:03:34.479303 20602 net.cpp:219] lstm2_ does not need backward computation.
I0925 23:03:34.479310 20602 net.cpp:219] lstm2_ does not need backward computation.
I0925 23:03:34.479315 20602 net.cpp:261] This network produces output c_T
I0925 23:03:34.479322 20602 net.cpp:261] This network produces output h_pseudoloss
I0925 23:03:34.479349 20602 net.cpp:274] Network initialization done.
I0925 23:03:34.479415 20602 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 23:03:34.479424 20602 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 23:03:34.479431 20602 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 23:03:34.480629 20602 net.cpp:141] Setting up lstm2
I0925 23:03:34.480650 20602 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:34.480659 20602 net.cpp:156] Memory required for data: 36412
I0925 23:03:34.480687 20602 layer_factory.hpp:77] Creating layer predict
I0925 23:03:34.480710 20602 net.cpp:91] Creating Layer predict
I0925 23:03:34.480722 20602 net.cpp:425] predict <- lstm2
I0925 23:03:34.480738 20602 net.cpp:399] predict -> predict
I0925 23:03:34.493525 20626 net.cpp:141] Setting up lstm2_x_transform
I0925 23:03:34.493901 20626 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:34.494030 20626 net.cpp:156] Memory required for data: 30020
I0925 23:03:34.494223 20626 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0925 23:03:34.494369 20626 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0925 23:03:34.494635 20626 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0925 23:03:34.494781 20626 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0925 23:03:34.494997 20626 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0925 23:03:34.495174 20626 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:34.495302 20626 net.cpp:156] Memory required for data: 46020
I0925 23:03:34.495429 20626 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0925 23:03:34.495560 20626 net.cpp:91] Creating Layer lstm2_h_conted_0
I0925 23:03:34.495826 20626 net.cpp:425] lstm2_h_conted_0 <- h_0
I0925 23:03:34.496093 20626 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0925 23:03:34.496121 20626 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0925 23:03:34.496354 20626 net.cpp:141] Setting up lstm2_h_conted_0
I0925 23:03:34.496372 20626 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:34.496381 20626 net.cpp:156] Memory required for data: 50020
I0925 23:03:34.496388 20626 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0925 23:03:34.496408 20626 net.cpp:91] Creating Layer lstm2_transform_1
I0925 23:03:34.496417 20626 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0925 23:03:34.496433 20626 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0925 23:03:34.593044 20626 net.cpp:141] Setting up lstm2_transform_1
I0925 23:03:34.593104 20626 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:34.593111 20626 net.cpp:156] Memory required for data: 66020
I0925 23:03:34.593135 20626 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0925 23:03:34.593163 20626 net.cpp:91] Creating Layer lstm2_gate_input_1
I0925 23:03:34.593169 20626 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0925 23:03:34.593178 20626 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0925 23:03:34.593186 20626 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0925 23:03:34.594219 20594 net.cpp:141] Setting up predict
I0925 23:03:34.594243 20594 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 23:03:34.594249 20594 net.cpp:156] Memory required for data: 221084
I0925 23:03:34.594260 20594 layer_factory.hpp:77] Creating layer probs
I0925 23:03:34.594277 20594 net.cpp:91] Creating Layer probs
I0925 23:03:34.594285 20594 net.cpp:425] probs <- predict
I0925 23:03:34.594292 20594 net.cpp:399] probs -> probs
I0925 23:03:34.594354 20626 net.cpp:141] Setting up lstm2_gate_input_1
I0925 23:03:34.594372 20626 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 23:03:34.594377 20626 net.cpp:156] Memory required for data: 82020
I0925 23:03:34.594383 20626 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0925 23:03:34.594393 20626 net.cpp:91] Creating Layer lstm2_unit_1
I0925 23:03:34.594398 20626 net.cpp:425] lstm2_unit_1 <- c_0
I0925 23:03:34.594405 20626 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0925 23:03:34.594411 20626 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0925 23:03:34.594422 20626 net.cpp:399] lstm2_unit_1 -> c_1
I0925 23:03:34.594434 20626 net.cpp:399] lstm2_unit_1 -> h_1
I0925 23:03:34.594441 20608 net.cpp:141] Setting up predict
I0925 23:03:34.594490 20608 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 23:03:34.594496 20608 net.cpp:156] Memory required for data: 221084
I0925 23:03:34.594516 20608 layer_factory.hpp:77] Creating layer probs
I0925 23:03:34.594534 20608 net.cpp:91] Creating Layer probs
I0925 23:03:34.594544 20608 net.cpp:425] probs <- predict
I0925 23:03:34.594542 20626 net.cpp:141] Setting up lstm2_unit_1
I0925 23:03:34.594561 20608 net.cpp:399] probs -> probs
I0925 23:03:34.594566 20626 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:34.594573 20626 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:34.594578 20626 net.cpp:156] Memory required for data: 90020
I0925 23:03:34.594583 20626 layer_factory.hpp:77] Creating layer lstm2_
I0925 23:03:34.594591 20626 net.cpp:91] Creating Layer lstm2_
I0925 23:03:34.594614 20626 net.cpp:425] lstm2_ <- c_1
I0925 23:03:34.594621 20626 net.cpp:399] lstm2_ -> c_T
I0925 23:03:34.594663 20626 net.cpp:141] Setting up lstm2_
I0925 23:03:34.594673 20626 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:34.594678 20626 net.cpp:156] Memory required for data: 94020
I0925 23:03:34.594682 20626 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0925 23:03:34.594693 20626 net.cpp:91] Creating Layer lstm2_h_concat
I0925 23:03:34.594698 20626 net.cpp:425] lstm2_h_concat <- h_1
I0925 23:03:34.594705 20626 net.cpp:399] lstm2_h_concat -> h
I0925 23:03:34.594779 20626 net.cpp:141] Setting up lstm2_h_concat
I0925 23:03:34.594789 20626 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:34.594794 20626 net.cpp:156] Memory required for data: 98020
I0925 23:03:34.594799 20626 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 23:03:34.594808 20626 net.cpp:91] Creating Layer h_pseudoloss
I0925 23:03:34.594812 20626 net.cpp:425] h_pseudoloss <- h
I0925 23:03:34.594820 20626 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 23:03:34.605062 20626 net.cpp:141] Setting up h_pseudoloss
I0925 23:03:34.605118 20626 net.cpp:148] Top shape: (1)
I0925 23:03:34.605126 20626 net.cpp:151]     with loss weight 1
I0925 23:03:34.605146 20626 net.cpp:156] Memory required for data: 98024
I0925 23:03:34.605167 20626 net.cpp:217] h_pseudoloss needs backward computation.
I0925 23:03:34.605176 20626 net.cpp:217] lstm2_h_concat needs backward computation.
I0925 23:03:34.605185 20626 net.cpp:219] lstm2_ does not need backward computation.
I0925 23:03:34.605193 20626 net.cpp:217] lstm2_unit_1 needs backward computation.
I0925 23:03:34.605204 20626 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0925 23:03:34.605213 20626 net.cpp:217] lstm2_transform_1 needs backward computation.
I0925 23:03:34.605222 20626 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0925 23:03:34.605232 20626 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0925 23:03:34.605240 20626 net.cpp:217] lstm2_x_transform needs backward computation.
I0925 23:03:34.605274 20626 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0925 23:03:34.605288 20626 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0925 23:03:34.605298 20626 net.cpp:219] lstm2_ does not need backward computation.
I0925 23:03:34.605304 20626 net.cpp:219] lstm2_ does not need backward computation.
I0925 23:03:34.605311 20626 net.cpp:261] This network produces output c_T
I0925 23:03:34.605320 20626 net.cpp:261] This network produces output h_pseudoloss
I0925 23:03:34.605345 20626 net.cpp:274] Network initialization done.
I0925 23:03:34.605419 20626 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 23:03:34.605429 20626 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 23:03:34.605437 20626 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 23:03:34.616971 20626 net.cpp:141] Setting up lstm2
I0925 23:03:34.617033 20626 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 23:03:34.617043 20626 net.cpp:156] Memory required for data: 36412
I0925 23:03:34.617077 20626 layer_factory.hpp:77] Creating layer predict
I0925 23:03:34.617105 20626 net.cpp:91] Creating Layer predict
I0925 23:03:34.617116 20626 net.cpp:425] predict <- lstm2
I0925 23:03:34.617132 20626 net.cpp:399] predict -> predict
I0925 23:03:34.702499 20634 net.cpp:141] Setting up predict
I0925 23:03:34.702564 20634 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 23:03:34.702574 20634 net.cpp:156] Memory required for data: 221084
I0925 23:03:34.702616 20634 layer_factory.hpp:77] Creating layer probs
I0925 23:03:34.702644 20634 net.cpp:91] Creating Layer probs
I0925 23:03:34.702657 20634 net.cpp:425] probs <- predict
I0925 23:03:34.702675 20634 net.cpp:399] probs -> probs
I0925 23:03:34.840983 20610 net.cpp:141] Setting up conv1
I0925 23:03:34.841042 20610 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0925 23:03:34.841048 20610 net.cpp:156] Memory required for data: 17799480
I0925 23:03:34.841074 20610 layer_factory.hpp:77] Creating layer relu1
I0925 23:03:34.841095 20610 net.cpp:91] Creating Layer relu1
I0925 23:03:34.841102 20610 net.cpp:425] relu1 <- conv1
I0925 23:03:34.841111 20610 net.cpp:386] relu1 -> conv1 (in-place)
I0925 23:03:34.841503 20610 net.cpp:141] Setting up relu1
I0925 23:03:34.841517 20610 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0925 23:03:34.841522 20610 net.cpp:156] Memory required for data: 29415480
I0925 23:03:34.841528 20610 layer_factory.hpp:77] Creating layer pool1
I0925 23:03:34.841558 20610 net.cpp:91] Creating Layer pool1
I0925 23:03:34.841564 20610 net.cpp:425] pool1 <- conv1
I0925 23:03:34.841573 20610 net.cpp:399] pool1 -> pool1
I0925 23:03:34.841668 20610 net.cpp:141] Setting up pool1
I0925 23:03:34.841681 20610 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0925 23:03:34.841686 20610 net.cpp:156] Memory required for data: 32214840
I0925 23:03:34.841692 20610 layer_factory.hpp:77] Creating layer norm1
I0925 23:03:34.841712 20610 net.cpp:91] Creating Layer norm1
I0925 23:03:34.841717 20610 net.cpp:425] norm1 <- pool1
I0925 23:03:34.841724 20610 net.cpp:399] norm1 -> norm1
I0925 23:03:34.841996 20610 net.cpp:141] Setting up norm1
I0925 23:03:34.842010 20610 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0925 23:03:34.842015 20610 net.cpp:156] Memory required for data: 35014200
I0925 23:03:34.842020 20610 layer_factory.hpp:77] Creating layer conv2
I0925 23:03:34.842052 20610 net.cpp:91] Creating Layer conv2
I0925 23:03:34.842059 20610 net.cpp:425] conv2 <- norm1
I0925 23:03:34.842067 20610 net.cpp:399] conv2 -> conv2
I0925 23:03:34.844146 20594 net.cpp:141] Setting up probs
I0925 23:03:34.844173 20594 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 23:03:34.844178 20594 net.cpp:156] Memory required for data: 405756
I0925 23:03:34.844185 20594 net.cpp:219] probs does not need backward computation.
I0925 23:03:34.844192 20594 net.cpp:219] predict does not need backward computation.
I0925 23:03:34.844197 20594 net.cpp:219] lstm2 does not need backward computation.
I0925 23:03:34.844202 20594 net.cpp:219] concat does not need backward computation.
I0925 23:03:34.844208 20594 net.cpp:219] lstm1 does not need backward computation.
I0925 23:03:34.844214 20594 net.cpp:219] embedding does not need backward computation.
I0925 23:03:34.844219 20594 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0925 23:03:34.844224 20594 net.cpp:219] reshape_frames does not need backward computation.
I0925 23:03:34.844229 20594 net.cpp:219] embed_encoder does not need backward computation.
I0925 23:03:34.844234 20594 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0925 23:03:34.844239 20594 net.cpp:219] input does not need backward computation.
I0925 23:03:34.844244 20594 net.cpp:261] This network produces output probs
I0925 23:03:34.844259 20594 net.cpp:274] Network initialization done.
I0925 23:03:34.849261 20588 net.cpp:141] Setting up probs
I0925 23:03:34.849313 20588 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 23:03:34.849323 20588 net.cpp:156] Memory required for data: 405756
I0925 23:03:34.849336 20588 net.cpp:219] probs does not need backward computation.
I0925 23:03:34.849349 20588 net.cpp:219] predict does not need backward computation.
I0925 23:03:34.849359 20588 net.cpp:219] lstm2 does not need backward computation.
I0925 23:03:34.849369 20588 net.cpp:219] concat does not need backward computation.
I0925 23:03:34.849378 20588 net.cpp:219] lstm1 does not need backward computation.
I0925 23:03:34.849382 20584 net.cpp:141] Setting up predict
I0925 23:03:34.849388 20588 net.cpp:219] embedding does not need backward computation.
I0925 23:03:34.849397 20588 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0925 23:03:34.849400 20584 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 23:03:34.849407 20584 net.cpp:156] Memory required for data: 221084
I0925 23:03:34.849407 20588 net.cpp:219] reshape_frames does not need backward computation.
I0925 23:03:34.849429 20588 net.cpp:219] embed_encoder does not need backward computation.
I0925 23:03:34.849434 20584 layer_factory.hpp:77] Creating layer probs
I0925 23:03:34.849439 20588 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0925 23:03:34.849448 20588 net.cpp:219] input does not need backward computation.
I0925 23:03:34.849454 20588 net.cpp:261] This network produces output probs
I0925 23:03:34.849473 20584 net.cpp:91] Creating Layer probs
I0925 23:03:34.849483 20588 net.cpp:274] Network initialization done.
I0925 23:03:34.849484 20584 net.cpp:425] probs <- predict
I0925 23:03:34.849509 20584 net.cpp:399] probs -> probs
I0925 23:03:34.851640 20584 net.cpp:141] Setting up probs
I0925 23:03:34.851691 20584 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 23:03:34.851701 20584 net.cpp:156] Memory required for data: 405756
I0925 23:03:34.851713 20584 net.cpp:219] probs does not need backward computation.
I0925 23:03:34.851723 20584 net.cpp:219] predict does not need backward computation.
I0925 23:03:34.851735 20584 net.cpp:219] lstm2 does not need backward computation.
I0925 23:03:34.851745 20584 net.cpp:219] concat does not need backward computation.
I0925 23:03:34.851757 20584 net.cpp:219] lstm1 does not need backward computation.
I0925 23:03:34.851768 20584 net.cpp:219] embedding does not need backward computation.
I0925 23:03:34.851776 20584 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0925 23:03:34.851786 20584 net.cpp:219] reshape_frames does not need backward computation.
I0925 23:03:34.851796 20584 net.cpp:219] embed_encoder does not need backward computation.
I0925 23:03:34.851805 20584 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0925 23:03:34.851816 20584 net.cpp:219] input does not need backward computation.
I0925 23:03:34.851824 20584 net.cpp:261] This network produces output probs
I0925 23:03:34.851857 20584 net.cpp:274] Network initialization done.
I0925 23:03:34.852133 20590 net.cpp:141] Setting up probs
I0925 23:03:34.852149 20638 net.cpp:141] Setting up probs
I0925 23:03:34.852176 20590 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 23:03:34.852181 20638 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 23:03:34.852182 20590 net.cpp:156] Memory required for data: 405756
I0925 23:03:34.852200 20638 net.cpp:156] Memory required for data: 405756
I0925 23:03:34.852208 20638 net.cpp:219] probs does not need backward computation.
I0925 23:03:34.852208 20590 net.cpp:219] probs does not need backward computation.
I0925 23:03:34.852217 20638 net.cpp:219] predict does not need backward computation.
I0925 23:03:34.852217 20590 net.cpp:219] predict does not need backward computation.
I0925 23:03:34.852226 20638 net.cpp:219] lstm2 does not need backward computation.
I0925 23:03:34.852231 20590 net.cpp:219] lstm2 does not need backward computation.
I0925 23:03:34.852233 20638 net.cpp:219] concat does not need backward computation.
I0925 23:03:34.852237 20590 net.cpp:219] concat does not need backward computation.
I0925 23:03:34.852241 20638 net.cpp:219] lstm1 does not need backward computation.
I0925 23:03:34.852244 20590 net.cpp:219] lstm1 does not need backward computation.
I0925 23:03:34.852247 20638 net.cpp:219] embedding does not need backward computation.
I0925 23:03:34.852252 20590 net.cpp:219] embedding does not need backward computation.
I0925 23:03:34.852253 20638 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0925 23:03:34.852257 20590 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0925 23:03:34.852259 20638 net.cpp:219] reshape_frames does not need backward computation.
I0925 23:03:34.852263 20590 net.cpp:219] reshape_frames does not need backward computation.
I0925 23:03:34.852265 20638 net.cpp:219] embed_encoder does not need backward computation.
I0925 23:03:34.852268 20590 net.cpp:219] embed_encoder does not need backward computation.
I0925 23:03:34.852272 20638 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0925 23:03:34.852274 20590 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0925 23:03:34.852280 20590 net.cpp:219] input does not need backward computation.
I0925 23:03:34.852284 20590 net.cpp:261] This network produces output probs
I0925 23:03:34.852306 20590 net.cpp:274] Network initialization done.
I0925 23:03:34.852329 20638 net.cpp:219] input does not need backward computation.
I0925 23:03:34.852344 20638 net.cpp:261] This network produces output probs
I0925 23:03:34.852375 20638 net.cpp:274] Network initialization done.
I0925 23:03:34.852471 20634 net.cpp:141] Setting up probs
I0925 23:03:34.852491 20634 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 23:03:34.852497 20634 net.cpp:156] Memory required for data: 405756
I0925 23:03:34.852504 20634 net.cpp:219] probs does not need backward computation.
I0925 23:03:34.852510 20634 net.cpp:219] predict does not need backward computation.
I0925 23:03:34.852515 20634 net.cpp:219] lstm2 does not need backward computation.
I0925 23:03:34.852521 20634 net.cpp:219] concat does not need backward computation.
I0925 23:03:34.852527 20634 net.cpp:219] lstm1 does not need backward computation.
I0925 23:03:34.852535 20634 net.cpp:219] embedding does not need backward computation.
I0925 23:03:34.852540 20634 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0925 23:03:34.852545 20634 net.cpp:219] reshape_frames does not need backward computation.
I0925 23:03:34.852550 20634 net.cpp:219] embed_encoder does not need backward computation.
I0925 23:03:34.852555 20634 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0925 23:03:34.852560 20634 net.cpp:219] input does not need backward computation.
I0925 23:03:34.852565 20634 net.cpp:261] This network produces output probs
I0925 23:03:34.852571 20608 net.cpp:141] Setting up probs
I0925 23:03:34.852583 20634 net.cpp:274] Network initialization done.
I0925 23:03:34.852591 20608 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 23:03:34.852598 20608 net.cpp:156] Memory required for data: 405756
I0925 23:03:34.852607 20608 net.cpp:219] probs does not need backward computation.
I0925 23:03:34.852612 20608 net.cpp:219] predict does not need backward computation.
I0925 23:03:34.852619 20608 net.cpp:219] lstm2 does not need backward computation.
I0925 23:03:34.852627 20608 net.cpp:219] concat does not need backward computation.
I0925 23:03:34.852633 20608 net.cpp:219] lstm1 does not need backward computation.
I0925 23:03:34.852640 20608 net.cpp:219] embedding does not need backward computation.
I0925 23:03:34.852646 20608 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0925 23:03:34.852653 20608 net.cpp:219] reshape_frames does not need backward computation.
I0925 23:03:34.852659 20608 net.cpp:219] embed_encoder does not need backward computation.
I0925 23:03:34.852664 20608 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0925 23:03:34.852671 20608 net.cpp:219] input does not need backward computation.
I0925 23:03:34.852675 20608 net.cpp:261] This network produces output probs
I0925 23:03:34.852731 20608 net.cpp:274] Network initialization done.
I0925 23:03:34.866770 20610 net.cpp:141] Setting up conv2
I0925 23:03:34.866835 20610 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0925 23:03:34.866847 20610 net.cpp:156] Memory required for data: 42479160
I0925 23:03:34.866878 20610 layer_factory.hpp:77] Creating layer relu2
I0925 23:03:34.866904 20610 net.cpp:91] Creating Layer relu2
I0925 23:03:34.866922 20610 net.cpp:425] relu2 <- conv2
I0925 23:03:34.867543 20610 net.cpp:386] relu2 -> conv2 (in-place)
I0925 23:03:34.869020 20610 net.cpp:141] Setting up relu2
I0925 23:03:34.869079 20610 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0925 23:03:34.869093 20610 net.cpp:156] Memory required for data: 49944120
I0925 23:03:34.869108 20610 layer_factory.hpp:77] Creating layer pool2
I0925 23:03:34.869213 20610 net.cpp:91] Creating Layer pool2
I0925 23:03:34.869247 20610 net.cpp:425] pool2 <- conv2
I0925 23:03:34.869261 20610 net.cpp:399] pool2 -> pool2
I0925 23:03:34.869534 20610 net.cpp:141] Setting up pool2
I0925 23:03:34.869551 20610 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0925 23:03:34.869556 20610 net.cpp:156] Memory required for data: 51674680
I0925 23:03:34.869570 20610 layer_factory.hpp:77] Creating layer norm2
I0925 23:03:34.870141 20610 net.cpp:91] Creating Layer norm2
I0925 23:03:34.870154 20610 net.cpp:425] norm2 <- pool2
I0925 23:03:34.870164 20610 net.cpp:399] norm2 -> norm2
I0925 23:03:34.871902 20610 net.cpp:141] Setting up norm2
I0925 23:03:34.871948 20610 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0925 23:03:34.871953 20610 net.cpp:156] Memory required for data: 53405240
I0925 23:03:34.871961 20610 layer_factory.hpp:77] Creating layer conv3
I0925 23:03:34.872522 20610 net.cpp:91] Creating Layer conv3
I0925 23:03:34.872534 20610 net.cpp:425] conv3 <- norm2
I0925 23:03:34.872550 20610 net.cpp:399] conv3 -> conv3
I0925 23:03:34.885738 20610 net.cpp:141] Setting up conv3
I0925 23:03:34.885792 20610 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0925 23:03:34.885798 20610 net.cpp:156] Memory required for data: 56001080
I0925 23:03:34.885825 20610 layer_factory.hpp:77] Creating layer relu3
I0925 23:03:34.885851 20610 net.cpp:91] Creating Layer relu3
I0925 23:03:34.885859 20610 net.cpp:425] relu3 <- conv3
I0925 23:03:34.885869 20610 net.cpp:386] relu3 -> conv3 (in-place)
I0925 23:03:34.886981 20610 net.cpp:141] Setting up relu3
I0925 23:03:34.887011 20610 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0925 23:03:34.887017 20610 net.cpp:156] Memory required for data: 58596920
I0925 23:03:34.887023 20610 layer_factory.hpp:77] Creating layer conv4
I0925 23:03:34.887048 20610 net.cpp:91] Creating Layer conv4
I0925 23:03:34.887054 20610 net.cpp:425] conv4 <- conv3
I0925 23:03:34.887065 20610 net.cpp:399] conv4 -> conv4
I0925 23:03:34.918109 20610 net.cpp:141] Setting up conv4
I0925 23:03:34.918165 20610 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0925 23:03:34.918174 20610 net.cpp:156] Memory required for data: 61192760
I0925 23:03:34.918190 20610 layer_factory.hpp:77] Creating layer relu4
I0925 23:03:34.918217 20610 net.cpp:91] Creating Layer relu4
I0925 23:03:34.918226 20610 net.cpp:425] relu4 <- conv4
I0925 23:03:34.918236 20610 net.cpp:386] relu4 -> conv4 (in-place)
I0925 23:03:34.919172 20610 net.cpp:141] Setting up relu4
I0925 23:03:34.919229 20610 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0925 23:03:34.919237 20610 net.cpp:156] Memory required for data: 63788600
I0925 23:03:34.919296 20610 layer_factory.hpp:77] Creating layer conv5
I0925 23:03:34.919335 20610 net.cpp:91] Creating Layer conv5
I0925 23:03:34.919343 20610 net.cpp:425] conv5 <- conv4
I0925 23:03:34.919394 20610 net.cpp:399] conv5 -> conv5
I0925 23:03:34.933380 20610 net.cpp:141] Setting up conv5
I0925 23:03:34.933456 20610 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0925 23:03:34.933466 20610 net.cpp:156] Memory required for data: 65519160
I0925 23:03:34.933504 20610 layer_factory.hpp:77] Creating layer relu5
I0925 23:03:34.933622 20610 net.cpp:91] Creating Layer relu5
I0925 23:03:34.933663 20610 net.cpp:425] relu5 <- conv5
I0925 23:03:34.933694 20610 net.cpp:386] relu5 -> conv5 (in-place)
I0925 23:03:34.934255 20610 net.cpp:141] Setting up relu5
I0925 23:03:34.934286 20610 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0925 23:03:34.934293 20610 net.cpp:156] Memory required for data: 67249720
I0925 23:03:34.934301 20610 layer_factory.hpp:77] Creating layer pool5
I0925 23:03:34.934319 20610 net.cpp:91] Creating Layer pool5
I0925 23:03:34.934324 20610 net.cpp:425] pool5 <- conv5
I0925 23:03:34.934334 20610 net.cpp:399] pool5 -> pool5
I0925 23:03:34.934478 20610 net.cpp:141] Setting up pool5
I0925 23:03:34.934490 20610 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0925 23:03:34.934495 20610 net.cpp:156] Memory required for data: 67618360
I0925 23:03:34.934500 20610 layer_factory.hpp:77] Creating layer fc6
I0925 23:03:34.934525 20610 net.cpp:91] Creating Layer fc6
I0925 23:03:34.934531 20610 net.cpp:425] fc6 <- pool5
I0925 23:03:34.934540 20610 net.cpp:399] fc6 -> fc6
I0925 23:03:35.026180 20602 net.cpp:141] Setting up predict
I0925 23:03:35.026242 20602 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 23:03:35.026253 20602 net.cpp:156] Memory required for data: 221084
I0925 23:03:35.026271 20602 layer_factory.hpp:77] Creating layer probs
I0925 23:03:35.026294 20602 net.cpp:91] Creating Layer probs
I0925 23:03:35.026304 20602 net.cpp:425] probs <- predict
I0925 23:03:35.026314 20602 net.cpp:399] probs -> probs
I0925 23:03:35.027421 20602 net.cpp:141] Setting up probs
I0925 23:03:35.027449 20602 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 23:03:35.027458 20602 net.cpp:156] Memory required for data: 405756
I0925 23:03:35.027468 20602 net.cpp:219] probs does not need backward computation.
I0925 23:03:35.027478 20602 net.cpp:219] predict does not need backward computation.
I0925 23:03:35.027487 20602 net.cpp:219] lstm2 does not need backward computation.
I0925 23:03:35.027498 20602 net.cpp:219] concat does not need backward computation.
I0925 23:03:35.027508 20602 net.cpp:219] lstm1 does not need backward computation.
I0925 23:03:35.027519 20602 net.cpp:219] embedding does not need backward computation.
I0925 23:03:35.027529 20602 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0925 23:03:35.027537 20602 net.cpp:219] reshape_frames does not need backward computation.
I0925 23:03:35.027546 20602 net.cpp:219] embed_encoder does not need backward computation.
I0925 23:03:35.027555 20602 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0925 23:03:35.027566 20602 net.cpp:219] input does not need backward computation.
I0925 23:03:35.027576 20602 net.cpp:261] This network produces output probs
I0925 23:03:35.027612 20602 net.cpp:274] Network initialization done.
I0925 23:03:35.071029 20610 net.cpp:141] Setting up fc6
I0925 23:03:35.071092 20610 net.cpp:148] Top shape: 10 4096 (40960)
I0925 23:03:35.071101 20610 net.cpp:156] Memory required for data: 67782200
I0925 23:03:35.071122 20610 layer_factory.hpp:77] Creating layer relu6
I0925 23:03:35.071144 20610 net.cpp:91] Creating Layer relu6
I0925 23:03:35.071151 20610 net.cpp:425] relu6 <- fc6
I0925 23:03:35.071693 20610 net.cpp:386] relu6 -> fc6 (in-place)
I0925 23:03:35.072933 20610 net.cpp:141] Setting up relu6
I0925 23:03:35.072962 20610 net.cpp:148] Top shape: 10 4096 (40960)
I0925 23:03:35.072968 20610 net.cpp:156] Memory required for data: 67946040
I0925 23:03:35.072976 20610 layer_factory.hpp:77] Creating layer drop6
I0925 23:03:35.073007 20610 net.cpp:91] Creating Layer drop6
I0925 23:03:35.073014 20610 net.cpp:425] drop6 <- fc6
I0925 23:03:35.073026 20610 net.cpp:386] drop6 -> fc6 (in-place)
I0925 23:03:35.073137 20610 net.cpp:141] Setting up drop6
I0925 23:03:35.073153 20610 net.cpp:148] Top shape: 10 4096 (40960)
I0925 23:03:35.073158 20610 net.cpp:156] Memory required for data: 68109880
I0925 23:03:35.073163 20610 layer_factory.hpp:77] Creating layer fc7
I0925 23:03:35.073175 20610 net.cpp:91] Creating Layer fc7
I0925 23:03:35.073180 20610 net.cpp:425] fc7 <- fc6
I0925 23:03:35.073189 20610 net.cpp:399] fc7 -> fc7
I0925 23:03:35.106608 20626 net.cpp:141] Setting up predict
I0925 23:03:35.106663 20626 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 23:03:35.106670 20626 net.cpp:156] Memory required for data: 221084
I0925 23:03:35.106688 20626 layer_factory.hpp:77] Creating layer probs
I0925 23:03:35.106708 20626 net.cpp:91] Creating Layer probs
I0925 23:03:35.106715 20626 net.cpp:425] probs <- predict
I0925 23:03:35.106725 20626 net.cpp:399] probs -> probs
I0925 23:03:35.107255 20626 net.cpp:141] Setting up probs
I0925 23:03:35.107272 20626 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 23:03:35.107277 20626 net.cpp:156] Memory required for data: 405756
I0925 23:03:35.107283 20626 net.cpp:219] probs does not need backward computation.
I0925 23:03:35.107290 20626 net.cpp:219] predict does not need backward computation.
I0925 23:03:35.107295 20626 net.cpp:219] lstm2 does not need backward computation.
I0925 23:03:35.107301 20626 net.cpp:219] concat does not need backward computation.
I0925 23:03:35.107307 20626 net.cpp:219] lstm1 does not need backward computation.
I0925 23:03:35.107313 20626 net.cpp:219] embedding does not need backward computation.
I0925 23:03:35.107318 20626 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0925 23:03:35.107323 20626 net.cpp:219] reshape_frames does not need backward computation.
I0925 23:03:35.107329 20626 net.cpp:219] embed_encoder does not need backward computation.
I0925 23:03:35.107336 20626 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0925 23:03:35.107341 20626 net.cpp:219] input does not need backward computation.
I0925 23:03:35.107344 20626 net.cpp:261] This network produces output probs
I0925 23:03:35.107362 20626 net.cpp:274] Network initialization done.
I0925 23:03:35.125082 20610 net.cpp:141] Setting up fc7
I0925 23:03:35.125143 20610 net.cpp:148] Top shape: 10 4096 (40960)
I0925 23:03:35.125152 20610 net.cpp:156] Memory required for data: 68273720
I0925 23:03:35.125176 20610 layer_factory.hpp:77] Creating layer relu7
I0925 23:03:35.130386 20610 net.cpp:91] Creating Layer relu7
I0925 23:03:35.130439 20610 net.cpp:425] relu7 <- fc7
I0925 23:03:35.130461 20610 net.cpp:386] relu7 -> fc7 (in-place)
I0925 23:03:35.142554 20610 net.cpp:141] Setting up relu7
I0925 23:03:35.142622 20610 net.cpp:148] Top shape: 10 4096 (40960)
I0925 23:03:35.142633 20610 net.cpp:156] Memory required for data: 68437560
I0925 23:03:35.142647 20610 layer_factory.hpp:77] Creating layer drop7
I0925 23:03:35.143227 20610 net.cpp:91] Creating Layer drop7
I0925 23:03:35.143244 20610 net.cpp:425] drop7 <- fc7
I0925 23:03:35.143265 20610 net.cpp:386] drop7 -> fc7 (in-place)
I0925 23:03:35.143414 20610 net.cpp:141] Setting up drop7
I0925 23:03:35.143429 20610 net.cpp:148] Top shape: 10 4096 (40960)
I0925 23:03:35.143435 20610 net.cpp:156] Memory required for data: 68601400
I0925 23:03:35.143443 20610 layer_factory.hpp:77] Creating layer fc8
I0925 23:03:35.143458 20610 net.cpp:91] Creating Layer fc8
I0925 23:03:35.143466 20610 net.cpp:425] fc8 <- fc7
I0925 23:03:35.143836 20610 net.cpp:399] fc8 -> fc8
I0925 23:03:35.161839 20610 net.cpp:141] Setting up fc8
I0925 23:03:35.161903 20610 net.cpp:148] Top shape: 10 1000 (10000)
I0925 23:03:35.161916 20610 net.cpp:156] Memory required for data: 68641400
I0925 23:03:35.161943 20610 layer_factory.hpp:77] Creating layer prob
I0925 23:03:35.161978 20610 net.cpp:91] Creating Layer prob
I0925 23:03:35.161993 20610 net.cpp:425] prob <- fc8
I0925 23:03:35.162012 20610 net.cpp:399] prob -> prob
I0925 23:03:35.169409 20610 net.cpp:141] Setting up prob
I0925 23:03:35.169472 20610 net.cpp:148] Top shape: 10 1000 (10000)
I0925 23:03:35.169486 20610 net.cpp:156] Memory required for data: 68681400
I0925 23:03:35.169502 20610 net.cpp:219] prob does not need backward computation.
I0925 23:03:35.169515 20610 net.cpp:219] fc8 does not need backward computation.
I0925 23:03:35.169526 20610 net.cpp:219] drop7 does not need backward computation.
I0925 23:03:35.169538 20610 net.cpp:219] relu7 does not need backward computation.
I0925 23:03:35.169548 20610 net.cpp:219] fc7 does not need backward computation.
I0925 23:03:35.169559 20610 net.cpp:219] drop6 does not need backward computation.
I0925 23:03:35.169569 20610 net.cpp:219] relu6 does not need backward computation.
I0925 23:03:35.169579 20610 net.cpp:219] fc6 does not need backward computation.
I0925 23:03:35.169589 20610 net.cpp:219] pool5 does not need backward computation.
I0925 23:03:35.169600 20610 net.cpp:219] relu5 does not need backward computation.
I0925 23:03:35.169610 20610 net.cpp:219] conv5 does not need backward computation.
I0925 23:03:35.169621 20610 net.cpp:219] relu4 does not need backward computation.
I0925 23:03:35.169631 20610 net.cpp:219] conv4 does not need backward computation.
I0925 23:03:35.169642 20610 net.cpp:219] relu3 does not need backward computation.
I0925 23:03:35.169652 20610 net.cpp:219] conv3 does not need backward computation.
I0925 23:03:35.169663 20610 net.cpp:219] norm2 does not need backward computation.
I0925 23:03:35.169674 20610 net.cpp:219] pool2 does not need backward computation.
I0925 23:03:35.169685 20610 net.cpp:219] relu2 does not need backward computation.
I0925 23:03:35.169695 20610 net.cpp:219] conv2 does not need backward computation.
I0925 23:03:35.169706 20610 net.cpp:219] norm1 does not need backward computation.
I0925 23:03:35.169718 20610 net.cpp:219] pool1 does not need backward computation.
I0925 23:03:35.169728 20610 net.cpp:219] relu1 does not need backward computation.
I0925 23:03:35.169739 20610 net.cpp:219] conv1 does not need backward computation.
I0925 23:03:35.169749 20610 net.cpp:219] data does not need backward computation.
I0925 23:03:35.169756 20610 net.cpp:261] This network produces output prob
I0925 23:03:35.170287 20610 net.cpp:274] Network initialization done.
I0925 23:03:35.369619 20584 net.cpp:752] Ignoring source layer data
I0925 23:03:35.369673 20584 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0925 23:03:35.369683 20584 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0925 23:03:35.378252 20590 net.cpp:752] Ignoring source layer data
I0925 23:03:35.378805 20590 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0925 23:03:35.379042 20590 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0925 23:03:35.417933 20608 net.cpp:752] Ignoring source layer data
I0925 23:03:35.417989 20608 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0925 23:03:35.417994 20608 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0925 23:03:35.442296 20634 net.cpp:752] Ignoring source layer data
I0925 23:03:35.442374 20634 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0925 23:03:35.442383 20634 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0925 23:03:35.442477 20588 net.cpp:752] Ignoring source layer data
I0925 23:03:35.442492 20588 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0925 23:03:35.442497 20588 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0925 23:03:35.461797 20594 net.cpp:752] Ignoring source layer data
I0925 23:03:35.462409 20594 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0925 23:03:35.462656 20594 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0925 23:03:35.479488 20584 net.cpp:752] Ignoring source layer cross_entropy_loss
I0925 23:03:35.518774 20638 net.cpp:752] Ignoring source layer data
I0925 23:03:35.518841 20638 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0925 23:03:35.518851 20638 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0925 23:03:35.545840 20590 net.cpp:752] Ignoring source layer cross_entropy_loss
I0925 23:03:35.551232 20608 net.cpp:752] Ignoring source layer cross_entropy_loss
I0925 23:03:35.568800 20634 net.cpp:752] Ignoring source layer cross_entropy_loss
I0925 23:03:35.569802 20588 net.cpp:752] Ignoring source layer cross_entropy_loss
I0925 23:03:35.612340 20602 net.cpp:752] Ignoring source layer data
I0925 23:03:35.612987 20602 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0925 23:03:35.613168 20602 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0925 23:03:35.615914 20610 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /home/peifeng/work/run/storm102/data/workers/3507868b-8089-46cf-b9c3-07ccbf177d02/tmp/cvld1195509740947419724/bvlc_reference_caffenet.caffemodel
I0925 23:03:35.615983 20610 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0925 23:03:35.615994 20610 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0925 23:03:35.616003 20610 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /home/peifeng/work/run/storm102/data/workers/3507868b-8089-46cf-b9c3-07ccbf177d02/tmp/cvld1195509740947419724/bvlc_reference_caffenet.caffemodel
I0925 23:03:35.619421 20594 net.cpp:752] Ignoring source layer cross_entropy_loss
I0925 23:03:35.657583 20638 net.cpp:752] Ignoring source layer cross_entropy_loss
I0925 23:03:35.693768 20626 net.cpp:752] Ignoring source layer data
I0925 23:03:35.693809 20626 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0925 23:03:35.693819 20626 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0925 23:03:35.707300 20602 net.cpp:752] Ignoring source layer cross_entropy_loss
I0925 23:03:35.771996 20626 net.cpp:752] Ignoring source layer cross_entropy_loss
I0925 23:03:36.036571 20610 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0925 23:03:36.087512 20610 net.cpp:752] Ignoring source layer loss
Loading the model + trained: 42691.9ms
Using cv::Size and some other stuff: 0.059ms
Loading the mean file: 384061ms
TIMERTIMER 248965214
TIMERTIMER 209945274
TIMERTIMER 250694872
TIMERTIMER 191568671
TIMERTIMER 237863739
TIMERTIMER 227250970
TIMERTIMER 244026748
TIMERTIMER 230424282
TIMERTIMER 251279897
TIMERTIMER 250168560
TIMERTIMER 246861805
TIMERTIMER 237974697
TIMERTIMER 249873746
TIMERTIMER 256722111
TIMERTIMER 248372783
TIMERTIMER 239282825
TIMERTIMER 262583943
TIMERTIMER 257133867
TIMERTIMER 250077707
TIMERTIMER 259347276
TIMERTIMER 244767841
TIMERTIMER 262306938
TIMERTIMER 248886645
TIMERTIMER 232202884
TIMERTIMER 251629218
TIMERTIMER 255022715
TIMERTIMER 235440757
TIMERTIMER 238794578
TIMERTIMER 227125821
TIMERTIMER 258038416
TIMERTIMER 228011783
TIMERTIMER 239607284
