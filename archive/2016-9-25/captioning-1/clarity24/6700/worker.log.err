SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/peifeng/tools/storm102/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/peifeng/work/run/storm102/data/supervisor/stormdist/captioning-1-1474849855/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /home/peifeng/work/run/storm102/data/workers/23d95a34-2869-403b-8500-59c076333e77/tmp/cvld2415285016873473660/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0925 20:32:21.744763 29622 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /home/peifeng/work/run/storm102/data/workers/23d95a34-2869-403b-8500-59c076333e77/tmp/cvld2415285016873473660/s2vt.words_to_preds.prototxt
I0925 20:32:21.744799 29628 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0925 20:32:21.744963 29622 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0925 20:32:21.744981 29622 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0925 20:32:21.745038 29628 layer_factory.hpp:77] Creating layer data
I0925 20:32:21.745077 29628 net.cpp:91] Creating Layer data
I0925 20:32:21.745088 29628 net.cpp:399] data -> data
I0925 20:32:21.745517 29622 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0925 20:32:21.745769 29622 layer_factory.hpp:77] Creating layer input
I0925 20:32:21.745797 29622 net.cpp:91] Creating Layer input
I0925 20:32:21.745811 29622 net.cpp:399] input -> frames_fc7
I0925 20:32:21.745841 29622 net.cpp:399] input -> cont_sentence
I0925 20:32:21.745865 29622 net.cpp:399] input -> input_sentence
I0925 20:32:21.745883 29622 net.cpp:399] input -> stage_indicator
I0925 20:32:22.337227 29628 net.cpp:141] Setting up data
I0925 20:32:22.337389 29628 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0925 20:32:22.337399 29628 net.cpp:156] Memory required for data: 6183480
I0925 20:32:22.337426 29628 layer_factory.hpp:77] Creating layer conv1
I0925 20:32:22.337465 29628 net.cpp:91] Creating Layer conv1
I0925 20:32:22.337474 29628 net.cpp:425] conv1 <- data
I0925 20:32:22.337494 29628 net.cpp:399] conv1 -> conv1
I0925 20:32:22.337502 29622 net.cpp:141] Setting up input
I0925 20:32:22.337558 29622 net.cpp:148] Top shape: 1 4096 (4096)
I0925 20:32:22.337570 29622 net.cpp:148] Top shape: 1 1 (1)
I0925 20:32:22.337580 29622 net.cpp:148] Top shape: 1 1 (1)
I0925 20:32:22.337589 29622 net.cpp:148] Top shape: 1 1 (1)
I0925 20:32:22.337596 29622 net.cpp:156] Memory required for data: 16396
I0925 20:32:22.337612 29622 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0925 20:32:22.337656 29622 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0925 20:32:22.337668 29622 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0925 20:32:22.337715 29622 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0925 20:32:22.337756 29622 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0925 20:32:22.338590 29622 net.cpp:141] Setting up cont_sentence_input_1_split
I0925 20:32:22.338660 29622 net.cpp:148] Top shape: 1 1 (1)
I0925 20:32:22.338672 29622 net.cpp:148] Top shape: 1 1 (1)
I0925 20:32:22.338681 29622 net.cpp:156] Memory required for data: 16404
I0925 20:32:22.338695 29622 layer_factory.hpp:77] Creating layer embed_encoder
I0925 20:32:22.338738 29622 net.cpp:91] Creating Layer embed_encoder
I0925 20:32:22.338750 29622 net.cpp:425] embed_encoder <- frames_fc7
I0925 20:32:22.338780 29622 net.cpp:399] embed_encoder -> embedded_in_frames
I0925 20:32:22.376979 29622 net.cpp:141] Setting up embed_encoder
I0925 20:32:22.377044 29622 net.cpp:148] Top shape: 1 500 (500)
I0925 20:32:22.377054 29622 net.cpp:156] Memory required for data: 18404
I0925 20:32:22.377094 29622 layer_factory.hpp:77] Creating layer reshape_frames
I0925 20:32:22.377148 29622 net.cpp:91] Creating Layer reshape_frames
I0925 20:32:22.377161 29622 net.cpp:425] reshape_frames <- embedded_in_frames
I0925 20:32:22.377177 29622 net.cpp:399] reshape_frames -> embedded_input_frames
I0925 20:32:22.387528 29622 net.cpp:141] Setting up reshape_frames
I0925 20:32:22.387560 29622 net.cpp:148] Top shape: 1 1 500 (500)
I0925 20:32:22.387568 29622 net.cpp:156] Memory required for data: 20404
I0925 20:32:22.387575 29622 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0925 20:32:22.387598 29622 net.cpp:91] Creating Layer reshape_stage_indicator
I0925 20:32:22.387606 29622 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0925 20:32:22.387626 29622 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0925 20:32:22.393467 29622 net.cpp:141] Setting up reshape_stage_indicator
I0925 20:32:22.393499 29622 net.cpp:148] Top shape: 1 1 1 (1)
I0925 20:32:22.393507 29622 net.cpp:156] Memory required for data: 20408
I0925 20:32:22.393515 29622 layer_factory.hpp:77] Creating layer embedding
I0925 20:32:22.393535 29622 net.cpp:91] Creating Layer embedding
I0925 20:32:22.393543 29622 net.cpp:425] embedding <- input_sentence
I0925 20:32:22.393564 29622 net.cpp:399] embedding -> embedded_input_sentence
I0925 20:32:22.608399 29628 net.cpp:141] Setting up conv1
I0925 20:32:22.608453 29628 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0925 20:32:22.608460 29628 net.cpp:156] Memory required for data: 17799480
I0925 20:32:22.608482 29628 layer_factory.hpp:77] Creating layer relu1
I0925 20:32:22.608501 29628 net.cpp:91] Creating Layer relu1
I0925 20:32:22.608508 29628 net.cpp:425] relu1 <- conv1
I0925 20:32:22.608517 29628 net.cpp:386] relu1 -> conv1 (in-place)
I0925 20:32:22.608929 29628 net.cpp:141] Setting up relu1
I0925 20:32:22.608945 29628 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0925 20:32:22.608950 29628 net.cpp:156] Memory required for data: 29415480
I0925 20:32:22.608957 29628 layer_factory.hpp:77] Creating layer pool1
I0925 20:32:22.608969 29628 net.cpp:91] Creating Layer pool1
I0925 20:32:22.608975 29628 net.cpp:425] pool1 <- conv1
I0925 20:32:22.608983 29628 net.cpp:399] pool1 -> pool1
I0925 20:32:22.609072 29628 net.cpp:141] Setting up pool1
I0925 20:32:22.609086 29628 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0925 20:32:22.609091 29628 net.cpp:156] Memory required for data: 32214840
I0925 20:32:22.609096 29628 layer_factory.hpp:77] Creating layer norm1
I0925 20:32:22.609112 29628 net.cpp:91] Creating Layer norm1
I0925 20:32:22.609118 29628 net.cpp:425] norm1 <- pool1
I0925 20:32:22.609125 29628 net.cpp:399] norm1 -> norm1
I0925 20:32:22.609400 29628 net.cpp:141] Setting up norm1
I0925 20:32:22.609413 29628 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0925 20:32:22.609418 29628 net.cpp:156] Memory required for data: 35014200
I0925 20:32:22.609424 29628 layer_factory.hpp:77] Creating layer conv2
I0925 20:32:22.609438 29628 net.cpp:91] Creating Layer conv2
I0925 20:32:22.609444 29628 net.cpp:425] conv2 <- norm1
I0925 20:32:22.609452 29628 net.cpp:399] conv2 -> conv2
I0925 20:32:22.613346 29628 net.cpp:141] Setting up conv2
I0925 20:32:22.613397 29628 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0925 20:32:22.613404 29628 net.cpp:156] Memory required for data: 42479160
I0925 20:32:22.613425 29628 layer_factory.hpp:77] Creating layer relu2
I0925 20:32:22.613443 29628 net.cpp:91] Creating Layer relu2
I0925 20:32:22.613451 29628 net.cpp:425] relu2 <- conv2
I0925 20:32:22.613464 29628 net.cpp:386] relu2 -> conv2 (in-place)
I0925 20:32:22.613917 29628 net.cpp:141] Setting up relu2
I0925 20:32:22.613931 29628 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0925 20:32:22.613936 29628 net.cpp:156] Memory required for data: 49944120
I0925 20:32:22.613942 29628 layer_factory.hpp:77] Creating layer pool2
I0925 20:32:22.613957 29628 net.cpp:91] Creating Layer pool2
I0925 20:32:22.613962 29628 net.cpp:425] pool2 <- conv2
I0925 20:32:22.613970 29628 net.cpp:399] pool2 -> pool2
I0925 20:32:22.614038 29628 net.cpp:141] Setting up pool2
I0925 20:32:22.614049 29628 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0925 20:32:22.614053 29628 net.cpp:156] Memory required for data: 51674680
I0925 20:32:22.614063 29628 layer_factory.hpp:77] Creating layer norm2
I0925 20:32:22.614079 29628 net.cpp:91] Creating Layer norm2
I0925 20:32:22.614085 29628 net.cpp:425] norm2 <- pool2
I0925 20:32:22.614095 29628 net.cpp:399] norm2 -> norm2
I0925 20:32:22.614385 29628 net.cpp:141] Setting up norm2
I0925 20:32:22.614401 29628 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0925 20:32:22.614408 29628 net.cpp:156] Memory required for data: 53405240
I0925 20:32:22.614413 29628 layer_factory.hpp:77] Creating layer conv3
I0925 20:32:22.614426 29628 net.cpp:91] Creating Layer conv3
I0925 20:32:22.614433 29628 net.cpp:425] conv3 <- norm2
I0925 20:32:22.614444 29628 net.cpp:399] conv3 -> conv3
I0925 20:32:22.618453 29628 net.cpp:141] Setting up conv3
I0925 20:32:22.618474 29628 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0925 20:32:22.618480 29628 net.cpp:156] Memory required for data: 56001080
I0925 20:32:22.618494 29628 layer_factory.hpp:77] Creating layer relu3
I0925 20:32:22.618504 29628 net.cpp:91] Creating Layer relu3
I0925 20:32:22.618508 29628 net.cpp:425] relu3 <- conv3
I0925 20:32:22.618520 29628 net.cpp:386] relu3 -> conv3 (in-place)
I0925 20:32:22.618780 29628 net.cpp:141] Setting up relu3
I0925 20:32:22.618794 29628 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0925 20:32:22.618799 29628 net.cpp:156] Memory required for data: 58596920
I0925 20:32:22.618804 29628 layer_factory.hpp:77] Creating layer conv4
I0925 20:32:22.618819 29628 net.cpp:91] Creating Layer conv4
I0925 20:32:22.618824 29628 net.cpp:425] conv4 <- conv3
I0925 20:32:22.618836 29628 net.cpp:399] conv4 -> conv4
I0925 20:32:22.623272 29628 net.cpp:141] Setting up conv4
I0925 20:32:22.623298 29628 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0925 20:32:22.623303 29628 net.cpp:156] Memory required for data: 61192760
I0925 20:32:22.623374 29628 layer_factory.hpp:77] Creating layer relu4
I0925 20:32:22.623415 29628 net.cpp:91] Creating Layer relu4
I0925 20:32:22.623425 29628 net.cpp:425] relu4 <- conv4
I0925 20:32:22.623433 29628 net.cpp:386] relu4 -> conv4 (in-place)
I0925 20:32:22.623956 29628 net.cpp:141] Setting up relu4
I0925 20:32:22.623971 29628 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0925 20:32:22.623977 29628 net.cpp:156] Memory required for data: 63788600
I0925 20:32:22.623983 29628 layer_factory.hpp:77] Creating layer conv5
I0925 20:32:22.623997 29628 net.cpp:91] Creating Layer conv5
I0925 20:32:22.624004 29628 net.cpp:425] conv5 <- conv4
I0925 20:32:22.624014 29628 net.cpp:399] conv5 -> conv5
I0925 20:32:22.628885 29628 net.cpp:141] Setting up conv5
I0925 20:32:22.628926 29628 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0925 20:32:22.628933 29628 net.cpp:156] Memory required for data: 65519160
I0925 20:32:22.628958 29628 layer_factory.hpp:77] Creating layer relu5
I0925 20:32:22.628976 29628 net.cpp:91] Creating Layer relu5
I0925 20:32:22.628983 29628 net.cpp:425] relu5 <- conv5
I0925 20:32:22.628994 29628 net.cpp:386] relu5 -> conv5 (in-place)
I0925 20:32:22.629429 29628 net.cpp:141] Setting up relu5
I0925 20:32:22.629444 29628 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0925 20:32:22.629449 29628 net.cpp:156] Memory required for data: 67249720
I0925 20:32:22.629456 29628 layer_factory.hpp:77] Creating layer pool5
I0925 20:32:22.629467 29628 net.cpp:91] Creating Layer pool5
I0925 20:32:22.629472 29628 net.cpp:425] pool5 <- conv5
I0925 20:32:22.629482 29628 net.cpp:399] pool5 -> pool5
I0925 20:32:22.629552 29628 net.cpp:141] Setting up pool5
I0925 20:32:22.629566 29628 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0925 20:32:22.629570 29628 net.cpp:156] Memory required for data: 67618360
I0925 20:32:22.629575 29628 layer_factory.hpp:77] Creating layer fc6
I0925 20:32:22.629588 29628 net.cpp:91] Creating Layer fc6
I0925 20:32:22.629593 29628 net.cpp:425] fc6 <- pool5
I0925 20:32:22.629601 29628 net.cpp:399] fc6 -> fc6
I0925 20:32:22.701855 29622 net.cpp:141] Setting up embedding
I0925 20:32:22.701899 29622 net.cpp:148] Top shape: 1 1 500 (500)
I0925 20:32:22.701905 29622 net.cpp:156] Memory required for data: 22408
I0925 20:32:22.701925 29622 layer_factory.hpp:77] Creating layer lstm1
I0925 20:32:22.701961 29622 net.cpp:91] Creating Layer lstm1
I0925 20:32:22.701969 29622 net.cpp:425] lstm1 <- embedded_input_frames
I0925 20:32:22.701978 29622 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0925 20:32:22.701990 29622 net.cpp:399] lstm1 -> lstm1
I0925 20:32:22.702021 29622 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 20:32:22.702899 29622 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 20:32:22.703083 29622 layer_factory.hpp:77] Creating layer lstm1_
I0925 20:32:22.703106 29622 net.cpp:91] Creating Layer lstm1_
I0925 20:32:22.703119 29622 net.cpp:399] lstm1_ -> x
I0925 20:32:22.703140 29622 net.cpp:399] lstm1_ -> cont
I0925 20:32:22.703263 29622 net.cpp:141] Setting up lstm1_
I0925 20:32:22.703281 29622 net.cpp:148] Top shape: 1 1 500 (500)
I0925 20:32:22.703292 29622 net.cpp:148] Top shape: 1 1 (1)
I0925 20:32:22.703299 29622 net.cpp:156] Memory required for data: 2004
I0925 20:32:22.703310 29622 layer_factory.hpp:77] Creating layer lstm1_
I0925 20:32:22.703325 29622 net.cpp:91] Creating Layer lstm1_
I0925 20:32:22.703341 29622 net.cpp:399] lstm1_ -> c_0
I0925 20:32:22.703361 29622 net.cpp:399] lstm1_ -> h_0
I0925 20:32:22.703459 29622 net.cpp:141] Setting up lstm1_
I0925 20:32:22.703476 29622 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:32:22.703486 29622 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:32:22.703493 29622 net.cpp:156] Memory required for data: 10004
I0925 20:32:22.703501 29622 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0925 20:32:22.703517 29622 net.cpp:91] Creating Layer lstm1_cont_slice
I0925 20:32:22.703526 29622 net.cpp:425] lstm1_cont_slice <- cont
I0925 20:32:22.703544 29622 net.cpp:399] lstm1_cont_slice -> cont_1
I0925 20:32:22.703609 29622 net.cpp:141] Setting up lstm1_cont_slice
I0925 20:32:22.703625 29622 net.cpp:148] Top shape: 1 1 (1)
I0925 20:32:22.703634 29622 net.cpp:156] Memory required for data: 10008
I0925 20:32:22.703641 29622 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0925 20:32:22.703660 29622 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0925 20:32:22.703670 29622 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0925 20:32:22.703683 29622 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0925 20:32:22.703698 29622 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0925 20:32:22.703789 29622 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0925 20:32:22.703805 29622 net.cpp:148] Top shape: 1 1 (1)
I0925 20:32:22.703816 29622 net.cpp:148] Top shape: 1 1 (1)
I0925 20:32:22.703824 29622 net.cpp:156] Memory required for data: 10016
I0925 20:32:22.703831 29622 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0925 20:32:22.703850 29622 net.cpp:91] Creating Layer lstm1_x_transform
I0925 20:32:22.703857 29622 net.cpp:425] lstm1_x_transform <- x
I0925 20:32:22.703871 29622 net.cpp:399] lstm1_x_transform -> W_xc_x
I0925 20:32:22.727880 29622 net.cpp:141] Setting up lstm1_x_transform
I0925 20:32:22.727928 29622 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 20:32:22.727934 29622 net.cpp:156] Memory required for data: 26016
I0925 20:32:22.727959 29622 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0925 20:32:22.727978 29622 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0925 20:32:22.727985 29622 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0925 20:32:22.727995 29622 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0925 20:32:22.728044 29622 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0925 20:32:22.728054 29622 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 20:32:22.728058 29622 net.cpp:156] Memory required for data: 42016
I0925 20:32:22.728063 29622 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0925 20:32:22.728077 29622 net.cpp:91] Creating Layer lstm1_h_conted_0
I0925 20:32:22.728083 29622 net.cpp:425] lstm1_h_conted_0 <- h_0
I0925 20:32:22.728090 29622 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0925 20:32:22.728097 29622 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0925 20:32:22.728214 29622 net.cpp:141] Setting up lstm1_h_conted_0
I0925 20:32:22.728225 29622 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:32:22.728230 29622 net.cpp:156] Memory required for data: 46016
I0925 20:32:22.728235 29622 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0925 20:32:22.728252 29622 net.cpp:91] Creating Layer lstm1_transform_1
I0925 20:32:22.728258 29622 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0925 20:32:22.728266 29622 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0925 20:32:22.742717 29628 net.cpp:141] Setting up fc6
I0925 20:32:22.742765 29628 net.cpp:148] Top shape: 10 4096 (40960)
I0925 20:32:22.742771 29628 net.cpp:156] Memory required for data: 67782200
I0925 20:32:22.742785 29628 layer_factory.hpp:77] Creating layer relu6
I0925 20:32:22.742810 29628 net.cpp:91] Creating Layer relu6
I0925 20:32:22.742816 29628 net.cpp:425] relu6 <- fc6
I0925 20:32:22.742825 29628 net.cpp:386] relu6 -> fc6 (in-place)
I0925 20:32:22.743186 29628 net.cpp:141] Setting up relu6
I0925 20:32:22.743199 29628 net.cpp:148] Top shape: 10 4096 (40960)
I0925 20:32:22.743204 29628 net.cpp:156] Memory required for data: 67946040
I0925 20:32:22.743211 29628 layer_factory.hpp:77] Creating layer drop6
I0925 20:32:22.743237 29628 net.cpp:91] Creating Layer drop6
I0925 20:32:22.743243 29628 net.cpp:425] drop6 <- fc6
I0925 20:32:22.743250 29628 net.cpp:386] drop6 -> fc6 (in-place)
I0925 20:32:22.743309 29628 net.cpp:141] Setting up drop6
I0925 20:32:22.743320 29628 net.cpp:148] Top shape: 10 4096 (40960)
I0925 20:32:22.743325 29628 net.cpp:156] Memory required for data: 68109880
I0925 20:32:22.743330 29628 layer_factory.hpp:77] Creating layer fc7
I0925 20:32:22.743340 29628 net.cpp:91] Creating Layer fc7
I0925 20:32:22.743345 29628 net.cpp:425] fc7 <- fc6
I0925 20:32:22.743357 29628 net.cpp:399] fc7 -> fc7
I0925 20:32:22.775892 29622 net.cpp:141] Setting up lstm1_transform_1
I0925 20:32:22.775949 29622 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 20:32:22.775955 29622 net.cpp:156] Memory required for data: 62016
I0925 20:32:22.775979 29622 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0925 20:32:22.776005 29622 net.cpp:91] Creating Layer lstm1_gate_input_1
I0925 20:32:22.776013 29622 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0925 20:32:22.776022 29622 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0925 20:32:22.776034 29622 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0925 20:32:22.776099 29622 net.cpp:141] Setting up lstm1_gate_input_1
I0925 20:32:22.776109 29622 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 20:32:22.776114 29622 net.cpp:156] Memory required for data: 78016
I0925 20:32:22.776119 29622 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0925 20:32:22.776134 29622 net.cpp:91] Creating Layer lstm1_unit_1
I0925 20:32:22.776139 29622 net.cpp:425] lstm1_unit_1 <- c_0
I0925 20:32:22.776145 29622 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0925 20:32:22.776151 29622 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0925 20:32:22.776159 29622 net.cpp:399] lstm1_unit_1 -> c_1
I0925 20:32:22.776168 29622 net.cpp:399] lstm1_unit_1 -> h_1
I0925 20:32:22.776238 29622 net.cpp:141] Setting up lstm1_unit_1
I0925 20:32:22.776248 29622 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:32:22.776254 29622 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:32:22.776259 29622 net.cpp:156] Memory required for data: 86016
I0925 20:32:22.776264 29622 layer_factory.hpp:77] Creating layer lstm1_
I0925 20:32:22.776273 29622 net.cpp:91] Creating Layer lstm1_
I0925 20:32:22.776278 29622 net.cpp:425] lstm1_ <- c_1
I0925 20:32:22.776288 29622 net.cpp:399] lstm1_ -> c_T
I0925 20:32:22.776321 29622 net.cpp:141] Setting up lstm1_
I0925 20:32:22.776330 29622 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:32:22.776335 29622 net.cpp:156] Memory required for data: 90016
I0925 20:32:22.776340 29622 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0925 20:32:22.776362 29622 net.cpp:91] Creating Layer lstm1_h_concat
I0925 20:32:22.776368 29622 net.cpp:425] lstm1_h_concat <- h_1
I0925 20:32:22.776376 29622 net.cpp:399] lstm1_h_concat -> h
I0925 20:32:22.776418 29622 net.cpp:141] Setting up lstm1_h_concat
I0925 20:32:22.776427 29622 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:32:22.776432 29622 net.cpp:156] Memory required for data: 94016
I0925 20:32:22.776437 29622 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 20:32:22.776453 29622 net.cpp:91] Creating Layer h_pseudoloss
I0925 20:32:22.776458 29622 net.cpp:425] h_pseudoloss <- h
I0925 20:32:22.776465 29622 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 20:32:22.776568 29622 net.cpp:141] Setting up h_pseudoloss
I0925 20:32:22.776582 29622 net.cpp:148] Top shape: (1)
I0925 20:32:22.776587 29622 net.cpp:151]     with loss weight 1
I0925 20:32:22.776628 29622 net.cpp:156] Memory required for data: 94020
I0925 20:32:22.776633 29622 net.cpp:217] h_pseudoloss needs backward computation.
I0925 20:32:22.776638 29622 net.cpp:217] lstm1_h_concat needs backward computation.
I0925 20:32:22.776643 29622 net.cpp:219] lstm1_ does not need backward computation.
I0925 20:32:22.776648 29622 net.cpp:217] lstm1_unit_1 needs backward computation.
I0925 20:32:22.776654 29622 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0925 20:32:22.776659 29622 net.cpp:217] lstm1_transform_1 needs backward computation.
I0925 20:32:22.776664 29622 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0925 20:32:22.776670 29622 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0925 20:32:22.776675 29622 net.cpp:217] lstm1_x_transform needs backward computation.
I0925 20:32:22.776680 29622 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0925 20:32:22.776686 29622 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0925 20:32:22.776691 29622 net.cpp:219] lstm1_ does not need backward computation.
I0925 20:32:22.776696 29622 net.cpp:219] lstm1_ does not need backward computation.
I0925 20:32:22.776700 29622 net.cpp:261] This network produces output c_T
I0925 20:32:22.776705 29622 net.cpp:261] This network produces output h_pseudoloss
I0925 20:32:22.776723 29622 net.cpp:274] Network initialization done.
I0925 20:32:22.776788 29622 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 20:32:22.776794 29622 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 20:32:22.776799 29622 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 20:32:22.776921 29622 net.cpp:141] Setting up lstm1
I0925 20:32:22.776934 29622 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:32:22.776938 29622 net.cpp:156] Memory required for data: 26408
I0925 20:32:22.776953 29622 layer_factory.hpp:77] Creating layer concat
I0925 20:32:22.776962 29622 net.cpp:91] Creating Layer concat
I0925 20:32:22.776968 29622 net.cpp:425] concat <- lstm1
I0925 20:32:22.776975 29622 net.cpp:425] concat <- embedded_input_sentence
I0925 20:32:22.776983 29622 net.cpp:425] concat <- reshaped_stage_indicator
I0925 20:32:22.776989 29622 net.cpp:399] concat -> lstm1_video_sequence
I0925 20:32:22.777025 29622 net.cpp:141] Setting up concat
I0925 20:32:22.777035 29622 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 20:32:22.777040 29622 net.cpp:156] Memory required for data: 32412
I0925 20:32:22.777045 29622 layer_factory.hpp:77] Creating layer lstm2
I0925 20:32:22.777058 29622 net.cpp:91] Creating Layer lstm2
I0925 20:32:22.777063 29622 net.cpp:425] lstm2 <- lstm1_video_sequence
I0925 20:32:22.777070 29622 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0925 20:32:22.777078 29622 net.cpp:399] lstm2 -> lstm2
I0925 20:32:22.777091 29622 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0925 20:32:22.777384 29622 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0925 20:32:22.777483 29622 layer_factory.hpp:77] Creating layer lstm2_
I0925 20:32:22.777496 29622 net.cpp:91] Creating Layer lstm2_
I0925 20:32:22.777503 29622 net.cpp:399] lstm2_ -> x
I0925 20:32:22.777514 29622 net.cpp:399] lstm2_ -> cont
I0925 20:32:22.777575 29622 net.cpp:141] Setting up lstm2_
I0925 20:32:22.777585 29622 net.cpp:148] Top shape: 1 1 1501 (1501)
I0925 20:32:22.777590 29622 net.cpp:148] Top shape: 1 1 (1)
I0925 20:32:22.777595 29622 net.cpp:156] Memory required for data: 6008
I0925 20:32:22.777600 29622 layer_factory.hpp:77] Creating layer lstm2_
I0925 20:32:22.777611 29622 net.cpp:91] Creating Layer lstm2_
I0925 20:32:22.777619 29622 net.cpp:399] lstm2_ -> c_0
I0925 20:32:22.777629 29622 net.cpp:399] lstm2_ -> h_0
I0925 20:32:22.777683 29622 net.cpp:141] Setting up lstm2_
I0925 20:32:22.777693 29622 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:32:22.777699 29622 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:32:22.777704 29622 net.cpp:156] Memory required for data: 14008
I0925 20:32:22.777709 29622 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0925 20:32:22.777717 29622 net.cpp:91] Creating Layer lstm2_cont_slice
I0925 20:32:22.777722 29622 net.cpp:425] lstm2_cont_slice <- cont
I0925 20:32:22.777729 29622 net.cpp:399] lstm2_cont_slice -> cont_1
I0925 20:32:22.777770 29622 net.cpp:141] Setting up lstm2_cont_slice
I0925 20:32:22.777778 29622 net.cpp:148] Top shape: 1 1 (1)
I0925 20:32:22.777783 29622 net.cpp:156] Memory required for data: 14012
I0925 20:32:22.777787 29622 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0925 20:32:22.777794 29622 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0925 20:32:22.777799 29622 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0925 20:32:22.777808 29622 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0925 20:32:22.777817 29622 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0925 20:32:22.777869 29622 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0925 20:32:22.777880 29622 net.cpp:148] Top shape: 1 1 (1)
I0925 20:32:22.777886 29622 net.cpp:148] Top shape: 1 1 (1)
I0925 20:32:22.777891 29622 net.cpp:156] Memory required for data: 14020
I0925 20:32:22.777895 29622 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0925 20:32:22.777906 29622 net.cpp:91] Creating Layer lstm2_x_transform
I0925 20:32:22.777911 29622 net.cpp:425] lstm2_x_transform <- x
I0925 20:32:22.777921 29622 net.cpp:399] lstm2_x_transform -> W_xc_x
I0925 20:32:22.797385 29628 net.cpp:141] Setting up fc7
I0925 20:32:22.797437 29628 net.cpp:148] Top shape: 10 4096 (40960)
I0925 20:32:22.797444 29628 net.cpp:156] Memory required for data: 68273720
I0925 20:32:22.797462 29628 layer_factory.hpp:77] Creating layer relu7
I0925 20:32:22.797487 29628 net.cpp:91] Creating Layer relu7
I0925 20:32:22.797495 29628 net.cpp:425] relu7 <- fc7
I0925 20:32:22.797505 29628 net.cpp:386] relu7 -> fc7 (in-place)
I0925 20:32:22.798233 29628 net.cpp:141] Setting up relu7
I0925 20:32:22.798249 29628 net.cpp:148] Top shape: 10 4096 (40960)
I0925 20:32:22.798254 29628 net.cpp:156] Memory required for data: 68437560
I0925 20:32:22.798259 29628 layer_factory.hpp:77] Creating layer drop7
I0925 20:32:22.798362 29628 net.cpp:91] Creating Layer drop7
I0925 20:32:22.798399 29628 net.cpp:425] drop7 <- fc7
I0925 20:32:22.798413 29628 net.cpp:386] drop7 -> fc7 (in-place)
I0925 20:32:22.798544 29628 net.cpp:141] Setting up drop7
I0925 20:32:22.798559 29628 net.cpp:148] Top shape: 10 4096 (40960)
I0925 20:32:22.798565 29628 net.cpp:156] Memory required for data: 68601400
I0925 20:32:22.798571 29628 layer_factory.hpp:77] Creating layer fc8
I0925 20:32:22.798584 29628 net.cpp:91] Creating Layer fc8
I0925 20:32:22.798589 29628 net.cpp:425] fc8 <- fc7
I0925 20:32:22.798620 29628 net.cpp:399] fc8 -> fc8
I0925 20:32:22.811882 29628 net.cpp:141] Setting up fc8
I0925 20:32:22.811934 29628 net.cpp:148] Top shape: 10 1000 (10000)
I0925 20:32:22.811942 29628 net.cpp:156] Memory required for data: 68641400
I0925 20:32:22.811959 29628 layer_factory.hpp:77] Creating layer prob
I0925 20:32:22.812012 29628 net.cpp:91] Creating Layer prob
I0925 20:32:22.812026 29628 net.cpp:425] prob <- fc8
I0925 20:32:22.812036 29628 net.cpp:399] prob -> prob
I0925 20:32:22.812505 29628 net.cpp:141] Setting up prob
I0925 20:32:22.812520 29628 net.cpp:148] Top shape: 10 1000 (10000)
I0925 20:32:22.812525 29628 net.cpp:156] Memory required for data: 68681400
I0925 20:32:22.812532 29628 net.cpp:219] prob does not need backward computation.
I0925 20:32:22.812538 29628 net.cpp:219] fc8 does not need backward computation.
I0925 20:32:22.812543 29628 net.cpp:219] drop7 does not need backward computation.
I0925 20:32:22.812548 29628 net.cpp:219] relu7 does not need backward computation.
I0925 20:32:22.812552 29628 net.cpp:219] fc7 does not need backward computation.
I0925 20:32:22.812557 29628 net.cpp:219] drop6 does not need backward computation.
I0925 20:32:22.812561 29628 net.cpp:219] relu6 does not need backward computation.
I0925 20:32:22.812566 29628 net.cpp:219] fc6 does not need backward computation.
I0925 20:32:22.812572 29628 net.cpp:219] pool5 does not need backward computation.
I0925 20:32:22.812577 29628 net.cpp:219] relu5 does not need backward computation.
I0925 20:32:22.812582 29628 net.cpp:219] conv5 does not need backward computation.
I0925 20:32:22.812587 29628 net.cpp:219] relu4 does not need backward computation.
I0925 20:32:22.812592 29628 net.cpp:219] conv4 does not need backward computation.
I0925 20:32:22.812597 29628 net.cpp:219] relu3 does not need backward computation.
I0925 20:32:22.812602 29628 net.cpp:219] conv3 does not need backward computation.
I0925 20:32:22.812608 29628 net.cpp:219] norm2 does not need backward computation.
I0925 20:32:22.812613 29628 net.cpp:219] pool2 does not need backward computation.
I0925 20:32:22.812618 29628 net.cpp:219] relu2 does not need backward computation.
I0925 20:32:22.812625 29628 net.cpp:219] conv2 does not need backward computation.
I0925 20:32:22.812630 29628 net.cpp:219] norm1 does not need backward computation.
I0925 20:32:22.812635 29628 net.cpp:219] pool1 does not need backward computation.
I0925 20:32:22.812643 29628 net.cpp:219] relu1 does not need backward computation.
I0925 20:32:22.812646 29628 net.cpp:219] conv1 does not need backward computation.
I0925 20:32:22.812651 29628 net.cpp:219] data does not need backward computation.
I0925 20:32:22.812656 29628 net.cpp:261] This network produces output prob
I0925 20:32:22.812677 29628 net.cpp:274] Network initialization done.
I0925 20:32:22.842214 29622 net.cpp:141] Setting up lstm2_x_transform
I0925 20:32:22.842272 29622 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 20:32:22.842278 29622 net.cpp:156] Memory required for data: 30020
I0925 20:32:22.842305 29622 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0925 20:32:22.842324 29622 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0925 20:32:22.842331 29622 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0925 20:32:22.842341 29622 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0925 20:32:22.842392 29622 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0925 20:32:22.842402 29622 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 20:32:22.842407 29622 net.cpp:156] Memory required for data: 46020
I0925 20:32:22.842412 29622 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0925 20:32:22.842427 29622 net.cpp:91] Creating Layer lstm2_h_conted_0
I0925 20:32:22.842433 29622 net.cpp:425] lstm2_h_conted_0 <- h_0
I0925 20:32:22.842440 29622 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0925 20:32:22.842447 29622 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0925 20:32:22.842555 29622 net.cpp:141] Setting up lstm2_h_conted_0
I0925 20:32:22.842566 29622 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:32:22.842569 29622 net.cpp:156] Memory required for data: 50020
I0925 20:32:22.842574 29622 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0925 20:32:22.842588 29622 net.cpp:91] Creating Layer lstm2_transform_1
I0925 20:32:22.842593 29622 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0925 20:32:22.842617 29622 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0925 20:32:22.885236 29622 net.cpp:141] Setting up lstm2_transform_1
I0925 20:32:22.885290 29622 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 20:32:22.885298 29622 net.cpp:156] Memory required for data: 66020
I0925 20:32:22.885318 29622 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0925 20:32:22.885345 29622 net.cpp:91] Creating Layer lstm2_gate_input_1
I0925 20:32:22.885354 29622 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0925 20:32:22.885362 29622 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0925 20:32:22.885370 29622 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0925 20:32:22.885426 29622 net.cpp:141] Setting up lstm2_gate_input_1
I0925 20:32:22.885437 29622 net.cpp:148] Top shape: 1 1 4000 (4000)
I0925 20:32:22.885442 29622 net.cpp:156] Memory required for data: 82020
I0925 20:32:22.885447 29622 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0925 20:32:22.885457 29622 net.cpp:91] Creating Layer lstm2_unit_1
I0925 20:32:22.885462 29622 net.cpp:425] lstm2_unit_1 <- c_0
I0925 20:32:22.885468 29622 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0925 20:32:22.885473 29622 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0925 20:32:22.885480 29622 net.cpp:399] lstm2_unit_1 -> c_1
I0925 20:32:22.885489 29622 net.cpp:399] lstm2_unit_1 -> h_1
I0925 20:32:22.885560 29622 net.cpp:141] Setting up lstm2_unit_1
I0925 20:32:22.885570 29622 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:32:22.885576 29622 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:32:22.885581 29622 net.cpp:156] Memory required for data: 90020
I0925 20:32:22.885586 29622 layer_factory.hpp:77] Creating layer lstm2_
I0925 20:32:22.885597 29622 net.cpp:91] Creating Layer lstm2_
I0925 20:32:22.885602 29622 net.cpp:425] lstm2_ <- c_1
I0925 20:32:22.885609 29622 net.cpp:399] lstm2_ -> c_T
I0925 20:32:22.885644 29622 net.cpp:141] Setting up lstm2_
I0925 20:32:22.885653 29622 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:32:22.885658 29622 net.cpp:156] Memory required for data: 94020
I0925 20:32:22.885663 29622 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0925 20:32:22.885673 29622 net.cpp:91] Creating Layer lstm2_h_concat
I0925 20:32:22.885677 29622 net.cpp:425] lstm2_h_concat <- h_1
I0925 20:32:22.885689 29622 net.cpp:399] lstm2_h_concat -> h
I0925 20:32:22.885727 29622 net.cpp:141] Setting up lstm2_h_concat
I0925 20:32:22.885740 29622 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:32:22.885745 29622 net.cpp:156] Memory required for data: 98020
I0925 20:32:22.885749 29622 layer_factory.hpp:77] Creating layer h_pseudoloss
I0925 20:32:22.885759 29622 net.cpp:91] Creating Layer h_pseudoloss
I0925 20:32:22.885764 29622 net.cpp:425] h_pseudoloss <- h
I0925 20:32:22.885771 29622 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0925 20:32:22.885871 29622 net.cpp:141] Setting up h_pseudoloss
I0925 20:32:22.885881 29622 net.cpp:148] Top shape: (1)
I0925 20:32:22.885886 29622 net.cpp:151]     with loss weight 1
I0925 20:32:22.885905 29622 net.cpp:156] Memory required for data: 98024
I0925 20:32:22.885911 29622 net.cpp:217] h_pseudoloss needs backward computation.
I0925 20:32:22.885916 29622 net.cpp:217] lstm2_h_concat needs backward computation.
I0925 20:32:22.885921 29622 net.cpp:219] lstm2_ does not need backward computation.
I0925 20:32:22.885926 29622 net.cpp:217] lstm2_unit_1 needs backward computation.
I0925 20:32:22.885932 29622 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0925 20:32:22.885937 29622 net.cpp:217] lstm2_transform_1 needs backward computation.
I0925 20:32:22.885943 29622 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0925 20:32:22.885949 29622 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0925 20:32:22.885954 29622 net.cpp:217] lstm2_x_transform needs backward computation.
I0925 20:32:22.885959 29622 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0925 20:32:22.885964 29622 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0925 20:32:22.885970 29622 net.cpp:219] lstm2_ does not need backward computation.
I0925 20:32:22.885974 29622 net.cpp:219] lstm2_ does not need backward computation.
I0925 20:32:22.885978 29622 net.cpp:261] This network produces output c_T
I0925 20:32:22.885983 29622 net.cpp:261] This network produces output h_pseudoloss
I0925 20:32:22.886003 29622 net.cpp:274] Network initialization done.
I0925 20:32:22.886056 29622 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0925 20:32:22.886063 29622 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0925 20:32:22.886068 29622 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0925 20:32:22.886180 29622 net.cpp:141] Setting up lstm2
I0925 20:32:22.886193 29622 net.cpp:148] Top shape: 1 1 1000 (1000)
I0925 20:32:22.886198 29622 net.cpp:156] Memory required for data: 36412
I0925 20:32:22.886211 29622 layer_factory.hpp:77] Creating layer predict
I0925 20:32:22.886226 29622 net.cpp:91] Creating Layer predict
I0925 20:32:22.886234 29622 net.cpp:425] predict <- lstm2
I0925 20:32:22.886242 29622 net.cpp:399] predict -> predict
I0925 20:32:23.055554 29628 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /home/peifeng/work/run/storm102/data/workers/23d95a34-2869-403b-8500-59c076333e77/tmp/cvld2415285016873473660/bvlc_reference_caffenet.caffemodel
I0925 20:32:23.055598 29628 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0925 20:32:23.055604 29628 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0925 20:32:23.055608 29628 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /home/peifeng/work/run/storm102/data/workers/23d95a34-2869-403b-8500-59c076333e77/tmp/cvld2415285016873473660/bvlc_reference_caffenet.caffemodel
I0925 20:32:23.390228 29622 net.cpp:141] Setting up predict
I0925 20:32:23.390291 29622 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 20:32:23.390298 29622 net.cpp:156] Memory required for data: 221084
I0925 20:32:23.390316 29622 layer_factory.hpp:77] Creating layer probs
I0925 20:32:23.390336 29622 net.cpp:91] Creating Layer probs
I0925 20:32:23.390344 29622 net.cpp:425] probs <- predict
I0925 20:32:23.390355 29622 net.cpp:399] probs -> probs
I0925 20:32:23.392756 29622 net.cpp:141] Setting up probs
I0925 20:32:23.392778 29622 net.cpp:148] Top shape: 1 1 46168 (46168)
I0925 20:32:23.392784 29622 net.cpp:156] Memory required for data: 405756
I0925 20:32:23.392791 29622 net.cpp:219] probs does not need backward computation.
I0925 20:32:23.392796 29622 net.cpp:219] predict does not need backward computation.
I0925 20:32:23.392802 29622 net.cpp:219] lstm2 does not need backward computation.
I0925 20:32:23.392807 29622 net.cpp:219] concat does not need backward computation.
I0925 20:32:23.392813 29622 net.cpp:219] lstm1 does not need backward computation.
I0925 20:32:23.392820 29622 net.cpp:219] embedding does not need backward computation.
I0925 20:32:23.392825 29622 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0925 20:32:23.392832 29622 net.cpp:219] reshape_frames does not need backward computation.
I0925 20:32:23.392837 29622 net.cpp:219] embed_encoder does not need backward computation.
I0925 20:32:23.392841 29622 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0925 20:32:23.392848 29622 net.cpp:219] input does not need backward computation.
I0925 20:32:23.392851 29622 net.cpp:261] This network produces output probs
I0925 20:32:23.392870 29622 net.cpp:274] Network initialization done.
I0925 20:32:23.454777 29628 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0925 20:32:23.508595 29628 net.cpp:752] Ignoring source layer loss
Loading the model + trained: 6291.1ms
Using cv::Size and some other stuff: 0.092ms
I0925 20:32:23.747184 29622 net.cpp:752] Ignoring source layer data
I0925 20:32:23.747228 29622 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0925 20:32:23.747236 29622 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0925 20:32:23.836434 29622 net.cpp:752] Ignoring source layer cross_entropy_loss
Loading the mean file: 65894.8ms
TIMERTIMER 301695200
TIMERTIMER 249444852
TIMERTIMER 288621754
TIMERTIMER 225494428
TIMERTIMER 237116527
TIMERTIMER 225737810
TIMERTIMER 236370672
TIMERTIMER 240864103
TIMERTIMER 237809211
TIMERTIMER 226542914
TIMERTIMER 231809422
TIMERTIMER 230555331
TIMERTIMER 239010316
TIMERTIMER 230983253
TIMERTIMER 231249740
TIMERTIMER 236573503
TIMERTIMER 238557101
TIMERTIMER 242703012
TIMERTIMER 230735491
TIMERTIMER 238708666
TIMERTIMER 233140264
TIMERTIMER 237430229
TIMERTIMER 233065262
TIMERTIMER 243401550
TIMERTIMER 224297915
TIMERTIMER 224942151
TIMERTIMER 231541142
TIMERTIMER 196945345
