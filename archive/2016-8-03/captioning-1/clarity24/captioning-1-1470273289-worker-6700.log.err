SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/lvnguyen/apache-storm-0.10.1/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/lvnguyen/apache-storm-0.10.1/data/supervisor/stormdist/captioning-1-1470273289/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
2016-08-03 21:15:23,134 ERROR Logger contains an invalid element or attribute "appender"
2016-08-03 21:15:40,479 ERROR Logger contains an invalid element or attribute "appender"
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /tmp/cvld3719170067850430311/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0803 21:15:46.656570 10552 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0803 21:15:46.656785 10552 layer_factory.hpp:77] Creating layer data
I0803 21:15:46.656811 10552 net.cpp:91] Creating Layer data
I0803 21:15:46.656821 10552 net.cpp:399] data -> data
I0803 21:15:47.149644 10542 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /tmp/cvld3719170067850430311/s2vt.words_to_preds.prototxt
I0803 21:15:47.149704 10542 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0803 21:15:47.149714 10542 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0803 21:15:47.150099 10542 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0803 21:15:47.150293 10542 layer_factory.hpp:77] Creating layer input
I0803 21:15:47.150310 10542 net.cpp:91] Creating Layer input
I0803 21:15:47.150317 10542 net.cpp:399] input -> frames_fc7
I0803 21:15:47.150333 10542 net.cpp:399] input -> cont_sentence
I0803 21:15:47.150347 10542 net.cpp:399] input -> input_sentence
I0803 21:15:47.150357 10542 net.cpp:399] input -> stage_indicator
I0803 21:15:47.168088 10552 net.cpp:141] Setting up data
I0803 21:15:47.168148 10552 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0803 21:15:47.168156 10552 net.cpp:156] Memory required for data: 6183480
I0803 21:15:47.168161 10542 net.cpp:141] Setting up input
I0803 21:15:47.168180 10552 layer_factory.hpp:77] Creating layer conv1
I0803 21:15:47.168182 10542 net.cpp:148] Top shape: 1 4096 (4096)
I0803 21:15:47.168190 10542 net.cpp:148] Top shape: 1 1 (1)
I0803 21:15:47.168196 10542 net.cpp:148] Top shape: 1 1 (1)
I0803 21:15:47.168202 10542 net.cpp:148] Top shape: 1 1 (1)
I0803 21:15:47.168205 10542 net.cpp:156] Memory required for data: 16396
I0803 21:15:47.168207 10552 net.cpp:91] Creating Layer conv1
I0803 21:15:47.168211 10542 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0803 21:15:47.168216 10552 net.cpp:425] conv1 <- data
I0803 21:15:47.168228 10552 net.cpp:399] conv1 -> conv1
I0803 21:15:47.168231 10542 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0803 21:15:47.168236 10542 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0803 21:15:47.168256 10542 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0803 21:15:47.168267 10542 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0803 21:15:47.168331 10542 net.cpp:141] Setting up cont_sentence_input_1_split
I0803 21:15:47.168342 10542 net.cpp:148] Top shape: 1 1 (1)
I0803 21:15:47.168349 10542 net.cpp:148] Top shape: 1 1 (1)
I0803 21:15:47.168352 10542 net.cpp:156] Memory required for data: 16404
I0803 21:15:47.168356 10542 layer_factory.hpp:77] Creating layer embed_encoder
I0803 21:15:47.168375 10542 net.cpp:91] Creating Layer embed_encoder
I0803 21:15:47.168380 10542 net.cpp:425] embed_encoder <- frames_fc7
I0803 21:15:47.168388 10542 net.cpp:399] embed_encoder -> embedded_in_frames
I0803 21:15:47.192227 10542 net.cpp:141] Setting up embed_encoder
I0803 21:15:47.192281 10542 net.cpp:148] Top shape: 1 500 (500)
I0803 21:15:47.192286 10542 net.cpp:156] Memory required for data: 18404
I0803 21:15:47.192312 10542 layer_factory.hpp:77] Creating layer reshape_frames
I0803 21:15:47.192345 10542 net.cpp:91] Creating Layer reshape_frames
I0803 21:15:47.192353 10542 net.cpp:425] reshape_frames <- embedded_in_frames
I0803 21:15:47.192364 10542 net.cpp:399] reshape_frames -> embedded_input_frames
I0803 21:15:47.192561 10542 net.cpp:141] Setting up reshape_frames
I0803 21:15:47.192572 10542 net.cpp:148] Top shape: 1 1 500 (500)
I0803 21:15:47.192576 10542 net.cpp:156] Memory required for data: 20404
I0803 21:15:47.192580 10542 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0803 21:15:47.192591 10542 net.cpp:91] Creating Layer reshape_stage_indicator
I0803 21:15:47.192596 10542 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0803 21:15:47.192605 10542 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0803 21:15:47.194248 10542 net.cpp:141] Setting up reshape_stage_indicator
I0803 21:15:47.194269 10542 net.cpp:148] Top shape: 1 1 1 (1)
I0803 21:15:47.194274 10542 net.cpp:156] Memory required for data: 20408
I0803 21:15:47.194279 10542 layer_factory.hpp:77] Creating layer embedding
I0803 21:15:47.194291 10542 net.cpp:91] Creating Layer embedding
I0803 21:15:47.194298 10542 net.cpp:425] embedding <- input_sentence
I0803 21:15:47.194304 10542 net.cpp:399] embedding -> embedded_input_sentence
I0803 21:15:47.411738 10542 net.cpp:141] Setting up embedding
I0803 21:15:47.411782 10542 net.cpp:148] Top shape: 1 1 500 (500)
I0803 21:15:47.411789 10542 net.cpp:156] Memory required for data: 22408
I0803 21:15:47.411805 10542 layer_factory.hpp:77] Creating layer lstm1
I0803 21:15:47.411823 10542 net.cpp:91] Creating Layer lstm1
I0803 21:15:47.411829 10542 net.cpp:425] lstm1 <- embedded_input_frames
I0803 21:15:47.411837 10542 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0803 21:15:47.411847 10542 net.cpp:399] lstm1 -> lstm1
I0803 21:15:47.411878 10542 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0803 21:15:47.412292 10542 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0803 21:15:47.412384 10542 layer_factory.hpp:77] Creating layer lstm1_
I0803 21:15:47.412398 10542 net.cpp:91] Creating Layer lstm1_
I0803 21:15:47.412405 10542 net.cpp:399] lstm1_ -> x
I0803 21:15:47.412416 10542 net.cpp:399] lstm1_ -> cont
I0803 21:15:47.415302 10542 net.cpp:141] Setting up lstm1_
I0803 21:15:47.415319 10542 net.cpp:148] Top shape: 1 1 500 (500)
I0803 21:15:47.415326 10542 net.cpp:148] Top shape: 1 1 (1)
I0803 21:15:47.415331 10542 net.cpp:156] Memory required for data: 2004
I0803 21:15:47.415336 10542 layer_factory.hpp:77] Creating layer lstm1_
I0803 21:15:47.415346 10542 net.cpp:91] Creating Layer lstm1_
I0803 21:15:47.415359 10542 net.cpp:399] lstm1_ -> c_0
I0803 21:15:47.415370 10542 net.cpp:399] lstm1_ -> h_0
I0803 21:15:47.415416 10542 net.cpp:141] Setting up lstm1_
I0803 21:15:47.415426 10542 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:15:47.415431 10542 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:15:47.415436 10542 net.cpp:156] Memory required for data: 10004
I0803 21:15:47.415439 10542 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0803 21:15:47.415451 10542 net.cpp:91] Creating Layer lstm1_cont_slice
I0803 21:15:47.415455 10542 net.cpp:425] lstm1_cont_slice <- cont
I0803 21:15:47.415462 10542 net.cpp:399] lstm1_cont_slice -> cont_1
I0803 21:15:47.415495 10542 net.cpp:141] Setting up lstm1_cont_slice
I0803 21:15:47.415503 10542 net.cpp:148] Top shape: 1 1 (1)
I0803 21:15:47.415508 10542 net.cpp:156] Memory required for data: 10008
I0803 21:15:47.415513 10542 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0803 21:15:47.415518 10542 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0803 21:15:47.415524 10542 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0803 21:15:47.415531 10542 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0803 21:15:47.415540 10542 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0803 21:15:47.415586 10542 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0803 21:15:47.415596 10542 net.cpp:148] Top shape: 1 1 (1)
I0803 21:15:47.415601 10542 net.cpp:148] Top shape: 1 1 (1)
I0803 21:15:47.415604 10542 net.cpp:156] Memory required for data: 10016
I0803 21:15:47.415609 10542 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0803 21:15:47.415621 10542 net.cpp:91] Creating Layer lstm1_x_transform
I0803 21:15:47.415627 10542 net.cpp:425] lstm1_x_transform <- x
I0803 21:15:47.415634 10542 net.cpp:399] lstm1_x_transform -> W_xc_x
I0803 21:15:47.424016 10552 net.cpp:141] Setting up conv1
I0803 21:15:47.424063 10552 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0803 21:15:47.424069 10552 net.cpp:156] Memory required for data: 17799480
I0803 21:15:47.424093 10552 layer_factory.hpp:77] Creating layer relu1
I0803 21:15:47.424113 10552 net.cpp:91] Creating Layer relu1
I0803 21:15:47.424120 10552 net.cpp:425] relu1 <- conv1
I0803 21:15:47.424129 10552 net.cpp:386] relu1 -> conv1 (in-place)
I0803 21:15:47.424537 10552 net.cpp:141] Setting up relu1
I0803 21:15:47.424551 10552 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0803 21:15:47.424554 10552 net.cpp:156] Memory required for data: 29415480
I0803 21:15:47.424559 10552 layer_factory.hpp:77] Creating layer pool1
I0803 21:15:47.424577 10552 net.cpp:91] Creating Layer pool1
I0803 21:15:47.424633 10552 net.cpp:425] pool1 <- conv1
I0803 21:15:47.424677 10552 net.cpp:399] pool1 -> pool1
I0803 21:15:47.424819 10552 net.cpp:141] Setting up pool1
I0803 21:15:47.424835 10552 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0803 21:15:47.424840 10552 net.cpp:156] Memory required for data: 32214840
I0803 21:15:47.424846 10552 layer_factory.hpp:77] Creating layer norm1
I0803 21:15:47.424867 10552 net.cpp:91] Creating Layer norm1
I0803 21:15:47.424873 10552 net.cpp:425] norm1 <- pool1
I0803 21:15:47.424880 10552 net.cpp:399] norm1 -> norm1
I0803 21:15:47.425493 10552 net.cpp:141] Setting up norm1
I0803 21:15:47.425510 10552 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0803 21:15:47.425515 10552 net.cpp:156] Memory required for data: 35014200
I0803 21:15:47.425521 10552 layer_factory.hpp:77] Creating layer conv2
I0803 21:15:47.425534 10552 net.cpp:91] Creating Layer conv2
I0803 21:15:47.425539 10552 net.cpp:425] conv2 <- norm1
I0803 21:15:47.425550 10552 net.cpp:399] conv2 -> conv2
I0803 21:15:47.428711 10552 net.cpp:141] Setting up conv2
I0803 21:15:47.428726 10552 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0803 21:15:47.428731 10552 net.cpp:156] Memory required for data: 42479160
I0803 21:15:47.428745 10552 layer_factory.hpp:77] Creating layer relu2
I0803 21:15:47.428777 10552 net.cpp:91] Creating Layer relu2
I0803 21:15:47.428783 10552 net.cpp:425] relu2 <- conv2
I0803 21:15:47.428791 10552 net.cpp:386] relu2 -> conv2 (in-place)
I0803 21:15:47.429175 10552 net.cpp:141] Setting up relu2
I0803 21:15:47.429189 10552 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0803 21:15:47.429195 10552 net.cpp:156] Memory required for data: 49944120
I0803 21:15:47.429200 10552 layer_factory.hpp:77] Creating layer pool2
I0803 21:15:47.429211 10552 net.cpp:91] Creating Layer pool2
I0803 21:15:47.429216 10552 net.cpp:425] pool2 <- conv2
I0803 21:15:47.429224 10552 net.cpp:399] pool2 -> pool2
I0803 21:15:47.429289 10552 net.cpp:141] Setting up pool2
I0803 21:15:47.429299 10552 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0803 21:15:47.429304 10552 net.cpp:156] Memory required for data: 51674680
I0803 21:15:47.429318 10552 layer_factory.hpp:77] Creating layer norm2
I0803 21:15:47.429332 10552 net.cpp:91] Creating Layer norm2
I0803 21:15:47.429337 10552 net.cpp:425] norm2 <- pool2
I0803 21:15:47.429344 10552 net.cpp:399] norm2 -> norm2
I0803 21:15:47.429596 10552 net.cpp:141] Setting up norm2
I0803 21:15:47.429608 10552 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0803 21:15:47.429615 10552 net.cpp:156] Memory required for data: 53405240
I0803 21:15:47.429623 10552 layer_factory.hpp:77] Creating layer conv3
I0803 21:15:47.429639 10552 net.cpp:91] Creating Layer conv3
I0803 21:15:47.429648 10552 net.cpp:425] conv3 <- norm2
I0803 21:15:47.429661 10552 net.cpp:399] conv3 -> conv3
I0803 21:15:47.433212 10552 net.cpp:141] Setting up conv3
I0803 21:15:47.433233 10552 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0803 21:15:47.433244 10552 net.cpp:156] Memory required for data: 56001080
I0803 21:15:47.433259 10552 layer_factory.hpp:77] Creating layer relu3
I0803 21:15:47.433267 10552 net.cpp:91] Creating Layer relu3
I0803 21:15:47.433272 10552 net.cpp:425] relu3 <- conv3
I0803 21:15:47.433285 10552 net.cpp:386] relu3 -> conv3 (in-place)
I0803 21:15:47.433660 10552 net.cpp:141] Setting up relu3
I0803 21:15:47.433673 10552 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0803 21:15:47.433677 10552 net.cpp:156] Memory required for data: 58596920
I0803 21:15:47.433682 10552 layer_factory.hpp:77] Creating layer conv4
I0803 21:15:47.433696 10552 net.cpp:91] Creating Layer conv4
I0803 21:15:47.433701 10552 net.cpp:425] conv4 <- conv3
I0803 21:15:47.433711 10552 net.cpp:399] conv4 -> conv4
I0803 21:15:47.437564 10552 net.cpp:141] Setting up conv4
I0803 21:15:47.437584 10552 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0803 21:15:47.437589 10552 net.cpp:156] Memory required for data: 61192760
I0803 21:15:47.437614 10552 layer_factory.hpp:77] Creating layer relu4
I0803 21:15:47.437624 10552 net.cpp:91] Creating Layer relu4
I0803 21:15:47.437629 10552 net.cpp:425] relu4 <- conv4
I0803 21:15:47.437639 10552 net.cpp:386] relu4 -> conv4 (in-place)
I0803 21:15:47.438035 10552 net.cpp:141] Setting up relu4
I0803 21:15:47.438048 10552 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0803 21:15:47.438053 10552 net.cpp:156] Memory required for data: 63788600
I0803 21:15:47.438057 10552 layer_factory.hpp:77] Creating layer conv5
I0803 21:15:47.438071 10552 net.cpp:91] Creating Layer conv5
I0803 21:15:47.438076 10552 net.cpp:425] conv5 <- conv4
I0803 21:15:47.438086 10552 net.cpp:399] conv5 -> conv5
I0803 21:15:47.439373 10542 net.cpp:141] Setting up lstm1_x_transform
I0803 21:15:47.439393 10542 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:15:47.439399 10542 net.cpp:156] Memory required for data: 26016
I0803 21:15:47.439411 10542 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0803 21:15:47.439424 10542 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0803 21:15:47.439430 10542 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0803 21:15:47.439438 10542 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0803 21:15:47.439479 10542 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0803 21:15:47.439489 10542 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:15:47.439493 10542 net.cpp:156] Memory required for data: 42016
I0803 21:15:47.439498 10542 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0803 21:15:47.439510 10542 net.cpp:91] Creating Layer lstm1_h_conted_0
I0803 21:15:47.439515 10542 net.cpp:425] lstm1_h_conted_0 <- h_0
I0803 21:15:47.439522 10542 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0803 21:15:47.439528 10542 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0803 21:15:47.439841 10542 net.cpp:141] Setting up lstm1_h_conted_0
I0803 21:15:47.439851 10542 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:15:47.439857 10542 net.cpp:156] Memory required for data: 46016
I0803 21:15:47.439860 10542 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0803 21:15:47.439882 10542 net.cpp:91] Creating Layer lstm1_transform_1
I0803 21:15:47.439888 10542 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0803 21:15:47.439895 10542 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0803 21:15:47.449141 10552 net.cpp:141] Setting up conv5
I0803 21:15:47.449180 10552 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0803 21:15:47.449187 10552 net.cpp:156] Memory required for data: 65519160
I0803 21:15:47.449205 10552 layer_factory.hpp:77] Creating layer relu5
I0803 21:15:47.449259 10552 net.cpp:91] Creating Layer relu5
I0803 21:15:47.449268 10552 net.cpp:425] relu5 <- conv5
I0803 21:15:47.449276 10552 net.cpp:386] relu5 -> conv5 (in-place)
I0803 21:15:47.449672 10552 net.cpp:141] Setting up relu5
I0803 21:15:47.449686 10552 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0803 21:15:47.449690 10552 net.cpp:156] Memory required for data: 67249720
I0803 21:15:47.449695 10552 layer_factory.hpp:77] Creating layer pool5
I0803 21:15:47.449710 10552 net.cpp:91] Creating Layer pool5
I0803 21:15:47.449717 10552 net.cpp:425] pool5 <- conv5
I0803 21:15:47.449723 10552 net.cpp:399] pool5 -> pool5
I0803 21:15:47.449787 10552 net.cpp:141] Setting up pool5
I0803 21:15:47.449796 10552 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0803 21:15:47.449800 10552 net.cpp:156] Memory required for data: 67618360
I0803 21:15:47.449805 10552 layer_factory.hpp:77] Creating layer fc6
I0803 21:15:47.449827 10552 net.cpp:91] Creating Layer fc6
I0803 21:15:47.449833 10552 net.cpp:425] fc6 <- pool5
I0803 21:15:47.449843 10552 net.cpp:399] fc6 -> fc6
I0803 21:15:47.513402 10542 net.cpp:141] Setting up lstm1_transform_1
I0803 21:15:47.513443 10542 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:15:47.513449 10542 net.cpp:156] Memory required for data: 62016
I0803 21:15:47.513468 10542 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0803 21:15:47.513489 10542 net.cpp:91] Creating Layer lstm1_gate_input_1
I0803 21:15:47.513496 10542 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0803 21:15:47.513504 10542 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0803 21:15:47.513511 10542 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0803 21:15:47.513567 10542 net.cpp:141] Setting up lstm1_gate_input_1
I0803 21:15:47.513576 10542 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:15:47.513581 10542 net.cpp:156] Memory required for data: 78016
I0803 21:15:47.513586 10542 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0803 21:15:47.513597 10542 net.cpp:91] Creating Layer lstm1_unit_1
I0803 21:15:47.513602 10542 net.cpp:425] lstm1_unit_1 <- c_0
I0803 21:15:47.513607 10542 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0803 21:15:47.513612 10542 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0803 21:15:47.513618 10542 net.cpp:399] lstm1_unit_1 -> c_1
I0803 21:15:47.513627 10542 net.cpp:399] lstm1_unit_1 -> h_1
I0803 21:15:47.513702 10542 net.cpp:141] Setting up lstm1_unit_1
I0803 21:15:47.513711 10542 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:15:47.513717 10542 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:15:47.513720 10542 net.cpp:156] Memory required for data: 86016
I0803 21:15:47.513725 10542 layer_factory.hpp:77] Creating layer lstm1_
I0803 21:15:47.513732 10542 net.cpp:91] Creating Layer lstm1_
I0803 21:15:47.513737 10542 net.cpp:425] lstm1_ <- c_1
I0803 21:15:47.513743 10542 net.cpp:399] lstm1_ -> c_T
I0803 21:15:47.513773 10542 net.cpp:141] Setting up lstm1_
I0803 21:15:47.513782 10542 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:15:47.513785 10542 net.cpp:156] Memory required for data: 90016
I0803 21:15:47.513789 10542 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0803 21:15:47.513798 10542 net.cpp:91] Creating Layer lstm1_h_concat
I0803 21:15:47.513803 10542 net.cpp:425] lstm1_h_concat <- h_1
I0803 21:15:47.513808 10542 net.cpp:399] lstm1_h_concat -> h
I0803 21:15:47.513851 10542 net.cpp:141] Setting up lstm1_h_concat
I0803 21:15:47.513859 10542 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:15:47.513864 10542 net.cpp:156] Memory required for data: 94016
I0803 21:15:47.513867 10542 layer_factory.hpp:77] Creating layer h_pseudoloss
I0803 21:15:47.513881 10542 net.cpp:91] Creating Layer h_pseudoloss
I0803 21:15:47.513885 10542 net.cpp:425] h_pseudoloss <- h
I0803 21:15:47.513891 10542 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0803 21:15:47.513978 10542 net.cpp:141] Setting up h_pseudoloss
I0803 21:15:47.513988 10542 net.cpp:148] Top shape: (1)
I0803 21:15:47.513991 10542 net.cpp:151]     with loss weight 1
I0803 21:15:47.514022 10542 net.cpp:156] Memory required for data: 94020
I0803 21:15:47.514027 10542 net.cpp:217] h_pseudoloss needs backward computation.
I0803 21:15:47.514032 10542 net.cpp:217] lstm1_h_concat needs backward computation.
I0803 21:15:47.514036 10542 net.cpp:219] lstm1_ does not need backward computation.
I0803 21:15:47.514040 10542 net.cpp:217] lstm1_unit_1 needs backward computation.
I0803 21:15:47.514046 10542 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0803 21:15:47.514051 10542 net.cpp:217] lstm1_transform_1 needs backward computation.
I0803 21:15:47.514055 10542 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0803 21:15:47.514063 10542 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0803 21:15:47.514068 10542 net.cpp:217] lstm1_x_transform needs backward computation.
I0803 21:15:47.514073 10542 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0803 21:15:47.514078 10542 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0803 21:15:47.514083 10542 net.cpp:219] lstm1_ does not need backward computation.
I0803 21:15:47.514087 10542 net.cpp:219] lstm1_ does not need backward computation.
I0803 21:15:47.514091 10542 net.cpp:261] This network produces output c_T
I0803 21:15:47.514094 10542 net.cpp:261] This network produces output h_pseudoloss
I0803 21:15:47.514109 10542 net.cpp:274] Network initialization done.
I0803 21:15:47.514163 10542 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0803 21:15:47.514168 10542 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0803 21:15:47.514173 10542 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0803 21:15:47.514273 10542 net.cpp:141] Setting up lstm1
I0803 21:15:47.514284 10542 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:15:47.514288 10542 net.cpp:156] Memory required for data: 26408
I0803 21:15:47.514302 10542 layer_factory.hpp:77] Creating layer concat
I0803 21:15:47.514309 10542 net.cpp:91] Creating Layer concat
I0803 21:15:47.514314 10542 net.cpp:425] concat <- lstm1
I0803 21:15:47.514320 10542 net.cpp:425] concat <- embedded_input_sentence
I0803 21:15:47.514325 10542 net.cpp:425] concat <- reshaped_stage_indicator
I0803 21:15:47.514331 10542 net.cpp:399] concat -> lstm1_video_sequence
I0803 21:15:47.514363 10542 net.cpp:141] Setting up concat
I0803 21:15:47.514370 10542 net.cpp:148] Top shape: 1 1 1501 (1501)
I0803 21:15:47.514374 10542 net.cpp:156] Memory required for data: 32412
I0803 21:15:47.514379 10542 layer_factory.hpp:77] Creating layer lstm2
I0803 21:15:47.514389 10542 net.cpp:91] Creating Layer lstm2
I0803 21:15:47.514394 10542 net.cpp:425] lstm2 <- lstm1_video_sequence
I0803 21:15:47.514400 10542 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0803 21:15:47.514405 10542 net.cpp:399] lstm2 -> lstm2
I0803 21:15:47.514415 10542 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0803 21:15:47.514667 10542 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0803 21:15:47.514763 10542 layer_factory.hpp:77] Creating layer lstm2_
I0803 21:15:47.514777 10542 net.cpp:91] Creating Layer lstm2_
I0803 21:15:47.514783 10542 net.cpp:399] lstm2_ -> x
I0803 21:15:47.514794 10542 net.cpp:399] lstm2_ -> cont
I0803 21:15:47.514847 10542 net.cpp:141] Setting up lstm2_
I0803 21:15:47.514856 10542 net.cpp:148] Top shape: 1 1 1501 (1501)
I0803 21:15:47.514863 10542 net.cpp:148] Top shape: 1 1 (1)
I0803 21:15:47.514866 10542 net.cpp:156] Memory required for data: 6008
I0803 21:15:47.514870 10542 layer_factory.hpp:77] Creating layer lstm2_
I0803 21:15:47.514879 10542 net.cpp:91] Creating Layer lstm2_
I0803 21:15:47.514888 10542 net.cpp:399] lstm2_ -> c_0
I0803 21:15:47.514897 10542 net.cpp:399] lstm2_ -> h_0
I0803 21:15:47.514943 10542 net.cpp:141] Setting up lstm2_
I0803 21:15:47.514952 10542 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:15:47.514958 10542 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:15:47.514962 10542 net.cpp:156] Memory required for data: 14008
I0803 21:15:47.514966 10542 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0803 21:15:47.514974 10542 net.cpp:91] Creating Layer lstm2_cont_slice
I0803 21:15:47.514978 10542 net.cpp:425] lstm2_cont_slice <- cont
I0803 21:15:47.514986 10542 net.cpp:399] lstm2_cont_slice -> cont_1
I0803 21:15:47.515015 10542 net.cpp:141] Setting up lstm2_cont_slice
I0803 21:15:47.515024 10542 net.cpp:148] Top shape: 1 1 (1)
I0803 21:15:47.515028 10542 net.cpp:156] Memory required for data: 14012
I0803 21:15:47.515033 10542 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0803 21:15:47.515043 10542 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0803 21:15:47.515048 10542 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0803 21:15:47.515053 10542 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0803 21:15:47.515061 10542 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0803 21:15:47.515107 10542 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0803 21:15:47.515115 10542 net.cpp:148] Top shape: 1 1 (1)
I0803 21:15:47.515121 10542 net.cpp:148] Top shape: 1 1 (1)
I0803 21:15:47.515125 10542 net.cpp:156] Memory required for data: 14020
I0803 21:15:47.515130 10542 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0803 21:15:47.515141 10542 net.cpp:91] Creating Layer lstm2_x_transform
I0803 21:15:47.515146 10542 net.cpp:425] lstm2_x_transform <- x
I0803 21:15:47.515152 10542 net.cpp:399] lstm2_x_transform -> W_xc_x
I0803 21:15:47.551944 10552 net.cpp:141] Setting up fc6
I0803 21:15:47.552019 10552 net.cpp:148] Top shape: 10 4096 (40960)
I0803 21:15:47.552026 10552 net.cpp:156] Memory required for data: 67782200
I0803 21:15:47.552043 10552 layer_factory.hpp:77] Creating layer relu6
I0803 21:15:47.552062 10552 net.cpp:91] Creating Layer relu6
I0803 21:15:47.552069 10552 net.cpp:425] relu6 <- fc6
I0803 21:15:47.552079 10552 net.cpp:386] relu6 -> fc6 (in-place)
I0803 21:15:47.552433 10552 net.cpp:141] Setting up relu6
I0803 21:15:47.552445 10552 net.cpp:148] Top shape: 10 4096 (40960)
I0803 21:15:47.552450 10552 net.cpp:156] Memory required for data: 67946040
I0803 21:15:47.552455 10552 layer_factory.hpp:77] Creating layer drop6
I0803 21:15:47.552471 10552 net.cpp:91] Creating Layer drop6
I0803 21:15:47.552477 10552 net.cpp:425] drop6 <- fc6
I0803 21:15:47.552485 10552 net.cpp:386] drop6 -> fc6 (in-place)
I0803 21:15:47.552534 10552 net.cpp:141] Setting up drop6
I0803 21:15:47.552543 10552 net.cpp:148] Top shape: 10 4096 (40960)
I0803 21:15:47.552547 10552 net.cpp:156] Memory required for data: 68109880
I0803 21:15:47.552552 10552 layer_factory.hpp:77] Creating layer fc7
I0803 21:15:47.552567 10552 net.cpp:91] Creating Layer fc7
I0803 21:15:47.552572 10552 net.cpp:425] fc7 <- fc6
I0803 21:15:47.552578 10552 net.cpp:399] fc7 -> fc7
I0803 21:15:47.581320 10542 net.cpp:141] Setting up lstm2_x_transform
I0803 21:15:47.581367 10542 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:15:47.581372 10542 net.cpp:156] Memory required for data: 30020
I0803 21:15:47.581392 10542 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0803 21:15:47.581410 10542 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0803 21:15:47.581418 10542 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0803 21:15:47.581426 10542 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0803 21:15:47.581470 10542 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0803 21:15:47.581478 10542 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:15:47.581482 10542 net.cpp:156] Memory required for data: 46020
I0803 21:15:47.581487 10542 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0803 21:15:47.581499 10542 net.cpp:91] Creating Layer lstm2_h_conted_0
I0803 21:15:47.581504 10542 net.cpp:425] lstm2_h_conted_0 <- h_0
I0803 21:15:47.581511 10542 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0803 21:15:47.581516 10542 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0803 21:15:47.581606 10542 net.cpp:141] Setting up lstm2_h_conted_0
I0803 21:15:47.581615 10542 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:15:47.581619 10542 net.cpp:156] Memory required for data: 50020
I0803 21:15:47.581624 10542 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0803 21:15:47.581637 10542 net.cpp:91] Creating Layer lstm2_transform_1
I0803 21:15:47.581642 10542 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0803 21:15:47.581650 10542 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0803 21:15:47.597506 10552 net.cpp:141] Setting up fc7
I0803 21:15:47.597576 10552 net.cpp:148] Top shape: 10 4096 (40960)
I0803 21:15:47.597589 10552 net.cpp:156] Memory required for data: 68273720
I0803 21:15:47.597604 10552 layer_factory.hpp:77] Creating layer relu7
I0803 21:15:47.597623 10552 net.cpp:91] Creating Layer relu7
I0803 21:15:47.597630 10552 net.cpp:425] relu7 <- fc7
I0803 21:15:47.597640 10552 net.cpp:386] relu7 -> fc7 (in-place)
I0803 21:15:47.598290 10552 net.cpp:141] Setting up relu7
I0803 21:15:47.598304 10552 net.cpp:148] Top shape: 10 4096 (40960)
I0803 21:15:47.598309 10552 net.cpp:156] Memory required for data: 68437560
I0803 21:15:47.598314 10552 layer_factory.hpp:77] Creating layer drop7
I0803 21:15:47.598335 10552 net.cpp:91] Creating Layer drop7
I0803 21:15:47.598340 10552 net.cpp:425] drop7 <- fc7
I0803 21:15:47.598347 10552 net.cpp:386] drop7 -> fc7 (in-place)
I0803 21:15:47.598392 10552 net.cpp:141] Setting up drop7
I0803 21:15:47.598402 10552 net.cpp:148] Top shape: 10 4096 (40960)
I0803 21:15:47.598405 10552 net.cpp:156] Memory required for data: 68601400
I0803 21:15:47.598410 10552 layer_factory.hpp:77] Creating layer fc8
I0803 21:15:47.598423 10552 net.cpp:91] Creating Layer fc8
I0803 21:15:47.598426 10552 net.cpp:425] fc8 <- fc7
I0803 21:15:47.598433 10552 net.cpp:399] fc8 -> fc8
I0803 21:15:47.611904 10552 net.cpp:141] Setting up fc8
I0803 21:15:47.611961 10552 net.cpp:148] Top shape: 10 1000 (10000)
I0803 21:15:47.611971 10552 net.cpp:156] Memory required for data: 68641400
I0803 21:15:47.611990 10552 layer_factory.hpp:77] Creating layer prob
I0803 21:15:47.612017 10552 net.cpp:91] Creating Layer prob
I0803 21:15:47.612025 10552 net.cpp:425] prob <- fc8
I0803 21:15:47.612038 10552 net.cpp:399] prob -> prob
I0803 21:15:47.612570 10552 net.cpp:141] Setting up prob
I0803 21:15:47.612581 10552 net.cpp:148] Top shape: 10 1000 (10000)
I0803 21:15:47.612586 10552 net.cpp:156] Memory required for data: 68681400
I0803 21:15:47.612592 10552 net.cpp:219] prob does not need backward computation.
I0803 21:15:47.612598 10552 net.cpp:219] fc8 does not need backward computation.
I0803 21:15:47.612604 10552 net.cpp:219] drop7 does not need backward computation.
I0803 21:15:47.612609 10552 net.cpp:219] relu7 does not need backward computation.
I0803 21:15:47.612613 10552 net.cpp:219] fc7 does not need backward computation.
I0803 21:15:47.612618 10552 net.cpp:219] drop6 does not need backward computation.
I0803 21:15:47.612624 10552 net.cpp:219] relu6 does not need backward computation.
I0803 21:15:47.612629 10552 net.cpp:219] fc6 does not need backward computation.
I0803 21:15:47.612634 10552 net.cpp:219] pool5 does not need backward computation.
I0803 21:15:47.612639 10552 net.cpp:219] relu5 does not need backward computation.
I0803 21:15:47.612644 10552 net.cpp:219] conv5 does not need backward computation.
I0803 21:15:47.612649 10552 net.cpp:219] relu4 does not need backward computation.
I0803 21:15:47.612653 10552 net.cpp:219] conv4 does not need backward computation.
I0803 21:15:47.612659 10552 net.cpp:219] relu3 does not need backward computation.
I0803 21:15:47.612663 10552 net.cpp:219] conv3 does not need backward computation.
I0803 21:15:47.612668 10552 net.cpp:219] norm2 does not need backward computation.
I0803 21:15:47.612673 10552 net.cpp:219] pool2 does not need backward computation.
I0803 21:15:47.612678 10552 net.cpp:219] relu2 does not need backward computation.
I0803 21:15:47.612682 10552 net.cpp:219] conv2 does not need backward computation.
I0803 21:15:47.612686 10552 net.cpp:219] norm1 does not need backward computation.
I0803 21:15:47.612691 10552 net.cpp:219] pool1 does not need backward computation.
I0803 21:15:47.612696 10552 net.cpp:219] relu1 does not need backward computation.
I0803 21:15:47.612700 10552 net.cpp:219] conv1 does not need backward computation.
I0803 21:15:47.612705 10552 net.cpp:219] data does not need backward computation.
I0803 21:15:47.612709 10552 net.cpp:261] This network produces output prob
I0803 21:15:47.612728 10552 net.cpp:274] Network initialization done.
I0803 21:15:47.619869 10542 net.cpp:141] Setting up lstm2_transform_1
I0803 21:15:47.619913 10542 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:15:47.619920 10542 net.cpp:156] Memory required for data: 66020
I0803 21:15:47.619940 10542 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0803 21:15:47.619966 10542 net.cpp:91] Creating Layer lstm2_gate_input_1
I0803 21:15:47.619972 10542 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0803 21:15:47.619979 10542 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0803 21:15:47.619989 10542 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0803 21:15:47.620038 10542 net.cpp:141] Setting up lstm2_gate_input_1
I0803 21:15:47.620048 10542 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:15:47.620051 10542 net.cpp:156] Memory required for data: 82020
I0803 21:15:47.620056 10542 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0803 21:15:47.620066 10542 net.cpp:91] Creating Layer lstm2_unit_1
I0803 21:15:47.620071 10542 net.cpp:425] lstm2_unit_1 <- c_0
I0803 21:15:47.620077 10542 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0803 21:15:47.620082 10542 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0803 21:15:47.620090 10542 net.cpp:399] lstm2_unit_1 -> c_1
I0803 21:15:47.620097 10542 net.cpp:399] lstm2_unit_1 -> h_1
I0803 21:15:47.620163 10542 net.cpp:141] Setting up lstm2_unit_1
I0803 21:15:47.620172 10542 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:15:47.620178 10542 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:15:47.620182 10542 net.cpp:156] Memory required for data: 90020
I0803 21:15:47.620187 10542 layer_factory.hpp:77] Creating layer lstm2_
I0803 21:15:47.620194 10542 net.cpp:91] Creating Layer lstm2_
I0803 21:15:47.620198 10542 net.cpp:425] lstm2_ <- c_1
I0803 21:15:47.620208 10542 net.cpp:399] lstm2_ -> c_T
I0803 21:15:47.620236 10542 net.cpp:141] Setting up lstm2_
I0803 21:15:47.620246 10542 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:15:47.620251 10542 net.cpp:156] Memory required for data: 94020
I0803 21:15:47.620255 10542 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0803 21:15:47.620265 10542 net.cpp:91] Creating Layer lstm2_h_concat
I0803 21:15:47.620270 10542 net.cpp:425] lstm2_h_concat <- h_1
I0803 21:15:47.620275 10542 net.cpp:399] lstm2_h_concat -> h
I0803 21:15:47.620311 10542 net.cpp:141] Setting up lstm2_h_concat
I0803 21:15:47.620319 10542 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:15:47.620324 10542 net.cpp:156] Memory required for data: 98020
I0803 21:15:47.620328 10542 layer_factory.hpp:77] Creating layer h_pseudoloss
I0803 21:15:47.620338 10542 net.cpp:91] Creating Layer h_pseudoloss
I0803 21:15:47.620343 10542 net.cpp:425] h_pseudoloss <- h
I0803 21:15:47.620349 10542 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0803 21:15:47.620440 10542 net.cpp:141] Setting up h_pseudoloss
I0803 21:15:47.620450 10542 net.cpp:148] Top shape: (1)
I0803 21:15:47.620453 10542 net.cpp:151]     with loss weight 1
I0803 21:15:47.620506 10542 net.cpp:156] Memory required for data: 98024
I0803 21:15:47.620512 10542 net.cpp:217] h_pseudoloss needs backward computation.
I0803 21:15:47.620517 10542 net.cpp:217] lstm2_h_concat needs backward computation.
I0803 21:15:47.620522 10542 net.cpp:219] lstm2_ does not need backward computation.
I0803 21:15:47.620527 10542 net.cpp:217] lstm2_unit_1 needs backward computation.
I0803 21:15:47.620535 10542 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0803 21:15:47.620540 10542 net.cpp:217] lstm2_transform_1 needs backward computation.
I0803 21:15:47.620545 10542 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0803 21:15:47.620551 10542 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0803 21:15:47.620555 10542 net.cpp:217] lstm2_x_transform needs backward computation.
I0803 21:15:47.620560 10542 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0803 21:15:47.620565 10542 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0803 21:15:47.620570 10542 net.cpp:219] lstm2_ does not need backward computation.
I0803 21:15:47.620574 10542 net.cpp:219] lstm2_ does not need backward computation.
I0803 21:15:47.620578 10542 net.cpp:261] This network produces output c_T
I0803 21:15:47.620581 10542 net.cpp:261] This network produces output h_pseudoloss
I0803 21:15:47.620596 10542 net.cpp:274] Network initialization done.
I0803 21:15:47.620646 10542 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0803 21:15:47.620653 10542 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0803 21:15:47.620657 10542 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0803 21:15:47.620761 10542 net.cpp:141] Setting up lstm2
I0803 21:15:47.620775 10542 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:15:47.620780 10542 net.cpp:156] Memory required for data: 36412
I0803 21:15:47.620795 10542 layer_factory.hpp:77] Creating layer predict
I0803 21:15:47.620806 10542 net.cpp:91] Creating Layer predict
I0803 21:15:47.620815 10542 net.cpp:425] predict <- lstm2
I0803 21:15:47.620821 10542 net.cpp:399] predict -> predict
I0803 21:15:47.901830 10552 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /tmp/cvld3719170067850430311/bvlc_reference_caffenet.caffemodel
I0803 21:15:47.901886 10552 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0803 21:15:47.901891 10552 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0803 21:15:47.901895 10552 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /tmp/cvld3719170067850430311/bvlc_reference_caffenet.caffemodel
I0803 21:15:48.045524 10542 net.cpp:141] Setting up predict
I0803 21:15:48.045565 10542 net.cpp:148] Top shape: 1 1 46168 (46168)
I0803 21:15:48.045572 10542 net.cpp:156] Memory required for data: 221084
I0803 21:15:48.045585 10542 layer_factory.hpp:77] Creating layer probs
I0803 21:15:48.045600 10542 net.cpp:91] Creating Layer probs
I0803 21:15:48.045608 10542 net.cpp:425] probs <- predict
I0803 21:15:48.045616 10542 net.cpp:399] probs -> probs
I0803 21:15:48.046398 10542 net.cpp:141] Setting up probs
I0803 21:15:48.046411 10542 net.cpp:148] Top shape: 1 1 46168 (46168)
I0803 21:15:48.046416 10542 net.cpp:156] Memory required for data: 405756
I0803 21:15:48.046422 10542 net.cpp:219] probs does not need backward computation.
I0803 21:15:48.046427 10542 net.cpp:219] predict does not need backward computation.
I0803 21:15:48.046432 10542 net.cpp:219] lstm2 does not need backward computation.
I0803 21:15:48.046437 10542 net.cpp:219] concat does not need backward computation.
I0803 21:15:48.046443 10542 net.cpp:219] lstm1 does not need backward computation.
I0803 21:15:48.046450 10542 net.cpp:219] embedding does not need backward computation.
I0803 21:15:48.046457 10542 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0803 21:15:48.046461 10542 net.cpp:219] reshape_frames does not need backward computation.
I0803 21:15:48.046465 10542 net.cpp:219] embed_encoder does not need backward computation.
I0803 21:15:48.046471 10542 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0803 21:15:48.046478 10542 net.cpp:219] input does not need backward computation.
I0803 21:15:48.046481 10542 net.cpp:261] This network produces output probs
I0803 21:15:48.046496 10542 net.cpp:274] Network initialization done.
I0803 21:15:48.255101 10552 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0803 21:15:48.302497 10552 net.cpp:752] Ignoring source layer loss
I0803 21:15:48.348078 10542 net.cpp:752] Ignoring source layer data
I0803 21:15:48.348109 10542 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0803 21:15:48.348114 10542 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0803 21:15:48.434077 10542 net.cpp:752] Ignoring source layer cross_entropy_loss
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/lvnguyen/apache-storm-0.10.1/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/lvnguyen/apache-storm-0.10.1/data/supervisor/stormdist/captioning-1-1470273289/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
2016-08-03 21:15:54,208 ERROR Logger contains an invalid element or attribute "appender"
2016-08-03 21:15:56,960 ERROR Logger contains an invalid element or attribute "appender"
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /tmp/cvld8685409518704790810/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0803 21:16:03.321465 10698 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0803 21:16:03.321687 10698 layer_factory.hpp:77] Creating layer data
I0803 21:16:03.321715 10698 net.cpp:91] Creating Layer data
I0803 21:16:03.321727 10698 net.cpp:399] data -> data
I0803 21:16:03.794754 10698 net.cpp:141] Setting up data
I0803 21:16:03.794909 10698 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0803 21:16:03.794921 10698 net.cpp:156] Memory required for data: 6183480
I0803 21:16:03.794948 10698 layer_factory.hpp:77] Creating layer conv1
I0803 21:16:03.794997 10698 net.cpp:91] Creating Layer conv1
I0803 21:16:03.795014 10698 net.cpp:425] conv1 <- data
I0803 21:16:03.795037 10698 net.cpp:399] conv1 -> conv1
I0803 21:16:03.920176 10688 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /tmp/cvld8685409518704790810/s2vt.words_to_preds.prototxt
I0803 21:16:03.920240 10688 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0803 21:16:03.920254 10688 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0803 21:16:03.920680 10688 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0803 21:16:03.920837 10688 layer_factory.hpp:77] Creating layer input
I0803 21:16:03.920862 10688 net.cpp:91] Creating Layer input
I0803 21:16:03.920878 10688 net.cpp:399] input -> frames_fc7
I0803 21:16:03.920908 10688 net.cpp:399] input -> cont_sentence
I0803 21:16:03.920931 10688 net.cpp:399] input -> input_sentence
I0803 21:16:03.920951 10688 net.cpp:399] input -> stage_indicator
I0803 21:16:03.921277 10688 net.cpp:141] Setting up input
I0803 21:16:03.921299 10688 net.cpp:148] Top shape: 1 4096 (4096)
I0803 21:16:03.921314 10688 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:03.921326 10688 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:03.921339 10688 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:03.921346 10688 net.cpp:156] Memory required for data: 16396
I0803 21:16:03.921357 10688 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0803 21:16:03.921385 10688 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0803 21:16:03.921393 10688 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0803 21:16:03.921421 10688 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0803 21:16:03.921437 10688 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0803 21:16:03.923580 10688 net.cpp:141] Setting up cont_sentence_input_1_split
I0803 21:16:03.923602 10688 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:03.923616 10688 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:03.923625 10688 net.cpp:156] Memory required for data: 16404
I0803 21:16:03.923635 10688 layer_factory.hpp:77] Creating layer embed_encoder
I0803 21:16:03.923661 10688 net.cpp:91] Creating Layer embed_encoder
I0803 21:16:03.923673 10688 net.cpp:425] embed_encoder <- frames_fc7
I0803 21:16:03.923692 10688 net.cpp:399] embed_encoder -> embedded_in_frames
I0803 21:16:03.954430 10688 net.cpp:141] Setting up embed_encoder
I0803 21:16:03.954488 10688 net.cpp:148] Top shape: 1 500 (500)
I0803 21:16:03.954498 10688 net.cpp:156] Memory required for data: 18404
I0803 21:16:03.954540 10688 layer_factory.hpp:77] Creating layer reshape_frames
I0803 21:16:03.954578 10688 net.cpp:91] Creating Layer reshape_frames
I0803 21:16:03.954591 10688 net.cpp:425] reshape_frames <- embedded_in_frames
I0803 21:16:03.954609 10688 net.cpp:399] reshape_frames -> embedded_input_frames
I0803 21:16:03.958416 10688 net.cpp:141] Setting up reshape_frames
I0803 21:16:03.958438 10688 net.cpp:148] Top shape: 1 1 500 (500)
I0803 21:16:03.958447 10688 net.cpp:156] Memory required for data: 20404
I0803 21:16:03.958456 10688 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0803 21:16:03.958474 10688 net.cpp:91] Creating Layer reshape_stage_indicator
I0803 21:16:03.958484 10688 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0803 21:16:03.958499 10688 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0803 21:16:03.961635 10688 net.cpp:141] Setting up reshape_stage_indicator
I0803 21:16:03.961658 10688 net.cpp:148] Top shape: 1 1 1 (1)
I0803 21:16:03.961668 10688 net.cpp:156] Memory required for data: 20408
I0803 21:16:03.961676 10688 layer_factory.hpp:77] Creating layer embedding
I0803 21:16:03.961695 10688 net.cpp:91] Creating Layer embedding
I0803 21:16:03.961706 10688 net.cpp:425] embedding <- input_sentence
I0803 21:16:03.961722 10688 net.cpp:399] embedding -> embedded_input_sentence
I0803 21:16:04.061460 10698 net.cpp:141] Setting up conv1
I0803 21:16:04.061514 10698 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0803 21:16:04.061522 10698 net.cpp:156] Memory required for data: 17799480
I0803 21:16:04.061544 10698 layer_factory.hpp:77] Creating layer relu1
I0803 21:16:04.061573 10698 net.cpp:91] Creating Layer relu1
I0803 21:16:04.061581 10698 net.cpp:425] relu1 <- conv1
I0803 21:16:04.061591 10698 net.cpp:386] relu1 -> conv1 (in-place)
I0803 21:16:04.062018 10698 net.cpp:141] Setting up relu1
I0803 21:16:04.062032 10698 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0803 21:16:04.062038 10698 net.cpp:156] Memory required for data: 29415480
I0803 21:16:04.062044 10698 layer_factory.hpp:77] Creating layer pool1
I0803 21:16:04.062060 10698 net.cpp:91] Creating Layer pool1
I0803 21:16:04.062067 10698 net.cpp:425] pool1 <- conv1
I0803 21:16:04.062075 10698 net.cpp:399] pool1 -> pool1
I0803 21:16:04.062153 10698 net.cpp:141] Setting up pool1
I0803 21:16:04.062165 10698 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0803 21:16:04.062170 10698 net.cpp:156] Memory required for data: 32214840
I0803 21:16:04.062175 10698 layer_factory.hpp:77] Creating layer norm1
I0803 21:16:04.062196 10698 net.cpp:91] Creating Layer norm1
I0803 21:16:04.062206 10698 net.cpp:425] norm1 <- pool1
I0803 21:16:04.062227 10698 net.cpp:399] norm1 -> norm1
I0803 21:16:04.062707 10698 net.cpp:141] Setting up norm1
I0803 21:16:04.062722 10698 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0803 21:16:04.062727 10698 net.cpp:156] Memory required for data: 35014200
I0803 21:16:04.062734 10698 layer_factory.hpp:77] Creating layer conv2
I0803 21:16:04.062754 10698 net.cpp:91] Creating Layer conv2
I0803 21:16:04.062770 10698 net.cpp:425] conv2 <- norm1
I0803 21:16:04.062778 10698 net.cpp:399] conv2 -> conv2
I0803 21:16:04.066311 10698 net.cpp:141] Setting up conv2
I0803 21:16:04.066336 10698 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0803 21:16:04.066342 10698 net.cpp:156] Memory required for data: 42479160
I0803 21:16:04.066356 10698 layer_factory.hpp:77] Creating layer relu2
I0803 21:16:04.066366 10698 net.cpp:91] Creating Layer relu2
I0803 21:16:04.066372 10698 net.cpp:425] relu2 <- conv2
I0803 21:16:04.066380 10698 net.cpp:386] relu2 -> conv2 (in-place)
I0803 21:16:04.066833 10698 net.cpp:141] Setting up relu2
I0803 21:16:04.066848 10698 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0803 21:16:04.066854 10698 net.cpp:156] Memory required for data: 49944120
I0803 21:16:04.066859 10698 layer_factory.hpp:77] Creating layer pool2
I0803 21:16:04.066870 10698 net.cpp:91] Creating Layer pool2
I0803 21:16:04.066875 10698 net.cpp:425] pool2 <- conv2
I0803 21:16:04.066887 10698 net.cpp:399] pool2 -> pool2
I0803 21:16:04.066951 10698 net.cpp:141] Setting up pool2
I0803 21:16:04.066962 10698 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0803 21:16:04.066965 10698 net.cpp:156] Memory required for data: 51674680
I0803 21:16:04.066972 10698 layer_factory.hpp:77] Creating layer norm2
I0803 21:16:04.066987 10698 net.cpp:91] Creating Layer norm2
I0803 21:16:04.066992 10698 net.cpp:425] norm2 <- pool2
I0803 21:16:04.067003 10698 net.cpp:399] norm2 -> norm2
I0803 21:16:04.067293 10698 net.cpp:141] Setting up norm2
I0803 21:16:04.067307 10698 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0803 21:16:04.067312 10698 net.cpp:156] Memory required for data: 53405240
I0803 21:16:04.067317 10698 layer_factory.hpp:77] Creating layer conv3
I0803 21:16:04.067333 10698 net.cpp:91] Creating Layer conv3
I0803 21:16:04.067339 10698 net.cpp:425] conv3 <- norm2
I0803 21:16:04.067349 10698 net.cpp:399] conv3 -> conv3
I0803 21:16:04.071439 10698 net.cpp:141] Setting up conv3
I0803 21:16:04.071460 10698 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0803 21:16:04.071467 10698 net.cpp:156] Memory required for data: 56001080
I0803 21:16:04.071481 10698 layer_factory.hpp:77] Creating layer relu3
I0803 21:16:04.071496 10698 net.cpp:91] Creating Layer relu3
I0803 21:16:04.071502 10698 net.cpp:425] relu3 <- conv3
I0803 21:16:04.071511 10698 net.cpp:386] relu3 -> conv3 (in-place)
I0803 21:16:04.071944 10698 net.cpp:141] Setting up relu3
I0803 21:16:04.071961 10698 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0803 21:16:04.071966 10698 net.cpp:156] Memory required for data: 58596920
I0803 21:16:04.071972 10698 layer_factory.hpp:77] Creating layer conv4
I0803 21:16:04.071991 10698 net.cpp:91] Creating Layer conv4
I0803 21:16:04.071997 10698 net.cpp:425] conv4 <- conv3
I0803 21:16:04.072006 10698 net.cpp:399] conv4 -> conv4
I0803 21:16:04.076364 10698 net.cpp:141] Setting up conv4
I0803 21:16:04.076386 10698 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0803 21:16:04.076392 10698 net.cpp:156] Memory required for data: 61192760
I0803 21:16:04.076403 10698 layer_factory.hpp:77] Creating layer relu4
I0803 21:16:04.076418 10698 net.cpp:91] Creating Layer relu4
I0803 21:16:04.076426 10698 net.cpp:425] relu4 <- conv4
I0803 21:16:04.076433 10698 net.cpp:386] relu4 -> conv4 (in-place)
I0803 21:16:04.076858 10698 net.cpp:141] Setting up relu4
I0803 21:16:04.076871 10698 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0803 21:16:04.076877 10698 net.cpp:156] Memory required for data: 63788600
I0803 21:16:04.076882 10698 layer_factory.hpp:77] Creating layer conv5
I0803 21:16:04.076902 10698 net.cpp:91] Creating Layer conv5
I0803 21:16:04.076908 10698 net.cpp:425] conv5 <- conv4
I0803 21:16:04.076917 10698 net.cpp:399] conv5 -> conv5
I0803 21:16:04.081004 10698 net.cpp:141] Setting up conv5
I0803 21:16:04.081024 10698 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0803 21:16:04.081030 10698 net.cpp:156] Memory required for data: 65519160
I0803 21:16:04.081050 10698 layer_factory.hpp:77] Creating layer relu5
I0803 21:16:04.081060 10698 net.cpp:91] Creating Layer relu5
I0803 21:16:04.081066 10698 net.cpp:425] relu5 <- conv5
I0803 21:16:04.081074 10698 net.cpp:386] relu5 -> conv5 (in-place)
I0803 21:16:04.081528 10698 net.cpp:141] Setting up relu5
I0803 21:16:04.081543 10698 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0803 21:16:04.081552 10698 net.cpp:156] Memory required for data: 67249720
I0803 21:16:04.081558 10698 layer_factory.hpp:77] Creating layer pool5
I0803 21:16:04.081569 10698 net.cpp:91] Creating Layer pool5
I0803 21:16:04.081574 10698 net.cpp:425] pool5 <- conv5
I0803 21:16:04.081583 10698 net.cpp:399] pool5 -> pool5
I0803 21:16:04.081655 10698 net.cpp:141] Setting up pool5
I0803 21:16:04.081671 10698 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0803 21:16:04.081681 10698 net.cpp:156] Memory required for data: 67618360
I0803 21:16:04.081691 10698 layer_factory.hpp:77] Creating layer fc6
I0803 21:16:04.081713 10698 net.cpp:91] Creating Layer fc6
I0803 21:16:04.081720 10698 net.cpp:425] fc6 <- pool5
I0803 21:16:04.081728 10698 net.cpp:399] fc6 -> fc6
I0803 21:16:04.201184 10698 net.cpp:141] Setting up fc6
I0803 21:16:04.201270 10698 net.cpp:148] Top shape: 10 4096 (40960)
I0803 21:16:04.201280 10698 net.cpp:156] Memory required for data: 67782200
I0803 21:16:04.201320 10698 layer_factory.hpp:77] Creating layer relu6
I0803 21:16:04.201342 10698 net.cpp:91] Creating Layer relu6
I0803 21:16:04.201350 10698 net.cpp:425] relu6 <- fc6
I0803 21:16:04.201360 10698 net.cpp:386] relu6 -> fc6 (in-place)
I0803 21:16:04.202555 10698 net.cpp:141] Setting up relu6
I0803 21:16:04.202574 10698 net.cpp:148] Top shape: 10 4096 (40960)
I0803 21:16:04.202579 10698 net.cpp:156] Memory required for data: 67946040
I0803 21:16:04.202585 10698 layer_factory.hpp:77] Creating layer drop6
I0803 21:16:04.202610 10698 net.cpp:91] Creating Layer drop6
I0803 21:16:04.202616 10698 net.cpp:425] drop6 <- fc6
I0803 21:16:04.202627 10698 net.cpp:386] drop6 -> fc6 (in-place)
I0803 21:16:04.202702 10698 net.cpp:141] Setting up drop6
I0803 21:16:04.202713 10698 net.cpp:148] Top shape: 10 4096 (40960)
I0803 21:16:04.202718 10698 net.cpp:156] Memory required for data: 68109880
I0803 21:16:04.202724 10698 layer_factory.hpp:77] Creating layer fc7
I0803 21:16:04.202744 10698 net.cpp:91] Creating Layer fc7
I0803 21:16:04.202750 10698 net.cpp:425] fc7 <- fc6
I0803 21:16:04.202759 10698 net.cpp:399] fc7 -> fc7
I0803 21:16:04.231956 10688 net.cpp:141] Setting up embedding
I0803 21:16:04.232007 10688 net.cpp:148] Top shape: 1 1 500 (500)
I0803 21:16:04.232012 10688 net.cpp:156] Memory required for data: 22408
I0803 21:16:04.232033 10688 layer_factory.hpp:77] Creating layer lstm1
I0803 21:16:04.232131 10688 net.cpp:91] Creating Layer lstm1
I0803 21:16:04.232167 10688 net.cpp:425] lstm1 <- embedded_input_frames
I0803 21:16:04.232180 10688 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0803 21:16:04.232190 10688 net.cpp:399] lstm1 -> lstm1
I0803 21:16:04.232234 10688 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0803 21:16:04.232627 10688 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0803 21:16:04.232723 10688 layer_factory.hpp:77] Creating layer lstm1_
I0803 21:16:04.232738 10688 net.cpp:91] Creating Layer lstm1_
I0803 21:16:04.232744 10688 net.cpp:399] lstm1_ -> x
I0803 21:16:04.232756 10688 net.cpp:399] lstm1_ -> cont
I0803 21:16:04.232873 10688 net.cpp:141] Setting up lstm1_
I0803 21:16:04.232888 10688 net.cpp:148] Top shape: 1 1 500 (500)
I0803 21:16:04.232895 10688 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:04.232899 10688 net.cpp:156] Memory required for data: 2004
I0803 21:16:04.232904 10688 layer_factory.hpp:77] Creating layer lstm1_
I0803 21:16:04.232913 10688 net.cpp:91] Creating Layer lstm1_
I0803 21:16:04.232919 10688 net.cpp:399] lstm1_ -> c_0
I0803 21:16:04.232928 10688 net.cpp:399] lstm1_ -> h_0
I0803 21:16:04.232985 10688 net.cpp:141] Setting up lstm1_
I0803 21:16:04.232995 10688 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:04.233000 10688 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:04.233005 10688 net.cpp:156] Memory required for data: 10004
I0803 21:16:04.233009 10688 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0803 21:16:04.233017 10688 net.cpp:91] Creating Layer lstm1_cont_slice
I0803 21:16:04.233022 10688 net.cpp:425] lstm1_cont_slice <- cont
I0803 21:16:04.233031 10688 net.cpp:399] lstm1_cont_slice -> cont_1
I0803 21:16:04.233072 10688 net.cpp:141] Setting up lstm1_cont_slice
I0803 21:16:04.233081 10688 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:04.233085 10688 net.cpp:156] Memory required for data: 10008
I0803 21:16:04.233089 10688 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0803 21:16:04.233098 10688 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0803 21:16:04.233103 10688 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0803 21:16:04.233108 10688 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0803 21:16:04.233119 10688 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0803 21:16:04.233166 10688 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0803 21:16:04.233175 10688 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:04.233180 10688 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:04.233184 10688 net.cpp:156] Memory required for data: 10016
I0803 21:16:04.233189 10688 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0803 21:16:04.233201 10688 net.cpp:91] Creating Layer lstm1_x_transform
I0803 21:16:04.233206 10688 net.cpp:425] lstm1_x_transform <- x
I0803 21:16:04.233214 10688 net.cpp:399] lstm1_x_transform -> W_xc_x
I0803 21:16:04.249991 10698 net.cpp:141] Setting up fc7
I0803 21:16:04.250044 10698 net.cpp:148] Top shape: 10 4096 (40960)
I0803 21:16:04.250051 10698 net.cpp:156] Memory required for data: 68273720
I0803 21:16:04.250066 10698 layer_factory.hpp:77] Creating layer relu7
I0803 21:16:04.250083 10698 net.cpp:91] Creating Layer relu7
I0803 21:16:04.250090 10698 net.cpp:425] relu7 <- fc7
I0803 21:16:04.250100 10698 net.cpp:386] relu7 -> fc7 (in-place)
I0803 21:16:04.250756 10698 net.cpp:141] Setting up relu7
I0803 21:16:04.250772 10698 net.cpp:148] Top shape: 10 4096 (40960)
I0803 21:16:04.250777 10698 net.cpp:156] Memory required for data: 68437560
I0803 21:16:04.250783 10698 layer_factory.hpp:77] Creating layer drop7
I0803 21:16:04.250793 10698 net.cpp:91] Creating Layer drop7
I0803 21:16:04.250798 10698 net.cpp:425] drop7 <- fc7
I0803 21:16:04.250805 10698 net.cpp:386] drop7 -> fc7 (in-place)
I0803 21:16:04.250847 10698 net.cpp:141] Setting up drop7
I0803 21:16:04.250856 10698 net.cpp:148] Top shape: 10 4096 (40960)
I0803 21:16:04.250860 10698 net.cpp:156] Memory required for data: 68601400
I0803 21:16:04.250865 10698 layer_factory.hpp:77] Creating layer fc8
I0803 21:16:04.250877 10698 net.cpp:91] Creating Layer fc8
I0803 21:16:04.250882 10698 net.cpp:425] fc8 <- fc7
I0803 21:16:04.250890 10698 net.cpp:399] fc8 -> fc8
I0803 21:16:04.258472 10688 net.cpp:141] Setting up lstm1_x_transform
I0803 21:16:04.258530 10688 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:16:04.258536 10688 net.cpp:156] Memory required for data: 26016
I0803 21:16:04.258561 10688 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0803 21:16:04.258579 10688 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0803 21:16:04.258586 10688 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0803 21:16:04.258599 10688 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0803 21:16:04.258646 10688 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0803 21:16:04.258656 10688 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:16:04.258661 10688 net.cpp:156] Memory required for data: 42016
I0803 21:16:04.258664 10688 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0803 21:16:04.258676 10688 net.cpp:91] Creating Layer lstm1_h_conted_0
I0803 21:16:04.258682 10688 net.cpp:425] lstm1_h_conted_0 <- h_0
I0803 21:16:04.258687 10688 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0803 21:16:04.258694 10688 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0803 21:16:04.258796 10688 net.cpp:141] Setting up lstm1_h_conted_0
I0803 21:16:04.258807 10688 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:04.258811 10688 net.cpp:156] Memory required for data: 46016
I0803 21:16:04.258816 10688 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0803 21:16:04.258829 10688 net.cpp:91] Creating Layer lstm1_transform_1
I0803 21:16:04.258834 10688 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0803 21:16:04.258846 10688 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0803 21:16:04.266484 10698 net.cpp:141] Setting up fc8
I0803 21:16:04.266556 10698 net.cpp:148] Top shape: 10 1000 (10000)
I0803 21:16:04.266562 10698 net.cpp:156] Memory required for data: 68641400
I0803 21:16:04.266579 10698 layer_factory.hpp:77] Creating layer prob
I0803 21:16:04.266603 10698 net.cpp:91] Creating Layer prob
I0803 21:16:04.266611 10698 net.cpp:425] prob <- fc8
I0803 21:16:04.266623 10698 net.cpp:399] prob -> prob
I0803 21:16:04.267043 10698 net.cpp:141] Setting up prob
I0803 21:16:04.267058 10698 net.cpp:148] Top shape: 10 1000 (10000)
I0803 21:16:04.267063 10698 net.cpp:156] Memory required for data: 68681400
I0803 21:16:04.267068 10698 net.cpp:219] prob does not need backward computation.
I0803 21:16:04.267074 10698 net.cpp:219] fc8 does not need backward computation.
I0803 21:16:04.267078 10698 net.cpp:219] drop7 does not need backward computation.
I0803 21:16:04.267083 10698 net.cpp:219] relu7 does not need backward computation.
I0803 21:16:04.267087 10698 net.cpp:219] fc7 does not need backward computation.
I0803 21:16:04.267092 10698 net.cpp:219] drop6 does not need backward computation.
I0803 21:16:04.267096 10698 net.cpp:219] relu6 does not need backward computation.
I0803 21:16:04.267101 10698 net.cpp:219] fc6 does not need backward computation.
I0803 21:16:04.267105 10698 net.cpp:219] pool5 does not need backward computation.
I0803 21:16:04.267110 10698 net.cpp:219] relu5 does not need backward computation.
I0803 21:16:04.267138 10698 net.cpp:219] conv5 does not need backward computation.
I0803 21:16:04.267143 10698 net.cpp:219] relu4 does not need backward computation.
I0803 21:16:04.267156 10698 net.cpp:219] conv4 does not need backward computation.
I0803 21:16:04.267163 10698 net.cpp:219] relu3 does not need backward computation.
I0803 21:16:04.267184 10698 net.cpp:219] conv3 does not need backward computation.
I0803 21:16:04.267190 10698 net.cpp:219] norm2 does not need backward computation.
I0803 21:16:04.267196 10698 net.cpp:219] pool2 does not need backward computation.
I0803 21:16:04.267208 10698 net.cpp:219] relu2 does not need backward computation.
I0803 21:16:04.267215 10698 net.cpp:219] conv2 does not need backward computation.
I0803 21:16:04.267220 10698 net.cpp:219] norm1 does not need backward computation.
I0803 21:16:04.267231 10698 net.cpp:219] pool1 does not need backward computation.
I0803 21:16:04.267238 10698 net.cpp:219] relu1 does not need backward computation.
I0803 21:16:04.267244 10698 net.cpp:219] conv1 does not need backward computation.
I0803 21:16:04.267249 10698 net.cpp:219] data does not need backward computation.
I0803 21:16:04.267254 10698 net.cpp:261] This network produces output prob
I0803 21:16:04.267277 10698 net.cpp:274] Network initialization done.
I0803 21:16:04.298557 10688 net.cpp:141] Setting up lstm1_transform_1
I0803 21:16:04.298627 10688 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:16:04.298635 10688 net.cpp:156] Memory required for data: 62016
I0803 21:16:04.298657 10688 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0803 21:16:04.298679 10688 net.cpp:91] Creating Layer lstm1_gate_input_1
I0803 21:16:04.298686 10688 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0803 21:16:04.298694 10688 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0803 21:16:04.298702 10688 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0803 21:16:04.298763 10688 net.cpp:141] Setting up lstm1_gate_input_1
I0803 21:16:04.298774 10688 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:16:04.298777 10688 net.cpp:156] Memory required for data: 78016
I0803 21:16:04.298782 10688 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0803 21:16:04.298794 10688 net.cpp:91] Creating Layer lstm1_unit_1
I0803 21:16:04.298799 10688 net.cpp:425] lstm1_unit_1 <- c_0
I0803 21:16:04.298805 10688 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0803 21:16:04.298810 10688 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0803 21:16:04.298817 10688 net.cpp:399] lstm1_unit_1 -> c_1
I0803 21:16:04.298826 10688 net.cpp:399] lstm1_unit_1 -> h_1
I0803 21:16:04.298889 10688 net.cpp:141] Setting up lstm1_unit_1
I0803 21:16:04.298899 10688 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:04.298904 10688 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:04.298908 10688 net.cpp:156] Memory required for data: 86016
I0803 21:16:04.298913 10688 layer_factory.hpp:77] Creating layer lstm1_
I0803 21:16:04.298921 10688 net.cpp:91] Creating Layer lstm1_
I0803 21:16:04.298926 10688 net.cpp:425] lstm1_ <- c_1
I0803 21:16:04.298933 10688 net.cpp:399] lstm1_ -> c_T
I0803 21:16:04.298964 10688 net.cpp:141] Setting up lstm1_
I0803 21:16:04.298971 10688 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:04.298976 10688 net.cpp:156] Memory required for data: 90016
I0803 21:16:04.298980 10688 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0803 21:16:04.298993 10688 net.cpp:91] Creating Layer lstm1_h_concat
I0803 21:16:04.298998 10688 net.cpp:425] lstm1_h_concat <- h_1
I0803 21:16:04.299005 10688 net.cpp:399] lstm1_h_concat -> h
I0803 21:16:04.299053 10688 net.cpp:141] Setting up lstm1_h_concat
I0803 21:16:04.299062 10688 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:04.299067 10688 net.cpp:156] Memory required for data: 94016
I0803 21:16:04.299070 10688 layer_factory.hpp:77] Creating layer h_pseudoloss
I0803 21:16:04.299085 10688 net.cpp:91] Creating Layer h_pseudoloss
I0803 21:16:04.299090 10688 net.cpp:425] h_pseudoloss <- h
I0803 21:16:04.299099 10688 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0803 21:16:04.299187 10688 net.cpp:141] Setting up h_pseudoloss
I0803 21:16:04.299197 10688 net.cpp:148] Top shape: (1)
I0803 21:16:04.299201 10688 net.cpp:151]     with loss weight 1
I0803 21:16:04.299244 10688 net.cpp:156] Memory required for data: 94020
I0803 21:16:04.299250 10688 net.cpp:217] h_pseudoloss needs backward computation.
I0803 21:16:04.299255 10688 net.cpp:217] lstm1_h_concat needs backward computation.
I0803 21:16:04.299259 10688 net.cpp:219] lstm1_ does not need backward computation.
I0803 21:16:04.299264 10688 net.cpp:217] lstm1_unit_1 needs backward computation.
I0803 21:16:04.299270 10688 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0803 21:16:04.299275 10688 net.cpp:217] lstm1_transform_1 needs backward computation.
I0803 21:16:04.299280 10688 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0803 21:16:04.299286 10688 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0803 21:16:04.299291 10688 net.cpp:217] lstm1_x_transform needs backward computation.
I0803 21:16:04.299296 10688 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0803 21:16:04.299301 10688 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0803 21:16:04.299307 10688 net.cpp:219] lstm1_ does not need backward computation.
I0803 21:16:04.299311 10688 net.cpp:219] lstm1_ does not need backward computation.
I0803 21:16:04.299315 10688 net.cpp:261] This network produces output c_T
I0803 21:16:04.299319 10688 net.cpp:261] This network produces output h_pseudoloss
I0803 21:16:04.299336 10688 net.cpp:274] Network initialization done.
I0803 21:16:04.299391 10688 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0803 21:16:04.299397 10688 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0803 21:16:04.299401 10688 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0803 21:16:04.299509 10688 net.cpp:141] Setting up lstm1
I0803 21:16:04.299520 10688 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:04.299525 10688 net.cpp:156] Memory required for data: 26408
I0803 21:16:04.299537 10688 layer_factory.hpp:77] Creating layer concat
I0803 21:16:04.299546 10688 net.cpp:91] Creating Layer concat
I0803 21:16:04.299552 10688 net.cpp:425] concat <- lstm1
I0803 21:16:04.299559 10688 net.cpp:425] concat <- embedded_input_sentence
I0803 21:16:04.299564 10688 net.cpp:425] concat <- reshaped_stage_indicator
I0803 21:16:04.299571 10688 net.cpp:399] concat -> lstm1_video_sequence
I0803 21:16:04.299604 10688 net.cpp:141] Setting up concat
I0803 21:16:04.299613 10688 net.cpp:148] Top shape: 1 1 1501 (1501)
I0803 21:16:04.299618 10688 net.cpp:156] Memory required for data: 32412
I0803 21:16:04.299623 10688 layer_factory.hpp:77] Creating layer lstm2
I0803 21:16:04.299635 10688 net.cpp:91] Creating Layer lstm2
I0803 21:16:04.299640 10688 net.cpp:425] lstm2 <- lstm1_video_sequence
I0803 21:16:04.299646 10688 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0803 21:16:04.299654 10688 net.cpp:399] lstm2 -> lstm2
I0803 21:16:04.299665 10688 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0803 21:16:04.299919 10688 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0803 21:16:04.300007 10688 layer_factory.hpp:77] Creating layer lstm2_
I0803 21:16:04.300019 10688 net.cpp:91] Creating Layer lstm2_
I0803 21:16:04.300025 10688 net.cpp:399] lstm2_ -> x
I0803 21:16:04.300036 10688 net.cpp:399] lstm2_ -> cont
I0803 21:16:04.300091 10688 net.cpp:141] Setting up lstm2_
I0803 21:16:04.300099 10688 net.cpp:148] Top shape: 1 1 1501 (1501)
I0803 21:16:04.300106 10688 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:04.300109 10688 net.cpp:156] Memory required for data: 6008
I0803 21:16:04.300114 10688 layer_factory.hpp:77] Creating layer lstm2_
I0803 21:16:04.300122 10688 net.cpp:91] Creating Layer lstm2_
I0803 21:16:04.300128 10688 net.cpp:399] lstm2_ -> c_0
I0803 21:16:04.300137 10688 net.cpp:399] lstm2_ -> h_0
I0803 21:16:04.300186 10688 net.cpp:141] Setting up lstm2_
I0803 21:16:04.300196 10688 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:04.300201 10688 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:04.300205 10688 net.cpp:156] Memory required for data: 14008
I0803 21:16:04.300209 10688 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0803 21:16:04.300218 10688 net.cpp:91] Creating Layer lstm2_cont_slice
I0803 21:16:04.300222 10688 net.cpp:425] lstm2_cont_slice <- cont
I0803 21:16:04.300231 10688 net.cpp:399] lstm2_cont_slice -> cont_1
I0803 21:16:04.300264 10688 net.cpp:141] Setting up lstm2_cont_slice
I0803 21:16:04.300273 10688 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:04.300277 10688 net.cpp:156] Memory required for data: 14012
I0803 21:16:04.300282 10688 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0803 21:16:04.300288 10688 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0803 21:16:04.300293 10688 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0803 21:16:04.300299 10688 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0803 21:16:04.300310 10688 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0803 21:16:04.300369 10688 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0803 21:16:04.300380 10688 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:04.300386 10688 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:04.300390 10688 net.cpp:156] Memory required for data: 14020
I0803 21:16:04.300395 10688 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0803 21:16:04.300407 10688 net.cpp:91] Creating Layer lstm2_x_transform
I0803 21:16:04.300412 10688 net.cpp:425] lstm2_x_transform <- x
I0803 21:16:04.300420 10688 net.cpp:399] lstm2_x_transform -> W_xc_x
I0803 21:16:04.356663 10688 net.cpp:141] Setting up lstm2_x_transform
I0803 21:16:04.356737 10688 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:16:04.356745 10688 net.cpp:156] Memory required for data: 30020
I0803 21:16:04.356770 10688 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0803 21:16:04.356792 10688 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0803 21:16:04.356801 10688 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0803 21:16:04.356811 10688 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0803 21:16:04.356858 10688 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0803 21:16:04.356868 10688 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:16:04.356873 10688 net.cpp:156] Memory required for data: 46020
I0803 21:16:04.356878 10688 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0803 21:16:04.356889 10688 net.cpp:91] Creating Layer lstm2_h_conted_0
I0803 21:16:04.356894 10688 net.cpp:425] lstm2_h_conted_0 <- h_0
I0803 21:16:04.356901 10688 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0803 21:16:04.356911 10688 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0803 21:16:04.357005 10688 net.cpp:141] Setting up lstm2_h_conted_0
I0803 21:16:04.357017 10688 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:04.357020 10688 net.cpp:156] Memory required for data: 50020
I0803 21:16:04.357025 10688 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0803 21:16:04.357040 10688 net.cpp:91] Creating Layer lstm2_transform_1
I0803 21:16:04.357045 10688 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0803 21:16:04.357053 10688 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0803 21:16:04.394327 10688 net.cpp:141] Setting up lstm2_transform_1
I0803 21:16:04.394397 10688 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:16:04.394403 10688 net.cpp:156] Memory required for data: 66020
I0803 21:16:04.394428 10688 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0803 21:16:04.394454 10688 net.cpp:91] Creating Layer lstm2_gate_input_1
I0803 21:16:04.394461 10688 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0803 21:16:04.394470 10688 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0803 21:16:04.394480 10688 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0803 21:16:04.394531 10688 net.cpp:141] Setting up lstm2_gate_input_1
I0803 21:16:04.394541 10688 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:16:04.394544 10688 net.cpp:156] Memory required for data: 82020
I0803 21:16:04.394549 10688 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0803 21:16:04.394561 10688 net.cpp:91] Creating Layer lstm2_unit_1
I0803 21:16:04.394567 10688 net.cpp:425] lstm2_unit_1 <- c_0
I0803 21:16:04.394572 10688 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0803 21:16:04.394578 10688 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0803 21:16:04.394587 10688 net.cpp:399] lstm2_unit_1 -> c_1
I0803 21:16:04.394598 10688 net.cpp:399] lstm2_unit_1 -> h_1
I0803 21:16:04.394667 10688 net.cpp:141] Setting up lstm2_unit_1
I0803 21:16:04.394677 10688 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:04.394683 10688 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:04.394687 10688 net.cpp:156] Memory required for data: 90020
I0803 21:16:04.394692 10688 layer_factory.hpp:77] Creating layer lstm2_
I0803 21:16:04.394701 10688 net.cpp:91] Creating Layer lstm2_
I0803 21:16:04.394706 10688 net.cpp:425] lstm2_ <- c_1
I0803 21:16:04.394714 10688 net.cpp:399] lstm2_ -> c_T
I0803 21:16:04.394747 10688 net.cpp:141] Setting up lstm2_
I0803 21:16:04.394754 10688 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:04.394759 10688 net.cpp:156] Memory required for data: 94020
I0803 21:16:04.394763 10688 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0803 21:16:04.394773 10688 net.cpp:91] Creating Layer lstm2_h_concat
I0803 21:16:04.394778 10688 net.cpp:425] lstm2_h_concat <- h_1
I0803 21:16:04.394785 10688 net.cpp:399] lstm2_h_concat -> h
I0803 21:16:04.394821 10688 net.cpp:141] Setting up lstm2_h_concat
I0803 21:16:04.394829 10688 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:04.394834 10688 net.cpp:156] Memory required for data: 98020
I0803 21:16:04.394839 10688 layer_factory.hpp:77] Creating layer h_pseudoloss
I0803 21:16:04.394848 10688 net.cpp:91] Creating Layer h_pseudoloss
I0803 21:16:04.394853 10688 net.cpp:425] h_pseudoloss <- h
I0803 21:16:04.394860 10688 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0803 21:16:04.394945 10688 net.cpp:141] Setting up h_pseudoloss
I0803 21:16:04.394956 10688 net.cpp:148] Top shape: (1)
I0803 21:16:04.394960 10688 net.cpp:151]     with loss weight 1
I0803 21:16:04.394982 10688 net.cpp:156] Memory required for data: 98024
I0803 21:16:04.394989 10688 net.cpp:217] h_pseudoloss needs backward computation.
I0803 21:16:04.394992 10688 net.cpp:217] lstm2_h_concat needs backward computation.
I0803 21:16:04.394997 10688 net.cpp:219] lstm2_ does not need backward computation.
I0803 21:16:04.395002 10688 net.cpp:217] lstm2_unit_1 needs backward computation.
I0803 21:16:04.395010 10688 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0803 21:16:04.395016 10688 net.cpp:217] lstm2_transform_1 needs backward computation.
I0803 21:16:04.395021 10688 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0803 21:16:04.395027 10688 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0803 21:16:04.395032 10688 net.cpp:217] lstm2_x_transform needs backward computation.
I0803 21:16:04.395037 10688 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0803 21:16:04.395042 10688 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0803 21:16:04.395048 10688 net.cpp:219] lstm2_ does not need backward computation.
I0803 21:16:04.395052 10688 net.cpp:219] lstm2_ does not need backward computation.
I0803 21:16:04.395056 10688 net.cpp:261] This network produces output c_T
I0803 21:16:04.395061 10688 net.cpp:261] This network produces output h_pseudoloss
I0803 21:16:04.395076 10688 net.cpp:274] Network initialization done.
I0803 21:16:04.395124 10688 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0803 21:16:04.395131 10688 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0803 21:16:04.395135 10688 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0803 21:16:04.395239 10688 net.cpp:141] Setting up lstm2
I0803 21:16:04.395251 10688 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:04.395256 10688 net.cpp:156] Memory required for data: 36412
I0803 21:16:04.395269 10688 layer_factory.hpp:77] Creating layer predict
I0803 21:16:04.395283 10688 net.cpp:91] Creating Layer predict
I0803 21:16:04.395289 10688 net.cpp:425] predict <- lstm2
I0803 21:16:04.395297 10688 net.cpp:399] predict -> predict
I0803 21:16:04.540107 10698 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /tmp/cvld8685409518704790810/bvlc_reference_caffenet.caffemodel
I0803 21:16:04.540171 10698 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0803 21:16:04.540179 10698 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0803 21:16:04.540182 10698 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /tmp/cvld8685409518704790810/bvlc_reference_caffenet.caffemodel
I0803 21:16:04.811321 10688 net.cpp:141] Setting up predict
I0803 21:16:04.811389 10688 net.cpp:148] Top shape: 1 1 46168 (46168)
I0803 21:16:04.811396 10688 net.cpp:156] Memory required for data: 221084
I0803 21:16:04.811415 10688 layer_factory.hpp:77] Creating layer probs
I0803 21:16:04.811437 10688 net.cpp:91] Creating Layer probs
I0803 21:16:04.811447 10688 net.cpp:425] probs <- predict
I0803 21:16:04.811460 10688 net.cpp:399] probs -> probs
I0803 21:16:04.812336 10688 net.cpp:141] Setting up probs
I0803 21:16:04.812353 10688 net.cpp:148] Top shape: 1 1 46168 (46168)
I0803 21:16:04.812358 10688 net.cpp:156] Memory required for data: 405756
I0803 21:16:04.812363 10688 net.cpp:219] probs does not need backward computation.
I0803 21:16:04.812368 10688 net.cpp:219] predict does not need backward computation.
I0803 21:16:04.812376 10688 net.cpp:219] lstm2 does not need backward computation.
I0803 21:16:04.812383 10688 net.cpp:219] concat does not need backward computation.
I0803 21:16:04.812389 10688 net.cpp:219] lstm1 does not need backward computation.
I0803 21:16:04.812397 10688 net.cpp:219] embedding does not need backward computation.
I0803 21:16:04.812402 10688 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0803 21:16:04.812409 10688 net.cpp:219] reshape_frames does not need backward computation.
I0803 21:16:04.812414 10688 net.cpp:219] embed_encoder does not need backward computation.
I0803 21:16:04.812420 10688 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0803 21:16:04.812427 10688 net.cpp:219] input does not need backward computation.
I0803 21:16:04.812430 10688 net.cpp:261] This network produces output probs
I0803 21:16:04.812448 10688 net.cpp:274] Network initialization done.
I0803 21:16:04.903739 10698 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0803 21:16:04.957746 10698 net.cpp:752] Ignoring source layer loss
I0803 21:16:05.151212 10688 net.cpp:752] Ignoring source layer data
I0803 21:16:05.151254 10688 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0803 21:16:05.151259 10688 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0803 21:16:05.253573 10688 net.cpp:752] Ignoring source layer cross_entropy_loss
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/lvnguyen/apache-storm-0.10.1/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/lvnguyen/apache-storm-0.10.1/data/supervisor/stormdist/captioning-1-1470273289/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
2016-08-03 21:16:09,236 ERROR Logger contains an invalid element or attribute "appender"
2016-08-03 21:16:12,272 ERROR Logger contains an invalid element or attribute "appender"
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /tmp/cvld704079848739473924/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0803 21:16:23.015712 10839 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0803 21:16:23.015983 10839 layer_factory.hpp:77] Creating layer data
I0803 21:16:23.016011 10839 net.cpp:91] Creating Layer data
I0803 21:16:23.016022 10839 net.cpp:399] data -> data
I0803 21:16:23.599812 10839 net.cpp:141] Setting up data
I0803 21:16:23.599931 10839 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0803 21:16:23.599941 10839 net.cpp:156] Memory required for data: 6183480
I0803 21:16:23.599964 10839 layer_factory.hpp:77] Creating layer conv1
I0803 21:16:23.600003 10839 net.cpp:91] Creating Layer conv1
I0803 21:16:23.600014 10839 net.cpp:425] conv1 <- data
I0803 21:16:23.600031 10839 net.cpp:399] conv1 -> conv1
I0803 21:16:23.775251 10829 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /tmp/cvld704079848739473924/s2vt.words_to_preds.prototxt
I0803 21:16:23.775315 10829 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0803 21:16:23.775326 10829 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0803 21:16:23.775635 10829 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0803 21:16:23.775753 10829 layer_factory.hpp:77] Creating layer input
I0803 21:16:23.775770 10829 net.cpp:91] Creating Layer input
I0803 21:16:23.775779 10829 net.cpp:399] input -> frames_fc7
I0803 21:16:23.775801 10829 net.cpp:399] input -> cont_sentence
I0803 21:16:23.775813 10829 net.cpp:399] input -> input_sentence
I0803 21:16:23.775825 10829 net.cpp:399] input -> stage_indicator
I0803 21:16:23.783635 10829 net.cpp:141] Setting up input
I0803 21:16:23.783658 10829 net.cpp:148] Top shape: 1 4096 (4096)
I0803 21:16:23.783666 10829 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:23.783673 10829 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:23.783679 10829 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:23.783684 10829 net.cpp:156] Memory required for data: 16396
I0803 21:16:23.783689 10829 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0803 21:16:23.783711 10829 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0803 21:16:23.783718 10829 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0803 21:16:23.783741 10829 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0803 21:16:23.783754 10829 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0803 21:16:23.783836 10829 net.cpp:141] Setting up cont_sentence_input_1_split
I0803 21:16:23.783849 10829 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:23.783854 10829 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:23.783859 10829 net.cpp:156] Memory required for data: 16404
I0803 21:16:23.783864 10829 layer_factory.hpp:77] Creating layer embed_encoder
I0803 21:16:23.783882 10829 net.cpp:91] Creating Layer embed_encoder
I0803 21:16:23.783890 10829 net.cpp:425] embed_encoder <- frames_fc7
I0803 21:16:23.783898 10829 net.cpp:399] embed_encoder -> embedded_in_frames
I0803 21:16:23.812729 10829 net.cpp:141] Setting up embed_encoder
I0803 21:16:23.812780 10829 net.cpp:148] Top shape: 1 500 (500)
I0803 21:16:23.812786 10829 net.cpp:156] Memory required for data: 18404
I0803 21:16:23.812820 10829 layer_factory.hpp:77] Creating layer reshape_frames
I0803 21:16:23.812854 10829 net.cpp:91] Creating Layer reshape_frames
I0803 21:16:23.812862 10829 net.cpp:425] reshape_frames <- embedded_in_frames
I0803 21:16:23.812875 10829 net.cpp:399] reshape_frames -> embedded_input_frames
I0803 21:16:23.814743 10829 net.cpp:141] Setting up reshape_frames
I0803 21:16:23.814767 10829 net.cpp:148] Top shape: 1 1 500 (500)
I0803 21:16:23.814774 10829 net.cpp:156] Memory required for data: 20404
I0803 21:16:23.814779 10829 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0803 21:16:23.814797 10829 net.cpp:91] Creating Layer reshape_stage_indicator
I0803 21:16:23.814805 10829 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0803 21:16:23.814815 10829 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0803 21:16:23.818760 10829 net.cpp:141] Setting up reshape_stage_indicator
I0803 21:16:23.818788 10829 net.cpp:148] Top shape: 1 1 1 (1)
I0803 21:16:23.818794 10829 net.cpp:156] Memory required for data: 20408
I0803 21:16:23.818799 10829 layer_factory.hpp:77] Creating layer embedding
I0803 21:16:23.818816 10829 net.cpp:91] Creating Layer embedding
I0803 21:16:23.818822 10829 net.cpp:425] embedding <- input_sentence
I0803 21:16:23.818836 10829 net.cpp:399] embedding -> embedded_input_sentence
I0803 21:16:23.883873 10839 net.cpp:141] Setting up conv1
I0803 21:16:23.883930 10839 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0803 21:16:23.883937 10839 net.cpp:156] Memory required for data: 17799480
I0803 21:16:23.883963 10839 layer_factory.hpp:77] Creating layer relu1
I0803 21:16:23.883985 10839 net.cpp:91] Creating Layer relu1
I0803 21:16:23.883993 10839 net.cpp:425] relu1 <- conv1
I0803 21:16:23.884002 10839 net.cpp:386] relu1 -> conv1 (in-place)
I0803 21:16:23.884413 10839 net.cpp:141] Setting up relu1
I0803 21:16:23.884428 10839 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0803 21:16:23.884433 10839 net.cpp:156] Memory required for data: 29415480
I0803 21:16:23.884438 10839 layer_factory.hpp:77] Creating layer pool1
I0803 21:16:23.884454 10839 net.cpp:91] Creating Layer pool1
I0803 21:16:23.884459 10839 net.cpp:425] pool1 <- conv1
I0803 21:16:23.884467 10839 net.cpp:399] pool1 -> pool1
I0803 21:16:23.884542 10839 net.cpp:141] Setting up pool1
I0803 21:16:23.884554 10839 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0803 21:16:23.884559 10839 net.cpp:156] Memory required for data: 32214840
I0803 21:16:23.884564 10839 layer_factory.hpp:77] Creating layer norm1
I0803 21:16:23.884583 10839 net.cpp:91] Creating Layer norm1
I0803 21:16:23.884589 10839 net.cpp:425] norm1 <- pool1
I0803 21:16:23.884598 10839 net.cpp:399] norm1 -> norm1
I0803 21:16:23.885051 10839 net.cpp:141] Setting up norm1
I0803 21:16:23.885066 10839 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0803 21:16:23.885072 10839 net.cpp:156] Memory required for data: 35014200
I0803 21:16:23.885078 10839 layer_factory.hpp:77] Creating layer conv2
I0803 21:16:23.885095 10839 net.cpp:91] Creating Layer conv2
I0803 21:16:23.885102 10839 net.cpp:425] conv2 <- norm1
I0803 21:16:23.885109 10839 net.cpp:399] conv2 -> conv2
I0803 21:16:23.888324 10839 net.cpp:141] Setting up conv2
I0803 21:16:23.888345 10839 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0803 21:16:23.888351 10839 net.cpp:156] Memory required for data: 42479160
I0803 21:16:23.888366 10839 layer_factory.hpp:77] Creating layer relu2
I0803 21:16:23.888377 10839 net.cpp:91] Creating Layer relu2
I0803 21:16:23.888383 10839 net.cpp:425] relu2 <- conv2
I0803 21:16:23.888391 10839 net.cpp:386] relu2 -> conv2 (in-place)
I0803 21:16:23.888803 10839 net.cpp:141] Setting up relu2
I0803 21:16:23.888818 10839 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0803 21:16:23.888823 10839 net.cpp:156] Memory required for data: 49944120
I0803 21:16:23.888828 10839 layer_factory.hpp:77] Creating layer pool2
I0803 21:16:23.888839 10839 net.cpp:91] Creating Layer pool2
I0803 21:16:23.888844 10839 net.cpp:425] pool2 <- conv2
I0803 21:16:23.888852 10839 net.cpp:399] pool2 -> pool2
I0803 21:16:23.888911 10839 net.cpp:141] Setting up pool2
I0803 21:16:23.888921 10839 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0803 21:16:23.888926 10839 net.cpp:156] Memory required for data: 51674680
I0803 21:16:23.888931 10839 layer_factory.hpp:77] Creating layer norm2
I0803 21:16:23.888943 10839 net.cpp:91] Creating Layer norm2
I0803 21:16:23.888948 10839 net.cpp:425] norm2 <- pool2
I0803 21:16:23.888957 10839 net.cpp:399] norm2 -> norm2
I0803 21:16:23.889225 10839 net.cpp:141] Setting up norm2
I0803 21:16:23.889246 10839 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0803 21:16:23.889252 10839 net.cpp:156] Memory required for data: 53405240
I0803 21:16:23.889257 10839 layer_factory.hpp:77] Creating layer conv3
I0803 21:16:23.889271 10839 net.cpp:91] Creating Layer conv3
I0803 21:16:23.889276 10839 net.cpp:425] conv3 <- norm2
I0803 21:16:23.889284 10839 net.cpp:399] conv3 -> conv3
I0803 21:16:23.893223 10839 net.cpp:141] Setting up conv3
I0803 21:16:23.893254 10839 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0803 21:16:23.893260 10839 net.cpp:156] Memory required for data: 56001080
I0803 21:16:23.893275 10839 layer_factory.hpp:77] Creating layer relu3
I0803 21:16:23.893285 10839 net.cpp:91] Creating Layer relu3
I0803 21:16:23.893291 10839 net.cpp:425] relu3 <- conv3
I0803 21:16:23.893298 10839 net.cpp:386] relu3 -> conv3 (in-place)
I0803 21:16:23.893723 10839 net.cpp:141] Setting up relu3
I0803 21:16:23.893738 10839 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0803 21:16:23.893743 10839 net.cpp:156] Memory required for data: 58596920
I0803 21:16:23.893748 10839 layer_factory.hpp:77] Creating layer conv4
I0803 21:16:23.893764 10839 net.cpp:91] Creating Layer conv4
I0803 21:16:23.893769 10839 net.cpp:425] conv4 <- conv3
I0803 21:16:23.893777 10839 net.cpp:399] conv4 -> conv4
I0803 21:16:23.897996 10839 net.cpp:141] Setting up conv4
I0803 21:16:23.898018 10839 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0803 21:16:23.898025 10839 net.cpp:156] Memory required for data: 61192760
I0803 21:16:23.898035 10839 layer_factory.hpp:77] Creating layer relu4
I0803 21:16:23.898046 10839 net.cpp:91] Creating Layer relu4
I0803 21:16:23.898051 10839 net.cpp:425] relu4 <- conv4
I0803 21:16:23.898059 10839 net.cpp:386] relu4 -> conv4 (in-place)
I0803 21:16:23.898488 10839 net.cpp:141] Setting up relu4
I0803 21:16:23.898501 10839 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0803 21:16:23.898506 10839 net.cpp:156] Memory required for data: 63788600
I0803 21:16:23.898512 10839 layer_factory.hpp:77] Creating layer conv5
I0803 21:16:23.898528 10839 net.cpp:91] Creating Layer conv5
I0803 21:16:23.898535 10839 net.cpp:425] conv5 <- conv4
I0803 21:16:23.898542 10839 net.cpp:399] conv5 -> conv5
I0803 21:16:23.902561 10839 net.cpp:141] Setting up conv5
I0803 21:16:23.902582 10839 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0803 21:16:23.902587 10839 net.cpp:156] Memory required for data: 65519160
I0803 21:16:23.902602 10839 layer_factory.hpp:77] Creating layer relu5
I0803 21:16:23.902617 10839 net.cpp:91] Creating Layer relu5
I0803 21:16:23.902624 10839 net.cpp:425] relu5 <- conv5
I0803 21:16:23.902631 10839 net.cpp:386] relu5 -> conv5 (in-place)
I0803 21:16:23.903072 10839 net.cpp:141] Setting up relu5
I0803 21:16:23.903087 10839 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0803 21:16:23.903092 10839 net.cpp:156] Memory required for data: 67249720
I0803 21:16:23.903097 10839 layer_factory.hpp:77] Creating layer pool5
I0803 21:16:23.903113 10839 net.cpp:91] Creating Layer pool5
I0803 21:16:23.903120 10839 net.cpp:425] pool5 <- conv5
I0803 21:16:23.903129 10839 net.cpp:399] pool5 -> pool5
I0803 21:16:23.903197 10839 net.cpp:141] Setting up pool5
I0803 21:16:23.903208 10839 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0803 21:16:23.903213 10839 net.cpp:156] Memory required for data: 67618360
I0803 21:16:23.903218 10839 layer_factory.hpp:77] Creating layer fc6
I0803 21:16:23.903234 10839 net.cpp:91] Creating Layer fc6
I0803 21:16:23.903240 10839 net.cpp:425] fc6 <- pool5
I0803 21:16:23.903247 10839 net.cpp:399] fc6 -> fc6
I0803 21:16:24.014379 10839 net.cpp:141] Setting up fc6
I0803 21:16:24.014436 10839 net.cpp:148] Top shape: 10 4096 (40960)
I0803 21:16:24.014446 10839 net.cpp:156] Memory required for data: 67782200
I0803 21:16:24.014470 10839 layer_factory.hpp:77] Creating layer relu6
I0803 21:16:24.014494 10839 net.cpp:91] Creating Layer relu6
I0803 21:16:24.014508 10839 net.cpp:425] relu6 <- fc6
I0803 21:16:24.014528 10839 net.cpp:386] relu6 -> fc6 (in-place)
I0803 21:16:24.015035 10839 net.cpp:141] Setting up relu6
I0803 21:16:24.015058 10839 net.cpp:148] Top shape: 10 4096 (40960)
I0803 21:16:24.015069 10839 net.cpp:156] Memory required for data: 67946040
I0803 21:16:24.015079 10839 layer_factory.hpp:77] Creating layer drop6
I0803 21:16:24.015113 10839 net.cpp:91] Creating Layer drop6
I0803 21:16:24.015126 10839 net.cpp:425] drop6 <- fc6
I0803 21:16:24.015148 10839 net.cpp:386] drop6 -> fc6 (in-place)
I0803 21:16:24.015233 10839 net.cpp:141] Setting up drop6
I0803 21:16:24.015254 10839 net.cpp:148] Top shape: 10 4096 (40960)
I0803 21:16:24.015264 10839 net.cpp:156] Memory required for data: 68109880
I0803 21:16:24.015274 10839 layer_factory.hpp:77] Creating layer fc7
I0803 21:16:24.015292 10839 net.cpp:91] Creating Layer fc7
I0803 21:16:24.015303 10839 net.cpp:425] fc7 <- fc6
I0803 21:16:24.015319 10839 net.cpp:399] fc7 -> fc7
I0803 21:16:24.065598 10829 net.cpp:141] Setting up embedding
I0803 21:16:24.065666 10829 net.cpp:148] Top shape: 1 1 500 (500)
I0803 21:16:24.065672 10829 net.cpp:156] Memory required for data: 22408
I0803 21:16:24.065695 10829 layer_factory.hpp:77] Creating layer lstm1
I0803 21:16:24.065733 10829 net.cpp:91] Creating Layer lstm1
I0803 21:16:24.065743 10829 net.cpp:425] lstm1 <- embedded_input_frames
I0803 21:16:24.065753 10829 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0803 21:16:24.065763 10829 net.cpp:399] lstm1 -> lstm1
I0803 21:16:24.065798 10829 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0803 21:16:24.066251 10829 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0803 21:16:24.066362 10829 layer_factory.hpp:77] Creating layer lstm1_
I0803 21:16:24.066377 10829 net.cpp:91] Creating Layer lstm1_
I0803 21:16:24.066383 10829 net.cpp:399] lstm1_ -> x
I0803 21:16:24.066396 10829 net.cpp:399] lstm1_ -> cont
I0803 21:16:24.066467 10829 net.cpp:141] Setting up lstm1_
I0803 21:16:24.066478 10829 net.cpp:148] Top shape: 1 1 500 (500)
I0803 21:16:24.066484 10829 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:24.066489 10829 net.cpp:156] Memory required for data: 2004
I0803 21:16:24.066494 10829 layer_factory.hpp:77] Creating layer lstm1_
I0803 21:16:24.066507 10829 net.cpp:91] Creating Layer lstm1_
I0803 21:16:24.066514 10829 net.cpp:399] lstm1_ -> c_0
I0803 21:16:24.066527 10829 net.cpp:399] lstm1_ -> h_0
I0803 21:16:24.066581 10829 net.cpp:141] Setting up lstm1_
I0803 21:16:24.066591 10829 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:24.066596 10829 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:24.066601 10829 net.cpp:156] Memory required for data: 10004
I0803 21:16:24.066606 10829 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0803 21:16:24.066618 10829 net.cpp:91] Creating Layer lstm1_cont_slice
I0803 21:16:24.066624 10829 net.cpp:425] lstm1_cont_slice <- cont
I0803 21:16:24.066632 10829 net.cpp:399] lstm1_cont_slice -> cont_1
I0803 21:16:24.066676 10829 net.cpp:141] Setting up lstm1_cont_slice
I0803 21:16:24.066687 10829 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:24.066691 10829 net.cpp:156] Memory required for data: 10008
I0803 21:16:24.066696 10829 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0803 21:16:24.066705 10829 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0803 21:16:24.066710 10829 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0803 21:16:24.066720 10829 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0803 21:16:24.066730 10829 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0803 21:16:24.066781 10829 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0803 21:16:24.066793 10829 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:24.066799 10829 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:24.066804 10829 net.cpp:156] Memory required for data: 10016
I0803 21:16:24.066809 10829 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0803 21:16:24.066819 10829 net.cpp:91] Creating Layer lstm1_x_transform
I0803 21:16:24.066824 10829 net.cpp:425] lstm1_x_transform <- x
I0803 21:16:24.066835 10829 net.cpp:399] lstm1_x_transform -> W_xc_x
I0803 21:16:24.071554 10839 net.cpp:141] Setting up fc7
I0803 21:16:24.071591 10839 net.cpp:148] Top shape: 10 4096 (40960)
I0803 21:16:24.071605 10839 net.cpp:156] Memory required for data: 68273720
I0803 21:16:24.071630 10839 layer_factory.hpp:77] Creating layer relu7
I0803 21:16:24.071663 10839 net.cpp:91] Creating Layer relu7
I0803 21:16:24.071677 10839 net.cpp:425] relu7 <- fc7
I0803 21:16:24.071696 10839 net.cpp:386] relu7 -> fc7 (in-place)
I0803 21:16:24.072546 10839 net.cpp:141] Setting up relu7
I0803 21:16:24.072569 10839 net.cpp:148] Top shape: 10 4096 (40960)
I0803 21:16:24.072582 10839 net.cpp:156] Memory required for data: 68437560
I0803 21:16:24.072592 10839 layer_factory.hpp:77] Creating layer drop7
I0803 21:16:24.072619 10839 net.cpp:91] Creating Layer drop7
I0803 21:16:24.072633 10839 net.cpp:425] drop7 <- fc7
I0803 21:16:24.072659 10839 net.cpp:386] drop7 -> fc7 (in-place)
I0803 21:16:24.072728 10839 net.cpp:141] Setting up drop7
I0803 21:16:24.072746 10839 net.cpp:148] Top shape: 10 4096 (40960)
I0803 21:16:24.072757 10839 net.cpp:156] Memory required for data: 68601400
I0803 21:16:24.072768 10839 layer_factory.hpp:77] Creating layer fc8
I0803 21:16:24.072785 10839 net.cpp:91] Creating Layer fc8
I0803 21:16:24.072796 10839 net.cpp:425] fc8 <- fc7
I0803 21:16:24.072820 10839 net.cpp:399] fc8 -> fc8
I0803 21:16:24.088246 10829 net.cpp:141] Setting up lstm1_x_transform
I0803 21:16:24.088297 10829 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:16:24.088304 10829 net.cpp:156] Memory required for data: 26016
I0803 21:16:24.088326 10829 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0803 21:16:24.088345 10829 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0803 21:16:24.088352 10829 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0803 21:16:24.088362 10829 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0803 21:16:24.088410 10829 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0803 21:16:24.088421 10829 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:16:24.088426 10829 net.cpp:156] Memory required for data: 42016
I0803 21:16:24.088431 10829 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0803 21:16:24.088445 10829 net.cpp:91] Creating Layer lstm1_h_conted_0
I0803 21:16:24.088451 10829 net.cpp:425] lstm1_h_conted_0 <- h_0
I0803 21:16:24.088459 10829 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0803 21:16:24.088466 10829 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0803 21:16:24.088568 10829 net.cpp:141] Setting up lstm1_h_conted_0
I0803 21:16:24.088579 10829 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:24.088584 10829 net.cpp:156] Memory required for data: 46016
I0803 21:16:24.088589 10829 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0803 21:16:24.088606 10829 net.cpp:91] Creating Layer lstm1_transform_1
I0803 21:16:24.088611 10829 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0803 21:16:24.088620 10829 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0803 21:16:24.097208 10839 net.cpp:141] Setting up fc8
I0803 21:16:24.097283 10839 net.cpp:148] Top shape: 10 1000 (10000)
I0803 21:16:24.097297 10839 net.cpp:156] Memory required for data: 68641400
I0803 21:16:24.097327 10839 layer_factory.hpp:77] Creating layer prob
I0803 21:16:24.097355 10839 net.cpp:91] Creating Layer prob
I0803 21:16:24.097370 10839 net.cpp:425] prob <- fc8
I0803 21:16:24.097390 10839 net.cpp:399] prob -> prob
I0803 21:16:24.098157 10839 net.cpp:141] Setting up prob
I0803 21:16:24.098179 10839 net.cpp:148] Top shape: 10 1000 (10000)
I0803 21:16:24.098191 10839 net.cpp:156] Memory required for data: 68681400
I0803 21:16:24.098202 10839 net.cpp:219] prob does not need backward computation.
I0803 21:16:24.098213 10839 net.cpp:219] fc8 does not need backward computation.
I0803 21:16:24.098224 10839 net.cpp:219] drop7 does not need backward computation.
I0803 21:16:24.098235 10839 net.cpp:219] relu7 does not need backward computation.
I0803 21:16:24.098244 10839 net.cpp:219] fc7 does not need backward computation.
I0803 21:16:24.098255 10839 net.cpp:219] drop6 does not need backward computation.
I0803 21:16:24.098264 10839 net.cpp:219] relu6 does not need backward computation.
I0803 21:16:24.098274 10839 net.cpp:219] fc6 does not need backward computation.
I0803 21:16:24.098284 10839 net.cpp:219] pool5 does not need backward computation.
I0803 21:16:24.098294 10839 net.cpp:219] relu5 does not need backward computation.
I0803 21:16:24.098304 10839 net.cpp:219] conv5 does not need backward computation.
I0803 21:16:24.098317 10839 net.cpp:219] relu4 does not need backward computation.
I0803 21:16:24.098328 10839 net.cpp:219] conv4 does not need backward computation.
I0803 21:16:24.098343 10839 net.cpp:219] relu3 does not need backward computation.
I0803 21:16:24.098353 10839 net.cpp:219] conv3 does not need backward computation.
I0803 21:16:24.098363 10839 net.cpp:219] norm2 does not need backward computation.
I0803 21:16:24.098374 10839 net.cpp:219] pool2 does not need backward computation.
I0803 21:16:24.098386 10839 net.cpp:219] relu2 does not need backward computation.
I0803 21:16:24.098397 10839 net.cpp:219] conv2 does not need backward computation.
I0803 21:16:24.098405 10839 net.cpp:219] norm1 does not need backward computation.
I0803 21:16:24.098414 10839 net.cpp:219] pool1 does not need backward computation.
I0803 21:16:24.098423 10839 net.cpp:219] relu1 does not need backward computation.
I0803 21:16:24.098430 10839 net.cpp:219] conv1 does not need backward computation.
I0803 21:16:24.098438 10839 net.cpp:219] data does not need backward computation.
I0803 21:16:24.098445 10839 net.cpp:261] This network produces output prob
I0803 21:16:24.098482 10839 net.cpp:274] Network initialization done.
I0803 21:16:24.131531 10829 net.cpp:141] Setting up lstm1_transform_1
I0803 21:16:24.131585 10829 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:16:24.131592 10829 net.cpp:156] Memory required for data: 62016
I0803 21:16:24.131615 10829 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0803 21:16:24.131640 10829 net.cpp:91] Creating Layer lstm1_gate_input_1
I0803 21:16:24.131649 10829 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0803 21:16:24.131657 10829 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0803 21:16:24.131669 10829 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0803 21:16:24.131729 10829 net.cpp:141] Setting up lstm1_gate_input_1
I0803 21:16:24.131741 10829 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:16:24.131744 10829 net.cpp:156] Memory required for data: 78016
I0803 21:16:24.131749 10829 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0803 21:16:24.131762 10829 net.cpp:91] Creating Layer lstm1_unit_1
I0803 21:16:24.131767 10829 net.cpp:425] lstm1_unit_1 <- c_0
I0803 21:16:24.131773 10829 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0803 21:16:24.131779 10829 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0803 21:16:24.131786 10829 net.cpp:399] lstm1_unit_1 -> c_1
I0803 21:16:24.131795 10829 net.cpp:399] lstm1_unit_1 -> h_1
I0803 21:16:24.131865 10829 net.cpp:141] Setting up lstm1_unit_1
I0803 21:16:24.131875 10829 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:24.131881 10829 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:24.131886 10829 net.cpp:156] Memory required for data: 86016
I0803 21:16:24.131891 10829 layer_factory.hpp:77] Creating layer lstm1_
I0803 21:16:24.131899 10829 net.cpp:91] Creating Layer lstm1_
I0803 21:16:24.131904 10829 net.cpp:425] lstm1_ <- c_1
I0803 21:16:24.131914 10829 net.cpp:399] lstm1_ -> c_T
I0803 21:16:24.131949 10829 net.cpp:141] Setting up lstm1_
I0803 21:16:24.131958 10829 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:24.131963 10829 net.cpp:156] Memory required for data: 90016
I0803 21:16:24.131968 10829 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0803 21:16:24.131978 10829 net.cpp:91] Creating Layer lstm1_h_concat
I0803 21:16:24.131984 10829 net.cpp:425] lstm1_h_concat <- h_1
I0803 21:16:24.131991 10829 net.cpp:399] lstm1_h_concat -> h
I0803 21:16:24.132035 10829 net.cpp:141] Setting up lstm1_h_concat
I0803 21:16:24.132045 10829 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:24.132050 10829 net.cpp:156] Memory required for data: 94016
I0803 21:16:24.132055 10829 layer_factory.hpp:77] Creating layer h_pseudoloss
I0803 21:16:24.132076 10829 net.cpp:91] Creating Layer h_pseudoloss
I0803 21:16:24.132081 10829 net.cpp:425] h_pseudoloss <- h
I0803 21:16:24.132088 10829 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0803 21:16:24.132191 10829 net.cpp:141] Setting up h_pseudoloss
I0803 21:16:24.132202 10829 net.cpp:148] Top shape: (1)
I0803 21:16:24.132207 10829 net.cpp:151]     with loss weight 1
I0803 21:16:24.132249 10829 net.cpp:156] Memory required for data: 94020
I0803 21:16:24.132256 10829 net.cpp:217] h_pseudoloss needs backward computation.
I0803 21:16:24.132261 10829 net.cpp:217] lstm1_h_concat needs backward computation.
I0803 21:16:24.132266 10829 net.cpp:219] lstm1_ does not need backward computation.
I0803 21:16:24.132272 10829 net.cpp:217] lstm1_unit_1 needs backward computation.
I0803 21:16:24.132280 10829 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0803 21:16:24.132287 10829 net.cpp:217] lstm1_transform_1 needs backward computation.
I0803 21:16:24.132292 10829 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0803 21:16:24.132298 10829 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0803 21:16:24.132304 10829 net.cpp:217] lstm1_x_transform needs backward computation.
I0803 21:16:24.132310 10829 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0803 21:16:24.132315 10829 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0803 21:16:24.132321 10829 net.cpp:219] lstm1_ does not need backward computation.
I0803 21:16:24.132326 10829 net.cpp:219] lstm1_ does not need backward computation.
I0803 21:16:24.132330 10829 net.cpp:261] This network produces output c_T
I0803 21:16:24.132335 10829 net.cpp:261] This network produces output h_pseudoloss
I0803 21:16:24.132352 10829 net.cpp:274] Network initialization done.
I0803 21:16:24.132414 10829 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0803 21:16:24.132421 10829 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0803 21:16:24.132426 10829 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0803 21:16:24.132544 10829 net.cpp:141] Setting up lstm1
I0803 21:16:24.132557 10829 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:24.132562 10829 net.cpp:156] Memory required for data: 26408
I0803 21:16:24.132577 10829 layer_factory.hpp:77] Creating layer concat
I0803 21:16:24.132587 10829 net.cpp:91] Creating Layer concat
I0803 21:16:24.132594 10829 net.cpp:425] concat <- lstm1
I0803 21:16:24.132601 10829 net.cpp:425] concat <- embedded_input_sentence
I0803 21:16:24.132607 10829 net.cpp:425] concat <- reshaped_stage_indicator
I0803 21:16:24.132614 10829 net.cpp:399] concat -> lstm1_video_sequence
I0803 21:16:24.132652 10829 net.cpp:141] Setting up concat
I0803 21:16:24.132661 10829 net.cpp:148] Top shape: 1 1 1501 (1501)
I0803 21:16:24.132665 10829 net.cpp:156] Memory required for data: 32412
I0803 21:16:24.132671 10829 layer_factory.hpp:77] Creating layer lstm2
I0803 21:16:24.132684 10829 net.cpp:91] Creating Layer lstm2
I0803 21:16:24.132689 10829 net.cpp:425] lstm2 <- lstm1_video_sequence
I0803 21:16:24.132696 10829 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0803 21:16:24.132704 10829 net.cpp:399] lstm2 -> lstm2
I0803 21:16:24.132719 10829 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0803 21:16:24.133003 10829 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0803 21:16:24.133103 10829 layer_factory.hpp:77] Creating layer lstm2_
I0803 21:16:24.133117 10829 net.cpp:91] Creating Layer lstm2_
I0803 21:16:24.133124 10829 net.cpp:399] lstm2_ -> x
I0803 21:16:24.133136 10829 net.cpp:399] lstm2_ -> cont
I0803 21:16:24.133196 10829 net.cpp:141] Setting up lstm2_
I0803 21:16:24.133206 10829 net.cpp:148] Top shape: 1 1 1501 (1501)
I0803 21:16:24.133213 10829 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:24.133219 10829 net.cpp:156] Memory required for data: 6008
I0803 21:16:24.133224 10829 layer_factory.hpp:77] Creating layer lstm2_
I0803 21:16:24.133235 10829 net.cpp:91] Creating Layer lstm2_
I0803 21:16:24.133254 10829 net.cpp:399] lstm2_ -> c_0
I0803 21:16:24.133265 10829 net.cpp:399] lstm2_ -> h_0
I0803 21:16:24.133319 10829 net.cpp:141] Setting up lstm2_
I0803 21:16:24.133330 10829 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:24.133337 10829 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:24.133340 10829 net.cpp:156] Memory required for data: 14008
I0803 21:16:24.133345 10829 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0803 21:16:24.133355 10829 net.cpp:91] Creating Layer lstm2_cont_slice
I0803 21:16:24.133360 10829 net.cpp:425] lstm2_cont_slice <- cont
I0803 21:16:24.133368 10829 net.cpp:399] lstm2_cont_slice -> cont_1
I0803 21:16:24.133409 10829 net.cpp:141] Setting up lstm2_cont_slice
I0803 21:16:24.133424 10829 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:24.133430 10829 net.cpp:156] Memory required for data: 14012
I0803 21:16:24.133435 10829 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0803 21:16:24.133441 10829 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0803 21:16:24.133446 10829 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0803 21:16:24.133455 10829 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0803 21:16:24.133466 10829 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0803 21:16:24.133514 10829 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0803 21:16:24.133523 10829 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:24.133530 10829 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:24.133534 10829 net.cpp:156] Memory required for data: 14020
I0803 21:16:24.133539 10829 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0803 21:16:24.133554 10829 net.cpp:91] Creating Layer lstm2_x_transform
I0803 21:16:24.133560 10829 net.cpp:425] lstm2_x_transform <- x
I0803 21:16:24.133570 10829 net.cpp:399] lstm2_x_transform -> W_xc_x
I0803 21:16:24.198851 10829 net.cpp:141] Setting up lstm2_x_transform
I0803 21:16:24.198909 10829 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:16:24.198915 10829 net.cpp:156] Memory required for data: 30020
I0803 21:16:24.198940 10829 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0803 21:16:24.198961 10829 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0803 21:16:24.198967 10829 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0803 21:16:24.198977 10829 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0803 21:16:24.199033 10829 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0803 21:16:24.199043 10829 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:16:24.199048 10829 net.cpp:156] Memory required for data: 46020
I0803 21:16:24.199054 10829 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0803 21:16:24.199064 10829 net.cpp:91] Creating Layer lstm2_h_conted_0
I0803 21:16:24.199070 10829 net.cpp:425] lstm2_h_conted_0 <- h_0
I0803 21:16:24.199077 10829 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0803 21:16:24.199084 10829 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0803 21:16:24.199190 10829 net.cpp:141] Setting up lstm2_h_conted_0
I0803 21:16:24.199201 10829 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:24.199206 10829 net.cpp:156] Memory required for data: 50020
I0803 21:16:24.199211 10829 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0803 21:16:24.199225 10829 net.cpp:91] Creating Layer lstm2_transform_1
I0803 21:16:24.199230 10829 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0803 21:16:24.199239 10829 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0803 21:16:24.242662 10829 net.cpp:141] Setting up lstm2_transform_1
I0803 21:16:24.242722 10829 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:16:24.242727 10829 net.cpp:156] Memory required for data: 66020
I0803 21:16:24.242750 10829 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0803 21:16:24.242774 10829 net.cpp:91] Creating Layer lstm2_gate_input_1
I0803 21:16:24.242781 10829 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0803 21:16:24.242790 10829 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0803 21:16:24.242801 10829 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0803 21:16:24.242856 10829 net.cpp:141] Setting up lstm2_gate_input_1
I0803 21:16:24.242868 10829 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:16:24.242873 10829 net.cpp:156] Memory required for data: 82020
I0803 21:16:24.242879 10829 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0803 21:16:24.242889 10829 net.cpp:91] Creating Layer lstm2_unit_1
I0803 21:16:24.242894 10829 net.cpp:425] lstm2_unit_1 <- c_0
I0803 21:16:24.242900 10829 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0803 21:16:24.242908 10829 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0803 21:16:24.242914 10829 net.cpp:399] lstm2_unit_1 -> c_1
I0803 21:16:24.242924 10829 net.cpp:399] lstm2_unit_1 -> h_1
I0803 21:16:24.242992 10829 net.cpp:141] Setting up lstm2_unit_1
I0803 21:16:24.243002 10829 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:24.243008 10829 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:24.243012 10829 net.cpp:156] Memory required for data: 90020
I0803 21:16:24.243017 10829 layer_factory.hpp:77] Creating layer lstm2_
I0803 21:16:24.243026 10829 net.cpp:91] Creating Layer lstm2_
I0803 21:16:24.243031 10829 net.cpp:425] lstm2_ <- c_1
I0803 21:16:24.243038 10829 net.cpp:399] lstm2_ -> c_T
I0803 21:16:24.243072 10829 net.cpp:141] Setting up lstm2_
I0803 21:16:24.243080 10829 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:24.243084 10829 net.cpp:156] Memory required for data: 94020
I0803 21:16:24.243089 10829 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0803 21:16:24.243103 10829 net.cpp:91] Creating Layer lstm2_h_concat
I0803 21:16:24.243108 10829 net.cpp:425] lstm2_h_concat <- h_1
I0803 21:16:24.243115 10829 net.cpp:399] lstm2_h_concat -> h
I0803 21:16:24.243155 10829 net.cpp:141] Setting up lstm2_h_concat
I0803 21:16:24.243165 10829 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:24.243170 10829 net.cpp:156] Memory required for data: 98020
I0803 21:16:24.243173 10829 layer_factory.hpp:77] Creating layer h_pseudoloss
I0803 21:16:24.243183 10829 net.cpp:91] Creating Layer h_pseudoloss
I0803 21:16:24.243188 10829 net.cpp:425] h_pseudoloss <- h
I0803 21:16:24.243197 10829 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0803 21:16:24.243306 10829 net.cpp:141] Setting up h_pseudoloss
I0803 21:16:24.243317 10829 net.cpp:148] Top shape: (1)
I0803 21:16:24.243321 10829 net.cpp:151]     with loss weight 1
I0803 21:16:24.243343 10829 net.cpp:156] Memory required for data: 98024
I0803 21:16:24.243350 10829 net.cpp:217] h_pseudoloss needs backward computation.
I0803 21:16:24.243355 10829 net.cpp:217] lstm2_h_concat needs backward computation.
I0803 21:16:24.243360 10829 net.cpp:219] lstm2_ does not need backward computation.
I0803 21:16:24.243365 10829 net.cpp:217] lstm2_unit_1 needs backward computation.
I0803 21:16:24.243371 10829 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0803 21:16:24.243376 10829 net.cpp:217] lstm2_transform_1 needs backward computation.
I0803 21:16:24.243381 10829 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0803 21:16:24.243387 10829 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0803 21:16:24.243393 10829 net.cpp:217] lstm2_x_transform needs backward computation.
I0803 21:16:24.243398 10829 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0803 21:16:24.243404 10829 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0803 21:16:24.243410 10829 net.cpp:219] lstm2_ does not need backward computation.
I0803 21:16:24.243414 10829 net.cpp:219] lstm2_ does not need backward computation.
I0803 21:16:24.243418 10829 net.cpp:261] This network produces output c_T
I0803 21:16:24.243423 10829 net.cpp:261] This network produces output h_pseudoloss
I0803 21:16:24.243443 10829 net.cpp:274] Network initialization done.
I0803 21:16:24.243496 10829 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0803 21:16:24.243504 10829 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0803 21:16:24.243508 10829 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0803 21:16:24.243618 10829 net.cpp:141] Setting up lstm2
I0803 21:16:24.243629 10829 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:24.243634 10829 net.cpp:156] Memory required for data: 36412
I0803 21:16:24.243649 10829 layer_factory.hpp:77] Creating layer predict
I0803 21:16:24.243665 10829 net.cpp:91] Creating Layer predict
I0803 21:16:24.243671 10829 net.cpp:425] predict <- lstm2
I0803 21:16:24.243680 10829 net.cpp:399] predict -> predict
I0803 21:16:24.408188 10839 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /tmp/cvld704079848739473924/bvlc_reference_caffenet.caffemodel
I0803 21:16:24.408241 10839 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0803 21:16:24.408251 10839 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0803 21:16:24.408257 10839 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /tmp/cvld704079848739473924/bvlc_reference_caffenet.caffemodel
I0803 21:16:24.741400 10829 net.cpp:141] Setting up predict
I0803 21:16:24.741467 10829 net.cpp:148] Top shape: 1 1 46168 (46168)
I0803 21:16:24.741475 10829 net.cpp:156] Memory required for data: 221084
I0803 21:16:24.741492 10829 layer_factory.hpp:77] Creating layer probs
I0803 21:16:24.741513 10829 net.cpp:91] Creating Layer probs
I0803 21:16:24.741520 10829 net.cpp:425] probs <- predict
I0803 21:16:24.741533 10829 net.cpp:399] probs -> probs
I0803 21:16:24.742377 10829 net.cpp:141] Setting up probs
I0803 21:16:24.742393 10829 net.cpp:148] Top shape: 1 1 46168 (46168)
I0803 21:16:24.742398 10829 net.cpp:156] Memory required for data: 405756
I0803 21:16:24.742404 10829 net.cpp:219] probs does not need backward computation.
I0803 21:16:24.742410 10829 net.cpp:219] predict does not need backward computation.
I0803 21:16:24.742416 10829 net.cpp:219] lstm2 does not need backward computation.
I0803 21:16:24.742422 10829 net.cpp:219] concat does not need backward computation.
I0803 21:16:24.742429 10829 net.cpp:219] lstm1 does not need backward computation.
I0803 21:16:24.742435 10829 net.cpp:219] embedding does not need backward computation.
I0803 21:16:24.742440 10829 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0803 21:16:24.742446 10829 net.cpp:219] reshape_frames does not need backward computation.
I0803 21:16:24.742451 10829 net.cpp:219] embed_encoder does not need backward computation.
I0803 21:16:24.742456 10829 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0803 21:16:24.742462 10829 net.cpp:219] input does not need backward computation.
I0803 21:16:24.742466 10829 net.cpp:261] This network produces output probs
I0803 21:16:24.742482 10829 net.cpp:274] Network initialization done.
I0803 21:16:24.843904 10839 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0803 21:16:24.905280 10839 net.cpp:752] Ignoring source layer loss
I0803 21:16:25.159766 10829 net.cpp:752] Ignoring source layer data
I0803 21:16:25.159804 10829 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0803 21:16:25.159811 10829 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0803 21:16:25.250644 10829 net.cpp:752] Ignoring source layer cross_entropy_loss
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/lvnguyen/apache-storm-0.10.1/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/lvnguyen/apache-storm-0.10.1/data/supervisor/stormdist/captioning-1-1470273289/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
2016-08-03 21:16:30,257 ERROR Logger contains an invalid element or attribute "appender"
2016-08-03 21:16:33,256 ERROR Logger contains an invalid element or attribute "appender"
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /tmp/cvld5637622572897720687/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0803 21:16:44.216783 10970 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /tmp/cvld5637622572897720687/s2vt.words_to_preds.prototxt
I0803 21:16:44.216895 10970 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0803 21:16:44.216907 10970 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0803 21:16:44.216925 10980 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0803 21:16:44.217034 10980 layer_factory.hpp:77] Creating layer data
I0803 21:16:44.217059 10980 net.cpp:91] Creating Layer data
I0803 21:16:44.217069 10980 net.cpp:399] data -> data
I0803 21:16:44.217212 10970 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0803 21:16:44.217367 10970 layer_factory.hpp:77] Creating layer input
I0803 21:16:44.217386 10970 net.cpp:91] Creating Layer input
I0803 21:16:44.217398 10970 net.cpp:399] input -> frames_fc7
I0803 21:16:44.217416 10970 net.cpp:399] input -> cont_sentence
I0803 21:16:44.217433 10970 net.cpp:399] input -> input_sentence
I0803 21:16:44.217450 10970 net.cpp:399] input -> stage_indicator
I0803 21:16:44.734879 10980 net.cpp:141] Setting up data
I0803 21:16:44.734941 10980 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0803 21:16:44.734947 10980 net.cpp:156] Memory required for data: 6183480
I0803 21:16:44.734954 10970 net.cpp:141] Setting up input
I0803 21:16:44.734966 10980 layer_factory.hpp:77] Creating layer conv1
I0803 21:16:44.734977 10970 net.cpp:148] Top shape: 1 4096 (4096)
I0803 21:16:44.734987 10970 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:44.734990 10980 net.cpp:91] Creating Layer conv1
I0803 21:16:44.734997 10970 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:44.734999 10980 net.cpp:425] conv1 <- data
I0803 21:16:44.735005 10970 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:44.735011 10970 net.cpp:156] Memory required for data: 16396
I0803 21:16:44.735013 10980 net.cpp:399] conv1 -> conv1
I0803 21:16:44.735020 10970 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0803 21:16:44.735044 10970 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0803 21:16:44.735051 10970 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0803 21:16:44.735077 10970 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0803 21:16:44.735093 10970 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0803 21:16:44.735266 10970 net.cpp:141] Setting up cont_sentence_input_1_split
I0803 21:16:44.735280 10970 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:44.735290 10970 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:44.735296 10970 net.cpp:156] Memory required for data: 16404
I0803 21:16:44.735302 10970 layer_factory.hpp:77] Creating layer embed_encoder
I0803 21:16:44.735326 10970 net.cpp:91] Creating Layer embed_encoder
I0803 21:16:44.735332 10970 net.cpp:425] embed_encoder <- frames_fc7
I0803 21:16:44.735347 10970 net.cpp:399] embed_encoder -> embedded_in_frames
I0803 21:16:44.771229 10970 net.cpp:141] Setting up embed_encoder
I0803 21:16:44.771270 10970 net.cpp:148] Top shape: 1 500 (500)
I0803 21:16:44.771289 10970 net.cpp:156] Memory required for data: 18404
I0803 21:16:44.771322 10970 layer_factory.hpp:77] Creating layer reshape_frames
I0803 21:16:44.771348 10970 net.cpp:91] Creating Layer reshape_frames
I0803 21:16:44.771358 10970 net.cpp:425] reshape_frames <- embedded_in_frames
I0803 21:16:44.771371 10970 net.cpp:399] reshape_frames -> embedded_input_frames
I0803 21:16:44.771437 10970 net.cpp:141] Setting up reshape_frames
I0803 21:16:44.771450 10970 net.cpp:148] Top shape: 1 1 500 (500)
I0803 21:16:44.771456 10970 net.cpp:156] Memory required for data: 20404
I0803 21:16:44.771464 10970 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0803 21:16:44.771477 10970 net.cpp:91] Creating Layer reshape_stage_indicator
I0803 21:16:44.771484 10970 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0803 21:16:44.771497 10970 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0803 21:16:44.771544 10970 net.cpp:141] Setting up reshape_stage_indicator
I0803 21:16:44.771559 10970 net.cpp:148] Top shape: 1 1 1 (1)
I0803 21:16:44.771564 10970 net.cpp:156] Memory required for data: 20408
I0803 21:16:44.771571 10970 layer_factory.hpp:77] Creating layer embedding
I0803 21:16:44.771585 10970 net.cpp:91] Creating Layer embedding
I0803 21:16:44.771592 10970 net.cpp:425] embedding <- input_sentence
I0803 21:16:44.771605 10970 net.cpp:399] embedding -> embedded_input_sentence
I0803 21:16:44.988934 10980 net.cpp:141] Setting up conv1
I0803 21:16:44.988993 10980 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0803 21:16:44.989001 10980 net.cpp:156] Memory required for data: 17799480
I0803 21:16:44.989019 10980 layer_factory.hpp:77] Creating layer relu1
I0803 21:16:44.989038 10980 net.cpp:91] Creating Layer relu1
I0803 21:16:44.989045 10980 net.cpp:425] relu1 <- conv1
I0803 21:16:44.989053 10980 net.cpp:386] relu1 -> conv1 (in-place)
I0803 21:16:44.989451 10980 net.cpp:141] Setting up relu1
I0803 21:16:44.989464 10980 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0803 21:16:44.989469 10980 net.cpp:156] Memory required for data: 29415480
I0803 21:16:44.989473 10980 layer_factory.hpp:77] Creating layer pool1
I0803 21:16:44.989488 10980 net.cpp:91] Creating Layer pool1
I0803 21:16:44.989495 10980 net.cpp:425] pool1 <- conv1
I0803 21:16:44.989501 10980 net.cpp:399] pool1 -> pool1
I0803 21:16:44.989570 10980 net.cpp:141] Setting up pool1
I0803 21:16:44.989580 10980 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0803 21:16:44.989584 10980 net.cpp:156] Memory required for data: 32214840
I0803 21:16:44.989589 10980 layer_factory.hpp:77] Creating layer norm1
I0803 21:16:44.989606 10980 net.cpp:91] Creating Layer norm1
I0803 21:16:44.989611 10980 net.cpp:425] norm1 <- pool1
I0803 21:16:44.989619 10980 net.cpp:399] norm1 -> norm1
I0803 21:16:44.990039 10980 net.cpp:141] Setting up norm1
I0803 21:16:44.990054 10980 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0803 21:16:44.990059 10980 net.cpp:156] Memory required for data: 35014200
I0803 21:16:44.990064 10980 layer_factory.hpp:77] Creating layer conv2
I0803 21:16:44.990077 10980 net.cpp:91] Creating Layer conv2
I0803 21:16:44.990082 10980 net.cpp:425] conv2 <- norm1
I0803 21:16:44.990092 10980 net.cpp:399] conv2 -> conv2
I0803 21:16:44.991328 10970 net.cpp:141] Setting up embedding
I0803 21:16:44.991348 10970 net.cpp:148] Top shape: 1 1 500 (500)
I0803 21:16:44.991353 10970 net.cpp:156] Memory required for data: 22408
I0803 21:16:44.991364 10970 layer_factory.hpp:77] Creating layer lstm1
I0803 21:16:44.991375 10970 net.cpp:91] Creating Layer lstm1
I0803 21:16:44.991384 10970 net.cpp:425] lstm1 <- embedded_input_frames
I0803 21:16:44.991389 10970 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0803 21:16:44.991397 10970 net.cpp:399] lstm1 -> lstm1
I0803 21:16:44.991418 10970 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0803 21:16:44.991724 10970 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0803 21:16:44.991808 10970 layer_factory.hpp:77] Creating layer lstm1_
I0803 21:16:44.991822 10970 net.cpp:91] Creating Layer lstm1_
I0803 21:16:44.991827 10970 net.cpp:399] lstm1_ -> x
I0803 21:16:44.991838 10970 net.cpp:399] lstm1_ -> cont
I0803 21:16:44.991936 10970 net.cpp:141] Setting up lstm1_
I0803 21:16:44.991948 10970 net.cpp:148] Top shape: 1 1 500 (500)
I0803 21:16:44.991955 10970 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:44.991958 10970 net.cpp:156] Memory required for data: 2004
I0803 21:16:44.991963 10970 layer_factory.hpp:77] Creating layer lstm1_
I0803 21:16:44.991979 10970 net.cpp:91] Creating Layer lstm1_
I0803 21:16:44.991986 10970 net.cpp:399] lstm1_ -> c_0
I0803 21:16:44.991996 10970 net.cpp:399] lstm1_ -> h_0
I0803 21:16:44.992218 10970 net.cpp:141] Setting up lstm1_
I0803 21:16:44.992228 10970 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:44.992233 10970 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:44.992238 10970 net.cpp:156] Memory required for data: 10004
I0803 21:16:44.992243 10970 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0803 21:16:44.992250 10970 net.cpp:91] Creating Layer lstm1_cont_slice
I0803 21:16:44.992254 10970 net.cpp:425] lstm1_cont_slice <- cont
I0803 21:16:44.992266 10970 net.cpp:399] lstm1_cont_slice -> cont_1
I0803 21:16:44.992511 10970 net.cpp:141] Setting up lstm1_cont_slice
I0803 21:16:44.992527 10970 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:44.992530 10970 net.cpp:156] Memory required for data: 10008
I0803 21:16:44.992535 10970 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0803 21:16:44.992542 10970 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0803 21:16:44.992547 10970 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0803 21:16:44.992553 10970 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0803 21:16:44.992560 10970 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0803 21:16:44.992666 10970 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0803 21:16:44.992676 10970 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:44.992681 10970 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:44.992684 10970 net.cpp:156] Memory required for data: 10016
I0803 21:16:44.992689 10970 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0803 21:16:44.992702 10970 net.cpp:91] Creating Layer lstm1_x_transform
I0803 21:16:44.992707 10970 net.cpp:425] lstm1_x_transform <- x
I0803 21:16:44.992713 10970 net.cpp:399] lstm1_x_transform -> W_xc_x
I0803 21:16:44.997279 10980 net.cpp:141] Setting up conv2
I0803 21:16:44.997303 10980 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0803 21:16:44.997308 10980 net.cpp:156] Memory required for data: 42479160
I0803 21:16:44.997323 10980 layer_factory.hpp:77] Creating layer relu2
I0803 21:16:44.997334 10980 net.cpp:91] Creating Layer relu2
I0803 21:16:44.997339 10980 net.cpp:425] relu2 <- conv2
I0803 21:16:44.997346 10980 net.cpp:386] relu2 -> conv2 (in-place)
I0803 21:16:44.997736 10980 net.cpp:141] Setting up relu2
I0803 21:16:44.997751 10980 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0803 21:16:44.997756 10980 net.cpp:156] Memory required for data: 49944120
I0803 21:16:44.997761 10980 layer_factory.hpp:77] Creating layer pool2
I0803 21:16:44.997769 10980 net.cpp:91] Creating Layer pool2
I0803 21:16:44.997774 10980 net.cpp:425] pool2 <- conv2
I0803 21:16:44.997781 10980 net.cpp:399] pool2 -> pool2
I0803 21:16:44.997838 10980 net.cpp:141] Setting up pool2
I0803 21:16:44.997848 10980 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0803 21:16:44.997853 10980 net.cpp:156] Memory required for data: 51674680
I0803 21:16:44.997856 10980 layer_factory.hpp:77] Creating layer norm2
I0803 21:16:44.997869 10980 net.cpp:91] Creating Layer norm2
I0803 21:16:44.997874 10980 net.cpp:425] norm2 <- pool2
I0803 21:16:44.997882 10980 net.cpp:399] norm2 -> norm2
I0803 21:16:44.998134 10980 net.cpp:141] Setting up norm2
I0803 21:16:44.998147 10980 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0803 21:16:44.998150 10980 net.cpp:156] Memory required for data: 53405240
I0803 21:16:44.998155 10980 layer_factory.hpp:77] Creating layer conv3
I0803 21:16:44.998169 10980 net.cpp:91] Creating Layer conv3
I0803 21:16:44.998174 10980 net.cpp:425] conv3 <- norm2
I0803 21:16:44.998181 10980 net.cpp:399] conv3 -> conv3
I0803 21:16:45.001780 10980 net.cpp:141] Setting up conv3
I0803 21:16:45.001801 10980 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0803 21:16:45.001806 10980 net.cpp:156] Memory required for data: 56001080
I0803 21:16:45.001818 10980 layer_factory.hpp:77] Creating layer relu3
I0803 21:16:45.001832 10980 net.cpp:91] Creating Layer relu3
I0803 21:16:45.001837 10980 net.cpp:425] relu3 <- conv3
I0803 21:16:45.001844 10980 net.cpp:386] relu3 -> conv3 (in-place)
I0803 21:16:45.002228 10980 net.cpp:141] Setting up relu3
I0803 21:16:45.002240 10980 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0803 21:16:45.002245 10980 net.cpp:156] Memory required for data: 58596920
I0803 21:16:45.002250 10980 layer_factory.hpp:77] Creating layer conv4
I0803 21:16:45.002264 10980 net.cpp:91] Creating Layer conv4
I0803 21:16:45.002269 10980 net.cpp:425] conv4 <- conv3
I0803 21:16:45.002279 10980 net.cpp:399] conv4 -> conv4
I0803 21:16:45.006546 10980 net.cpp:141] Setting up conv4
I0803 21:16:45.006572 10980 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0803 21:16:45.006577 10980 net.cpp:156] Memory required for data: 61192760
I0803 21:16:45.006589 10980 layer_factory.hpp:77] Creating layer relu4
I0803 21:16:45.006604 10980 net.cpp:91] Creating Layer relu4
I0803 21:16:45.006610 10980 net.cpp:425] relu4 <- conv4
I0803 21:16:45.006618 10980 net.cpp:386] relu4 -> conv4 (in-place)
I0803 21:16:45.007007 10980 net.cpp:141] Setting up relu4
I0803 21:16:45.007020 10980 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0803 21:16:45.007025 10980 net.cpp:156] Memory required for data: 63788600
I0803 21:16:45.007030 10980 layer_factory.hpp:77] Creating layer conv5
I0803 21:16:45.007046 10980 net.cpp:91] Creating Layer conv5
I0803 21:16:45.007051 10980 net.cpp:425] conv5 <- conv4
I0803 21:16:45.007061 10980 net.cpp:399] conv5 -> conv5
I0803 21:16:45.010754 10980 net.cpp:141] Setting up conv5
I0803 21:16:45.010776 10980 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0803 21:16:45.010781 10980 net.cpp:156] Memory required for data: 65519160
I0803 21:16:45.010795 10980 layer_factory.hpp:77] Creating layer relu5
I0803 21:16:45.010804 10980 net.cpp:91] Creating Layer relu5
I0803 21:16:45.010812 10980 net.cpp:425] relu5 <- conv5
I0803 21:16:45.010819 10980 net.cpp:386] relu5 -> conv5 (in-place)
I0803 21:16:45.011210 10980 net.cpp:141] Setting up relu5
I0803 21:16:45.011222 10980 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0803 21:16:45.011227 10980 net.cpp:156] Memory required for data: 67249720
I0803 21:16:45.011232 10980 layer_factory.hpp:77] Creating layer pool5
I0803 21:16:45.011245 10980 net.cpp:91] Creating Layer pool5
I0803 21:16:45.011250 10980 net.cpp:425] pool5 <- conv5
I0803 21:16:45.011256 10980 net.cpp:399] pool5 -> pool5
I0803 21:16:45.011318 10980 net.cpp:141] Setting up pool5
I0803 21:16:45.011328 10980 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0803 21:16:45.011332 10980 net.cpp:156] Memory required for data: 67618360
I0803 21:16:45.011337 10980 layer_factory.hpp:77] Creating layer fc6
I0803 21:16:45.011348 10980 net.cpp:91] Creating Layer fc6
I0803 21:16:45.011353 10980 net.cpp:425] fc6 <- pool5
I0803 21:16:45.011363 10980 net.cpp:399] fc6 -> fc6
I0803 21:16:45.073657 10970 net.cpp:141] Setting up lstm1_x_transform
I0803 21:16:45.073704 10970 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:16:45.073710 10970 net.cpp:156] Memory required for data: 26016
I0803 21:16:45.073730 10970 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0803 21:16:45.073745 10970 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0803 21:16:45.073751 10970 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0803 21:16:45.073762 10970 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0803 21:16:45.073806 10970 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0803 21:16:45.073815 10970 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:16:45.073819 10970 net.cpp:156] Memory required for data: 42016
I0803 21:16:45.073823 10970 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0803 21:16:45.073832 10970 net.cpp:91] Creating Layer lstm1_h_conted_0
I0803 21:16:45.073837 10970 net.cpp:425] lstm1_h_conted_0 <- h_0
I0803 21:16:45.073843 10970 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0803 21:16:45.073853 10970 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0803 21:16:45.073940 10970 net.cpp:141] Setting up lstm1_h_conted_0
I0803 21:16:45.073950 10970 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:45.073954 10970 net.cpp:156] Memory required for data: 46016
I0803 21:16:45.073958 10970 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0803 21:16:45.073971 10970 net.cpp:91] Creating Layer lstm1_transform_1
I0803 21:16:45.073974 10970 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0803 21:16:45.073984 10970 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0803 21:16:45.110916 10980 net.cpp:141] Setting up fc6
I0803 21:16:45.110970 10980 net.cpp:148] Top shape: 10 4096 (40960)
I0803 21:16:45.110976 10980 net.cpp:156] Memory required for data: 67782200
I0803 21:16:45.110990 10980 layer_factory.hpp:77] Creating layer relu6
I0803 21:16:45.111006 10980 net.cpp:91] Creating Layer relu6
I0803 21:16:45.111011 10980 net.cpp:425] relu6 <- fc6
I0803 21:16:45.111019 10980 net.cpp:386] relu6 -> fc6 (in-place)
I0803 21:16:45.111328 10980 net.cpp:141] Setting up relu6
I0803 21:16:45.111340 10980 net.cpp:148] Top shape: 10 4096 (40960)
I0803 21:16:45.111344 10980 net.cpp:156] Memory required for data: 67946040
I0803 21:16:45.111349 10980 layer_factory.hpp:77] Creating layer drop6
I0803 21:16:45.111361 10980 net.cpp:91] Creating Layer drop6
I0803 21:16:45.111366 10980 net.cpp:425] drop6 <- fc6
I0803 21:16:45.111374 10980 net.cpp:386] drop6 -> fc6 (in-place)
I0803 21:16:45.111418 10980 net.cpp:141] Setting up drop6
I0803 21:16:45.111426 10980 net.cpp:148] Top shape: 10 4096 (40960)
I0803 21:16:45.111430 10980 net.cpp:156] Memory required for data: 68109880
I0803 21:16:45.111435 10980 layer_factory.hpp:77] Creating layer fc7
I0803 21:16:45.111448 10980 net.cpp:91] Creating Layer fc7
I0803 21:16:45.111452 10980 net.cpp:425] fc7 <- fc6
I0803 21:16:45.111459 10980 net.cpp:399] fc7 -> fc7
I0803 21:16:45.139583 10970 net.cpp:141] Setting up lstm1_transform_1
I0803 21:16:45.139632 10970 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:16:45.139638 10970 net.cpp:156] Memory required for data: 62016
I0803 21:16:45.139659 10970 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0803 21:16:45.139678 10970 net.cpp:91] Creating Layer lstm1_gate_input_1
I0803 21:16:45.139683 10970 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0803 21:16:45.139691 10970 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0803 21:16:45.139701 10970 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0803 21:16:45.139765 10970 net.cpp:141] Setting up lstm1_gate_input_1
I0803 21:16:45.139775 10970 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:16:45.139780 10970 net.cpp:156] Memory required for data: 78016
I0803 21:16:45.139783 10970 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0803 21:16:45.139792 10970 net.cpp:91] Creating Layer lstm1_unit_1
I0803 21:16:45.139796 10970 net.cpp:425] lstm1_unit_1 <- c_0
I0803 21:16:45.139802 10970 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0803 21:16:45.139807 10970 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0803 21:16:45.139813 10970 net.cpp:399] lstm1_unit_1 -> c_1
I0803 21:16:45.139824 10970 net.cpp:399] lstm1_unit_1 -> h_1
I0803 21:16:45.139885 10970 net.cpp:141] Setting up lstm1_unit_1
I0803 21:16:45.139894 10970 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:45.139900 10970 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:45.139904 10970 net.cpp:156] Memory required for data: 86016
I0803 21:16:45.139909 10970 layer_factory.hpp:77] Creating layer lstm1_
I0803 21:16:45.139916 10970 net.cpp:91] Creating Layer lstm1_
I0803 21:16:45.139920 10970 net.cpp:425] lstm1_ <- c_1
I0803 21:16:45.139926 10970 net.cpp:399] lstm1_ -> c_T
I0803 21:16:45.139955 10970 net.cpp:141] Setting up lstm1_
I0803 21:16:45.139963 10970 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:45.139968 10970 net.cpp:156] Memory required for data: 90016
I0803 21:16:45.139972 10970 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0803 21:16:45.139983 10970 net.cpp:91] Creating Layer lstm1_h_concat
I0803 21:16:45.139988 10970 net.cpp:425] lstm1_h_concat <- h_1
I0803 21:16:45.139996 10970 net.cpp:399] lstm1_h_concat -> h
I0803 21:16:45.140036 10970 net.cpp:141] Setting up lstm1_h_concat
I0803 21:16:45.140045 10970 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:45.140049 10970 net.cpp:156] Memory required for data: 94016
I0803 21:16:45.140053 10970 layer_factory.hpp:77] Creating layer h_pseudoloss
I0803 21:16:45.140069 10970 net.cpp:91] Creating Layer h_pseudoloss
I0803 21:16:45.140074 10970 net.cpp:425] h_pseudoloss <- h
I0803 21:16:45.140079 10970 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0803 21:16:45.140167 10970 net.cpp:141] Setting up h_pseudoloss
I0803 21:16:45.140177 10970 net.cpp:148] Top shape: (1)
I0803 21:16:45.140182 10970 net.cpp:151]     with loss weight 1
I0803 21:16:45.140215 10970 net.cpp:156] Memory required for data: 94020
I0803 21:16:45.140221 10970 net.cpp:217] h_pseudoloss needs backward computation.
I0803 21:16:45.140225 10970 net.cpp:217] lstm1_h_concat needs backward computation.
I0803 21:16:45.140230 10970 net.cpp:219] lstm1_ does not need backward computation.
I0803 21:16:45.140234 10970 net.cpp:217] lstm1_unit_1 needs backward computation.
I0803 21:16:45.140239 10970 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0803 21:16:45.140244 10970 net.cpp:217] lstm1_transform_1 needs backward computation.
I0803 21:16:45.140249 10970 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0803 21:16:45.140254 10970 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0803 21:16:45.140257 10970 net.cpp:217] lstm1_x_transform needs backward computation.
I0803 21:16:45.140262 10970 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0803 21:16:45.140266 10970 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0803 21:16:45.140271 10970 net.cpp:219] lstm1_ does not need backward computation.
I0803 21:16:45.140275 10970 net.cpp:219] lstm1_ does not need backward computation.
I0803 21:16:45.140278 10970 net.cpp:261] This network produces output c_T
I0803 21:16:45.140282 10970 net.cpp:261] This network produces output h_pseudoloss
I0803 21:16:45.140301 10970 net.cpp:274] Network initialization done.
I0803 21:16:45.140355 10970 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0803 21:16:45.140362 10970 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0803 21:16:45.140365 10970 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0803 21:16:45.140477 10970 net.cpp:141] Setting up lstm1
I0803 21:16:45.140491 10970 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:45.140494 10970 net.cpp:156] Memory required for data: 26408
I0803 21:16:45.140507 10970 layer_factory.hpp:77] Creating layer concat
I0803 21:16:45.140516 10970 net.cpp:91] Creating Layer concat
I0803 21:16:45.140522 10970 net.cpp:425] concat <- lstm1
I0803 21:16:45.140527 10970 net.cpp:425] concat <- embedded_input_sentence
I0803 21:16:45.140532 10970 net.cpp:425] concat <- reshaped_stage_indicator
I0803 21:16:45.140539 10970 net.cpp:399] concat -> lstm1_video_sequence
I0803 21:16:45.140573 10970 net.cpp:141] Setting up concat
I0803 21:16:45.140580 10970 net.cpp:148] Top shape: 1 1 1501 (1501)
I0803 21:16:45.140585 10970 net.cpp:156] Memory required for data: 32412
I0803 21:16:45.140589 10970 layer_factory.hpp:77] Creating layer lstm2
I0803 21:16:45.140600 10970 net.cpp:91] Creating Layer lstm2
I0803 21:16:45.140605 10970 net.cpp:425] lstm2 <- lstm1_video_sequence
I0803 21:16:45.140611 10970 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0803 21:16:45.140617 10970 net.cpp:399] lstm2 -> lstm2
I0803 21:16:45.140626 10970 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0803 21:16:45.140852 10970 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0803 21:16:45.140934 10970 layer_factory.hpp:77] Creating layer lstm2_
I0803 21:16:45.140945 10970 net.cpp:91] Creating Layer lstm2_
I0803 21:16:45.140951 10970 net.cpp:399] lstm2_ -> x
I0803 21:16:45.140961 10970 net.cpp:399] lstm2_ -> cont
I0803 21:16:45.141014 10970 net.cpp:141] Setting up lstm2_
I0803 21:16:45.141023 10970 net.cpp:148] Top shape: 1 1 1501 (1501)
I0803 21:16:45.141029 10970 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:45.141033 10970 net.cpp:156] Memory required for data: 6008
I0803 21:16:45.141037 10970 layer_factory.hpp:77] Creating layer lstm2_
I0803 21:16:45.141046 10970 net.cpp:91] Creating Layer lstm2_
I0803 21:16:45.141052 10970 net.cpp:399] lstm2_ -> c_0
I0803 21:16:45.141062 10970 net.cpp:399] lstm2_ -> h_0
I0803 21:16:45.141108 10970 net.cpp:141] Setting up lstm2_
I0803 21:16:45.141118 10970 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:45.141124 10970 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:45.141126 10970 net.cpp:156] Memory required for data: 14008
I0803 21:16:45.141130 10970 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0803 21:16:45.141144 10970 net.cpp:91] Creating Layer lstm2_cont_slice
I0803 21:16:45.141149 10970 net.cpp:425] lstm2_cont_slice <- cont
I0803 21:16:45.141155 10970 net.cpp:399] lstm2_cont_slice -> cont_1
I0803 21:16:45.141185 10970 net.cpp:141] Setting up lstm2_cont_slice
I0803 21:16:45.141193 10970 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:45.141197 10970 net.cpp:156] Memory required for data: 14012
I0803 21:16:45.141201 10970 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0803 21:16:45.141207 10970 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0803 21:16:45.141211 10970 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0803 21:16:45.141221 10970 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0803 21:16:45.141228 10970 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0803 21:16:45.141305 10970 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0803 21:16:45.141317 10970 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:45.141322 10970 net.cpp:148] Top shape: 1 1 (1)
I0803 21:16:45.141326 10970 net.cpp:156] Memory required for data: 14020
I0803 21:16:45.141331 10970 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0803 21:16:45.141343 10970 net.cpp:91] Creating Layer lstm2_x_transform
I0803 21:16:45.141348 10970 net.cpp:425] lstm2_x_transform <- x
I0803 21:16:45.141355 10970 net.cpp:399] lstm2_x_transform -> W_xc_x
I0803 21:16:45.157696 10980 net.cpp:141] Setting up fc7
I0803 21:16:45.157735 10980 net.cpp:148] Top shape: 10 4096 (40960)
I0803 21:16:45.157742 10980 net.cpp:156] Memory required for data: 68273720
I0803 21:16:45.157754 10980 layer_factory.hpp:77] Creating layer relu7
I0803 21:16:45.157769 10980 net.cpp:91] Creating Layer relu7
I0803 21:16:45.157775 10980 net.cpp:425] relu7 <- fc7
I0803 21:16:45.157783 10980 net.cpp:386] relu7 -> fc7 (in-place)
I0803 21:16:45.158404 10980 net.cpp:141] Setting up relu7
I0803 21:16:45.158419 10980 net.cpp:148] Top shape: 10 4096 (40960)
I0803 21:16:45.158424 10980 net.cpp:156] Memory required for data: 68437560
I0803 21:16:45.158430 10980 layer_factory.hpp:77] Creating layer drop7
I0803 21:16:45.158439 10980 net.cpp:91] Creating Layer drop7
I0803 21:16:45.158444 10980 net.cpp:425] drop7 <- fc7
I0803 21:16:45.158450 10980 net.cpp:386] drop7 -> fc7 (in-place)
I0803 21:16:45.158494 10980 net.cpp:141] Setting up drop7
I0803 21:16:45.158504 10980 net.cpp:148] Top shape: 10 4096 (40960)
I0803 21:16:45.158507 10980 net.cpp:156] Memory required for data: 68601400
I0803 21:16:45.158512 10980 layer_factory.hpp:77] Creating layer fc8
I0803 21:16:45.158521 10980 net.cpp:91] Creating Layer fc8
I0803 21:16:45.158525 10980 net.cpp:425] fc8 <- fc7
I0803 21:16:45.158535 10980 net.cpp:399] fc8 -> fc8
I0803 21:16:45.170308 10980 net.cpp:141] Setting up fc8
I0803 21:16:45.170348 10980 net.cpp:148] Top shape: 10 1000 (10000)
I0803 21:16:45.170353 10980 net.cpp:156] Memory required for data: 68641400
I0803 21:16:45.170367 10980 layer_factory.hpp:77] Creating layer prob
I0803 21:16:45.170387 10980 net.cpp:91] Creating Layer prob
I0803 21:16:45.170393 10980 net.cpp:425] prob <- fc8
I0803 21:16:45.170402 10980 net.cpp:399] prob -> prob
I0803 21:16:45.170812 10980 net.cpp:141] Setting up prob
I0803 21:16:45.170826 10980 net.cpp:148] Top shape: 10 1000 (10000)
I0803 21:16:45.170831 10980 net.cpp:156] Memory required for data: 68681400
I0803 21:16:45.170836 10980 net.cpp:219] prob does not need backward computation.
I0803 21:16:45.170841 10980 net.cpp:219] fc8 does not need backward computation.
I0803 21:16:45.170846 10980 net.cpp:219] drop7 does not need backward computation.
I0803 21:16:45.170850 10980 net.cpp:219] relu7 does not need backward computation.
I0803 21:16:45.170855 10980 net.cpp:219] fc7 does not need backward computation.
I0803 21:16:45.170858 10980 net.cpp:219] drop6 does not need backward computation.
I0803 21:16:45.170862 10980 net.cpp:219] relu6 does not need backward computation.
I0803 21:16:45.170866 10980 net.cpp:219] fc6 does not need backward computation.
I0803 21:16:45.170871 10980 net.cpp:219] pool5 does not need backward computation.
I0803 21:16:45.170874 10980 net.cpp:219] relu5 does not need backward computation.
I0803 21:16:45.170878 10980 net.cpp:219] conv5 does not need backward computation.
I0803 21:16:45.170882 10980 net.cpp:219] relu4 does not need backward computation.
I0803 21:16:45.170886 10980 net.cpp:219] conv4 does not need backward computation.
I0803 21:16:45.170892 10980 net.cpp:219] relu3 does not need backward computation.
I0803 21:16:45.170894 10980 net.cpp:219] conv3 does not need backward computation.
I0803 21:16:45.170899 10980 net.cpp:219] norm2 does not need backward computation.
I0803 21:16:45.170903 10980 net.cpp:219] pool2 does not need backward computation.
I0803 21:16:45.170907 10980 net.cpp:219] relu2 does not need backward computation.
I0803 21:16:45.170912 10980 net.cpp:219] conv2 does not need backward computation.
I0803 21:16:45.170915 10980 net.cpp:219] norm1 does not need backward computation.
I0803 21:16:45.170919 10980 net.cpp:219] pool1 does not need backward computation.
I0803 21:16:45.170923 10980 net.cpp:219] relu1 does not need backward computation.
I0803 21:16:45.170928 10980 net.cpp:219] conv1 does not need backward computation.
I0803 21:16:45.170931 10980 net.cpp:219] data does not need backward computation.
I0803 21:16:45.170934 10980 net.cpp:261] This network produces output prob
I0803 21:16:45.170953 10980 net.cpp:274] Network initialization done.
I0803 21:16:45.202601 10970 net.cpp:141] Setting up lstm2_x_transform
I0803 21:16:45.202641 10970 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:16:45.202647 10970 net.cpp:156] Memory required for data: 30020
I0803 21:16:45.202666 10970 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0803 21:16:45.202679 10970 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0803 21:16:45.202685 10970 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0803 21:16:45.202697 10970 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0803 21:16:45.202739 10970 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0803 21:16:45.202749 10970 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:16:45.202752 10970 net.cpp:156] Memory required for data: 46020
I0803 21:16:45.202757 10970 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0803 21:16:45.202766 10970 net.cpp:91] Creating Layer lstm2_h_conted_0
I0803 21:16:45.202771 10970 net.cpp:425] lstm2_h_conted_0 <- h_0
I0803 21:16:45.202776 10970 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0803 21:16:45.202786 10970 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0803 21:16:45.202877 10970 net.cpp:141] Setting up lstm2_h_conted_0
I0803 21:16:45.202885 10970 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:45.202889 10970 net.cpp:156] Memory required for data: 50020
I0803 21:16:45.202894 10970 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0803 21:16:45.202905 10970 net.cpp:91] Creating Layer lstm2_transform_1
I0803 21:16:45.202909 10970 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0803 21:16:45.202919 10970 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0803 21:16:45.241209 10970 net.cpp:141] Setting up lstm2_transform_1
I0803 21:16:45.241258 10970 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:16:45.241264 10970 net.cpp:156] Memory required for data: 66020
I0803 21:16:45.241282 10970 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0803 21:16:45.241298 10970 net.cpp:91] Creating Layer lstm2_gate_input_1
I0803 21:16:45.241305 10970 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0803 21:16:45.241312 10970 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0803 21:16:45.241322 10970 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0803 21:16:45.241369 10970 net.cpp:141] Setting up lstm2_gate_input_1
I0803 21:16:45.241379 10970 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:16:45.241382 10970 net.cpp:156] Memory required for data: 82020
I0803 21:16:45.241386 10970 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0803 21:16:45.241394 10970 net.cpp:91] Creating Layer lstm2_unit_1
I0803 21:16:45.241399 10970 net.cpp:425] lstm2_unit_1 <- c_0
I0803 21:16:45.241405 10970 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0803 21:16:45.241410 10970 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0803 21:16:45.241417 10970 net.cpp:399] lstm2_unit_1 -> c_1
I0803 21:16:45.241426 10970 net.cpp:399] lstm2_unit_1 -> h_1
I0803 21:16:45.241488 10970 net.cpp:141] Setting up lstm2_unit_1
I0803 21:16:45.241497 10970 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:45.241503 10970 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:45.241508 10970 net.cpp:156] Memory required for data: 90020
I0803 21:16:45.241513 10970 layer_factory.hpp:77] Creating layer lstm2_
I0803 21:16:45.241519 10970 net.cpp:91] Creating Layer lstm2_
I0803 21:16:45.241524 10970 net.cpp:425] lstm2_ <- c_1
I0803 21:16:45.241530 10970 net.cpp:399] lstm2_ -> c_T
I0803 21:16:45.241562 10970 net.cpp:141] Setting up lstm2_
I0803 21:16:45.241571 10970 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:45.241575 10970 net.cpp:156] Memory required for data: 94020
I0803 21:16:45.241580 10970 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0803 21:16:45.241588 10970 net.cpp:91] Creating Layer lstm2_h_concat
I0803 21:16:45.241592 10970 net.cpp:425] lstm2_h_concat <- h_1
I0803 21:16:45.241600 10970 net.cpp:399] lstm2_h_concat -> h
I0803 21:16:45.241631 10970 net.cpp:141] Setting up lstm2_h_concat
I0803 21:16:45.241638 10970 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:45.241642 10970 net.cpp:156] Memory required for data: 98020
I0803 21:16:45.241647 10970 layer_factory.hpp:77] Creating layer h_pseudoloss
I0803 21:16:45.241657 10970 net.cpp:91] Creating Layer h_pseudoloss
I0803 21:16:45.241662 10970 net.cpp:425] h_pseudoloss <- h
I0803 21:16:45.241668 10970 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0803 21:16:45.241751 10970 net.cpp:141] Setting up h_pseudoloss
I0803 21:16:45.241761 10970 net.cpp:148] Top shape: (1)
I0803 21:16:45.241765 10970 net.cpp:151]     with loss weight 1
I0803 21:16:45.241783 10970 net.cpp:156] Memory required for data: 98024
I0803 21:16:45.241788 10970 net.cpp:217] h_pseudoloss needs backward computation.
I0803 21:16:45.241792 10970 net.cpp:217] lstm2_h_concat needs backward computation.
I0803 21:16:45.241796 10970 net.cpp:219] lstm2_ does not need backward computation.
I0803 21:16:45.241801 10970 net.cpp:217] lstm2_unit_1 needs backward computation.
I0803 21:16:45.241806 10970 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0803 21:16:45.241811 10970 net.cpp:217] lstm2_transform_1 needs backward computation.
I0803 21:16:45.241814 10970 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0803 21:16:45.241819 10970 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0803 21:16:45.241824 10970 net.cpp:217] lstm2_x_transform needs backward computation.
I0803 21:16:45.241828 10970 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0803 21:16:45.241833 10970 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0803 21:16:45.241837 10970 net.cpp:219] lstm2_ does not need backward computation.
I0803 21:16:45.241842 10970 net.cpp:219] lstm2_ does not need backward computation.
I0803 21:16:45.241845 10970 net.cpp:261] This network produces output c_T
I0803 21:16:45.241849 10970 net.cpp:261] This network produces output h_pseudoloss
I0803 21:16:45.241865 10970 net.cpp:274] Network initialization done.
I0803 21:16:45.241909 10970 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0803 21:16:45.241914 10970 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0803 21:16:45.241919 10970 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0803 21:16:45.242018 10970 net.cpp:141] Setting up lstm2
I0803 21:16:45.242029 10970 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:16:45.242034 10970 net.cpp:156] Memory required for data: 36412
I0803 21:16:45.242048 10970 layer_factory.hpp:77] Creating layer predict
I0803 21:16:45.242058 10970 net.cpp:91] Creating Layer predict
I0803 21:16:45.242064 10970 net.cpp:425] predict <- lstm2
I0803 21:16:45.242070 10970 net.cpp:399] predict -> predict
I0803 21:16:45.396667 10980 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /tmp/cvld5637622572897720687/bvlc_reference_caffenet.caffemodel
I0803 21:16:45.396703 10980 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0803 21:16:45.396708 10980 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0803 21:16:45.396713 10980 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /tmp/cvld5637622572897720687/bvlc_reference_caffenet.caffemodel
I0803 21:16:45.692528 10970 net.cpp:141] Setting up predict
I0803 21:16:45.692601 10970 net.cpp:148] Top shape: 1 1 46168 (46168)
I0803 21:16:45.692610 10970 net.cpp:156] Memory required for data: 221084
I0803 21:16:45.692628 10970 layer_factory.hpp:77] Creating layer probs
I0803 21:16:45.692649 10970 net.cpp:91] Creating Layer probs
I0803 21:16:45.692658 10970 net.cpp:425] probs <- predict
I0803 21:16:45.692672 10970 net.cpp:399] probs -> probs
I0803 21:16:45.693588 10970 net.cpp:141] Setting up probs
I0803 21:16:45.693611 10970 net.cpp:148] Top shape: 1 1 46168 (46168)
I0803 21:16:45.693616 10970 net.cpp:156] Memory required for data: 405756
I0803 21:16:45.693622 10970 net.cpp:219] probs does not need backward computation.
I0803 21:16:45.693629 10970 net.cpp:219] predict does not need backward computation.
I0803 21:16:45.693634 10970 net.cpp:219] lstm2 does not need backward computation.
I0803 21:16:45.693640 10970 net.cpp:219] concat does not need backward computation.
I0803 21:16:45.693646 10970 net.cpp:219] lstm1 does not need backward computation.
I0803 21:16:45.693652 10970 net.cpp:219] embedding does not need backward computation.
I0803 21:16:45.693658 10970 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0803 21:16:45.693663 10970 net.cpp:219] reshape_frames does not need backward computation.
I0803 21:16:45.693670 10970 net.cpp:219] embed_encoder does not need backward computation.
I0803 21:16:45.693675 10970 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0803 21:16:45.693680 10970 net.cpp:219] input does not need backward computation.
I0803 21:16:45.693684 10970 net.cpp:261] This network produces output probs
I0803 21:16:45.693699 10970 net.cpp:274] Network initialization done.
I0803 21:16:45.755482 10980 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0803 21:16:45.802175 10980 net.cpp:752] Ignoring source layer loss
I0803 21:16:46.117053 10970 net.cpp:752] Ignoring source layer data
I0803 21:16:46.117100 10970 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0803 21:16:46.117106 10970 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0803 21:16:46.193056 10970 net.cpp:752] Ignoring source layer cross_entropy_loss
SLF4J: Class path contains multiple SLF4J bindings.
2016-08-03 21:16:53,529 ERROR Logger contains an invalid element or attribute "appender"
SLF4J: Found binding in [jar:file:/home/lvnguyen/apache-storm-0.10.1/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/lvnguyen/apache-storm-0.10.1/data/supervisor/stormdist/captioning-1-1470273289/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
2016-08-03 21:16:59,537 ERROR Logger contains an invalid element or attribute "appender"
Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /tmp/cvld5698412900921754623/libopencv_java310.xine1.so which might have disabled stack guard. The VM will try to fix the stack guard now.
It's highly recommended that you fix the library with 'execstack -c <libfile>', or link it with '-z noexecstack'.
WARNING: Logging before InitGoogleLogging() is written to STDERR
I0803 21:17:05.594691 11190 net.cpp:49] Initializing net from parameters: 
name: "CaffeNet"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "Input"
  top: "data"
  input_param {
    shape {
      dim: 10
      dim: 3
      dim: 227
      dim: 227
    }
  }
}
layer {
  name: "conv1"
  type: "Convolution"
  bottom: "data"
  top: "conv1"
  convolution_param {
    num_output: 96
    kernel_size: 11
    stride: 4
  }
}
layer {
  name: "relu1"
  type: "ReLU"
  bottom: "conv1"
  top: "conv1"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm1"
  type: "LRN"
  bottom: "pool1"
  top: "norm1"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv2"
  type: "Convolution"
  bottom: "norm1"
  top: "conv2"
  convolution_param {
    num_output: 256
    pad: 2
    kernel_size: 5
    group: 2
  }
}
layer {
  name: "relu2"
  type: "ReLU"
  bottom: "conv2"
  top: "conv2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "norm2"
  type: "LRN"
  bottom: "pool2"
  top: "norm2"
  lrn_param {
    local_size: 5
    alpha: 0.0001
    beta: 0.75
  }
}
layer {
  name: "conv3"
  type: "Convolution"
  bottom: "norm2"
  top: "conv3"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "relu3"
  type: "ReLU"
  bottom: "conv3"
  top: "conv3"
}
layer {
  name: "conv4"
  type: "Convolution"
  bottom: "conv3"
  top: "conv4"
  convolution_param {
    num_output: 384
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu4"
  type: "ReLU"
  bottom: "conv4"
  top: "conv4"
}
layer {
  name: "conv5"
  type: "Convolution"
  bottom: "conv4"
  top: "conv5"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    group: 2
  }
}
layer {
  name: "relu5"
  type: "ReLU"
  bottom: "conv5"
  top: "conv5"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 3
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8"
  inner_product_param {
    num_output: 1000
  }
}
layer {
  name: "prob"
  type: "Softmax"
  bottom: "fc8"
  top: "prob"
}
I0803 21:17:05.594893 11190 layer_factory.hpp:77] Creating layer data
I0803 21:17:05.594919 11190 net.cpp:91] Creating Layer data
I0803 21:17:05.594929 11190 net.cpp:399] data -> data
I0803 21:17:06.065913 11190 net.cpp:141] Setting up data
I0803 21:17:06.066001 11190 net.cpp:148] Top shape: 10 3 227 227 (1545870)
I0803 21:17:06.066009 11190 net.cpp:156] Memory required for data: 6183480
I0803 21:17:06.066025 11190 layer_factory.hpp:77] Creating layer conv1
I0803 21:17:06.066054 11190 net.cpp:91] Creating Layer conv1
I0803 21:17:06.066064 11190 net.cpp:425] conv1 <- data
I0803 21:17:06.066077 11190 net.cpp:399] conv1 -> conv1
I0803 21:17:06.089982 11180 upgrade_proto.cpp:66] Attempting to upgrade input file specified using deprecated input fields: /tmp/cvld5698412900921754623/s2vt.words_to_preds.prototxt
I0803 21:17:06.090039 11180 upgrade_proto.cpp:69] Successfully upgraded file specified using deprecated input fields.
W0803 21:17:06.090051 11180 upgrade_proto.cpp:71] Note that future Caffe releases will only support input layers and not input fields.
I0803 21:17:06.090461 11180 net.cpp:49] Initializing net from parameters: 
name: "s2vt:features_to_lstm"
state {
  phase: TEST
}
layer {
  name: "input"
  type: "Input"
  top: "frames_fc7"
  top: "cont_sentence"
  top: "input_sentence"
  top: "stage_indicator"
  input_param {
    shape {
      dim: 1
      dim: 4096
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embed_encoder"
  type: "InnerProduct"
  bottom: "frames_fc7"
  top: "embedded_in_frames"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 500
    weight_filler {
      type: "xavier"
    }
    bias_filler {
      type: "constant"
      value: 0.2
    }
  }
}
layer {
  name: "reshape_frames"
  type: "Reshape"
  bottom: "embedded_in_frames"
  top: "embedded_input_frames"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
  }
}
layer {
  name: "reshape_stage_indicator"
  type: "Reshape"
  bottom: "stage_indicator"
  top: "reshaped_stage_indicator"
  reshape_param {
    shape {
      dim: 1
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "embedding"
  type: "Embed"
  bottom: "input_sentence"
  top: "embedded_input_sentence"
  param {
    lr_mult: 1
  }
  embed_param {
    num_output: 500
    input_dim: 46168
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
  }
}
layer {
  name: "lstm1"
  type: "LSTM"
  bottom: "embedded_input_frames"
  bottom: "cont_sentence"
  top: "lstm1"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "concat"
  type: "Concat"
  bottom: "lstm1"
  bottom: "embedded_input_sentence"
  bottom: "reshaped_stage_indicator"
  top: "lstm1_video_sequence"
  concat_param {
    concat_dim: 2
  }
}
layer {
  name: "lstm2"
  type: "LSTM"
  bottom: "lstm1_video_sequence"
  bottom: "cont_sentence"
  top: "lstm2"
  recurrent_param {
    num_output: 1000
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "predict"
  type: "InnerProduct"
  bottom: "lstm2"
  top: "predict"
  param {
    lr_mult: 1
    decay_mult: 1
  }
  param {
    lr_mult: 2
    decay_mult: 0
  }
  inner_product_param {
    num_output: 46168
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "probs"
  type: "Softmax"
  bottom: "predict"
  top: "probs"
  softmax_param {
    axis: 2
  }
}
I0803 21:17:06.090605 11180 layer_factory.hpp:77] Creating layer input
I0803 21:17:06.090628 11180 net.cpp:91] Creating Layer input
I0803 21:17:06.090641 11180 net.cpp:399] input -> frames_fc7
I0803 21:17:06.090670 11180 net.cpp:399] input -> cont_sentence
I0803 21:17:06.090692 11180 net.cpp:399] input -> input_sentence
I0803 21:17:06.090713 11180 net.cpp:399] input -> stage_indicator
I0803 21:17:06.091495 11180 net.cpp:141] Setting up input
I0803 21:17:06.091516 11180 net.cpp:148] Top shape: 1 4096 (4096)
I0803 21:17:06.091531 11180 net.cpp:148] Top shape: 1 1 (1)
I0803 21:17:06.091542 11180 net.cpp:148] Top shape: 1 1 (1)
I0803 21:17:06.091554 11180 net.cpp:148] Top shape: 1 1 (1)
I0803 21:17:06.091563 11180 net.cpp:156] Memory required for data: 16396
I0803 21:17:06.091572 11180 layer_factory.hpp:77] Creating layer cont_sentence_input_1_split
I0803 21:17:06.091598 11180 net.cpp:91] Creating Layer cont_sentence_input_1_split
I0803 21:17:06.091611 11180 net.cpp:425] cont_sentence_input_1_split <- cont_sentence
I0803 21:17:06.091645 11180 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_0
I0803 21:17:06.091665 11180 net.cpp:399] cont_sentence_input_1_split -> cont_sentence_input_1_split_1
I0803 21:17:06.093312 11180 net.cpp:141] Setting up cont_sentence_input_1_split
I0803 21:17:06.093334 11180 net.cpp:148] Top shape: 1 1 (1)
I0803 21:17:06.093348 11180 net.cpp:148] Top shape: 1 1 (1)
I0803 21:17:06.093356 11180 net.cpp:156] Memory required for data: 16404
I0803 21:17:06.093365 11180 layer_factory.hpp:77] Creating layer embed_encoder
I0803 21:17:06.093391 11180 net.cpp:91] Creating Layer embed_encoder
I0803 21:17:06.093405 11180 net.cpp:425] embed_encoder <- frames_fc7
I0803 21:17:06.093423 11180 net.cpp:399] embed_encoder -> embedded_in_frames
I0803 21:17:06.126830 11180 net.cpp:141] Setting up embed_encoder
I0803 21:17:06.126873 11180 net.cpp:148] Top shape: 1 500 (500)
I0803 21:17:06.126883 11180 net.cpp:156] Memory required for data: 18404
I0803 21:17:06.126919 11180 layer_factory.hpp:77] Creating layer reshape_frames
I0803 21:17:06.126950 11180 net.cpp:91] Creating Layer reshape_frames
I0803 21:17:06.126960 11180 net.cpp:425] reshape_frames <- embedded_in_frames
I0803 21:17:06.126976 11180 net.cpp:399] reshape_frames -> embedded_input_frames
I0803 21:17:06.128394 11180 net.cpp:141] Setting up reshape_frames
I0803 21:17:06.128417 11180 net.cpp:148] Top shape: 1 1 500 (500)
I0803 21:17:06.128425 11180 net.cpp:156] Memory required for data: 20404
I0803 21:17:06.128435 11180 layer_factory.hpp:77] Creating layer reshape_stage_indicator
I0803 21:17:06.128453 11180 net.cpp:91] Creating Layer reshape_stage_indicator
I0803 21:17:06.128464 11180 net.cpp:425] reshape_stage_indicator <- stage_indicator
I0803 21:17:06.128479 11180 net.cpp:399] reshape_stage_indicator -> reshaped_stage_indicator
I0803 21:17:06.128881 11180 net.cpp:141] Setting up reshape_stage_indicator
I0803 21:17:06.128901 11180 net.cpp:148] Top shape: 1 1 1 (1)
I0803 21:17:06.128911 11180 net.cpp:156] Memory required for data: 20408
I0803 21:17:06.128921 11180 layer_factory.hpp:77] Creating layer embedding
I0803 21:17:06.128939 11180 net.cpp:91] Creating Layer embedding
I0803 21:17:06.128950 11180 net.cpp:425] embedding <- input_sentence
I0803 21:17:06.128968 11180 net.cpp:399] embedding -> embedded_input_sentence
I0803 21:17:06.317117 11190 net.cpp:141] Setting up conv1
I0803 21:17:06.317186 11190 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0803 21:17:06.317194 11190 net.cpp:156] Memory required for data: 17799480
I0803 21:17:06.317217 11190 layer_factory.hpp:77] Creating layer relu1
I0803 21:17:06.317255 11190 net.cpp:91] Creating Layer relu1
I0803 21:17:06.317263 11190 net.cpp:425] relu1 <- conv1
I0803 21:17:06.317271 11190 net.cpp:386] relu1 -> conv1 (in-place)
I0803 21:17:06.317679 11190 net.cpp:141] Setting up relu1
I0803 21:17:06.317692 11190 net.cpp:148] Top shape: 10 96 55 55 (2904000)
I0803 21:17:06.317698 11190 net.cpp:156] Memory required for data: 29415480
I0803 21:17:06.317703 11190 layer_factory.hpp:77] Creating layer pool1
I0803 21:17:06.317716 11190 net.cpp:91] Creating Layer pool1
I0803 21:17:06.317723 11190 net.cpp:425] pool1 <- conv1
I0803 21:17:06.317729 11190 net.cpp:399] pool1 -> pool1
I0803 21:17:06.317811 11190 net.cpp:141] Setting up pool1
I0803 21:17:06.317821 11190 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0803 21:17:06.317826 11190 net.cpp:156] Memory required for data: 32214840
I0803 21:17:06.317829 11190 layer_factory.hpp:77] Creating layer norm1
I0803 21:17:06.317850 11190 net.cpp:91] Creating Layer norm1
I0803 21:17:06.317855 11190 net.cpp:425] norm1 <- pool1
I0803 21:17:06.317862 11190 net.cpp:399] norm1 -> norm1
I0803 21:17:06.318301 11190 net.cpp:141] Setting up norm1
I0803 21:17:06.318315 11190 net.cpp:148] Top shape: 10 96 27 27 (699840)
I0803 21:17:06.318320 11190 net.cpp:156] Memory required for data: 35014200
I0803 21:17:06.318325 11190 layer_factory.hpp:77] Creating layer conv2
I0803 21:17:06.318351 11190 net.cpp:91] Creating Layer conv2
I0803 21:17:06.318356 11190 net.cpp:425] conv2 <- norm1
I0803 21:17:06.318366 11190 net.cpp:399] conv2 -> conv2
I0803 21:17:06.321460 11190 net.cpp:141] Setting up conv2
I0803 21:17:06.321491 11190 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0803 21:17:06.321497 11190 net.cpp:156] Memory required for data: 42479160
I0803 21:17:06.321509 11190 layer_factory.hpp:77] Creating layer relu2
I0803 21:17:06.321517 11190 net.cpp:91] Creating Layer relu2
I0803 21:17:06.321522 11190 net.cpp:425] relu2 <- conv2
I0803 21:17:06.321533 11190 net.cpp:386] relu2 -> conv2 (in-place)
I0803 21:17:06.321929 11190 net.cpp:141] Setting up relu2
I0803 21:17:06.321943 11190 net.cpp:148] Top shape: 10 256 27 27 (1866240)
I0803 21:17:06.321948 11190 net.cpp:156] Memory required for data: 49944120
I0803 21:17:06.321952 11190 layer_factory.hpp:77] Creating layer pool2
I0803 21:17:06.321960 11190 net.cpp:91] Creating Layer pool2
I0803 21:17:06.321964 11190 net.cpp:425] pool2 <- conv2
I0803 21:17:06.321974 11190 net.cpp:399] pool2 -> pool2
I0803 21:17:06.322029 11190 net.cpp:141] Setting up pool2
I0803 21:17:06.322038 11190 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0803 21:17:06.322042 11190 net.cpp:156] Memory required for data: 51674680
I0803 21:17:06.322046 11190 layer_factory.hpp:77] Creating layer norm2
I0803 21:17:06.322060 11190 net.cpp:91] Creating Layer norm2
I0803 21:17:06.322067 11190 net.cpp:425] norm2 <- pool2
I0803 21:17:06.322072 11190 net.cpp:399] norm2 -> norm2
I0803 21:17:06.322324 11190 net.cpp:141] Setting up norm2
I0803 21:17:06.322335 11190 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0803 21:17:06.322340 11190 net.cpp:156] Memory required for data: 53405240
I0803 21:17:06.322345 11190 layer_factory.hpp:77] Creating layer conv3
I0803 21:17:06.322357 11190 net.cpp:91] Creating Layer conv3
I0803 21:17:06.322362 11190 net.cpp:425] conv3 <- norm2
I0803 21:17:06.322371 11190 net.cpp:399] conv3 -> conv3
I0803 21:17:06.326045 11190 net.cpp:141] Setting up conv3
I0803 21:17:06.326078 11190 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0803 21:17:06.326084 11190 net.cpp:156] Memory required for data: 56001080
I0803 21:17:06.326102 11190 layer_factory.hpp:77] Creating layer relu3
I0803 21:17:06.326112 11190 net.cpp:91] Creating Layer relu3
I0803 21:17:06.326117 11190 net.cpp:425] relu3 <- conv3
I0803 21:17:06.326125 11190 net.cpp:386] relu3 -> conv3 (in-place)
I0803 21:17:06.326508 11190 net.cpp:141] Setting up relu3
I0803 21:17:06.326520 11190 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0803 21:17:06.326525 11190 net.cpp:156] Memory required for data: 58596920
I0803 21:17:06.326530 11190 layer_factory.hpp:77] Creating layer conv4
I0803 21:17:06.326542 11190 net.cpp:91] Creating Layer conv4
I0803 21:17:06.326547 11190 net.cpp:425] conv4 <- conv3
I0803 21:17:06.326555 11190 net.cpp:399] conv4 -> conv4
I0803 21:17:06.330391 11190 net.cpp:141] Setting up conv4
I0803 21:17:06.330417 11190 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0803 21:17:06.330423 11190 net.cpp:156] Memory required for data: 61192760
I0803 21:17:06.330432 11190 layer_factory.hpp:77] Creating layer relu4
I0803 21:17:06.330441 11190 net.cpp:91] Creating Layer relu4
I0803 21:17:06.330447 11190 net.cpp:425] relu4 <- conv4
I0803 21:17:06.330456 11190 net.cpp:386] relu4 -> conv4 (in-place)
I0803 21:17:06.330838 11190 net.cpp:141] Setting up relu4
I0803 21:17:06.330855 11190 net.cpp:148] Top shape: 10 384 13 13 (648960)
I0803 21:17:06.330860 11190 net.cpp:156] Memory required for data: 63788600
I0803 21:17:06.330865 11190 layer_factory.hpp:77] Creating layer conv5
I0803 21:17:06.330878 11190 net.cpp:91] Creating Layer conv5
I0803 21:17:06.330884 11190 net.cpp:425] conv5 <- conv4
I0803 21:17:06.330891 11190 net.cpp:399] conv5 -> conv5
I0803 21:17:06.334552 11190 net.cpp:141] Setting up conv5
I0803 21:17:06.334583 11190 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0803 21:17:06.334589 11190 net.cpp:156] Memory required for data: 65519160
I0803 21:17:06.334605 11190 layer_factory.hpp:77] Creating layer relu5
I0803 21:17:06.334614 11190 net.cpp:91] Creating Layer relu5
I0803 21:17:06.334619 11190 net.cpp:425] relu5 <- conv5
I0803 21:17:06.334626 11190 net.cpp:386] relu5 -> conv5 (in-place)
I0803 21:17:06.335023 11190 net.cpp:141] Setting up relu5
I0803 21:17:06.335038 11190 net.cpp:148] Top shape: 10 256 13 13 (432640)
I0803 21:17:06.335042 11190 net.cpp:156] Memory required for data: 67249720
I0803 21:17:06.335047 11190 layer_factory.hpp:77] Creating layer pool5
I0803 21:17:06.335058 11190 net.cpp:91] Creating Layer pool5
I0803 21:17:06.335063 11190 net.cpp:425] pool5 <- conv5
I0803 21:17:06.335070 11190 net.cpp:399] pool5 -> pool5
I0803 21:17:06.335131 11190 net.cpp:141] Setting up pool5
I0803 21:17:06.335141 11190 net.cpp:148] Top shape: 10 256 6 6 (92160)
I0803 21:17:06.335145 11190 net.cpp:156] Memory required for data: 67618360
I0803 21:17:06.335150 11190 layer_factory.hpp:77] Creating layer fc6
I0803 21:17:06.335168 11190 net.cpp:91] Creating Layer fc6
I0803 21:17:06.335175 11190 net.cpp:425] fc6 <- pool5
I0803 21:17:06.335181 11190 net.cpp:399] fc6 -> fc6
I0803 21:17:06.397471 11180 net.cpp:141] Setting up embedding
I0803 21:17:06.397562 11180 net.cpp:148] Top shape: 1 1 500 (500)
I0803 21:17:06.397569 11180 net.cpp:156] Memory required for data: 22408
I0803 21:17:06.397595 11180 layer_factory.hpp:77] Creating layer lstm1
I0803 21:17:06.397739 11180 net.cpp:91] Creating Layer lstm1
I0803 21:17:06.397790 11180 net.cpp:425] lstm1 <- embedded_input_frames
I0803 21:17:06.397807 11180 net.cpp:425] lstm1 <- cont_sentence_input_1_split_0
I0803 21:17:06.397831 11180 net.cpp:399] lstm1 -> lstm1
I0803 21:17:06.397893 11180 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0803 21:17:06.398533 11180 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm1_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 500
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm1_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm1_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm1_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm1_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm1_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm1_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm1_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm1_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm1_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0803 21:17:06.398700 11180 layer_factory.hpp:77] Creating layer lstm1_
I0803 21:17:06.398725 11180 net.cpp:91] Creating Layer lstm1_
I0803 21:17:06.398736 11180 net.cpp:399] lstm1_ -> x
I0803 21:17:06.398758 11180 net.cpp:399] lstm1_ -> cont
I0803 21:17:06.398958 11180 net.cpp:141] Setting up lstm1_
I0803 21:17:06.398979 11180 net.cpp:148] Top shape: 1 1 500 (500)
I0803 21:17:06.398991 11180 net.cpp:148] Top shape: 1 1 (1)
I0803 21:17:06.398999 11180 net.cpp:156] Memory required for data: 2004
I0803 21:17:06.399009 11180 layer_factory.hpp:77] Creating layer lstm1_
I0803 21:17:06.399031 11180 net.cpp:91] Creating Layer lstm1_
I0803 21:17:06.399044 11180 net.cpp:399] lstm1_ -> c_0
I0803 21:17:06.399062 11180 net.cpp:399] lstm1_ -> h_0
I0803 21:17:06.399168 11180 net.cpp:141] Setting up lstm1_
I0803 21:17:06.399186 11180 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:17:06.399197 11180 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:17:06.399205 11180 net.cpp:156] Memory required for data: 10004
I0803 21:17:06.399214 11180 layer_factory.hpp:77] Creating layer lstm1_cont_slice
I0803 21:17:06.399229 11180 net.cpp:91] Creating Layer lstm1_cont_slice
I0803 21:17:06.399238 11180 net.cpp:425] lstm1_cont_slice <- cont
I0803 21:17:06.399256 11180 net.cpp:399] lstm1_cont_slice -> cont_1
I0803 21:17:06.399327 11180 net.cpp:141] Setting up lstm1_cont_slice
I0803 21:17:06.399344 11180 net.cpp:148] Top shape: 1 1 (1)
I0803 21:17:06.399353 11180 net.cpp:156] Memory required for data: 10008
I0803 21:17:06.399360 11180 layer_factory.hpp:77] Creating layer cont_1_lstm1_cont_slice_0_split
I0803 21:17:06.399374 11180 net.cpp:91] Creating Layer cont_1_lstm1_cont_slice_0_split
I0803 21:17:06.399382 11180 net.cpp:425] cont_1_lstm1_cont_slice_0_split <- cont_1
I0803 21:17:06.399394 11180 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_0
I0803 21:17:06.399410 11180 net.cpp:399] cont_1_lstm1_cont_slice_0_split -> cont_1_lstm1_cont_slice_0_split_1
I0803 21:17:06.399507 11180 net.cpp:141] Setting up cont_1_lstm1_cont_slice_0_split
I0803 21:17:06.399523 11180 net.cpp:148] Top shape: 1 1 (1)
I0803 21:17:06.399534 11180 net.cpp:148] Top shape: 1 1 (1)
I0803 21:17:06.399543 11180 net.cpp:156] Memory required for data: 10016
I0803 21:17:06.399550 11180 layer_factory.hpp:77] Creating layer lstm1_x_transform
I0803 21:17:06.399572 11180 net.cpp:91] Creating Layer lstm1_x_transform
I0803 21:17:06.399582 11180 net.cpp:425] lstm1_x_transform <- x
I0803 21:17:06.399597 11180 net.cpp:399] lstm1_x_transform -> W_xc_x
I0803 21:17:06.429050 11180 net.cpp:141] Setting up lstm1_x_transform
I0803 21:17:06.429088 11180 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:17:06.429096 11180 net.cpp:156] Memory required for data: 26016
I0803 21:17:06.429129 11180 layer_factory.hpp:77] Creating layer lstm1_W_xc_x_slice
I0803 21:17:06.429143 11180 net.cpp:91] Creating Layer lstm1_W_xc_x_slice
I0803 21:17:06.429150 11180 net.cpp:425] lstm1_W_xc_x_slice <- W_xc_x
I0803 21:17:06.429163 11180 net.cpp:399] lstm1_W_xc_x_slice -> W_xc_x_1
I0803 21:17:06.429214 11180 net.cpp:141] Setting up lstm1_W_xc_x_slice
I0803 21:17:06.429226 11180 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:17:06.429231 11180 net.cpp:156] Memory required for data: 42016
I0803 21:17:06.429246 11180 layer_factory.hpp:77] Creating layer lstm1_h_conted_0
I0803 21:17:06.429260 11180 net.cpp:91] Creating Layer lstm1_h_conted_0
I0803 21:17:06.429266 11180 net.cpp:425] lstm1_h_conted_0 <- h_0
I0803 21:17:06.429275 11180 net.cpp:425] lstm1_h_conted_0 <- cont_1_lstm1_cont_slice_0_split_0
I0803 21:17:06.429299 11180 net.cpp:399] lstm1_h_conted_0 -> h_conted_0
I0803 21:17:06.429384 11180 net.cpp:141] Setting up lstm1_h_conted_0
I0803 21:17:06.429394 11180 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:17:06.429399 11180 net.cpp:156] Memory required for data: 46016
I0803 21:17:06.429404 11180 layer_factory.hpp:77] Creating layer lstm1_transform_1
I0803 21:17:06.429411 11180 net.cpp:91] Creating Layer lstm1_transform_1
I0803 21:17:06.429416 11180 net.cpp:425] lstm1_transform_1 <- h_conted_0
I0803 21:17:06.429426 11180 net.cpp:399] lstm1_transform_1 -> W_hc_h_0
I0803 21:17:06.439369 11190 net.cpp:141] Setting up fc6
I0803 21:17:06.439434 11190 net.cpp:148] Top shape: 10 4096 (40960)
I0803 21:17:06.439440 11190 net.cpp:156] Memory required for data: 67782200
I0803 21:17:06.439456 11190 layer_factory.hpp:77] Creating layer relu6
I0803 21:17:06.439476 11190 net.cpp:91] Creating Layer relu6
I0803 21:17:06.439482 11190 net.cpp:425] relu6 <- fc6
I0803 21:17:06.439494 11190 net.cpp:386] relu6 -> fc6 (in-place)
I0803 21:17:06.439822 11190 net.cpp:141] Setting up relu6
I0803 21:17:06.439832 11190 net.cpp:148] Top shape: 10 4096 (40960)
I0803 21:17:06.439837 11190 net.cpp:156] Memory required for data: 67946040
I0803 21:17:06.439841 11190 layer_factory.hpp:77] Creating layer drop6
I0803 21:17:06.439865 11190 net.cpp:91] Creating Layer drop6
I0803 21:17:06.439870 11190 net.cpp:425] drop6 <- fc6
I0803 21:17:06.439877 11190 net.cpp:386] drop6 -> fc6 (in-place)
I0803 21:17:06.439924 11190 net.cpp:141] Setting up drop6
I0803 21:17:06.439932 11190 net.cpp:148] Top shape: 10 4096 (40960)
I0803 21:17:06.439936 11190 net.cpp:156] Memory required for data: 68109880
I0803 21:17:06.439940 11190 layer_factory.hpp:77] Creating layer fc7
I0803 21:17:06.439954 11190 net.cpp:91] Creating Layer fc7
I0803 21:17:06.439960 11190 net.cpp:425] fc7 <- fc6
I0803 21:17:06.439967 11190 net.cpp:399] fc7 -> fc7
I0803 21:17:06.477939 11180 net.cpp:141] Setting up lstm1_transform_1
I0803 21:17:06.477978 11180 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:17:06.477984 11180 net.cpp:156] Memory required for data: 62016
I0803 21:17:06.478003 11180 layer_factory.hpp:77] Creating layer lstm1_gate_input_1
I0803 21:17:06.478019 11180 net.cpp:91] Creating Layer lstm1_gate_input_1
I0803 21:17:06.478027 11180 net.cpp:425] lstm1_gate_input_1 <- W_hc_h_0
I0803 21:17:06.478035 11180 net.cpp:425] lstm1_gate_input_1 <- W_xc_x_1
I0803 21:17:06.478046 11180 net.cpp:399] lstm1_gate_input_1 -> gate_input_1
I0803 21:17:06.478106 11180 net.cpp:141] Setting up lstm1_gate_input_1
I0803 21:17:06.478116 11180 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:17:06.478121 11180 net.cpp:156] Memory required for data: 78016
I0803 21:17:06.478127 11180 layer_factory.hpp:77] Creating layer lstm1_unit_1
I0803 21:17:06.478135 11180 net.cpp:91] Creating Layer lstm1_unit_1
I0803 21:17:06.478142 11180 net.cpp:425] lstm1_unit_1 <- c_0
I0803 21:17:06.478147 11180 net.cpp:425] lstm1_unit_1 <- gate_input_1
I0803 21:17:06.478153 11180 net.cpp:425] lstm1_unit_1 <- cont_1_lstm1_cont_slice_0_split_1
I0803 21:17:06.478163 11180 net.cpp:399] lstm1_unit_1 -> c_1
I0803 21:17:06.478173 11180 net.cpp:399] lstm1_unit_1 -> h_1
I0803 21:17:06.478242 11180 net.cpp:141] Setting up lstm1_unit_1
I0803 21:17:06.478252 11180 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:17:06.478258 11180 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:17:06.478263 11180 net.cpp:156] Memory required for data: 86016
I0803 21:17:06.478268 11180 layer_factory.hpp:77] Creating layer lstm1_
I0803 21:17:06.478276 11180 net.cpp:91] Creating Layer lstm1_
I0803 21:17:06.478282 11180 net.cpp:425] lstm1_ <- c_1
I0803 21:17:06.478289 11180 net.cpp:399] lstm1_ -> c_T
I0803 21:17:06.478325 11180 net.cpp:141] Setting up lstm1_
I0803 21:17:06.478335 11180 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:17:06.478340 11180 net.cpp:156] Memory required for data: 90016
I0803 21:17:06.478345 11180 layer_factory.hpp:77] Creating layer lstm1_h_concat
I0803 21:17:06.478354 11180 net.cpp:91] Creating Layer lstm1_h_concat
I0803 21:17:06.478360 11180 net.cpp:425] lstm1_h_concat <- h_1
I0803 21:17:06.478368 11180 net.cpp:399] lstm1_h_concat -> h
I0803 21:17:06.478404 11180 net.cpp:141] Setting up lstm1_h_concat
I0803 21:17:06.478415 11180 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:17:06.478418 11180 net.cpp:156] Memory required for data: 94016
I0803 21:17:06.478423 11180 layer_factory.hpp:77] Creating layer h_pseudoloss
I0803 21:17:06.478444 11180 net.cpp:91] Creating Layer h_pseudoloss
I0803 21:17:06.478451 11180 net.cpp:425] h_pseudoloss <- h
I0803 21:17:06.478457 11180 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0803 21:17:06.478560 11180 net.cpp:141] Setting up h_pseudoloss
I0803 21:17:06.478571 11180 net.cpp:148] Top shape: (1)
I0803 21:17:06.478576 11180 net.cpp:151]     with loss weight 1
I0803 21:17:06.478610 11180 net.cpp:156] Memory required for data: 94020
I0803 21:17:06.478616 11180 net.cpp:217] h_pseudoloss needs backward computation.
I0803 21:17:06.478621 11180 net.cpp:217] lstm1_h_concat needs backward computation.
I0803 21:17:06.478626 11180 net.cpp:219] lstm1_ does not need backward computation.
I0803 21:17:06.478631 11180 net.cpp:217] lstm1_unit_1 needs backward computation.
I0803 21:17:06.478638 11180 net.cpp:217] lstm1_gate_input_1 needs backward computation.
I0803 21:17:06.478643 11180 net.cpp:217] lstm1_transform_1 needs backward computation.
I0803 21:17:06.478648 11180 net.cpp:219] lstm1_h_conted_0 does not need backward computation.
I0803 21:17:06.478654 11180 net.cpp:217] lstm1_W_xc_x_slice needs backward computation.
I0803 21:17:06.478659 11180 net.cpp:217] lstm1_x_transform needs backward computation.
I0803 21:17:06.478665 11180 net.cpp:219] cont_1_lstm1_cont_slice_0_split does not need backward computation.
I0803 21:17:06.478670 11180 net.cpp:219] lstm1_cont_slice does not need backward computation.
I0803 21:17:06.478677 11180 net.cpp:219] lstm1_ does not need backward computation.
I0803 21:17:06.478680 11180 net.cpp:219] lstm1_ does not need backward computation.
I0803 21:17:06.478684 11180 net.cpp:261] This network produces output c_T
I0803 21:17:06.478689 11180 net.cpp:261] This network produces output h_pseudoloss
I0803 21:17:06.478710 11180 net.cpp:274] Network initialization done.
I0803 21:17:06.478767 11180 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0803 21:17:06.478775 11180 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0803 21:17:06.478780 11180 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0803 21:17:06.478891 11180 net.cpp:141] Setting up lstm1
I0803 21:17:06.478905 11180 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:17:06.478910 11180 net.cpp:156] Memory required for data: 26408
I0803 21:17:06.478924 11180 layer_factory.hpp:77] Creating layer concat
I0803 21:17:06.478934 11180 net.cpp:91] Creating Layer concat
I0803 21:17:06.478940 11180 net.cpp:425] concat <- lstm1
I0803 21:17:06.478946 11180 net.cpp:425] concat <- embedded_input_sentence
I0803 21:17:06.478952 11180 net.cpp:425] concat <- reshaped_stage_indicator
I0803 21:17:06.478960 11180 net.cpp:399] concat -> lstm1_video_sequence
I0803 21:17:06.479351 11180 net.cpp:141] Setting up concat
I0803 21:17:06.479363 11180 net.cpp:148] Top shape: 1 1 1501 (1501)
I0803 21:17:06.479368 11180 net.cpp:156] Memory required for data: 32412
I0803 21:17:06.479373 11180 layer_factory.hpp:77] Creating layer lstm2
I0803 21:17:06.479387 11180 net.cpp:91] Creating Layer lstm2
I0803 21:17:06.479393 11180 net.cpp:425] lstm2 <- lstm1_video_sequence
I0803 21:17:06.479398 11180 net.cpp:425] lstm2 <- cont_sentence_input_1_split_1
I0803 21:17:06.479406 11180 net.cpp:399] lstm2 -> lstm2
I0803 21:17:06.479418 11180 recurrent_layer.cpp:20] Initializing recurrent layer: assuming input batch contains 1 timesteps of 1 independent streams.
I0803 21:17:06.479697 11180 net.cpp:49] Initializing net from parameters: 
layer {
  name: "lstm2_"
  type: "Input"
  top: "x"
  top: "cont"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1501
    }
    shape {
      dim: 1
      dim: 1
    }
  }
}
layer {
  name: "lstm2_"
  type: "Input"
  top: "c_0"
  top: "h_0"
  input_param {
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
    shape {
      dim: 1
      dim: 1
      dim: 1000
    }
  }
}
layer {
  name: "lstm2_cont_slice"
  type: "Slice"
  bottom: "cont"
  top: "cont_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_x_transform"
  type: "InnerProduct"
  bottom: "x"
  top: "W_xc_x"
  param {
    name: "W_xc"
  }
  param {
    name: "b_c"
  }
  propagate_down: true
  inner_product_param {
    num_output: 4000
    bias_term: true
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    bias_filler {
      type: "constant"
      value: 0
    }
    axis: 2
  }
}
layer {
  name: "lstm2_W_xc_x_slice"
  type: "Slice"
  bottom: "W_xc_x"
  top: "W_xc_x_1"
  slice_param {
    axis: 0
  }
}
layer {
  name: "lstm2_h_conted_0"
  type: "Scale"
  bottom: "h_0"
  bottom: "cont_1"
  top: "h_conted_0"
  scale_param {
    axis: 0
  }
}
layer {
  name: "lstm2_transform_1"
  type: "InnerProduct"
  bottom: "h_conted_0"
  top: "W_hc_h_0"
  param {
    name: "W_hc"
  }
  inner_product_param {
    num_output: 4000
    bias_term: false
    weight_filler {
      type: "uniform"
      min: -0.08
      max: 0.08
    }
    axis: 2
  }
}
layer {
  name: "lstm2_gate_input_1"
  type: "Eltwise"
  bottom: "W_hc_h_0"
  bottom: "W_xc_x_1"
  top: "gate_input_1"
  eltwise_param {
    operation: SUM
  }
}
layer {
  name: "lstm2_unit_1"
  type: "LSTMUnit"
  bottom: "c_0"
  bottom: "gate_input_1"
  bottom: "cont_1"
  top: "c_1"
  top: "h_1"
}
layer {
  name: "lstm2_"
  type: "Split"
  bottom: "c_1"
  top: "c_T"
}
layer {
  name: "lstm2_h_concat"
  type: "Concat"
  bottom: "h_1"
  top: "h"
  concat_param {
    axis: 0
  }
}
layer {
  name: "h_pseudoloss"
  type: "Reduction"
  bottom: "h"
  top: "h_pseudoloss"
  loss_weight: 1
}
I0803 21:17:06.479794 11180 layer_factory.hpp:77] Creating layer lstm2_
I0803 21:17:06.479807 11180 net.cpp:91] Creating Layer lstm2_
I0803 21:17:06.479815 11180 net.cpp:399] lstm2_ -> x
I0803 21:17:06.479825 11180 net.cpp:399] lstm2_ -> cont
I0803 21:17:06.479885 11180 net.cpp:141] Setting up lstm2_
I0803 21:17:06.479897 11180 net.cpp:148] Top shape: 1 1 1501 (1501)
I0803 21:17:06.479902 11180 net.cpp:148] Top shape: 1 1 (1)
I0803 21:17:06.479907 11180 net.cpp:156] Memory required for data: 6008
I0803 21:17:06.479912 11180 layer_factory.hpp:77] Creating layer lstm2_
I0803 21:17:06.479921 11180 net.cpp:91] Creating Layer lstm2_
I0803 21:17:06.479931 11180 net.cpp:399] lstm2_ -> c_0
I0803 21:17:06.479943 11180 net.cpp:399] lstm2_ -> h_0
I0803 21:17:06.479992 11180 net.cpp:141] Setting up lstm2_
I0803 21:17:06.480002 11180 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:17:06.480008 11180 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:17:06.480013 11180 net.cpp:156] Memory required for data: 14008
I0803 21:17:06.480017 11180 layer_factory.hpp:77] Creating layer lstm2_cont_slice
I0803 21:17:06.480031 11180 net.cpp:91] Creating Layer lstm2_cont_slice
I0803 21:17:06.480037 11180 net.cpp:425] lstm2_cont_slice <- cont
I0803 21:17:06.480046 11180 net.cpp:399] lstm2_cont_slice -> cont_1
I0803 21:17:06.480080 11180 net.cpp:141] Setting up lstm2_cont_slice
I0803 21:17:06.480092 11180 net.cpp:148] Top shape: 1 1 (1)
I0803 21:17:06.480095 11180 net.cpp:156] Memory required for data: 14012
I0803 21:17:06.480100 11180 layer_factory.hpp:77] Creating layer cont_1_lstm2_cont_slice_0_split
I0803 21:17:06.480108 11180 net.cpp:91] Creating Layer cont_1_lstm2_cont_slice_0_split
I0803 21:17:06.480113 11180 net.cpp:425] cont_1_lstm2_cont_slice_0_split <- cont_1
I0803 21:17:06.480123 11180 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_0
I0803 21:17:06.480132 11180 net.cpp:399] cont_1_lstm2_cont_slice_0_split -> cont_1_lstm2_cont_slice_0_split_1
I0803 21:17:06.480187 11180 net.cpp:141] Setting up cont_1_lstm2_cont_slice_0_split
I0803 21:17:06.480196 11180 net.cpp:148] Top shape: 1 1 (1)
I0803 21:17:06.480203 11180 net.cpp:148] Top shape: 1 1 (1)
I0803 21:17:06.480207 11180 net.cpp:156] Memory required for data: 14020
I0803 21:17:06.480212 11180 layer_factory.hpp:77] Creating layer lstm2_x_transform
I0803 21:17:06.480226 11180 net.cpp:91] Creating Layer lstm2_x_transform
I0803 21:17:06.480232 11180 net.cpp:425] lstm2_x_transform <- x
I0803 21:17:06.480239 11180 net.cpp:399] lstm2_x_transform -> W_xc_x
I0803 21:17:06.492152 11190 net.cpp:141] Setting up fc7
I0803 21:17:06.492230 11190 net.cpp:148] Top shape: 10 4096 (40960)
I0803 21:17:06.492243 11190 net.cpp:156] Memory required for data: 68273720
I0803 21:17:06.492269 11190 layer_factory.hpp:77] Creating layer relu7
I0803 21:17:06.492295 11190 net.cpp:91] Creating Layer relu7
I0803 21:17:06.492307 11190 net.cpp:425] relu7 <- fc7
I0803 21:17:06.492331 11190 net.cpp:386] relu7 -> fc7 (in-place)
I0803 21:17:06.493000 11190 net.cpp:141] Setting up relu7
I0803 21:17:06.493013 11190 net.cpp:148] Top shape: 10 4096 (40960)
I0803 21:17:06.493018 11190 net.cpp:156] Memory required for data: 68437560
I0803 21:17:06.493022 11190 layer_factory.hpp:77] Creating layer drop7
I0803 21:17:06.493033 11190 net.cpp:91] Creating Layer drop7
I0803 21:17:06.493038 11190 net.cpp:425] drop7 <- fc7
I0803 21:17:06.493047 11190 net.cpp:386] drop7 -> fc7 (in-place)
I0803 21:17:06.493085 11190 net.cpp:141] Setting up drop7
I0803 21:17:06.493096 11190 net.cpp:148] Top shape: 10 4096 (40960)
I0803 21:17:06.493101 11190 net.cpp:156] Memory required for data: 68601400
I0803 21:17:06.493105 11190 layer_factory.hpp:77] Creating layer fc8
I0803 21:17:06.493115 11190 net.cpp:91] Creating Layer fc8
I0803 21:17:06.493119 11190 net.cpp:425] fc8 <- fc7
I0803 21:17:06.493125 11190 net.cpp:399] fc8 -> fc8
I0803 21:17:06.503811 11190 net.cpp:141] Setting up fc8
I0803 21:17:06.503872 11190 net.cpp:148] Top shape: 10 1000 (10000)
I0803 21:17:06.503878 11190 net.cpp:156] Memory required for data: 68641400
I0803 21:17:06.503895 11190 layer_factory.hpp:77] Creating layer prob
I0803 21:17:06.503912 11190 net.cpp:91] Creating Layer prob
I0803 21:17:06.503919 11190 net.cpp:425] prob <- fc8
I0803 21:17:06.503936 11190 net.cpp:399] prob -> prob
I0803 21:17:06.504350 11190 net.cpp:141] Setting up prob
I0803 21:17:06.504362 11190 net.cpp:148] Top shape: 10 1000 (10000)
I0803 21:17:06.504366 11190 net.cpp:156] Memory required for data: 68681400
I0803 21:17:06.504371 11190 net.cpp:219] prob does not need backward computation.
I0803 21:17:06.504376 11190 net.cpp:219] fc8 does not need backward computation.
I0803 21:17:06.504380 11190 net.cpp:219] drop7 does not need backward computation.
I0803 21:17:06.504384 11190 net.cpp:219] relu7 does not need backward computation.
I0803 21:17:06.504389 11190 net.cpp:219] fc7 does not need backward computation.
I0803 21:17:06.504393 11190 net.cpp:219] drop6 does not need backward computation.
I0803 21:17:06.504397 11190 net.cpp:219] relu6 does not need backward computation.
I0803 21:17:06.504400 11190 net.cpp:219] fc6 does not need backward computation.
I0803 21:17:06.504405 11190 net.cpp:219] pool5 does not need backward computation.
I0803 21:17:06.504410 11190 net.cpp:219] relu5 does not need backward computation.
I0803 21:17:06.504413 11190 net.cpp:219] conv5 does not need backward computation.
I0803 21:17:06.504417 11190 net.cpp:219] relu4 does not need backward computation.
I0803 21:17:06.504421 11190 net.cpp:219] conv4 does not need backward computation.
I0803 21:17:06.504426 11190 net.cpp:219] relu3 does not need backward computation.
I0803 21:17:06.504429 11190 net.cpp:219] conv3 does not need backward computation.
I0803 21:17:06.504433 11190 net.cpp:219] norm2 does not need backward computation.
I0803 21:17:06.504438 11190 net.cpp:219] pool2 does not need backward computation.
I0803 21:17:06.504441 11190 net.cpp:219] relu2 does not need backward computation.
I0803 21:17:06.504446 11190 net.cpp:219] conv2 does not need backward computation.
I0803 21:17:06.504449 11190 net.cpp:219] norm1 does not need backward computation.
I0803 21:17:06.504453 11190 net.cpp:219] pool1 does not need backward computation.
I0803 21:17:06.504458 11190 net.cpp:219] relu1 does not need backward computation.
I0803 21:17:06.504462 11190 net.cpp:219] conv1 does not need backward computation.
I0803 21:17:06.504467 11190 net.cpp:219] data does not need backward computation.
I0803 21:17:06.504469 11190 net.cpp:261] This network produces output prob
I0803 21:17:06.504490 11190 net.cpp:274] Network initialization done.
I0803 21:17:06.536204 11180 net.cpp:141] Setting up lstm2_x_transform
I0803 21:17:06.536255 11180 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:17:06.536262 11180 net.cpp:156] Memory required for data: 30020
I0803 21:17:06.536278 11180 layer_factory.hpp:77] Creating layer lstm2_W_xc_x_slice
I0803 21:17:06.536291 11180 net.cpp:91] Creating Layer lstm2_W_xc_x_slice
I0803 21:17:06.536298 11180 net.cpp:425] lstm2_W_xc_x_slice <- W_xc_x
I0803 21:17:06.536309 11180 net.cpp:399] lstm2_W_xc_x_slice -> W_xc_x_1
I0803 21:17:06.536350 11180 net.cpp:141] Setting up lstm2_W_xc_x_slice
I0803 21:17:06.536358 11180 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:17:06.536362 11180 net.cpp:156] Memory required for data: 46020
I0803 21:17:06.536367 11180 layer_factory.hpp:77] Creating layer lstm2_h_conted_0
I0803 21:17:06.536376 11180 net.cpp:91] Creating Layer lstm2_h_conted_0
I0803 21:17:06.536381 11180 net.cpp:425] lstm2_h_conted_0 <- h_0
I0803 21:17:06.536387 11180 net.cpp:425] lstm2_h_conted_0 <- cont_1_lstm2_cont_slice_0_split_0
I0803 21:17:06.536396 11180 net.cpp:399] lstm2_h_conted_0 -> h_conted_0
I0803 21:17:06.536489 11180 net.cpp:141] Setting up lstm2_h_conted_0
I0803 21:17:06.536497 11180 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:17:06.536501 11180 net.cpp:156] Memory required for data: 50020
I0803 21:17:06.536505 11180 layer_factory.hpp:77] Creating layer lstm2_transform_1
I0803 21:17:06.536517 11180 net.cpp:91] Creating Layer lstm2_transform_1
I0803 21:17:06.536522 11180 net.cpp:425] lstm2_transform_1 <- h_conted_0
I0803 21:17:06.536530 11180 net.cpp:399] lstm2_transform_1 -> W_hc_h_0
I0803 21:17:06.572316 11180 net.cpp:141] Setting up lstm2_transform_1
I0803 21:17:06.572353 11180 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:17:06.572371 11180 net.cpp:156] Memory required for data: 66020
I0803 21:17:06.572388 11180 layer_factory.hpp:77] Creating layer lstm2_gate_input_1
I0803 21:17:06.572407 11180 net.cpp:91] Creating Layer lstm2_gate_input_1
I0803 21:17:06.572412 11180 net.cpp:425] lstm2_gate_input_1 <- W_hc_h_0
I0803 21:17:06.572419 11180 net.cpp:425] lstm2_gate_input_1 <- W_xc_x_1
I0803 21:17:06.572427 11180 net.cpp:399] lstm2_gate_input_1 -> gate_input_1
I0803 21:17:06.572473 11180 net.cpp:141] Setting up lstm2_gate_input_1
I0803 21:17:06.572480 11180 net.cpp:148] Top shape: 1 1 4000 (4000)
I0803 21:17:06.572484 11180 net.cpp:156] Memory required for data: 82020
I0803 21:17:06.572489 11180 layer_factory.hpp:77] Creating layer lstm2_unit_1
I0803 21:17:06.572496 11180 net.cpp:91] Creating Layer lstm2_unit_1
I0803 21:17:06.572501 11180 net.cpp:425] lstm2_unit_1 <- c_0
I0803 21:17:06.572506 11180 net.cpp:425] lstm2_unit_1 <- gate_input_1
I0803 21:17:06.572511 11180 net.cpp:425] lstm2_unit_1 <- cont_1_lstm2_cont_slice_0_split_1
I0803 21:17:06.572520 11180 net.cpp:399] lstm2_unit_1 -> c_1
I0803 21:17:06.572528 11180 net.cpp:399] lstm2_unit_1 -> h_1
I0803 21:17:06.572587 11180 net.cpp:141] Setting up lstm2_unit_1
I0803 21:17:06.572595 11180 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:17:06.572600 11180 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:17:06.572604 11180 net.cpp:156] Memory required for data: 90020
I0803 21:17:06.572608 11180 layer_factory.hpp:77] Creating layer lstm2_
I0803 21:17:06.572615 11180 net.cpp:91] Creating Layer lstm2_
I0803 21:17:06.572619 11180 net.cpp:425] lstm2_ <- c_1
I0803 21:17:06.572626 11180 net.cpp:399] lstm2_ -> c_T
I0803 21:17:06.572656 11180 net.cpp:141] Setting up lstm2_
I0803 21:17:06.572665 11180 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:17:06.572669 11180 net.cpp:156] Memory required for data: 94020
I0803 21:17:06.572674 11180 layer_factory.hpp:77] Creating layer lstm2_h_concat
I0803 21:17:06.572681 11180 net.cpp:91] Creating Layer lstm2_h_concat
I0803 21:17:06.572686 11180 net.cpp:425] lstm2_h_concat <- h_1
I0803 21:17:06.572692 11180 net.cpp:399] lstm2_h_concat -> h
I0803 21:17:06.572723 11180 net.cpp:141] Setting up lstm2_h_concat
I0803 21:17:06.572731 11180 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:17:06.572736 11180 net.cpp:156] Memory required for data: 98020
I0803 21:17:06.572739 11180 layer_factory.hpp:77] Creating layer h_pseudoloss
I0803 21:17:06.572749 11180 net.cpp:91] Creating Layer h_pseudoloss
I0803 21:17:06.572754 11180 net.cpp:425] h_pseudoloss <- h
I0803 21:17:06.572762 11180 net.cpp:399] h_pseudoloss -> h_pseudoloss
I0803 21:17:06.572847 11180 net.cpp:141] Setting up h_pseudoloss
I0803 21:17:06.572856 11180 net.cpp:148] Top shape: (1)
I0803 21:17:06.572861 11180 net.cpp:151]     with loss weight 1
I0803 21:17:06.572877 11180 net.cpp:156] Memory required for data: 98024
I0803 21:17:06.572882 11180 net.cpp:217] h_pseudoloss needs backward computation.
I0803 21:17:06.572886 11180 net.cpp:217] lstm2_h_concat needs backward computation.
I0803 21:17:06.572890 11180 net.cpp:219] lstm2_ does not need backward computation.
I0803 21:17:06.572896 11180 net.cpp:217] lstm2_unit_1 needs backward computation.
I0803 21:17:06.572901 11180 net.cpp:217] lstm2_gate_input_1 needs backward computation.
I0803 21:17:06.572904 11180 net.cpp:217] lstm2_transform_1 needs backward computation.
I0803 21:17:06.572909 11180 net.cpp:219] lstm2_h_conted_0 does not need backward computation.
I0803 21:17:06.572914 11180 net.cpp:217] lstm2_W_xc_x_slice needs backward computation.
I0803 21:17:06.572918 11180 net.cpp:217] lstm2_x_transform needs backward computation.
I0803 21:17:06.572923 11180 net.cpp:219] cont_1_lstm2_cont_slice_0_split does not need backward computation.
I0803 21:17:06.572927 11180 net.cpp:219] lstm2_cont_slice does not need backward computation.
I0803 21:17:06.572932 11180 net.cpp:219] lstm2_ does not need backward computation.
I0803 21:17:06.572937 11180 net.cpp:219] lstm2_ does not need backward computation.
I0803 21:17:06.572939 11180 net.cpp:261] This network produces output c_T
I0803 21:17:06.572943 11180 net.cpp:261] This network produces output h_pseudoloss
I0803 21:17:06.572959 11180 net.cpp:274] Network initialization done.
I0803 21:17:06.573002 11180 recurrent_layer.cpp:150] Adding parameter 0: W_xc
I0803 21:17:06.573007 11180 recurrent_layer.cpp:150] Adding parameter 1: b_c
I0803 21:17:06.573011 11180 recurrent_layer.cpp:150] Adding parameter 2: W_hc
I0803 21:17:06.573104 11180 net.cpp:141] Setting up lstm2
I0803 21:17:06.573115 11180 net.cpp:148] Top shape: 1 1 1000 (1000)
I0803 21:17:06.573119 11180 net.cpp:156] Memory required for data: 36412
I0803 21:17:06.573132 11180 layer_factory.hpp:77] Creating layer predict
I0803 21:17:06.573143 11180 net.cpp:91] Creating Layer predict
I0803 21:17:06.573149 11180 net.cpp:425] predict <- lstm2
I0803 21:17:06.573155 11180 net.cpp:399] predict -> predict
I0803 21:17:06.715777 11190 upgrade_proto.cpp:43] Attempting to upgrade input file specified using deprecated transformation parameters: /tmp/cvld5698412900921754623/bvlc_reference_caffenet.caffemodel
I0803 21:17:06.715822 11190 upgrade_proto.cpp:46] Successfully upgraded file specified using deprecated data transformation parameters.
W0803 21:17:06.715836 11190 upgrade_proto.cpp:48] Note that future Caffe releases will only support transform_param messages for transformation fields.
I0803 21:17:06.715839 11190 upgrade_proto.cpp:52] Attempting to upgrade input file specified using deprecated V1LayerParameter: /tmp/cvld5698412900921754623/bvlc_reference_caffenet.caffemodel
I0803 21:17:07.011899 11180 net.cpp:141] Setting up predict
I0803 21:17:07.011973 11180 net.cpp:148] Top shape: 1 1 46168 (46168)
I0803 21:17:07.011981 11180 net.cpp:156] Memory required for data: 221084
I0803 21:17:07.012015 11180 layer_factory.hpp:77] Creating layer probs
I0803 21:17:07.012040 11180 net.cpp:91] Creating Layer probs
I0803 21:17:07.012066 11180 net.cpp:425] probs <- predict
I0803 21:17:07.012087 11180 net.cpp:399] probs -> probs
I0803 21:17:07.013310 11180 net.cpp:141] Setting up probs
I0803 21:17:07.013341 11180 net.cpp:148] Top shape: 1 1 46168 (46168)
I0803 21:17:07.013348 11180 net.cpp:156] Memory required for data: 405756
I0803 21:17:07.013356 11180 net.cpp:219] probs does not need backward computation.
I0803 21:17:07.013363 11180 net.cpp:219] predict does not need backward computation.
I0803 21:17:07.013370 11180 net.cpp:219] lstm2 does not need backward computation.
I0803 21:17:07.013378 11180 net.cpp:219] concat does not need backward computation.
I0803 21:17:07.013392 11180 net.cpp:219] lstm1 does not need backward computation.
I0803 21:17:07.013407 11180 net.cpp:219] embedding does not need backward computation.
I0803 21:17:07.013413 11180 net.cpp:219] reshape_stage_indicator does not need backward computation.
I0803 21:17:07.013422 11180 net.cpp:219] reshape_frames does not need backward computation.
I0803 21:17:07.013428 11180 net.cpp:219] embed_encoder does not need backward computation.
I0803 21:17:07.013435 11180 net.cpp:219] cont_sentence_input_1_split does not need backward computation.
I0803 21:17:07.013443 11180 net.cpp:219] input does not need backward computation.
I0803 21:17:07.013449 11180 net.cpp:261] This network produces output probs
I0803 21:17:07.013468 11180 net.cpp:274] Network initialization done.
I0803 21:17:07.099686 11190 upgrade_proto.cpp:60] Successfully upgraded file specified using deprecated V1LayerParameter
I0803 21:17:07.154325 11190 net.cpp:752] Ignoring source layer loss
I0803 21:17:07.387287 11180 net.cpp:752] Ignoring source layer data
I0803 21:17:07.387333 11180 net.cpp:752] Ignoring source layer cont_sentence_data_0_split
I0803 21:17:07.387339 11180 net.cpp:752] Ignoring source layer reshape_stg_indicator
I0803 21:17:07.486141 11180 net.cpp:752] Ignoring source layer cross_entropy_loss
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/lvnguyen/apache-storm-0.10.1/lib/log4j-slf4j-impl-2.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/lvnguyen/apache-storm-0.10.1/data/supervisor/stormdist/captioning-1-1470273289/stormjar.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
2016-08-03 21:17:17,077 ERROR Logger contains an invalid element or attribute "appender"
2016-08-03 21:17:22,473 ERROR Logger contains an invalid element or attribute "appender"
